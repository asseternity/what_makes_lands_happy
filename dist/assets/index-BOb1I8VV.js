function _y(R,U){for(var G=0;G<U.length;G++){const k=U[G];if(typeof k!="string"&&!Array.isArray(k)){for(const Q in k)if(Q!=="default"&&!(Q in R)){const ee=Object.getOwnPropertyDescriptor(k,Q);ee&&Object.defineProperty(R,Q,ee.get?ee:{enumerable:!0,get:()=>k[Q]})}}}return Object.freeze(Object.defineProperty(R,Symbol.toStringTag,{value:"Module"}))}(function(){const U=document.createElement("link").relList;if(U&&U.supports&&U.supports("modulepreload"))return;for(const Q of document.querySelectorAll('link[rel="modulepreload"]'))k(Q);new MutationObserver(Q=>{for(const ee of Q)if(ee.type==="childList")for(const E of ee.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&k(E)}).observe(document,{childList:!0,subtree:!0});function G(Q){const ee={};return Q.integrity&&(ee.integrity=Q.integrity),Q.referrerPolicy&&(ee.referrerPolicy=Q.referrerPolicy),Q.crossOrigin==="use-credentials"?ee.credentials="include":Q.crossOrigin==="anonymous"?ee.credentials="omit":ee.credentials="same-origin",ee}function k(Q){if(Q.ep)return;Q.ep=!0;const ee=G(Q);fetch(Q.href,ee)}})();function wg(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}var hm={exports:{}},Rf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $m;function vy(){if($m)return Rf;$m=1;var R=Symbol.for("react.transitional.element"),U=Symbol.for("react.fragment");function G(k,Q,ee){var E=null;if(ee!==void 0&&(E=""+ee),Q.key!==void 0&&(E=""+Q.key),"key"in Q){ee={};for(var c in Q)c!=="key"&&(ee[c]=Q[c])}else ee=Q;return Q=ee.ref,{$$typeof:R,type:k,key:E,ref:Q!==void 0?Q:null,props:ee}}return Rf.Fragment=U,Rf.jsx=G,Rf.jsxs=G,Rf}var Xm;function xy(){return Xm||(Xm=1,hm.exports=vy()),hm.exports}var Ie=xy(),dm={exports:{}},bn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ym;function by(){if(Ym)return bn;Ym=1;var R=Symbol.for("react.transitional.element"),U=Symbol.for("react.portal"),G=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),ee=Symbol.for("react.consumer"),E=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),te=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),ze=Symbol.iterator;function Ce(me){return me===null||typeof me!="object"?null:(me=ze&&me[ze]||me["@@iterator"],typeof me=="function"?me:null)}var ue={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},je=Object.assign,Ge={};function Ye(me,Ze,gt){this.props=me,this.context=Ze,this.refs=Ge,this.updater=gt||ue}Ye.prototype.isReactComponent={},Ye.prototype.setState=function(me,Ze){if(typeof me!="object"&&typeof me!="function"&&me!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,me,Ze,"setState")},Ye.prototype.forceUpdate=function(me){this.updater.enqueueForceUpdate(this,me,"forceUpdate")};function We(){}We.prototype=Ye.prototype;function He(me,Ze,gt){this.props=me,this.context=Ze,this.refs=Ge,this.updater=gt||ue}var nt=He.prototype=new We;nt.constructor=He,je(nt,Ye.prototype),nt.isPureReactComponent=!0;var wt=Array.isArray,xt={H:null,A:null,T:null,S:null,V:null},Tt=Object.prototype.hasOwnProperty;function It(me,Ze,gt,rt,yt,Kt){return gt=Kt.ref,{$$typeof:R,type:me,key:Ze,ref:gt!==void 0?gt:null,props:Kt}}function ut(me,Ze){return It(me.type,Ze,void 0,void 0,void 0,me.props)}function Gt(me){return typeof me=="object"&&me!==null&&me.$$typeof===R}function pn(me){var Ze={"=":"=0",":":"=2"};return"$"+me.replace(/[=:]/g,function(gt){return Ze[gt]})}var nn=/\/+/g;function on(me,Ze){return typeof me=="object"&&me!==null&&me.key!=null?pn(""+me.key):Ze.toString(36)}function jn(){}function er(me){switch(me.status){case"fulfilled":return me.value;case"rejected":throw me.reason;default:switch(typeof me.status=="string"?me.then(jn,jn):(me.status="pending",me.then(function(Ze){me.status==="pending"&&(me.status="fulfilled",me.value=Ze)},function(Ze){me.status==="pending"&&(me.status="rejected",me.reason=Ze)})),me.status){case"fulfilled":return me.value;case"rejected":throw me.reason}}throw me}function mn(me,Ze,gt,rt,yt){var Kt=typeof me;(Kt==="undefined"||Kt==="boolean")&&(me=null);var Dt=!1;if(me===null)Dt=!0;else switch(Kt){case"bigint":case"string":case"number":Dt=!0;break;case"object":switch(me.$$typeof){case R:case U:Dt=!0;break;case Se:return Dt=me._init,mn(Dt(me._payload),Ze,gt,rt,yt)}}if(Dt)return yt=yt(me),Dt=rt===""?"."+on(me,0):rt,wt(yt)?(gt="",Dt!=null&&(gt=Dt.replace(nn,"$&/")+"/"),mn(yt,Ze,gt,"",function(En){return En})):yt!=null&&(Gt(yt)&&(yt=ut(yt,gt+(yt.key==null||me&&me.key===yt.key?"":(""+yt.key).replace(nn,"$&/")+"/")+Dt)),Ze.push(yt)),1;Dt=0;var Zt=rt===""?".":rt+":";if(wt(me))for(var Vt=0;Vt<me.length;Vt++)rt=me[Vt],Kt=Zt+on(rt,Vt),Dt+=mn(rt,Ze,gt,Kt,yt);else if(Vt=Ce(me),typeof Vt=="function")for(me=Vt.call(me),Vt=0;!(rt=me.next()).done;)rt=rt.value,Kt=Zt+on(rt,Vt++),Dt+=mn(rt,Ze,gt,Kt,yt);else if(Kt==="object"){if(typeof me.then=="function")return mn(er(me),Ze,gt,rt,yt);throw Ze=String(me),Error("Objects are not valid as a React child (found: "+(Ze==="[object Object]"?"object with keys {"+Object.keys(me).join(", ")+"}":Ze)+"). If you meant to render a collection of children, use an array instead.")}return Dt}function Ue(me,Ze,gt){if(me==null)return me;var rt=[],yt=0;return mn(me,rt,"","",function(Kt){return Ze.call(gt,Kt,yt++)}),rt}function ht(me){if(me._status===-1){var Ze=me._result;Ze=Ze(),Ze.then(function(gt){(me._status===0||me._status===-1)&&(me._status=1,me._result=gt)},function(gt){(me._status===0||me._status===-1)&&(me._status=2,me._result=gt)}),me._status===-1&&(me._status=0,me._result=Ze)}if(me._status===1)return me._result.default;throw me._result}var tt=typeof reportError=="function"?reportError:function(me){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ze=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof me=="object"&&me!==null&&typeof me.message=="string"?String(me.message):String(me),error:me});if(!window.dispatchEvent(Ze))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",me);return}console.error(me)};function At(){}return bn.Children={map:Ue,forEach:function(me,Ze,gt){Ue(me,function(){Ze.apply(this,arguments)},gt)},count:function(me){var Ze=0;return Ue(me,function(){Ze++}),Ze},toArray:function(me){return Ue(me,function(Ze){return Ze})||[]},only:function(me){if(!Gt(me))throw Error("React.Children.only expected to receive a single React element child.");return me}},bn.Component=Ye,bn.Fragment=G,bn.Profiler=Q,bn.PureComponent=He,bn.StrictMode=k,bn.Suspense=q,bn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=xt,bn.__COMPILER_RUNTIME={__proto__:null,c:function(me){return xt.H.useMemoCache(me)}},bn.cache=function(me){return function(){return me.apply(null,arguments)}},bn.cloneElement=function(me,Ze,gt){if(me==null)throw Error("The argument must be a React element, but you passed "+me+".");var rt=je({},me.props),yt=me.key,Kt=void 0;if(Ze!=null)for(Dt in Ze.ref!==void 0&&(Kt=void 0),Ze.key!==void 0&&(yt=""+Ze.key),Ze)!Tt.call(Ze,Dt)||Dt==="key"||Dt==="__self"||Dt==="__source"||Dt==="ref"&&Ze.ref===void 0||(rt[Dt]=Ze[Dt]);var Dt=arguments.length-2;if(Dt===1)rt.children=gt;else if(1<Dt){for(var Zt=Array(Dt),Vt=0;Vt<Dt;Vt++)Zt[Vt]=arguments[Vt+2];rt.children=Zt}return It(me.type,yt,void 0,void 0,Kt,rt)},bn.createContext=function(me){return me={$$typeof:E,_currentValue:me,_currentValue2:me,_threadCount:0,Provider:null,Consumer:null},me.Provider=me,me.Consumer={$$typeof:ee,_context:me},me},bn.createElement=function(me,Ze,gt){var rt,yt={},Kt=null;if(Ze!=null)for(rt in Ze.key!==void 0&&(Kt=""+Ze.key),Ze)Tt.call(Ze,rt)&&rt!=="key"&&rt!=="__self"&&rt!=="__source"&&(yt[rt]=Ze[rt]);var Dt=arguments.length-2;if(Dt===1)yt.children=gt;else if(1<Dt){for(var Zt=Array(Dt),Vt=0;Vt<Dt;Vt++)Zt[Vt]=arguments[Vt+2];yt.children=Zt}if(me&&me.defaultProps)for(rt in Dt=me.defaultProps,Dt)yt[rt]===void 0&&(yt[rt]=Dt[rt]);return It(me,Kt,void 0,void 0,null,yt)},bn.createRef=function(){return{current:null}},bn.forwardRef=function(me){return{$$typeof:c,render:me}},bn.isValidElement=Gt,bn.lazy=function(me){return{$$typeof:Se,_payload:{_status:-1,_result:me},_init:ht}},bn.memo=function(me,Ze){return{$$typeof:te,type:me,compare:Ze===void 0?null:Ze}},bn.startTransition=function(me){var Ze=xt.T,gt={};xt.T=gt;try{var rt=me(),yt=xt.S;yt!==null&&yt(gt,rt),typeof rt=="object"&&rt!==null&&typeof rt.then=="function"&&rt.then(At,tt)}catch(Kt){tt(Kt)}finally{xt.T=Ze}},bn.unstable_useCacheRefresh=function(){return xt.H.useCacheRefresh()},bn.use=function(me){return xt.H.use(me)},bn.useActionState=function(me,Ze,gt){return xt.H.useActionState(me,Ze,gt)},bn.useCallback=function(me,Ze){return xt.H.useCallback(me,Ze)},bn.useContext=function(me){return xt.H.useContext(me)},bn.useDebugValue=function(){},bn.useDeferredValue=function(me,Ze){return xt.H.useDeferredValue(me,Ze)},bn.useEffect=function(me,Ze,gt){var rt=xt.H;if(typeof gt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return rt.useEffect(me,Ze)},bn.useId=function(){return xt.H.useId()},bn.useImperativeHandle=function(me,Ze,gt){return xt.H.useImperativeHandle(me,Ze,gt)},bn.useInsertionEffect=function(me,Ze){return xt.H.useInsertionEffect(me,Ze)},bn.useLayoutEffect=function(me,Ze){return xt.H.useLayoutEffect(me,Ze)},bn.useMemo=function(me,Ze){return xt.H.useMemo(me,Ze)},bn.useOptimistic=function(me,Ze){return xt.H.useOptimistic(me,Ze)},bn.useReducer=function(me,Ze,gt){return xt.H.useReducer(me,Ze,gt)},bn.useRef=function(me){return xt.H.useRef(me)},bn.useState=function(me){return xt.H.useState(me)},bn.useSyncExternalStore=function(me,Ze,gt){return xt.H.useSyncExternalStore(me,Ze,gt)},bn.useTransition=function(){return xt.H.useTransition()},bn.version="19.1.1",bn}var Km;function Rm(){return Km||(Km=1,dm.exports=by()),dm.exports}var mt=Rm();const gi=wg(mt),Sg=_y({__proto__:null,default:gi},[mt]);var fm={exports:{}},Df={},pm={exports:{}},mm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qm;function wy(){return Qm||(Qm=1,(function(R){function U(Ue,ht){var tt=Ue.length;Ue.push(ht);e:for(;0<tt;){var At=tt-1>>>1,me=Ue[At];if(0<Q(me,ht))Ue[At]=ht,Ue[tt]=me,tt=At;else break e}}function G(Ue){return Ue.length===0?null:Ue[0]}function k(Ue){if(Ue.length===0)return null;var ht=Ue[0],tt=Ue.pop();if(tt!==ht){Ue[0]=tt;e:for(var At=0,me=Ue.length,Ze=me>>>1;At<Ze;){var gt=2*(At+1)-1,rt=Ue[gt],yt=gt+1,Kt=Ue[yt];if(0>Q(rt,tt))yt<me&&0>Q(Kt,rt)?(Ue[At]=Kt,Ue[yt]=tt,At=yt):(Ue[At]=rt,Ue[gt]=tt,At=gt);else if(yt<me&&0>Q(Kt,tt))Ue[At]=Kt,Ue[yt]=tt,At=yt;else break e}}return ht}function Q(Ue,ht){var tt=Ue.sortIndex-ht.sortIndex;return tt!==0?tt:Ue.id-ht.id}if(R.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var ee=performance;R.unstable_now=function(){return ee.now()}}else{var E=Date,c=E.now();R.unstable_now=function(){return E.now()-c}}var q=[],te=[],Se=1,ze=null,Ce=3,ue=!1,je=!1,Ge=!1,Ye=!1,We=typeof setTimeout=="function"?setTimeout:null,He=typeof clearTimeout=="function"?clearTimeout:null,nt=typeof setImmediate<"u"?setImmediate:null;function wt(Ue){for(var ht=G(te);ht!==null;){if(ht.callback===null)k(te);else if(ht.startTime<=Ue)k(te),ht.sortIndex=ht.expirationTime,U(q,ht);else break;ht=G(te)}}function xt(Ue){if(Ge=!1,wt(Ue),!je)if(G(q)!==null)je=!0,Tt||(Tt=!0,on());else{var ht=G(te);ht!==null&&mn(xt,ht.startTime-Ue)}}var Tt=!1,It=-1,ut=5,Gt=-1;function pn(){return Ye?!0:!(R.unstable_now()-Gt<ut)}function nn(){if(Ye=!1,Tt){var Ue=R.unstable_now();Gt=Ue;var ht=!0;try{e:{je=!1,Ge&&(Ge=!1,He(It),It=-1),ue=!0;var tt=Ce;try{t:{for(wt(Ue),ze=G(q);ze!==null&&!(ze.expirationTime>Ue&&pn());){var At=ze.callback;if(typeof At=="function"){ze.callback=null,Ce=ze.priorityLevel;var me=At(ze.expirationTime<=Ue);if(Ue=R.unstable_now(),typeof me=="function"){ze.callback=me,wt(Ue),ht=!0;break t}ze===G(q)&&k(q),wt(Ue)}else k(q);ze=G(q)}if(ze!==null)ht=!0;else{var Ze=G(te);Ze!==null&&mn(xt,Ze.startTime-Ue),ht=!1}}break e}finally{ze=null,Ce=tt,ue=!1}ht=void 0}}finally{ht?on():Tt=!1}}}var on;if(typeof nt=="function")on=function(){nt(nn)};else if(typeof MessageChannel<"u"){var jn=new MessageChannel,er=jn.port2;jn.port1.onmessage=nn,on=function(){er.postMessage(null)}}else on=function(){We(nn,0)};function mn(Ue,ht){It=We(function(){Ue(R.unstable_now())},ht)}R.unstable_IdlePriority=5,R.unstable_ImmediatePriority=1,R.unstable_LowPriority=4,R.unstable_NormalPriority=3,R.unstable_Profiling=null,R.unstable_UserBlockingPriority=2,R.unstable_cancelCallback=function(Ue){Ue.callback=null},R.unstable_forceFrameRate=function(Ue){0>Ue||125<Ue?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<Ue?Math.floor(1e3/Ue):5},R.unstable_getCurrentPriorityLevel=function(){return Ce},R.unstable_next=function(Ue){switch(Ce){case 1:case 2:case 3:var ht=3;break;default:ht=Ce}var tt=Ce;Ce=ht;try{return Ue()}finally{Ce=tt}},R.unstable_requestPaint=function(){Ye=!0},R.unstable_runWithPriority=function(Ue,ht){switch(Ue){case 1:case 2:case 3:case 4:case 5:break;default:Ue=3}var tt=Ce;Ce=Ue;try{return ht()}finally{Ce=tt}},R.unstable_scheduleCallback=function(Ue,ht,tt){var At=R.unstable_now();switch(typeof tt=="object"&&tt!==null?(tt=tt.delay,tt=typeof tt=="number"&&0<tt?At+tt:At):tt=At,Ue){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=tt+me,Ue={id:Se++,callback:ht,priorityLevel:Ue,startTime:tt,expirationTime:me,sortIndex:-1},tt>At?(Ue.sortIndex=tt,U(te,Ue),G(q)===null&&Ue===G(te)&&(Ge?(He(It),It=-1):Ge=!0,mn(xt,tt-At))):(Ue.sortIndex=me,U(q,Ue),je||ue||(je=!0,Tt||(Tt=!0,on()))),Ue},R.unstable_shouldYield=pn,R.unstable_wrapCallback=function(Ue){var ht=Ce;return function(){var tt=Ce;Ce=ht;try{return Ue.apply(this,arguments)}finally{Ce=tt}}}})(mm)),mm}var Jm;function Sy(){return Jm||(Jm=1,pm.exports=wy()),pm.exports}var gm={exports:{}},Pa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eg;function Py(){if(eg)return Pa;eg=1;var R=Rm();function U(q){var te="https://react.dev/errors/"+q;if(1<arguments.length){te+="?args[]="+encodeURIComponent(arguments[1]);for(var Se=2;Se<arguments.length;Se++)te+="&args[]="+encodeURIComponent(arguments[Se])}return"Minified React error #"+q+"; visit "+te+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function G(){}var k={d:{f:G,r:function(){throw Error(U(522))},D:G,C:G,L:G,m:G,X:G,S:G,M:G},p:0,findDOMNode:null},Q=Symbol.for("react.portal");function ee(q,te,Se){var ze=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Q,key:ze==null?null:""+ze,children:q,containerInfo:te,implementation:Se}}var E=R.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(q,te){if(q==="font")return"";if(typeof te=="string")return te==="use-credentials"?te:""}return Pa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Pa.createPortal=function(q,te){var Se=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!te||te.nodeType!==1&&te.nodeType!==9&&te.nodeType!==11)throw Error(U(299));return ee(q,te,null,Se)},Pa.flushSync=function(q){var te=E.T,Se=k.p;try{if(E.T=null,k.p=2,q)return q()}finally{E.T=te,k.p=Se,k.d.f()}},Pa.preconnect=function(q,te){typeof q=="string"&&(te?(te=te.crossOrigin,te=typeof te=="string"?te==="use-credentials"?te:"":void 0):te=null,k.d.C(q,te))},Pa.prefetchDNS=function(q){typeof q=="string"&&k.d.D(q)},Pa.preinit=function(q,te){if(typeof q=="string"&&te&&typeof te.as=="string"){var Se=te.as,ze=c(Se,te.crossOrigin),Ce=typeof te.integrity=="string"?te.integrity:void 0,ue=typeof te.fetchPriority=="string"?te.fetchPriority:void 0;Se==="style"?k.d.S(q,typeof te.precedence=="string"?te.precedence:void 0,{crossOrigin:ze,integrity:Ce,fetchPriority:ue}):Se==="script"&&k.d.X(q,{crossOrigin:ze,integrity:Ce,fetchPriority:ue,nonce:typeof te.nonce=="string"?te.nonce:void 0})}},Pa.preinitModule=function(q,te){if(typeof q=="string")if(typeof te=="object"&&te!==null){if(te.as==null||te.as==="script"){var Se=c(te.as,te.crossOrigin);k.d.M(q,{crossOrigin:Se,integrity:typeof te.integrity=="string"?te.integrity:void 0,nonce:typeof te.nonce=="string"?te.nonce:void 0})}}else te==null&&k.d.M(q)},Pa.preload=function(q,te){if(typeof q=="string"&&typeof te=="object"&&te!==null&&typeof te.as=="string"){var Se=te.as,ze=c(Se,te.crossOrigin);k.d.L(q,Se,{crossOrigin:ze,integrity:typeof te.integrity=="string"?te.integrity:void 0,nonce:typeof te.nonce=="string"?te.nonce:void 0,type:typeof te.type=="string"?te.type:void 0,fetchPriority:typeof te.fetchPriority=="string"?te.fetchPriority:void 0,referrerPolicy:typeof te.referrerPolicy=="string"?te.referrerPolicy:void 0,imageSrcSet:typeof te.imageSrcSet=="string"?te.imageSrcSet:void 0,imageSizes:typeof te.imageSizes=="string"?te.imageSizes:void 0,media:typeof te.media=="string"?te.media:void 0})}},Pa.preloadModule=function(q,te){if(typeof q=="string")if(te){var Se=c(te.as,te.crossOrigin);k.d.m(q,{as:typeof te.as=="string"&&te.as!=="script"?te.as:void 0,crossOrigin:Se,integrity:typeof te.integrity=="string"?te.integrity:void 0})}else k.d.m(q)},Pa.requestFormReset=function(q){k.d.r(q)},Pa.unstable_batchedUpdates=function(q,te){return q(te)},Pa.useFormState=function(q,te,Se){return E.H.useFormState(q,te,Se)},Pa.useFormStatus=function(){return E.H.useHostTransitionStatus()},Pa.version="19.1.1",Pa}var tg;function Pg(){if(tg)return gm.exports;tg=1;function R(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(R)}catch(U){console.error(U)}}return R(),gm.exports=Py(),gm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ng;function Cy(){if(ng)return Df;ng=1;var R=Sy(),U=Rm(),G=Pg();function k(n){var o="https://react.dev/errors/"+n;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Q(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function ee(n){var o=n,u=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(u=o.return),n=o.return;while(n)}return o.tag===3?u:null}function E(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function c(n){if(ee(n)!==n)throw Error(k(188))}function q(n){var o=n.alternate;if(!o){if(o=ee(n),o===null)throw Error(k(188));return o!==n?null:n}for(var u=n,p=o;;){var x=u.return;if(x===null)break;var C=x.alternate;if(C===null){if(p=x.return,p!==null){u=p;continue}break}if(x.child===C.child){for(C=x.child;C;){if(C===u)return c(x),n;if(C===p)return c(x),o;C=C.sibling}throw Error(k(188))}if(u.return!==p.return)u=x,p=C;else{for(var O=!1,H=x.child;H;){if(H===u){O=!0,u=x,p=C;break}if(H===p){O=!0,p=x,u=C;break}H=H.sibling}if(!O){for(H=C.child;H;){if(H===u){O=!0,u=C,p=x;break}if(H===p){O=!0,p=C,u=x;break}H=H.sibling}if(!O)throw Error(k(189))}}if(u.alternate!==p)throw Error(k(190))}if(u.tag!==3)throw Error(k(188));return u.stateNode.current===u?n:o}function te(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n;for(n=n.child;n!==null;){if(o=te(n),o!==null)return o;n=n.sibling}return null}var Se=Object.assign,ze=Symbol.for("react.element"),Ce=Symbol.for("react.transitional.element"),ue=Symbol.for("react.portal"),je=Symbol.for("react.fragment"),Ge=Symbol.for("react.strict_mode"),Ye=Symbol.for("react.profiler"),We=Symbol.for("react.provider"),He=Symbol.for("react.consumer"),nt=Symbol.for("react.context"),wt=Symbol.for("react.forward_ref"),xt=Symbol.for("react.suspense"),Tt=Symbol.for("react.suspense_list"),It=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),Gt=Symbol.for("react.activity"),pn=Symbol.for("react.memo_cache_sentinel"),nn=Symbol.iterator;function on(n){return n===null||typeof n!="object"?null:(n=nn&&n[nn]||n["@@iterator"],typeof n=="function"?n:null)}var jn=Symbol.for("react.client.reference");function er(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===jn?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case je:return"Fragment";case Ye:return"Profiler";case Ge:return"StrictMode";case xt:return"Suspense";case Tt:return"SuspenseList";case Gt:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case ue:return"Portal";case nt:return(n.displayName||"Context")+".Provider";case He:return(n._context.displayName||"Context")+".Consumer";case wt:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case It:return o=n.displayName||null,o!==null?o:er(n.type)||"Memo";case ut:o=n._payload,n=n._init;try{return er(n(o))}catch{}}return null}var mn=Array.isArray,Ue=U.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ht=G.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt={pending:!1,data:null,method:null,action:null},At=[],me=-1;function Ze(n){return{current:n}}function gt(n){0>me||(n.current=At[me],At[me]=null,me--)}function rt(n,o){me++,At[me]=n.current,n.current=o}var yt=Ze(null),Kt=Ze(null),Dt=Ze(null),Zt=Ze(null);function Vt(n,o){switch(rt(Dt,o),rt(Kt,n),rt(yt,null),o.nodeType){case 9:case 11:n=(n=o.documentElement)&&(n=n.namespaceURI)?Ru(n):0;break;default:if(n=o.tagName,o=o.namespaceURI)o=Ru(o),n=vc(o,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}gt(yt),rt(yt,n)}function En(){gt(yt),gt(Kt),gt(Dt)}function tr(n){n.memoizedState!==null&&rt(Zt,n);var o=yt.current,u=vc(o,n.type);o!==u&&(rt(Kt,n),rt(yt,u))}function xn(n){Kt.current===n&&(gt(yt),gt(Kt)),Zt.current===n&&(gt(Zt),D._currentValue=tt)}var vt=Object.prototype.hasOwnProperty,qt=R.unstable_scheduleCallback,un=R.unstable_cancelCallback,qn=R.unstable_shouldYield,Ar=R.unstable_requestPaint,nr=R.unstable_now,Kr=R.unstable_getCurrentPriorityLevel,Br=R.unstable_ImmediatePriority,Ei=R.unstable_UserBlockingPriority,oi=R.unstable_NormalPriority,ga=R.unstable_LowPriority,na=R.unstable_IdlePriority,Za=R.log,Ta=R.unstable_setDisableYieldValue,qi=null,gr=null;function Mi(n){if(typeof Za=="function"&&Ta(n),gr&&typeof gr.setStrictMode=="function")try{gr.setStrictMode(qi,n)}catch{}}var ge=Math.clz32?Math.clz32:$,j=Math.log,V=Math.LN2;function $(n){return n>>>=0,n===0?32:31-(j(n)/V|0)|0}var oe=256,he=4194304;function ye(n){var o=n&42;if(o!==0)return o;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Me(n,o,u){var p=n.pendingLanes;if(p===0)return 0;var x=0,C=n.suspendedLanes,O=n.pingedLanes;n=n.warmLanes;var H=p&134217727;return H!==0?(p=H&~C,p!==0?x=ye(p):(O&=H,O!==0?x=ye(O):u||(u=H&~n,u!==0&&(x=ye(u))))):(H=p&~C,H!==0?x=ye(H):O!==0?x=ye(O):u||(u=p&~n,u!==0&&(x=ye(u)))),x===0?0:o!==0&&o!==x&&(o&C)===0&&(C=x&-x,u=o&-o,C>=u||C===32&&(u&4194048)!==0)?o:x}function ve(n,o){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&o)===0}function Ne(n,o){switch(n){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var n=oe;return oe<<=1,(oe&4194048)===0&&(oe=256),n}function qe(){var n=he;return he<<=1,(he&62914560)===0&&(he=4194304),n}function bt(n){for(var o=[],u=0;31>u;u++)o.push(n);return o}function xe(n,o){n.pendingLanes|=o,o!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Wt(n,o,u,p,x,C){var O=n.pendingLanes;n.pendingLanes=u,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=u,n.entangledLanes&=u,n.errorRecoveryDisabledLanes&=u,n.shellSuspendCounter=0;var H=n.entanglements,de=n.expirationTimes,De=n.hiddenUpdates;for(u=O&~u;0<u;){var Xe=31-ge(u),Je=1<<Xe;H[Xe]=0,de[Xe]=-1;var Oe=De[Xe];if(Oe!==null)for(De[Xe]=null,Xe=0;Xe<Oe.length;Xe++){var Fe=Oe[Xe];Fe!==null&&(Fe.lane&=-536870913)}u&=~Je}p!==0&&hn(n,p,0),C!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=C&~(O&~o))}function hn(n,o,u){n.pendingLanes|=o,n.suspendedLanes&=~o;var p=31-ge(o);n.entangledLanes|=o,n.entanglements[p]=n.entanglements[p]|1073741824|u&4194090}function Mt(n,o){var u=n.entangledLanes|=o;for(n=n.entanglements;u;){var p=31-ge(u),x=1<<p;x&o|n[p]&o&&(n[p]|=o),u&=~x}}function Ht(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function zn(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Fr(){var n=ht.p;return n!==0?n:(n=window.event,n===void 0?32:ft(n.type))}function Vr(n,o){var u=ht.p;try{return ht.p=n,o()}finally{ht.p=u}}var Vn=Math.random().toString(36).slice(2),Nt="__reactFiber$"+Vn,$t="__reactProps$"+Vn,lr="__reactContainer$"+Vn,it="__reactEvents$"+Vn,yi="__reactListeners$"+Vn,yr="__reactHandles$"+Vn,fo="__reactResources$"+Vn,qa="__reactMarker$"+Vn;function pt(n){delete n[Nt],delete n[$t],delete n[it],delete n[yi],delete n[yr]}function rn(n){var o=n[Nt];if(o)return o;for(var u=n.parentNode;u;){if(o=u[lr]||u[Nt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(n=Tf(n);n!==null;){if(u=n[Nt])return u;n=Tf(n)}return o}n=u,u=n.parentNode}return null}function Qt(n){if(n=n[Nt]||n[lr]){var o=n.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return n}return null}function Er(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n.stateNode;throw Error(k(33))}function ya(n){var o=n[fo];return o||(o=n[fo]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function ur(n){n[qa]=!0}var an=new Set,Vl={};function Hi(n,o){po(n,o),po(n+"Capture",o)}function po(n,o){for(Vl[n]=o,n=0;n<o.length;n++)an.add(o[n])}var Ha=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ls={},_r={};function Lu(n){return vt.call(_r,n)?!0:vt.call(ls,n)?!1:Ha.test(n)?_r[n]=!0:(ls[n]=!0,!1)}function si(n,o,u){if(Lu(o))if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":n.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){n.removeAttribute(o);return}}n.setAttribute(o,""+u)}}function In(n,o,u){if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttribute(o,""+u)}}function $a(n,o,u,p){if(p===null)n.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(u);return}n.setAttributeNS(o,u,""+p)}}var us,ku;function ra(n){if(us===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);us=o&&o[1]||"",ku=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+us+n+ku}var Xa=!1;function Gl(n,o){if(!n||Xa)return"";Xa=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var Je=function(){throw Error()};if(Object.defineProperty(Je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Je,[])}catch(Fe){var Oe=Fe}Reflect.construct(n,[],Je)}else{try{Je.call()}catch(Fe){Oe=Fe}n.call(Je.prototype)}}else{try{throw Error()}catch(Fe){Oe=Fe}(Je=n())&&typeof Je.catch=="function"&&Je.catch(function(){})}}catch(Fe){if(Fe&&Oe&&typeof Fe.stack=="string")return[Fe.stack,Oe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=p.DetermineComponentFrameRoot(),O=C[0],H=C[1];if(O&&H){var de=O.split(`
`),De=H.split(`
`);for(x=p=0;p<de.length&&!de[p].includes("DetermineComponentFrameRoot");)p++;for(;x<De.length&&!De[x].includes("DetermineComponentFrameRoot");)x++;if(p===de.length||x===De.length)for(p=de.length-1,x=De.length-1;1<=p&&0<=x&&de[p]!==De[x];)x--;for(;1<=p&&0<=x;p--,x--)if(de[p]!==De[x]){if(p!==1||x!==1)do if(p--,x--,0>x||de[p]!==De[x]){var Xe=`
`+de[p].replace(" at new "," at ");return n.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",n.displayName)),Xe}while(1<=p&&0<=x);break}}}finally{Xa=!1,Error.prepareStackTrace=u}return(u=n?n.displayName||n.name:"")?ra(u):""}function Ih(n){switch(n.tag){case 26:case 27:case 5:return ra(n.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 15:return Gl(n.type,!1);case 11:return Gl(n.type.render,!1);case 1:return Gl(n.type,!0);case 31:return ra("Activity");default:return""}}function Tc(n){try{var o="";do o+=Ih(n),n=n.return;while(n);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function li(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ac(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function wd(n){var o=Ac(n)?"checked":"value",u=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),p=""+n[o];if(!n.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var x=u.get,C=u.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return x.call(this)},set:function(O){p=""+O,C.call(this,O)}}),Object.defineProperty(n,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(O){p=""+O},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Ou(n){n._valueTracker||(n._valueTracker=wd(n))}function Lh(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return n&&(p=Ac(n)?n.checked?"true":"false":n.value),n=p,n!==u?(o.setValue(n),!0):!1}function el(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var tl=/[\n"\\]/g;function $i(n){return n.replace(tl,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Wl(n,o,u,p,x,C,O,H){n.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.type=O:n.removeAttribute("type"),o!=null?O==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+li(o)):n.value!==""+li(o)&&(n.value=""+li(o)):O!=="submit"&&O!=="reset"||n.removeAttribute("value"),o!=null?Zl(n,O,li(o)):u!=null?Zl(n,O,li(u)):p!=null&&n.removeAttribute("value"),x==null&&C!=null&&(n.defaultChecked=!!C),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?n.name=""+li(H):n.removeAttribute("name")}function cs(n,o,u,p,x,C,O,H){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(n.type=C),o!=null||u!=null){if(!(C!=="submit"&&C!=="reset"||o!=null))return;u=u!=null?""+li(u):"",o=o!=null?""+li(o):u,H||o===n.value||(n.value=o),n.defaultValue=o}p=p??x,p=typeof p!="function"&&typeof p!="symbol"&&!!p,n.checked=H?n.checked:!!p,n.defaultChecked=!!p,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(n.name=O)}function Zl(n,o,u){o==="number"&&el(n.ownerDocument)===n||n.defaultValue===""+u||(n.defaultValue=""+u)}function No(n,o,u,p){if(n=n.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<n.length;u++)x=o.hasOwnProperty("$"+n[u].value),n[u].selected!==x&&(n[u].selected=x),x&&p&&(n[u].defaultSelected=!0)}else{for(u=""+li(u),o=null,x=0;x<n.length;x++){if(n[x].value===u){n[x].selected=!0,p&&(n[x].defaultSelected=!0);return}o!==null||n[x].disabled||(o=n[x])}o!==null&&(o.selected=!0)}}function kh(n,o,u){if(o!=null&&(o=""+li(o),o!==n.value&&(n.value=o),u==null)){n.defaultValue!==o&&(n.defaultValue=o);return}n.defaultValue=u!=null?""+li(u):""}function hs(n,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(k(92));if(mn(p)){if(1<p.length)throw Error(k(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=li(o),n.defaultValue=u,p=n.textContent,p===u&&p!==""&&p!==null&&(n.value=p)}function Ya(n,o){if(o){var u=n.firstChild;if(u&&u===n.lastChild&&u.nodeType===3){u.nodeValue=o;return}}n.textContent=o}var Aa=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function dn(n,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?n.setProperty(o,""):o==="float"?n.cssFloat="":n[o]="":p?n.setProperty(o,u):typeof u!="number"||u===0||Aa.has(o)?o==="float"?n.cssFloat=u:n[o]=(""+u).trim():n[o]=u+"px"}function Uo(n,o,u){if(o!=null&&typeof o!="object")throw Error(k(62));if(n=n.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?n.setProperty(p,""):p==="float"?n.cssFloat="":n[p]="");for(var x in o)p=o[x],o.hasOwnProperty(x)&&u[x]!==p&&dn(n,x,p)}else for(var C in o)o.hasOwnProperty(C)&&dn(n,C,o[C])}function Ka(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ds=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cn(n){return ds.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var go=null;function nl(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var yo=null,Nr=null;function Gr(n){var o=Qt(n);if(o&&(n=o.stateNode)){var u=n[$t]||null;e:switch(n=o.stateNode,o.type){case"input":if(Wl(n,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=n;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+$i(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==n&&p.form===n.form){var x=p[$t]||null;if(!x)throw Error(k(90));Wl(p,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===n.form&&Lh(p)}break e;case"textarea":kh(n,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&No(n,!!u.multiple,o,!1)}}}var ui=!1;function Mr(n,o,u){if(ui)return n(o,u);ui=!0;try{var p=n(o);return p}finally{if(ui=!1,(yo!==null||Nr!==null)&&(mh(),yo&&(o=yo,n=Nr,Nr=yo=null,Gr(o),n)))for(o=0;o<n.length;o++)Gr(n[o])}}function Rn(n,o){var u=n.stateNode;if(u===null)return null;var p=u[$t]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(u&&typeof u!="function")throw Error(k(231,o,typeof u));return u}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ci=!1;if(Qa)try{var hi={};Object.defineProperty(hi,"passive",{get:function(){ci=!0}}),window.addEventListener("test",hi,hi),window.removeEventListener("test",hi,hi)}catch{ci=!1}var vr=null,Gn=null,Ja=null;function Ft(){if(Ja)return Ja;var n,o=Gn,u=o.length,p,x="value"in vr?vr.value:vr.textContent,C=x.length;for(n=0;n<u&&o[n]===x[n];n++);var O=u-n;for(p=1;p<=O&&o[u-p]===x[C-p];p++);return Ja=x.slice(n,1<p?1-p:void 0)}function Xt(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function _a(){return!0}function _n(){return!1}function rr(n){function o(u,p,x,C,O){this._reactName=u,this._targetInst=x,this.type=p,this.nativeEvent=C,this.target=O,this.currentTarget=null;for(var H in n)n.hasOwnProperty(H)&&(u=n[H],this[H]=u?u(C):C[H]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?_a:_n,this.isPropagationStopped=_n,this}return Se(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=_a)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=_a)},persist:function(){},isPersistent:_a}),o}var _i={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ia=rr(_i),jo=Se({},_i,{view:0,detail:0}),Ec=rr(jo),Vo,fs,Go,ps=Se({},jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ys,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Go&&(Go&&n.type==="mousemove"?(Vo=n.screenX-Go.screenX,fs=n.screenY-Go.screenY):fs=Vo=0,Go=n),Vo)},movementY:function(n){return"movementY"in n?n.movementY:fs}}),ql=rr(ps),Ea=Se({},ps,{dataTransfer:0}),Qr=rr(Ea),rl=Se({},jo,{relatedTarget:0}),ms=rr(rl),gs=Se({},_i,{animationName:0,elapsedTime:0,pseudoElement:0}),wr=rr(gs),Oh=Se({},_i,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Hl=rr(Oh),Mc=Se({},_i,{data:0}),Bh=rr(Mc),il={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},di={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$l={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eo(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=$l[n])?!!o[n]:!1}function ys(){return eo}var Xl=Se({},jo,{key:function(n){if(n.key){var o=il[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Xt(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?di[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ys,charCode:function(n){return n.type==="keypress"?Xt(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Xt(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Yl=rr(Xl),vi=Se({},ps,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rc=rr(vi),Bu=Se({},jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ys}),Sd=rr(Bu),Dc=Se({},_i,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pd=rr(Dc),Cd=Se({},ps,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fu=rr(Cd),zc=Se({},_i,{newState:0,oldState:0}),_s=rr(zc),Ic=[9,13,27,32],al=Qa&&"CompositionEvent"in window,Ri=null;Qa&&"documentMode"in document&&(Ri=document.documentMode);var Td=Qa&&"TextEvent"in window&&!Ri,Kl=Qa&&(!al||Ri&&8<Ri&&11>=Ri),ol=" ",sl=!1;function Fh(n,o){switch(n){case"keyup":return Ic.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ql(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ll=!1;function vs(n,o){switch(n){case"compositionend":return Ql(o);case"keypress":return o.which!==32?null:(sl=!0,ol);case"textInput":return n=o.data,n===ol&&sl?null:n;default:return null}}function Nh(n,o){if(ll)return n==="compositionend"||!al&&Fh(n,o)?(n=Ft(),Ja=Gn=vr=null,ll=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Kl&&o.locale!=="ko"?null:o.data;default:return null}}var Lc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Uh(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!Lc[n.type]:o==="textarea"}function kc(n,o,u,p){yo?Nr?Nr.push(p):Nr=[p]:yo=p,o=hd(o,"onChange"),0<o.length&&(u=new ia("onChange","change",null,u,p),n.push({event:u,listeners:o}))}var xs=null,ul=null;function Nu(n){yf(n,0)}function Jl(n){var o=Er(n);if(Lh(o))return n}function Oc(n,o){if(n==="change")return o}var Wo=!1;if(Qa){var eu;if(Qa){var tu="oninput"in document;if(!tu){var cl=document.createElement("div");cl.setAttribute("oninput","return;"),tu=typeof cl.oninput=="function"}eu=tu}else eu=!1;Wo=eu&&(!document.documentMode||9<document.documentMode)}function jh(){xs&&(xs.detachEvent("onpropertychange",hl),ul=xs=null)}function hl(n){if(n.propertyName==="value"&&Jl(ul)){var o=[];kc(o,ul,n,nl(n)),Mr(Nu,o)}}function Vh(n,o,u){n==="focusin"?(jh(),xs=o,ul=u,xs.attachEvent("onpropertychange",hl)):n==="focusout"&&jh()}function Ad(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Jl(ul)}function Gh(n,o){if(n==="click")return Jl(o)}function Wh(n,o){if(n==="input"||n==="change")return Jl(o)}function Bc(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Di=typeof Object.is=="function"?Object.is:Bc;function dl(n,o){if(Di(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var u=Object.keys(n),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var x=u[p];if(!vt.call(o,x)||!Di(n[x],o[x]))return!1}return!0}function nu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function to(n,o){var u=nu(n);n=0;for(var p;u;){if(u.nodeType===3){if(p=n+u.textContent.length,n<=o&&p>=o)return{node:u,offset:o-n};n=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=nu(u)}}function Sn(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Sn(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Uu(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var o=el(n.document);o instanceof n.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)n=o.contentWindow;else break;o=el(n.document)}return o}function ru(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}var Zh=Qa&&"documentMode"in document&&11>=document.documentMode,Zo=null,_o=null,bs=null,Fc=!1;function qh(n,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Fc||Zo==null||Zo!==el(p)||(p=Zo,"selectionStart"in p&&ru(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),bs&&dl(bs,p)||(bs=p,p=hd(_o,"onSelect"),0<p.length&&(o=new ia("onSelect","select",null,o,u),n.push({event:o,listeners:p}),o.target=Zo)))}function ws(n,o){var u={};return u[n.toLowerCase()]=o.toLowerCase(),u["Webkit"+n]="webkit"+o,u["Moz"+n]="moz"+o,u}var fl={animationend:ws("Animation","AnimationEnd"),animationiteration:ws("Animation","AnimationIteration"),animationstart:ws("Animation","AnimationStart"),transitionrun:ws("Transition","TransitionRun"),transitionstart:ws("Transition","TransitionStart"),transitioncancel:ws("Transition","TransitionCancel"),transitionend:ws("Transition","TransitionEnd")},ju={},Hh={};Qa&&(Hh=document.createElement("div").style,"AnimationEvent"in window||(delete fl.animationend.animation,delete fl.animationiteration.animation,delete fl.animationstart.animation),"TransitionEvent"in window||delete fl.transitionend.transition);function qo(n){if(ju[n])return ju[n];if(!fl[n])return n;var o=fl[n],u;for(u in o)if(o.hasOwnProperty(u)&&u in Hh)return ju[n]=o[u];return n}var iu=qo("animationend"),au=qo("animationiteration"),ou=qo("animationstart"),Nc=qo("transitionrun"),Ss=qo("transitionstart"),su=qo("transitioncancel"),Ps=qo("transitionend"),aa=new Map,Vu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vu.push("scrollEnd");function va(n,o){aa.set(n,o),Hi(o,[n])}var Gu=new WeakMap;function Jr(n,o){if(typeof n=="object"&&n!==null){var u=Gu.get(n);return u!==void 0?u:(o={value:n,source:o,stack:Tc(o)},Gu.set(n,o),o)}return{value:n,source:o,stack:Tc(o)}}var zi=[],vo=0,Cs=0;function Ts(){for(var n=vo,o=Cs=vo=0;o<n;){var u=zi[o];zi[o++]=null;var p=zi[o];zi[o++]=null;var x=zi[o];zi[o++]=null;var C=zi[o];if(zi[o++]=null,p!==null&&x!==null){var O=p.pending;O===null?x.next=x:(x.next=O.next,O.next=x),p.pending=x}C!==0&&Uc(u,x,C)}}function lu(n,o,u,p){zi[vo++]=n,zi[vo++]=o,zi[vo++]=u,zi[vo++]=p,Cs|=p,n.lanes|=p,n=n.alternate,n!==null&&(n.lanes|=p)}function Ho(n,o,u,p){return lu(n,o,u,p),pl(n)}function oa(n,o){return lu(n,null,null,o),pl(n)}function Uc(n,o,u){n.lanes|=u;var p=n.alternate;p!==null&&(p.lanes|=u);for(var x=!1,C=n.return;C!==null;)C.childLanes|=u,p=C.alternate,p!==null&&(p.childLanes|=u),C.tag===22&&(n=C.stateNode,n===null||n._visibility&1||(x=!0)),n=C,C=C.return;return n.tag===3?(C=n.stateNode,x&&o!==null&&(x=31-ge(u),n=C.hiddenUpdates,p=n[x],p===null?n[x]=[o]:p.push(o),o.lane=u|536870912),C):null}function pl(n){if(50<ph)throw ph=0,Qd=null,Error(k(185));for(var o=n.return;o!==null;)n=o,o=n.return;return n.tag===3?n.stateNode:null}var sn={};function uu(n,o,u,p){this.tag=n,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sa(n,o,u,p){return new uu(n,o,u,p)}function Wu(n){return n=n.prototype,!(!n||!n.isReactComponent)}function xi(n,o){var u=n.alternate;return u===null?(u=sa(n.tag,o,n.key,n.mode),u.elementType=n.elementType,u.type=n.type,u.stateNode=n.stateNode,u.alternate=n,n.alternate=u):(u.pendingProps=o,u.type=n.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=n.flags&65011712,u.childLanes=n.childLanes,u.lanes=n.lanes,u.child=n.child,u.memoizedProps=n.memoizedProps,u.memoizedState=n.memoizedState,u.updateQueue=n.updateQueue,o=n.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=n.sibling,u.index=n.index,u.ref=n.ref,u.refCleanup=n.refCleanup,u}function jc(n,o){n.flags&=65011714;var u=n.alternate;return u===null?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=u.childLanes,n.lanes=u.lanes,n.child=u.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=u.memoizedProps,n.memoizedState=u.memoizedState,n.updateQueue=u.updateQueue,n.type=u.type,o=u.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),n}function Zu(n,o,u,p,x,C){var O=0;if(p=n,typeof n=="function")Wu(n)&&(O=1);else if(typeof n=="string")O=t(n,u,yt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case Gt:return n=sa(31,u,o,x),n.elementType=Gt,n.lanes=C,n;case je:return $o(u.children,x,C,o);case Ge:O=8,x|=24;break;case Ye:return n=sa(12,u,o,x|2),n.elementType=Ye,n.lanes=C,n;case xt:return n=sa(13,u,o,x),n.elementType=xt,n.lanes=C,n;case Tt:return n=sa(19,u,o,x),n.elementType=Tt,n.lanes=C,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case We:case nt:O=10;break e;case He:O=9;break e;case wt:O=11;break e;case It:O=14;break e;case ut:O=16,p=null;break e}O=29,u=Error(k(130,n===null?"null":typeof n,"")),p=null}return o=sa(O,u,o,x),o.elementType=n,o.type=p,o.lanes=C,o}function $o(n,o,u,p){return n=sa(7,n,p,o),n.lanes=u,n}function Vc(n,o,u){return n=sa(6,n,null,o),n.lanes=u,n}function cu(n,o,u){return o=sa(4,n.children!==null?n.children:[],n.key,o),o.lanes=u,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}var xo=[],no=0,Xo=null,ml=0,la=[],bi=0,Ma=null,ua=1,Ii="";function Ra(n,o){xo[no++]=ml,xo[no++]=Xo,Xo=n,ml=o}function qu(n,o,u){la[bi++]=ua,la[bi++]=Ii,la[bi++]=Ma,Ma=n;var p=ua;n=Ii;var x=32-ge(p)-1;p&=~(1<<x),u+=1;var C=32-ge(o)+x;if(30<C){var O=x-x%5;C=(p&(1<<O)-1).toString(32),p>>=O,x-=O,ua=1<<32-ge(o)+x|u<<x|p,Ii=C+n}else ua=1<<C|u<<x|p,Ii=n}function bo(n){n.return!==null&&(Ra(n,1),qu(n,1,0))}function hu(n){for(;n===Xo;)Xo=xo[--no],xo[no]=null,ml=xo[--no],xo[no]=null;for(;n===Ma;)Ma=la[--bi],la[bi]=null,Ii=la[--bi],la[bi]=null,ua=la[--bi],la[bi]=null}var Wr=null,cr=null,Mn=!1,Yo=null,Da=!1,gl=Error(k(519));function wo(n){var o=Error(k(418,""));throw Ko(Jr(o,n)),gl}function Gc(n){var o=n.stateNode,u=n.type,p=n.memoizedProps;switch(o[Nt]=n,o[$t]=p,u){case"dialog":Cn("cancel",o),Cn("close",o);break;case"iframe":case"object":case"embed":Cn("load",o);break;case"video":case"audio":for(u=0;u<_c.length;u++)Cn(_c[u],o);break;case"source":Cn("error",o);break;case"img":case"image":case"link":Cn("error",o),Cn("load",o);break;case"details":Cn("toggle",o);break;case"input":Cn("invalid",o),cs(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),Ou(o);break;case"select":Cn("invalid",o);break;case"textarea":Cn("invalid",o),hs(o,p.value,p.defaultValue,p.children),Ou(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||wf(o.textContent,u)?(p.popover!=null&&(Cn("beforetoggle",o),Cn("toggle",o)),p.onScroll!=null&&Cn("scroll",o),p.onScrollEnd!=null&&Cn("scrollend",o),p.onClick!=null&&(o.onclick=wh),o=!0):o=!1,o||wo(n)}function Hu(n){for(Wr=n.return;Wr;)switch(Wr.tag){case 5:case 13:Da=!1;return;case 27:case 3:Da=!0;return;default:Wr=Wr.return}}function Bn(n){if(n!==Wr)return!1;if(!Mn)return Hu(n),Mn=!0,!1;var o=n.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=n.type,u=!(u!=="form"&&u!=="button")||Hs(n.type,n.memoizedProps)),u=!u),u&&cr&&wo(n),Hu(n),o===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(k(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8)if(u=n.data,u==="/$"){if(o===0){cr=ho(n.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;n=n.nextSibling}cr=null}}else o===27?(o=cr,$s(n.type)?(n=xc,xc=null,cr=n):cr=o):cr=Wr?ho(n.stateNode.nextSibling):null;return!0}function za(){cr=Wr=null,Mn=!1}function Xi(){var n=Yo;return n!==null&&(ha===null?ha=n:ha.push.apply(ha,n),Yo=null),n}function Ko(n){Yo===null?Yo=[n]:Yo.push(n)}var yl=Ze(null),So=null,Li=null;function Yi(n,o,u){rt(yl,o._currentValue),o._currentValue=u}function ca(n){n._currentValue=yl.current,gt(yl)}function du(n,o,u){for(;n!==null;){var p=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),n===u)break;n=n.return}}function $u(n,o,u,p){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var C=x.dependencies;if(C!==null){var O=x.child;C=C.firstContext;e:for(;C!==null;){var H=C;C=x;for(var de=0;de<o.length;de++)if(H.context===o[de]){C.lanes|=u,H=C.alternate,H!==null&&(H.lanes|=u),du(C.return,u,n),p||(O=null);break e}C=H.next}}else if(x.tag===18){if(O=x.return,O===null)throw Error(k(341));O.lanes|=u,C=O.alternate,C!==null&&(C.lanes|=u),du(O,u,n),O=null}else O=x.child;if(O!==null)O.return=x;else for(O=x;O!==null;){if(O===n){O=null;break}if(x=O.sibling,x!==null){x.return=O.return,O=x;break}O=O.return}x=O}}function _l(n,o,u,p){n=null;for(var x=o,C=!1;x!==null;){if(!C){if((x.flags&524288)!==0)C=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var O=x.alternate;if(O===null)throw Error(k(387));if(O=O.memoizedProps,O!==null){var H=x.type;Di(x.pendingProps.value,O.value)||(n!==null?n.push(H):n=[H])}}else if(x===Zt.current){if(O=x.alternate,O===null)throw Error(k(387));O.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(D):n=[D])}x=x.return}n!==null&&$u(o,n,u,p),o.flags|=262144}function fu(n){for(n=n.firstContext;n!==null;){if(!Di(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Qo(n){So=n,Li=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Rr(n){return ki(So,n)}function Ki(n,o){return So===null&&Qo(n),ki(n,o)}function ki(n,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Li===null){if(n===null)throw Error(k(308));Li=o,n.dependencies={lanes:0,firstContext:o},n.flags|=524288}else Li=Li.next=o;return u}var vl=typeof AbortController<"u"?AbortController:function(){var n=[],o=this.signal={aborted:!1,addEventListener:function(u,p){n.push(p)}};this.abort=function(){o.aborted=!0,n.forEach(function(u){return u()})}},Wc=R.unstable_scheduleCallback,$h=R.unstable_NormalPriority,Ur={$$typeof:nt,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jo(){return{controller:new vl,data:new Map,refCount:0}}function As(n){n.refCount--,n.refCount===0&&Wc($h,function(){n.controller.abort()})}var es=null,xl=0,Po=0,fi=null;function Oi(n,o){if(es===null){var u=es=[];xl=0,Po=vh(),fi={status:"pending",value:void 0,then:function(p){u.push(p)}}}return xl++,o.then(Zc,Zc),o}function Zc(){if(--xl===0&&es!==null){fi!==null&&(fi.status="fulfilled");var n=es;es=null,Po=0,fi=null;for(var o=0;o<n.length;o++)(0,n[o])()}}function Ia(n,o){var u=[],p={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return n.then(function(){p.status="fulfilled",p.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(p.status="rejected",p.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),p}var Es=Ue.S;Ue.S=function(n,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Oi(n,o),Es!==null&&Es(n,o)};var La=Ze(null);function qc(){var n=La.current;return n!==null?n:or.pooledCache}function Xu(n,o){o===null?rt(La,La.current):rt(La,o.pool)}function pu(){var n=qc();return n===null?null:{parent:Ur._currentValue,pool:n}}var bl=Error(k(460)),ts=Error(k(474)),Bi=Error(k(542)),_t={then:function(){}};function Yu(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Ms(){}function Ku(n,o,u){switch(u=n[u],u===void 0?n.push(o):u!==o&&(o.then(Ms,Ms),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,Qu(n),n;default:if(typeof o.status=="string")o.then(Ms,Ms);else{if(n=or,n!==null&&100<n.shellSuspendCounter)throw Error(k(482));n=o,n.status="pending",n.then(function(p){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=p}},function(p){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,Qu(n),n}throw ka=o,bl}}var ka=null;function Rs(){if(ka===null)throw Error(k(459));var n=ka;return ka=null,n}function Qu(n){if(n===bl||n===Bi)throw Error(k(483))}var en=!1;function mu(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ju(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function ro(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Co(n,o,u){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,(Xn&2)!==0){var x=p.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),p.pending=o,o=pl(n),Uc(n,null,u),o}return lu(n,p,o,u),pl(n)}function wl(n,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=n.pendingLanes,u|=p,o.lanes=u,Mt(n,u)}}function ec(n,o){var u=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var x=null,C=null;if(u=u.firstBaseUpdate,u!==null){do{var O={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};C===null?x=C=O:C=C.next=O,u=u.next}while(u!==null);C===null?x=C=o:C=C.next=o}else x=C=o;u={baseState:p.baseState,firstBaseUpdate:x,lastBaseUpdate:C,shared:p.shared,callbacks:p.callbacks},n.updateQueue=u;return}n=u.lastBaseUpdate,n===null?u.firstBaseUpdate=o:n.next=o,u.lastBaseUpdate=o}var gu=!1;function Ds(){if(gu){var n=fi;if(n!==null)throw n}}function Sl(n,o,u,p){gu=!1;var x=n.updateQueue;en=!1;var C=x.firstBaseUpdate,O=x.lastBaseUpdate,H=x.shared.pending;if(H!==null){x.shared.pending=null;var de=H,De=de.next;de.next=null,O===null?C=De:O.next=De,O=de;var Xe=n.alternate;Xe!==null&&(Xe=Xe.updateQueue,H=Xe.lastBaseUpdate,H!==O&&(H===null?Xe.firstBaseUpdate=De:H.next=De,Xe.lastBaseUpdate=de))}if(C!==null){var Je=x.baseState;O=0,Xe=De=de=null,H=C;do{var Oe=H.lane&-536870913,Fe=Oe!==H.lane;if(Fe?(An&Oe)===Oe:(p&Oe)===Oe){Oe!==0&&Oe===Po&&(gu=!0),Xe!==null&&(Xe=Xe.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var tn=n,Yt=H;Oe=o;var Jn=u;switch(Yt.tag){case 1:if(tn=Yt.payload,typeof tn=="function"){Je=tn.call(Jn,Je,Oe);break e}Je=tn;break e;case 3:tn.flags=tn.flags&-65537|128;case 0:if(tn=Yt.payload,Oe=typeof tn=="function"?tn.call(Jn,Je,Oe):tn,Oe==null)break e;Je=Se({},Je,Oe);break e;case 2:en=!0}}Oe=H.callback,Oe!==null&&(n.flags|=64,Fe&&(n.flags|=8192),Fe=x.callbacks,Fe===null?x.callbacks=[Oe]:Fe.push(Oe))}else Fe={lane:Oe,tag:H.tag,payload:H.payload,callback:H.callback,next:null},Xe===null?(De=Xe=Fe,de=Je):Xe=Xe.next=Fe,O|=Oe;if(H=H.next,H===null){if(H=x.shared.pending,H===null)break;Fe=H,H=Fe.next,Fe.next=null,x.lastBaseUpdate=Fe,x.shared.pending=null}}while(!0);Xe===null&&(de=Je),x.baseState=de,x.firstBaseUpdate=De,x.lastBaseUpdate=Xe,C===null&&(x.shared.lanes=0),Vs|=O,n.lanes=O,n.memoizedState=Je}}function tc(n,o){if(typeof n!="function")throw Error(k(191,n));n.call(o)}function Hc(n,o){var u=n.callbacks;if(u!==null)for(n.callbacks=null,n=0;n<u.length;n++)tc(u[n],o)}var To=Ze(null),Oa=Ze(0);function Ln(n,o){n=js,rt(Oa,n),rt(To,o),js=n|o.baseLanes}function $c(){rt(Oa,js),rt(To,To.current)}function Pl(){js=Oa.current,gt(To),gt(Oa)}var Ba=0,fn=null,kn=null,Dr=null,nc=!1,Fi=!1,io=!1,St=0,zt=0,Ao=null,Xc=0;function fr(){throw Error(k(321))}function ei(n,o){if(o===null)return!1;for(var u=0;u<o.length&&u<n.length;u++)if(!Di(n[u],o[u]))return!1;return!0}function rc(n,o,u,p,x,C){return Ba=C,fn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ue.H=n===null||n.memoizedState===null?ao:oo,io=!1,C=u(p,x),io=!1,Fi&&(C=ns(o,u,p,x)),xa(n),C}function xa(n){Ue.H=ni;var o=kn!==null&&kn.next!==null;if(Ba=0,Dr=kn=fn=null,nc=!1,zt=0,Ao=null,o)throw Error(k(300));n===null||Ir||(n=n.dependencies,n!==null&&fu(n)&&(Ir=!0))}function ns(n,o,u,p){fn=n;var x=0;do{if(Fi&&(Ao=null),zt=0,Fi=!1,25<=x)throw Error(k(301));if(x+=1,Dr=kn=null,n.updateQueue!=null){var C=n.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}Ue.H=as,C=o(u,p)}while(Fi);return C}function Cl(){var n=Ue.H,o=n.useState()[0];return o=typeof o.then=="function"?zs(o):o,n=n.useState()[0],(kn!==null?kn.memoizedState:null)!==n&&(fn.flags|=1024),o}function Hn(){var n=St!==0;return St=0,n}function pr(n,o,u){o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~u}function Tl(n){if(nc){for(n=n.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}nc=!1}Ba=0,Dr=kn=fn=null,Fi=!1,zt=St=0,Ao=null}function ti(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?fn.memoizedState=Dr=n:Dr=Dr.next=n,Dr}function ir(){if(kn===null){var n=fn.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var o=Dr===null?fn.memoizedState:Dr.next;if(o!==null)Dr=o,kn=n;else{if(n===null)throw fn.alternate===null?Error(k(467)):Error(k(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Dr===null?fn.memoizedState=Dr=n:Dr=Dr.next=n}return Dr}function Eo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zs(n){var o=zt;return zt+=1,Ao===null&&(Ao=[]),n=Ku(Ao,n,o),o=fn,(Dr===null?o.memoizedState:Dr.next)===null&&(o=o.alternate,Ue.H=o===null||o.memoizedState===null?ao:oo),n}function Is(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return zs(n);if(n.$$typeof===nt)return Rr(n)}throw Error(k(438,String(n)))}function Fa(n){var o=null,u=fn.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=fn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Eo(),fn.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(n),p=0;p<n;p++)u[p]=pn;return o.index++,u}function Na(n,o){return typeof o=="function"?o(n):o}function Al(n){var o=ir();return El(o,kn,n)}function El(n,o,u){var p=n.queue;if(p===null)throw Error(k(311));p.lastRenderedReducer=u;var x=n.baseQueue,C=p.pending;if(C!==null){if(x!==null){var O=x.next;x.next=C.next,C.next=O}o.baseQueue=x=C,p.pending=null}if(C=n.baseState,x===null)n.memoizedState=C;else{o=x.next;var H=O=null,de=null,De=o,Xe=!1;do{var Je=De.lane&-536870913;if(Je!==De.lane?(An&Je)===Je:(Ba&Je)===Je){var Oe=De.revertLane;if(Oe===0)de!==null&&(de=de.next={lane:0,revertLane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),Je===Po&&(Xe=!0);else if((Ba&Oe)===Oe){De=De.next,Oe===Po&&(Xe=!0);continue}else Je={lane:0,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},de===null?(H=de=Je,O=C):de=de.next=Je,fn.lanes|=Oe,Vs|=Oe;Je=De.action,io&&u(C,Je),C=De.hasEagerState?De.eagerState:u(C,Je)}else Oe={lane:Je,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},de===null?(H=de=Oe,O=C):de=de.next=Oe,fn.lanes|=Je,Vs|=Je;De=De.next}while(De!==null&&De!==o);if(de===null?O=C:de.next=H,!Di(C,n.memoizedState)&&(Ir=!0,Xe&&(u=fi,u!==null)))throw u;n.memoizedState=C,n.baseState=O,n.baseQueue=de,p.lastRenderedState=C}return x===null&&(p.lanes=0),[n.memoizedState,p.dispatch]}function yu(n){var o=ir(),u=o.queue;if(u===null)throw Error(k(311));u.lastRenderedReducer=n;var p=u.dispatch,x=u.pending,C=o.memoizedState;if(x!==null){u.pending=null;var O=x=x.next;do C=n(C,O.action),O=O.next;while(O!==x);Di(C,o.memoizedState)||(Ir=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),u.lastRenderedState=C}return[C,p]}function f(n,o,u){var p=fn,x=ir(),C=Mn;if(C){if(u===void 0)throw Error(k(407));u=u()}else u=o();var O=!Di((kn||x).memoizedState,u);O&&(x.memoizedState=u,Ir=!0),x=x.queue;var H=l.bind(null,p,x,n);if(_e(2048,8,H,[n]),x.getSnapshot!==o||O||Dr!==null&&Dr.memoizedState.tag&1){if(p.flags|=2048,ie(9,ce(),a.bind(null,p,x,u,o),null),or===null)throw Error(k(349));C||(Ba&124)!==0||e(p,o,u)}return u}function e(n,o,u){n.flags|=16384,n={getSnapshot:o,value:u},o=fn.updateQueue,o===null?(o=Eo(),fn.updateQueue=o,o.stores=[n]):(u=o.stores,u===null?o.stores=[n]:u.push(n))}function a(n,o,u,p){o.value=u,o.getSnapshot=p,d(o)&&g(n)}function l(n,o,u){return u(function(){d(o)&&g(n)})}function d(n){var o=n.getSnapshot;n=n.value;try{var u=o();return!Di(n,u)}catch{return!0}}function g(n){var o=oa(n,2);o!==null&&da(o,n,2)}function _(n){var o=ti();if(typeof n=="function"){var u=n;if(n=u(),io){Mi(!0);try{u()}finally{Mi(!1)}}}return o.memoizedState=o.baseState=n,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:n},o}function w(n,o,u,p){return n.baseState=u,El(n,kn,typeof p=="function"?p:Na)}function S(n,o,u,p,x){if(is(n))throw Error(k(485));if(n=o.action,n!==null){var C={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){C.listeners.push(O)}};Ue.T!==null?u(!0):C.isTransition=!1,p(C),u=o.pending,u===null?(C.next=o.pending=C,T(o,C)):(C.next=u.next,o.pending=u.next=C)}}function T(n,o){var u=o.action,p=o.payload,x=n.state;if(o.isTransition){var C=Ue.T,O={};Ue.T=O;try{var H=u(x,p),de=Ue.S;de!==null&&de(O,H),M(n,o,H)}catch(De){z(n,o,De)}finally{Ue.T=C}}else try{C=u(x,p),M(n,o,C)}catch(De){z(n,o,De)}}function M(n,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){I(n,o,p)},function(p){return z(n,o,p)}):I(n,o,u)}function I(n,o,u){o.status="fulfilled",o.value=u,B(o),n.state=u,o=n.pending,o!==null&&(u=o.next,u===o?n.pending=null:(u=u.next,o.next=u,T(n,u)))}function z(n,o,u){var p=n.pending;if(n.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,B(o),o=o.next;while(o!==p)}n.action=null}function B(n){n=n.listeners;for(var o=0;o<n.length;o++)(0,n[o])()}function W(n,o){return o}function Y(n,o){if(Mn){var u=or.formState;if(u!==null){e:{var p=fn;if(Mn){if(cr){t:{for(var x=cr,C=Da;x.nodeType!==8;){if(!C){x=null;break t}if(x=ho(x.nextSibling),x===null){x=null;break t}}C=x.data,x=C==="F!"||C==="F"?x:null}if(x){cr=ho(x.nextSibling),p=x.data==="F!";break e}}wo(p)}p=!1}p&&(o=u[0])}}return u=ti(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:W,lastRenderedState:o},u.queue=p,u=Mo.bind(null,fn,p),p.dispatch=u,p=_(!1),C=Ro.bind(null,fn,!1,p.queue),p=ti(),x={state:o,dispatch:null,action:n,pending:null},p.queue=x,u=S.bind(null,fn,x,C,u),x.dispatch=u,p.memoizedState=n,[o,u,!1]}function K(n){var o=ir();return J(o,kn,n)}function J(n,o,u){if(o=El(n,o,W)[0],n=Al(Na)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=zs(o)}catch(O){throw O===bl?Bi:O}else p=o;o=ir();var x=o.queue,C=x.dispatch;return u!==o.memoizedState&&(fn.flags|=2048,ie(9,ce(),re.bind(null,x,u),null)),[p,C,n]}function re(n,o){n.action=o}function se(n){var o=ir(),u=kn;if(u!==null)return J(o,u,n);ir(),o=o.memoizedState,u=ir();var p=u.queue.dispatch;return u.memoizedState=n,[o,p,!1]}function ie(n,o,u,p){return n={tag:n,create:u,deps:p,inst:o,next:null},o=fn.updateQueue,o===null&&(o=Eo(),fn.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=n.next=n:(p=u.next,u.next=n,n.next=p,o.lastEffect=n),n}function ce(){return{destroy:void 0,resource:void 0}}function pe(){return ir().memoizedState}function ae(n,o,u,p){var x=ti();p=p===void 0?null:p,fn.flags|=n,x.memoizedState=ie(1|o,ce(),u,p)}function _e(n,o,u,p){var x=ir();p=p===void 0?null:p;var C=x.memoizedState.inst;kn!==null&&p!==null&&ei(p,kn.memoizedState.deps)?x.memoizedState=ie(o,C,u,p):(fn.flags|=n,x.memoizedState=ie(1|o,C,u,p))}function Le(n,o){ae(8390656,8,n,o)}function Te(n,o){_e(2048,8,n,o)}function Ee(n,o){return _e(4,2,n,o)}function ke(n,o){return _e(4,4,n,o)}function ct(n,o){if(typeof o=="function"){n=n();var u=o(n);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function st(n,o,u){u=u!=null?u.concat([n]):null,_e(4,4,ct.bind(null,o,n),u)}function $e(){}function Pt(n,o){var u=ir();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&ei(o,p[1])?p[0]:(u.memoizedState=[n,o],n)}function ln(n,o){var u=ir();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&ei(o,p[1]))return p[0];if(p=n(),io){Mi(!0);try{n()}finally{Mi(!1)}}return u.memoizedState=[p,o],p}function Pn(n,o,u){return u===void 0||(Ba&1073741824)!==0?n.memoizedState=o:(n.memoizedState=u,n=qr(),fn.lanes|=n,Vs|=n,u)}function ar(n,o,u,p){return Di(u,o)?u:To.current!==null?(n=Pn(n,u,p),Di(n,o)||(Ir=!0),n):(Ba&42)===0?(Ir=!0,n.memoizedState=u):(n=qr(),fn.lanes|=n,Vs|=n,o)}function Fn(n,o,u,p,x){var C=ht.p;ht.p=C!==0&&8>C?C:8;var O=Ue.T,H={};Ue.T=H,Ro(n,!1,o,u);try{var de=x(),De=Ue.S;if(De!==null&&De(H,de),de!==null&&typeof de=="object"&&typeof de.then=="function"){var Xe=Ia(de,p);Ui(n,o,Xe,Wi(n))}else Ui(n,o,p,Wi(n))}catch(Je){Ui(n,o,{then:function(){},status:"rejected",reason:Je},Wi())}finally{ht.p=C,Ue.T=O}}function Nn(){}function $n(n,o,u,p){if(n.tag!==5)throw Error(k(476));var x=Wn(n).queue;Fn(n,x,o,tt,u===null?Nn:function(){return Un(n),u(p)})}function Wn(n){var o=n.memoizedState;if(o!==null)return o;o={memoizedState:tt,baseState:tt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:tt},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:u},next:null},n.memoizedState=o,n=n.alternate,n!==null&&(n.memoizedState=o),o}function Un(n){var o=Wn(n).next.queue;Ui(n,o,{},Wi())}function vn(){return Rr(D)}function jr(){return ir().memoizedState}function zr(){return ir().memoizedState}function Ni(n){for(var o=n.return;o!==null;){switch(o.tag){case 24:case 3:var u=Wi();n=ro(u);var p=Co(o,n,u);p!==null&&(da(p,o,u),wl(p,o,u)),o={cache:Jo()},n.payload=o;return}o=o.return}}function rs(n,o,u){var p=Wi();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},is(n)?_u(o,u):(u=Ho(n,o,u,p),u!==null&&(da(u,n,p),Do(u,o,p)))}function Mo(n,o,u){var p=Wi();Ui(n,o,u,p)}function Ui(n,o,u,p){var x={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(is(n))_u(o,x);else{var C=n.alternate;if(n.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var O=o.lastRenderedState,H=C(O,u);if(x.hasEagerState=!0,x.eagerState=H,Di(H,O))return lu(n,o,x,0),or===null&&Ts(),!1}catch{}finally{}if(u=Ho(n,o,x,p),u!==null)return da(u,n,p),Do(u,o,p),!0}return!1}function Ro(n,o,u,p){if(p={lane:2,revertLane:vh(),action:p,hasEagerState:!1,eagerState:null,next:null},is(n)){if(o)throw Error(k(479))}else o=Ho(n,u,p,2),o!==null&&da(o,n,2)}function is(n){var o=n.alternate;return n===fn||o!==null&&o===fn}function _u(n,o){Fi=nc=!0;var u=n.pending;u===null?o.next=o:(o.next=u.next,u.next=o),n.pending=o}function Do(n,o,u){if((u&4194048)!==0){var p=o.lanes;p&=n.pendingLanes,u|=p,o.lanes=u,Mt(n,u)}}var ni={readContext:Rr,use:Is,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useLayoutEffect:fr,useInsertionEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useSyncExternalStore:fr,useId:fr,useHostTransitionStatus:fr,useFormState:fr,useActionState:fr,useOptimistic:fr,useMemoCache:fr,useCacheRefresh:fr},ao={readContext:Rr,use:Is,useCallback:function(n,o){return ti().memoizedState=[n,o===void 0?null:o],n},useContext:Rr,useEffect:Le,useImperativeHandle:function(n,o,u){u=u!=null?u.concat([n]):null,ae(4194308,4,ct.bind(null,o,n),u)},useLayoutEffect:function(n,o){return ae(4194308,4,n,o)},useInsertionEffect:function(n,o){ae(4,2,n,o)},useMemo:function(n,o){var u=ti();o=o===void 0?null:o;var p=n();if(io){Mi(!0);try{n()}finally{Mi(!1)}}return u.memoizedState=[p,o],p},useReducer:function(n,o,u){var p=ti();if(u!==void 0){var x=u(o);if(io){Mi(!0);try{u(o)}finally{Mi(!1)}}}else x=o;return p.memoizedState=p.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},p.queue=n,n=n.dispatch=rs.bind(null,fn,n),[p.memoizedState,n]},useRef:function(n){var o=ti();return n={current:n},o.memoizedState=n},useState:function(n){n=_(n);var o=n.queue,u=Mo.bind(null,fn,o);return o.dispatch=u,[n.memoizedState,u]},useDebugValue:$e,useDeferredValue:function(n,o){var u=ti();return Pn(u,n,o)},useTransition:function(){var n=_(!1);return n=Fn.bind(null,fn,n.queue,!0,!1),ti().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,o,u){var p=fn,x=ti();if(Mn){if(u===void 0)throw Error(k(407));u=u()}else{if(u=o(),or===null)throw Error(k(349));(An&124)!==0||e(p,o,u)}x.memoizedState=u;var C={value:u,getSnapshot:o};return x.queue=C,Le(l.bind(null,p,C,n),[n]),p.flags|=2048,ie(9,ce(),a.bind(null,p,C,u,o),null),u},useId:function(){var n=ti(),o=or.identifierPrefix;if(Mn){var u=Ii,p=ua;u=(p&~(1<<32-ge(p)-1)).toString(32)+u,o="«"+o+"R"+u,u=St++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=Xc++,o="«"+o+"r"+u.toString(32)+"»";return n.memoizedState=o},useHostTransitionStatus:vn,useFormState:Y,useActionState:Y,useOptimistic:function(n){var o=ti();o.memoizedState=o.baseState=n;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Ro.bind(null,fn,!0,u),u.dispatch=o,[n,o]},useMemoCache:Fa,useCacheRefresh:function(){return ti().memoizedState=Ni.bind(null,fn)}},oo={readContext:Rr,use:Is,useCallback:Pt,useContext:Rr,useEffect:Te,useImperativeHandle:st,useInsertionEffect:Ee,useLayoutEffect:ke,useMemo:ln,useReducer:Al,useRef:pe,useState:function(){return Al(Na)},useDebugValue:$e,useDeferredValue:function(n,o){var u=ir();return ar(u,kn.memoizedState,n,o)},useTransition:function(){var n=Al(Na)[0],o=ir().memoizedState;return[typeof n=="boolean"?n:zs(n),o]},useSyncExternalStore:f,useId:jr,useHostTransitionStatus:vn,useFormState:K,useActionState:K,useOptimistic:function(n,o){var u=ir();return w(u,kn,n,o)},useMemoCache:Fa,useCacheRefresh:zr},as={readContext:Rr,use:Is,useCallback:Pt,useContext:Rr,useEffect:Te,useImperativeHandle:st,useInsertionEffect:Ee,useLayoutEffect:ke,useMemo:ln,useReducer:yu,useRef:pe,useState:function(){return yu(Na)},useDebugValue:$e,useDeferredValue:function(n,o){var u=ir();return kn===null?Pn(u,n,o):ar(u,kn.memoizedState,n,o)},useTransition:function(){var n=yu(Na)[0],o=ir().memoizedState;return[typeof n=="boolean"?n:zs(n),o]},useSyncExternalStore:f,useId:jr,useHostTransitionStatus:vn,useFormState:se,useActionState:se,useOptimistic:function(n,o){var u=ir();return kn!==null?w(u,kn,n,o):(u.baseState=n,[n,u.queue.dispatch])},useMemoCache:Fa,useCacheRefresh:zr},Dn=null,hr=0;function wi(n){var o=hr;return hr+=1,Dn===null&&(Dn=[]),Ku(Dn,n,o)}function xr(n,o){o=o.props.ref,n.ref=o!==void 0?o:null}function ic(n,o){throw o.$$typeof===ze?Error(k(525)):(n=Object.prototype.toString.call(o),Error(k(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n)))}function ac(n){var o=n._init;return o(n._payload)}function Ml(n){function o(Pe,we){if(n){var Ae=Pe.deletions;Ae===null?(Pe.deletions=[we],Pe.flags|=16):Ae.push(we)}}function u(Pe,we){if(!n)return null;for(;we!==null;)o(Pe,we),we=we.sibling;return null}function p(Pe){for(var we=new Map;Pe!==null;)Pe.key!==null?we.set(Pe.key,Pe):we.set(Pe.index,Pe),Pe=Pe.sibling;return we}function x(Pe,we){return Pe=xi(Pe,we),Pe.index=0,Pe.sibling=null,Pe}function C(Pe,we,Ae){return Pe.index=Ae,n?(Ae=Pe.alternate,Ae!==null?(Ae=Ae.index,Ae<we?(Pe.flags|=67108866,we):Ae):(Pe.flags|=67108866,we)):(Pe.flags|=1048576,we)}function O(Pe){return n&&Pe.alternate===null&&(Pe.flags|=67108866),Pe}function H(Pe,we,Ae,Qe){return we===null||we.tag!==6?(we=Vc(Ae,Pe.mode,Qe),we.return=Pe,we):(we=x(we,Ae),we.return=Pe,we)}function de(Pe,we,Ae,Qe){var Lt=Ae.type;return Lt===je?Xe(Pe,we,Ae.props.children,Qe,Ae.key):we!==null&&(we.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===ut&&ac(Lt)===we.type)?(we=x(we,Ae.props),xr(we,Ae),we.return=Pe,we):(we=Zu(Ae.type,Ae.key,Ae.props,null,Pe.mode,Qe),xr(we,Ae),we.return=Pe,we)}function De(Pe,we,Ae,Qe){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ae.containerInfo||we.stateNode.implementation!==Ae.implementation?(we=cu(Ae,Pe.mode,Qe),we.return=Pe,we):(we=x(we,Ae.children||[]),we.return=Pe,we)}function Xe(Pe,we,Ae,Qe,Lt){return we===null||we.tag!==7?(we=$o(Ae,Pe.mode,Qe,Lt),we.return=Pe,we):(we=x(we,Ae),we.return=Pe,we)}function Je(Pe,we,Ae){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return we=Vc(""+we,Pe.mode,Ae),we.return=Pe,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case Ce:return Ae=Zu(we.type,we.key,we.props,null,Pe.mode,Ae),xr(Ae,we),Ae.return=Pe,Ae;case ue:return we=cu(we,Pe.mode,Ae),we.return=Pe,we;case ut:var Qe=we._init;return we=Qe(we._payload),Je(Pe,we,Ae)}if(mn(we)||on(we))return we=$o(we,Pe.mode,Ae,null),we.return=Pe,we;if(typeof we.then=="function")return Je(Pe,wi(we),Ae);if(we.$$typeof===nt)return Je(Pe,Ki(Pe,we),Ae);ic(Pe,we)}return null}function Oe(Pe,we,Ae,Qe){var Lt=we!==null?we.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Lt!==null?null:H(Pe,we,""+Ae,Qe);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case Ce:return Ae.key===Lt?de(Pe,we,Ae,Qe):null;case ue:return Ae.key===Lt?De(Pe,we,Ae,Qe):null;case ut:return Lt=Ae._init,Ae=Lt(Ae._payload),Oe(Pe,we,Ae,Qe)}if(mn(Ae)||on(Ae))return Lt!==null?null:Xe(Pe,we,Ae,Qe,null);if(typeof Ae.then=="function")return Oe(Pe,we,wi(Ae),Qe);if(Ae.$$typeof===nt)return Oe(Pe,we,Ki(Pe,Ae),Qe);ic(Pe,Ae)}return null}function Fe(Pe,we,Ae,Qe,Lt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Pe=Pe.get(Ae)||null,H(we,Pe,""+Qe,Lt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case Ce:return Pe=Pe.get(Qe.key===null?Ae:Qe.key)||null,de(we,Pe,Qe,Lt);case ue:return Pe=Pe.get(Qe.key===null?Ae:Qe.key)||null,De(we,Pe,Qe,Lt);case ut:var wn=Qe._init;return Qe=wn(Qe._payload),Fe(Pe,we,Ae,Qe,Lt)}if(mn(Qe)||on(Qe))return Pe=Pe.get(Ae)||null,Xe(we,Pe,Qe,Lt,null);if(typeof Qe.then=="function")return Fe(Pe,we,Ae,wi(Qe),Lt);if(Qe.$$typeof===nt)return Fe(Pe,we,Ae,Ki(we,Qe),Lt);ic(we,Qe)}return null}function tn(Pe,we,Ae,Qe){for(var Lt=null,wn=null,jt=we,Jt=we=0,Ai=null;jt!==null&&Jt<Ae.length;Jt++){jt.index>Jt?(Ai=jt,jt=null):Ai=jt.sibling;var On=Oe(Pe,jt,Ae[Jt],Qe);if(On===null){jt===null&&(jt=Ai);break}n&&jt&&On.alternate===null&&o(Pe,jt),we=C(On,we,Jt),wn===null?Lt=On:wn.sibling=On,wn=On,jt=Ai}if(Jt===Ae.length)return u(Pe,jt),Mn&&Ra(Pe,Jt),Lt;if(jt===null){for(;Jt<Ae.length;Jt++)jt=Je(Pe,Ae[Jt],Qe),jt!==null&&(we=C(jt,we,Jt),wn===null?Lt=jt:wn.sibling=jt,wn=jt);return Mn&&Ra(Pe,Jt),Lt}for(jt=p(jt);Jt<Ae.length;Jt++)Ai=Fe(jt,Pe,Jt,Ae[Jt],Qe),Ai!==null&&(n&&Ai.alternate!==null&&jt.delete(Ai.key===null?Jt:Ai.key),we=C(Ai,we,Jt),wn===null?Lt=Ai:wn.sibling=Ai,wn=Ai);return n&&jt.forEach(function(Ul){return o(Pe,Ul)}),Mn&&Ra(Pe,Jt),Lt}function Yt(Pe,we,Ae,Qe){if(Ae==null)throw Error(k(151));for(var Lt=null,wn=null,jt=we,Jt=we=0,Ai=null,On=Ae.next();jt!==null&&!On.done;Jt++,On=Ae.next()){jt.index>Jt?(Ai=jt,jt=null):Ai=jt.sibling;var Ul=Oe(Pe,jt,On.value,Qe);if(Ul===null){jt===null&&(jt=Ai);break}n&&jt&&Ul.alternate===null&&o(Pe,jt),we=C(Ul,we,Jt),wn===null?Lt=Ul:wn.sibling=Ul,wn=Ul,jt=Ai}if(On.done)return u(Pe,jt),Mn&&Ra(Pe,Jt),Lt;if(jt===null){for(;!On.done;Jt++,On=Ae.next())On=Je(Pe,On.value,Qe),On!==null&&(we=C(On,we,Jt),wn===null?Lt=On:wn.sibling=On,wn=On);return Mn&&Ra(Pe,Jt),Lt}for(jt=p(jt);!On.done;Jt++,On=Ae.next())On=Fe(jt,Pe,Jt,On.value,Qe),On!==null&&(n&&On.alternate!==null&&jt.delete(On.key===null?Jt:On.key),we=C(On,we,Jt),wn===null?Lt=On:wn.sibling=On,wn=On);return n&&jt.forEach(function(cm){return o(Pe,cm)}),Mn&&Ra(Pe,Jt),Lt}function Jn(Pe,we,Ae,Qe){if(typeof Ae=="object"&&Ae!==null&&Ae.type===je&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case Ce:e:{for(var Lt=Ae.key;we!==null;){if(we.key===Lt){if(Lt=Ae.type,Lt===je){if(we.tag===7){u(Pe,we.sibling),Qe=x(we,Ae.props.children),Qe.return=Pe,Pe=Qe;break e}}else if(we.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===ut&&ac(Lt)===we.type){u(Pe,we.sibling),Qe=x(we,Ae.props),xr(Qe,Ae),Qe.return=Pe,Pe=Qe;break e}u(Pe,we);break}else o(Pe,we);we=we.sibling}Ae.type===je?(Qe=$o(Ae.props.children,Pe.mode,Qe,Ae.key),Qe.return=Pe,Pe=Qe):(Qe=Zu(Ae.type,Ae.key,Ae.props,null,Pe.mode,Qe),xr(Qe,Ae),Qe.return=Pe,Pe=Qe)}return O(Pe);case ue:e:{for(Lt=Ae.key;we!==null;){if(we.key===Lt)if(we.tag===4&&we.stateNode.containerInfo===Ae.containerInfo&&we.stateNode.implementation===Ae.implementation){u(Pe,we.sibling),Qe=x(we,Ae.children||[]),Qe.return=Pe,Pe=Qe;break e}else{u(Pe,we);break}else o(Pe,we);we=we.sibling}Qe=cu(Ae,Pe.mode,Qe),Qe.return=Pe,Pe=Qe}return O(Pe);case ut:return Lt=Ae._init,Ae=Lt(Ae._payload),Jn(Pe,we,Ae,Qe)}if(mn(Ae))return tn(Pe,we,Ae,Qe);if(on(Ae)){if(Lt=on(Ae),typeof Lt!="function")throw Error(k(150));return Ae=Lt.call(Ae),Yt(Pe,we,Ae,Qe)}if(typeof Ae.then=="function")return Jn(Pe,we,wi(Ae),Qe);if(Ae.$$typeof===nt)return Jn(Pe,we,Ki(Pe,Ae),Qe);ic(Pe,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint"?(Ae=""+Ae,we!==null&&we.tag===6?(u(Pe,we.sibling),Qe=x(we,Ae),Qe.return=Pe,Pe=Qe):(u(Pe,we),Qe=Vc(Ae,Pe.mode,Qe),Qe.return=Pe,Pe=Qe),O(Pe)):u(Pe,we)}return function(Pe,we,Ae,Qe){try{hr=0;var Lt=Jn(Pe,we,Ae,Qe);return Dn=null,Lt}catch(jt){if(jt===bl||jt===Bi)throw jt;var wn=sa(29,jt,null,Pe.mode);return wn.lanes=Qe,wn.return=Pe,wn}finally{}}}var Ua=Ml(!0),so=Ml(!1),Sr=Ze(null),br=null;function lo(n){var o=n.alternate;rt(Pr,Pr.current&1),rt(Sr,n),br===null&&(o===null||To.current!==null||o.memoizedState!==null)&&(br=n)}function zo(n){if(n.tag===22){if(rt(Pr,Pr.current),rt(Sr,n),br===null){var o=n.alternate;o!==null&&o.memoizedState!==null&&(br=n)}}else Io()}function Io(){rt(Pr,Pr.current),rt(Sr,Sr.current)}function ba(n){gt(Sr),br===n&&(br=null),gt(Pr)}var Pr=Ze(0);function Ls(n){for(var o=n;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Cf(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function ks(n,o,u,p){o=n.memoizedState,u=u(p,o),u=u==null?o:Se({},o,u),n.memoizedState=u,n.lanes===0&&(n.updateQueue.baseState=u)}var Os={enqueueSetState:function(n,o,u){n=n._reactInternals;var p=Wi(),x=ro(p);x.payload=o,u!=null&&(x.callback=u),o=Co(n,x,p),o!==null&&(da(o,n,p),wl(o,n,p))},enqueueReplaceState:function(n,o,u){n=n._reactInternals;var p=Wi(),x=ro(p);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=Co(n,x,p),o!==null&&(da(o,n,p),wl(o,n,p))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var u=Wi(),p=ro(u);p.tag=2,o!=null&&(p.callback=o),o=Co(n,p,u),o!==null&&(da(o,n,u),wl(o,n,u))}};function Ed(n,o,u,p,x,C,O){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,C,O):o.prototype&&o.prototype.isPureReactComponent?!dl(u,p)||!dl(x,C):!0}function Vf(n,o,u,p){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==n&&Os.enqueueReplaceState(o,o.state,null)}function Bs(n,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(n=n.defaultProps){u===o&&(u=Se({},u));for(var x in n)u[x]===void 0&&(u[x]=n[x])}return u}var Yc=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function Kc(n){Yc(n)}function Md(n){console.error(n)}function Gf(n){Yc(n)}function oc(n,o){try{var u=n.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function Wf(n,o,u){try{var p=n.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Qc(n,o,u){return u=ro(u),u.tag=3,u.payload={element:null},u.callback=function(){oc(n,o)},u}function Rd(n){return n=ro(n),n.tag=3,n}function Dd(n,o,u,p){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var C=p.value;n.payload=function(){return x(C)},n.callback=function(){Wf(o,u,p)}}var O=u.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(n.callback=function(){Wf(o,u,p),typeof x!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var H=p.stack;this.componentDidCatch(p.value,{componentStack:H!==null?H:""})})}function sc(n,o,u,p,x){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&_l(o,u,x,!0),u=Sr.current,u!==null){switch(u.tag){case 13:return br===null?rf():u.alternate===null&&mr===0&&(mr=3),u.flags&=-257,u.flags|=65536,u.lanes=x,p===_t?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),lf(n,p,x)),!1;case 22:return u.flags|=65536,p===_t?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),lf(n,p,x)),!1}throw Error(k(435,u.tag))}return lf(n,p,x),rf(),!1}if(Mn)return o=Sr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,p!==gl&&(n=Error(k(422),{cause:p}),Ko(Jr(n,u)))):(p!==gl&&(o=Error(k(423),{cause:p}),Ko(Jr(o,u))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,p=Jr(p,u),x=Qc(n.stateNode,p,x),ec(n,x),mr!==4&&(mr=2)),!1;var C=Error(k(520),{cause:p});if(C=Jr(C,u),ch===null?ch=[C]:ch.push(C),mr!==4&&(mr=2),o===null)return!0;p=Jr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,n=x&-x,u.lanes|=n,n=Qc(u.stateNode,p,n),ec(u,n),!1;case 1:if(o=u.type,C=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Dl===null||!Dl.has(C))))return u.flags|=65536,x&=-x,u.lanes|=x,x=Rd(x),Dd(x,n,u,p),ec(u,x),!1}u=u.return}while(u!==null);return!1}var Zf=Error(k(461)),Ir=!1;function ri(n,o,u,p){o.child=n===null?so(o,null,u,p):Ua(o,n.child,u,p)}function Jc(n,o,u,p,x){u=u.render;var C=o.ref;if("ref"in p){var O={};for(var H in p)H!=="ref"&&(O[H]=p[H])}else O=p;return Qo(o),p=rc(n,o,u,O,C,x),H=Hn(),n!==null&&!Ir?(pr(n,o,x),Lo(n,o,x)):(Mn&&H&&bo(o),o.flags|=1,ri(n,o,p,x),o.child)}function qf(n,o,u,p,x){if(n===null){var C=u.type;return typeof C=="function"&&!Wu(C)&&C.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=C,Hf(n,o,C,p,x)):(n=Zu(u.type,null,p,o,o.mode,x),n.ref=o.ref,n.return=o,o.child=n)}if(C=n.child,!Od(n,x)){var O=C.memoizedProps;if(u=u.compare,u=u!==null?u:dl,u(O,p)&&n.ref===o.ref)return Lo(n,o,x)}return o.flags|=1,n=xi(C,p),n.ref=o.ref,n.return=o,o.child=n}function Hf(n,o,u,p,x){if(n!==null){var C=n.memoizedProps;if(dl(C,p)&&n.ref===o.ref)if(Ir=!1,o.pendingProps=p=C,Od(n,x))(n.flags&131072)!==0&&(Ir=!0);else return o.lanes=n.lanes,Lo(n,o,x)}return th(n,o,u,p,x)}function $f(n,o,u){var p=o.pendingProps,x=p.children,C=n!==null?n.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=C!==null?C.baseLanes|u:u,n!==null){for(x=o.child=n.child,C=0;x!==null;)C=C|x.lanes|x.childLanes,x=x.sibling;o.childLanes=C&~p}else o.childLanes=0,o.child=null;return Xf(n,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},n!==null&&Xu(o,C!==null?C.cachePool:null),C!==null?Ln(o,C):$c(),zo(o);else return o.lanes=o.childLanes=536870912,Xf(n,o,C!==null?C.baseLanes|u:u,u)}else C!==null?(Xu(o,C.cachePool),Ln(o,C),Io(),o.memoizedState=null):(n!==null&&Xu(o,null),$c(),Io());return ri(n,o,x,u),o.child}function Xf(n,o,u,p){var x=qc();return x=x===null?null:{parent:Ur._currentValue,pool:x},o.memoizedState={baseLanes:u,cachePool:x},n!==null&&Xu(o,null),$c(),zo(o),n!==null&&_l(n,o,p,!0),null}function eh(n,o){var u=o.ref;if(u===null)n!==null&&n.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(k(284));(n===null||n.ref!==u)&&(o.flags|=4194816)}}function th(n,o,u,p,x){return Qo(o),u=rc(n,o,u,p,void 0,x),p=Hn(),n!==null&&!Ir?(pr(n,o,x),Lo(n,o,x)):(Mn&&p&&bo(o),o.flags|=1,ri(n,o,u,x),o.child)}function zd(n,o,u,p,x,C){return Qo(o),o.updateQueue=null,u=ns(o,p,u,x),xa(n),p=Hn(),n!==null&&!Ir?(pr(n,o,C),Lo(n,o,C)):(Mn&&p&&bo(o),o.flags|=1,ri(n,o,u,C),o.child)}function Id(n,o,u,p,x){if(Qo(o),o.stateNode===null){var C=sn,O=u.contextType;typeof O=="object"&&O!==null&&(C=Rr(O)),C=new u(p,C),o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=Os,o.stateNode=C,C._reactInternals=o,C=o.stateNode,C.props=p,C.state=o.memoizedState,C.refs={},mu(o),O=u.contextType,C.context=typeof O=="object"&&O!==null?Rr(O):sn,C.state=o.memoizedState,O=u.getDerivedStateFromProps,typeof O=="function"&&(ks(o,u,O,p),C.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(O=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),O!==C.state&&Os.enqueueReplaceState(C,C.state,null),Sl(o,p,C,x),Ds(),C.state=o.memoizedState),typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(n===null){C=o.stateNode;var H=o.memoizedProps,de=Bs(u,H);C.props=de;var De=C.context,Xe=u.contextType;O=sn,typeof Xe=="object"&&Xe!==null&&(O=Rr(Xe));var Je=u.getDerivedStateFromProps;Xe=typeof Je=="function"||typeof C.getSnapshotBeforeUpdate=="function",H=o.pendingProps!==H,Xe||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(H||De!==O)&&Vf(o,C,p,O),en=!1;var Oe=o.memoizedState;C.state=Oe,Sl(o,p,C,x),Ds(),De=o.memoizedState,H||Oe!==De||en?(typeof Je=="function"&&(ks(o,u,Je,p),De=o.memoizedState),(de=en||Ed(o,u,de,p,Oe,De,O))?(Xe||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=De),C.props=p,C.state=De,C.context=O,p=de):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{C=o.stateNode,Ju(n,o),O=o.memoizedProps,Xe=Bs(u,O),C.props=Xe,Je=o.pendingProps,Oe=C.context,De=u.contextType,de=sn,typeof De=="object"&&De!==null&&(de=Rr(De)),H=u.getDerivedStateFromProps,(De=typeof H=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(O!==Je||Oe!==de)&&Vf(o,C,p,de),en=!1,Oe=o.memoizedState,C.state=Oe,Sl(o,p,C,x),Ds();var Fe=o.memoizedState;O!==Je||Oe!==Fe||en||n!==null&&n.dependencies!==null&&fu(n.dependencies)?(typeof H=="function"&&(ks(o,u,H,p),Fe=o.memoizedState),(Xe=en||Ed(o,u,Xe,p,Oe,Fe,de)||n!==null&&n.dependencies!==null&&fu(n.dependencies))?(De||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,Fe,de),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,Fe,de)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||O===n.memoizedProps&&Oe===n.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&Oe===n.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=Fe),C.props=p,C.state=Fe,C.context=de,p=Xe):(typeof C.componentDidUpdate!="function"||O===n.memoizedProps&&Oe===n.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&Oe===n.memoizedState||(o.flags|=1024),p=!1)}return C=p,eh(n,o),p=(o.flags&128)!==0,C||p?(C=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:C.render(),o.flags|=1,n!==null&&p?(o.child=Ua(o,n.child,null,x),o.child=Ua(o,null,u,x)):ri(n,o,u,x),o.memoizedState=C.state,n=o.child):n=Lo(n,o,x),n}function Yf(n,o,u,p){return za(),o.flags|=256,ri(n,o,u,p),o.child}var Ld={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Xh(n){return{baseLanes:n,cachePool:pu()}}function Yh(n,o,u){return n=n!==null?n.childLanes&~u:0,o&&(n|=co),n}function Kf(n,o,u){var p=o.pendingProps,x=!1,C=(o.flags&128)!==0,O;if((O=C)||(O=n!==null&&n.memoizedState===null?!1:(Pr.current&2)!==0),O&&(x=!0,o.flags&=-129),O=(o.flags&32)!==0,o.flags&=-33,n===null){if(Mn){if(x?lo(o):Io(),Mn){var H=cr,de;if(de=H){e:{for(de=H,H=Da;de.nodeType!==8;){if(!H){H=null;break e}if(de=ho(de.nextSibling),de===null){H=null;break e}}H=de}H!==null?(o.memoizedState={dehydrated:H,treeContext:Ma!==null?{id:ua,overflow:Ii}:null,retryLane:536870912,hydrationErrors:null},de=sa(18,null,null,0),de.stateNode=H,de.return=o,o.child=de,Wr=o,cr=null,de=!0):de=!1}de||wo(o)}if(H=o.memoizedState,H!==null&&(H=H.dehydrated,H!==null))return Cf(H)?o.lanes=32:o.lanes=536870912,null;ba(o)}return H=p.children,p=p.fallback,x?(Io(),x=o.mode,H=rh({mode:"hidden",children:H},x),p=$o(p,x,u,null),H.return=o,p.return=o,H.sibling=p,o.child=H,x=o.child,x.memoizedState=Xh(u),x.childLanes=Yh(n,O,u),o.memoizedState=Ld,p):(lo(o),nh(o,H))}if(de=n.memoizedState,de!==null&&(H=de.dehydrated,H!==null)){if(C)o.flags&256?(lo(o),o.flags&=-257,o=ih(n,o,u)):o.memoizedState!==null?(Io(),o.child=n.child,o.flags|=128,o=null):(Io(),x=p.fallback,H=o.mode,p=rh({mode:"visible",children:p.children},H),x=$o(x,H,u,null),x.flags|=2,p.return=o,x.return=o,p.sibling=x,o.child=p,Ua(o,n.child,null,u),p=o.child,p.memoizedState=Xh(u),p.childLanes=Yh(n,O,u),o.memoizedState=Ld,o=x);else if(lo(o),Cf(H)){if(O=H.nextSibling&&H.nextSibling.dataset,O)var De=O.dgst;O=De,p=Error(k(419)),p.stack="",p.digest=O,Ko({value:p,source:null,stack:null}),o=ih(n,o,u)}else if(Ir||_l(n,o,u,!1),O=(u&n.childLanes)!==0,Ir||O){if(O=or,O!==null&&(p=u&-u,p=(p&42)!==0?1:Ht(p),p=(p&(O.suspendedLanes|u))!==0?0:p,p!==0&&p!==de.retryLane))throw de.retryLane=p,oa(n,p),da(O,n,p),Zf;H.data==="$?"||rf(),o=ih(n,o,u)}else H.data==="$?"?(o.flags|=192,o.child=n.child,o=null):(n=de.treeContext,cr=ho(H.nextSibling),Wr=o,Mn=!0,Yo=null,Da=!1,n!==null&&(la[bi++]=ua,la[bi++]=Ii,la[bi++]=Ma,ua=n.id,Ii=n.overflow,Ma=o),o=nh(o,p.children),o.flags|=4096);return o}return x?(Io(),x=p.fallback,H=o.mode,de=n.child,De=de.sibling,p=xi(de,{mode:"hidden",children:p.children}),p.subtreeFlags=de.subtreeFlags&65011712,De!==null?x=xi(De,x):(x=$o(x,H,u,null),x.flags|=2),x.return=o,p.return=o,p.sibling=x,o.child=p,p=x,x=o.child,H=n.child.memoizedState,H===null?H=Xh(u):(de=H.cachePool,de!==null?(De=Ur._currentValue,de=de.parent!==De?{parent:De,pool:De}:de):de=pu(),H={baseLanes:H.baseLanes|u,cachePool:de}),x.memoizedState=H,x.childLanes=Yh(n,O,u),o.memoizedState=Ld,p):(lo(o),u=n.child,n=u.sibling,u=xi(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,n!==null&&(O=o.deletions,O===null?(o.deletions=[n],o.flags|=16):O.push(n)),o.child=u,o.memoizedState=null,u)}function nh(n,o){return o=rh({mode:"visible",children:o},n.mode),o.return=n,n.child=o}function rh(n,o){return n=sa(22,n,null,o),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function ih(n,o,u){return Ua(o,n.child,null,u),n=nh(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function lc(n,o,u){n.lanes|=o;var p=n.alternate;p!==null&&(p.lanes|=o),du(n.return,o,u)}function ji(n,o,u,p,x){var C=n.memoizedState;C===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:x}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=p,C.tail=u,C.tailMode=x)}function kd(n,o,u){var p=o.pendingProps,x=p.revealOrder,C=p.tail;if(ri(n,o,p.children,u),p=Pr.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&lc(n,u,o);else if(n.tag===19)lc(n,u,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}p&=1}switch(rt(Pr,p),x){case"forwards":for(u=o.child,x=null;u!==null;)n=u.alternate,n!==null&&Ls(n)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),ji(o,!1,x,u,C);break;case"backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(n=x.alternate,n!==null&&Ls(n)===null){o.child=x;break}n=x.sibling,x.sibling=u,u=x,x=n}ji(o,!0,u,null,C);break;case"together":ji(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Lo(n,o,u){if(n!==null&&(o.dependencies=n.dependencies),Vs|=o.lanes,(u&o.childLanes)===0)if(n!==null){if(_l(n,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(n!==null&&o.child!==n.child)throw Error(k(153));if(o.child!==null){for(n=o.child,u=xi(n,n.pendingProps),o.child=u,u.return=o;n.sibling!==null;)n=n.sibling,u=u.sibling=xi(n,n.pendingProps),u.return=o;u.sibling=null}return o.child}function Od(n,o){return(n.lanes&o)!==0?!0:(n=n.dependencies,!!(n!==null&&fu(n)))}function Qf(n,o,u){switch(o.tag){case 3:Vt(o,o.stateNode.containerInfo),Yi(o,Ur,n.memoizedState.cache),za();break;case 27:case 5:tr(o);break;case 4:Vt(o,o.stateNode.containerInfo);break;case 10:Yi(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(lo(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Kf(n,o,u):(lo(o),n=Lo(n,o,u),n!==null?n.sibling:null);lo(o);break;case 19:var x=(n.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(_l(n,o,u,!1),p=(u&o.childLanes)!==0),x){if(p)return kd(n,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),rt(Pr,Pr.current),p)break;return null;case 22:case 23:return o.lanes=0,$f(n,o,u);case 24:Yi(o,Ur,n.memoizedState.cache)}return Lo(n,o,u)}function Jf(n,o,u){if(n!==null)if(n.memoizedProps!==o.pendingProps)Ir=!0;else{if(!Od(n,u)&&(o.flags&128)===0)return Ir=!1,Qf(n,o,u);Ir=(n.flags&131072)!==0}else Ir=!1,Mn&&(o.flags&1048576)!==0&&qu(o,ml,o.index);switch(o.lanes=0,o.tag){case 16:e:{n=o.pendingProps;var p=o.elementType,x=p._init;if(p=x(p._payload),o.type=p,typeof p=="function")Wu(p)?(n=Bs(p,n),o.tag=1,o=Id(null,o,p,n,u)):(o.tag=0,o=th(null,o,p,n,u));else{if(p!=null){if(x=p.$$typeof,x===wt){o.tag=11,o=Jc(null,o,p,n,u);break e}else if(x===It){o.tag=14,o=qf(null,o,p,n,u);break e}}throw o=er(p)||p,Error(k(306,o,""))}}return o;case 0:return th(n,o,o.type,o.pendingProps,u);case 1:return p=o.type,x=Bs(p,o.pendingProps),Id(n,o,p,x,u);case 3:e:{if(Vt(o,o.stateNode.containerInfo),n===null)throw Error(k(387));p=o.pendingProps;var C=o.memoizedState;x=C.element,Ju(n,o),Sl(o,p,null,u);var O=o.memoizedState;if(p=O.cache,Yi(o,Ur,p),p!==C.cache&&$u(o,[Ur],u,!0),Ds(),p=O.element,C.isDehydrated)if(C={element:p,isDehydrated:!1,cache:O.cache},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){o=Yf(n,o,p,u);break e}else if(p!==x){x=Jr(Error(k(424)),o),Ko(x),o=Yf(n,o,p,u);break e}else{switch(n=o.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(cr=ho(n.firstChild),Wr=o,Mn=!0,Yo=null,Da=!0,u=so(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(za(),p===x){o=Lo(n,o,u);break e}ri(n,o,p,u)}o=o.child}return o;case 26:return eh(n,o),n===null?(u=yd(o.type,null,o.pendingProps,null))?o.memoizedState=u:Mn||(u=o.type,n=o.pendingProps,p=Qi(Dt.current).createElement(u),p[Nt]=o,p[$t]=n,Hr(p,u,n),ur(p),o.stateNode=p):o.memoizedState=yd(o.type,n.memoizedProps,o.pendingProps,n.memoizedState),null;case 27:return tr(o),n===null&&Mn&&(p=o.stateNode=Ph(o.type,o.pendingProps,Dt.current),Wr=o,Da=!0,x=cr,$s(o.type)?(xc=x,cr=ho(p.firstChild)):cr=x),ri(n,o,o.pendingProps.children,u),eh(n,o),n===null&&(o.flags|=4194304),o.child;case 5:return n===null&&Mn&&((x=p=cr)&&(p=Ep(p,o.type,o.pendingProps,Da),p!==null?(o.stateNode=p,Wr=o,cr=ho(p.firstChild),Da=!1,x=!0):x=!1),x||wo(o)),tr(o),x=o.type,C=o.pendingProps,O=n!==null?n.memoizedProps:null,p=C.children,Hs(x,C)?p=null:O!==null&&Hs(x,O)&&(o.flags|=32),o.memoizedState!==null&&(x=rc(n,o,Cl,null,null,u),D._currentValue=x),eh(n,o),ri(n,o,p,u),o.child;case 6:return n===null&&Mn&&((n=u=cr)&&(u=sm(u,o.pendingProps,Da),u!==null?(o.stateNode=u,Wr=o,cr=null,n=!0):n=!1),n||wo(o)),null;case 13:return Kf(n,o,u);case 4:return Vt(o,o.stateNode.containerInfo),p=o.pendingProps,n===null?o.child=Ua(o,null,p,u):ri(n,o,p,u),o.child;case 11:return Jc(n,o,o.type,o.pendingProps,u);case 7:return ri(n,o,o.pendingProps,u),o.child;case 8:return ri(n,o,o.pendingProps.children,u),o.child;case 12:return ri(n,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,Yi(o,o.type,p.value),ri(n,o,p.children,u),o.child;case 9:return x=o.type._context,p=o.pendingProps.children,Qo(o),x=Rr(x),p=p(x),o.flags|=1,ri(n,o,p,u),o.child;case 14:return qf(n,o,o.type,o.pendingProps,u);case 15:return Hf(n,o,o.type,o.pendingProps,u);case 19:return kd(n,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},n===null?(u=rh(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=xi(n.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return $f(n,o,u);case 24:return Qo(o),p=Rr(Ur),n===null?(x=qc(),x===null&&(x=or,C=Jo(),x.pooledCache=C,C.refCount++,C!==null&&(x.pooledCacheLanes|=u),x=C),o.memoizedState={parent:p,cache:x},mu(o),Yi(o,Ur,x)):((n.lanes&u)!==0&&(Ju(n,o),Sl(o,null,null,u),Ds()),x=n.memoizedState,C=o.memoizedState,x.parent!==p?(x={parent:p,cache:p},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),Yi(o,Ur,p)):(p=C.cache,Yi(o,Ur,p),p!==x.cache&&$u(o,[Ur],u,!0))),ri(n,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(k(156,o.tag))}function Fs(n){n.flags|=4}function Bd(n,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!r(o)){if(o=Sr.current,o!==null&&((An&4194048)===An?br!==null:(An&62914560)!==An&&(An&536870912)===0||o!==br))throw ka=_t,ts;n.flags|=8192}}function Kh(n,o){o!==null&&(n.flags|=4),n.flags&16384&&(o=n.tag!==22?qe():536870912,n.lanes|=o,hc|=o)}function vu(n,o){if(!Mn)switch(n.tailMode){case"hidden":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n.tail=null:u.sibling=null;break;case"collapsed":u=n.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function Cr(n){var o=n.alternate!==null&&n.alternate.child===n.child,u=0,p=0;if(o)for(var x=n.child;x!==null;)u|=x.lanes|x.childLanes,p|=x.subtreeFlags&65011712,p|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)u|=x.lanes|x.childLanes,p|=x.subtreeFlags,p|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=p,n.childLanes=u,o}function ep(n,o,u){var p=o.pendingProps;switch(hu(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(o),null;case 1:return Cr(o),null;case 3:return u=o.stateNode,p=null,n!==null&&(p=n.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),ca(Ur),En(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(n===null||n.child===null)&&(Bn(o)?Fs(o):n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Xi())),Cr(o),null;case 26:return u=o.memoizedState,n===null?(Fs(o),u!==null?(Cr(o),Bd(o,u)):(Cr(o),o.flags&=-16777217)):u?u!==n.memoizedState?(Fs(o),Cr(o),Bd(o,u)):(Cr(o),o.flags&=-16777217):(n.memoizedProps!==p&&Fs(o),Cr(o),o.flags&=-16777217),null;case 27:xn(o),u=Dt.current;var x=o.type;if(n!==null&&o.stateNode!=null)n.memoizedProps!==p&&Fs(o);else{if(!p){if(o.stateNode===null)throw Error(k(166));return Cr(o),null}n=yt.current,Bn(o)?Gc(o):(n=Ph(x,p,u),o.stateNode=n,Fs(o))}return Cr(o),null;case 5:if(xn(o),u=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==p&&Fs(o);else{if(!p){if(o.stateNode===null)throw Error(k(166));return Cr(o),null}if(n=yt.current,Bn(o))Gc(o);else{switch(x=Qi(Dt.current),n){case 1:n=x.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:n=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":n=x.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":n=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":n=x.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?n.multiple=!0:p.size&&(n.size=p.size);break;default:n=typeof p.is=="string"?x.createElement(u,{is:p.is}):x.createElement(u)}}n[Nt]=o,n[$t]=p;e:for(x=o.child;x!==null;){if(x.tag===5||x.tag===6)n.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===o)break e;for(;x.sibling===null;){if(x.return===null||x.return===o)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}o.stateNode=n;e:switch(Hr(n,u,p),u){case"button":case"input":case"select":case"textarea":n=!!p.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Fs(o)}}return Cr(o),o.flags&=-16777217,null;case 6:if(n&&o.stateNode!=null)n.memoizedProps!==p&&Fs(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(k(166));if(n=Dt.current,Bn(o)){if(n=o.stateNode,u=o.memoizedProps,p=null,x=Wr,x!==null)switch(x.tag){case 27:case 5:p=x.memoizedProps}n[Nt]=o,n=!!(n.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||wf(n.nodeValue,u)),n||wo(o)}else n=Qi(n).createTextNode(p),n[Nt]=o,o.stateNode=n}return Cr(o),null;case 13:if(p=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=Bn(o),p!==null&&p.dehydrated!==null){if(n===null){if(!x)throw Error(k(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(k(317));x[Nt]=o}else za(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cr(o),x=!1}else x=Xi(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(ba(o),o):(ba(o),null)}if(ba(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,n=n!==null&&n.memoizedState!==null,u){p=o.child,x=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(x=p.alternate.memoizedState.cachePool.pool);var C=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(C=p.memoizedState.cachePool.pool),C!==x&&(p.flags|=2048)}return u!==n&&u&&(o.child.flags|=8192),Kh(o,o.updateQueue),Cr(o),null;case 4:return En(),n===null&&vf(o.stateNode.containerInfo),Cr(o),null;case 10:return ca(o.type),Cr(o),null;case 19:if(gt(Pr),x=o.memoizedState,x===null)return Cr(o),null;if(p=(o.flags&128)!==0,C=x.rendering,C===null)if(p)vu(x,!1);else{if(mr!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if(C=Ls(n),C!==null){for(o.flags|=128,vu(x,!1),n=C.updateQueue,o.updateQueue=n,Kh(o,n),o.subtreeFlags=0,n=u,u=o.child;u!==null;)jc(u,n),u=u.sibling;return rt(Pr,Pr.current&1|2),o.child}n=n.sibling}x.tail!==null&&nr()>dh&&(o.flags|=128,p=!0,vu(x,!1),o.lanes=4194304)}else{if(!p)if(n=Ls(C),n!==null){if(o.flags|=128,p=!0,n=n.updateQueue,o.updateQueue=n,Kh(o,n),vu(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!Mn)return Cr(o),null}else 2*nr()-x.renderingStartTime>dh&&u!==536870912&&(o.flags|=128,p=!0,vu(x,!1),o.lanes=4194304);x.isBackwards?(C.sibling=o.child,o.child=C):(n=x.last,n!==null?n.sibling=C:o.child=C,x.last=C)}return x.tail!==null?(o=x.tail,x.rendering=o,x.tail=o.sibling,x.renderingStartTime=nr(),o.sibling=null,n=Pr.current,rt(Pr,p?n&1|2:n&1),o):(Cr(o),null);case 22:case 23:return ba(o),Pl(),p=o.memoizedState!==null,n!==null?n.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(Cr(o),o.subtreeFlags&6&&(o.flags|=8192)):Cr(o),u=o.updateQueue,u!==null&&Kh(o,u.retryQueue),u=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),n!==null&&gt(La),null;case 24:return u=null,n!==null&&(u=n.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ca(Ur),Cr(o),null;case 25:return null;case 30:return null}throw Error(k(156,o.tag))}function tm(n,o){switch(hu(o),o.tag){case 1:return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return ca(Ur),En(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 26:case 27:case 5:return xn(o),null;case 13:if(ba(o),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(k(340));za()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return gt(Pr),null;case 4:return En(),null;case 10:return ca(o.type),null;case 22:case 23:return ba(o),Pl(),n!==null&&gt(La),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 24:return ca(Ur),null;case 25:return null;default:return null}}function tp(n,o){switch(hu(o),o.tag){case 3:ca(Ur),En();break;case 26:case 27:case 5:xn(o);break;case 4:En();break;case 13:ba(o);break;case 19:gt(Pr);break;case 10:ca(o.type);break;case 22:case 23:ba(o),Pl(),n!==null&&gt(La);break;case 24:ca(Ur)}}function ah(n,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var x=p.next;u=x;do{if((u.tag&n)===n){p=void 0;var C=u.create,O=u.inst;p=C(),O.destroy=p}u=u.next}while(u!==x)}}catch(H){sr(o,o.return,H)}}function os(n,o,u){try{var p=o.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var C=x.next;p=C;do{if((p.tag&n)===n){var O=p.inst,H=O.destroy;if(H!==void 0){O.destroy=void 0,x=o;var de=u,De=H;try{De()}catch(Xe){sr(x,de,Xe)}}}p=p.next}while(p!==C)}}catch(Xe){sr(o,o.return,Xe)}}function Qh(n){var o=n.updateQueue;if(o!==null){var u=n.stateNode;try{Hc(o,u)}catch(p){sr(n,n.return,p)}}}function Fd(n,o,u){u.props=Bs(n.type,n.memoizedProps),u.state=n.memoizedState;try{u.componentWillUnmount()}catch(p){sr(n,o,p)}}function ko(n,o){try{var u=n.ref;if(u!==null){switch(n.tag){case 26:case 27:case 5:var p=n.stateNode;break;case 30:p=n.stateNode;break;default:p=n.stateNode}typeof u=="function"?n.refCleanup=u(p):u.current=p}}catch(x){sr(n,o,x)}}function wa(n,o){var u=n.ref,p=n.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(x){sr(n,o,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){sr(n,o,x)}else u.current=null}function np(n){var o=n.type,u=n.memoizedProps,p=n.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(x){sr(n,n.return,x)}}function Nd(n,o,u){try{var p=n.stateNode;Sp(p,n.type,u,o),p[$t]=o}catch(x){sr(n,n.return,x)}}function rp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&$s(n.type)||n.tag===4}function Ud(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||rp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&$s(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function jd(n,o,u){var p=n.tag;if(p===5||p===6)n=n.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(n,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(n),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=wh));else if(p!==4&&(p===27&&$s(n.type)&&(u=n.stateNode,o=null),n=n.child,n!==null))for(jd(n,o,u),n=n.sibling;n!==null;)jd(n,o,u),n=n.sibling}function Jh(n,o,u){var p=n.tag;if(p===5||p===6)n=n.stateNode,o?u.insertBefore(n,o):u.appendChild(n);else if(p!==4&&(p===27&&$s(n.type)&&(u=n.stateNode),n=n.child,n!==null))for(Jh(n,o,u),n=n.sibling;n!==null;)Jh(n,o,u),n=n.sibling}function ip(n){var o=n.stateNode,u=n.memoizedProps;try{for(var p=n.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Hr(o,p,u),o[Nt]=n,o[$t]=u}catch(C){sr(n,n.return,C)}}var Oo=!1,Zr=!1,ed=!1,uc=typeof WeakSet=="function"?WeakSet:Set,Si=null;function Lr(n,o){if(n=n.containerInfo,Sh=le,n=Uu(n),ru(n)){if("selectionStart"in n)var u={start:n.selectionStart,end:n.selectionEnd};else e:{u=(u=n.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var x=p.anchorOffset,C=p.focusNode;p=p.focusOffset;try{u.nodeType,C.nodeType}catch{u=null;break e}var O=0,H=-1,de=-1,De=0,Xe=0,Je=n,Oe=null;t:for(;;){for(var Fe;Je!==u||x!==0&&Je.nodeType!==3||(H=O+x),Je!==C||p!==0&&Je.nodeType!==3||(de=O+p),Je.nodeType===3&&(O+=Je.nodeValue.length),(Fe=Je.firstChild)!==null;)Oe=Je,Je=Fe;for(;;){if(Je===n)break t;if(Oe===u&&++De===x&&(H=O),Oe===C&&++Xe===p&&(de=O),(Fe=Je.nextSibling)!==null)break;Je=Oe,Oe=Je.parentNode}Je=Fe}u=H===-1||de===-1?null:{start:H,end:de}}else u=null}u=u||{start:0,end:0}}else u=null;for(fd={focusedElem:n,selectionRange:u},le=!1,Si=o;Si!==null;)if(o=Si,n=o.child,(o.subtreeFlags&1024)!==0&&n!==null)n.return=o,Si=n;else for(;Si!==null;){switch(o=Si,C=o.alternate,n=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&C!==null){n=void 0,u=o,x=C.memoizedProps,C=C.memoizedState,p=u.stateNode;try{var tn=Bs(u.type,x,u.elementType===u.type);n=p.getSnapshotBeforeUpdate(tn,C),p.__reactInternalSnapshotBeforeUpdate=n}catch(Yt){sr(u,u.return,Yt)}}break;case 3:if((n&1024)!==0){if(n=o.stateNode.containerInfo,u=n.nodeType,u===9)md(n);else if(u===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":md(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(k(163))}if(n=o.sibling,n!==null){n.return=o.return,Si=n;break}Si=o.return}}function xu(n,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Ns(n,u),p&4&&ah(5,u);break;case 1:if(Ns(n,u),p&4)if(n=u.stateNode,o===null)try{n.componentDidMount()}catch(O){sr(u,u.return,O)}else{var x=Bs(u.type,o.memoizedProps);o=o.memoizedState;try{n.componentDidUpdate(x,o,n.__reactInternalSnapshotBeforeUpdate)}catch(O){sr(u,u.return,O)}}p&64&&Qh(u),p&512&&ko(u,u.return);break;case 3:if(Ns(n,u),p&64&&(n=u.updateQueue,n!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Hc(n,o)}catch(O){sr(u,u.return,O)}}break;case 27:o===null&&p&4&&ip(u);case 26:case 5:Ns(n,u),o===null&&p&4&&np(u),p&512&&ko(u,u.return);break;case 12:Ns(n,u);break;case 13:Ns(n,u),p&4&&Wd(n,u),p&64&&(n=u.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(u=cf.bind(null,u),Mp(n,u))));break;case 22:if(p=u.memoizedState!==null||Oo,!p){o=o!==null&&o.memoizedState!==null||Zr,x=Oo;var C=Zr;Oo=p,(Zr=o)&&!C?Rl(n,u,(u.subtreeFlags&8772)!==0):Ns(n,u),Oo=x,Zr=C}break;case 30:break;default:Ns(n,u)}}function Vd(n){var o=n.alternate;o!==null&&(n.alternate=null,Vd(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&pt(o)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var dr=null,Vi=!1;function ja(n,o,u){for(u=u.child;u!==null;)Gd(n,o,u),u=u.sibling}function Gd(n,o,u){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(qi,u)}catch{}switch(u.tag){case 26:Zr||wa(u,o),ja(n,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Zr||wa(u,o);var p=dr,x=Vi;$s(u.type)&&(dr=u.stateNode,Vi=!1),ja(n,o,u),Ol(u.stateNode),dr=p,Vi=x;break;case 5:Zr||wa(u,o);case 6:if(p=dr,x=Vi,dr=null,ja(n,o,u),dr=p,Vi=x,dr!==null)if(Vi)try{(dr.nodeType===9?dr.body:dr.nodeName==="HTML"?dr.ownerDocument.body:dr).removeChild(u.stateNode)}catch(C){sr(u,o,C)}else try{dr.removeChild(u.stateNode)}catch(C){sr(u,o,C)}break;case 18:dr!==null&&(Vi?(n=dr,Pf(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,u.stateNode),Or(n)):Pf(dr,u.stateNode));break;case 4:p=dr,x=Vi,dr=u.stateNode.containerInfo,Vi=!0,ja(n,o,u),dr=p,Vi=x;break;case 0:case 11:case 14:case 15:Zr||os(2,u,o),Zr||os(4,u,o),ja(n,o,u);break;case 1:Zr||(wa(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&Fd(u,o,p)),ja(n,o,u);break;case 21:ja(n,o,u);break;case 22:Zr=(p=Zr)||u.memoizedState!==null,ja(n,o,u),Zr=p;break;default:ja(n,o,u)}}function Wd(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Or(n)}catch(u){sr(o,o.return,u)}}function oh(n){switch(n.tag){case 13:case 19:var o=n.stateNode;return o===null&&(o=n.stateNode=new uc),o;case 22:return n=n.stateNode,o=n._retryCache,o===null&&(o=n._retryCache=new uc),o;default:throw Error(k(435,n.tag))}}function sh(n,o){var u=oh(n);o.forEach(function(p){var x=hf.bind(null,n,p);u.has(p)||(u.add(p),p.then(x,x))})}function Pi(n,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var x=u[p],C=n,O=o,H=O;e:for(;H!==null;){switch(H.tag){case 27:if($s(H.type)){dr=H.stateNode,Vi=!1;break e}break;case 5:dr=H.stateNode,Vi=!1;break e;case 3:case 4:dr=H.stateNode.containerInfo,Vi=!0;break e}H=H.return}if(dr===null)throw Error(k(160));Gd(C,O,x),dr=null,Vi=!1,C=x.alternate,C!==null&&(C.return=null),x.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)bu(o,n),o=o.sibling}var Sa=null;function bu(n,o){var u=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Pi(o,n),Gi(n),p&4&&(os(3,n,n.return),ah(3,n),os(5,n,n.return));break;case 1:Pi(o,n),Gi(n),p&512&&(Zr||u===null||wa(u,u.return)),p&64&&Oo&&(n=n.updateQueue,n!==null&&(p=n.callbacks,p!==null&&(u=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var x=Sa;if(Pi(o,n),Gi(n),p&512&&(Zr||u===null||wa(u,u.return)),p&4){var C=u!==null?u.memoizedState:null;if(p=n.memoizedState,u===null)if(p===null)if(n.stateNode===null){e:{p=n.type,u=n.memoizedProps,x=x.ownerDocument||x;t:switch(p){case"title":C=x.getElementsByTagName("title")[0],(!C||C[qa]||C[Nt]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=x.createElement(p),x.head.insertBefore(C,x.querySelector("head > title"))),Hr(C,p,u),C[Nt]=n,ur(C),p=C;break e;case"link":var O=kp("link","href",x).get(p+(u.href||""));if(O){for(var H=0;H<O.length;H++)if(C=O[H],C.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&C.getAttribute("rel")===(u.rel==null?null:u.rel)&&C.getAttribute("title")===(u.title==null?null:u.title)&&C.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){O.splice(H,1);break t}}C=x.createElement(p),Hr(C,p,u),x.head.appendChild(C);break;case"meta":if(O=kp("meta","content",x).get(p+(u.content||""))){for(H=0;H<O.length;H++)if(C=O[H],C.getAttribute("content")===(u.content==null?null:""+u.content)&&C.getAttribute("name")===(u.name==null?null:u.name)&&C.getAttribute("property")===(u.property==null?null:u.property)&&C.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&C.getAttribute("charset")===(u.charSet==null?null:u.charSet)){O.splice(H,1);break t}}C=x.createElement(p),Hr(C,p,u),x.head.appendChild(C);break;default:throw Error(k(468,p))}C[Nt]=n,ur(C),p=C}n.stateNode=p}else i(x,n.type,n.stateNode);else n.stateNode=Ch(x,p,n.memoizedProps);else C!==p?(C===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):C.count--,p===null?i(x,n.type,n.stateNode):Ch(x,p,n.memoizedProps)):p===null&&n.stateNode!==null&&Nd(n,n.memoizedProps,u.memoizedProps)}break;case 27:Pi(o,n),Gi(n),p&512&&(Zr||u===null||wa(u,u.return)),u!==null&&p&4&&Nd(n,n.memoizedProps,u.memoizedProps);break;case 5:if(Pi(o,n),Gi(n),p&512&&(Zr||u===null||wa(u,u.return)),n.flags&32){x=n.stateNode;try{Ya(x,"")}catch(Fe){sr(n,n.return,Fe)}}p&4&&n.stateNode!=null&&(x=n.memoizedProps,Nd(n,x,u!==null?u.memoizedProps:x)),p&1024&&(ed=!0);break;case 6:if(Pi(o,n),Gi(n),p&4){if(n.stateNode===null)throw Error(k(162));p=n.memoizedProps,u=n.stateNode;try{u.nodeValue=p}catch(Fe){sr(n,n.return,Fe)}}break;case 3:if(Pc=null,x=Sa,Sa=gd(o.containerInfo),Pi(o,n),Sa=x,Gi(n),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Or(o.containerInfo)}catch(Fe){sr(n,n.return,Fe)}ed&&(ed=!1,ap(n));break;case 4:p=Sa,Sa=gd(n.stateNode.containerInfo),Pi(o,n),Gi(n),Sa=p;break;case 12:Pi(o,n),Gi(n);break;case 13:Pi(o,n),Gi(n),n.child.flags&8192&&n.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(rd=nr()),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,sh(n,p)));break;case 22:x=n.memoizedState!==null;var de=u!==null&&u.memoizedState!==null,De=Oo,Xe=Zr;if(Oo=De||x,Zr=Xe||de,Pi(o,n),Zr=Xe,Oo=De,Gi(n),p&8192)e:for(o=n.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||de||Oo||Zr||Va(n)),u=null,o=n;;){if(o.tag===5||o.tag===26){if(u===null){de=u=o;try{if(C=de.stateNode,x)O=C.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{H=de.stateNode;var Je=de.memoizedProps.style,Oe=Je!=null&&Je.hasOwnProperty("display")?Je.display:null;H.style.display=Oe==null||typeof Oe=="boolean"?"":(""+Oe).trim()}}catch(Fe){sr(de,de.return,Fe)}}}else if(o.tag===6){if(u===null){de=o;try{de.stateNode.nodeValue=x?"":de.memoizedProps}catch(Fe){sr(de,de.return,Fe)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===n)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break e;for(;o.sibling===null;){if(o.return===null||o.return===n)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=n.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,sh(n,u))));break;case 19:Pi(o,n),Gi(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,sh(n,p)));break;case 30:break;case 21:break;default:Pi(o,n),Gi(n)}}function Gi(n){var o=n.flags;if(o&2){try{for(var u,p=n.return;p!==null;){if(rp(p)){u=p;break}p=p.return}if(u==null)throw Error(k(160));switch(u.tag){case 27:var x=u.stateNode,C=Ud(n);Jh(n,C,x);break;case 5:var O=u.stateNode;u.flags&32&&(Ya(O,""),u.flags&=-33);var H=Ud(n);Jh(n,H,O);break;case 3:case 4:var de=u.stateNode.containerInfo,De=Ud(n);jd(n,De,de);break;default:throw Error(k(161))}}catch(Xe){sr(n,n.return,Xe)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function ap(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var o=n;ap(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),n=n.sibling}}function Ns(n,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)xu(n,o.alternate,o),o=o.sibling}function Va(n){for(n=n.child;n!==null;){var o=n;switch(o.tag){case 0:case 11:case 14:case 15:os(4,o,o.return),Va(o);break;case 1:wa(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Fd(o,o.return,u),Va(o);break;case 27:Ol(o.stateNode);case 26:case 5:wa(o,o.return),Va(o);break;case 22:o.memoizedState===null&&Va(o);break;case 30:Va(o);break;default:Va(o)}n=n.sibling}}function Rl(n,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,x=n,C=o,O=C.flags;switch(C.tag){case 0:case 11:case 15:Rl(x,C,u),ah(4,C);break;case 1:if(Rl(x,C,u),p=C,x=p.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(De){sr(p,p.return,De)}if(p=C,x=p.updateQueue,x!==null){var H=p.stateNode;try{var de=x.shared.hiddenCallbacks;if(de!==null)for(x.shared.hiddenCallbacks=null,x=0;x<de.length;x++)tc(de[x],H)}catch(De){sr(p,p.return,De)}}u&&O&64&&Qh(C),ko(C,C.return);break;case 27:ip(C);case 26:case 5:Rl(x,C,u),u&&p===null&&O&4&&np(C),ko(C,C.return);break;case 12:Rl(x,C,u);break;case 13:Rl(x,C,u),u&&O&4&&Wd(x,C);break;case 22:C.memoizedState===null&&Rl(x,C,u),ko(C,C.return);break;case 30:break;default:Rl(x,C,u)}o=o.sibling}}function td(n,o){var u=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),n=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(n=o.memoizedState.cachePool.pool),n!==u&&(n!=null&&n.refCount++,u!=null&&As(u))}function wu(n,o){n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&As(n))}function uo(n,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Zd(n,o,u,p),o=o.sibling}function Zd(n,o,u,p){var x=o.flags;switch(o.tag){case 0:case 11:case 15:uo(n,o,u,p),x&2048&&ah(9,o);break;case 1:uo(n,o,u,p);break;case 3:uo(n,o,u,p),x&2048&&(n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&As(n)));break;case 12:if(x&2048){uo(n,o,u,p),n=o.stateNode;try{var C=o.memoizedProps,O=C.id,H=C.onPostCommit;typeof H=="function"&&H(O,o.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(de){sr(o,o.return,de)}}else uo(n,o,u,p);break;case 13:uo(n,o,u,p);break;case 23:break;case 22:C=o.stateNode,O=o.alternate,o.memoizedState!==null?C._visibility&2?uo(n,o,u,p):lh(n,o):C._visibility&2?uo(n,o,u,p):(C._visibility|=2,Su(n,o,u,p,(o.subtreeFlags&10256)!==0)),x&2048&&td(O,o);break;case 24:uo(n,o,u,p),x&2048&&wu(o.alternate,o);break;default:uo(n,o,u,p)}}function Su(n,o,u,p,x){for(x=x&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var C=n,O=o,H=u,de=p,De=O.flags;switch(O.tag){case 0:case 11:case 15:Su(C,O,H,de,x),ah(8,O);break;case 23:break;case 22:var Xe=O.stateNode;O.memoizedState!==null?Xe._visibility&2?Su(C,O,H,de,x):lh(C,O):(Xe._visibility|=2,Su(C,O,H,de,x)),x&&De&2048&&td(O.alternate,O);break;case 24:Su(C,O,H,de,x),x&&De&2048&&wu(O.alternate,O);break;default:Su(C,O,H,de,x)}o=o.sibling}}function lh(n,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=n,p=o,x=p.flags;switch(p.tag){case 22:lh(u,p),x&2048&&td(p.alternate,p);break;case 24:lh(u,p),x&2048&&wu(p.alternate,p);break;default:lh(u,p)}o=o.sibling}}var uh=8192;function cc(n){if(n.subtreeFlags&uh)for(n=n.child;n!==null;)op(n),n=n.sibling}function op(n){switch(n.tag){case 26:cc(n),n.flags&uh&&n.memoizedState!==null&&m(Sa,n.memoizedState,n.memoizedProps);break;case 5:cc(n);break;case 3:case 4:var o=Sa;Sa=gd(n.stateNode.containerInfo),cc(n),Sa=o;break;case 22:n.memoizedState===null&&(o=n.alternate,o!==null&&o.memoizedState!==null?(o=uh,uh=16777216,cc(n),uh=o):cc(n));break;default:cc(n)}}function sp(n){var o=n.alternate;if(o!==null&&(n=o.child,n!==null)){o.child=null;do o=n.sibling,n.sibling=null,n=o;while(n!==null)}}function ss(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Si=p,qd(p,n)}sp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)lp(n),n=n.sibling}function lp(n){switch(n.tag){case 0:case 11:case 15:ss(n),n.flags&2048&&os(9,n,n.return);break;case 3:ss(n);break;case 12:ss(n);break;case 22:var o=n.stateNode;n.memoizedState!==null&&o._visibility&2&&(n.return===null||n.return.tag!==13)?(o._visibility&=-3,nd(n)):ss(n);break;default:ss(n)}}function nd(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Si=p,qd(p,n)}sp(n)}for(n=n.child;n!==null;){switch(o=n,o.tag){case 0:case 11:case 15:os(8,o,o.return),nd(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,nd(o));break;default:nd(o)}n=n.sibling}}function qd(n,o){for(;Si!==null;){var u=Si;switch(u.tag){case 0:case 11:case 15:os(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:As(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Si=p;else e:for(u=n;Si!==null;){p=Si;var x=p.sibling,C=p.return;if(Vd(p),p===u){Si=null;break e}if(x!==null){x.return=C,Si=x;break e}Si=C}}}var nm={getCacheForType:function(n){var o=Rr(Ur),u=o.data.get(n);return u===void 0&&(u=n(),o.data.set(n,u)),u}},up=typeof WeakMap=="function"?WeakMap:Map,Xn=0,or=null,yn=null,An=0,Yn=0,Ga=null,Us=!1,Pu=!1,Hd=!1,js=0,mr=0,Vs=0,Cu=0,$d=0,co=0,hc=0,ch=null,ha=null,hh=!1,rd=0,dh=1/0,fh=null,Dl=null,ii=0,zl=null,Tu=null,dc=0,Xd=0,Yd=null,Kd=null,ph=0,Qd=null;function Wi(){if((Xn&2)!==0&&An!==0)return An&-An;if(Ue.T!==null){var n=Po;return n!==0?n:vh()}return Fr()}function qr(){co===0&&(co=(An&536870912)===0||Mn?et():536870912);var n=Sr.current;return n!==null&&(n.flags|=32),co}function da(n,o,u){(n===or&&(Yn===2||Yn===9)||n.cancelPendingCommit!==null)&&(fc(n,0),Wa(n,An,co,!1)),xe(n,u),((Xn&2)===0||n!==or)&&(n===or&&((Xn&2)===0&&(Cu|=u),mr===4&&Wa(n,An,co,!1)),Bo(n))}function Jd(n,o,u){if((Xn&6)!==0)throw Error(k(327));var p=!u&&(o&124)===0&&(o&n.expiredLanes)===0||ve(n,o),x=p?im(n,o):af(n,o,!0),C=p;do{if(x===0){Pu&&!p&&Wa(n,o,0,!1);break}else{if(u=n.current.alternate,C&&!tf(u)){x=af(n,o,!1),C=!1;continue}if(x===2){if(C=o,n.errorRecoveryDisabledLanes&C)var O=0;else O=n.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){o=O;e:{var H=n;x=ch;var de=H.current.memoizedState.isDehydrated;if(de&&(fc(H,O).flags|=256),O=af(H,O,!1),O!==2){if(Hd&&!de){H.errorRecoveryDisabledLanes|=C,Cu|=C,x=4;break e}C=ha,ha=x,C!==null&&(ha===null?ha=C:ha.push.apply(ha,C))}x=O}if(C=!1,x!==2)continue}}if(x===1){fc(n,0),Wa(n,o,0,!0);break}e:{switch(p=n,C=x,C){case 0:case 1:throw Error(k(345));case 4:if((o&4194048)!==o)break;case 6:Wa(p,o,co,!Us);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(k(329))}if((o&62914560)===o&&(x=rd+300-nr(),10<x)){if(Wa(p,o,co,!Us),Me(p,0,!0)!==0)break e;p.timeoutHandle=Sf(ef.bind(null,p,u,ha,fh,hh,o,co,Cu,hc,Us,C,2,-0,0),x);break e}ef(p,u,ha,fh,hh,o,co,Cu,hc,Us,C,0,-0,0)}}break}while(!0);Bo(n)}function ef(n,o,u,p,x,C,O,H,de,De,Xe,Je,Oe,Fe){if(n.timeoutHandle=-1,Je=o.subtreeFlags,(Je&8192||(Je&16785408)===16785408)&&(s={stylesheets:null,count:0,unsuspend:h},op(o),Je=y(),Je!==null)){n.cancelPendingCommit=Je(Gs.bind(null,n,o,C,u,p,x,O,H,de,Xe,1,Oe,Fe)),Wa(n,C,O,!De);return}Gs(n,o,C,u,p,x,O,H,de)}function tf(n){for(var o=n;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var x=u[p],C=x.getSnapshot;x=x.value;try{if(!Di(C(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Wa(n,o,u,p){o&=~$d,o&=~Cu,n.suspendedLanes|=o,n.pingedLanes&=~o,p&&(n.warmLanes|=o),p=n.expirationTimes;for(var x=o;0<x;){var C=31-ge(x),O=1<<C;p[C]=-1,x&=~O}u!==0&&hn(n,u,o)}function mh(){return(Xn&6)===0?(yc(0),!1):!0}function nf(){if(yn!==null){if(Yn===0)var n=yn.return;else n=yn,Li=So=null,Tl(n),Dn=null,hr=0,n=yn;for(;n!==null;)tp(n.alternate,n),n=n.return;yn=null}}function fc(n,o){var u=n.timeoutHandle;u!==-1&&(n.timeoutHandle=-1,Cp(u)),u=n.cancelPendingCommit,u!==null&&(n.cancelPendingCommit=null,u()),nf(),or=n,yn=u=xi(n.current,null),An=o,Yn=0,Ga=null,Us=!1,Pu=ve(n,o),Hd=!1,hc=co=$d=Cu=Vs=mr=0,ha=ch=null,hh=!1,(o&8)!==0&&(o|=o&32);var p=n.entangledLanes;if(p!==0)for(n=n.entanglements,p&=o;0<p;){var x=31-ge(p),C=1<<x;o|=n[x],p&=~C}return js=o,Ts(),u}function cp(n,o){fn=null,Ue.H=ni,o===bl||o===Bi?(o=Rs(),Yn=3):o===ts?(o=Rs(),Yn=4):Yn=o===Zf?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ga=o,yn===null&&(mr=1,oc(n,Jr(o,n.current)))}function hp(){var n=Ue.H;return Ue.H=ni,n===null?ni:n}function dp(){var n=Ue.A;return Ue.A=nm,n}function rf(){mr=4,Us||(An&4194048)!==An&&Sr.current!==null||(Pu=!0),(Vs&134217727)===0&&(Cu&134217727)===0||or===null||Wa(or,An,co,!1)}function af(n,o,u){var p=Xn;Xn|=2;var x=hp(),C=dp();(or!==n||An!==o)&&(fh=null,fc(n,o)),o=!1;var O=mr;e:do try{if(Yn!==0&&yn!==null){var H=yn,de=Ga;switch(Yn){case 8:nf(),O=6;break e;case 3:case 2:case 9:case 6:Sr.current===null&&(o=!0);var De=Yn;if(Yn=0,Ga=null,Au(n,H,de,De),u&&Pu){O=0;break e}break;default:De=Yn,Yn=0,Ga=null,Au(n,H,de,De)}}rm(),O=mr;break}catch(Xe){cp(n,Xe)}while(!0);return o&&n.shellSuspendCounter++,Li=So=null,Xn=p,Ue.H=x,Ue.A=C,yn===null&&(or=null,An=0,Ts()),O}function rm(){for(;yn!==null;)fp(yn)}function im(n,o){var u=Xn;Xn|=2;var p=hp(),x=dp();or!==n||An!==o?(fh=null,dh=nr()+500,fc(n,o)):Pu=ve(n,o);e:do try{if(Yn!==0&&yn!==null){o=yn;var C=Ga;t:switch(Yn){case 1:Yn=0,Ga=null,Au(n,o,C,1);break;case 2:case 9:if(Yu(C)){Yn=0,Ga=null,pp(o);break}o=function(){Yn!==2&&Yn!==9||or!==n||(Yn=7),Bo(n)},C.then(o,o);break e;case 3:Yn=7;break e;case 4:Yn=5;break e;case 7:Yu(C)?(Yn=0,Ga=null,pp(o)):(Yn=0,Ga=null,Au(n,o,C,7));break;case 5:var O=null;switch(yn.tag){case 26:O=yn.memoizedState;case 5:case 27:var H=yn;if(!O||r(O)){Yn=0,Ga=null;var de=H.sibling;if(de!==null)yn=de;else{var De=H.return;De!==null?(yn=De,pc(De)):yn=null}break t}}Yn=0,Ga=null,Au(n,o,C,5);break;case 6:Yn=0,Ga=null,Au(n,o,C,6);break;case 8:nf(),mr=6;break e;default:throw Error(k(462))}}am();break}catch(Xe){cp(n,Xe)}while(!0);return Li=So=null,Ue.H=p,Ue.A=x,Xn=u,yn!==null?0:(or=null,An=0,Ts(),mr)}function am(){for(;yn!==null&&!qn();)fp(yn)}function fp(n){var o=Jf(n.alternate,n,js);n.memoizedProps=n.pendingProps,o===null?pc(n):yn=o}function pp(n){var o=n,u=o.alternate;switch(o.tag){case 15:case 0:o=zd(u,o,o.pendingProps,o.type,void 0,An);break;case 11:o=zd(u,o,o.pendingProps,o.type.render,o.ref,An);break;case 5:Tl(o);default:tp(u,o),o=yn=jc(o,js),o=Jf(u,o,js)}n.memoizedProps=n.pendingProps,o===null?pc(n):yn=o}function Au(n,o,u,p){Li=So=null,Tl(o),Dn=null,hr=0;var x=o.return;try{if(sc(n,x,o,u,An)){mr=1,oc(n,Jr(u,n.current)),yn=null;return}}catch(C){if(x!==null)throw yn=x,C;mr=1,oc(n,Jr(u,n.current)),yn=null;return}o.flags&32768?(Mn||p===1?n=!0:Pu||(An&536870912)!==0?n=!1:(Us=n=!0,(p===2||p===9||p===3||p===6)&&(p=Sr.current,p!==null&&p.tag===13&&(p.flags|=16384))),of(o,n)):pc(o)}function pc(n){var o=n;do{if((o.flags&32768)!==0){of(o,Us);return}n=o.return;var u=ep(o.alternate,o,js);if(u!==null){yn=u;return}if(o=o.sibling,o!==null){yn=o;return}yn=o=n}while(o!==null);mr===0&&(mr=5)}function of(n,o){do{var u=tm(n.alternate,n);if(u!==null){u.flags&=32767,yn=u;return}if(u=n.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(n=n.sibling,n!==null)){yn=n;return}yn=n=u}while(n!==null);mr=6,yn=null}function Gs(n,o,u,p,x,C,O,H,de){n.cancelPendingCommit=null;do id();while(ii!==0);if((Xn&6)!==0)throw Error(k(327));if(o!==null){if(o===n.current)throw Error(k(177));if(C=o.lanes|o.childLanes,C|=Cs,Wt(n,u,C,O,H,de),n===or&&(yn=or=null,An=0),Tu=o,zl=n,dc=u,Xd=C,Yd=x,Kd=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,om(oi,function(){return mp(),null})):(n.callbackNode=null,n.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=Ue.T,Ue.T=null,x=ht.p,ht.p=2,O=Xn,Xn|=4;try{Lr(n,o,u)}finally{Xn=O,ht.p=x,Ue.T=p}}ii=1,mc(),Eu(),gh()}}function mc(){if(ii===1){ii=0;var n=zl,o=Tu,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=Ue.T,Ue.T=null;var p=ht.p;ht.p=2;var x=Xn;Xn|=4;try{bu(o,n);var C=fd,O=Uu(n.containerInfo),H=C.focusedElem,de=C.selectionRange;if(O!==H&&H&&H.ownerDocument&&Sn(H.ownerDocument.documentElement,H)){if(de!==null&&ru(H)){var De=de.start,Xe=de.end;if(Xe===void 0&&(Xe=De),"selectionStart"in H)H.selectionStart=De,H.selectionEnd=Math.min(Xe,H.value.length);else{var Je=H.ownerDocument||document,Oe=Je&&Je.defaultView||window;if(Oe.getSelection){var Fe=Oe.getSelection(),tn=H.textContent.length,Yt=Math.min(de.start,tn),Jn=de.end===void 0?Yt:Math.min(de.end,tn);!Fe.extend&&Yt>Jn&&(O=Jn,Jn=Yt,Yt=O);var Pe=to(H,Yt),we=to(H,Jn);if(Pe&&we&&(Fe.rangeCount!==1||Fe.anchorNode!==Pe.node||Fe.anchorOffset!==Pe.offset||Fe.focusNode!==we.node||Fe.focusOffset!==we.offset)){var Ae=Je.createRange();Ae.setStart(Pe.node,Pe.offset),Fe.removeAllRanges(),Yt>Jn?(Fe.addRange(Ae),Fe.extend(we.node,we.offset)):(Ae.setEnd(we.node,we.offset),Fe.addRange(Ae))}}}}for(Je=[],Fe=H;Fe=Fe.parentNode;)Fe.nodeType===1&&Je.push({element:Fe,left:Fe.scrollLeft,top:Fe.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<Je.length;H++){var Qe=Je[H];Qe.element.scrollLeft=Qe.left,Qe.element.scrollTop=Qe.top}}le=!!Sh,fd=Sh=null}finally{Xn=x,ht.p=p,Ue.T=u}}n.current=o,ii=2}}function Eu(){if(ii===2){ii=0;var n=zl,o=Tu,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=Ue.T,Ue.T=null;var p=ht.p;ht.p=2;var x=Xn;Xn|=4;try{xu(n,o.alternate,o)}finally{Xn=x,ht.p=p,Ue.T=u}}ii=3}}function gh(){if(ii===4||ii===3){ii=0,Ar();var n=zl,o=Tu,u=dc,p=Kd;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?ii=5:(ii=0,Tu=zl=null,yh(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(Dl=null),zn(u),o=o.stateNode,gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(qi,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=Ue.T,x=ht.p,ht.p=2,Ue.T=null;try{for(var C=n.onRecoverableError,O=0;O<p.length;O++){var H=p[O];C(H.value,{componentStack:H.stack})}}finally{Ue.T=o,ht.p=x}}(dc&3)!==0&&id(),Bo(n),x=n.pendingLanes,(u&4194090)!==0&&(x&42)!==0?n===Qd?ph++:(ph=0,Qd=n):ph=0,yc(0)}}function yh(n,o){(n.pooledCacheLanes&=o)===0&&(o=n.pooledCache,o!=null&&(n.pooledCache=null,As(o)))}function id(n){return mc(),Eu(),gh(),mp()}function mp(){if(ii!==5)return!1;var n=zl,o=Xd;Xd=0;var u=zn(dc),p=Ue.T,x=ht.p;try{ht.p=32>u?32:u,Ue.T=null,u=Yd,Yd=null;var C=zl,O=dc;if(ii=0,Tu=zl=null,dc=0,(Xn&6)!==0)throw Error(k(331));var H=Xn;if(Xn|=4,lp(C.current),Zd(C,C.current,O,u),Xn=H,yc(0,!1),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(qi,C)}catch{}return!0}finally{ht.p=x,Ue.T=p,yh(n,o)}}function sf(n,o,u){o=Jr(u,o),o=Qc(n.stateNode,o,2),n=Co(n,o,2),n!==null&&(xe(n,2),Bo(n))}function sr(n,o,u){if(n.tag===3)sf(n,n,u);else for(;o!==null;){if(o.tag===3){sf(o,n,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Dl===null||!Dl.has(p))){n=Jr(u,n),u=Rd(2),p=Co(o,u,2),p!==null&&(Dd(u,p,o,n),xe(p,2),Bo(p));break}}o=o.return}}function lf(n,o,u){var p=n.pingCache;if(p===null){p=n.pingCache=new up;var x=new Set;p.set(o,x)}else x=p.get(o),x===void 0&&(x=new Set,p.set(o,x));x.has(u)||(Hd=!0,x.add(u),n=gp.bind(null,n,o,u),o.then(n,n))}function gp(n,o,u){var p=n.pingCache;p!==null&&p.delete(o),n.pingedLanes|=n.suspendedLanes&u,n.warmLanes&=~u,or===n&&(An&u)===u&&(mr===4||mr===3&&(An&62914560)===An&&300>nr()-rd?(Xn&2)===0&&fc(n,0):$d|=u,hc===An&&(hc=0)),Bo(n)}function uf(n,o){o===0&&(o=qe()),n=oa(n,o),n!==null&&(xe(n,o),Bo(n))}function cf(n){var o=n.memoizedState,u=0;o!==null&&(u=o.retryLane),uf(n,u)}function hf(n,o){var u=0;switch(n.tag){case 13:var p=n.stateNode,x=n.memoizedState;x!==null&&(u=x.retryLane);break;case 19:p=n.stateNode;break;case 22:p=n.stateNode._retryCache;break;default:throw Error(k(314))}p!==null&&p.delete(o),uf(n,u)}function om(n,o){return qt(n,o)}var _h=null,gc=null,df=!1,ad=!1,ff=!1,Mu=0;function Bo(n){n!==gc&&n.next===null&&(gc===null?_h=gc=n:gc=gc.next=n),ad=!0,df||(df=!0,sd())}function yc(n,o){if(!ff&&ad){ff=!0;do for(var u=!1,p=_h;p!==null;){if(n!==0){var x=p.pendingLanes;if(x===0)var C=0;else{var O=p.suspendedLanes,H=p.pingedLanes;C=(1<<31-ge(42|n)+1)-1,C&=x&~(O&~H),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(u=!0,yp(p,C))}else C=An,C=Me(p,p===or?C:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(C&3)===0||ve(p,C)||(u=!0,yp(p,C));p=p.next}while(u);ff=!1}}function Ws(){Zs()}function Zs(){ad=df=!1;var n=0;Mu!==0&&(Pp()&&(n=Mu),Mu=0);for(var o=nr(),u=null,p=_h;p!==null;){var x=p.next,C=pf(p,o);C===0?(p.next=null,u===null?_h=x:u.next=x,x===null&&(gc=u)):(u=p,(n!==0||(C&3)!==0)&&(ad=!0)),p=x}yc(n)}function pf(n,o){for(var u=n.suspendedLanes,p=n.pingedLanes,x=n.expirationTimes,C=n.pendingLanes&-62914561;0<C;){var O=31-ge(C),H=1<<O,de=x[O];de===-1?((H&u)===0||(H&p)!==0)&&(x[O]=Ne(H,o)):de<=o&&(n.expiredLanes|=H),C&=~H}if(o=or,u=An,u=Me(n,n===o?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p=n.callbackNode,u===0||n===o&&(Yn===2||Yn===9)||n.cancelPendingCommit!==null)return p!==null&&p!==null&&un(p),n.callbackNode=null,n.callbackPriority=0;if((u&3)===0||ve(n,u)){if(o=u&-u,o===n.callbackPriority)return o;switch(p!==null&&un(p),zn(u)){case 2:case 8:u=Ei;break;case 32:u=oi;break;case 268435456:u=na;break;default:u=oi}return p=od.bind(null,n),u=qt(u,p),n.callbackPriority=o,n.callbackNode=u,o}return p!==null&&p!==null&&un(p),n.callbackPriority=2,n.callbackNode=null,2}function od(n,o){if(ii!==0&&ii!==5)return n.callbackNode=null,n.callbackPriority=0,null;var u=n.callbackNode;if(id()&&n.callbackNode!==u)return null;var p=An;return p=Me(n,n===or?p:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p===0?null:(Jd(n,p,o),pf(n,nr()),n.callbackNode!=null&&n.callbackNode===u?od.bind(null,n):null)}function yp(n,o){if(id())return null;Jd(n,o,!0)}function sd(){Ap(function(){(Xn&6)!==0?qt(Br,Ws):Zs()})}function vh(){return Mu===0&&(Mu=et()),Mu}function _p(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:cn(""+n)}function ld(n,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,n.id&&u.setAttribute("form",n.id),o.parentNode.insertBefore(u,o),n=new FormData(n),u.parentNode.removeChild(u),n}function mf(n,o,u,p,x){if(o==="submit"&&u&&u.stateNode===x){var C=_p((x[$t]||null).action),O=p.submitter;O&&(o=(o=O[$t]||null)?_p(o.formAction):O.getAttribute("formAction"),o!==null&&(C=o,O=null));var H=new ia("action","action",null,p,x);n.push({event:H,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Mu!==0){var de=O?ld(x,O):new FormData(x);$n(u,{pending:!0,data:de,method:x.method,action:C},null,de)}}else typeof C=="function"&&(H.preventDefault(),de=O?ld(x,O):new FormData(x),$n(u,{pending:!0,data:de,method:x.method,action:C},C,de))},currentTarget:x}]})}}for(var Il=0;Il<Vu.length;Il++){var ud=Vu[Il],vp=ud.toLowerCase(),gf=ud[0].toUpperCase()+ud.slice(1);va(vp,"on"+gf)}va(iu,"onAnimationEnd"),va(au,"onAnimationIteration"),va(ou,"onAnimationStart"),va("dblclick","onDoubleClick"),va("focusin","onFocus"),va("focusout","onBlur"),va(Nc,"onTransitionRun"),va(Ss,"onTransitionStart"),va(su,"onTransitionCancel"),va(Ps,"onTransitionEnd"),po("onMouseEnter",["mouseout","mouseover"]),po("onMouseLeave",["mouseout","mouseover"]),po("onPointerEnter",["pointerout","pointerover"]),po("onPointerLeave",["pointerout","pointerover"]),Hi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_c));function yf(n,o){o=(o&4)!==0;for(var u=0;u<n.length;u++){var p=n[u],x=p.event;p=p.listeners;e:{var C=void 0;if(o)for(var O=p.length-1;0<=O;O--){var H=p[O],de=H.instance,De=H.currentTarget;if(H=H.listener,de!==C&&x.isPropagationStopped())break e;C=H,x.currentTarget=De;try{C(x)}catch(Xe){Yc(Xe)}x.currentTarget=null,C=de}else for(O=0;O<p.length;O++){if(H=p[O],de=H.instance,De=H.currentTarget,H=H.listener,de!==C&&x.isPropagationStopped())break e;C=H,x.currentTarget=De;try{C(x)}catch(Xe){Yc(Xe)}x.currentTarget=null,C=de}}}}function Cn(n,o){var u=o[it];u===void 0&&(u=o[it]=new Set);var p=n+"__bubble";u.has(p)||(xp(o,n,2,!1),u.add(p))}function _f(n,o,u){var p=0;o&&(p|=4),xp(u,n,p,o)}var xh="_reactListening"+Math.random().toString(36).slice(2);function vf(n){if(!n[xh]){n[xh]=!0,an.forEach(function(u){u!=="selectionchange"&&(cd.has(u)||_f(u,!1,n),_f(u,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[xh]||(o[xh]=!0,_f("selectionchange",!1,o))}}function xp(n,o,u,p){switch(ft(o)){case 2:var x=fe;break;case 8:x=Re;break;default:x=Be}u=x.bind(null,o,u,n),x=void 0,!ci||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),p?x!==void 0?n.addEventListener(o,u,{capture:!0,passive:x}):n.addEventListener(o,u,!0):x!==void 0?n.addEventListener(o,u,{passive:x}):n.addEventListener(o,u,!1)}function xf(n,o,u,p,x){var C=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var O=p.tag;if(O===3||O===4){var H=p.stateNode.containerInfo;if(H===x)break;if(O===4)for(O=p.return;O!==null;){var de=O.tag;if((de===3||de===4)&&O.stateNode.containerInfo===x)return;O=O.return}for(;H!==null;){if(O=rn(H),O===null)return;if(de=O.tag,de===5||de===6||de===26||de===27){p=C=O;continue e}H=H.parentNode}}p=p.return}Mr(function(){var De=C,Xe=nl(u),Je=[];e:{var Oe=aa.get(n);if(Oe!==void 0){var Fe=ia,tn=n;switch(n){case"keypress":if(Xt(u)===0)break e;case"keydown":case"keyup":Fe=Yl;break;case"focusin":tn="focus",Fe=ms;break;case"focusout":tn="blur",Fe=ms;break;case"beforeblur":case"afterblur":Fe=ms;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=ql;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=Qr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=Sd;break;case iu:case au:case ou:Fe=wr;break;case Ps:Fe=Pd;break;case"scroll":case"scrollend":Fe=Ec;break;case"wheel":Fe=Fu;break;case"copy":case"cut":case"paste":Fe=Hl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=Rc;break;case"toggle":case"beforetoggle":Fe=_s}var Yt=(o&4)!==0,Jn=!Yt&&(n==="scroll"||n==="scrollend"),Pe=Yt?Oe!==null?Oe+"Capture":null:Oe;Yt=[];for(var we=De,Ae;we!==null;){var Qe=we;if(Ae=Qe.stateNode,Qe=Qe.tag,Qe!==5&&Qe!==26&&Qe!==27||Ae===null||Pe===null||(Qe=Rn(we,Pe),Qe!=null&&Yt.push(bh(we,Qe,Ae))),Jn)break;we=we.return}0<Yt.length&&(Oe=new Fe(Oe,tn,null,u,Xe),Je.push({event:Oe,listeners:Yt}))}}if((o&7)===0){e:{if(Oe=n==="mouseover"||n==="pointerover",Fe=n==="mouseout"||n==="pointerout",Oe&&u!==go&&(tn=u.relatedTarget||u.fromElement)&&(rn(tn)||tn[lr]))break e;if((Fe||Oe)&&(Oe=Xe.window===Xe?Xe:(Oe=Xe.ownerDocument)?Oe.defaultView||Oe.parentWindow:window,Fe?(tn=u.relatedTarget||u.toElement,Fe=De,tn=tn?rn(tn):null,tn!==null&&(Jn=ee(tn),Yt=tn.tag,tn!==Jn||Yt!==5&&Yt!==27&&Yt!==6)&&(tn=null)):(Fe=null,tn=De),Fe!==tn)){if(Yt=ql,Qe="onMouseLeave",Pe="onMouseEnter",we="mouse",(n==="pointerout"||n==="pointerover")&&(Yt=Rc,Qe="onPointerLeave",Pe="onPointerEnter",we="pointer"),Jn=Fe==null?Oe:Er(Fe),Ae=tn==null?Oe:Er(tn),Oe=new Yt(Qe,we+"leave",Fe,u,Xe),Oe.target=Jn,Oe.relatedTarget=Ae,Qe=null,rn(Xe)===De&&(Yt=new Yt(Pe,we+"enter",tn,u,Xe),Yt.target=Ae,Yt.relatedTarget=Jn,Qe=Yt),Jn=Qe,Fe&&tn)t:{for(Yt=Fe,Pe=tn,we=0,Ae=Yt;Ae;Ae=Ll(Ae))we++;for(Ae=0,Qe=Pe;Qe;Qe=Ll(Qe))Ae++;for(;0<we-Ae;)Yt=Ll(Yt),we--;for(;0<Ae-we;)Pe=Ll(Pe),Ae--;for(;we--;){if(Yt===Pe||Pe!==null&&Yt===Pe.alternate)break t;Yt=Ll(Yt),Pe=Ll(Pe)}Yt=null}else Yt=null;Fe!==null&&qs(Je,Oe,Fe,Yt,!1),tn!==null&&Jn!==null&&qs(Je,Jn,tn,Yt,!0)}}e:{if(Oe=De?Er(De):window,Fe=Oe.nodeName&&Oe.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&Oe.type==="file")var Lt=Oc;else if(Uh(Oe))if(Wo)Lt=Wh;else{Lt=Ad;var wn=Vh}else Fe=Oe.nodeName,!Fe||Fe.toLowerCase()!=="input"||Oe.type!=="checkbox"&&Oe.type!=="radio"?De&&Ka(De.elementType)&&(Lt=Oc):Lt=Gh;if(Lt&&(Lt=Lt(n,De))){kc(Je,Lt,u,Xe);break e}wn&&wn(n,Oe,De),n==="focusout"&&De&&Oe.type==="number"&&De.memoizedProps.value!=null&&Zl(Oe,"number",Oe.value)}switch(wn=De?Er(De):window,n){case"focusin":(Uh(wn)||wn.contentEditable==="true")&&(Zo=wn,_o=De,bs=null);break;case"focusout":bs=_o=Zo=null;break;case"mousedown":Fc=!0;break;case"contextmenu":case"mouseup":case"dragend":Fc=!1,qh(Je,u,Xe);break;case"selectionchange":if(Zh)break;case"keydown":case"keyup":qh(Je,u,Xe)}var jt;if(al)e:{switch(n){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else ll?Fh(n,u)&&(Jt="onCompositionEnd"):n==="keydown"&&u.keyCode===229&&(Jt="onCompositionStart");Jt&&(Kl&&u.locale!=="ko"&&(ll||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&ll&&(jt=Ft()):(vr=Xe,Gn="value"in vr?vr.value:vr.textContent,ll=!0)),wn=hd(De,Jt),0<wn.length&&(Jt=new Bh(Jt,n,null,u,Xe),Je.push({event:Jt,listeners:wn}),jt?Jt.data=jt:(jt=Ql(u),jt!==null&&(Jt.data=jt)))),(jt=Td?vs(n,u):Nh(n,u))&&(Jt=hd(De,"onBeforeInput"),0<Jt.length&&(wn=new Bh("onBeforeInput","beforeinput",null,u,Xe),Je.push({event:wn,listeners:Jt}),wn.data=jt)),mf(Je,n,De,u,Xe)}yf(Je,o)})}function bh(n,o,u){return{instance:n,listener:o,currentTarget:u}}function hd(n,o){for(var u=o+"Capture",p=[];n!==null;){var x=n,C=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||C===null||(x=Rn(n,u),x!=null&&p.unshift(bh(n,x,C)),x=Rn(n,o),x!=null&&p.push(bh(n,x,C))),n.tag===3)return p;n=n.return}return[]}function Ll(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function qs(n,o,u,p,x){for(var C=o._reactName,O=[];u!==null&&u!==p;){var H=u,de=H.alternate,De=H.stateNode;if(H=H.tag,de!==null&&de===p)break;H!==5&&H!==26&&H!==27||De===null||(de=De,x?(De=Rn(u,C),De!=null&&O.unshift(bh(u,De,de))):x||(De=Rn(u,C),De!=null&&O.push(bh(u,De,de)))),u=u.return}O.length!==0&&n.push({event:o,listeners:O})}var bp=/\r\n?/g,wp=/\u0000|\uFFFD/g;function bf(n){return(typeof n=="string"?n:""+n).replace(bp,`
`).replace(wp,"")}function wf(n,o){return o=bf(o),bf(n)===o}function wh(){}function Zn(n,o,u,p,x,C){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Ya(n,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Ya(n,""+p);break;case"className":In(n,"class",p);break;case"tabIndex":In(n,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":In(n,u,p);break;case"style":Uo(n,p,C);break;case"data":if(o!=="object"){In(n,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){n.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(u);break}p=cn(""+p),n.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){n.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(u==="formAction"?(o!=="input"&&Zn(n,o,"name",x.name,x,null),Zn(n,o,"formEncType",x.formEncType,x,null),Zn(n,o,"formMethod",x.formMethod,x,null),Zn(n,o,"formTarget",x.formTarget,x,null)):(Zn(n,o,"encType",x.encType,x,null),Zn(n,o,"method",x.method,x,null),Zn(n,o,"target",x.target,x,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(u);break}p=cn(""+p),n.setAttribute(u,p);break;case"onClick":p!=null&&(n.onclick=wh);break;case"onScroll":p!=null&&Cn("scroll",n);break;case"onScrollEnd":p!=null&&Cn("scrollend",n);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(k(61));if(u=p.__html,u!=null){if(x.children!=null)throw Error(k(60));n.innerHTML=u}}break;case"multiple":n.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":n.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){n.removeAttribute("xlink:href");break}u=cn(""+p),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,""+p):n.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,""):n.removeAttribute(u);break;case"capture":case"download":p===!0?n.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,p):n.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?n.setAttribute(u,p):n.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?n.removeAttribute(u):n.setAttribute(u,p);break;case"popover":Cn("beforetoggle",n),Cn("toggle",n),si(n,"popover",p);break;case"xlinkActuate":$a(n,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":$a(n,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":$a(n,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":$a(n,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":$a(n,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":$a(n,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":$a(n,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":$a(n,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":$a(n,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":si(n,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=mo.get(u)||u,si(n,u,p))}}function dd(n,o,u,p,x,C){switch(u){case"style":Uo(n,p,C);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(k(61));if(u=p.__html,u!=null){if(x.children!=null)throw Error(k(60));n.innerHTML=u}}break;case"children":typeof p=="string"?Ya(n,p):(typeof p=="number"||typeof p=="bigint")&&Ya(n,""+p);break;case"onScroll":p!=null&&Cn("scroll",n);break;case"onScrollEnd":p!=null&&Cn("scrollend",n);break;case"onClick":p!=null&&(n.onclick=wh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Vl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),C=n[$t]||null,C=C!=null?C[u]:null,typeof C=="function"&&n.removeEventListener(o,C,x),typeof p=="function")){typeof C!="function"&&C!==null&&(u in n?n[u]=null:n.hasAttribute(u)&&n.removeAttribute(u)),n.addEventListener(o,p,x);break e}u in n?n[u]=p:p===!0?n.setAttribute(u,""):si(n,u,p)}}}function Hr(n,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cn("error",n),Cn("load",n);var p=!1,x=!1,C;for(C in u)if(u.hasOwnProperty(C)){var O=u[C];if(O!=null)switch(C){case"src":p=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(k(137,o));default:Zn(n,o,C,O,u,null)}}x&&Zn(n,o,"srcSet",u.srcSet,u,null),p&&Zn(n,o,"src",u.src,u,null);return;case"input":Cn("invalid",n);var H=C=O=x=null,de=null,De=null;for(p in u)if(u.hasOwnProperty(p)){var Xe=u[p];if(Xe!=null)switch(p){case"name":x=Xe;break;case"type":O=Xe;break;case"checked":de=Xe;break;case"defaultChecked":De=Xe;break;case"value":C=Xe;break;case"defaultValue":H=Xe;break;case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(k(137,o));break;default:Zn(n,o,p,Xe,u,null)}}cs(n,C,H,de,De,O,x,!1),Ou(n);return;case"select":Cn("invalid",n),p=O=C=null;for(x in u)if(u.hasOwnProperty(x)&&(H=u[x],H!=null))switch(x){case"value":C=H;break;case"defaultValue":O=H;break;case"multiple":p=H;default:Zn(n,o,x,H,u,null)}o=C,u=O,n.multiple=!!p,o!=null?No(n,!!p,o,!1):u!=null&&No(n,!!p,u,!0);return;case"textarea":Cn("invalid",n),C=x=p=null;for(O in u)if(u.hasOwnProperty(O)&&(H=u[O],H!=null))switch(O){case"value":p=H;break;case"defaultValue":x=H;break;case"children":C=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(k(91));break;default:Zn(n,o,O,H,u,null)}hs(n,p,x,C),Ou(n);return;case"option":for(de in u)if(u.hasOwnProperty(de)&&(p=u[de],p!=null))switch(de){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Zn(n,o,de,p,u,null)}return;case"dialog":Cn("beforetoggle",n),Cn("toggle",n),Cn("cancel",n),Cn("close",n);break;case"iframe":case"object":Cn("load",n);break;case"video":case"audio":for(p=0;p<_c.length;p++)Cn(_c[p],n);break;case"image":Cn("error",n),Cn("load",n);break;case"details":Cn("toggle",n);break;case"embed":case"source":case"link":Cn("error",n),Cn("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(De in u)if(u.hasOwnProperty(De)&&(p=u[De],p!=null))switch(De){case"children":case"dangerouslySetInnerHTML":throw Error(k(137,o));default:Zn(n,o,De,p,u,null)}return;default:if(Ka(o)){for(Xe in u)u.hasOwnProperty(Xe)&&(p=u[Xe],p!==void 0&&dd(n,o,Xe,p,u,void 0));return}}for(H in u)u.hasOwnProperty(H)&&(p=u[H],p!=null&&Zn(n,o,H,p,u,null))}function Sp(n,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,C=null,O=null,H=null,de=null,De=null,Xe=null;for(Fe in u){var Je=u[Fe];if(u.hasOwnProperty(Fe)&&Je!=null)switch(Fe){case"checked":break;case"value":break;case"defaultValue":de=Je;default:p.hasOwnProperty(Fe)||Zn(n,o,Fe,null,p,Je)}}for(var Oe in p){var Fe=p[Oe];if(Je=u[Oe],p.hasOwnProperty(Oe)&&(Fe!=null||Je!=null))switch(Oe){case"type":C=Fe;break;case"name":x=Fe;break;case"checked":De=Fe;break;case"defaultChecked":Xe=Fe;break;case"value":O=Fe;break;case"defaultValue":H=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(k(137,o));break;default:Fe!==Je&&Zn(n,o,Oe,Fe,p,Je)}}Wl(n,O,H,de,De,Xe,C,x);return;case"select":Fe=O=H=Oe=null;for(C in u)if(de=u[C],u.hasOwnProperty(C)&&de!=null)switch(C){case"value":break;case"multiple":Fe=de;default:p.hasOwnProperty(C)||Zn(n,o,C,null,p,de)}for(x in p)if(C=p[x],de=u[x],p.hasOwnProperty(x)&&(C!=null||de!=null))switch(x){case"value":Oe=C;break;case"defaultValue":H=C;break;case"multiple":O=C;default:C!==de&&Zn(n,o,x,C,p,de)}o=H,u=O,p=Fe,Oe!=null?No(n,!!u,Oe,!1):!!p!=!!u&&(o!=null?No(n,!!u,o,!0):No(n,!!u,u?[]:"",!1));return;case"textarea":Fe=Oe=null;for(H in u)if(x=u[H],u.hasOwnProperty(H)&&x!=null&&!p.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:Zn(n,o,H,null,p,x)}for(O in p)if(x=p[O],C=u[O],p.hasOwnProperty(O)&&(x!=null||C!=null))switch(O){case"value":Oe=x;break;case"defaultValue":Fe=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(k(91));break;default:x!==C&&Zn(n,o,O,x,p,C)}kh(n,Oe,Fe);return;case"option":for(var tn in u)if(Oe=u[tn],u.hasOwnProperty(tn)&&Oe!=null&&!p.hasOwnProperty(tn))switch(tn){case"selected":n.selected=!1;break;default:Zn(n,o,tn,null,p,Oe)}for(de in p)if(Oe=p[de],Fe=u[de],p.hasOwnProperty(de)&&Oe!==Fe&&(Oe!=null||Fe!=null))switch(de){case"selected":n.selected=Oe&&typeof Oe!="function"&&typeof Oe!="symbol";break;default:Zn(n,o,de,Oe,p,Fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yt in u)Oe=u[Yt],u.hasOwnProperty(Yt)&&Oe!=null&&!p.hasOwnProperty(Yt)&&Zn(n,o,Yt,null,p,Oe);for(De in p)if(Oe=p[De],Fe=u[De],p.hasOwnProperty(De)&&Oe!==Fe&&(Oe!=null||Fe!=null))switch(De){case"children":case"dangerouslySetInnerHTML":if(Oe!=null)throw Error(k(137,o));break;default:Zn(n,o,De,Oe,p,Fe)}return;default:if(Ka(o)){for(var Jn in u)Oe=u[Jn],u.hasOwnProperty(Jn)&&Oe!==void 0&&!p.hasOwnProperty(Jn)&&dd(n,o,Jn,void 0,p,Oe);for(Xe in p)Oe=p[Xe],Fe=u[Xe],!p.hasOwnProperty(Xe)||Oe===Fe||Oe===void 0&&Fe===void 0||dd(n,o,Xe,Oe,p,Fe);return}}for(var Pe in u)Oe=u[Pe],u.hasOwnProperty(Pe)&&Oe!=null&&!p.hasOwnProperty(Pe)&&Zn(n,o,Pe,null,p,Oe);for(Je in p)Oe=p[Je],Fe=u[Je],!p.hasOwnProperty(Je)||Oe===Fe||Oe==null&&Fe==null||Zn(n,o,Je,Oe,p,Fe)}var Sh=null,fd=null;function Qi(n){return n.nodeType===9?n:n.ownerDocument}function Ru(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vc(n,o){if(n===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&o==="foreignObject"?0:n}function Hs(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var pd=null;function Pp(){var n=window.event;return n&&n.type==="popstate"?n===pd?!1:(pd=n,!0):(pd=null,!1)}var Sf=typeof setTimeout=="function"?setTimeout:void 0,Cp=typeof clearTimeout=="function"?clearTimeout:void 0,Tp=typeof Promise=="function"?Promise:void 0,Ap=typeof queueMicrotask=="function"?queueMicrotask:typeof Tp<"u"?function(n){return Tp.resolve(null).then(n).catch(kl)}:Sf;function kl(n){setTimeout(function(){throw n})}function $s(n){return n==="head"}function Pf(n,o){var u=o,p=0,x=0;do{var C=u.nextSibling;if(n.removeChild(u),C&&C.nodeType===8)if(u=C.data,u==="/$"){if(0<p&&8>p){u=p;var O=n.ownerDocument;if(u&1&&Ol(O.documentElement),u&2&&Ol(O.body),u&4)for(u=O.head,Ol(u),O=u.firstChild;O;){var H=O.nextSibling,de=O.nodeName;O[qa]||de==="SCRIPT"||de==="STYLE"||de==="LINK"&&O.rel.toLowerCase()==="stylesheet"||u.removeChild(O),O=H}}if(x===0){n.removeChild(C),Or(o);return}x--}else u==="$"||u==="$?"||u==="$!"?x++:p=u.charCodeAt(0)-48;else p=0;u=C}while(u);Or(o)}function md(n){var o=n.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":md(u),pt(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}n.removeChild(u)}}function Ep(n,o,u,p){for(;n.nodeType===1;){var x=u;if(n.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(p){if(!n[qa])switch(o){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(C=n.getAttribute("rel"),C==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(C!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(C=n.getAttribute("src"),(C!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&C&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(o==="input"&&n.type==="hidden"){var C=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===C)return n}else return n;if(n=ho(n.nextSibling),n===null)break}return null}function sm(n,o,u){if(o==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!u||(n=ho(n.nextSibling),n===null))return null;return n}function Cf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function Mp(n,o){var u=n.ownerDocument;if(n.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),n._reactRetry=p}}function ho(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return n}var xc=null;function Tf(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var u=n.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return n;o--}else u==="/$"&&o++}n=n.previousSibling}return null}function Ph(n,o,u){switch(o=Qi(u),n){case"html":if(n=o.documentElement,!n)throw Error(k(452));return n;case"head":if(n=o.head,!n)throw Error(k(453));return n;case"body":if(n=o.body,!n)throw Error(k(454));return n;default:throw Error(k(451))}}function Ol(n){for(var o=n.attributes;o.length;)n.removeAttributeNode(o[0]);pt(n)}var fa=new Map,Rp=new Set;function gd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Xs=ht.d;ht.d={f:bc,r:Ci,D:Dp,C:Ef,L:lm,m:zp,X:um,S:Ip,M:Lp};function bc(){var n=Xs.f(),o=mh();return n||o}function Ci(n){var o=Qt(n);o!==null&&o.tag===5&&o.type==="form"?Un(o):Xs.r(n)}var Bl=typeof document>"u"?null:document;function Af(n,o,u){var p=Bl;if(p&&typeof o=="string"&&o){var x=$i(o);x='link[rel="'+n+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),Rp.has(x)||(Rp.add(x),n={rel:n,crossOrigin:u,href:o},p.querySelector(x)===null&&(o=p.createElement("link"),Hr(o,"link",n),ur(o),p.head.appendChild(o)))}}function Dp(n){Xs.D(n),Af("dns-prefetch",n,null)}function Ef(n,o){Xs.C(n,o),Af("preconnect",n,o)}function lm(n,o,u){Xs.L(n,o,u);var p=Bl;if(p&&n&&o){var x='link[rel="preload"][as="'+$i(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+$i(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+$i(u.imageSizes)+'"]')):x+='[href="'+$i(n)+'"]';var C=x;switch(o){case"style":C=Fl(n);break;case"script":C=Du(n)}fa.has(C)||(n=Se({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:n,as:o},u),fa.set(C,n),p.querySelector(x)!==null||o==="style"&&p.querySelector(wc(C))||o==="script"&&p.querySelector(zu(C))||(o=p.createElement("link"),Hr(o,"link",n),ur(o),p.head.appendChild(o)))}}function zp(n,o){Xs.m(n,o);var u=Bl;if(u&&n){var p=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+$i(p)+'"][href="'+$i(n)+'"]',C=x;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Du(n)}if(!fa.has(C)&&(n=Se({rel:"modulepreload",href:n},o),fa.set(C,n),u.querySelector(x)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(zu(C)))return}p=u.createElement("link"),Hr(p,"link",n),ur(p),u.head.appendChild(p)}}}function Ip(n,o,u){Xs.S(n,o,u);var p=Bl;if(p&&n){var x=ya(p).hoistableStyles,C=Fl(n);o=o||"default";var O=x.get(C);if(!O){var H={loading:0,preload:null};if(O=p.querySelector(wc(C)))H.loading=5;else{n=Se({rel:"stylesheet",href:n,"data-precedence":o},u),(u=fa.get(C))&&Th(n,u);var de=O=p.createElement("link");ur(de),Hr(de,"link",n),de._p=new Promise(function(De,Xe){de.onload=De,de.onerror=Xe}),de.addEventListener("load",function(){H.loading|=1}),de.addEventListener("error",function(){H.loading|=2}),H.loading|=4,Nl(O,o,p)}O={type:"stylesheet",instance:O,count:1,state:H},x.set(C,O)}}}function um(n,o){Xs.X(n,o);var u=Bl;if(u&&n){var p=ya(u).hoistableScripts,x=Du(n),C=p.get(x);C||(C=u.querySelector(zu(x)),C||(n=Se({src:n,async:!0},o),(o=fa.get(x))&&Ah(n,o),C=u.createElement("script"),ur(C),Hr(C,"link",n),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(x,C))}}function Lp(n,o){Xs.M(n,o);var u=Bl;if(u&&n){var p=ya(u).hoistableScripts,x=Du(n),C=p.get(x);C||(C=u.querySelector(zu(x)),C||(n=Se({src:n,async:!0,type:"module"},o),(o=fa.get(x))&&Ah(n,o),C=u.createElement("script"),ur(C),Hr(C,"link",n),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},p.set(x,C))}}function yd(n,o,u,p){var x=(x=Dt.current)?gd(x):null;if(!x)throw Error(k(446));switch(n){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Fl(u.href),u=ya(x).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){n=Fl(u.href);var C=ya(x).hoistableStyles,O=C.get(n);if(O||(x=x.ownerDocument||x,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(n,O),(C=x.querySelector(wc(n)))&&!C._p&&(O.instance=C,O.state.loading=5),fa.has(n)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},fa.set(n,u),C||Mf(x,n,u,O.state))),o&&p===null)throw Error(k(528,""));return O}if(o&&p!==null)throw Error(k(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Du(u),u=ya(x).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(k(444,n))}}function Fl(n){return'href="'+$i(n)+'"'}function wc(n){return'link[rel="stylesheet"]['+n+"]"}function Sc(n){return Se({},n,{"data-precedence":n.precedence,precedence:null})}function Mf(n,o,u,p){n.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=n.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Hr(o,"link",u),ur(o),n.head.appendChild(o))}function Du(n){return'[src="'+$i(n)+'"]'}function zu(n){return"script[async]"+n}function Ch(n,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=n.querySelector('style[data-href~="'+$i(u.href)+'"]');if(p)return o.instance=p,ur(p),p;var x=Se({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(n.ownerDocument||n).createElement("style"),ur(p),Hr(p,"style",x),Nl(p,u.precedence,n),o.instance=p;case"stylesheet":x=Fl(u.href);var C=n.querySelector(wc(x));if(C)return o.state.loading|=4,o.instance=C,ur(C),C;p=Sc(u),(x=fa.get(x))&&Th(p,x),C=(n.ownerDocument||n).createElement("link"),ur(C);var O=C;return O._p=new Promise(function(H,de){O.onload=H,O.onerror=de}),Hr(C,"link",p),o.state.loading|=4,Nl(C,u.precedence,n),o.instance=C;case"script":return C=Du(u.src),(x=n.querySelector(zu(C)))?(o.instance=x,ur(x),x):(p=u,(x=fa.get(C))&&(p=Se({},u),Ah(p,x)),n=n.ownerDocument||n,x=n.createElement("script"),ur(x),Hr(x,"link",p),n.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(k(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Nl(p,u.precedence,n));return o.instance}function Nl(n,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=p.length?p[p.length-1]:null,C=x,O=0;O<p.length;O++){var H=p[O];if(H.dataset.precedence===o)C=H;else if(C!==x)break}C?C.parentNode.insertBefore(n,C.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(n,o.firstChild))}function Th(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.title==null&&(n.title=o.title)}function Ah(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.integrity==null&&(n.integrity=o.integrity)}var Pc=null;function kp(n,o,u){if(Pc===null){var p=new Map,x=Pc=new Map;x.set(u,p)}else x=Pc,p=x.get(u),p||(p=new Map,x.set(u,p));if(p.has(n))return p;for(p.set(n,null),u=u.getElementsByTagName(n),x=0;x<u.length;x++){var C=u[x];if(!(C[qa]||C[Nt]||n==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var O=C.getAttribute(o)||"";O=n+O;var H=p.get(O);H?H.push(C):p.set(O,[C])}}return p}function i(n,o,u){n=n.ownerDocument||n,n.head.insertBefore(u,o==="title"?n.querySelector("head > title"):null)}function t(n,o,u){if(u===1||o.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return n=o.disabled,typeof o.precedence=="string"&&n==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function r(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var s=null;function h(){}function m(n,o,u){if(s===null)throw Error(k(475));var p=s;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var x=Fl(u.href),C=n.querySelector(wc(x));if(C){n=C._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(p.count++,p=v.bind(p),n.then(p,p)),o.state.loading|=4,o.instance=C,ur(C);return}C=n.ownerDocument||n,u=Sc(u),(x=fa.get(x))&&Th(u,x),C=C.createElement("link"),ur(C);var O=C;O._p=new Promise(function(H,de){O.onload=H,O.onerror=de}),Hr(C,"link",u),o.instance=C}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,n),(n=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=v.bind(p),n.addEventListener("load",o),n.addEventListener("error",o))}}function y(){if(s===null)throw Error(k(475));var n=s;return n.stylesheets&&n.count===0&&P(n,n.stylesheets),0<n.count?function(o){var u=setTimeout(function(){if(n.stylesheets&&P(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(u)}}:null}function v(){if(this.count--,this.count===0){if(this.stylesheets)P(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var b=null;function P(n,o){n.stylesheets=null,n.unsuspend!==null&&(n.count++,b=new Map,o.forEach(A,n),b=null,v.call(n))}function A(n,o){if(!(o.state.loading&4)){var u=b.get(n);if(u)var p=u.get(null);else{u=new Map,b.set(n,u);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<x.length;C++){var O=x[C];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(u.set(O.dataset.precedence,O),p=O)}p&&u.set(null,p)}x=o.instance,O=x.getAttribute("data-precedence"),C=u.get(O)||p,C===p&&u.set(null,x),u.set(O,x),this.count++,p=v.bind(this),x.addEventListener("load",p),x.addEventListener("error",p),C?C.parentNode.insertBefore(x,C.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),o.state.loading|=4}}var D={$$typeof:nt,Provider:null,Consumer:null,_currentValue:tt,_currentValue2:tt,_threadCount:0};function L(n,o,u,p,x,C,O,H){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bt(0),this.hiddenUpdates=bt(null),this.identifierPrefix=p,this.onUncaughtError=x,this.onCaughtError=C,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=H,this.incompleteTransitions=new Map}function F(n,o,u,p,x,C,O,H,de,De,Xe,Je){return n=new L(n,o,u,O,H,de,De,Je),o=1,C===!0&&(o|=24),C=sa(3,null,null,o),n.current=C,C.stateNode=n,o=Jo(),o.refCount++,n.pooledCache=o,o.refCount++,C.memoizedState={element:p,isDehydrated:u,cache:o},mu(C),n}function N(n){return n?(n=sn,n):sn}function Z(n,o,u,p,x,C){x=N(x),p.context===null?p.context=x:p.pendingContext=x,p=ro(o),p.payload={element:u},C=C===void 0?null:C,C!==null&&(p.callback=C),u=Co(n,p,o),u!==null&&(da(u,n,o),wl(u,n,o))}function X(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var u=n.retryLane;n.retryLane=u!==0&&u<o?u:o}}function ne(n,o){X(n,o),(n=n.alternate)&&X(n,o)}function be(n){if(n.tag===13){var o=oa(n,67108864);o!==null&&da(o,n,67108864),ne(n,67108864)}}var le=!0;function fe(n,o,u,p){var x=Ue.T;Ue.T=null;var C=ht.p;try{ht.p=2,Be(n,o,u,p)}finally{ht.p=C,Ue.T=x}}function Re(n,o,u,p){var x=Ue.T;Ue.T=null;var C=ht.p;try{ht.p=8,Be(n,o,u,p)}finally{ht.p=C,Ue.T=x}}function Be(n,o,u,p){if(le){var x=Ke(p);if(x===null)xf(n,o,p,dt,u),gn(n,p);else if($r(x,n,o,u,p))p.stopPropagation();else if(gn(n,p),o&4&&-1<Ct.indexOf(n)){for(;x!==null;){var C=Qt(x);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var O=ye(C.pendingLanes);if(O!==0){var H=C;for(H.pendingLanes|=2,H.entangledLanes|=2;O;){var de=1<<31-ge(O);H.entanglements[1]|=de,O&=~de}Bo(C),(Xn&6)===0&&(dh=nr()+500,yc(0))}}break;case 13:H=oa(C,2),H!==null&&da(H,C,2),mh(),ne(C,2)}if(C=Ke(p),C===null&&xf(n,o,p,dt,u),C===x)break;x=C}x!==null&&p.stopPropagation()}else xf(n,o,p,null,u)}}function Ke(n){return n=nl(n),at(n)}var dt=null;function at(n){if(dt=null,n=rn(n),n!==null){var o=ee(n);if(o===null)n=null;else{var u=o.tag;if(u===13){if(n=E(o),n!==null)return n;n=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}return dt=n,null}function ft(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Kr()){case Br:return 2;case Ei:return 8;case oi:case ga:return 32;case na:return 268435456;default:return 32}default:return 32}}var Rt=!1,ot=null,lt=null,Ve=null,Bt=new Map,Ut=new Map,Et=[],Ct="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gn(n,o){switch(n){case"focusin":case"focusout":ot=null;break;case"dragenter":case"dragleave":lt=null;break;case"mouseover":case"mouseout":Ve=null;break;case"pointerover":case"pointerout":Bt.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ut.delete(o.pointerId)}}function Kn(n,o,u,p,x,C){return n===null||n.nativeEvent!==C?(n={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:C,targetContainers:[x]},o!==null&&(o=Qt(o),o!==null&&be(o)),n):(n.eventSystemFlags|=p,o=n.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),n)}function $r(n,o,u,p,x){switch(o){case"focusin":return ot=Kn(ot,n,o,u,p,x),!0;case"dragenter":return lt=Kn(lt,n,o,u,p,x),!0;case"mouseover":return Ve=Kn(Ve,n,o,u,p,x),!0;case"pointerover":var C=x.pointerId;return Bt.set(C,Kn(Bt.get(C)||null,n,o,u,p,x)),!0;case"gotpointercapture":return C=x.pointerId,Ut.set(C,Kn(Ut.get(C)||null,n,o,u,p,x)),!0}return!1}function pi(n){var o=rn(n.target);if(o!==null){var u=ee(o);if(u!==null){if(o=u.tag,o===13){if(o=E(u),o!==null){n.blockedOn=o,Vr(n.priority,function(){if(u.tag===13){var p=Wi();p=Ht(p);var x=oa(u,p);x!==null&&da(x,u,p),ne(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){n.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ji(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var u=Ke(n.nativeEvent);if(u===null){u=n.nativeEvent;var p=new u.constructor(u.type,u);go=p,u.target.dispatchEvent(p),go=null}else return o=Qt(u),o!==null&&be(o),n.blockedOn=u,!1;o.shift()}return!0}function ea(n,o,u){Ji(n)&&u.delete(o)}function mi(){Rt=!1,ot!==null&&Ji(ot)&&(ot=null),lt!==null&&Ji(lt)&&(lt=null),Ve!==null&&Ji(Ve)&&(Ve=null),Bt.forEach(ea),Ut.forEach(ea)}function Qn(n,o){n.blockedOn===o&&(n.blockedOn=null,Rt||(Rt=!0,R.unstable_scheduleCallback(R.unstable_NormalPriority,mi)))}var kr=null;function ai(n){kr!==n&&(kr=n,R.unstable_scheduleCallback(R.unstable_NormalPriority,function(){kr===n&&(kr=null);for(var o=0;o<n.length;o+=3){var u=n[o],p=n[o+1],x=n[o+2];if(typeof p!="function"){if(at(p||u)===null)continue;break}var C=Qt(u);C!==null&&(n.splice(o,3),o-=3,$n(C,{pending:!0,data:x,method:u.method,action:p},p,x))}}))}function Or(n){function o(de){return Qn(de,n)}ot!==null&&Qn(ot,n),lt!==null&&Qn(lt,n),Ve!==null&&Qn(Ve,n),Bt.forEach(o),Ut.forEach(o);for(var u=0;u<Et.length;u++){var p=Et[u];p.blockedOn===n&&(p.blockedOn=null)}for(;0<Et.length&&(u=Et[0],u.blockedOn===null);)pi(u),u.blockedOn===null&&Et.shift();if(u=(n.ownerDocument||n).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var x=u[p],C=u[p+1],O=x[$t]||null;if(typeof C=="function")O||ai(u);else if(O){var H=null;if(C&&C.hasAttribute("formAction")){if(x=C,O=C[$t]||null)H=O.formAction;else if(at(x)!==null)continue}else H=O.action;typeof H=="function"?u[p+1]=H:(u.splice(p,3),p-=3),ai(u)}}}function Ti(n){this._internalRoot=n}ta.prototype.render=Ti.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(k(409));var u=o.current,p=Wi();Z(u,p,n,o,null,null)},ta.prototype.unmount=Ti.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;Z(n.current,2,null,n,null,null),mh(),o[lr]=null}};function ta(n){this._internalRoot=n}ta.prototype.unstable_scheduleHydration=function(n){if(n){var o=Fr();n={blockedOn:null,target:n,priority:o};for(var u=0;u<Et.length&&o!==0&&o<Et[u].priority;u++);Et.splice(u,0,n),u===0&&pi(n)}};var Xr=U.version;if(Xr!=="19.1.1")throw Error(k(527,Xr,"19.1.1"));ht.findDOMNode=function(n){var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(k(188)):(n=Object.keys(n).join(","),Error(k(268,n)));return n=q(o),n=n!==null?te(n):null,n=n===null?null:n.stateNode,n};var pa={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:Ue,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tr.isDisabled&&Tr.supportsFiber)try{qi=Tr.inject(pa),gr=Tr}catch{}}return Df.createRoot=function(n,o){if(!Q(n))throw Error(k(299));var u=!1,p="",x=Kc,C=Md,O=Gf,H=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(H=o.unstable_transitionCallbacks)),o=F(n,1,!1,null,null,u,p,x,C,O,H,null),n[lr]=o.current,vf(n),new Ti(o)},Df.hydrateRoot=function(n,o,u){if(!Q(n))throw Error(k(299));var p=!1,x="",C=Kc,O=Md,H=Gf,de=null,De=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(C=u.onUncaughtError),u.onCaughtError!==void 0&&(O=u.onCaughtError),u.onRecoverableError!==void 0&&(H=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(de=u.unstable_transitionCallbacks),u.formState!==void 0&&(De=u.formState)),o=F(n,1,!0,o,u??null,p,x,C,O,H,de,De),o.context=N(null),u=o.current,p=Wi(),p=Ht(p),x=ro(p),x.callback=null,Co(u,x,p),u=p,o.current.lanes=u,xe(o,u),Bo(o),n[lr]=o.current,vf(n),new ta(o)},Df.version="19.1.1",Df}var rg;function Ty(){if(rg)return fm.exports;rg=1;function R(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(R)}catch(U){console.error(U)}}return R(),fm.exports=Cy(),fm.exports}var Ay=Ty();const Ey="/what_makes_lands_happy/world-map-svgrepo-com.svg",ym=JSON.parse('[{"Country":"Finland","Country_clean":"finland","Region":"Western Europe","Happiness":7.741,"Average Wage (USD/year)":46230,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":13.54,"Women Safety Index":0.924,"Average Winter Temperature":-12.356432,"Average Summer Temperature":-4.902662,"Population":5540745,"Energy Per Capita":58966.16,"% of Power from Fossil Fuels":10.769,"% of Power from Nuclear":34.333,"% of Power from Renewables":54.898,"% of Agricultural Land":7.4618100417,"% of Forest Land":73.7264996577,"Territory":303947.7,"Average Rainfall":536,"Corruption":0.1622093022,"Wheat Production (tonnes)":2640555,"Rye Production (tonnes)":1200,"Potatoes Production (tonnes)":38388000,"Meat, chicken Production (tonnes)":54950,"Avocados Production (tonnes)":2243396.8,"Petrol Price (USD/liter)":2.64,"Daily Oil Consumption (Barrels)":210030,"CO2 Emissions (ton per capita)":7.372854761},{"Country":"Denmark","Country_clean":"denmark","Region":"Western Europe","Happiness":7.583,"Average Wage (USD/year)":58430,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":15.04,"Women Safety Index":0.932,"Average Winter Temperature":1.278225,"Average Summer Temperature":5.266599,"Population":5882261,"Energy Per Capita":32197.939,"% of Power from Fossil Fuels":16.037,"% of Power from Nuclear":0,"% of Power from Renewables":83.963,"% of Agricultural Land":65.45,"% of Forest Land":15.7345,"Territory":40000,"Average Rainfall":703,"Corruption":0.1622093022,"Wheat Production (tonnes)":37885740,"Rye Production (tonnes)":2000,"Potatoes Production (tonnes)":28781776,"Meat, chicken Production (tonnes)":94712,"Avocados Production (tonnes)":2300,"Petrol Price (USD/liter)":2.65,"Daily Oil Consumption (Barrels)":158194,"CO2 Emissions (ton per capita)":5.107988509},{"Country":"Iceland","Country_clean":"iceland","Region":"Western Europe","Happiness":7.525,"Average Wage (USD/year)":67488,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.67,"Women Safety Index":0.924,"Average Winter Temperature":-4.115238,"Average Summer Temperature":-3.5402563,"Population":372899,"Energy Per Capita":165870.875,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":99.986,"% of Agricultural Land":18.5659030051,"% of Forest Land":0.5157522563,"Territory":100830,"Average Rainfall":1940,"Corruption":0.2001170814,"Wheat Production (tonnes)":1290.74,"Rye Production (tonnes)":46331.4,"Potatoes Production (tonnes)":294,"Meat, chicken Production (tonnes)":2790,"Avocados Production (tonnes)":84114,"Petrol Price (USD/liter)":2.6,"Daily Oil Consumption (Barrels)":19090,"CO2 Emissions (ton per capita)":4.548442258},{"Country":"Sweden","Country_clean":"sweden","Region":"Western Europe","Happiness":7.344,"Average Wage (USD/year)":47020,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.2,"Women Safety Index":0.926,"Average Winter Temperature":-8.132298,"Average Summer Temperature":-2.8563125,"Population":10549347,"Energy Per Capita":59926.805,"% of Power from Fossil Fuels":1.782,"% of Power from Nuclear":29.835,"% of Power from Renewables":68.383,"% of Agricultural Land":7.3730207707,"% of Forest Land":68.6990689582,"Territory":407283.54,"Average Rainfall":624,"Corruption":0.1622093022,"Wheat Production (tonnes)":5007.8,"Rye Production (tonnes)":34011.166,"Potatoes Production (tonnes)":3368,"Meat, chicken Production (tonnes)":279,"Avocados Production (tonnes)":38349.266,"Petrol Price (USD/liter)":2.3,"Daily Oil Consumption (Barrels)":322109,"CO2 Emissions (ton per capita)":3.405037919},{"Country":"Israel","Country_clean":"israel","Region":"Middle East and North Africa","Happiness":7.341,"Average Wage (USD/year)":39322,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":15.05,"Women Safety Index":0.703,"Average Winter Temperature":13.687662,"Average Summer Temperature":13.979397,"Population":9038309,"Energy Per Capita":33643.016,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":9.508,"% of Agricultural Land":29.7365988909,"% of Forest Land":6.4695009242,"Territory":21640,"Average Rainfall":435,"Corruption":0.2001170814,"Wheat Production (tonnes)":85400,"Rye Production (tonnes)":6347351.2,"Potatoes Production (tonnes)":1379223,"Meat, chicken Production (tonnes)":7098960,"Avocados Production (tonnes)":41217,"Petrol Price (USD/liter)":2.1,"Daily Oil Consumption (Barrels)":236249,"CO2 Emissions (ton per capita)":6.919593718},{"Country":"Netherlands","Country_clean":"netherlands","Region":"Western Europe","Happiness":7.319,"Average Wage (USD/year)":58828,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":13.54,"Women Safety Index":0.908,"Average Winter Temperature":3.8456993,"Average Summer Temperature":6.0171475,"Population":17564014,"Energy Per Capita":56000.762,"% of Power from Fossil Fuels":56.704,"% of Power from Nuclear":3.425,"% of Power from Renewables":39.871,"% of Agricultural Land":53.8164538165,"% of Forest Land":11.001980992,"Territory":33670,"Average Rainfall":778,"Corruption":0.1622093022,"Wheat Production (tonnes)":86110,"Rye Production (tonnes)":1142391.36,"Potatoes Production (tonnes)":14154907,"Meat, chicken Production (tonnes)":3756,"Avocados Production (tonnes)":5300,"Petrol Price (USD/liter)":2.47,"Daily Oil Consumption (Barrels)":937098,"CO2 Emissions (ton per capita)":8.437074627},{"Country":"Norway","Country_clean":"norway","Region":"Western Europe","Happiness":7.302,"Average Wage (USD/year)":55780,"Infant Survival Rate":1000,"Alcohol Consumption Rate":5.97,"Life Expectancy":81.8,"Netflix (USD/month)":12.17,"Women Safety Index":0.92,"Average Winter Temperature":-8.88361,"Average Summer Temperature":-4.446233,"Population":5434319,"Energy Per Capita":96926.234,"% of Power from Fossil Fuels":1.028,"% of Power from Nuclear":0,"% of Power from Renewables":98.972,"% of Agricultural Land":2.7040382134,"% of Forest Land":33.4581491751,"Territory":364270,"Average Rainfall":1414,"Corruption":0.1814468056,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":2.7,"Daily Oil Consumption (Barrels)":204090,"CO2 Emissions (ton per capita)":6.722269985},{"Country":"Luxembourg","Country_clean":"luxembourg","Region":"Western Europe","Happiness":7.122,"Average Wage (USD/year)":65854,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.924,"Average Winter Temperature":1.5896153,"Average Summer Temperature":2.84097,"Population":647599,"Energy Per Capita":60334.328,"% of Power from Fossil Fuels":14.159,"% of Power from Nuclear":0,"% of Power from Renewables":85.841,"% of Agricultural Land":51.5879058133,"% of Forest Land":34.4538272104,"Territory":2574.46,"Average Rainfall":934,"Corruption":0.1622093022,"Wheat Production (tonnes)":22278900,"Rye Production (tonnes)":2792668.5,"Potatoes Production (tonnes)":2749.14,"Meat, chicken Production (tonnes)":187,"Avocados Production (tonnes)":23943,"Petrol Price (USD/liter)":2.09,"Daily Oil Consumption (Barrels)":56194,"CO2 Emissions (ton per capita)":15.30642656},{"Country":"Switzerland","Country_clean":"switzerland","Region":"Western Europe","Happiness":7.06,"Average Wage (USD/year)":64824,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":20.46,"Women Safety Index":0.928,"Average Winter Temperature":-2.5467072,"Average Summer Temperature":-1.4338865,"Population":8740472,"Energy Per Capita":33350.754,"% of Power from Fossil Fuels":3.631,"% of Power from Nuclear":36.964,"% of Power from Renewables":59.406,"% of Agricultural Land":37.9496922649,"% of Forest Land":32.2086033203,"Territory":39509.63,"Average Rainfall":1537,"Corruption":0.2001170814,"Wheat Production (tonnes)":702495.4,"Rye Production (tonnes)":118594,"Potatoes Production (tonnes)":6485000,"Meat, chicken Production (tonnes)":100.8,"Avocados Production (tonnes)":226048.64,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":228194,"CO2 Emissions (ton per capita)":4.359041462},{"Country":"Australia","Country_clean":"australia","Region":"North America and ANZ","Happiness":7.057,"Average Wage (USD/year)":55206,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":12.12,"Women Safety Index":0.902,"Average Winter Temperature":28.664902,"Average Summer Temperature":29.092043,"Population":26177413,"Energy Per Capita":63458.84,"% of Power from Fossil Fuels":67.697,"% of Power from Nuclear":0,"% of Power from Renewables":32.303,"% of Agricultural Land":47.2592374955,"% of Forest Land":17.4213145572,"Territory":7692020,"Average Rainfall":534,"Corruption":0.1621359587,"Wheat Production (tonnes)":1970363.6,"Rye Production (tonnes)":269,"Potatoes Production (tonnes)":767261.1,"Meat, chicken Production (tonnes)":1191322,"Avocados Production (tonnes)":202541,"Petrol Price (USD/liter)":1.38,"Daily Oil Consumption (Barrels)":1114645,"CO2 Emissions (ton per capita)":15.23826715},{"Country":"New Zealand","Country_clean":"new zealand","Region":"North America and ANZ","Happiness":7.029,"Average Wage (USD/year)":45269,"Infant Survival Rate":1000,"Alcohol Consumption Rate":8.7,"Life Expectancy":81.6,"Netflix (USD/month)":12.53,"Women Safety Index":0.904,"Average Winter Temperature":15.329823,"Average Summer Temperature":16.2116,"Population":5185288,"Energy Per Capita":44939.27,"% of Power from Fossil Fuels":14.444,"% of Power from Nuclear":0,"% of Power from Renewables":85.556,"% of Agricultural Land":38.6426645399,"% of Forest Land":37.6306509438,"Territory":263310,"Average Rainfall":1732,"Corruption":0.1743465513,"Wheat Production (tonnes)":93719040,"Rye Production (tonnes)":1116969.72,"Potatoes Production (tonnes)":919200,"Meat, chicken Production (tonnes)":4000,"Avocados Production (tonnes)":271591.974,"Petrol Price (USD/liter)":2.07,"Daily Oil Consumption (Barrels)":166913,"CO2 Emissions (ton per capita)":6.830414187},{"Country":"Costa Rica","Country_clean":"costa rica","Region":"Latin America and Caribbean","Happiness":6.955,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":12.99,"Women Safety Index":0.743,"Average Winter Temperature":22.746216,"Average Summer Temperature":23.510368,"Population":5180829,"Energy Per Capita":null,"% of Power from Fossil Fuels":1.979,"% of Power from Nuclear":0,"% of Power from Renewables":98.021,"% of Agricultural Land":35.4680767724,"% of Forest Land":59.7579318449,"Territory":51060,"Average Rainfall":2926,"Corruption":0.1670125574,"Wheat Production (tonnes)":195069710,"Rye Production (tonnes)":124200,"Potatoes Production (tonnes)":695604,"Meat, chicken Production (tonnes)":569.91,"Avocados Production (tonnes)":380,"Petrol Price (USD/liter)":1.55,"Daily Oil Consumption (Barrels)":55000,"CO2 Emissions (ton per capita)":1.632471558},{"Country":"Kuwait","Country_clean":"kuwait","Region":"Middle East and North Africa","Happiness":6.951,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.742,"Average Winter Temperature":14.190281,"Average Summer Temperature":16.082039,"Population":4268873,"Energy Per Capita":103882.75,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":0.258,"% of Agricultural Land":8.4175084175,"% of Forest Land":0.3507295174,"Territory":17820,"Average Rainfall":121,"Corruption":0.1987654865,"Wheat Production (tonnes)":413533,"Rye Production (tonnes)":433732.2,"Potatoes Production (tonnes)":190000,"Meat, chicken Production (tonnes)":371700,"Avocados Production (tonnes)":264535,"Petrol Price (USD/liter)":0.34,"Daily Oil Consumption (Barrels)":359000,"CO2 Emissions (ton per capita)":22.0224164},{"Country":"Austria","Country_clean":"austria","Region":"Western Europe","Happiness":6.905,"Average Wage (USD/year)":53132,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.67,"Women Safety Index":0.911,"Average Winter Temperature":-1.6856745,"Average Summer Temperature":-0.967524,"Population":8939617,"Energy Per Capita":42685.379,"% of Power from Fossil Fuels":23.713,"% of Power from Nuclear":0,"% of Power from Renewables":76.287,"% of Agricultural Land":31.4767256423,"% of Forest Land":47.2944740669,"Territory":82520,"Average Rainfall":1110,"Corruption":0.1622093022,"Wheat Production (tonnes)":1041825,"Rye Production (tonnes)":4076,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":125900,"Avocados Production (tonnes)":260,"Petrol Price (USD/liter)":2.13,"Daily Oil Consumption (Barrels)":262352,"CO2 Emissions (ton per capita)":7.293984252},{"Country":"Canada","Country_clean":"canada","Region":"North America and ANZ","Happiness":6.9,"Average Wage (USD/year)":55342,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.87,"Women Safety Index":0.885,"Average Winter Temperature":-19.196556,"Average Summer Temperature":-14.700624,"Population":38454327,"Energy Per Capita":102160.289,"% of Power from Fossil Fuels":17.368,"% of Power from Nuclear":12.888,"% of Power from Renewables":69.744,"% of Agricultural Land":6.4845767861,"% of Forest Land":39.4701279256,"Territory":8788700,"Average Rainfall":537,"Corruption":0.1705811173,"Wheat Production (tonnes)":96520,"Rye Production (tonnes)":10210326,"Potatoes Production (tonnes)":13000,"Meat, chicken Production (tonnes)":17203.52,"Avocados Production (tonnes)":31000,"Petrol Price (USD/liter)":1.79,"Daily Oil Consumption (Barrels)":2486301,"CO2 Emissions (ton per capita)":15.43061283},{"Country":"Belgium","Country_clean":"belgium","Region":"Western Europe","Happiness":6.894,"Average Wage (USD/year)":54237,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":15.24,"Women Safety Index":0.902,"Average Winter Temperature":2.9873695,"Average Summer Temperature":4.751282,"Population":11655930,"Energy Per Capita":58395.824,"% of Power from Fossil Fuels":27.892,"% of Power from Nuclear":46.659,"% of Power from Renewables":25.449,"% of Agricultural Land":45.1013870542,"% of Forest Land":22.7642007926,"Territory":30280,"Average Rainfall":847,"Corruption":0.1622093022,"Wheat Production (tonnes)":240533,"Rye Production (tonnes)":219,"Potatoes Production (tonnes)":171,"Meat, chicken Production (tonnes)":14934,"Avocados Production (tonnes)":51351,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":631522,"CO2 Emissions (ton per capita)":8.095583954},{"Country":"Ireland","Country_clean":"ireland","Region":"Western Europe","Happiness":6.838,"Average Wage (USD/year)":49474,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":14.67,"Women Safety Index":0.892,"Average Winter Temperature":5.0232058,"Average Summer Temperature":7.5741353,"Population":5023109,"Energy Per Capita":37761.402,"% of Power from Fossil Fuels":61.381,"% of Power from Nuclear":0,"% of Power from Renewables":38.619,"% of Agricultural Land":62.9554362026,"% of Forest Land":11.4097837132,"Territory":68890,"Average Rainfall":1118,"Corruption":0.1622093022,"Wheat Production (tonnes)":1290.74,"Rye Production (tonnes)":46331.4,"Potatoes Production (tonnes)":294,"Meat, chicken Production (tonnes)":2790,"Avocados Production (tonnes)":84114,"Petrol Price (USD/liter)":2.07,"Daily Oil Consumption (Barrels)":152404,"CO2 Emissions (ton per capita)":7.245143221},{"Country":"Czechia","Country_clean":"czech republic","Region":"Central and Eastern Europe","Happiness":6.822,"Average Wage (USD/year)":29885,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.49,"Women Safety Index":0.884,"Average Winter Temperature":-0.254366,"Average Summer Temperature":1.0374577,"Population":10493986,"Energy Per Capita":44242.148,"% of Power from Fossil Fuels":51.251,"% of Power from Nuclear":36.412,"% of Power from Renewables":12.337,"% of Agricultural Land":45.7305605114,"% of Forest Land":34.7066980209,"Territory":77186.83,"Average Rainfall":677,"Corruption":0.1467373222,"Wheat Production (tonnes)":122501976,"Rye Production (tonnes)":5116,"Potatoes Production (tonnes)":631,"Meat, chicken Production (tonnes)":123700,"Avocados Production (tonnes)":4200,"Petrol Price (USD/liter)":2,"Daily Oil Consumption (Barrels)":179956,"CO2 Emissions (ton per capita)":9.022786158},{"Country":"Lithuania","Country_clean":"lithuania","Region":"Central and Eastern Europe","Happiness":6.818,"Average Wage (USD/year)":31811,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.886,"Average Winter Temperature":-4.2955937,"Average Summer Temperature":1.70184,"Population":2750055,"Energy Per Capita":23151.053,"% of Power from Fossil Fuels":25.18,"% of Power from Nuclear":0,"% of Power from Renewables":74.82,"% of Agricultural Land":46.9222168983,"% of Forest Land":35.1807490816,"Territory":62610,"Average Rainfall":656,"Corruption":0.1467373222,"Wheat Production (tonnes)":15983841,"Rye Production (tonnes)":21420,"Potatoes Production (tonnes)":26995,"Meat, chicken Production (tonnes)":1391220,"Avocados Production (tonnes)":17200,"Petrol Price (USD/liter)":2.14,"Daily Oil Consumption (Barrels)":61612,"CO2 Emissions (ton per capita)":4.198076022},{"Country":"United Kingdom","Country_clean":"united kingdom","Region":"Western Europe","Happiness":6.749,"Average Wage (USD/year)":47147,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":13.2,"Women Safety Index":0.86,"Average Winter Temperature":4.4938073,"Average Summer Temperature":6.856918,"Population":67508936,"Energy Per Capita":30097.885,"% of Power from Fossil Fuels":43.729,"% of Power from Nuclear":14.823,"% of Power from Renewables":41.448,"% of Agricultural Land":71.1575290373,"% of Forest Land":13.2214553797,"Territory":241930,"Average Rainfall":1220,"Corruption":0.1743465513,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":2.22,"Daily Oil Consumption (Barrels)":1583896,"CO2 Emissions (ton per capita)":5.220514488},{"Country":"Slovenia","Country_clean":"slovenia","Region":"Central and Eastern Europe","Happiness":6.743,"Average Wage (USD/year)":41445,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.824,"Average Winter Temperature":0.9988481,"Average Summer Temperature":1.4752173,"Population":2119844,"Energy Per Capita":34391.094,"% of Power from Fossil Fuels":28.259,"% of Power from Nuclear":42.125,"% of Power from Renewables":29.616,"% of Agricultural Land":30.3410738762,"% of Forest Land":61.3711140025,"Territory":20136.4,"Average Rainfall":1162,"Corruption":0.1467373222,"Wheat Production (tonnes)":645031.8,"Rye Production (tonnes)":168.6,"Potatoes Production (tonnes)":7326446,"Meat, chicken Production (tonnes)":4000,"Avocados Production (tonnes)":163.4,"Petrol Price (USD/liter)":1.62,"Daily Oil Consumption (Barrels)":52298,"CO2 Emissions (ton per capita)":6.512209378},{"Country":"United Arab Emirates","Country_clean":"united arab emirates","Region":"Middle East and North Africa","Happiness":6.733,"Average Wage (USD/year)":69392,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":13.99,"Women Safety Index":0.868,"Average Winter Temperature":20.363506,"Average Summer Temperature":20.625269,"Population":9441129,"Energy Per Capita":148576.547,"% of Power from Fossil Fuels":82.508,"% of Power from Nuclear":12.992,"% of Power from Renewables":4.5,"% of Agricultural Land":5.5133976345,"% of Forest Land":4.4677555618,"Territory":71020,"Average Rainfall":78,"Corruption":0.1655614674,"Wheat Production (tonnes)":46614014.4,"Rye Production (tonnes)":72513,"Potatoes Production (tonnes)":136000,"Meat, chicken Production (tonnes)":60000,"Avocados Production (tonnes)":43039.038,"Petrol Price (USD/liter)":1.1,"Daily Oil Consumption (Barrels)":896000,"CO2 Emissions (ton per capita)":19.32956328},{"Country":"United States","Country_clean":"united states","Region":"North America and ANZ","Happiness":6.725,"Average Wage (USD/year)":69392,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":13.99,"Women Safety Index":0.823,"Average Winter Temperature":-2.7272227,"Average Summer Temperature":0.94223034,"Population":338289857,"Energy Per Capita":78754.273,"% of Power from Fossil Fuels":59.523,"% of Power from Nuclear":17.956,"% of Power from Renewables":22.521,"% of Agricultural Land":44.3633673539,"% of Forest Land":33.866926412,"Territory":9147420,"Average Rainfall":715,"Corruption":0.1590943187,"Wheat Production (tonnes)":110,"Rye Production (tonnes)":12326464,"Potatoes Production (tonnes)":2525383,"Meat, chicken Production (tonnes)":361499,"Avocados Production (tonnes)":1219.74,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":19687287,"CO2 Emissions (ton per capita)":14.67341061},{"Country":"Germany","Country_clean":"germany","Region":"Western Europe","Happiness":6.719,"Average Wage (USD/year)":53745,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.67,"Women Safety Index":0.871,"Average Winter Temperature":1.539955,"Average Summer Temperature":3.0275564,"Population":83369843,"Energy Per Capita":40977.492,"% of Power from Fossil Fuels":50.783,"% of Power from Nuclear":6.27,"% of Power from Renewables":42.947,"% of Agricultural Land":47.485617791,"% of Forest Land":32.6826755202,"Territory":349390,"Average Rainfall":700,"Corruption":0.1622093022,"Wheat Production (tonnes)":156400,"Rye Production (tonnes)":601991,"Potatoes Production (tonnes)":138832220,"Meat, chicken Production (tonnes)":14429,"Avocados Production (tonnes)":2073,"Petrol Price (USD/liter)":2.02,"Daily Oil Consumption (Barrels)":2383393,"CO2 Emissions (ton per capita)":7.911621016},{"Country":"Mexico","Country_clean":"mexico","Region":"Latin America and Caribbean","Happiness":6.678,"Average Wage (USD/year)":16230,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.43,"Women Safety Index":0.551,"Average Winter Temperature":15.8056965,"Average Summer Temperature":17.122166,"Population":127504125,"Energy Per Capita":19009.186,"% of Power from Fossil Fuels":74.097,"% of Power from Nuclear":2.964,"% of Power from Renewables":22.938,"% of Agricultural Land":49.9632192186,"% of Forest Land":33.7273678335,"Territory":1943950,"Average Rainfall":758,"Corruption":0.1599350423,"Wheat Production (tonnes)":1744,"Rye Production (tonnes)":260323.2,"Potatoes Production (tonnes)":10968420,"Meat, chicken Production (tonnes)":53300,"Avocados Production (tonnes)":2376648.5,"Petrol Price (USD/liter)":1.15,"Daily Oil Consumption (Barrels)":2052607,"CO2 Emissions (ton per capita)":3.521600048},{"Country":"Uruguay","Country_clean":"uruguay","Region":"Latin America and Caribbean","Happiness":6.611,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":12.99,"Women Safety Index":0.748,"Average Winter Temperature":20.111822,"Average Summer Temperature":23.139511,"Population":3422794,"Energy Per Capita":null,"% of Power from Fossil Fuels":15.557,"% of Power from Nuclear":0,"% of Power from Renewables":84.443,"% of Agricultural Land":80.3885555936,"% of Forest Land":11.7243743572,"Territory":175020,"Average Rainfall":1300,"Corruption":0.1677868664,"Wheat Production (tonnes)":223447.024,"Rye Production (tonnes)":7181.2,"Potatoes Production (tonnes)":12261,"Meat, chicken Production (tonnes)":3200,"Avocados Production (tonnes)":36219.6,"Petrol Price (USD/liter)":2.02,"Daily Oil Consumption (Barrels)":53000,"CO2 Emissions (ton per capita)":1.874784543},{"Country":"France","Country_clean":"france","Region":"Western Europe","Happiness":6.609,"Average Wage (USD/year)":45581,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":15.24,"Women Safety Index":0.864,"Average Winter Temperature":7.6805277,"Average Summer Temperature":7.854504,"Population":64626628,"Energy Per Capita":36051.793,"% of Power from Fossil Fuels":12.154,"% of Power from Nuclear":63.304,"% of Power from Renewables":24.542,"% of Agricultural Land":52.1475462829,"% of Forest Land":31.6613612829,"Territory":547557,"Average Rainfall":867,"Corruption":0.1622093022,"Wheat Production (tonnes)":332400,"Rye Production (tonnes)":125870,"Potatoes Production (tonnes)":402966,"Meat, chicken Production (tonnes)":10075471,"Avocados Production (tonnes)":28385.3,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":1705568,"CO2 Emissions (ton per capita)":4.468770089},{"Country":"Saudi Arabia","Country_clean":"saudi arabia","Region":"Middle East and North Africa","Happiness":6.594,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.737,"Average Winter Temperature":16.798635,"Average Summer Temperature":17.893715,"Population":36408820,"Energy Per Capita":87707.289,"% of Power from Fossil Fuels":99.792,"% of Power from Nuclear":null,"% of Power from Renewables":0.208,"% of Agricultural Land":80.7730416944,"% of Forest Land":0.4544841349,"Territory":2149690,"Average Rainfall":59,"Corruption":0.1871376336,"Wheat Production (tonnes)":229775,"Rye Production (tonnes)":70119.8,"Potatoes Production (tonnes)":738265,"Meat, chicken Production (tonnes)":5332,"Avocados Production (tonnes)":8802.4,"Petrol Price (USD/liter)":0.62,"Daily Oil Consumption (Barrels)":3302000,"CO2 Emissions (ton per capita)":15.28457873},{"Country":"Kosovo","Country_clean":"kosovo","Region":"Central and Eastern Europe","Happiness":6.561,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":null,"Average Winter Temperature":1.4193249,"Average Summer Temperature":1.8427454,"Population":null,"Energy Per Capita":null,"% of Power from Fossil Fuels":93.71,"% of Power from Nuclear":0,"% of Power from Renewables":6.29,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":0.170497179,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":null},{"Country":"Singapore","Country_clean":"singapore","Region":"Southeast Asia","Happiness":6.523,"Average Wage (USD/year)":null,"Infant Survival Rate":1000,"Alcohol Consumption Rate":1.79,"Life Expectancy":83.1,"Netflix (USD/month)":12.81,"Women Safety Index":0.887,"Average Winter Temperature":null,"Average Summer Temperature":null,"Population":5975689,"Energy Per Capita":147084.844,"% of Power from Fossil Fuels":97.591,"% of Power from Nuclear":0,"% of Power from Renewables":2.409,"% of Agricultural Land":0.9192200557,"% of Forest Land":21.43454039,"Territory":718,"Average Rainfall":2497,"Corruption":0.1537519991,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":2.3,"Daily Oil Consumption (Barrels)":1357000,"CO2 Emissions (ton per capita)":8.307079491},{"Country":"Taiwan Province of China","Country_clean":"taiwan province of china","Region":"East Asia","Happiness":6.503,"Average Wage (USD/year)":null,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":11.9,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":55.4626494294,"% of Forest Land":23.6315282679,"Territory":9388210,"Average Rainfall":645,"Corruption":0.1543876231,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Romania","Country_clean":"romania","Region":"Central and Eastern Europe","Happiness":6.491,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.8,"Average Winter Temperature":-0.022084355,"Average Summer Temperature":1.9483956,"Population":19659267,"Energy Per Capita":18346.869,"% of Power from Fossil Fuels":37.815,"% of Power from Nuclear":20.036,"% of Power from Renewables":42.149,"% of Agricultural Land":56.8454450626,"% of Forest Land":30.1158292768,"Territory":230080,"Average Rainfall":637,"Corruption":0.1467373222,"Wheat Production (tonnes)":32129760,"Rye Production (tonnes)":137059.6,"Potatoes Production (tonnes)":119834,"Meat, chicken Production (tonnes)":6314210,"Avocados Production (tonnes)":17978,"Petrol Price (USD/liter)":1.82,"Daily Oil Consumption (Barrels)":200000,"CO2 Emissions (ton per capita)":3.817434477},{"Country":"El Salvador","Country_clean":"el salvador","Region":"Latin America and Caribbean","Happiness":6.469,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.566,"Average Winter Temperature":25.628748,"Average Summer Temperature":27.070652,"Population":6336392,"Energy Per Capita":null,"% of Power from Fossil Fuels":26.772,"% of Power from Nuclear":0,"% of Power from Renewables":73.228,"% of Agricultural Land":57.7075289575,"% of Forest Land":27.9623552124,"Territory":20720,"Average Rainfall":1784,"Corruption":0.1591664106,"Wheat Production (tonnes)":439000,"Rye Production (tonnes)":9716,"Potatoes Production (tonnes)":104795630,"Meat, chicken Production (tonnes)":1130102,"Avocados Production (tonnes)":93872.16,"Petrol Price (USD/liter)":1.14,"Daily Oil Consumption (Barrels)":52000,"CO2 Emissions (ton per capita)":1.208637136},{"Country":"Estonia","Country_clean":"estonia","Region":"Central and Eastern Europe","Happiness":6.448,"Average Wage (USD/year)":30720,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.892,"Average Winter Temperature":-6.8556023,"Average Summer Temperature":1.2210779,"Population":1326062,"Energy Per Capita":46504.863,"% of Power from Fossil Fuels":55.995,"% of Power from Nuclear":0,"% of Power from Renewables":44.005,"% of Agricultural Land":23.0877192982,"% of Forest Land":57.0385964912,"Territory":42750,"Average Rainfall":626,"Corruption":0.1467373222,"Wheat Production (tonnes)":583000,"Rye Production (tonnes)":20000,"Potatoes Production (tonnes)":82505816,"Meat, chicken Production (tonnes)":2425173,"Avocados Production (tonnes)":6500,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":28855,"CO2 Emissions (ton per capita)":7.672277909},{"Country":"Poland","Country_clean":"poland","Region":"Central and Eastern Europe","Happiness":6.442,"Average Wage (USD/year)":32527,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.58,"Women Safety Index":0.859,"Average Winter Temperature":-0.49168286,"Average Summer Temperature":2.4689384,"Population":39857145,"Energy Per Capita":30065.42,"% of Power from Fossil Fuels":78.957,"% of Power from Nuclear":0,"% of Power from Renewables":21.043,"% of Agricultural Land":47.3683763476,"% of Forest Land":31.0192747468,"Territory":306100,"Average Rainfall":600,"Corruption":0.1467373222,"Wheat Production (tonnes)":452089,"Rye Production (tonnes)":208680.516,"Potatoes Production (tonnes)":260,"Meat, chicken Production (tonnes)":2000,"Avocados Production (tonnes)":153457.498,"Petrol Price (USD/liter)":1.8,"Daily Oil Consumption (Barrels)":582161,"CO2 Emissions (ton per capita)":7.773641839},{"Country":"Spain","Country_clean":"spain","Region":"Western Europe","Happiness":6.421,"Average Wage (USD/year)":37922,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.67,"Women Safety Index":0.859,"Average Winter Temperature":7.264159,"Average Summer Temperature":8.429356,"Population":47558630,"Energy Per Capita":33615.332,"% of Power from Fossil Fuels":37.267,"% of Power from Nuclear":20.515,"% of Power from Renewables":42.218,"% of Agricultural Land":52.4848941208,"% of Forest Land":37.1727521093,"Territory":499733.244,"Average Rainfall":636,"Corruption":0.1622093022,"Wheat Production (tonnes)":68301098.8,"Rye Production (tonnes)":179520.532,"Potatoes Production (tonnes)":4600000,"Meat, chicken Production (tonnes)":400,"Avocados Production (tonnes)":119712.856,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":1290063,"CO2 Emissions (ton per capita)":5.09135092},{"Country":"Serbia","Country_clean":"serbia","Region":"Central and Eastern Europe","Happiness":6.411,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.835,"Average Winter Temperature":1.7233353,"Average Summer Temperature":2.3860748,"Population":7221365,"Energy Per Capita":null,"% of Power from Fossil Fuels":70.509,"% of Power from Nuclear":0,"% of Power from Renewables":29.491,"% of Agricultural Land":41.4436912831,"% of Forest Land":32.3812581758,"Territory":84090,"Average Rainfall":null,"Corruption":0.1620248556,"Wheat Production (tonnes)":3997110.2,"Rye Production (tonnes)":0,"Potatoes Production (tonnes)":1879008,"Meat, chicken Production (tonnes)":387376.3,"Avocados Production (tonnes)":12.308,"Petrol Price (USD/liter)":1.76,"Daily Oil Consumption (Barrels)":74000,"CO2 Emissions (ton per capita)":6.616046939},{"Country":"Chile","Country_clean":"chile","Region":"Latin America and Caribbean","Happiness":6.36,"Average Wage (USD/year)":26729,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":9.91,"Women Safety Index":0.736,"Average Winter Temperature":12.694138,"Average Summer Temperature":14.701271,"Population":19603733,"Energy Per Capita":25342.707,"% of Power from Fossil Fuels":47.044,"% of Power from Nuclear":null,"% of Power from Renewables":52.956,"% of Agricultural Land":14.250277056,"% of Forest Land":24.6574727113,"Territory":743532,"Average Rainfall":1522,"Corruption":0.1599350423,"Wheat Production (tonnes)":102965304,"Rye Production (tonnes)":108500,"Potatoes Production (tonnes)":25363,"Meat, chicken Production (tonnes)":230758.84,"Avocados Production (tonnes)":50,"Petrol Price (USD/liter)":1.39,"Daily Oil Consumption (Barrels)":351989,"CO2 Emissions (ton per capita)":4.821118299},{"Country":"Panama","Country_clean":"panama","Region":"Latin America and Caribbean","Happiness":6.358,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.757,"Average Winter Temperature":24.940985,"Average Summer Temperature":25.922495,"Population":4408581,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":29.4057158264,"% of Forest Land":56.6517026153,"Territory":74180,"Average Rainfall":2928,"Corruption":0.1670125574,"Wheat Production (tonnes)":12000,"Rye Production (tonnes)":7.6,"Potatoes Production (tonnes)":1280086,"Meat, chicken Production (tonnes)":3500,"Avocados Production (tonnes)":16528.4,"Petrol Price (USD/liter)":1.45,"Daily Oil Consumption (Barrels)":155000,"CO2 Emissions (ton per capita)":3.141454996},{"Country":"Malta","Country_clean":"malta","Region":"Western Europe","Happiness":6.346,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.846,"Average Winter Temperature":null,"Average Summer Temperature":null,"Population":533286,"Energy Per Capita":null,"% of Power from Fossil Fuels":99.5,"% of Power from Nuclear":0,"% of Power from Renewables":0.5,"% of Agricultural Land":27.34375,"% of Forest Land":1.4375,"Territory":320,"Average Rainfall":560,"Corruption":0.1696073413,"Wheat Production (tonnes)":5165083,"Rye Production (tonnes)":4862470.8,"Potatoes Production (tonnes)":1641853,"Meat, chicken Production (tonnes)":597949,"Avocados Production (tonnes)":4449.6,"Petrol Price (USD/liter)":1.4,"Daily Oil Consumption (Barrels)":47000,"CO2 Emissions (ton per capita)":3.293245606},{"Country":"Italy","Country_clean":"italy","Region":"Western Europe","Happiness":6.324,"Average Wage (USD/year)":37769,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":14.67,"Women Safety Index":0.827,"Average Winter Temperature":5.8631363,"Average Summer Temperature":6.1182337,"Population":59037474,"Energy Per Capita":28910.201,"% of Power from Fossil Fuels":63.562,"% of Power from Nuclear":0,"% of Power from Renewables":36.438,"% of Agricultural Land":41.942231593,"% of Forest Land":32.5308994748,"Territory":295717,"Average Rainfall":832,"Corruption":0.1622093022,"Wheat Production (tonnes)":5700,"Rye Production (tonnes)":1012,"Potatoes Production (tonnes)":20475928,"Meat, chicken Production (tonnes)":4700,"Avocados Production (tonnes)":13817.47,"Petrol Price (USD/liter)":2.12,"Daily Oil Consumption (Barrels)":1236628,"CO2 Emissions (ton per capita)":5.311315442},{"Country":"Guatemala","Country_clean":"guatemala","Region":"Latin America and Caribbean","Happiness":6.287,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.99,"Women Safety Index":0.569,"Average Winter Temperature":21.24547,"Average Summer Temperature":22.411528,"Population":17843908,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":43.0384471818,"% of Forest Land":32.812616648,"Territory":107160,"Average Rainfall":1996,"Corruption":0.1670125574,"Wheat Production (tonnes)":483,"Rye Production (tonnes)":511.23,"Potatoes Production (tonnes)":18843300,"Meat, chicken Production (tonnes)":1760,"Avocados Production (tonnes)":1023.49,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":93000,"CO2 Emissions (ton per capita)":1.162970924},{"Country":"Nicaragua","Country_clean":"nicaragua","Region":"Latin America and Caribbean","Happiness":6.284,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.717,"Average Winter Temperature":24.97253,"Average Summer Temperature":25.584845,"Population":6948392,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":42.3051354496,"% of Forest Land":27.4848761841,"Territory":120340,"Average Rainfall":2280,"Corruption":0.1591832638,"Wheat Production (tonnes)":19615588,"Rye Production (tonnes)":1503073.6,"Potatoes Production (tonnes)":770127,"Meat, chicken Production (tonnes)":20825,"Avocados Production (tonnes)":46826.8,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":37000,"CO2 Emissions (ton per capita)":0.800549594},{"Country":"Brazil","Country_clean":"brazil","Region":"Latin America and Caribbean","Happiness":6.272,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":7.11,"Women Safety Index":0.63,"Average Winter Temperature":25.908457,"Average Summer Temperature":26.127356,"Population":215313498,"Energy Per Capita":17299.75,"% of Power from Fossil Fuels":10.924,"% of Power from Nuclear":2.135,"% of Power from Renewables":86.94,"% of Agricultural Land":28.6390944636,"% of Forest Land":59.2705274977,"Territory":8358140,"Average Rainfall":1761,"Corruption":0.1599350423,"Wheat Production (tonnes)":19888224,"Rye Production (tonnes)":5533432,"Potatoes Production (tonnes)":166772,"Meat, chicken Production (tonnes)":1593.62,"Avocados Production (tonnes)":43200,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":2984000,"CO2 Emissions (ton per capita)":2.057810839},{"Country":"Slovakia","Country_clean":"slovakia","Region":"Central and Eastern Europe","Happiness":6.257,"Average Wage (USD/year)":23619,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.856,"Average Winter Temperature":-0.32777002,"Average Summer Temperature":0.70984817,"Population":5643453,"Energy Per Capita":33887.691,"% of Power from Fossil Fuels":17.845,"% of Power from Nuclear":59.484,"% of Power from Renewables":22.671,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":46043401.6,"Rye Production (tonnes)":3904665.32,"Potatoes Production (tonnes)":13240782,"Meat, chicken Production (tonnes)":360,"Avocados Production (tonnes)":102320.138,"Petrol Price (USD/liter)":1.98,"Daily Oil Consumption (Barrels)":81587,"CO2 Emissions (ton per capita)":null},{"Country":"Latvia","Country_clean":"latvia","Region":"Central and Eastern Europe","Happiness":6.234,"Average Wage (USD/year)":29876,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.872,"Average Winter Temperature":-5.6515737,"Average Summer Temperature":1.3988863,"Population":1850651,"Energy Per Capita":21435.611,"% of Power from Fossil Fuels":27.866,"% of Power from Nuclear":0,"% of Power from Renewables":72.134,"% of Agricultural Land":31.6567571911,"% of Forest Land":54.871605335,"Territory":62230,"Average Rainfall":667,"Corruption":0.1467373222,"Wheat Production (tonnes)":68948700,"Rye Production (tonnes)":896889.36,"Potatoes Production (tonnes)":8375542,"Meat, chicken Production (tonnes)":122411.04,"Avocados Production (tonnes)":212977,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":37694,"CO2 Emissions (ton per capita)":3.955435862},{"Country":"Uzbekistan","Country_clean":"uzbekistan","Region":"Commonwealth of Independent States","Happiness":6.195,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.674,"Average Winter Temperature":-1.1172104,"Average Summer Temperature":0.41523957,"Population":34627652,"Energy Per Capita":16929.814,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":7.744,"% of Agricultural Land":58.3012029874,"% of Forest Land":8.4318046172,"Territory":440653,"Average Rainfall":206,"Corruption":0.1534096003,"Wheat Production (tonnes)":12797144.4,"Rye Production (tonnes)":56359,"Potatoes Production (tonnes)":4772327.2,"Meat, chicken Production (tonnes)":3600,"Avocados Production (tonnes)":11471,"Petrol Price (USD/liter)":0.9,"Daily Oil Consumption (Barrels)":49000,"CO2 Emissions (ton per capita)":3.47554445},{"Country":"Argentina","Country_clean":"argentina","Region":"Latin America and Caribbean","Happiness":6.188,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":6.3,"Women Safety Index":0.768,"Average Winter Temperature":20.045332,"Average Summer Temperature":22.75778,"Population":45510318,"Energy Per Capita":21994.422,"% of Power from Fossil Fuels":63.374,"% of Power from Nuclear":5.199,"% of Power from Renewables":31.426,"% of Agricultural Land":43.1023461554,"% of Forest Land":10.4007639521,"Territory":2736690,"Average Rainfall":591,"Corruption":0.1599350423,"Wheat Production (tonnes)":188681200,"Rye Production (tonnes)":283601,"Potatoes Production (tonnes)":52048230,"Meat, chicken Production (tonnes)":2055000,"Avocados Production (tonnes)":2040,"Petrol Price (USD/liter)":1.05,"Daily Oil Consumption (Barrels)":709000,"CO2 Emissions (ton per capita)":3.740650291},{"Country":"Kazakhstan","Country_clean":"kazakhstan","Region":"Commonwealth of Independent States","Happiness":6.188,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.729,"Average Winter Temperature":-9.164996,"Average Summer Temperature":-7.0029874,"Population":19397998,"Energy Per Capita":44701.98,"% of Power from Fossil Fuels":88.659,"% of Power from Nuclear":null,"% of Power from Renewables":11.341,"% of Agricultural Land":79.1924658295,"% of Forest Land":1.2904838315,"Territory":2699700,"Average Rainfall":250,"Corruption":0.1555387676,"Wheat Production (tonnes)":100,"Rye Production (tonnes)":230580.8,"Potatoes Production (tonnes)":275000,"Meat, chicken Production (tonnes)":2736,"Avocados Production (tonnes)":72.65,"Petrol Price (USD/liter)":0.48,"Daily Oil Consumption (Barrels)":325000,"CO2 Emissions (ton per capita)":11.45693783},{"Country":"Cyprus","Country_clean":"cyprus","Region":"Western Europe","Happiness":6.068,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.739,"Average Winter Temperature":13.245076,"Average Summer Temperature":13.512097,"Population":1251488,"Energy Per Capita":25359.791,"% of Power from Fossil Fuels":83.08,"% of Power from Nuclear":0,"% of Power from Renewables":16.92,"% of Agricultural Land":13.3262878788,"% of Forest Land":18.6699134199,"Territory":9240,"Average Rainfall":498,"Corruption":0.1622093022,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.86,"Daily Oil Consumption (Barrels)":52000,"CO2 Emissions (ton per capita)":5.998795283},{"Country":"Japan","Country_clean":"japan","Region":"East Asia","Happiness":6.06,"Average Wage (USD/year)":38515,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":13.13,"Women Safety Index":0.866,"Average Winter Temperature":2.164464,"Average Summer Temperature":2.298908,"Population":123951692,"Energy Per Capita":39984.914,"% of Power from Fossil Fuels":71.011,"% of Power from Nuclear":5.357,"% of Power from Renewables":23.631,"% of Agricultural Land":12.7818930041,"% of Forest Land":68.4087791495,"Territory":364500,"Average Rainfall":1668,"Corruption":0.1614369303,"Wheat Production (tonnes)":38159276,"Rye Production (tonnes)":460847.088,"Potatoes Production (tonnes)":3573873,"Meat, chicken Production (tonnes)":117500,"Avocados Production (tonnes)":92936,"Petrol Price (USD/liter)":1.24,"Daily Oil Consumption (Barrels)":4012877,"CO2 Emissions (ton per capita)":8.540980205},{"Country":"South Korea","Country_clean":"korea republic of","Region":"East Asia","Happiness":6.058,"Average Wage (USD/year)":41960,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":11.47,"Women Safety Index":0.848,"Average Winter Temperature":0.54568756,"Average Summer Temperature":1.3578094,"Population":51815810,"Energy Per Capita":68126.188,"% of Power from Fossil Fuels":62.993,"% of Power from Nuclear":27.795,"% of Power from Renewables":9.212,"% of Agricultural Land":16.4241803279,"% of Forest Land":64.3135245902,"Territory":97600,"Average Rainfall":1274,"Corruption":0.1531555355,"Wheat Production (tonnes)":2114998.2,"Rye Production (tonnes)":1300000,"Potatoes Production (tonnes)":715276,"Meat, chicken Production (tonnes)":87928,"Avocados Production (tonnes)":8759.354,"Petrol Price (USD/liter)":1.61,"Daily Oil Consumption (Barrels)":2605440,"CO2 Emissions (ton per capita)":11.79932538},{"Country":"Philippines","Country_clean":"philippines","Region":"Southeast Asia","Happiness":6.048,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":9.14,"Women Safety Index":0.612,"Average Winter Temperature":25.283766,"Average Summer Temperature":25.835867,"Population":115559009,"Energy Per Capita":5066.786,"% of Power from Fossil Fuels":77.417,"% of Power from Nuclear":0,"% of Power from Renewables":22.583,"% of Agricultural Land":42.536137103,"% of Forest Land":24.2260455445,"Territory":298170,"Average Rainfall":2348,"Corruption":0.1470372379,"Wheat Production (tonnes)":111872930,"Rye Production (tonnes)":14215792.8,"Potatoes Production (tonnes)":224700,"Meat, chicken Production (tonnes)":5260,"Avocados Production (tonnes)":161127.4,"Petrol Price (USD/liter)":1.55,"Daily Oil Consumption (Barrels)":429000,"CO2 Emissions (ton per capita)":1.345029057},{"Country":"Vietnam","Country_clean":"vietnam","Region":"Southeast Asia","Happiness":6.043,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.707,"Average Winter Temperature":20.113937,"Average Summer Temperature":20.465149,"Population":98186856,"Energy Per Capita":12983.017,"% of Power from Fossil Fuels":48.449,"% of Power from Nuclear":0,"% of Power from Renewables":51.551,"% of Agricultural Land":39.4347683207,"% of Forest Land":46.961161858,"Territory":313429,"Average Rainfall":1821,"Corruption":0.1536959112,"Wheat Production (tonnes)":126369.276,"Rye Production (tonnes)":65741.052,"Potatoes Production (tonnes)":1658756.2,"Meat, chicken Production (tonnes)":18293614,"Avocados Production (tonnes)":77631.608,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":478000,"CO2 Emissions (ton per capita)":3.488312636},{"Country":"Portugal","Country_clean":"portugal","Region":"Western Europe","Happiness":6.03,"Average Wage (USD/year)":28410,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":13.54,"Women Safety Index":0.877,"Average Winter Temperature":9.626703,"Average Summer Temperature":10.976666,"Population":10270865,"Energy Per Capita":25094.396,"% of Power from Fossil Fuels":40.183,"% of Power from Nuclear":0,"% of Power from Renewables":59.817,"% of Agricultural Land":43.2538567511,"% of Forest Land":36.1549948911,"Territory":91605.6,"Average Rainfall":854,"Corruption":0.1622093022,"Wheat Production (tonnes)":947400,"Rye Production (tonnes)":3710.18,"Potatoes Production (tonnes)":10200,"Meat, chicken Production (tonnes)":3760,"Avocados Production (tonnes)":125446.8,"Petrol Price (USD/liter)":2.26,"Daily Oil Consumption (Barrels)":236866,"CO2 Emissions (ton per capita)":4.339768426},{"Country":"Hungary","Country_clean":"hungary","Region":"Central and Eastern Europe","Happiness":6.017,"Average Wage (USD/year)":25410,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.71,"Women Safety Index":0.835,"Average Winter Temperature":1.4500087,"Average Summer Temperature":2.1213894,"Population":9967308,"Energy Per Capita":26660.49,"% of Power from Fossil Fuels":34.178,"% of Power from Nuclear":44.623,"% of Power from Renewables":21.199,"% of Agricultural Land":55.2672430419,"% of Forest Land":22.4803495507,"Territory":91260,"Average Rainfall":589,"Corruption":0.1467373222,"Wheat Production (tonnes)":18287,"Rye Production (tonnes)":240000,"Potatoes Production (tonnes)":13775,"Meat, chicken Production (tonnes)":5795,"Avocados Production (tonnes)":230332,"Petrol Price (USD/liter)":2.01,"Daily Oil Consumption (Barrels)":155544,"CO2 Emissions (ton per capita)":4.74663103},{"Country":"Paraguay","Country_clean":"paraguay","Region":"Latin America and Caribbean","Happiness":5.977,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.49,"Women Safety Index":0.691,"Average Winter Temperature":26.823614,"Average Summer Temperature":29.723492,"Population":6780744,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":42.3084319154,"% of Forest Land":39.8261432167,"Territory":397300,"Average Rainfall":1130,"Corruption":0.1677868664,"Wheat Production (tonnes)":3974000,"Rye Production (tonnes)":597306.826,"Potatoes Production (tonnes)":5600,"Meat, chicken Production (tonnes)":83300,"Avocados Production (tonnes)":3820.012,"Petrol Price (USD/liter)":1.4,"Daily Oil Consumption (Barrels)":51000,"CO2 Emissions (ton per capita)":1.165425232},{"Country":"Thailand","Country_clean":"thailand","Region":"Southeast Asia","Happiness":5.976,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.43,"Women Safety Index":0.764,"Average Winter Temperature":23.979416,"Average Summer Temperature":24.891027,"Population":71697030,"Energy Per Capita":19616.777,"% of Power from Fossil Fuels":84.744,"% of Power from Nuclear":0,"% of Power from Renewables":15.256,"% of Agricultural Land":45.9981600736,"% of Forest Land":38.8283192077,"Territory":510890,"Average Rainfall":1622,"Corruption":0.1531555355,"Wheat Production (tonnes)":2133386,"Rye Production (tonnes)":416000,"Potatoes Production (tonnes)":190964,"Meat, chicken Production (tonnes)":416,"Avocados Production (tonnes)":266926.338,"Petrol Price (USD/liter)":1.51,"Daily Oil Consumption (Barrels)":1302000,"CO2 Emissions (ton per capita)":3.836090019},{"Country":"Malaysia","Country_clean":"malaysia","Region":"Southeast Asia","Happiness":5.975,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.65,"Women Safety Index":0.738,"Average Winter Temperature":25.763824,"Average Summer Temperature":25.89396,"Population":33938221,"Energy Per Capita":39586.996,"% of Power from Fossil Fuels":80.96,"% of Power from Nuclear":null,"% of Power from Renewables":19.04,"% of Agricultural Land":26.0873535231,"% of Forest Land":58.0243189773,"Territory":328550,"Average Rainfall":2875,"Corruption":0.1531555355,"Wheat Production (tonnes)":58253,"Rye Production (tonnes)":127405.114,"Potatoes Production (tonnes)":10200,"Meat, chicken Production (tonnes)":1556741.9,"Avocados Production (tonnes)":84517.6,"Petrol Price (USD/liter)":0.46,"Daily Oil Consumption (Barrels)":708000,"CO2 Emissions (ton per capita)":7.927126037},{"Country":"China","Country_clean":"china","Region":"East Asia","Happiness":5.973,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":55.4626494294,"% of Forest Land":23.6315282679,"Territory":9388210,"Average Rainfall":645,"Corruption":0.1543876231,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Honduras","Country_clean":"honduras","Region":"Latin America and Caribbean","Happiness":5.968,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.99,"Women Safety Index":0.61,"Average Winter Temperature":22.25614,"Average Summer Temperature":23.138378,"Population":10432860,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":31.9599606757,"% of Forest Land":56.6476896952,"Territory":111890,"Average Rainfall":1976,"Corruption":0.1517658681,"Wheat Production (tonnes)":2455774,"Rye Production (tonnes)":3800,"Potatoes Production (tonnes)":2055233,"Meat, chicken Production (tonnes)":710,"Avocados Production (tonnes)":12.8,"Petrol Price (USD/liter)":1.45,"Daily Oil Consumption (Barrels)":58000,"CO2 Emissions (ton per capita)":1.048622992},{"Country":"Bahrain","Country_clean":"bahrain","Region":"Middle East and North Africa","Happiness":5.959,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.752,"Average Winter Temperature":18.957916,"Average Summer Temperature":19.866425,"Population":1472233,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":10.253164557,"% of Forest Land":0.9113924051,"Territory":790,"Average Rainfall":83,"Corruption":0.1871376336,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":0.53,"Daily Oil Consumption (Barrels)":62000,"CO2 Emissions (ton per capita)":20.26610279},{"Country":"Croatia","Country_clean":"croatia","Region":"Central and Eastern Europe","Happiness":5.942,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.862,"Average Winter Temperature":3.5226943,"Average Summer Temperature":3.6475925,"Population":4030358,"Energy Per Capita":23468.168,"% of Power from Fossil Fuels":36.686,"% of Power from Nuclear":0,"% of Power from Renewables":63.314,"% of Agricultural Land":26.3759828449,"% of Forest Land":34.6963902788,"Territory":55960,"Average Rainfall":1113,"Corruption":0.1467373222,"Wheat Production (tonnes)":73391864,"Rye Production (tonnes)":60000,"Potatoes Production (tonnes)":122.62,"Meat, chicken Production (tonnes)":36,"Avocados Production (tonnes)":47000,"Petrol Price (USD/liter)":1.91,"Daily Oil Consumption (Barrels)":69000,"CO2 Emissions (ton per capita)":4.063707833},{"Country":"Greece","Country_clean":"greece","Region":"Western Europe","Happiness":5.934,"Average Wage (USD/year)":27207,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":12.42,"Women Safety Index":0.766,"Average Winter Temperature":7.6042023,"Average Summer Temperature":8.659867,"Population":10384971,"Energy Per Capita":30410.344,"% of Power from Fossil Fuels":56.693,"% of Power from Nuclear":0,"% of Power from Renewables":43.307,"% of Agricultural Land":45.5173622964,"% of Forest Land":30.2699767261,"Territory":128900,"Average Rainfall":652,"Corruption":0.1622093022,"Wheat Production (tonnes)":4317391,"Rye Production (tonnes)":366200,"Potatoes Production (tonnes)":1512428,"Meat, chicken Production (tonnes)":1049150,"Avocados Production (tonnes)":77556,"Petrol Price (USD/liter)":2.51,"Daily Oil Consumption (Barrels)":296101,"CO2 Emissions (ton per capita)":5.59618907},{"Country":"Bosnia and Herzegovina","Country_clean":"bosnia and herzegovina","Region":"Central and Eastern Europe","Happiness":5.877,"Average Wage (USD/year)":null,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":null,"Women Safety Index":0.754,"Average Winter Temperature":2.2383707,"Average Summer Temperature":2.2406917,"Population":3233526,"Energy Per Capita":null,"% of Power from Fossil Fuels":62.131,"% of Power from Nuclear":0,"% of Power from Renewables":37.869,"% of Agricultural Land":44.19921875,"% of Forest Land":42.7326171875,"Territory":51200,"Average Rainfall":1028,"Corruption":0.1741266698,"Wheat Production (tonnes)":9024254,"Rye Production (tonnes)":771700,"Potatoes Production (tonnes)":81498,"Meat, chicken Production (tonnes)":20326,"Avocados Production (tonnes)":8525.45,"Petrol Price (USD/liter)":1.73,"Daily Oil Consumption (Barrels)":35000,"CO2 Emissions (ton per capita)":6.382918043},{"Country":"Libya","Country_clean":"libya","Region":"Middle East and North Africa","Happiness":5.866,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.61,"Average Winter Temperature":13.038244,"Average Summer Temperature":13.510715,"Population":6812341,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":8.7238710117,"% of Forest Land":0.1233276879,"Territory":1759540,"Average Rainfall":56,"Corruption":0.2036707252,"Wheat Production (tonnes)":85250690,"Rye Production (tonnes)":960041.848,"Potatoes Production (tonnes)":124532,"Meat, chicken Production (tonnes)":125192,"Avocados Production (tonnes)":1306.12,"Petrol Price (USD/liter)":0.03,"Daily Oil Consumption (Barrels)":223000,"CO2 Emissions (ton per capita)":8.380729344},{"Country":"Jamaica","Country_clean":"jamaica","Region":"Latin America and Caribbean","Happiness":5.842,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.71,"Average Winter Temperature":25.523024,"Average Summer Temperature":25.65008,"Population":2827377,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":38.5041551247,"% of Forest Land":55.4730655586,"Territory":10830,"Average Rainfall":2051,"Corruption":0.1735760421,"Wheat Production (tonnes)":1012930,"Rye Production (tonnes)":878583,"Potatoes Production (tonnes)":29460,"Meat, chicken Production (tonnes)":26500,"Avocados Production (tonnes)":95729.19,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":54000,"CO2 Emissions (ton per capita)":2.845730012},{"Country":"Peru","Country_clean":"peru","Region":"Latin America and Caribbean","Happiness":5.841,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":8.56,"Women Safety Index":0.717,"Average Winter Temperature":20.036163,"Average Summer Temperature":20.772074,"Population":34049588,"Energy Per Capita":9835.475,"% of Power from Fossil Fuels":44.915,"% of Power from Nuclear":0,"% of Power from Renewables":55.085,"% of Agricultural Land":19.9341320313,"% of Forest Land":56.3730728906,"Territory":1280000,"Average Rainfall":1738,"Corruption":0.1599350423,"Wheat Production (tonnes)":29718000,"Rye Production (tonnes)":586828.8,"Potatoes Production (tonnes)":3289722,"Meat, chicken Production (tonnes)":130,"Avocados Production (tonnes)":83822.8,"Petrol Price (USD/liter)":1.65,"Daily Oil Consumption (Barrels)":246000,"CO2 Emissions (ton per capita)":1.745591927},{"Country":"Dominican Republic","Country_clean":"dominican republic","Region":"Latin America and Caribbean","Happiness":5.823,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.99,"Women Safety Index":0.666,"Average Winter Temperature":23.858599,"Average Summer Temperature":23.987373,"Population":11228821,"Energy Per Capita":21683.146,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":80.468,"% of Agricultural Land":51.1034903537,"% of Forest Land":45.2797121878,"Territory":47531,"Average Rainfall":1410,"Corruption":0.1670125574,"Wheat Production (tonnes)":32079,"Rye Production (tonnes)":1143319,"Potatoes Production (tonnes)":422589.44,"Meat, chicken Production (tonnes)":5300,"Avocados Production (tonnes)":70948,"Petrol Price (USD/liter)":1.41,"Daily Oil Consumption (Barrels)":133000,"CO2 Emissions (ton per capita)":2.535627952},{"Country":"Mauritius","Country_clean":"mauritius","Region":"Sub-Saharan Africa","Happiness":5.816,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.678,"Average Winter Temperature":25.453356,"Average Summer Temperature":26.709538,"Population":1299469,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":43.0645968953,"% of Forest Land":19.4341512268,"Territory":1997,"Average Rainfall":2041,"Corruption":0.1810258031,"Wheat Production (tonnes)":201,"Rye Production (tonnes)":590006.12,"Potatoes Production (tonnes)":465598.97,"Meat, chicken Production (tonnes)":1080,"Avocados Production (tonnes)":194246.34,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":28000,"CO2 Emissions (ton per capita)":3.294591006},{"Country":"Moldova","Country_clean":"moldova","Region":"Commonwealth of Independent States","Happiness":5.816,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.758,"Average Winter Temperature":-0.58977896,"Average Summer Temperature":2.0659935,"Population":3272996,"Energy Per Capita":null,"% of Power from Fossil Fuels":93.123,"% of Power from Nuclear":0,"% of Power from Renewables":6.877,"% of Agricultural Land":69.0021231423,"% of Forest Land":11.7227782833,"Territory":32970,"Average Rainfall":450,"Corruption":0.1620248556,"Wheat Production (tonnes)":1713061,"Rye Production (tonnes)":277982.8,"Potatoes Production (tonnes)":2263.6,"Meat, chicken Production (tonnes)":474021.6,"Avocados Production (tonnes)":4707.65,"Petrol Price (USD/liter)":1.78,"Daily Oil Consumption (Barrels)":18001,"CO2 Emissions (ton per capita)":3.324610168},{"Country":"Russia","Country_clean":"russian federation","Region":"Commonwealth of Independent States","Happiness":5.785,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.84,"Women Safety Index":0.752,"Average Winter Temperature":-22.901932,"Average Summer Temperature":-16.512663,"Population":144713314,"Energy Per Capita":55459.422,"% of Power from Fossil Fuels":61.33,"% of Power from Nuclear":20.309,"% of Power from Renewables":18.361,"% of Agricultural Land":13.158436258,"% of Forest Land":49.7843360789,"Territory":16376870,"Average Rainfall":460,"Corruption":0.1620248556,"Wheat Production (tonnes)":38418516,"Rye Production (tonnes)":69628.2,"Potatoes Production (tonnes)":391924.53,"Meat, chicken Production (tonnes)":21388082,"Avocados Production (tonnes)":25469.03,"Petrol Price (USD/liter)":0.9,"Daily Oil Consumption (Barrels)":3631287,"CO2 Emissions (ton per capita)":11.79720293},{"Country":"Bolivia","Country_clean":"bolivia","Region":"Latin America and Caribbean","Happiness":5.784,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.99,"Women Safety Index":0.696,"Average Winter Temperature":22.62405,"Average Summer Temperature":23.684843,"Population":12224110,"Energy Per Capita":null,"% of Power from Fossil Fuels":60.692,"% of Power from Nuclear":0,"% of Power from Renewables":39.308,"% of Agricultural Land":35.1881908982,"% of Forest Land":46.7283054556,"Territory":1083300,"Average Rainfall":1146,"Corruption":0.1598362178,"Wheat Production (tonnes)":631.08,"Rye Production (tonnes)":564675,"Potatoes Production (tonnes)":261690,"Meat, chicken Production (tonnes)":1208,"Avocados Production (tonnes)":35000,"Petrol Price (USD/liter)":0.54,"Daily Oil Consumption (Barrels)":90000,"CO2 Emissions (ton per capita)":1.940398005},{"Country":"Ecuador","Country_clean":"ecuador","Region":"Latin America and Caribbean","Happiness":5.725,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.99,"Women Safety Index":0.655,"Average Winter Temperature":21.600014,"Average Summer Temperature":22.433525,"Population":18001000,"Energy Per Capita":12150.252,"% of Power from Fossil Fuels":24.275,"% of Power from Nuclear":0,"% of Power from Renewables":75.725,"% of Agricultural Land":22.0244805927,"% of Forest Land":50.0626509905,"Territory":248360,"Average Rainfall":2274,"Corruption":0.1677868664,"Wheat Production (tonnes)":2754740,"Rye Production (tonnes)":4000,"Potatoes Production (tonnes)":376000,"Meat, chicken Production (tonnes)":118350,"Avocados Production (tonnes)":163323,"Petrol Price (USD/liter)":1.17,"Daily Oil Consumption (Barrels)":259000,"CO2 Emissions (ton per capita)":2.261469817},{"Country":"Kyrgyzstan","Country_clean":"kyrgyzstan","Region":"Commonwealth of Independent States","Happiness":5.714,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.673,"Average Winter Temperature":-12.751518,"Average Summer Temperature":-8.788135,"Population":6630623,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":8330,"Rye Production (tonnes)":260323.2,"Potatoes Production (tonnes)":1791600,"Meat, chicken Production (tonnes)":3175853,"Avocados Production (tonnes)":429912,"Petrol Price (USD/liter)":0.83,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":null},{"Country":"Montenegro","Country_clean":"montenegro","Region":"Central and Eastern Europe","Happiness":5.707,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.808,"Average Winter Temperature":1.7943455,"Average Summer Temperature":2.1861253,"Population":627082,"Energy Per Capita":null,"% of Power from Fossil Fuels":47.678,"% of Power from Nuclear":0,"% of Power from Renewables":52.322,"% of Agricultural Land":19.0007434944,"% of Forest Land":61.4869888476,"Territory":13450,"Average Rainfall":null,"Corruption":0.1997847706,"Wheat Production (tonnes)":1275302,"Rye Production (tonnes)":3805260,"Potatoes Production (tonnes)":248321,"Meat, chicken Production (tonnes)":789921.3,"Avocados Production (tonnes)":330240.25,"Petrol Price (USD/liter)":1.71,"Daily Oil Consumption (Barrels)":7000,"CO2 Emissions (ton per capita)":4.179875994},{"Country":"Mongolia","Country_clean":"mongolia","Region":"East Asia","Happiness":5.696,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.794,"Average Winter Temperature":-18.015043,"Average Summer Temperature":-16.466763,"Population":3398366,"Energy Per Capita":null,"% of Power from Fossil Fuels":91.197,"% of Power from Nuclear":0,"% of Power from Renewables":8.803,"% of Agricultural Land":72.3150521956,"% of Forest Land":9.0989446596,"Territory":1557507,"Average Rainfall":241,"Corruption":0.1558940709,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.23,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":7.153120086},{"Country":"Colombia","Country_clean":"colombia","Region":"Latin America and Caribbean","Happiness":5.695,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":6.86,"Women Safety Index":0.582,"Average Winter Temperature":24.625221,"Average Summer Temperature":25.879896,"Population":51874024,"Energy Per Capita":11746.604,"% of Power from Fossil Fuels":24.503,"% of Power from Nuclear":0,"% of Power from Renewables":75.497,"% of Agricultural Land":38.5020279405,"% of Forest Land":53.125395854,"Territory":1109500,"Average Rainfall":3240,"Corruption":0.1599350423,"Wheat Production (tonnes)":144885,"Rye Production (tonnes)":168,"Potatoes Production (tonnes)":111760,"Meat, chicken Production (tonnes)":13216000,"Avocados Production (tonnes)":9570,"Petrol Price (USD/liter)":0.6,"Daily Oil Consumption (Barrels)":357000,"CO2 Emissions (ton per capita)":1.609870831},{"Country":"Venezuela","Country_clean":"venezuela bolivarian republic of","Region":"Latin America and Caribbean","Happiness":5.607,"Average Wage (USD/year)":41960,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":10.99,"Women Safety Index":0.628,"Average Winter Temperature":26.43019,"Average Summer Temperature":27.094582,"Population":28301696,"Energy Per Capita":21683.146,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":80.468,"% of Agricultural Land":24.3750354288,"% of Forest Land":52.3477807381,"Territory":882050,"Average Rainfall":2044,"Corruption":0.1630260944,"Wheat Production (tonnes)":2600996.2,"Rye Production (tonnes)":33067.614,"Potatoes Production (tonnes)":122987476,"Meat, chicken Production (tonnes)":18293614,"Avocados Production (tonnes)":26527.058,"Petrol Price (USD/liter)":0.02,"Daily Oil Consumption (Barrels)":598000,"CO2 Emissions (ton per capita)":3.939566209},{"Country":"Indonesia","Country_clean":"indonesia","Region":"Southeast Asia","Happiness":5.568,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.66,"Women Safety Index":0.7,"Average Winter Temperature":25.869717,"Average Summer Temperature":25.94353,"Population":275501339,"Energy Per Capita":9854.455,"% of Power from Fossil Fuels":80.383,"% of Power from Nuclear":null,"% of Power from Renewables":19.617,"% of Agricultural Land":34.1337419294,"% of Forest Land":48.3619448681,"Territory":1892555.47,"Average Rainfall":2702,"Corruption":0.1470372379,"Wheat Production (tonnes)":209830,"Rye Production (tonnes)":38193584,"Potatoes Production (tonnes)":95170,"Meat, chicken Production (tonnes)":158.9,"Avocados Production (tonnes)":382467,"Petrol Price (USD/liter)":1.18,"Daily Oil Consumption (Barrels)":1623000,"CO2 Emissions (ton per capita)":2.290397148},{"Country":"Bulgaria","Country_clean":"bulgaria","Region":"Central and Eastern Europe","Happiness":5.463,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.826,"Average Winter Temperature":1.7989875,"Average Summer Temperature":3.720064,"Population":6781953,"Energy Per Capita":34175.52,"% of Power from Fossil Fuels":48.754,"% of Power from Nuclear":32.543,"% of Power from Renewables":18.703,"% of Agricultural Land":46.4867096536,"% of Forest Land":35.9801031688,"Territory":108560,"Average Rainfall":608,"Corruption":0.1467373222,"Wheat Production (tonnes)":2800,"Rye Production (tonnes)":79.38,"Potatoes Production (tonnes)":4584500,"Meat, chicken Production (tonnes)":13234959,"Avocados Production (tonnes)":193,"Petrol Price (USD/liter)":1.72,"Daily Oil Consumption (Barrels)":97000,"CO2 Emissions (ton per capita)":5.61085728},{"Country":"Armenia","Country_clean":"armenia","Region":"Commonwealth of Independent States","Happiness":5.455,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.772,"Average Winter Temperature":-2.63862,"Average Summer Temperature":-2.4225743,"Population":2780469,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":58.827537759,"% of Forest Land":11.5300316122,"Territory":28470,"Average Rainfall":562,"Corruption":0.1820750087,"Wheat Production (tonnes)":328610800,"Rye Production (tonnes)":188384.1,"Potatoes Production (tonnes)":174471740,"Meat, chicken Production (tonnes)":9700,"Avocados Production (tonnes)":7610,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":6000,"CO2 Emissions (ton per capita)":2.086060678},{"Country":"South Africa","Country_clean":"south africa","Region":"Sub-Saharan Africa","Happiness":5.422,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":10.05,"Women Safety Index":0.688,"Average Winter Temperature":23.753565,"Average Summer Temperature":24.343164,"Population":59893885,"Energy Per Capita":22350.898,"% of Power from Fossil Fuels":86.194,"% of Power from Nuclear":4.714,"% of Power from Renewables":9.092,"% of Agricultural Land":79.4178502832,"% of Forest Land":14.0250847011,"Territory":1213090,"Average Rainfall":495,"Corruption":0.1603969038,"Wheat Production (tonnes)":230786548,"Rye Production (tonnes)":310517.2,"Potatoes Production (tonnes)":200506,"Meat, chicken Production (tonnes)":1296,"Avocados Production (tonnes)":2868,"Petrol Price (USD/liter)":1.48,"Daily Oil Consumption (Barrels)":640000,"CO2 Emissions (ton per capita)":7.507736092},{"Country":"North Macedonia","Country_clean":"north macedonia","Region":"Central and Eastern Europe","Happiness":5.369,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.798,"Average Winter Temperature":1.727479,"Average Summer Temperature":2.884718,"Population":2093599,"Energy Per Capita":13874.975,"% of Power from Fossil Fuels":72.818,"% of Power from Nuclear":0,"% of Power from Renewables":27.182,"% of Agricultural Land":49.9603489294,"% of Forest Land":39.7101506741,"Territory":25220,"Average Rainfall":619,"Corruption":0.1741266698,"Wheat Production (tonnes)":1044000,"Rye Production (tonnes)":143862.004,"Potatoes Production (tonnes)":10800,"Meat, chicken Production (tonnes)":63139.8,"Avocados Production (tonnes)":40944.6,"Petrol Price (USD/liter)":1.88,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":3.996737213},{"Country":"Algeria","Country_clean":"algeria","Region":"Middle East and North Africa","Happiness":5.364,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.622,"Average Winter Temperature":13.421954,"Average Summer Temperature":14.559108,"Population":44903225,"Energy Per Capita":15252.127,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":0.839,"% of Agricultural Land":17.3470041453,"% of Forest Land":0.8222276478,"Territory":2381741,"Average Rainfall":89,"Corruption":0.178580597,"Wheat Production (tonnes)":2168386,"Rye Production (tonnes)":135945,"Potatoes Production (tonnes)":4360880,"Meat, chicken Production (tonnes)":257644.62,"Avocados Production (tonnes)":1240356.5,"Petrol Price (USD/liter)":0.31,"Daily Oil Consumption (Barrels)":429000,"CO2 Emissions (ton per capita)":3.977650459},{"Country":"Hong Kong S.A.R. of China","Country_clean":"hong kong sar of china","Region":"East Asia","Happiness":5.316,"Average Wage (USD/year)":null,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":10,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":3.8095238095,"% of Forest Land":null,"Territory":1050,"Average Rainfall":null,"Corruption":0.1621359587,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Albania","Country_clean":"albania","Region":"Central and Eastern Europe","Happiness":5.304,"Average Wage (USD/year)":null,"Infant Survival Rate":1000,"Alcohol Consumption Rate":4.6,"Life Expectancy":77.8,"Netflix (USD/month)":null,"Women Safety Index":0.796,"Average Winter Temperature":4.993411,"Average Summer Temperature":5.48025,"Population":2842321,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":41.4718978102,"% of Forest Land":28.7919708029,"Territory":27400,"Average Rainfall":1485,"Corruption":0.1620248556,"Wheat Production (tonnes)":225170.9,"Rye Production (tonnes)":873343.06,"Potatoes Production (tonnes)":258862,"Meat, chicken Production (tonnes)":13250,"Avocados Production (tonnes)":4173.95,"Petrol Price (USD/liter)":2.11,"Daily Oil Consumption (Barrels)":27000,"CO2 Emissions (ton per capita)":1.69224832},{"Country":"Tajikistan","Country_clean":"tajikistan","Region":"Commonwealth of Independent States","Happiness":5.281,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.69,"Average Winter Temperature":-13.769967,"Average Summer Temperature":-9.324993,"Population":9952787,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":35.4276244686,"% of Forest Land":3.0607392463,"Territory":138790,"Average Rainfall":691,"Corruption":0.1768408716,"Wheat Production (tonnes)":10363525.6,"Rye Production (tonnes)":3997,"Potatoes Production (tonnes)":140721600,"Meat, chicken Production (tonnes)":425,"Avocados Production (tonnes)":39040.4,"Petrol Price (USD/liter)":1.57,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":1.010618692},{"Country":"Congo (Brazzaville)","Country_clean":"congo brazzaville","Region":"Sub-Saharan Africa","Happiness":5.221,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.384,"Average Winter Temperature":25.505972,"Average Summer Temperature":26.152718,"Population":99010212,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":31.2679355783,"% of Forest Land":64.2196193265,"Territory":341500,"Average Rainfall":1646,"Corruption":0.158911109,"Wheat Production (tonnes)":916614,"Rye Production (tonnes)":15,"Potatoes Production (tonnes)":32500,"Meat, chicken Production (tonnes)":1478922.8,"Avocados Production (tonnes)":21000,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":17000,"CO2 Emissions (ton per capita)":1.349316017},{"Country":"Mozambique","Country_clean":"mozambique","Region":"Sub-Saharan Africa","Happiness":5.216,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.58,"Average Winter Temperature":26.116705,"Average Summer Temperature":28.754948,"Population":32969517,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":52.6638927745,"% of Forest Land":46.4121731224,"Territory":786380,"Average Rainfall":1032,"Corruption":0.1515905112,"Wheat Production (tonnes)":960,"Rye Production (tonnes)":240600.52,"Potatoes Production (tonnes)":13900,"Meat, chicken Production (tonnes)":2108.7,"Avocados Production (tonnes)":21020,"Petrol Price (USD/liter)":1.3,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":0.246986412},{"Country":"Georgia","Country_clean":"georgia","Region":"Commonwealth of Independent States","Happiness":5.185,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.812,"Average Winter Temperature":-1.3454458,"Average Summer Temperature":-1.0580338,"Population":3744385,"Energy Per Capita":null,"% of Power from Fossil Fuels":23.806,"% of Power from Nuclear":0,"% of Power from Renewables":76.194,"% of Agricultural Land":34.2480932508,"% of Forest Land":40.6159159591,"Territory":69490,"Average Rainfall":1026,"Corruption":0.1741266698,"Wheat Production (tonnes)":33722,"Rye Production (tonnes)":1400,"Potatoes Production (tonnes)":10000,"Meat, chicken Production (tonnes)":7479107,"Avocados Production (tonnes)":83301.25,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":33000,"CO2 Emissions (ton per capita)":2.717624226},{"Country":"Iraq","Country_clean":"iraq","Region":"Middle East and North Africa","Happiness":5.166,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.424,"Average Winter Temperature":10.920471,"Average Summer Temperature":12.792713,"Population":44496122,"Energy Per Capita":14392.053,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":3.169,"% of Agricultural Land":21.7078833892,"% of Forest Land":1.9003611838,"Territory":434128,"Average Rainfall":216,"Corruption":0.2064384371,"Wheat Production (tonnes)":2000,"Rye Production (tonnes)":36788.4,"Potatoes Production (tonnes)":28,"Meat, chicken Production (tonnes)":2250,"Avocados Production (tonnes)":79661,"Petrol Price (USD/liter)":0.51,"Daily Oil Consumption (Barrels)":857000,"CO2 Emissions (ton per capita)":4.440624129},{"Country":"Nepal","Country_clean":"nepal","Region":"South Asia","Happiness":5.158,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.644,"Average Winter Temperature":3.4482849,"Average Summer Temperature":6.6038175,"Population":30547580,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":28.7478200209,"% of Forest Land":41.5907220091,"Territory":143350,"Average Rainfall":1500,"Corruption":0.1649870872,"Wheat Production (tonnes)":18053568,"Rye Production (tonnes)":1585771.6,"Potatoes Production (tonnes)":867000,"Meat, chicken Production (tonnes)":142000,"Avocados Production (tonnes)":69582.234,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":43000,"CO2 Emissions (ton per capita)":0.470136453},{"Country":"Laos","Country_clean":"laos","Region":"Southeast Asia","Happiness":5.139,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.704,"Average Winter Temperature":19.469608,"Average Summer Temperature":20.353256,"Population":7529475,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":96402500,"Rye Production (tonnes)":177940.2,"Potatoes Production (tonnes)":7540892.5,"Meat, chicken Production (tonnes)":96000,"Avocados Production (tonnes)":0,"Petrol Price (USD/liter)":1.91,"Daily Oil Consumption (Barrels)":18000,"CO2 Emissions (ton per capita)":null},{"Country":"Gabon","Country_clean":"gabon","Region":"Sub-Saharan Africa","Happiness":5.106,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.593,"Average Winter Temperature":25.409601,"Average Summer Temperature":26.325548,"Population":2388992,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":8.3565645981,"% of Forest Land":91.2745760081,"Territory":257670,"Average Rainfall":1831,"Corruption":0.1993061751,"Wheat Production (tonnes)":67690,"Rye Production (tonnes)":9447,"Potatoes Production (tonnes)":32656,"Meat, chicken Production (tonnes)":4519606,"Avocados Production (tonnes)":9710,"Petrol Price (USD/liter)":0.97,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":2.416484011},{"Country":"Ivory Coast","Country_clean":"cote divoire","Region":"Sub-Saharan Africa","Happiness":5.08,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.573,"Average Winter Temperature":26.548874,"Average Summer Temperature":27.247503,"Population":28160542,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":73.8993710692,"% of Forest Land":8.5654927673,"Territory":318000,"Average Rainfall":1348,"Corruption":0.1473762393,"Wheat Production (tonnes)":195046800,"Rye Production (tonnes)":71873.17,"Potatoes Production (tonnes)":420,"Meat, chicken Production (tonnes)":6563.91,"Avocados Production (tonnes)":53000,"Petrol Price (USD/liter)":1.18,"Daily Oil Consumption (Barrels)":51000,"CO2 Emissions (ton per capita)":0.421129515},{"Country":"Guinea","Country_clean":"guinea","Region":"Sub-Saharan Africa","Happiness":5.023,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.539,"Average Winter Temperature":25.573353,"Average Summer Temperature":26.244331,"Population":13859341,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":59.5718704216,"% of Forest Land":25.0244180368,"Territory":245720,"Average Rainfall":1651,"Corruption":0.1515905112,"Wheat Production (tonnes)":407,"Rye Production (tonnes)":295681,"Potatoes Production (tonnes)":1109560,"Meat, chicken Production (tonnes)":351,"Avocados Production (tonnes)":5720,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":19001,"CO2 Emissions (ton per capita)":0.309288541},{"Country":"Turkiye","Country_clean":"turkiye","Region":"Middle East and North Africa","Happiness":4.975,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":null,"Average Winter Temperature":null,"Average Summer Temperature":null,"Population":null,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":49.4900146824,"% of Forest Land":29.0741785014,"Territory":769630,"Average Rainfall":593,"Corruption":0.1640447378,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":4.75658475},{"Country":"Senegal","Country_clean":"senegal","Region":"Sub-Saharan Africa","Happiness":4.969,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.619,"Average Winter Temperature":25.55183,"Average Summer Temperature":26.647112,"Population":17316449,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":49.4000934919,"% of Forest Land":41.6982288475,"Territory":192530,"Average Rainfall":686,"Corruption":0.1473762393,"Wheat Production (tonnes)":56920,"Rye Production (tonnes)":13524458.4,"Potatoes Production (tonnes)":879000,"Meat, chicken Production (tonnes)":117856.39,"Avocados Production (tonnes)":113807.792,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":49000,"CO2 Emissions (ton per capita)":0.651679184},{"Country":"Iran","Country_clean":"iran","Region":"Middle East and North Africa","Happiness":4.923,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.557,"Average Winter Temperature":6.699771,"Average Summer Temperature":9.465016,"Population":88550570,"Energy Per Capita":38133.086,"% of Power from Fossil Fuels":94.081,"% of Power from Nuclear":0.955,"% of Power from Renewables":4.965,"% of Agricultural Land":29.0089368259,"% of Forest Land":6.635211094,"Territory":1622500,"Average Rainfall":228,"Corruption":0.1734505892,"Wheat Production (tonnes)":1562160,"Rye Production (tonnes)":71601,"Potatoes Production (tonnes)":195000,"Meat, chicken Production (tonnes)":2530,"Avocados Production (tonnes)":382467,"Petrol Price (USD/liter)":0.05,"Daily Oil Consumption (Barrels)":1803999,"CO2 Emissions (ton per capita)":7.598364845},{"Country":"Azerbaijan","Country_clean":"azerbaijan","Region":"Commonwealth of Independent States","Happiness":4.893,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.667,"Average Winter Temperature":1.85439,"Average Summer Temperature":3.2257857,"Population":10358074,"Energy Per Capita":18747.918,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":6.343,"% of Agricultural Land":57.8415003025,"% of Forest Land":13.8329909256,"Territory":82650,"Average Rainfall":447,"Corruption":0.1841555238,"Wheat Production (tonnes)":1348186,"Rye Production (tonnes)":7577,"Potatoes Production (tonnes)":31,"Meat, chicken Production (tonnes)":95517,"Avocados Production (tonnes)":4200,"Petrol Price (USD/liter)":0.59,"Daily Oil Consumption (Barrels)":96000,"CO2 Emissions (ton per capita)":3.542397828},{"Country":"Nigeria","Country_clean":"nigeria","Region":"Sub-Saharan Africa","Happiness":4.881,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.465,"Average Winter Temperature":25.011763,"Average Summer Temperature":25.588018,"Population":218541212,"Energy Per Capita":null,"% of Power from Fossil Fuels":72.492,"% of Power from Nuclear":0,"% of Power from Renewables":27.508,"% of Agricultural Land":75.3691931003,"% of Forest Land":23.5664876972,"Territory":910770,"Average Rainfall":1150,"Corruption":0.1521603316,"Wheat Production (tonnes)":199000,"Rye Production (tonnes)":10328099,"Potatoes Production (tonnes)":1850,"Meat, chicken Production (tonnes)":1441905,"Avocados Production (tonnes)":80609.488,"Petrol Price (USD/liter)":0.42,"Daily Oil Consumption (Barrels)":428000,"CO2 Emissions (ton per capita)":0.573636206},{"Country":"State of Palestine","Country_clean":"state of palestine","Region":"Middle East and North Africa","Happiness":4.879,"Average Wage (USD/year)":null,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":10.99,"Women Safety Index":0.483,"Average Winter Temperature":13.515371,"Average Summer Temperature":14.106538,"Population":5250072,"Energy Per Capita":21683.146,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":80.468,"% of Agricultural Land":68.7719298246,"% of Forest Land":6.0701754386,"Territory":570,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":23762000,"Rye Production (tonnes)":391.1,"Potatoes Production (tonnes)":7529025,"Meat, chicken Production (tonnes)":52000,"Avocados Production (tonnes)":145795,"Petrol Price (USD/liter)":1.75,"Daily Oil Consumption (Barrels)":24001,"CO2 Emissions (ton per capita)":null},{"Country":"Cameroon","Country_clean":"cameroon","Region":"Sub-Saharan Africa","Happiness":4.874,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.466,"Average Winter Temperature":24.881084,"Average Summer Temperature":24.946562,"Population":27914536,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":20.6257536333,"% of Forest Land":42.9110448266,"Territory":472710,"Average Rainfall":1604,"Corruption":0.1473762393,"Wheat Production (tonnes)":31793,"Rye Production (tonnes)":10210326,"Potatoes Production (tonnes)":2133322.8,"Meat, chicken Production (tonnes)":6922.65,"Avocados Production (tonnes)":28994,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":0.364424922},{"Country":"Ukraine","Country_clean":"ukraine","Region":"Commonwealth of Independent States","Happiness":4.873,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":8.46,"Women Safety Index":0.626,"Average Winter Temperature":-1.7763926,"Average Summer Temperature":0.87508214,"Population":39701739,"Energy Per Capita":16309.124,"% of Power from Fossil Fuels":25.424,"% of Power from Nuclear":58.058,"% of Power from Renewables":16.518,"% of Agricultural Land":71.2996202969,"% of Forest Land":16.7345529858,"Territory":579400,"Average Rainfall":565,"Corruption":0.1620248556,"Wheat Production (tonnes)":2727560,"Rye Production (tonnes)":10948.6,"Potatoes Production (tonnes)":330779000,"Meat, chicken Production (tonnes)":80000,"Avocados Production (tonnes)":97652.8,"Petrol Price (USD/liter)":1.7,"Daily Oil Consumption (Barrels)":244000,"CO2 Emissions (ton per capita)":3.936583531},{"Country":"Namibia","Country_clean":"namibia","Region":"Sub-Saharan Africa","Happiness":4.832,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.61,"Average Winter Temperature":25.959553,"Average Summer Temperature":26.584833,"Population":2567012,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":47.1425621591,"% of Forest Land":7.9776142064,"Territory":823290,"Average Rainfall":285,"Corruption":0.1675386727,"Wheat Production (tonnes)":18053568,"Rye Production (tonnes)":2762388.832,"Potatoes Production (tonnes)":24754506,"Meat, chicken Production (tonnes)":9280,"Avocados Production (tonnes)":567.4,"Petrol Price (USD/liter)":1.27,"Daily Oil Consumption (Barrels)":26000,"CO2 Emissions (ton per capita)":1.691705428},{"Country":"Morocco","Country_clean":"morocco","Region":"Middle East and North Africa","Happiness":4.795,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.637,"Average Winter Temperature":11.878008,"Average Summer Temperature":13.544462,"Population":37457971,"Energy Per Capita":6855.11,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":17.382,"% of Agricultural Land":67.8713869594,"% of Forest Land":12.8903354246,"Territory":446300,"Average Rainfall":346,"Corruption":0.1603332013,"Wheat Production (tonnes)":580,"Rye Production (tonnes)":240600.52,"Potatoes Production (tonnes)":1642,"Meat, chicken Production (tonnes)":8401090,"Avocados Production (tonnes)":21020,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":275000,"CO2 Emissions (ton per capita)":1.959872285},{"Country":"Pakistan","Country_clean":"pakistan","Region":"South Asia","Happiness":4.657,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":9.189832,"Average Summer Temperature":9.4178095,"Population":235824862,"Energy Per Capita":4242.753,"% of Power from Fossil Fuels":56.575,"% of Power from Nuclear":14.74,"% of Power from Renewables":28.685,"% of Agricultural Land":47.0929327522,"% of Forest Land":4.7796803653,"Territory":770880,"Average Rainfall":494,"Corruption":0.1551976055,"Wheat Production (tonnes)":2326000,"Rye Production (tonnes)":2036086.2,"Potatoes Production (tonnes)":1000,"Meat, chicken Production (tonnes)":1.6,"Avocados Production (tonnes)":548570.264,"Petrol Price (USD/liter)":1.03,"Daily Oil Consumption (Barrels)":556000,"CO2 Emissions (ton per capita)":0.879965499},{"Country":"Niger","Country_clean":"niger","Region":"Sub-Saharan Africa","Happiness":4.556,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.442,"Average Winter Temperature":18.64278,"Average Summer Temperature":19.539503,"Population":26207977,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":36.7845583011,"% of Forest Land":0.8425673009,"Territory":1266700,"Average Rainfall":151,"Corruption":0.1515905112,"Wheat Production (tonnes)":6040500,"Rye Production (tonnes)":3735380.8,"Potatoes Production (tonnes)":770127,"Meat, chicken Production (tonnes)":15557,"Avocados Production (tonnes)":87005.8,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.092232251},{"Country":"Burkina Faso","Country_clean":"burkina faso","Region":"Sub-Saharan Africa","Happiness":4.548,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":25.427477,"Average Summer Temperature":26.73383,"Population":22673762,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":46.5643274854,"% of Forest Land":22.5380116959,"Territory":273600,"Average Rainfall":748,"Corruption":0.1515905112,"Wheat Production (tonnes)":1780160,"Rye Production (tonnes)":21900,"Potatoes Production (tonnes)":3760,"Meat, chicken Production (tonnes)":24732.78,"Avocados Production (tonnes)":138000,"Petrol Price (USD/liter)":1.14,"Daily Oil Consumption (Barrels)":23000,"CO2 Emissions (ton per capita)":0.246046246},{"Country":"Mauritania","Country_clean":"mauritania","Region":"Sub-Saharan Africa","Happiness":4.505,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.506,"Average Winter Temperature":20.794834,"Average Summer Temperature":21.64168,"Population":4736139,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":38.5272145144,"% of Forest Land":0.2982116038,"Territory":1030700,"Average Rainfall":92,"Corruption":0.163652122,"Wheat Production (tonnes)":329411,"Rye Production (tonnes)":845441.6,"Potatoes Production (tonnes)":326562,"Meat, chicken Production (tonnes)":58000,"Avocados Production (tonnes)":91812.448,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.872793555},{"Country":"Gambia","Country_clean":"gambia","Region":"Sub-Saharan Africa","Happiness":4.485,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.575,"Average Winter Temperature":25.587826,"Average Summer Temperature":26.182985,"Population":2705992,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":62.6482213439,"% of Forest Land":23.4123814229,"Territory":10120,"Average Rainfall":836,"Corruption":0.1527849287,"Wheat Production (tonnes)":50000,"Rye Production (tonnes)":4000,"Potatoes Production (tonnes)":40392,"Meat, chicken Production (tonnes)":4631097,"Avocados Production (tonnes)":9710,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":3800,"CO2 Emissions (ton per capita)":0.247050718},{"Country":"Chad","Country_clean":"chad","Region":"Sub-Saharan Africa","Happiness":4.471,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.462,"Average Winter Temperature":21.083433,"Average Summer Temperature":21.204617,"Population":17723315,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":39.9761753494,"% of Forest Land":3.3365099269,"Territory":1259200,"Average Rainfall":322,"Corruption":0.1769557148,"Wheat Production (tonnes)":94838540,"Rye Production (tonnes)":10666877,"Potatoes Production (tonnes)":1300,"Meat, chicken Production (tonnes)":703003,"Avocados Production (tonnes)":83403.5,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.141093412},{"Country":"Kenya","Country_clean":"kenya","Region":"Sub-Saharan Africa","Happiness":4.47,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.511,"Average Winter Temperature":25.798006,"Average Summer Temperature":26.603018,"Population":54027487,"Energy Per Capita":null,"% of Power from Fossil Fuels":10.219,"% of Power from Nuclear":0,"% of Power from Renewables":89.781,"% of Agricultural Land":48.6874934111,"% of Forest Land":6.3448184981,"Territory":569140,"Average Rainfall":630,"Corruption":0.1473762393,"Wheat Production (tonnes)":250320,"Rye Production (tonnes)":76025.194,"Potatoes Production (tonnes)":112000,"Meat, chicken Production (tonnes)":698000,"Avocados Production (tonnes)":370,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":114000,"CO2 Emissions (ton per capita)":0.423783898},{"Country":"Tunisia","Country_clean":"tunisia","Region":"Middle East and North Africa","Happiness":4.422,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.669,"Average Winter Temperature":12.263956,"Average Summer Temperature":12.730293,"Population":12356117,"Energy Per Capita":null,"% of Power from Fossil Fuels":95.611,"% of Power from Nuclear":0,"% of Power from Renewables":4.389,"% of Agricultural Land":62.4388516993,"% of Forest Land":4.533084449,"Territory":155360,"Average Rainfall":207,"Corruption":0.1589545012,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":0.76,"Daily Oil Consumption (Barrels)":97000,"CO2 Emissions (ton per capita)":2.557564208},{"Country":"Benin","Country_clean":"benin","Region":"Sub-Saharan Africa","Happiness":4.377,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.566,"Average Winter Temperature":26.43899,"Average Summer Temperature":27.806599,"Population":13352864,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":35.0301525364,"% of Forest Land":27.3603228095,"Territory":112760,"Average Rainfall":1039,"Corruption":0.1563068628,"Wheat Production (tonnes)":4326575,"Rye Production (tonnes)":2949,"Potatoes Production (tonnes)":12335,"Meat, chicken Production (tonnes)":18924,"Avocados Production (tonnes)":12800,"Petrol Price (USD/liter)":0.96,"Daily Oil Consumption (Barrels)":36000,"CO2 Emissions (ton per capita)":0.618583746},{"Country":"Uganda","Country_clean":"uganda","Region":"Sub-Saharan Africa","Happiness":4.372,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.544,"Average Winter Temperature":23.9091,"Average Summer Temperature":24.655352,"Population":47249585,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":71.8880909635,"% of Forest Land":11.4534375623,"Territory":200520,"Average Rainfall":1180,"Corruption":0.1515905112,"Wheat Production (tonnes)":2727560,"Rye Production (tonnes)":10948.6,"Potatoes Production (tonnes)":297921600,"Meat, chicken Production (tonnes)":25400,"Avocados Production (tonnes)":97652.8,"Petrol Price (USD/liter)":1.51,"Daily Oil Consumption (Barrels)":32001,"CO2 Emissions (ton per capita)":0.132370788},{"Country":"Myanmar","Country_clean":"myanmar","Region":"Southeast Asia","Happiness":4.354,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.451,"Average Winter Temperature":18.82836,"Average Summer Temperature":20.528673,"Population":54179306,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":19.8875388788,"% of Forest Land":43.2901466285,"Territory":652670,"Average Rainfall":2091,"Corruption":0.1673619598,"Wheat Production (tonnes)":2105000,"Rye Production (tonnes)":160787.4,"Potatoes Production (tonnes)":73000,"Meat, chicken Production (tonnes)":15600,"Avocados Production (tonnes)":133.254,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":123000,"CO2 Emissions (ton per capita)":0.679428523},{"Country":"Cambodia","Country_clean":"cambodia","Region":"Southeast Asia","Happiness":4.341,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.645,"Average Winter Temperature":25.820742,"Average Summer Temperature":26.725933,"Population":16767842,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":34.5521170406,"% of Forest Land":44.8259687288,"Territory":176520,"Average Rainfall":1904,"Corruption":0.1557928324,"Wheat Production (tonnes)":93873230,"Rye Production (tonnes)":14953906,"Potatoes Production (tonnes)":1175.02,"Meat, chicken Production (tonnes)":183000,"Avocados Production (tonnes)":231517.88,"Petrol Price (USD/liter)":1.53,"Daily Oil Consumption (Barrels)":48000,"CO2 Emissions (ton per capita)":0.98140655},{"Country":"Ghana","Country_clean":"ghana","Region":"Sub-Saharan Africa","Happiness":4.289,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.651,"Average Winter Temperature":27.695566,"Average Summer Temperature":28.66266,"Population":33475870,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":55.3930199136,"% of Forest Land":35.1286771589,"Territory":227533,"Average Rainfall":1187,"Corruption":0.1473762393,"Wheat Production (tonnes)":16184871,"Rye Production (tonnes)":263400,"Potatoes Production (tonnes)":6323,"Meat, chicken Production (tonnes)":100860,"Avocados Production (tonnes)":16800,"Petrol Price (USD/liter)":1.29,"Daily Oil Consumption (Barrels)":88000,"CO2 Emissions (ton per capita)":0.658823541},{"Country":"Liberia","Country_clean":"liberia","Region":"Sub-Saharan Africa","Happiness":4.269,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.5,"Average Winter Temperature":26.30846,"Average Summer Temperature":26.822199,"Population":5302681,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":19.9651162791,"% of Forest Land":78.7705564784,"Territory":96320,"Average Rainfall":2391,"Corruption":0.1515905112,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.3,"Daily Oil Consumption (Barrels)":8000,"CO2 Emissions (ton per capita)":0.23899343},{"Country":"Mali","Country_clean":"mali","Region":"Sub-Saharan Africa","Happiness":4.232,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":22.10115,"Average Summer Temperature":23.133558,"Population":22593590,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":35.3477737074,"% of Forest Land":10.8966636344,"Territory":1220190,"Average Rainfall":282,"Corruption":0.1473762393,"Wheat Production (tonnes)":4187394,"Rye Production (tonnes)":2372272,"Potatoes Production (tonnes)":1924871,"Meat, chicken Production (tonnes)":494128,"Avocados Production (tonnes)":11187.4,"Petrol Price (USD/liter)":1.22,"Daily Oil Consumption (Barrels)":21999,"CO2 Emissions (ton per capita)":0.29657102},{"Country":"Madagascar","Country_clean":"madagascar","Region":"Sub-Saharan Africa","Happiness":4.228,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.505,"Average Winter Temperature":24.953327,"Average Summer Temperature":25.925783,"Population":29611714,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":70.2904778274,"% of Forest Land":21.341692506,"Territory":581800,"Average Rainfall":1513,"Corruption":0.1534845382,"Wheat Production (tonnes)":2286,"Rye Production (tonnes)":3011811.06,"Potatoes Production (tonnes)":1483500,"Meat, chicken Production (tonnes)":7284,"Avocados Production (tonnes)":14839.178,"Petrol Price (USD/liter)":1.02,"Daily Oil Consumption (Barrels)":18000,"CO2 Emissions (ton per capita)":0.152766255},{"Country":"Togo","Country_clean":"togo","Region":"Sub-Saharan Africa","Happiness":4.214,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.595,"Average Winter Temperature":27.114004,"Average Summer Temperature":28.22776,"Population":8848699,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":70.2334988049,"% of Forest Land":22.1788931789,"Territory":54390,"Average Rainfall":1168,"Corruption":0.1515905112,"Wheat Production (tonnes)":1169283.4,"Rye Production (tonnes)":9853.4,"Potatoes Production (tonnes)":682800,"Meat, chicken Production (tonnes)":328000,"Avocados Production (tonnes)":179232.066,"Petrol Price (USD/liter)":0.84,"Daily Oil Consumption (Barrels)":15000,"CO2 Emissions (ton per capita)":0.293231207},{"Country":"Jordan","Country_clean":"jordan","Region":"Middle East and North Africa","Happiness":4.186,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.679,"Average Winter Temperature":10.618665,"Average Summer Temperature":11.0657425,"Population":11285869,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":11.5210487195,"% of Forest Land":1.0980471653,"Territory":88794,"Average Rainfall":111,"Corruption":0.1633208543,"Wheat Production (tonnes)":1268900,"Rye Production (tonnes)":391236.668,"Potatoes Production (tonnes)":140000,"Meat, chicken Production (tonnes)":250,"Avocados Production (tonnes)":190,"Petrol Price (USD/liter)":1.66,"Daily Oil Consumption (Barrels)":114000,"CO2 Emissions (ton per capita)":2.438204112},{"Country":"India","Country_clean":"india","Region":"South Asia","Happiness":4.054,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":6.61,"Women Safety Index":0.595,"Average Winter Temperature":16.979853,"Average Summer Temperature":18.022833,"Population":1417173173,"Energy Per Capita":7143.406,"% of Power from Fossil Fuels":77.006,"% of Power from Nuclear":2.519,"% of Power from Renewables":20.476,"% of Agricultural Land":60.0459264292,"% of Forest Land":24.3598290052,"Territory":2973190,"Average Rainfall":1083,"Corruption":0.1470372379,"Wheat Production (tonnes)":1286332,"Rye Production (tonnes)":4688054,"Potatoes Production (tonnes)":3087000,"Meat, chicken Production (tonnes)":990,"Avocados Production (tonnes)":22132,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":4443000,"CO2 Emissions (ton per capita)":1.797620119},{"Country":"Egypt","Country_clean":"egypt","Region":"Middle East and North Africa","Happiness":3.977,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.645,"Average Winter Temperature":14.330447,"Average Summer Temperature":14.60245,"Population":110990103,"Energy Per Capita":9960.062,"% of Power from Fossil Fuels":88.779,"% of Power from Nuclear":0,"% of Power from Renewables":11.221,"% of Agricultural Land":4.0494248832,"% of Forest Land":0.0451855945,"Territory":995450,"Average Rainfall":18.1,"Corruption":0.1632932276,"Wheat Production (tonnes)":1085494,"Rye Production (tonnes)":9716,"Potatoes Production (tonnes)":104900960,"Meat, chicken Production (tonnes)":842853,"Avocados Production (tonnes)":0,"Petrol Price (USD/liter)":0.52,"Daily Oil Consumption (Barrels)":877000,"CO2 Emissions (ton per capita)":2.484059911},{"Country":"Sri Lanka","Country_clean":"sri lanka","Region":"South Asia","Happiness":3.898,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.743,"Average Winter Temperature":25.60819,"Average Summer Temperature":25.9974,"Population":21832143,"Energy Per Capita":4347.636,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":51.574,"% of Agricultural Land":45.4574846427,"% of Forest Land":34.1070158422,"Territory":61860,"Average Rainfall":1712,"Corruption":0.1708792597,"Wheat Production (tonnes)":953620,"Rye Production (tonnes)":334353.706,"Potatoes Production (tonnes)":84310000,"Meat, chicken Production (tonnes)":3670,"Avocados Production (tonnes)":16564.6,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":127000,"CO2 Emissions (ton per capita)":1.090675627},{"Country":"Bangladesh","Country_clean":"bangladesh","Region":"South Asia","Happiness":3.886,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.593,"Average Winter Temperature":16.99154,"Average Summer Temperature":19.676044,"Population":171186372,"Energy Per Capita":2912.048,"% of Power from Fossil Fuels":98.052,"% of Power from Nuclear":0,"% of Power from Renewables":1.948,"% of Agricultural Land":77.3450103711,"% of Forest Land":14.4687716064,"Territory":130170,"Average Rainfall":2666,"Corruption":0.1545842141,"Wheat Production (tonnes)":11000,"Rye Production (tonnes)":341300,"Potatoes Production (tonnes)":3296077,"Meat, chicken Production (tonnes)":8222.25,"Avocados Production (tonnes)":55000,"Petrol Price (USD/liter)":0.95,"Daily Oil Consumption (Barrels)":113000,"CO2 Emissions (ton per capita)":0.556529455},{"Country":"Ethiopia","Country_clean":"ethiopia","Region":"Sub-Saharan Africa","Happiness":3.861,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.521,"Average Winter Temperature":22.94068,"Average Summer Temperature":23.82733,"Population":123379924,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":34.1981062224,"% of Forest Land":15.0593059801,"Territory":1128571.265,"Average Rainfall":848,"Corruption":0.1515905112,"Wheat Production (tonnes)":8126800,"Rye Production (tonnes)":7124000,"Potatoes Production (tonnes)":51085360,"Meat, chicken Production (tonnes)":48000,"Avocados Production (tonnes)":762336,"Petrol Price (USD/liter)":0.71,"Daily Oil Consumption (Barrels)":74000,"CO2 Emissions (ton per capita)":0.163813429},{"Country":"Tanzania","Country_clean":"tanzania","Region":"Sub-Saharan Africa","Happiness":3.781,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.652,"Average Winter Temperature":22.93629,"Average Summer Temperature":23.6847,"Population":65497748,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":44.6163919621,"% of Forest Land":51.1131180853,"Territory":885800,"Average Rainfall":1071,"Corruption":0.1473762393,"Wheat Production (tonnes)":23410593.11,"Rye Production (tonnes)":6242369.62,"Potatoes Production (tonnes)":102287,"Meat, chicken Production (tonnes)":368,"Avocados Production (tonnes)":111386.946,"Petrol Price (USD/liter)":1.28,"Daily Oil Consumption (Barrels)":71999,"CO2 Emissions (ton per capita)":0.21463496},{"Country":"Comoros","Country_clean":"comoros","Region":"Sub-Saharan Africa","Happiness":3.566,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.519,"Average Winter Temperature":26.264544,"Average Summer Temperature":26.784773,"Population":836774,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":71.4669532509,"% of Forest Land":17.4529822676,"Territory":1861,"Average Rainfall":900,"Corruption":0.2269586474,"Wheat Production (tonnes)":700,"Rye Production (tonnes)":28383.1,"Potatoes Production (tonnes)":820515,"Meat, chicken Production (tonnes)":13808618,"Avocados Production (tonnes)":1552.63,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":1300,"CO2 Emissions (ton per capita)":0.376076363},{"Country":"Yemen","Country_clean":"yemen","Region":"Middle East and North Africa","Happiness":3.561,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.287,"Average Winter Temperature":19.670574,"Average Summer Temperature":21.359116,"Population":33696614,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":44.4191904843,"% of Forest Land":1.0398318086,"Territory":527970,"Average Rainfall":167,"Corruption":0.1827792972,"Wheat Production (tonnes)":202362,"Rye Production (tonnes)":16472.4,"Potatoes Production (tonnes)":58010040.4,"Meat, chicken Production (tonnes)":2458136,"Avocados Production (tonnes)":11979.6,"Petrol Price (USD/liter)":0.52,"Daily Oil Consumption (Barrels)":60000,"CO2 Emissions (ton per capita)":0.380633361},{"Country":"Zambia","Country_clean":"zambia","Region":"Sub-Saharan Africa","Happiness":3.502,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.556,"Average Winter Temperature":23.009497,"Average Summer Temperature":25.123566,"Population":20017675,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":32.0679589448,"% of Forest Land":60.0301501231,"Territory":743390,"Average Rainfall":1020,"Corruption":0.1535387486,"Wheat Production (tonnes)":12373724.2,"Rye Production (tonnes)":3980041.4,"Potatoes Production (tonnes)":1539264.8,"Meat, chicken Production (tonnes)":16400,"Avocados Production (tonnes)":17474.034,"Petrol Price (USD/liter)":1.48,"Daily Oil Consumption (Barrels)":22000,"CO2 Emissions (ton per capita)":0.380717051},{"Country":"Eswatini","Country_clean":"eswatini","Region":"Sub-Saharan Africa","Happiness":3.502,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.415,"Average Winter Temperature":23.062267,"Average Summer Temperature":24.690916,"Population":1201670,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":69.476744186,"% of Forest Land":28.998255814,"Territory":17200,"Average Rainfall":788,"Corruption":0.2084804773,"Wheat Production (tonnes)":242000,"Rye Production (tonnes)":685,"Potatoes Production (tonnes)":84367810,"Meat, chicken Production (tonnes)":148000,"Avocados Production (tonnes)":192307,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.836140045},{"Country":"Malawi","Country_clean":"malawi","Region":"Sub-Saharan Africa","Happiness":3.421,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.521,"Average Winter Temperature":23.77365,"Average Summer Temperature":25.912868,"Population":20405317,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":64.1705557913,"% of Forest Land":23.3315655494,"Territory":94280,"Average Rainfall":1181,"Corruption":0.1473762393,"Wheat Production (tonnes)":23310800,"Rye Production (tonnes)":2242357.8,"Potatoes Production (tonnes)":447532.88,"Meat, chicken Production (tonnes)":6200,"Avocados Production (tonnes)":68493.6,"Petrol Price (USD/liter)":1.35,"Daily Oil Consumption (Barrels)":6001,"CO2 Emissions (ton per capita)":0.077836684},{"Country":"Botswana","Country_clean":"botswana","Region":"Sub-Saharan Africa","Happiness":3.383,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.659,"Average Winter Temperature":26.46735,"Average Summer Temperature":28.064913,"Population":2630296,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":45.6337232898,"% of Forest Land":26.7083090713,"Territory":566730,"Average Rainfall":416,"Corruption":0.1603969038,"Wheat Production (tonnes)":2713157,"Rye Production (tonnes)":557002.44,"Potatoes Production (tonnes)":30482,"Meat, chicken Production (tonnes)":57420,"Avocados Production (tonnes)":830,"Petrol Price (USD/liter)":1.13,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":3.147107071},{"Country":"Zimbabwe","Country_clean":"zimbabwe","Region":"Sub-Saharan Africa","Happiness":3.341,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.604,"Average Winter Temperature":23.768185,"Average Summer Temperature":27.019161,"Population":16320537,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":41.876696394,"% of Forest Land":44.9748222825,"Territory":386850,"Average Rainfall":657,"Corruption":0.1515905112,"Wheat Production (tonnes)":1316724.8,"Rye Production (tonnes)":140284.8,"Potatoes Production (tonnes)":271012.612,"Meat, chicken Production (tonnes)":8000,"Avocados Production (tonnes)":29313.66,"Petrol Price (USD/liter)":1.62,"Daily Oil Consumption (Barrels)":24000,"CO2 Emissions (ton per capita)":0.80297852},{"Country":"Congo (Kinshasa)","Country_clean":"congo kinshasa","Region":"Sub-Saharan Africa","Happiness":3.295,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.384,"Average Winter Temperature":25.505972,"Average Summer Temperature":26.152718,"Population":99010212,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":31.2679355783,"% of Forest Land":64.2196193265,"Territory":341500,"Average Rainfall":1646,"Corruption":0.158911109,"Wheat Production (tonnes)":916614,"Rye Production (tonnes)":15,"Potatoes Production (tonnes)":32500,"Meat, chicken Production (tonnes)":1478922.8,"Avocados Production (tonnes)":21000,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":17000,"CO2 Emissions (ton per capita)":1.349316017},{"Country":"Sierra Leone","Country_clean":"sierra leone","Region":"Sub-Saharan Africa","Happiness":3.245,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.543,"Average Winter Temperature":26.811758,"Average Summer Temperature":27.633963,"Population":8605718,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":54.710446107,"% of Forest Land":34.8455250762,"Territory":72180,"Average Rainfall":2526,"Corruption":0.1473762393,"Wheat Production (tonnes)":127106.8,"Rye Production (tonnes)":49816.2,"Potatoes Production (tonnes)":65460290,"Meat, chicken Production (tonnes)":688538.1,"Avocados Production (tonnes)":17496,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":6500,"CO2 Emissions (ton per capita)":0.115189573},{"Country":"Lesotho","Country_clean":"lesotho","Region":"Sub-Saharan Africa","Happiness":3.186,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.605,"Average Winter Temperature":16.68572,"Average Summer Temperature":18.73354,"Population":2305825,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":80.1383399209,"% of Forest Land":1.1370223979,"Territory":30360,"Average Rainfall":788,"Corruption":0.1740706116,"Wheat Production (tonnes)":18781986,"Rye Production (tonnes)":10563.96,"Potatoes Production (tonnes)":285000,"Meat, chicken Production (tonnes)":1068500,"Avocados Production (tonnes)":1664340,"Petrol Price (USD/liter)":1.5,"Daily Oil Consumption (Barrels)":5001,"CO2 Emissions (ton per capita)":0.362307409},{"Country":"Lebanon","Country_clean":"lebanon","Region":"Middle East and North Africa","Happiness":2.707,"Average Wage (USD/year)":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.595,"Average Winter Temperature":9.020683,"Average Summer Temperature":9.587217,"Population":5489739,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":66.4027370479,"% of Forest Land":14.0694037146,"Territory":10230,"Average Rainfall":661,"Corruption":0.1708792597,"Wheat Production (tonnes)":239916,"Rye Production (tonnes)":714111.8,"Potatoes Production (tonnes)":200810,"Meat, chicken Production (tonnes)":541292,"Avocados Production (tonnes)":195067.11,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":153000,"CO2 Emissions (ton per capita)":4.076894274},{"Country":"Afghanistan","Country_clean":"afghanistan","Region":"South Asia","Happiness":1.721,"Average Wage (USD/year)":null,"Infant Survival Rate":938,"Alcohol Consumption Rate":0.01,"Life Expectancy":65,"Netflix (USD/month)":null,"Women Safety Index":0.286,"Average Winter Temperature":0.047207996,"Average Summer Temperature":3.3000636,"Population":41128771,"Energy Per Capita":null,"% of Power from Fossil Fuels":null,"% of Power from Nuclear":null,"% of Power from Renewables":null,"% of Agricultural Land":58.7415482269,"% of Forest Land":1.8527819941,"Territory":652230,"Average Rainfall":327,"Corruption":0.1827608198,"Wheat Production (tonnes)":3900000,"Rye Production (tonnes)":96473.03,"Potatoes Production (tonnes)":864772,"Meat, chicken Production (tonnes)":28029.23,"Avocados Production (tonnes)":1069854.4,"Petrol Price (USD/liter)":0.96,"Daily Oil Consumption (Barrels)":35000,"CO2 Emissions (ton per capita)":0.159824372}]');function ig(R,U){if(typeof R=="function")return R(U);R!=null&&(R.current=U)}function Cg(...R){return U=>{let G=!1;const k=R.map(Q=>{const ee=ig(Q,U);return!G&&typeof ee=="function"&&(G=!0),ee});if(G)return()=>{for(let Q=0;Q<k.length;Q++){const ee=k[Q];typeof ee=="function"?ee():ig(R[Q],null)}}}}function kf(...R){return mt.useCallback(Cg(...R),R)}function Wp(R){const U=Ry(R),G=mt.forwardRef((k,Q)=>{const{children:ee,...E}=k,c=mt.Children.toArray(ee),q=c.find(zy);if(q){const te=q.props.children,Se=c.map(ze=>ze===q?mt.Children.count(te)>1?mt.Children.only(null):mt.isValidElement(te)?te.props.children:null:ze);return Ie.jsx(U,{...E,ref:Q,children:mt.isValidElement(te)?mt.cloneElement(te,void 0,Se):null})}return Ie.jsx(U,{...E,ref:Q,children:ee})});return G.displayName=`${R}.Slot`,G}var My=Wp("Slot");function Ry(R){const U=mt.forwardRef((G,k)=>{const{children:Q,...ee}=G;if(mt.isValidElement(Q)){const E=Ly(Q),c=Iy(ee,Q.props);return Q.type!==mt.Fragment&&(c.ref=k?Cg(k,E):E),mt.cloneElement(Q,c)}return mt.Children.count(Q)>1?mt.Children.only(null):null});return U.displayName=`${R}.SlotClone`,U}var Dy=Symbol("radix.slottable");function zy(R){return mt.isValidElement(R)&&typeof R.type=="function"&&"__radixId"in R.type&&R.type.__radixId===Dy}function Iy(R,U){const G={...U};for(const k in U){const Q=R[k],ee=U[k];/^on[A-Z]/.test(k)?Q&&ee?G[k]=(...c)=>{const q=ee(...c);return Q(...c),q}:Q&&(G[k]=Q):k==="style"?G[k]={...Q,...ee}:k==="className"&&(G[k]=[Q,ee].filter(Boolean).join(" "))}return{...R,...G}}function Ly(R){let U=Object.getOwnPropertyDescriptor(R.props,"ref")?.get,G=U&&"isReactWarning"in U&&U.isReactWarning;return G?R.ref:(U=Object.getOwnPropertyDescriptor(R,"ref")?.get,G=U&&"isReactWarning"in U&&U.isReactWarning,G?R.props.ref:R.props.ref||R.ref)}function Tg(R){var U,G,k="";if(typeof R=="string"||typeof R=="number")k+=R;else if(typeof R=="object")if(Array.isArray(R)){var Q=R.length;for(U=0;U<Q;U++)R[U]&&(G=Tg(R[U]))&&(k&&(k+=" "),k+=G)}else for(G in R)R[G]&&(k&&(k+=" "),k+=G);return k}function Ag(){for(var R,U,G=0,k="",Q=arguments.length;G<Q;G++)(R=arguments[G])&&(U=Tg(R))&&(k&&(k+=" "),k+=U);return k}const ag=R=>typeof R=="boolean"?`${R}`:R===0?"0":R,og=Ag,ky=(R,U)=>G=>{var k;if(U?.variants==null)return og(R,G?.class,G?.className);const{variants:Q,defaultVariants:ee}=U,E=Object.keys(Q).map(te=>{const Se=G?.[te],ze=ee?.[te];if(Se===null)return null;const Ce=ag(Se)||ag(ze);return Q[te][Ce]}),c=G&&Object.entries(G).reduce((te,Se)=>{let[ze,Ce]=Se;return Ce===void 0||(te[ze]=Ce),te},{}),q=U==null||(k=U.compoundVariants)===null||k===void 0?void 0:k.reduce((te,Se)=>{let{class:ze,className:Ce,...ue}=Se;return Object.entries(ue).every(je=>{let[Ge,Ye]=je;return Array.isArray(Ye)?Ye.includes({...ee,...c}[Ge]):{...ee,...c}[Ge]===Ye})?[...te,ze,Ce]:te},[]);return og(R,E,q,G?.class,G?.className)},Dm="-",Oy=R=>{const U=Fy(R),{conflictingClassGroups:G,conflictingClassGroupModifiers:k}=R;return{getClassGroupId:E=>{const c=E.split(Dm);return c[0]===""&&c.length!==1&&c.shift(),Eg(c,U)||By(E)},getConflictingClassGroupIds:(E,c)=>{const q=G[E]||[];return c&&k[E]?[...q,...k[E]]:q}}},Eg=(R,U)=>{if(R.length===0)return U.classGroupId;const G=R[0],k=U.nextPart.get(G),Q=k?Eg(R.slice(1),k):void 0;if(Q)return Q;if(U.validators.length===0)return;const ee=R.join(Dm);return U.validators.find(({validator:E})=>E(ee))?.classGroupId},sg=/^\[(.+)\]$/,By=R=>{if(sg.test(R)){const U=sg.exec(R)[1],G=U?.substring(0,U.indexOf(":"));if(G)return"arbitrary.."+G}},Fy=R=>{const{theme:U,classGroups:G}=R,k={nextPart:new Map,validators:[]};for(const Q in G)Pm(G[Q],k,Q,U);return k},Pm=(R,U,G,k)=>{R.forEach(Q=>{if(typeof Q=="string"){const ee=Q===""?U:lg(U,Q);ee.classGroupId=G;return}if(typeof Q=="function"){if(Ny(Q)){Pm(Q(k),U,G,k);return}U.validators.push({validator:Q,classGroupId:G});return}Object.entries(Q).forEach(([ee,E])=>{Pm(E,lg(U,ee),G,k)})})},lg=(R,U)=>{let G=R;return U.split(Dm).forEach(k=>{G.nextPart.has(k)||G.nextPart.set(k,{nextPart:new Map,validators:[]}),G=G.nextPart.get(k)}),G},Ny=R=>R.isThemeGetter,Uy=R=>{if(R<1)return{get:()=>{},set:()=>{}};let U=0,G=new Map,k=new Map;const Q=(ee,E)=>{G.set(ee,E),U++,U>R&&(U=0,k=G,G=new Map)};return{get(ee){let E=G.get(ee);if(E!==void 0)return E;if((E=k.get(ee))!==void 0)return Q(ee,E),E},set(ee,E){G.has(ee)?G.set(ee,E):Q(ee,E)}}},Cm="!",Tm=":",jy=Tm.length,Vy=R=>{const{prefix:U,experimentalParseClassName:G}=R;let k=Q=>{const ee=[];let E=0,c=0,q=0,te;for(let je=0;je<Q.length;je++){let Ge=Q[je];if(E===0&&c===0){if(Ge===Tm){ee.push(Q.slice(q,je)),q=je+jy;continue}if(Ge==="/"){te=je;continue}}Ge==="["?E++:Ge==="]"?E--:Ge==="("?c++:Ge===")"&&c--}const Se=ee.length===0?Q:Q.substring(q),ze=Gy(Se),Ce=ze!==Se,ue=te&&te>q?te-q:void 0;return{modifiers:ee,hasImportantModifier:Ce,baseClassName:ze,maybePostfixModifierPosition:ue}};if(U){const Q=U+Tm,ee=k;k=E=>E.startsWith(Q)?ee(E.substring(Q.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:E,maybePostfixModifierPosition:void 0}}if(G){const Q=k;k=ee=>G({className:ee,parseClassName:Q})}return k},Gy=R=>R.endsWith(Cm)?R.substring(0,R.length-1):R.startsWith(Cm)?R.substring(1):R,Wy=R=>{const U=Object.fromEntries(R.orderSensitiveModifiers.map(k=>[k,!0]));return k=>{if(k.length<=1)return k;const Q=[];let ee=[];return k.forEach(E=>{E[0]==="["||U[E]?(Q.push(...ee.sort(),E),ee=[]):ee.push(E)}),Q.push(...ee.sort()),Q}},Zy=R=>({cache:Uy(R.cacheSize),parseClassName:Vy(R),sortModifiers:Wy(R),...Oy(R)}),qy=/\s+/,Hy=(R,U)=>{const{parseClassName:G,getClassGroupId:k,getConflictingClassGroupIds:Q,sortModifiers:ee}=U,E=[],c=R.trim().split(qy);let q="";for(let te=c.length-1;te>=0;te-=1){const Se=c[te],{isExternal:ze,modifiers:Ce,hasImportantModifier:ue,baseClassName:je,maybePostfixModifierPosition:Ge}=G(Se);if(ze){q=Se+(q.length>0?" "+q:q);continue}let Ye=!!Ge,We=k(Ye?je.substring(0,Ge):je);if(!We){if(!Ye){q=Se+(q.length>0?" "+q:q);continue}if(We=k(je),!We){q=Se+(q.length>0?" "+q:q);continue}Ye=!1}const He=ee(Ce).join(":"),nt=ue?He+Cm:He,wt=nt+We;if(E.includes(wt))continue;E.push(wt);const xt=Q(We,Ye);for(let Tt=0;Tt<xt.length;++Tt){const It=xt[Tt];E.push(nt+It)}q=Se+(q.length>0?" "+q:q)}return q};function $y(){let R=0,U,G,k="";for(;R<arguments.length;)(U=arguments[R++])&&(G=Mg(U))&&(k&&(k+=" "),k+=G);return k}const Mg=R=>{if(typeof R=="string")return R;let U,G="";for(let k=0;k<R.length;k++)R[k]&&(U=Mg(R[k]))&&(G&&(G+=" "),G+=U);return G};function Xy(R,...U){let G,k,Q,ee=E;function E(q){const te=U.reduce((Se,ze)=>ze(Se),R());return G=Zy(te),k=G.cache.get,Q=G.cache.set,ee=c,c(q)}function c(q){const te=k(q);if(te)return te;const Se=Hy(q,G);return Q(q,Se),Se}return function(){return ee($y.apply(null,arguments))}}const Zi=R=>{const U=G=>G[R]||[];return U.isThemeGetter=!0,U},Rg=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Dg=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Yy=/^\d+\/\d+$/,Ky=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Qy=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Jy=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,e_=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,t_=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_d=R=>Yy.test(R),Tn=R=>!!R&&!Number.isNaN(Number(R)),Cc=R=>!!R&&Number.isInteger(Number(R)),_m=R=>R.endsWith("%")&&Tn(R.slice(0,-1)),Iu=R=>Ky.test(R),n_=()=>!0,r_=R=>Qy.test(R)&&!Jy.test(R),zg=()=>!1,i_=R=>e_.test(R),a_=R=>t_.test(R),o_=R=>!kt(R)&&!Ot(R),s_=R=>xd(R,kg,zg),kt=R=>Rg.test(R),Rh=R=>xd(R,Og,r_),vm=R=>xd(R,d_,Tn),ug=R=>xd(R,Ig,zg),l_=R=>xd(R,Lg,a_),Bp=R=>xd(R,Bg,i_),Ot=R=>Dg.test(R),zf=R=>bd(R,Og),u_=R=>bd(R,f_),cg=R=>bd(R,Ig),c_=R=>bd(R,kg),h_=R=>bd(R,Lg),Fp=R=>bd(R,Bg,!0),xd=(R,U,G)=>{const k=Rg.exec(R);return k?k[1]?U(k[1]):G(k[2]):!1},bd=(R,U,G=!1)=>{const k=Dg.exec(R);return k?k[1]?U(k[1]):G:!1},Ig=R=>R==="position"||R==="percentage",Lg=R=>R==="image"||R==="url",kg=R=>R==="length"||R==="size"||R==="bg-size",Og=R=>R==="length",d_=R=>R==="number",f_=R=>R==="family-name",Bg=R=>R==="shadow",p_=()=>{const R=Zi("color"),U=Zi("font"),G=Zi("text"),k=Zi("font-weight"),Q=Zi("tracking"),ee=Zi("leading"),E=Zi("breakpoint"),c=Zi("container"),q=Zi("spacing"),te=Zi("radius"),Se=Zi("shadow"),ze=Zi("inset-shadow"),Ce=Zi("text-shadow"),ue=Zi("drop-shadow"),je=Zi("blur"),Ge=Zi("perspective"),Ye=Zi("aspect"),We=Zi("ease"),He=Zi("animate"),nt=()=>["auto","avoid","all","avoid-page","page","left","right","column"],wt=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],xt=()=>[...wt(),Ot,kt],Tt=()=>["auto","hidden","clip","visible","scroll"],It=()=>["auto","contain","none"],ut=()=>[Ot,kt,q],Gt=()=>[_d,"full","auto",...ut()],pn=()=>[Cc,"none","subgrid",Ot,kt],nn=()=>["auto",{span:["full",Cc,Ot,kt]},Cc,Ot,kt],on=()=>[Cc,"auto",Ot,kt],jn=()=>["auto","min","max","fr",Ot,kt],er=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],mn=()=>["start","end","center","stretch","center-safe","end-safe"],Ue=()=>["auto",...ut()],ht=()=>[_d,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...ut()],tt=()=>[R,Ot,kt],At=()=>[...wt(),cg,ug,{position:[Ot,kt]}],me=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Ze=()=>["auto","cover","contain",c_,s_,{size:[Ot,kt]}],gt=()=>[_m,zf,Rh],rt=()=>["","none","full",te,Ot,kt],yt=()=>["",Tn,zf,Rh],Kt=()=>["solid","dashed","dotted","double"],Dt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Zt=()=>[Tn,_m,cg,ug],Vt=()=>["","none",je,Ot,kt],En=()=>["none",Tn,Ot,kt],tr=()=>["none",Tn,Ot,kt],xn=()=>[Tn,Ot,kt],vt=()=>[_d,"full",...ut()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Iu],breakpoint:[Iu],color:[n_],container:[Iu],"drop-shadow":[Iu],ease:["in","out","in-out"],font:[o_],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Iu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Iu],shadow:[Iu],spacing:["px",Tn],text:[Iu],"text-shadow":[Iu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",_d,kt,Ot,Ye]}],container:["container"],columns:[{columns:[Tn,kt,Ot,c]}],"break-after":[{"break-after":nt()}],"break-before":[{"break-before":nt()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:xt()}],overflow:[{overflow:Tt()}],"overflow-x":[{"overflow-x":Tt()}],"overflow-y":[{"overflow-y":Tt()}],overscroll:[{overscroll:It()}],"overscroll-x":[{"overscroll-x":It()}],"overscroll-y":[{"overscroll-y":It()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Gt()}],"inset-x":[{"inset-x":Gt()}],"inset-y":[{"inset-y":Gt()}],start:[{start:Gt()}],end:[{end:Gt()}],top:[{top:Gt()}],right:[{right:Gt()}],bottom:[{bottom:Gt()}],left:[{left:Gt()}],visibility:["visible","invisible","collapse"],z:[{z:[Cc,"auto",Ot,kt]}],basis:[{basis:[_d,"full","auto",c,...ut()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Tn,_d,"auto","initial","none",kt]}],grow:[{grow:["",Tn,Ot,kt]}],shrink:[{shrink:["",Tn,Ot,kt]}],order:[{order:[Cc,"first","last","none",Ot,kt]}],"grid-cols":[{"grid-cols":pn()}],"col-start-end":[{col:nn()}],"col-start":[{"col-start":on()}],"col-end":[{"col-end":on()}],"grid-rows":[{"grid-rows":pn()}],"row-start-end":[{row:nn()}],"row-start":[{"row-start":on()}],"row-end":[{"row-end":on()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":jn()}],"auto-rows":[{"auto-rows":jn()}],gap:[{gap:ut()}],"gap-x":[{"gap-x":ut()}],"gap-y":[{"gap-y":ut()}],"justify-content":[{justify:[...er(),"normal"]}],"justify-items":[{"justify-items":[...mn(),"normal"]}],"justify-self":[{"justify-self":["auto",...mn()]}],"align-content":[{content:["normal",...er()]}],"align-items":[{items:[...mn(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...mn(),{baseline:["","last"]}]}],"place-content":[{"place-content":er()}],"place-items":[{"place-items":[...mn(),"baseline"]}],"place-self":[{"place-self":["auto",...mn()]}],p:[{p:ut()}],px:[{px:ut()}],py:[{py:ut()}],ps:[{ps:ut()}],pe:[{pe:ut()}],pt:[{pt:ut()}],pr:[{pr:ut()}],pb:[{pb:ut()}],pl:[{pl:ut()}],m:[{m:Ue()}],mx:[{mx:Ue()}],my:[{my:Ue()}],ms:[{ms:Ue()}],me:[{me:Ue()}],mt:[{mt:Ue()}],mr:[{mr:Ue()}],mb:[{mb:Ue()}],ml:[{ml:Ue()}],"space-x":[{"space-x":ut()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":ut()}],"space-y-reverse":["space-y-reverse"],size:[{size:ht()}],w:[{w:[c,"screen",...ht()]}],"min-w":[{"min-w":[c,"screen","none",...ht()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[E]},...ht()]}],h:[{h:["screen","lh",...ht()]}],"min-h":[{"min-h":["screen","lh","none",...ht()]}],"max-h":[{"max-h":["screen","lh",...ht()]}],"font-size":[{text:["base",G,zf,Rh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[k,Ot,vm]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",_m,kt]}],"font-family":[{font:[u_,kt,U]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[Q,Ot,kt]}],"line-clamp":[{"line-clamp":[Tn,"none",Ot,vm]}],leading:[{leading:[ee,...ut()]}],"list-image":[{"list-image":["none",Ot,kt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ot,kt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:tt()}],"text-color":[{text:tt()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Kt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Tn,"from-font","auto",Ot,Rh]}],"text-decoration-color":[{decoration:tt()}],"underline-offset":[{"underline-offset":[Tn,"auto",Ot,kt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ut()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ot,kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ot,kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:At()}],"bg-repeat":[{bg:me()}],"bg-size":[{bg:Ze()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Cc,Ot,kt],radial:["",Ot,kt],conic:[Cc,Ot,kt]},h_,l_]}],"bg-color":[{bg:tt()}],"gradient-from-pos":[{from:gt()}],"gradient-via-pos":[{via:gt()}],"gradient-to-pos":[{to:gt()}],"gradient-from":[{from:tt()}],"gradient-via":[{via:tt()}],"gradient-to":[{to:tt()}],rounded:[{rounded:rt()}],"rounded-s":[{"rounded-s":rt()}],"rounded-e":[{"rounded-e":rt()}],"rounded-t":[{"rounded-t":rt()}],"rounded-r":[{"rounded-r":rt()}],"rounded-b":[{"rounded-b":rt()}],"rounded-l":[{"rounded-l":rt()}],"rounded-ss":[{"rounded-ss":rt()}],"rounded-se":[{"rounded-se":rt()}],"rounded-ee":[{"rounded-ee":rt()}],"rounded-es":[{"rounded-es":rt()}],"rounded-tl":[{"rounded-tl":rt()}],"rounded-tr":[{"rounded-tr":rt()}],"rounded-br":[{"rounded-br":rt()}],"rounded-bl":[{"rounded-bl":rt()}],"border-w":[{border:yt()}],"border-w-x":[{"border-x":yt()}],"border-w-y":[{"border-y":yt()}],"border-w-s":[{"border-s":yt()}],"border-w-e":[{"border-e":yt()}],"border-w-t":[{"border-t":yt()}],"border-w-r":[{"border-r":yt()}],"border-w-b":[{"border-b":yt()}],"border-w-l":[{"border-l":yt()}],"divide-x":[{"divide-x":yt()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":yt()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Kt(),"hidden","none"]}],"divide-style":[{divide:[...Kt(),"hidden","none"]}],"border-color":[{border:tt()}],"border-color-x":[{"border-x":tt()}],"border-color-y":[{"border-y":tt()}],"border-color-s":[{"border-s":tt()}],"border-color-e":[{"border-e":tt()}],"border-color-t":[{"border-t":tt()}],"border-color-r":[{"border-r":tt()}],"border-color-b":[{"border-b":tt()}],"border-color-l":[{"border-l":tt()}],"divide-color":[{divide:tt()}],"outline-style":[{outline:[...Kt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Tn,Ot,kt]}],"outline-w":[{outline:["",Tn,zf,Rh]}],"outline-color":[{outline:tt()}],shadow:[{shadow:["","none",Se,Fp,Bp]}],"shadow-color":[{shadow:tt()}],"inset-shadow":[{"inset-shadow":["none",ze,Fp,Bp]}],"inset-shadow-color":[{"inset-shadow":tt()}],"ring-w":[{ring:yt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:tt()}],"ring-offset-w":[{"ring-offset":[Tn,Rh]}],"ring-offset-color":[{"ring-offset":tt()}],"inset-ring-w":[{"inset-ring":yt()}],"inset-ring-color":[{"inset-ring":tt()}],"text-shadow":[{"text-shadow":["none",Ce,Fp,Bp]}],"text-shadow-color":[{"text-shadow":tt()}],opacity:[{opacity:[Tn,Ot,kt]}],"mix-blend":[{"mix-blend":[...Dt(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Dt()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Tn]}],"mask-image-linear-from-pos":[{"mask-linear-from":Zt()}],"mask-image-linear-to-pos":[{"mask-linear-to":Zt()}],"mask-image-linear-from-color":[{"mask-linear-from":tt()}],"mask-image-linear-to-color":[{"mask-linear-to":tt()}],"mask-image-t-from-pos":[{"mask-t-from":Zt()}],"mask-image-t-to-pos":[{"mask-t-to":Zt()}],"mask-image-t-from-color":[{"mask-t-from":tt()}],"mask-image-t-to-color":[{"mask-t-to":tt()}],"mask-image-r-from-pos":[{"mask-r-from":Zt()}],"mask-image-r-to-pos":[{"mask-r-to":Zt()}],"mask-image-r-from-color":[{"mask-r-from":tt()}],"mask-image-r-to-color":[{"mask-r-to":tt()}],"mask-image-b-from-pos":[{"mask-b-from":Zt()}],"mask-image-b-to-pos":[{"mask-b-to":Zt()}],"mask-image-b-from-color":[{"mask-b-from":tt()}],"mask-image-b-to-color":[{"mask-b-to":tt()}],"mask-image-l-from-pos":[{"mask-l-from":Zt()}],"mask-image-l-to-pos":[{"mask-l-to":Zt()}],"mask-image-l-from-color":[{"mask-l-from":tt()}],"mask-image-l-to-color":[{"mask-l-to":tt()}],"mask-image-x-from-pos":[{"mask-x-from":Zt()}],"mask-image-x-to-pos":[{"mask-x-to":Zt()}],"mask-image-x-from-color":[{"mask-x-from":tt()}],"mask-image-x-to-color":[{"mask-x-to":tt()}],"mask-image-y-from-pos":[{"mask-y-from":Zt()}],"mask-image-y-to-pos":[{"mask-y-to":Zt()}],"mask-image-y-from-color":[{"mask-y-from":tt()}],"mask-image-y-to-color":[{"mask-y-to":tt()}],"mask-image-radial":[{"mask-radial":[Ot,kt]}],"mask-image-radial-from-pos":[{"mask-radial-from":Zt()}],"mask-image-radial-to-pos":[{"mask-radial-to":Zt()}],"mask-image-radial-from-color":[{"mask-radial-from":tt()}],"mask-image-radial-to-color":[{"mask-radial-to":tt()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":wt()}],"mask-image-conic-pos":[{"mask-conic":[Tn]}],"mask-image-conic-from-pos":[{"mask-conic-from":Zt()}],"mask-image-conic-to-pos":[{"mask-conic-to":Zt()}],"mask-image-conic-from-color":[{"mask-conic-from":tt()}],"mask-image-conic-to-color":[{"mask-conic-to":tt()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:At()}],"mask-repeat":[{mask:me()}],"mask-size":[{mask:Ze()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ot,kt]}],filter:[{filter:["","none",Ot,kt]}],blur:[{blur:Vt()}],brightness:[{brightness:[Tn,Ot,kt]}],contrast:[{contrast:[Tn,Ot,kt]}],"drop-shadow":[{"drop-shadow":["","none",ue,Fp,Bp]}],"drop-shadow-color":[{"drop-shadow":tt()}],grayscale:[{grayscale:["",Tn,Ot,kt]}],"hue-rotate":[{"hue-rotate":[Tn,Ot,kt]}],invert:[{invert:["",Tn,Ot,kt]}],saturate:[{saturate:[Tn,Ot,kt]}],sepia:[{sepia:["",Tn,Ot,kt]}],"backdrop-filter":[{"backdrop-filter":["","none",Ot,kt]}],"backdrop-blur":[{"backdrop-blur":Vt()}],"backdrop-brightness":[{"backdrop-brightness":[Tn,Ot,kt]}],"backdrop-contrast":[{"backdrop-contrast":[Tn,Ot,kt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Tn,Ot,kt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Tn,Ot,kt]}],"backdrop-invert":[{"backdrop-invert":["",Tn,Ot,kt]}],"backdrop-opacity":[{"backdrop-opacity":[Tn,Ot,kt]}],"backdrop-saturate":[{"backdrop-saturate":[Tn,Ot,kt]}],"backdrop-sepia":[{"backdrop-sepia":["",Tn,Ot,kt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":ut()}],"border-spacing-x":[{"border-spacing-x":ut()}],"border-spacing-y":[{"border-spacing-y":ut()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ot,kt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Tn,"initial",Ot,kt]}],ease:[{ease:["linear","initial",We,Ot,kt]}],delay:[{delay:[Tn,Ot,kt]}],animate:[{animate:["none",He,Ot,kt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[Ge,Ot,kt]}],"perspective-origin":[{"perspective-origin":xt()}],rotate:[{rotate:En()}],"rotate-x":[{"rotate-x":En()}],"rotate-y":[{"rotate-y":En()}],"rotate-z":[{"rotate-z":En()}],scale:[{scale:tr()}],"scale-x":[{"scale-x":tr()}],"scale-y":[{"scale-y":tr()}],"scale-z":[{"scale-z":tr()}],"scale-3d":["scale-3d"],skew:[{skew:xn()}],"skew-x":[{"skew-x":xn()}],"skew-y":[{"skew-y":xn()}],transform:[{transform:[Ot,kt,"","none","gpu","cpu"]}],"transform-origin":[{origin:xt()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:vt()}],"translate-x":[{"translate-x":vt()}],"translate-y":[{"translate-y":vt()}],"translate-z":[{"translate-z":vt()}],"translate-none":["translate-none"],accent:[{accent:tt()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:tt()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ot,kt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ut()}],"scroll-mx":[{"scroll-mx":ut()}],"scroll-my":[{"scroll-my":ut()}],"scroll-ms":[{"scroll-ms":ut()}],"scroll-me":[{"scroll-me":ut()}],"scroll-mt":[{"scroll-mt":ut()}],"scroll-mr":[{"scroll-mr":ut()}],"scroll-mb":[{"scroll-mb":ut()}],"scroll-ml":[{"scroll-ml":ut()}],"scroll-p":[{"scroll-p":ut()}],"scroll-px":[{"scroll-px":ut()}],"scroll-py":[{"scroll-py":ut()}],"scroll-ps":[{"scroll-ps":ut()}],"scroll-pe":[{"scroll-pe":ut()}],"scroll-pt":[{"scroll-pt":ut()}],"scroll-pr":[{"scroll-pr":ut()}],"scroll-pb":[{"scroll-pb":ut()}],"scroll-pl":[{"scroll-pl":ut()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ot,kt]}],fill:[{fill:["none",...tt()]}],"stroke-w":[{stroke:[Tn,zf,Rh,vm]}],stroke:[{stroke:["none",...tt()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},m_=Xy(p_);function Ca(...R){return m_(Ag(R))}const g_=ky("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Uf({className:R,variant:U,size:G,asChild:k=!1,...Q}){const ee=k?My:"button";return Ie.jsx(ee,{"data-slot":"button",className:Ca(g_({variant:U,size:G,className:R})),...Q})}function y_({className:R,type:U,...G}){return Ie.jsx("input",{type:U,"data-slot":"input",className:Ca("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",R),...G})}var Up={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.3/LICENSE.txt
 */var __=Up.exports,hg;function v_(){return hg||(hg=1,(function(R,U){(function(G,k){R.exports=k()})(__,(function(){var G={},k={};function Q(E,c,q){if(k[E]=q,E==="index"){var te="var sharedModule = {}; ("+k.shared+")(sharedModule); ("+k.worker+")(sharedModule);",Se={};return k.shared(Se),k.index(G,Se),typeof window<"u"&&G.setWorkerUrl(window.URL.createObjectURL(new Blob([te],{type:"text/javascript"}))),G}}Q("shared",["exports"],(function(E){function c(i,t,r,s){return new(r||(r=Promise))((function(h,m){function y(P){try{b(s.next(P))}catch(A){m(A)}}function v(P){try{b(s.throw(P))}catch(A){m(A)}}function b(P){var A;P.done?h(P.value):(A=P.value,A instanceof r?A:new r((function(D){D(A)}))).then(y,v)}b((s=s.apply(i,t||[])).next())}))}function q(i,t){this.x=i,this.y=t}function te(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Se,ze;typeof SuppressedError=="function"&&SuppressedError,q.prototype={clone(){return new q(this.x,this.y)},add(i){return this.clone()._add(i)},sub(i){return this.clone()._sub(i)},multByPoint(i){return this.clone()._multByPoint(i)},divByPoint(i){return this.clone()._divByPoint(i)},mult(i){return this.clone()._mult(i)},div(i){return this.clone()._div(i)},rotate(i){return this.clone()._rotate(i)},rotateAround(i,t){return this.clone()._rotateAround(i,t)},matMult(i){return this.clone()._matMult(i)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(i){return this.x===i.x&&this.y===i.y},dist(i){return Math.sqrt(this.distSqr(i))},distSqr(i){const t=i.x-this.x,r=i.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith(i){return this.angleWithSep(i.x,i.y)},angleWithSep(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult(i){const t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add(i){return this.x+=i.x,this.y+=i.y,this},_sub(i){return this.x-=i.x,this.y-=i.y,this},_mult(i){return this.x*=i,this.y*=i,this},_div(i){return this.x/=i,this.y/=i,this},_multByPoint(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint(i){return this.x/=i.x,this.y/=i.y,this},_unit(){return this._div(this.mag()),this},_perp(){const i=this.y;return this.y=this.x,this.x=-i,this},_rotate(i){const t=Math.cos(i),r=Math.sin(i),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround(i,t){const r=Math.cos(i),s=Math.sin(i),h=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:q},q.convert=function(i){if(i instanceof q)return i;if(Array.isArray(i))return new q(+i[0],+i[1]);if(i.x!==void 0&&i.y!==void 0)return new q(+i.x,+i.y);throw new Error("Expected [x, y] or {x, y} point format")};var Ce=(function(){if(ze)return Se;function i(t,r,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=s,this.p2y=h}return ze=1,Se=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var v=0,b=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<r));h++)t>m?v=s:b=s,s=.5*(b-v)+v;return s},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Se})(),ue=te(Ce);let je,Ge;function Ye(){return je==null&&(je=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),je}function We(){if(Ge==null&&(Ge=!1,Ye())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<25;s++){const h=4*s;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let s=0;s<100;s++)if(s%4!=3&&r[s]!==s){Ge=!0;break}}}return Ge||!1}var He=1e-6,nt=typeof Float32Array<"u"?Float32Array:Array;function wt(){var i=new nt(9);return nt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function xt(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Tt(){var i=new nt(3);return nt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function It(i){var t=i[0],r=i[1],s=i[2];return Math.sqrt(t*t+r*r+s*s)}function ut(i,t,r){var s=new nt(3);return s[0]=i,s[1]=t,s[2]=r,s}function Gt(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i}function pn(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i}function nn(i,t,r){var s=t[0],h=t[1],m=t[2],y=r[0],v=r[1],b=r[2];return i[0]=h*b-m*v,i[1]=m*y-s*b,i[2]=s*v-h*y,i}var on,jn=It;function er(i,t,r){var s=t[0],h=t[1],m=t[2],y=t[3];return i[0]=r[0]*s+r[4]*h+r[8]*m+r[12]*y,i[1]=r[1]*s+r[5]*h+r[9]*m+r[13]*y,i[2]=r[2]*s+r[6]*h+r[10]*m+r[14]*y,i[3]=r[3]*s+r[7]*h+r[11]*m+r[15]*y,i}function mn(){var i=new nt(4);return nt!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function Ue(i,t,r,s){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",m=Math.PI/360;t*=m,s*=m,r*=m;var y=Math.sin(t),v=Math.cos(t),b=Math.sin(r),P=Math.cos(r),A=Math.sin(s),D=Math.cos(s);switch(h){case"xyz":i[0]=y*P*D+v*b*A,i[1]=v*b*D-y*P*A,i[2]=v*P*A+y*b*D,i[3]=v*P*D-y*b*A;break;case"xzy":i[0]=y*P*D-v*b*A,i[1]=v*b*D-y*P*A,i[2]=v*P*A+y*b*D,i[3]=v*P*D+y*b*A;break;case"yxz":i[0]=y*P*D+v*b*A,i[1]=v*b*D-y*P*A,i[2]=v*P*A-y*b*D,i[3]=v*P*D+y*b*A;break;case"yzx":i[0]=y*P*D+v*b*A,i[1]=v*b*D+y*P*A,i[2]=v*P*A-y*b*D,i[3]=v*P*D-y*b*A;break;case"zxy":i[0]=y*P*D-v*b*A,i[1]=v*b*D+y*P*A,i[2]=v*P*A+y*b*D,i[3]=v*P*D-y*b*A;break;case"zyx":i[0]=y*P*D-v*b*A,i[1]=v*b*D+y*P*A,i[2]=v*P*A-y*b*D,i[3]=v*P*D+y*b*A;break;default:throw new Error("Unknown angle order "+h)}return i}function ht(){var i=new nt(2);return nt!=Float32Array&&(i[0]=0,i[1]=0),i}function tt(i,t){var r=new nt(2);return r[0]=i,r[1]=t,r}Tt(),on=new nt(4),nt!=Float32Array&&(on[0]=0,on[1]=0,on[2]=0,on[3]=0),Tt(),ut(1,0,0),ut(0,1,0),mn(),mn(),wt(),ht();const At=8192;function me(i,t,r){return t*(At/(i.tileSize*Math.pow(2,r-i.tileID.overscaledZ)))}function Ze(i,t){return(i%t+t)%t}function gt(i,t,r){return i*(1-r)+t*r}function rt(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,r=t*i;return 4*(i<.5?r:3*(i-t)+r-.75)}function yt(i,t,r,s){const h=new ue(i,t,r,s);return m=>h.solve(m)}const Kt=yt(.25,.1,.25,1);function Dt(i,t,r){return Math.min(r,Math.max(t,i))}function Zt(i,t,r){const s=r-t,h=((i-t)%s+s)%s+t;return h===t?r:h}function Vt(i,...t){for(const r of t)for(const s in r)i[s]=r[s];return i}let En=1;function tr(i,t,r){const s={};for(const h in i)s[h]=t.call(this,i[h],h,i);return s}function xn(i,t,r){const s={};for(const h in i)t.call(this,i[h],h,i)&&(s[h]=i[h]);return s}function vt(i){return Array.isArray(i)?i.map(vt):typeof i=="object"&&i?tr(i,vt):i}const qt={};function un(i){qt[i]||(typeof console<"u"&&console.warn(i),qt[i]=!0)}function qn(i,t,r){return(r.y-i.y)*(t.x-i.x)>(t.y-i.y)*(r.x-i.x)}function Ar(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let nr=null;function Kr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Ei(i,t,r,s,h){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(i,{timestamp:0});try{const y=m?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),b=new Uint8ClampedArray(s*h*4);if(yield m.copyTo(b,(function(P,A,D,L,F){const N=4*Math.max(-A,0),Z=(Math.max(0,D)-D)*L*4+N,X=4*L,ne=Math.max(0,A),be=Math.max(0,D);return{rect:{x:ne,y:be,width:Math.min(P.width,A+L)-ne,height:Math.min(P.height,D+F)-be},layout:[{offset:Z,stride:X}]}})(i,t,r,s,h)),v)for(let P=0;P<b.length;P+=4){const A=b[P];b[P]=b[P+2],b[P+2]=A}return b}finally{m.close()}}))}let oi,ga;function na(i,t,r,s){return i.addEventListener(t,r,s),{unsubscribe:()=>{i.removeEventListener(t,r,s)}}}function Za(i){return i*Math.PI/180}function Ta(i){return i/Math.PI*180}const qi={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},gr={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Mi="AbortError";function ge(){return new Error(Mi)}const j={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function V(i){return j.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const $="global-dispatcher";class oe extends Error{constructor(t,r,s,h){super(`AJAXError: ${r} (${t}): ${s}`),this.status=t,this.statusText=r,this.url=s,this.body=h}}const he=()=>Ar(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,ye=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const s=V(i.url);if(s)return s(i,t);if(Ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:$},t)}if(!(/^file:/.test(r=i.url)||/^file:/.test(he())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(s,h){return c(this,void 0,void 0,(function*(){const m=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:he(),signal:h.signal});let y,v;s.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{y=yield fetch(m)}catch(P){throw new oe(0,P.message,s.url,new Blob)}if(!y.ok){const P=yield y.blob();throw new oe(y.status,y.statusText,s.url,P)}v=s.type==="arrayBuffer"||s.type==="image"?y.arrayBuffer():s.type==="json"?y.json():y.text();const b=yield v;if(h.signal.aborted)throw ge();return{data:b,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}}))})(i,t);if(Ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:$},t)}var r;return(function(s,h){return new Promise(((m,y)=>{var v;const b=new XMLHttpRequest;b.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(b.responseType="arraybuffer");for(const P in s.headers)b.setRequestHeader(P,s.headers[P]);s.type==="json"&&(b.responseType="text",!((v=s.headers)===null||v===void 0)&&v.Accept||b.setRequestHeader("Accept","application/json")),b.withCredentials=s.credentials==="include",b.onerror=()=>{y(new Error(b.statusText))},b.onload=()=>{if(!h.signal.aborted)if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let P=b.response;if(s.type==="json")try{P=JSON.parse(b.response)}catch(A){return void y(A)}m({data:P,cacheControl:b.getResponseHeader("Cache-Control"),expires:b.getResponseHeader("Expires")})}else{const P=new Blob([b.response],{type:b.getResponseHeader("Content-Type")});y(new oe(b.status,b.statusText,s.url,P))}},h.signal.addEventListener("abort",(()=>{b.abort(),y(ge())})),b.send(s.body)}))})(i,t)};function Me(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function ve(i,t,r){r[i]&&r[i].indexOf(t)!==-1||(r[i]=r[i]||[],r[i].push(t))}function Ne(i,t,r){if(r&&r[i]){const s=r[i].indexOf(t);s!==-1&&r[i].splice(s,1)}}class et{constructor(t,r={}){Vt(this,r),this.type=t}}class qe extends et{constructor(t,r={}){super("error",Vt({error:t},r))}}class bt{on(t,r){return this._listeners=this._listeners||{},ve(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return Ne(t,r,this._listeners),Ne(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},ve(t,r,this._oneTimeListeners),this):new Promise((s=>this.once(t,s)))}fire(t,r){typeof t=="string"&&(t=new et(t,r||{}));const s=t.type;if(this.listens(s)){t.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of m)Ne(s,v,this._oneTimeListeners),v.call(this,t);const y=this._eventedParent;y&&(Vt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof qe&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Wt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function hn(i,t){const r={};for(const s in i)s!=="ref"&&(r[s]=i[s]);return Wt.forEach((s=>{s in t&&(r[s]=t[s])})),r}function Mt(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(!Mt(i[r],t[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const r in i)if(!Mt(i[r],t[r]))return!1;return!0}return i===t}function Ht(i,t){i.push(t)}function zn(i,t,r){Ht(r,{command:"addSource",args:[i,t[i]]})}function Fr(i,t,r){Ht(t,{command:"removeSource",args:[i]}),r[i]=!0}function Vr(i,t,r,s){Fr(i,r,s),zn(i,t,r)}function Vn(i,t,r){let s;for(s in i[r])if(Object.prototype.hasOwnProperty.call(i[r],s)&&s!=="data"&&!Mt(i[r][s],t[r][s]))return!1;for(s in t[r])if(Object.prototype.hasOwnProperty.call(t[r],s)&&s!=="data"&&!Mt(i[r][s],t[r][s]))return!1;return!0}function Nt(i,t,r,s,h,m){i=i||{},t=t||{};for(const y in i)Object.prototype.hasOwnProperty.call(i,y)&&(Mt(i[y],t[y])||r.push({command:m,args:[s,y,t[y],h]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(Mt(i[y],t[y])||r.push({command:m,args:[s,y,t[y],h]}))}function $t(i){return i.id}function lr(i,t){return i[t.id]=t,i}class it{constructor(t,r,s,h){this.message=(t?`${t}: `:"")+s,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function yi(i,...t){for(const r of t)for(const s in r)i[s]=r[s];return i}class yr extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class fo{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[s,h]of r)this.bindings[s]=h}concat(t){return new fo(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const qa={kind:"null"},pt={kind:"number"},rn={kind:"string"},Qt={kind:"boolean"},Er={kind:"color"},ya={kind:"projectionDefinition"},ur={kind:"object"},an={kind:"value"},Vl={kind:"collator"},Hi={kind:"formatted"},po={kind:"padding"},Ha={kind:"colorArray"},ls={kind:"numberArray"},_r={kind:"resolvedImage"},Lu={kind:"variableAnchorOffsetCollection"};function si(i,t){return{kind:"array",itemType:i,N:t}}function In(i){if(i.kind==="array"){const t=In(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const $a=[qa,pt,rn,Qt,Er,ya,Hi,ur,si(an),po,ls,Ha,_r,Lu];function us(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!us(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const r of $a)if(!us(r,t))return null}}return`Expected ${In(i)} but found ${In(t)} instead.`}function ku(i,t){return t.some((r=>r.kind===i.kind))}function ra(i,t){return t.some((r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i))}function Xa(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const Gl=.96422,Ih=.82521,Tc=4/29,li=6/29,Ac=3*li*li,wd=li*li*li,Ou=Math.PI/180,Lh=180/Math.PI;function el(i){return(i%=360)<0&&(i+=360),i}function tl([i,t,r,s]){let h,m;const y=Wl((.2225045*(i=$i(i))+.7168786*(t=$i(t))+.0606169*(r=$i(r)))/1);i===t&&t===r?h=m=y:(h=Wl((.4360747*i+.3850649*t+.1430804*r)/Gl),m=Wl((.0139322*i+.0971045*t+.7141733*r)/Ih));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-m),s]}function $i(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Wl(i){return i>wd?Math.pow(i,1/3):i/Ac+Tc}function cs([i,t,r,s]){let h=(i+16)/116,m=isNaN(t)?h:h+t/500,y=isNaN(r)?h:h-r/200;return h=1*No(h),m=Gl*No(m),y=Ih*No(y),[Zl(3.1338561*m-1.6168667*h-.4906146*y),Zl(-.9787684*m+1.9161415*h+.033454*y),Zl(.0719453*m-.2289914*h+1.4052427*y),s]}function Zl(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function No(i){return i>li?i*i*i:Ac*(i-Tc)}const kh=Object.hasOwn||function(i,t){return Object.prototype.hasOwnProperty.call(i,t)};function hs(i,t){return kh(i,t)?i[t]:void 0}function Ya(i){return parseInt(i.padEnd(2,i),16)/255}function Aa(i,t){return dn(t?i/100:i,0,1)}function dn(i,t,r){return Math.min(Math.max(t,i),r)}function Uo(i){return!i.some(Number.isNaN)}const Ka={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function mo(i,t,r){return i+r*(t-i)}function ds(i,t,r){return i.map(((s,h)=>mo(s,t[h],r)))}class cn{constructor(t,r,s,h=1,m=!0){this.r=t,this.g=r,this.b=s,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,r,s,h]))}static parse(t){if(t instanceof cn)return t;if(typeof t!="string")return;const r=(function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=hs(Ka,s);if(h){const[y,v,b]=h;return[y/255,v/255,b/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const y=s.length<6?1:2;let v=1;return[Ya(s.slice(v,v+=y)),Ya(s.slice(v,v+=y)),Ya(s.slice(v,v+=y)),Ya(s.slice(v,v+y)||"ff")]}if(s.startsWith("rgb")){const y=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,b,P,A,D,L,F,N,Z,X,ne,be]=y,le=[A||" ",F||" ",X].join("");if(le==="  "||le==="  /"||le===",,"||le===",,,"){const fe=[P,L,Z].join(""),Re=fe==="%%%"?100:fe===""?255:0;if(Re){const Be=[dn(+b/Re,0,1),dn(+D/Re,0,1),dn(+N/Re,0,1),ne?Aa(+ne,be):1];if(Uo(Be))return Be}}return}}const m=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,v,b,P,A,D,L,F,N]=m,Z=[b||" ",A||" ",L].join("");if(Z==="  "||Z==="  /"||Z===",,"||Z===",,,"){const X=[+v,dn(+P,0,100),dn(+D,0,100),F?Aa(+F,N):1];if(Uo(X))return(function([ne,be,le,fe]){function Re(Be){const Ke=(Be+ne/30)%12,dt=be*Math.min(le,1-le);return le-dt*Math.max(-1,Math.min(Ke-3,9-Ke,1))}return ne=el(ne),be/=100,le/=100,[Re(0),Re(8),Re(4),fe]})(X)}}})(t);return r?new cn(...r,!1):void 0}get rgb(){const{r:t,g:r,b:s,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,r/m,s/m,h])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[r,s,h,m]=tl(t),y=Math.sqrt(s*s+h*h);return[Math.round(1e4*y)?el(Math.atan2(h,s)*Lh):NaN,y,r,m]})(this.rgb))}get lab(){return this.overwriteGetter("lab",tl(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,s,h]=this.rgb;return`rgba(${[t,r,s].map((m=>Math.round(255*m))).join(",")},${h})`}static interpolate(t,r,s,h="rgb"){switch(h){case"rgb":{const[m,y,v,b]=ds(t.rgb,r.rgb,s);return new cn(m,y,v,b,!1)}case"hcl":{const[m,y,v,b]=t.hcl,[P,A,D,L]=r.hcl;let F,N;if(isNaN(m)||isNaN(P))isNaN(m)?isNaN(P)?F=NaN:(F=P,v!==1&&v!==0||(N=A)):(F=m,D!==1&&D!==0||(N=y));else{let le=P-m;P>m&&le>180?le-=360:P<m&&m-P>180&&(le+=360),F=m+s*le}const[Z,X,ne,be]=(function([le,fe,Re,Be]){return le=isNaN(le)?0:le*Ou,cs([Re,Math.cos(le)*fe,Math.sin(le)*fe,Be])})([F,N??mo(y,A,s),mo(v,D,s),mo(b,L,s)]);return new cn(Z,X,ne,be,!1)}case"lab":{const[m,y,v,b]=cs(ds(t.lab,r.lab,s));return new cn(m,y,v,b,!1)}}}}cn.black=new cn(0,0,0,1),cn.white=new cn(1,1,1,1),cn.transparent=new cn(0,0,0,0),cn.red=new cn(1,0,0,1);class go{constructor(t,r,s){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const nl=["bottom","center","top"];class yo{constructor(t,r,s,h,m,y){this.text=t,this.image=r,this.scale=s,this.fontStack=h,this.textColor=m,this.verticalAlign=y}}class Nr{constructor(t){this.sections=t}static fromString(t){return new Nr([new yo(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof Nr?t:Nr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class Gr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Gr)return t;if(typeof t=="number")return new Gr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Gr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){return new Gr(ds(t.values,r.values,s))}}class ui{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ui)return t;if(typeof t=="number")return new ui([t]);if(Array.isArray(t)){for(const r of t)if(typeof r!="number")return;return new ui(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){return new ui(ds(t.values,r.values,s))}}class Mr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Mr)return t;if(typeof t=="string"){const s=cn.parse(t);return s?new Mr([s]):void 0}if(!Array.isArray(t))return;const r=[];for(const s of t){if(typeof s!="string")return;const h=cn.parse(s);if(!h)return;r.push(h)}return new Mr(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s,h="rgb"){const m=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)m.push(cn.interpolate(t.values[y],r.values[y],s,h));return new Mr(m)}}class Rn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Qa=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ci{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ci)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const s=t[r],h=t[r+1];if(typeof s!="string"||!Qa.has(s)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new ci(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){const h=t.values,m=r.values;if(h.length!==m.length)throw new Rn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const y=[];for(let v=0;v<h.length;v+=2){if(h[v]!==m[v])throw new Rn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${m[v]}`);y.push(h[v]);const[b,P]=h[v+1],[A,D]=m[v+1];y.push([mo(b,A,s),mo(P,D,s)])}return new ci(y)}}class hi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new hi({name:t,available:!1}):null}}class vr{constructor(t,r,s){this.from=t,this.to=r,this.transition=s}static interpolate(t,r,s){return new vr(t,r,s)}static parse(t){return t instanceof vr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new vr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new vr(t.from,t.to,t.transition):typeof t=="string"?new vr(t,t,1):void 0}}function Gn(i,t,r,s){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[i,t,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[i,t,r,s]:[i,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ja(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof vr||i instanceof cn||i instanceof go||i instanceof Nr||i instanceof Gr||i instanceof ui||i instanceof Mr||i instanceof ci||i instanceof hi)return!0;if(Array.isArray(i)){for(const t of i)if(!Ja(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!Ja(i[t]))return!1;return!0}return!1}function Ft(i){if(i===null)return qa;if(typeof i=="string")return rn;if(typeof i=="boolean")return Qt;if(typeof i=="number")return pt;if(i instanceof cn)return Er;if(i instanceof vr)return ya;if(i instanceof go)return Vl;if(i instanceof Nr)return Hi;if(i instanceof Gr)return po;if(i instanceof ui)return ls;if(i instanceof Mr)return Ha;if(i instanceof ci)return Lu;if(i instanceof hi)return _r;if(Array.isArray(i)){const t=i.length;let r;for(const s of i){const h=Ft(s);if(r){if(r===h)continue;r=an;break}r=h}return si(r||an,t)}return ur}function Xt(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof cn||i instanceof vr||i instanceof Nr||i instanceof Gr||i instanceof ui||i instanceof Mr||i instanceof ci||i instanceof hi?i.toString():JSON.stringify(i)}class _a{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ja(t[1]))return r.error("invalid value");const s=t[1];let h=Ft(s);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new _a(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const _n={string:rn,number:pt,boolean:Qt,object:ur};class rr{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s,h=1;const m=t[0];if(m==="array"){let v,b;if(t.length>2){const P=t[1];if(typeof P!="string"||!(P in _n)||P==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=_n[P],h++}else v=an;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);b=t[2],h++}s=si(v,b)}else{if(!_n[m])throw new Error(`Types doesn't contain name = ${m}`);s=_n[m]}const y=[];for(;h<t.length;h++){const v=r.parse(t[h],h,an);if(!v)return null;y.push(v)}return new rr(s,y)}evaluate(t){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(t);if(!us(this.type,Ft(s)))return s;if(r===this.args.length-1)throw new Rn(`Expected value to be of type ${In(this.type)}, but found ${In(Ft(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const _i={"to-boolean":Qt,"to-color":Er,"to-number":pt,"to-string":rn};class ia{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[0];if(!_i[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return r.error("Expected one argument.");const h=_i[s],m=[];for(let y=1;y<t.length;y++){const v=r.parse(t[y],y,an);if(!v)return null;m.push(v)}return new ia(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,s;for(const h of this.args){if(r=h.evaluate(t),s=null,r instanceof cn)return r;if(typeof r=="string"){const m=t.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Gn(r[0],r[1],r[2],r[3]),!s))return new cn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Rn(s||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const s of this.args){r=s.evaluate(t);const h=Gr.parse(r);if(h)return h}throw new Rn(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(const s of this.args){r=s.evaluate(t);const h=ui.parse(r);if(h)return h}throw new Rn(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(const s of this.args){r=s.evaluate(t);const h=Mr.parse(r);if(h)return h}throw new Rn(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const s of this.args){r=s.evaluate(t);const h=ci.parse(r);if(h)return h}throw new Rn(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const s of this.args){if(r=s.evaluate(t),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new Rn(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Nr.fromString(Xt(this.args[0].evaluate(t)));case"resolvedImage":return hi.fromString(Xt(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Xt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const jo=["Unknown","Point","LineString","Polygon"];class Ec{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?jo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=cn.parse(t),this._parseColorCache.set(t,r)),r}}class Vo{constructor(t,r,s=[],h,m=new fo,y=[]){this.registry=t,this.path=s,this.key=s.map((v=>`[${v}]`)).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=r}parse(t,r,s,h,m={}){return r?this.concat(r,s,h)._parse(t,m):this._parse(t,m)}_parse(t,r){function s(h,m,y){return y==="assert"?new rr(m,[h]):y==="coerce"?new ia(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(t,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,b=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(b.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(b.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(b.kind)||v.kind==="colorArray"&&["value","string","array"].includes(b.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(b.kind))y=s(y,v,r.typeAnnotation||"coerce");else if(this.checkSubtype(v,b))return null}else y=s(y,v,r.typeAnnotation||"assert")}if(!(y instanceof _a)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new Ec;try{y=new _a(y.type,y.evaluate(v))}catch(b){return this.error(b.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,s){const h=typeof t=="number"?this.path.concat(t):this.path,m=s?this.scope.concat(s):this.scope;return new Vo(this.registry,this._isConstant,h,r||null,m,this.errors)}error(t,...r){const s=`${this.key}${r.map((h=>`[${h}]`)).join("")}`;this.errors.push(new yr(s,t))}checkSubtype(t,r){const s=us(t,r);return s&&this.error(s),s}}class fs{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let m=1;m<t.length-1;m+=2){const y=t[m];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=r.parse(t[m+1],m+1);if(!v)return null;s.push([y,v])}const h=r.parse(t[t.length-1],t.length-1,r.expectedType,s);return h?new fs(s,h):null}outputDefined(){return this.result.outputDefined()}}class Go{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const s=t[1];return r.scope.has(s)?new Go(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ps{constructor(t,r,s){this.type=t,this.index=r,this.input=s}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,pt),h=r.parse(t[2],2,si(r.expectedType||an));return s&&h?new ps(h.type.itemType,s,h):null}evaluate(t){const r=this.index.evaluate(t),s=this.input.evaluate(t);if(r<0)throw new Rn(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new Rn(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new Rn(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class ql{constructor(t,r){this.type=Qt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,an);return s&&h?ku(s.type,[Qt,rn,pt,qa,an])?new ql(s,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${In(s.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!ra(r,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${In(Ft(r))} instead.`);if(!ra(s,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${In(Ft(s))} instead.`);return s.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ea{constructor(t,r,s){this.type=pt,this.needle=t,this.haystack=r,this.fromIndex=s}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,an);if(!s||!h)return null;if(!ku(s.type,[Qt,rn,pt,qa,an]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${In(s.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,pt);return m?new Ea(s,h,m):null}return new Ea(s,h)}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ra(r,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${In(Ft(r))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),ra(s,["string"])){const m=s.indexOf(r,h);return m===-1?-1:[...s.slice(0,m)].length}if(ra(s,["array"]))return s.indexOf(r,h);throw new Rn(`Expected second argument to be of type array or string, but found ${In(Ft(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Qr{constructor(t,r,s,h,m,y){this.inputType=t,this.type=r,this.input=s,this.cases=h,this.outputs=m,this.otherwise=y}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let s,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},y=[];for(let P=2;P<t.length-1;P+=2){let A=t[P];const D=t[P+1];Array.isArray(A)||(A=[A]);const L=r.concat(P);if(A.length===0)return L.error("Expected at least one branch label.");for(const N of A){if(typeof N!="number"&&typeof N!="string")return L.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return L.error("Numeric branch labels must be integer values.");if(s){if(L.checkSubtype(s,Ft(N)))return null}else s=Ft(N);if(m[String(N)]!==void 0)return L.error("Branch labels must be unique.");m[String(N)]=y.length}const F=r.parse(D,P,h);if(!F)return null;h=h||F.type,y.push(F)}const v=r.parse(t[1],1,an);if(!v)return null;const b=r.parse(t[t.length-1],t.length-1,h);return b?v.type.kind!=="value"&&r.concat(1).checkSubtype(s,v.type)?null:new Qr(s,h,v,m,y,b):null}evaluate(t){const r=this.input.evaluate(t);return(Ft(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class rl{constructor(t,r,s){this.type=t,this.branches=r,this.otherwise=s}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const v=r.parse(t[y],y,Qt);if(!v)return null;const b=r.parse(t[y+1],y+1,s);if(!b)return null;h.push([v,b]),s=s||b.type}const m=r.parse(t[t.length-1],t.length-1,s);if(!m)return null;if(!s)throw new Error("Can't infer output type");return new rl(s,h,m)}evaluate(t){for(const[r,s]of this.branches)if(r.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,s]of this.branches)t(r),t(s);t(this.otherwise)}outputDefined(){return this.branches.every((([t,r])=>r.outputDefined()))&&this.otherwise.outputDefined()}}class ms{constructor(t,r,s,h){this.type=t,this.input=r,this.beginIndex=s,this.endIndex=h}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,pt);if(!s||!h)return null;if(!ku(s.type,[si(an),rn,an]))return r.error(`Expected first argument to be of type array or string, but found ${In(s.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,pt);return m?new ms(s.type,s,h,m):null}return new ms(s.type,s,h)}evaluate(t){const r=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),ra(r,["string"]))return[...r].slice(s,h).join("");if(ra(r,["array"]))return r.slice(s,h);throw new Rn(`Expected first argument to be of type array or string, but found ${In(Ft(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function gs(i,t){const r=i.length-1;let s,h,m=0,y=r,v=0;for(;m<=y;)if(v=Math.floor((m+y)/2),s=i[v],h=i[v+1],s<=t){if(v===r||t<h)return v;m=v+1}else{if(!(s>t))throw new Rn("Input is not a number.");y=v-1}return 0}class wr{constructor(t,r,s){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of s)this.labels.push(h),this.outputs.push(m)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(t[1],1,pt);if(!s)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let y=1;y<t.length;y+=2){const v=y===1?-1/0:t[y],b=t[y+1],P=y,A=y+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const D=r.parse(b,A,m);if(!D)return null;m=m||D.type,h.push([v,D])}return new wr(m,s,h)}evaluate(t){const r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return s[0].evaluate(t);const m=r.length;return h>=r[m-1]?s[m-1].evaluate(t):s[gs(r,h)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Oh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Hl,Mc,Bh=(function(){if(Mc)return Hl;function i(t,r,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=s,this.p2y=h}return Mc=1,Hl=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var v=0,b=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<r));h++)t>m?v=s:b=s,s=.5*(b-v)+v;return s},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Hl})(),il=Oh(Bh);class di{constructor(t,r,s,h,m){this.type=t,this.operator=r,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of m)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(t,r,s,h){let m=0;if(t.name==="exponential")m=$l(r,t.base,s,h);else if(t.name==="linear")m=$l(r,1,s,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;m=new il(y[0],y[1],y[2],y[3]).solve($l(r,1,s,h))}return m}static parse(t,r){let[s,h,m,...y]=t;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const P=h[1];if(typeof P!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:P}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const P=h.slice(1);if(P.length!==4||P.some((A=>typeof A!="number"||A<0||A>1)))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:P}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,pt),!m)return null;const v=[];let b=null;s!=="interpolate-hcl"&&s!=="interpolate-lab"||r.expectedType==Ha?r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType):b=Er;for(let P=0;P<y.length;P+=2){const A=y[P],D=y[P+1],L=P+3,F=P+4;if(typeof A!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=A)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const N=r.parse(D,F,b);if(!N)return null;b=b||N.type,v.push([A,N])}return Xa(b,pt)||Xa(b,ya)||Xa(b,Er)||Xa(b,po)||Xa(b,ls)||Xa(b,Ha)||Xa(b,Lu)||Xa(b,si(pt))?new di(b,s,h,m,v):r.error(`Type ${In(b)} is not interpolatable.`)}evaluate(t){const r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return s[0].evaluate(t);const m=r.length;if(h>=r[m-1])return s[m-1].evaluate(t);const y=gs(r,h),v=di.interpolationFactor(this.interpolation,h,r[y],r[y+1]),b=s[y].evaluate(t),P=s[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return mo(b,P,v);case"color":return cn.interpolate(b,P,v);case"padding":return Gr.interpolate(b,P,v);case"colorArray":return Mr.interpolate(b,P,v);case"numberArray":return ui.interpolate(b,P,v);case"variableAnchorOffsetCollection":return ci.interpolate(b,P,v);case"array":return ds(b,P,v);case"projectionDefinition":return vr.interpolate(b,P,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return cn.interpolate(b,P,v,"hcl");case"colorArray":return Mr.interpolate(b,P,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return cn.interpolate(b,P,v,"lab");case"colorArray":return Mr.interpolate(b,P,v,"lab")}}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function $l(i,t,r,s){const h=s-r,m=i-r;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const eo={color:cn.interpolate,number:mo,padding:Gr.interpolate,numberArray:ui.interpolate,colorArray:Mr.interpolate,variableAnchorOffsetCollection:ci.interpolate,array:ds};class ys{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s=null;const h=r.expectedType;h&&h.kind!=="value"&&(s=h);const m=[];for(const v of t.slice(1)){const b=r.parse(v,1+m.length,s,void 0,{typeAnnotation:"omit"});if(!b)return null;s=s||b.type,m.push(b)}if(!s)throw new Error("No output type");const y=h&&m.some((v=>us(h,v.type)));return new ys(y?an:s,m)}evaluate(t){let r,s=null,h=0;for(const m of this.args)if(h++,s=m.evaluate(t),s&&s instanceof hi&&!s.available&&(r||(r=s.name),s=null,h===this.args.length&&(s=r)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function Xl(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Yl(i,t,r,s){return s.compare(t,r)===0}function vi(i,t,r){const s=i!=="=="&&i!=="!=";return class Fg{constructor(m,y,v){this.type=Qt,this.lhs=m,this.rhs=y,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const v=m[0];let b=y.parse(m[1],1,an);if(!b)return null;if(!Xl(v,b.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${In(b.type)}'.`);let P=y.parse(m[2],2,an);if(!P)return null;if(!Xl(v,P.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${In(P.type)}'.`);if(b.type.kind!==P.type.kind&&b.type.kind!=="value"&&P.type.kind!=="value")return y.error(`Cannot compare types '${In(b.type)}' and '${In(P.type)}'.`);s&&(b.type.kind==="value"&&P.type.kind!=="value"?b=new rr(P.type,[b]):b.type.kind!=="value"&&P.type.kind==="value"&&(P=new rr(b.type,[P])));let A=null;if(m.length===4){if(b.type.kind!=="string"&&P.type.kind!=="string"&&b.type.kind!=="value"&&P.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(A=y.parse(m[3],3,Vl),!A)return null}return new Fg(b,P,A)}evaluate(m){const y=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(s&&this.hasUntypedArgument){const b=Ft(y),P=Ft(v);if(b.kind!==P.kind||b.kind!=="string"&&b.kind!=="number")throw new Rn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${P.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const b=Ft(y),P=Ft(v);if(b.kind!=="string"||P.kind!=="string")return t(m,y,v)}return this.collator?r(m,y,v,this.collator.evaluate(m)):t(m,y,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Rc=vi("==",(function(i,t,r){return t===r}),Yl),Bu=vi("!=",(function(i,t,r){return t!==r}),(function(i,t,r,s){return!Yl(0,t,r,s)})),Sd=vi("<",(function(i,t,r){return t<r}),(function(i,t,r,s){return s.compare(t,r)<0})),Dc=vi(">",(function(i,t,r){return t>r}),(function(i,t,r,s){return s.compare(t,r)>0})),Pd=vi("<=",(function(i,t,r){return t<=r}),(function(i,t,r,s){return s.compare(t,r)<=0})),Cd=vi(">=",(function(i,t,r){return t>=r}),(function(i,t,r,s){return s.compare(t,r)>=0}));class Fu{constructor(t,r,s){this.type=Vl,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return r.error("Collator options argument must be an object.");const h=r.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Qt);if(!h)return null;const m=r.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Qt);if(!m)return null;let y=null;return s.locale&&(y=r.parse(s.locale,1,rn),!y)?null:new Fu(h,m,y)}evaluate(t){return new go(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class zc{constructor(t,r,s,h,m){this.type=rn,this.number=t,this.locale=r,this.currency=s,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const s=r.parse(t[1],1,pt);if(!s)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,rn),!m))return null;let y=null;if(h.currency&&(y=r.parse(h.currency,1,rn),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,pt),!v))return null;let b=null;return h["max-fraction-digits"]&&(b=r.parse(h["max-fraction-digits"],1,pt),!b)?null:new zc(s,m,y,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class _s{constructor(t){this.type=Hi,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=t.length-1;++y){const v=t[y];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let b=null;if(v["font-scale"]&&(b=r.parse(v["font-scale"],1,pt),!b))return null;let P=null;if(v["text-font"]&&(P=r.parse(v["text-font"],1,si(rn)),!P))return null;let A=null;if(v["text-color"]&&(A=r.parse(v["text-color"],1,Er),!A))return null;let D=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!nl.includes(v["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(D=r.parse(v["vertical-align"],1,rn),!D)return null}const L=h[h.length-1];L.scale=b,L.font=P,L.textColor=A,L.verticalAlign=D}else{const b=r.parse(t[y],1,an);if(!b)return null;const P=b.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:b,scale:null,font:null,textColor:null,verticalAlign:null})}}return new _s(h)}evaluate(t){return new Nr(this.sections.map((r=>{const s=r.content.evaluate(t);return Ft(s)===_r?new yo("",s,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new yo(Xt(s),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class Ic{constructor(t){this.type=_r,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const s=r.parse(t[1],1,rn);return s?new Ic(s):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),s=hi.fromString(r);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(r)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class al{constructor(t){this.type=pt,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=r.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${In(s.type)} instead.`):new al(s):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Rn(`Expected value to be of type string or array, but found ${In(Ft(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ri=8192;function Td(i,t){const r=(180+i[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*Ri),Math.round(s*h*Ri)]}function Kl(i,t){const r=Math.pow(2,t.z);return[(h=(i[0]/Ri+t.x)/r,360*h-180),(s=(i[1]/Ri+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,h}function ol(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function sl(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Fh(i,t,r){const s=i[0]-t[0],h=i[1]-t[1],m=i[0]-r[0],y=i[1]-r[1];return s*y-m*h==0&&s*m<=0&&h*y<=0}function Ql(i,t,r,s){return(h=[s[0]-r[0],s[1]-r[1]])[0]*(m=[t[0]-i[0],t[1]-i[1]])[1]-h[1]*m[0]!=0&&!(!kc(i,t,r,s)||!kc(r,s,i,t));var h,m}function ll(i,t,r){for(const s of r)for(let h=0;h<s.length-1;++h)if(Ql(i,t,s[h],s[h+1]))return!0;return!1}function vs(i,t,r=!1){let s=!1;for(const v of t)for(let b=0;b<v.length-1;b++){if(Fh(i,v[b],v[b+1]))return r;(m=v[b])[1]>(h=i)[1]!=(y=v[b+1])[1]>h[1]&&h[0]<(y[0]-m[0])*(h[1]-m[1])/(y[1]-m[1])+m[0]&&(s=!s)}var h,m,y;return s}function Nh(i,t){for(const r of t)if(vs(i,r))return!0;return!1}function Lc(i,t){for(const r of i)if(!vs(r,t))return!1;for(let r=0;r<i.length-1;++r)if(ll(i[r],i[r+1],t))return!1;return!0}function Uh(i,t){for(const r of t)if(Lc(i,r))return!0;return!1}function kc(i,t,r,s){const h=s[0]-r[0],m=s[1]-r[1],y=(i[0]-r[0])*m-h*(i[1]-r[1]),v=(t[0]-r[0])*m-h*(t[1]-r[1]);return y>0&&v<0||y<0&&v>0}function xs(i,t,r){const s=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const v=Td(i[h][y],r);ol(t,v),m.push(v)}s.push(m)}return s}function ul(i,t,r){const s=[];for(let h=0;h<i.length;h++){const m=xs(i[h],t,r);s.push(m)}return s}function Nu(i,t,r,s){if(i[0]<r[0]||i[0]>r[2]){const h=.5*s;let m=i[0]-r[0]>h?-s:r[0]-i[0]>h?s:0;m===0&&(m=i[0]-r[2]>h?-s:r[2]-i[0]>h?s:0),i[0]+=m}ol(t,i)}function Jl(i,t,r,s){const h=Math.pow(2,s.z)*Ri,m=[s.x*Ri,s.y*Ri],y=[];for(const v of i)for(const b of v){const P=[b.x+m[0],b.y+m[1]];Nu(P,t,r,h),y.push(P)}return y}function Oc(i,t,r,s){const h=Math.pow(2,s.z)*Ri,m=[s.x*Ri,s.y*Ri],y=[];for(const b of i){const P=[];for(const A of b){const D=[A.x+m[0],A.y+m[1]];ol(t,D),P.push(D)}y.push(P)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of y)for(const P of b)Nu(P,t,r,h)}var v;return y}class Wo{constructor(t,r){this.type=Qt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ja(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const h=[];for(const m of s.features){const{type:y,coordinates:v}=m.geometry;y==="Polygon"&&h.push(v),y==="MultiPolygon"&&h.push(...v)}if(h.length)return new Wo(s,{type:"MultiPolygon",coordinates:h})}else if(s.type==="Feature"){const h=s.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Wo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Wo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(s.type==="Polygon"){const v=xs(s.coordinates,m,y),b=Jl(r.geometry(),h,m,y);if(!sl(h,m))return!1;for(const P of b)if(!vs(P,v))return!1}if(s.type==="MultiPolygon"){const v=ul(s.coordinates,m,y),b=Jl(r.geometry(),h,m,y);if(!sl(h,m))return!1;for(const P of b)if(!Nh(P,v))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(s.type==="Polygon"){const v=xs(s.coordinates,m,y),b=Oc(r.geometry(),h,m,y);if(!sl(h,m))return!1;for(const P of b)if(!Lc(P,v))return!1}if(s.type==="MultiPolygon"){const v=ul(s.coordinates,m,y),b=Oc(r.geometry(),h,m,y);if(!sl(h,m))return!1;for(const P of b)if(!Uh(P,v))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let eu=class{constructor(i=[],t=(r,s)=>r<s?-1:r>s?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:r}=this,s=t[i];for(;i>0;){const h=i-1>>1,m=t[h];if(r(s,m)>=0)break;t[i]=m,i=h}t[i]=s}_down(i){const{data:t,compare:r}=this,s=this.length>>1,h=t[i];for(;i<s;){let m=1+(i<<1);const y=m+1;if(y<this.length&&r(t[y],t[m])<0&&(m=y),r(t[m],h)>=0)break;t[i]=t[m],i=m}t[i]=h}};function tu(i,t,r=0,s=i.length-1,h=jh){for(;s>r;){if(s-r>600){const b=s-r+1,P=t-r+1,A=Math.log(b),D=.5*Math.exp(2*A/3),L=.5*Math.sqrt(A*D*(b-D)/b)*(P-b/2<0?-1:1);tu(i,t,Math.max(r,Math.floor(t-P*D/b+L)),Math.min(s,Math.floor(t+(b-P)*D/b+L)),h)}const m=i[t];let y=r,v=s;for(cl(i,r,t),h(i[s],m)>0&&cl(i,r,s);y<v;){for(cl(i,y,v),y++,v--;h(i[y],m)<0;)y++;for(;h(i[v],m)>0;)v--}h(i[r],m)===0?cl(i,r,v):(v++,cl(i,v,s)),v<=t&&(r=v+1),t<=v&&(s=v-1)}}function cl(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}function jh(i,t){return i<t?-1:i>t?1:0}function hl(i,t){if(i.length<=1)return[i];const r=[];let s,h;for(const m of i){const y=Ad(m);y!==0&&(m.area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(s&&r.push(s),s=[m]):s.push(m))}if(s&&r.push(s),t>1)for(let m=0;m<r.length;m++)r[m].length<=t||(tu(r[m],t,1,r[m].length-1,Vh),r[m]=r[m].slice(0,t));return r}function Vh(i,t){return t.area-i.area}function Ad(i){let t=0;for(let r,s,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],s=i[y],t+=(s.x-r.x)*(r.y+s.y);return t}const Gh=1/298.257223563,Wh=Gh*(2-Gh),Bc=Math.PI/180;class Di{constructor(t){const r=6378.137*Bc*1e3,s=Math.cos(t*Bc),h=1/(1-Wh*(1-s*s)),m=Math.sqrt(h);this.kx=r*m*s,this.ky=r*m*h*(1-Wh)}distance(t,r){const s=this.wrap(t[0]-r[0])*this.kx,h=(t[1]-r[1])*this.ky;return Math.sqrt(s*s+h*h)}pointOnLine(t,r){let s,h,m,y,v=1/0;for(let b=0;b<t.length-1;b++){let P=t[b][0],A=t[b][1],D=this.wrap(t[b+1][0]-P)*this.kx,L=(t[b+1][1]-A)*this.ky,F=0;D===0&&L===0||(F=(this.wrap(r[0]-P)*this.kx*D+(r[1]-A)*this.ky*L)/(D*D+L*L),F>1?(P=t[b+1][0],A=t[b+1][1]):F>0&&(P+=D/this.kx*F,A+=L/this.ky*F)),D=this.wrap(r[0]-P)*this.kx,L=(r[1]-A)*this.ky;const N=D*D+L*L;N<v&&(v=N,s=P,h=A,m=b,y=F)}return{point:[s,h],index:m,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function dl(i,t){return t[0]-i[0]}function nu(i){return i[1]-i[0]+1}function to(i,t){return i[1]>=i[0]&&i[1]<t}function Sn(i,t){if(i[0]>i[1])return[null,null];const r=nu(i);if(t){if(r===2)return[i,null];const h=Math.floor(r/2);return[[i[0],i[0]+h],[i[0]+h,i[1]]]}if(r===1)return[i,null];const s=Math.floor(r/2)-1;return[[i[0],i[0]+s],[i[0]+s+1,i[1]]]}function Uu(i,t){if(!to(t,i.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)ol(r,i[s]);return r}function ru(i){const t=[1/0,1/0,-1/0,-1/0];for(const r of i)for(const s of r)ol(t,s);return t}function Zh(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function Zo(i,t,r){if(!Zh(i)||!Zh(t))return NaN;let s=0,h=0;return i[2]<t[0]&&(s=t[0]-i[2]),i[0]>t[2]&&(s=i[0]-t[2]),i[1]>t[3]&&(h=i[1]-t[3]),i[3]<t[1]&&(h=t[1]-i[3]),r.distance([0,0],[s,h])}function _o(i,t,r){const s=r.pointOnLine(t,i);return r.distance(i,s.point)}function bs(i,t,r,s,h){const m=Math.min(_o(i,[r,s],h),_o(t,[r,s],h)),y=Math.min(_o(r,[i,t],h),_o(s,[i,t],h));return Math.min(m,y)}function Fc(i,t,r,s,h){if(!to(t,i.length)||!to(s,r.length))return 1/0;let m=1/0;for(let y=t[0];y<t[1];++y){const v=i[y],b=i[y+1];for(let P=s[0];P<s[1];++P){const A=r[P],D=r[P+1];if(Ql(v,b,A,D))return 0;m=Math.min(m,bs(v,b,A,D,h))}}return m}function qh(i,t,r,s,h){if(!to(t,i.length)||!to(s,r.length))return NaN;let m=1/0;for(let y=t[0];y<=t[1];++y)for(let v=s[0];v<=s[1];++v)if(m=Math.min(m,h.distance(i[y],r[v])),m===0)return m;return m}function ws(i,t,r){if(vs(i,t,!0))return 0;let s=1/0;for(const h of t){const m=h[0],y=h[h.length-1];if(m!==y&&(s=Math.min(s,_o(i,[y,m],r)),s===0))return s;const v=r.pointOnLine(h,i);if(s=Math.min(s,r.distance(i,v.point)),s===0)return s}return s}function fl(i,t,r,s){if(!to(t,i.length))return NaN;for(let m=t[0];m<=t[1];++m)if(vs(i[m],r,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const y=i[m],v=i[m+1];for(const b of r)for(let P=0,A=b.length,D=A-1;P<A;D=P++){const L=b[D],F=b[P];if(Ql(y,v,L,F))return 0;h=Math.min(h,bs(y,v,L,F,s))}}return h}function ju(i,t){for(const r of i)for(const s of r)if(vs(s,t,!0))return!0;return!1}function Hh(i,t,r,s=1/0){const h=ru(i),m=ru(t);if(s!==1/0&&Zo(h,m,r)>=s)return s;if(sl(h,m)){if(ju(i,t))return 0}else if(ju(t,i))return 0;let y=1/0;for(const v of i)for(let b=0,P=v.length,A=P-1;b<P;A=b++){const D=v[A],L=v[b];for(const F of t)for(let N=0,Z=F.length,X=Z-1;N<Z;X=N++){const ne=F[X],be=F[N];if(Ql(D,L,ne,be))return 0;y=Math.min(y,bs(D,L,ne,be,r))}}return y}function qo(i,t,r,s,h,m){if(!m)return;const y=Zo(Uu(s,m),h,r);y<t&&i.push([y,m,[0,0]])}function iu(i,t,r,s,h,m,y){if(!m||!y)return;const v=Zo(Uu(s,m),Uu(h,y),r);v<t&&i.push([v,m,y])}function au(i,t,r,s,h=1/0){let m=Math.min(s.distance(i[0],r[0][0]),h);if(m===0)return m;const y=new eu([[0,[0,i.length-1],[0,0]]],dl),v=ru(r);for(;y.length>0;){const b=y.pop();if(b[0]>=m)continue;const P=b[1],A=t?50:100;if(nu(P)<=A){if(!to(P,i.length))return NaN;if(t){const D=fl(i,P,r,s);if(isNaN(D)||D===0)return D;m=Math.min(m,D)}else for(let D=P[0];D<=P[1];++D){const L=ws(i[D],r,s);if(m=Math.min(m,L),m===0)return 0}}else{const D=Sn(P,t);qo(y,m,s,i,v,D[0]),qo(y,m,s,i,v,D[1])}}return m}function ou(i,t,r,s,h,m=1/0){let y=Math.min(m,h.distance(i[0],r[0]));if(y===0)return y;const v=new eu([[0,[0,i.length-1],[0,r.length-1]]],dl);for(;v.length>0;){const b=v.pop();if(b[0]>=y)continue;const P=b[1],A=b[2],D=t?50:100,L=s?50:100;if(nu(P)<=D&&nu(A)<=L){if(!to(P,i.length)&&to(A,r.length))return NaN;let F;if(t&&s)F=Fc(i,P,r,A,h),y=Math.min(y,F);else if(t&&!s){const N=i.slice(P[0],P[1]+1);for(let Z=A[0];Z<=A[1];++Z)if(F=_o(r[Z],N,h),y=Math.min(y,F),y===0)return y}else if(!t&&s){const N=r.slice(A[0],A[1]+1);for(let Z=P[0];Z<=P[1];++Z)if(F=_o(i[Z],N,h),y=Math.min(y,F),y===0)return y}else F=qh(i,P,r,A,h),y=Math.min(y,F)}else{const F=Sn(P,t),N=Sn(A,s);iu(v,y,h,i,r,F[0],N[0]),iu(v,y,h,i,r,F[0],N[1]),iu(v,y,h,i,r,F[1],N[0]),iu(v,y,h,i,r,F[1],N[1])}}return y}function Nc(i){return i.type==="MultiPolygon"?i.coordinates.map((t=>({type:"Polygon",coordinates:t}))):i.type==="MultiLineString"?i.coordinates.map((t=>({type:"LineString",coordinates:t}))):i.type==="MultiPoint"?i.coordinates.map((t=>({type:"Point",coordinates:t}))):[i]}class Ss{constructor(t,r){this.type=pt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ja(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Ss(s,s.features.map((h=>Nc(h.geometry))).flat());if(s.type==="Feature")return new Ss(s,Nc(s.geometry));if("type"in s&&"coordinates"in s)return new Ss(s,Nc(s))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,s){const h=r.geometry(),m=h.flat().map((b=>Kl([b.x,b.y],r.canonical)));if(h.length===0)return NaN;const y=new Di(m[0][1]);let v=1/0;for(const b of s){switch(b.type){case"Point":v=Math.min(v,ou(m,!1,[b.coordinates],!1,y,v));break;case"LineString":v=Math.min(v,ou(m,!1,b.coordinates,!0,y,v));break;case"Polygon":v=Math.min(v,au(m,!1,b.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,s){const h=r.geometry(),m=h.flat().map((b=>Kl([b.x,b.y],r.canonical)));if(h.length===0)return NaN;const y=new Di(m[0][1]);let v=1/0;for(const b of s){switch(b.type){case"Point":v=Math.min(v,ou(m,!0,[b.coordinates],!1,y,v));break;case"LineString":v=Math.min(v,ou(m,!0,b.coordinates,!0,y,v));break;case"Polygon":v=Math.min(v,au(m,!0,b.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(r,s){const h=r.geometry();if(h.length===0||h[0].length===0)return NaN;const m=hl(h,0).map((b=>b.map((P=>P.map((A=>Kl([A.x,A.y],r.canonical))))))),y=new Di(m[0][0][0][1]);let v=1/0;for(const b of s)for(const P of m){switch(b.type){case"Point":v=Math.min(v,au([b.coordinates],!1,P,y,v));break;case"LineString":v=Math.min(v,au(b.coordinates,!0,P,y,v));break;case"Polygon":v=Math.min(v,Hh(P,b.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class su{constructor(t){this.type=an,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=t[1];return s==null?r.error("Global state property must be defined."):typeof s!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new su(s)}evaluate(t){var r;const s=(r=t.globals)===null||r===void 0?void 0:r.globalState;return s&&Object.keys(s).length!==0?hs(s,this.key):null}eachChild(){}outputDefined(){return!1}}const Ps={"==":Rc,"!=":Bu,">":Dc,"<":Sd,">=":Cd,"<=":Pd,array:rr,at:ps,boolean:rr,case:rl,coalesce:ys,collator:Fu,format:_s,image:Ic,in:ql,"index-of":Ea,interpolate:di,"interpolate-hcl":di,"interpolate-lab":di,length:al,let:fs,literal:_a,match:Qr,number:rr,"number-format":zc,object:rr,slice:ms,step:wr,string:rr,"to-boolean":ia,"to-color":ia,"to-number":ia,"to-string":ia,var:Go,within:Wo,distance:Ss,"global-state":su};class aa{constructor(t,r,s,h){this.name=t,this.type=r,this._evaluate=s,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const s=t[0],h=aa.definitions[s];if(!h)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter((([P])=>!Array.isArray(P)||P.length===t.length-1));let b=null;for(const[P,A]of v){b=new Vo(r.registry,zi,r.path,null,r.scope);const D=[];let L=!1;for(let F=1;F<t.length;F++){const N=t[F],Z=Array.isArray(P)?P[F-1]:P.type,X=b.parse(N,1+D.length,Z);if(!X){L=!0;break}D.push(X)}if(!L)if(Array.isArray(P)&&P.length!==D.length)b.error(`Expected ${P.length} arguments, but found ${D.length} instead.`);else{for(let F=0;F<D.length;F++){const N=Array.isArray(P)?P[F]:P.type,Z=D[F];b.concat(F+1).checkSubtype(N,Z.type)}if(b.errors.length===0)return new aa(s,m,A,D)}}if(v.length===1)r.errors.push(...b.errors);else{const P=(v.length?v:y).map((([D])=>{return L=D,Array.isArray(L)?`(${L.map(In).join(", ")})`:`(${In(L.type)}...)`;var L})).join(" | "),A=[];for(let D=1;D<t.length;D++){const L=r.parse(t[D],1+A.length);if(!L)return null;A.push(In(L.type))}r.error(`Expected arguments of type ${P}, but found (${A.join(", ")}) instead.`)}return null}static register(t,r){aa.definitions=r;for(const s in r)t[s]=aa}}function Vu(i,[t,r,s,h]){t=t.evaluate(i),r=r.evaluate(i),s=s.evaluate(i);const m=h?h.evaluate(i):1,y=Gn(t,r,s,m);if(y)throw new Rn(y);return new cn(t/255,r/255,s/255,m,!1)}function va(i,t){return i in t}function Gu(i,t){const r=t[i];return r===void 0?null:r}function Jr(i){return{type:i}}function zi(i){if(i instanceof Go)return zi(i.boundExpression);if(i instanceof aa&&i.name==="error"||i instanceof Fu||i instanceof Wo||i instanceof Ss||i instanceof su)return!1;const t=i instanceof ia||i instanceof rr;let r=!0;return i.eachChild((s=>{r=t?r&&zi(s):r&&s instanceof _a})),!!r&&vo(i)&&Ts(i,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function vo(i){if(i instanceof aa&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Wo||i instanceof Ss)return!1;let t=!0;return i.eachChild((r=>{t&&!vo(r)&&(t=!1)})),t}function Cs(i){if(i instanceof aa&&i.name==="feature-state")return!1;let t=!0;return i.eachChild((r=>{t&&!Cs(r)&&(t=!1)})),t}function Ts(i,t){if(i instanceof aa&&t.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild((s=>{r&&!Ts(s,t)&&(r=!1)})),r}function lu(i){return{result:"success",value:i}}function Ho(i){return{result:"error",value:i}}function oa(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Uc(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function pl(i){return!!i.expression&&i.expression.interpolated}function sn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function uu(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&Ft(i)===ur}function sa(i){return i}function Wu(i,t){const r=i.stops&&typeof i.stops[0][0]=="object",s=r||!(r||i.property!==void 0),h=i.type||(pl(t)?"exponential":"interval"),m=(function(A){switch(A.type){case"color":return cn.parse;case"padding":return Gr.parse;case"numberArray":return ui.parse;case"colorArray":return Mr.parse;default:return null}})(t);if(m&&((i=yi({},i)).stops&&(i.stops=i.stops.map((A=>[A[0],m(A[1])]))),i.default=m(i.default?i.default:t.default)),i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;const v=(function(A){switch(A){case"exponential":return $o;case"interval":return Zu;case"categorical":return jc;case"identity":return Vc;default:throw new Error(`Unknown function type "${A}"`)}})(h);let b,P;if(h==="categorical"){b=Object.create(null);for(const A of i.stops)b[A[0]]=A[1];P=typeof i.stops[0][0]}if(r){const A={},D=[];for(let N=0;N<i.stops.length;N++){const Z=i.stops[N],X=Z[0].zoom;A[X]===void 0&&(A[X]={zoom:X,type:i.type,property:i.property,default:i.default,stops:[]},D.push(X)),A[X].stops.push([Z[0].value,Z[1]])}const L=[];for(const N of D)L.push([A[N].zoom,Wu(A[N],t)]);const F={name:"linear"};return{kind:"composite",interpolationType:F,interpolationFactor:di.interpolationFactor.bind(void 0,F),zoomStops:L.map((N=>N[0])),evaluate:({zoom:N},Z)=>$o({stops:L,base:i.base},t,N).evaluate(N,Z)}}if(s){const A=h==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:di.interpolationFactor.bind(void 0,A),zoomStops:i.stops.map((D=>D[0])),evaluate:({zoom:D})=>v(i,t,D,b,P)}}return{kind:"source",evaluate(A,D){const L=D&&D.properties?D.properties[i.property]:void 0;return L===void 0?xi(i.default,t.default):v(i,t,L,b,P)}}}function xi(i,t,r){return i!==void 0?i:t!==void 0?t:r!==void 0?r:void 0}function jc(i,t,r,s,h){return xi(typeof r===h?s[r]:void 0,i.default,t.default)}function Zu(i,t,r){if(sn(r)!=="number")return xi(i.default,t.default);const s=i.stops.length;if(s===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[s-1][0])return i.stops[s-1][1];const h=gs(i.stops.map((m=>m[0])),r);return i.stops[h][1]}function $o(i,t,r){const s=i.base!==void 0?i.base:1;if(sn(r)!=="number")return xi(i.default,t.default);const h=i.stops.length;if(h===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[h-1][0])return i.stops[h-1][1];const m=gs(i.stops.map((A=>A[0])),r),y=(function(A,D,L,F){const N=F-L,Z=A-L;return N===0?0:D===1?Z/N:(Math.pow(D,Z)-1)/(Math.pow(D,N)-1)})(r,s,i.stops[m][0],i.stops[m+1][0]),v=i.stops[m][1],b=i.stops[m+1][1],P=eo[t.type]||sa;return typeof v.evaluate=="function"?{evaluate(...A){const D=v.evaluate.apply(void 0,A),L=b.evaluate.apply(void 0,A);if(D!==void 0&&L!==void 0)return P(D,L,y,i.colorSpace)}}:P(v,b,y,i.colorSpace)}function Vc(i,t,r){switch(t.type){case"color":r=cn.parse(r);break;case"formatted":r=Nr.fromString(r.toString());break;case"resolvedImage":r=hi.fromString(r.toString());break;case"padding":r=Gr.parse(r);break;case"colorArray":r=Mr.parse(r);break;case"numberArray":r=ui.parse(r);break;default:sn(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return xi(r,i.default,t.default)}aa.register(Ps,{error:[{kind:"error"},[rn],(i,[t])=>{throw new Rn(t.evaluate(i))}],typeof:[rn,[an],(i,[t])=>In(Ft(t.evaluate(i)))],"to-rgba":[si(pt,4),[Er],(i,[t])=>{const[r,s,h,m]=t.evaluate(i).rgb;return[255*r,255*s,255*h,m]}],rgb:[Er,[pt,pt,pt],Vu],rgba:[Er,[pt,pt,pt,pt],Vu],has:{type:Qt,overloads:[[[rn],(i,[t])=>va(t.evaluate(i),i.properties())],[[rn,ur],(i,[t,r])=>va(t.evaluate(i),r.evaluate(i))]]},get:{type:an,overloads:[[[rn],(i,[t])=>Gu(t.evaluate(i),i.properties())],[[rn,ur],(i,[t,r])=>Gu(t.evaluate(i),r.evaluate(i))]]},"feature-state":[an,[rn],(i,[t])=>Gu(t.evaluate(i),i.featureState||{})],properties:[ur,[],i=>i.properties()],"geometry-type":[rn,[],i=>i.geometryType()],id:[an,[],i=>i.id()],zoom:[pt,[],i=>i.globals.zoom],"heatmap-density":[pt,[],i=>i.globals.heatmapDensity||0],elevation:[pt,[],i=>i.globals.elevation||0],"line-progress":[pt,[],i=>i.globals.lineProgress||0],accumulated:[an,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[pt,Jr(pt),(i,t)=>{let r=0;for(const s of t)r+=s.evaluate(i);return r}],"*":[pt,Jr(pt),(i,t)=>{let r=1;for(const s of t)r*=s.evaluate(i);return r}],"-":{type:pt,overloads:[[[pt,pt],(i,[t,r])=>t.evaluate(i)-r.evaluate(i)],[[pt],(i,[t])=>-t.evaluate(i)]]},"/":[pt,[pt,pt],(i,[t,r])=>t.evaluate(i)/r.evaluate(i)],"%":[pt,[pt,pt],(i,[t,r])=>t.evaluate(i)%r.evaluate(i)],ln2:[pt,[],()=>Math.LN2],pi:[pt,[],()=>Math.PI],e:[pt,[],()=>Math.E],"^":[pt,[pt,pt],(i,[t,r])=>Math.pow(t.evaluate(i),r.evaluate(i))],sqrt:[pt,[pt],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[pt,[pt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[pt,[pt],(i,[t])=>Math.log(t.evaluate(i))],log2:[pt,[pt],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[pt,[pt],(i,[t])=>Math.sin(t.evaluate(i))],cos:[pt,[pt],(i,[t])=>Math.cos(t.evaluate(i))],tan:[pt,[pt],(i,[t])=>Math.tan(t.evaluate(i))],asin:[pt,[pt],(i,[t])=>Math.asin(t.evaluate(i))],acos:[pt,[pt],(i,[t])=>Math.acos(t.evaluate(i))],atan:[pt,[pt],(i,[t])=>Math.atan(t.evaluate(i))],min:[pt,Jr(pt),(i,t)=>Math.min(...t.map((r=>r.evaluate(i))))],max:[pt,Jr(pt),(i,t)=>Math.max(...t.map((r=>r.evaluate(i))))],abs:[pt,[pt],(i,[t])=>Math.abs(t.evaluate(i))],round:[pt,[pt],(i,[t])=>{const r=t.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[pt,[pt],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[pt,[pt],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Qt,[rn,an],(i,[t,r])=>i.properties()[t.value]===r.value],"filter-id-==":[Qt,[an],(i,[t])=>i.id()===t.value],"filter-type-==":[Qt,[rn],(i,[t])=>i.geometryType()===t.value],"filter-<":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s<h}],"filter-id-<":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r<s}],"filter->":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s>h}],"filter-id->":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r>s}],"filter-<=":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r<=s}],"filter->=":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r>=s}],"filter-has":[Qt,[an],(i,[t])=>t.value in i.properties()],"filter-has-id":[Qt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Qt,[si(rn)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Qt,[si(an)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Qt,[rn,si(an)],(i,[t,r])=>r.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Qt,[rn,si(an)],(i,[t,r])=>(function(s,h,m,y){for(;m<=y;){const v=m+y>>1;if(h[v]===s)return!0;h[v]>s?y=v-1:m=v+1}return!1})(i.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Qt,overloads:[[[Qt,Qt],(i,[t,r])=>t.evaluate(i)&&r.evaluate(i)],[Jr(Qt),(i,t)=>{for(const r of t)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Qt,overloads:[[[Qt,Qt],(i,[t,r])=>t.evaluate(i)||r.evaluate(i)],[Jr(Qt),(i,t)=>{for(const r of t)if(r.evaluate(i))return!0;return!1}]]},"!":[Qt,[Qt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Qt,[rn],(i,[t])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(t.evaluate(i))}],upcase:[rn,[rn],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[rn,[rn],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[rn,Jr(an),(i,t)=>t.map((r=>Xt(r.evaluate(i)))).join("")],"resolved-locale":[rn,[Vl],(i,[t])=>t.evaluate(i).resolvedLocale()]});class cu{constructor(t,r,s){this.expression=t,this._warningHistory={},this._evaluator=new Ec,this._defaultValue=r?(function(h){if(h.type==="color"&&uu(h.default))return new cn(0,0,0,0);switch(h.type){case"color":return cn.parse(h.default)||null;case"padding":return Gr.parse(h.default)||null;case"numberArray":return ui.parse(h.default)||null;case"colorArray":return Mr.parse(h.default)||null;case"variableAnchorOffsetCollection":return ci.parse(h.default)||null;case"projectionDefinition":return vr.parse(h.default)||null;default:return h.default===void 0?null:h.default}})(r):null,this._enumValues=r&&r.type==="enum"?r.values:null,this._globalState=s}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Ii(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,r,s,h,m,y){this._globalState&&(t=Ii(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Rn(`Expected value to be one of ${Object.keys(this._enumValues).map((b=>JSON.stringify(b))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function xo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Ps}function no(i,t,r){const s=new Vo(Ps,zi,[],t?(function(m){const y={color:Er,string:rn,number:pt,enum:rn,boolean:Qt,formatted:Hi,padding:po,numberArray:ls,colorArray:Ha,projectionDefinition:ya,resolvedImage:_r,variableAnchorOffsetCollection:Lu};return m.type==="array"?si(y[m.value]||an,m.length):y[m.type]})(t):void 0),h=s.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?lu(new cu(h,t,r)):Ho(s.errors)}class Xo{constructor(t,r,s){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Cs(r.expression),this.globalStateRefs=ua(r.expression),this._globalState=s}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Ii(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,r,s,h,m,y)}evaluate(t,r,s,h,m,y){return this._globalState&&(t=Ii(t,this._globalState)),this._styleExpression.evaluate(t,r,s,h,m,y)}}class ml{constructor(t,r,s,h,m){this.kind=t,this.zoomStops=s,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Cs(r.expression),this.globalStateRefs=ua(r.expression),this.interpolationType=h,this._globalState=m}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Ii(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,r,s,h,m,y)}evaluate(t,r,s,h,m,y){return this._globalState&&(t=Ii(t,this._globalState)),this._styleExpression.evaluate(t,r,s,h,m,y)}interpolationFactor(t,r,s){return this.interpolationType?di.interpolationFactor(this.interpolationType,t,r,s):0}}function la(i,t,r){const s=no(i,t,r);if(s.result==="error")return s;const h=s.value.expression,m=vo(h);if(!m&&!oa(t))return Ho([new yr("","data expressions not supported")]);const y=Ts(h,["zoom"]);if(!y&&!Uc(t))return Ho([new yr("","zoom expressions not supported")]);const v=Ma(h);return v||y?v instanceof yr?Ho([v]):v instanceof di&&!pl(t)?Ho([new yr("",'"interpolate" expressions cannot be used with this property')]):lu(v?new ml(m?"camera":"composite",s.value,v.labels,v instanceof di?v.interpolation:void 0,r):new Xo(m?"constant":"source",s.value,r)):Ho([new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class bi{constructor(t,r){this._parameters=t,this._specification=r,yi(this,Wu(this._parameters,this._specification))}static deserialize(t){return new bi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ma(i){let t=null;if(i instanceof fs)t=Ma(i.result);else if(i instanceof ys){for(const r of i.args)if(t=Ma(r),t)break}else(i instanceof wr||i instanceof di)&&i.input instanceof aa&&i.input.name==="zoom"&&(t=i);return t instanceof yr||i.eachChild((r=>{const s=Ma(r);s instanceof yr?t=s:!t&&s?t=new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new yr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function ua(i,t=new Set){return i instanceof su&&t.add(i.key),i.eachChild((r=>{ua(r,t)})),t}function Ii(i,t){const{zoom:r,heatmapDensity:s,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:v}=i??{};return{zoom:r,heatmapDensity:s,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:v,globalState:t}}function Ra(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Ra(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const qu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bo(i,t){if(i==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Ra(i)||(i=cr(i));const r=no(i,qu,t);if(r.result==="error")throw new Error(r.value.map((s=>`${s.key}: ${s.message}`)).join(", "));return{filter:(s,h,m)=>r.value.evaluate(s,h,{},m),needGeometry:Wr(i),getGlobalStateRefs:()=>ua(r.value.expression)}}function hu(i,t){return i<t?-1:i>t?1:0}function Wr(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Wr(i[t]))return!0;return!1}function cr(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Mn(i[1],i[2],"=="):t==="!="?gl(Mn(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Mn(i[1],i[2],t):t==="any"?(r=i.slice(1),["any"].concat(r.map(cr))):t==="all"?["all"].concat(i.slice(1).map(cr)):t==="none"?["all"].concat(i.slice(1).map(cr).map(gl)):t==="in"?Yo(i[1],i.slice(2)):t==="!in"?gl(Yo(i[1],i.slice(2))):t==="has"?Da(i[1]):t!=="!has"||gl(Da(i[1]));var r}function Mn(i,t,r){switch(i){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,i,t]}}function Yo(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((r=>typeof r!=typeof t[0]))?["filter-in-large",i,["literal",t.sort(hu)]]:["filter-in-small",i,["literal",t]]}}function Da(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function gl(i){return["!",i]}function wo(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const m of i)h+=`${wo(m)},`;return`${h}]`}const r=Object.keys(i).sort();let s="{";for(let h=0;h<r.length;h++)s+=`${JSON.stringify(r[h])}:${wo(i[r[h]])},`;return`${s}}`}function Gc(i){let t="";for(const r of Wt)t+=`/${wo(i[r])}`;return t}function Hu(i){const t=i.value;return t?[new it(i.key,t,"constants have been deprecated as of v8")]:[]}function Bn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function za(i){if(Array.isArray(i))return i.map(za);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const r in i)t[r]=za(i[r]);return t}return Bn(i)}function Xi(i){const t=i.key,r=i.value,s=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec,v=i.validateSpec;let b=[];const P=sn(r);if(P!=="object")return[new it(t,r,`object expected, ${P} found`)];for(const A in r){const D=A.split(".")[0],L=hs(s,D)||s["*"];let F;if(hs(h,D))F=h[D];else if(hs(s,D))F=v;else if(h["*"])F=h["*"];else{if(!s["*"]){b.push(new it(t,r[A],`unknown property "${A}"`));continue}F=v}b=b.concat(F({key:(t&&`${t}.`)+A,value:r[A],valueSpec:L,style:m,styleSpec:y,object:r,objectKey:A,validateSpec:v},r))}for(const A in s)h[A]||s[A].required&&s[A].default===void 0&&r[A]===void 0&&b.push(new it(t,r,`missing required property "${A}"`));return b}function Ko(i){const t=i.value,r=i.valueSpec,s=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||i.validateSpec;if(sn(t)!=="array")return[new it(m,t,`array expected, ${sn(t)} found`)];if(r.length&&t.length!==r.length)return[new it(m,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new it(m,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),sn(r.value)==="object"&&(v=r.value);let b=[];for(let P=0;P<t.length;P++)b=b.concat(y({array:t,arrayIndex:P,value:t[P],valueSpec:v,validateSpec:i.validateSpec,style:s,styleSpec:h,key:`${m}[${P}]`}));return b}function yl(i){const t=i.key,r=i.value,s=i.valueSpec;let h=sn(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new it(t,r,`number expected, ${h} found`)]:"minimum"in s&&r<s.minimum?[new it(t,r,`${r} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&r>s.maximum?[new it(t,r,`${r} is greater than the maximum value ${s.maximum}`)]:[]}function So(i){const t=i.valueSpec,r=Bn(i.value.type);let s,h,m,y={};const v=r!=="categorical"&&i.value.property===void 0,b=!v,P=sn(i.value.stops)==="array"&&sn(i.value.stops[0])==="array"&&sn(i.value.stops[0][0])==="object",A=Xi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(F){if(r==="identity")return[new it(F.key,F.value,'identity function may not have a "stops" property')];let N=[];const Z=F.value;return N=N.concat(Ko({key:F.key,value:Z,valueSpec:F.valueSpec,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:D})),sn(Z)==="array"&&Z.length===0&&N.push(new it(F.key,Z,"array must have at least one stop")),N},default:function(F){return F.validateSpec({key:F.key,value:F.value,valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec})}}});return r==="identity"&&v&&A.push(new it(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||A.push(new it(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!pl(i.valueSpec)&&A.push(new it(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(b&&!oa(i.valueSpec)?A.push(new it(i.key,i.value,"property functions not supported")):v&&!Uc(i.valueSpec)&&A.push(new it(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!P||i.value.property!==void 0||A.push(new it(i.key,i.value,'"property" property is required')),A;function D(F){let N=[];const Z=F.value,X=F.key;if(sn(Z)!=="array")return[new it(X,Z,`array expected, ${sn(Z)} found`)];if(Z.length!==2)return[new it(X,Z,`array length 2 expected, length ${Z.length} found`)];if(P){if(sn(Z[0])!=="object")return[new it(X,Z,`object expected, ${sn(Z[0])} found`)];if(Z[0].zoom===void 0)return[new it(X,Z,"object stop key must have zoom")];if(Z[0].value===void 0)return[new it(X,Z,"object stop key must have value")];if(m&&m>Bn(Z[0].zoom))return[new it(X,Z[0].zoom,"stop zoom values must appear in ascending order")];Bn(Z[0].zoom)!==m&&(m=Bn(Z[0].zoom),h=void 0,y={}),N=N.concat(Xi({key:`${X}[0]`,value:Z[0],valueSpec:{zoom:{}},validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:yl,value:L}}))}else N=N.concat(L({key:`${X}[0]`,value:Z[0],validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec},Z));return xo(za(Z[1]))?N.concat([new it(`${X}[1]`,Z[1],"expressions are not allowed in function stops.")]):N.concat(F.validateSpec({key:`${X}[1]`,value:Z[1],valueSpec:t,validateSpec:F.validateSpec,style:F.style,styleSpec:F.styleSpec}))}function L(F,N){const Z=sn(F.value),X=Bn(F.value),ne=F.value!==null?F.value:N;if(s){if(Z!==s)return[new it(F.key,ne,`${Z} stop domain type must match previous stop domain type ${s}`)]}else s=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean")return[new it(F.key,ne,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&r!=="categorical"){let be=`number expected, ${Z} found`;return oa(t)&&r===void 0&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new it(F.key,ne,be)]}return r!=="categorical"||Z!=="number"||isFinite(X)&&Math.floor(X)===X?r!=="categorical"&&Z==="number"&&h!==void 0&&X<h?[new it(F.key,ne,"stop domain values must appear in ascending order")]:(h=X,r==="categorical"&&X in y?[new it(F.key,ne,"stop domain values must be unique")]:(y[X]=!0,[])):[new it(F.key,ne,`integer expected, found ${X}`)]}}function Li(i){const t=(i.expressionContext==="property"?la:no)(za(i.value),i.valueSpec);if(t.result==="error")return t.value.map((s=>new it(`${i.key}${s.key}`,i.value,s.message)));const r=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new it(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Cs(r))return[new it(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Cs(r))return[new it(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Ts(r,["zoom","feature-state"]))return[new it(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!vo(r))return[new it(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yi(i){const t=i.key,r=i.value,s=sn(r);return s!=="string"?[new it(t,r,`color expected, ${s} found`)]:cn.parse(String(r))?[]:[new it(t,r,`color expected, "${r}" found`)]}function ca(i){const t=i.key,r=i.value,s=i.valueSpec,h=[];return Array.isArray(s.values)?s.values.indexOf(Bn(r))===-1&&h.push(new it(t,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(s.values).indexOf(Bn(r))===-1&&h.push(new it(t,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function du(i){return Ra(za(i.value))?Li(yi({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):$u(i)}function $u(i){const t=i.value,r=i.key;if(sn(t)!=="array")return[new it(r,t,`array expected, ${sn(t)} found`)];const s=i.styleSpec;let h,m=[];if(t.length<1)return[new it(r,t,"filter array must have at least 1 element")];switch(m=m.concat(ca({key:`${r}[0]`,value:t[0],valueSpec:s.filter_operator,style:i.style,styleSpec:i.styleSpec})),Bn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Bn(t[1])==="$type"&&m.push(new it(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new it(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=sn(t[1]),h!=="string"&&m.push(new it(`${r}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=sn(t[y]),Bn(t[1])==="$type"?m=m.concat(ca({key:`${r}[${y}]`,value:t[y],valueSpec:s.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new it(`${r}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)m=m.concat($u({key:`${r}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=sn(t[1]),t.length!==2?m.push(new it(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new it(`${r}[1]`,t[1],`string expected, ${h} found`))}return m}function _l(i,t){const r=i.key,s=i.validateSpec,h=i.style,m=i.styleSpec,y=i.value,v=i.objectKey,b=m[`${t}_${i.layerType}`];if(!b)return[];const P=v.match(/^(.*)-transition$/);if(t==="paint"&&P&&b[P[1]]&&b[P[1]].transition)return s({key:r,value:y,valueSpec:m.transition,style:h,styleSpec:m});const A=i.valueSpec||b[v];if(!A)return[new it(r,y,`unknown property "${v}"`)];let D;if(sn(y)==="string"&&oa(A)&&!A.tokens&&(D=/^{([^}]+)}$/.exec(y)))return[new it(r,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(D[1])} }\`.`)];const L=[];return i.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&L.push(new it(r,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&uu(za(y))&&Bn(y.type)==="identity"&&L.push(new it(r,y,'"text-font" does not support identity functions'))),L.concat(s({key:i.key,value:y,valueSpec:A,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function fu(i){return _l(i,"paint")}function Qo(i){return _l(i,"layout")}function Rr(i){let t=[];const r=i.value,s=i.key,h=i.style,m=i.styleSpec;if(sn(r)!=="object")return[new it(s,r,`object expected, ${sn(r)} found`)];r.type||r.ref||t.push(new it(s,r,'either "type" or "ref" is required'));let y=Bn(r.type);const v=Bn(r.ref);if(r.id){const b=Bn(r.id);for(let P=0;P<i.arrayIndex;P++){const A=h.layers[P];Bn(A.id)===b&&t.push(new it(s,r.id,`duplicate layer id "${r.id}", previously used at line ${A.id.__line__}`))}}if("ref"in r){let b;["type","source","source-layer","filter","layout"].forEach((P=>{P in r&&t.push(new it(s,r[P],`"${P}" is prohibited for ref layers`))})),h.layers.forEach((P=>{Bn(P.id)===v&&(b=P)})),b?b.ref?t.push(new it(s,r.ref,"ref cannot reference another ref layer")):y=Bn(b.type):t.push(new it(s,r.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(r.source){const b=h.sources&&h.sources[r.source],P=b&&Bn(b.type);b?P==="vector"&&y==="raster"?t.push(new it(s,r.source,`layer "${r.id}" requires a raster source`)):P!=="raster-dem"&&y==="hillshade"||P!=="raster-dem"&&y==="color-relief"?t.push(new it(s,r.source,`layer "${r.id}" requires a raster-dem source`)):P==="raster"&&y!=="raster"?t.push(new it(s,r.source,`layer "${r.id}" requires a vector source`)):P!=="vector"||r["source-layer"]?P==="raster-dem"&&y!=="hillshade"&&y!=="color-relief"?t.push(new it(s,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||P==="geojson"&&b.lineMetrics||t.push(new it(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new it(s,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new it(s,r.source,`source "${r.source}" not found`))}else t.push(new it(s,r,'missing required property "source"'));return t=t.concat(Xi({key:s,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${s}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:r,objectKey:"type"}),filter:du,layout:b=>Xi({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":P=>Qo(yi({layerType:y},P))}}),paint:b=>Xi({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":P=>fu(yi({layerType:y},P))}})}})),t}function Ki(i){const t=i.value,r=i.key,s=sn(t);return s!=="string"?[new it(r,t,`string expected, ${s} found`)]:[]}const ki={promoteId:function({key:i,value:t}){if(sn(t)==="string")return Ki({key:i,value:t});{const r=[];for(const s in t)r.push(...Ki({key:`${i}.${s}`,value:t[s]}));return r}}};function vl(i){const t=i.value,r=i.key,s=i.styleSpec,h=i.style,m=i.validateSpec;if(!t.type)return[new it(r,t,'"type" is required')];const y=Bn(t.type);let v;switch(y){case"vector":case"raster":return v=Xi({key:r,value:t,valueSpec:s[`source_${y.replace("-","_")}`],style:i.style,styleSpec:s,objectElementValidators:ki,validateSpec:m}),v;case"raster-dem":return v=(function(b){var P;const A=(P=b.sourceName)!==null&&P!==void 0?P:"",D=b.value,L=b.styleSpec,F=L.source_raster_dem,N=b.style;let Z=[];const X=sn(D);if(D===void 0)return Z;if(X!=="object")return Z.push(new it("source_raster_dem",D,`object expected, ${X} found`)),Z;const ne=Bn(D.encoding)==="custom",be=["redFactor","greenFactor","blueFactor","baseShift"],le=b.value.encoding?`"${b.value.encoding}"`:"Default";for(const fe in D)!ne&&be.includes(fe)?Z.push(new it(fe,D[fe],`In "${A}": "${fe}" is only valid when "encoding" is set to "custom". ${le} encoding found`)):F[fe]?Z=Z.concat(b.validateSpec({key:fe,value:D[fe],valueSpec:F[fe],validateSpec:b.validateSpec,style:N,styleSpec:L})):Z.push(new it(fe,D[fe],`unknown property "${fe}"`));return Z})({sourceName:r,value:t,style:i.style,styleSpec:s,validateSpec:m}),v;case"geojson":if(v=Xi({key:r,value:t,valueSpec:s.source_geojson,style:h,styleSpec:s,validateSpec:m,objectElementValidators:ki}),t.cluster)for(const b in t.clusterProperties){const[P,A]=t.clusterProperties[b],D=typeof P=="string"?[P,["accumulated"],["get",b]]:P;v.push(...Li({key:`${r}.${b}.map`,value:A,expressionContext:"cluster-map"})),v.push(...Li({key:`${r}.${b}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return v;case"video":return Xi({key:r,value:t,valueSpec:s.source_video,style:h,validateSpec:m,styleSpec:s});case"image":return Xi({key:r,value:t,valueSpec:s.source_image,style:h,validateSpec:m,styleSpec:s});case"canvas":return[new it(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ca({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Wc(i){const t=i.value,r=i.styleSpec,s=r.light,h=i.style;let m=[];const y=sn(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new it("light",t,`object expected, ${y} found`)]),m;for(const v in t){const b=v.match(/^(.*)-transition$/);m=m.concat(b&&s[b[1]]&&s[b[1]].transition?i.validateSpec({key:v,value:t[v],valueSpec:r.transition,validateSpec:i.validateSpec,style:h,styleSpec:r}):s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:i.validateSpec,style:h,styleSpec:r}):[new it(v,t[v],`unknown property "${v}"`)])}return m}function $h(i){const t=i.value,r=i.styleSpec,s=r.sky,h=i.style,m=sn(t);if(t===void 0)return[];if(m!=="object")return[new it("sky",t,`object expected, ${m} found`)];let y=[];for(const v in t)y=y.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],style:h,styleSpec:r}):[new it(v,t[v],`unknown property "${v}"`)]);return y}function Ur(i){const t=i.value,r=i.styleSpec,s=r.terrain,h=i.style;let m=[];const y=sn(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new it("terrain",t,`object expected, ${y} found`)]),m;for(const v in t)m=m.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:i.validateSpec,style:h,styleSpec:r}):[new it(v,t[v],`unknown property "${v}"`)]);return m}function Jo(i){let t=[];const r=i.value,s=i.key;if(Array.isArray(r)){const h=[],m=[];for(const y in r)r[y].id&&h.includes(r[y].id)&&t.push(new it(s,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),h.push(r[y].id),r[y].url&&m.includes(r[y].url)&&t.push(new it(s,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),m.push(r[y].url),t=t.concat(Xi({key:`${s}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return Ki({key:s,value:r})}function As(i){return t=i.value,t&&t.constructor===Object?[]:[new it(i.key,i.value,`object expected, ${sn(i.value)} found`)];var t}const es={"*":()=>[],array:Ko,boolean:function(i){const t=i.value,r=i.key,s=sn(t);return s!=="boolean"?[new it(r,t,`boolean expected, ${s} found`)]:[]},number:yl,color:Yi,constants:Hu,enum:ca,filter:du,function:So,layer:Rr,object:Xi,source:vl,light:Wc,sky:$h,terrain:Ur,projection:function(i){const t=i.value,r=i.styleSpec,s=r.projection,h=i.style,m=sn(t);if(t===void 0)return[];if(m!=="object")return[new it("projection",t,`object expected, ${m} found`)];let y=[];for(const v in t)y=y.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],style:h,styleSpec:r}):[new it(v,t[v],`unknown property "${v}"`)]);return y},projectionDefinition:function(i){const t=i.key;let r=i.value;r=r instanceof String?r.valueOf():r;const s=sn(r);return s!=="array"||(function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"})(r)||(function(h){return!!["interpolate","step","literal"].includes(h[0])})(r)?["array","string"].includes(s)?[]:[new it(t,r,`projection expected, invalid type "${s}" found`)]:[new it(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Ki,formatted:function(i){return Ki(i).length===0?[]:Li(i)},resolvedImage:function(i){return Ki(i).length===0?[]:Li(i)},padding:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){if(r.length<1||r.length>4)return[new it(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const s={type:"number"};let h=[];for(let m=0;m<r.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return yl({key:t,value:r,valueSpec:{}})},numberArray:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){const s={type:"number"};if(r.length<1)return[new it(t,r,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<r.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return yl({key:t,value:r,valueSpec:{}})},colorArray:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){if(r.length<1)return[new it(t,r,"array length at least 1 expected, length 0 found")];let s=[];for(let h=0;h<r.length;h++)s=s.concat(Yi({key:`${t}[${h}]`,value:r[h]}));return s}return Yi({key:t,value:r})},variableAnchorOffsetCollection:function(i){const t=i.key,r=i.value,s=sn(r),h=i.styleSpec;if(s!=="array"||r.length<1||r.length%2!=0)return[new it(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<r.length;y+=2)m=m.concat(ca({key:`${t}[${y}]`,value:r[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(Ko({key:`${t}[${y+1}]`,value:r[y+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return m},sprite:Jo,state:As};function xl(i){const t=i.value,r=i.valueSpec,s=i.styleSpec;return i.validateSpec=xl,r.expression&&uu(Bn(t))?So(i):r.expression&&xo(za(t))?Li(i):r.type&&es[r.type]?es[r.type](i):Xi(yi({},i,{valueSpec:r.type?s[r.type]:r}))}function Po(i){const t=i.value,r=i.key,s=Ki(i);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new it(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new it(r,t,'"glyphs" url must include a "{range}" token'))),s}function fi(i,t=xe){let r=[];return r=r.concat(xl({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:xl,objectElementValidators:{glyphs:Po,"*":()=>[]}})),i.constants&&(r=r.concat(Hu({key:"constants",value:i.constants}))),Zc(r)}function Oi(i){return function(t){return i({...t,validateSpec:xl})}}function Zc(i){return[].concat(i).sort(((t,r)=>t.line-r.line))}function Ia(i){return function(...t){return Zc(i.apply(this,t))}}fi.source=Ia(Oi(vl)),fi.sprite=Ia(Oi(Jo)),fi.glyphs=Ia(Oi(Po)),fi.light=Ia(Oi(Wc)),fi.sky=Ia(Oi($h)),fi.terrain=Ia(Oi(Ur)),fi.state=Ia(Oi(As)),fi.layer=Ia(Oi(Rr)),fi.filter=Ia(Oi(du)),fi.paintProperty=Ia(Oi(fu)),fi.layoutProperty=Ia(Oi(Qo));const Es=fi,La=Es.light,qc=Es.sky,Xu=Es.paintProperty,pu=Es.layoutProperty;function bl(i,t){let r=!1;if(t&&t.length)for(const s of t)i.fire(new qe(new Error(s.message))),r=!0;return r}class ts{constructor(t,r,s){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(r=y[1])+2*(s=y[2]);for(let b=0;b<this.d*this.d;b++){const P=y[3+b],A=y[3+b+1];h.push(P===A?null:y.subarray(P,A))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*s;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=s,this.scale=r/t,this.uid=0;const m=s/r*t;this.min=-m,this.max=t+m}insert(t,r,s,h,m){this._forEachCell(r,s,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,s,h,m,y){this.cells[m].push(y)}query(t,r,s,h,m){const y=this.min,v=this.max;if(t<=y&&r<=y&&v<=s&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(t,r,s,h,this._queryCell,b,{},m),b}}_queryCell(t,r,s,h,m,y,v,b){const P=this.cells[m];if(P!==null){const A=this.keys,D=this.bboxes;for(let L=0;L<P.length;L++){const F=P[L];if(v[F]===void 0){const N=4*F;(b?b(D[N+0],D[N+1],D[N+2],D[N+3]):t<=D[N+2]&&r<=D[N+3]&&s>=D[N+0]&&h>=D[N+1])?(v[F]=!0,y.push(A[F])):v[F]=!1}}}}_forEachCell(t,r,s,h,m,y,v,b){const P=this._convertToCellCoord(t),A=this._convertToCellCoord(r),D=this._convertToCellCoord(s),L=this._convertToCellCoord(h);for(let F=P;F<=D;F++)for(let N=A;N<=L;N++){const Z=this.d*N+F;if((!b||b(this._convertFromCellCoord(F),this._convertFromCellCoord(N),this._convertFromCellCoord(F+1),this._convertFromCellCoord(N+1)))&&m.call(this,t,r,s,h,Z,y,v,b))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let s=0;for(let y=0;y<this.cells.length;y++)s+=this.cells[y].length;const h=new Int32Array(r+s+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=r;for(let y=0;y<t.length;y++){const v=t[y];h[3+y]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,r){const s=t.toArrayBuffer();return r&&r.push(s),{buffer:s}}static deserialize(t){return new ts(t.buffer)}}const Bi={};function _t(i,t,r={}){if(Bi[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Bi[i]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}_t("Object",Object),_t("Set",Set),_t("TransferableGridIndex",ts),_t("Color",cn),_t("Error",Error),_t("AJAXError",oe),_t("ResolvedImage",hi),_t("StylePropertyFunction",bi),_t("StyleExpression",cu,{omit:["_evaluator"]}),_t("ZoomDependentExpression",ml),_t("ZoomConstantExpression",Xo),_t("CompoundExpression",aa,{omit:["_evaluate"]});for(const i in Ps)Ps[i]._classRegistryKey||_t(`Expression_${i}`,Ps[i]);function Yu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Ms(i){return i.$name||i.constructor._classRegistryKey}function Ku(i){return!(function(t){if(t===null||typeof t!="object")return!1;const r=Ms(t);return!(!r||r==="Object")})(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||Yu(i)||Kr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function ka(i,t){if(Ku(i))return(Yu(i)||Kr(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const m=[];for(const y of i)m.push(ka(y,t));return m}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const r=Ms(i);if(!r)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Bi[r])throw new Error(`${r} is not registered.`);const{klass:s}=Bi[r],h=s.serialize?s.serialize(i,t):{};if(s.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||Bi[r].omit.indexOf(m)>=0)continue;const y=i[m];h[m]=Bi[r].shallow.indexOf(m)>=0?y:ka(y,t)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(h.$name=r),h}function Rs(i){if(Ku(i))return i;if(Array.isArray(i))return i.map(Rs);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=Ms(i)||"Object";if(!Bi[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Bi[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(i);const s=Object.create(r.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const m=i[h];s[h]=Bi[t].shallow.indexOf(h)>=0?m:Rs(m)}return s}class Qu{constructor(){this.first=!0}update(t,r){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const en={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Hangul Syllables":i=>i>=44032&&i<=55215,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function mu(i){for(const t of i)if(gu(t.charCodeAt(0)))return!0;return!1}function Ju(i){for(const t of i)if(!wl(t.charCodeAt(0)))return!1;return!0}function ro(i){const t=i.map((r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}})).filter((r=>r));return new RegExp(t.join("|"),"u")}const Co=ro(["Arab","Dupl","Mong","Ougr","Syrc"]);function wl(i){return!Co.test(String.fromCodePoint(i))}const ec=ro(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function gu(i){return!(i!==746&&i!==747&&(i<4352||!(en["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||en["CJK Compatibility"](i)||en["CJK Strokes"](i)||!(!en["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||en["Enclosed CJK Letters and Months"](i)||en["Ideographic Description Characters"](i)||en.Kanbun(i)||en.Katakana(i)&&i!==12540||!(!en["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!en["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||en["Vertical Forms"](i)||en["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||ec.test(String.fromCodePoint(i)))))}function Ds(i){return!(gu(i)||(function(t){return!!(en["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||en["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||en["Letterlike Symbols"](t)||en["Number Forms"](t)||en["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||en["Control Pictures"](t)&&t!==9251||en["Optical Character Recognition"](t)||en["Enclosed Alphanumerics"](t)||en["Geometric Shapes"](t)||en["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||en["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||en["CJK Symbols and Punctuation"](t)||en.Katakana(t)||en["Private Use Area"](t)||en["CJK Compatibility Forms"](t)||en["Small Form Variants"](t)||en["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(i))}const Sl=ro(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function tc(i){return Sl.test(String.fromCodePoint(i))}function Hc(i,t){return!(!t&&tc(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||en.Khmer(i))}function To(i){for(const t of i)if(tc(t.charCodeAt(0)))return!0;return!1}const Oa=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(Oa.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,t){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const r=i.pluginURL,s=new Promise((m=>{this.loadScriptResolve=m}));t(r);const h=new Promise((m=>setTimeout((()=>m()),this.TIMEOUT)));if(yield Promise.race([s,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:r};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)}))}};class Ln{constructor(t,r){this.isSupportedScript=$c,this.zoom=t,r?(this.now=r.now||0,this.fadeDuration=r.fadeDuration||0,this.zoomHistory=r.zoomHistory||new Qu,this.transition=r.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Qu,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*r}}}function $c(i){return(function(t,r){for(const s of t)if(!Hc(s.charCodeAt(0),r))return!1;return!0})(i,Oa.getRTLTextPluginStatus()==="loaded")}class Pl{constructor(t,r,s){this.property=t,this.value=r,this.expression=(function(h,m,y){if(uu(h))return new bi(h,m);if(xo(h)){const v=la(h,m,y);if(v.result==="error")throw new Error(v.value.map((b=>`${b.key}: ${b.message}`)).join(", "));return v.value}{let v=h;return m.type==="color"&&typeof h=="string"?v=cn.parse(h):m.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?m.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?m.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?v=ci.parse(h):m.type==="projectionDefinition"&&typeof h=="string"&&(v=vr.parse(h)):v=Mr.parse(h):v=ui.parse(h):v=Gr.parse(h),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>v}}})(r===void 0?t.specification.default:r,t.specification,s)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,r,s){return this.property.possiblyEvaluate(this,t,r,s)}}class Ba{constructor(t,r){this.property=t,this.value=new Pl(t,void 0,r)}transitioned(t,r){return new kn(this.property,this.value,r,Vt({},t.transition,this.transition),t.now)}untransitioned(){return new kn(this.property,this.value,null,{},0)}}class fn{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=r}getValue(t){return vt(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ba(this._values[t].property,this._globalState)),this._values[t].value=new Pl(this._values[t].property,r===null?void 0:vt(r),this._globalState)}getTransition(t){return vt(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Ba(this._values[t].property,this._globalState)),this._values[t].transition=vt(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);s!==void 0&&(t[r]=s);const h=this.getTransition(r);h!==void 0&&(t[`${r}-transition`]=h)}return t}transitioned(t,r){const s=new Dr(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(t,r._values[h]);return s}untransitioned(){const t=new Dr(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class kn{constructor(t,r,s,h,m){this.property=t,this.value=r,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(t,r,s){const h=t.now||0,m=this.value.possiblyEvaluate(t,r,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(t,r,s);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,r,s),m,rt(v))}}return m}}class Dr{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,s){const h=new io(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,s);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class nc{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=r}hasValue(t){return this._values[t].value!==void 0}getValue(t){return vt(this._values[t].value)}setValue(t,r){this._values[t]=new Pl(this._values[t].property,r===null?void 0:vt(r),this._globalState)}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);s!==void 0&&(t[r]=s)}return t}possiblyEvaluate(t,r,s){const h=new io(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,s);return h}}class Fi{constructor(t,r,s){this.property=t,this.value=r,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,s,h){return this.property.evaluate(this.value,this.parameters,t,r,s,h)}}class io{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class St{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,s){const h=eo[this.specification.type];return h?h(t,r,s):t}}class zt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,s,h){return new Fi(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},s,h)}:t.expression,r)}interpolate(t,r,s){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Fi(this,{kind:"constant",value:void 0},t.parameters);const h=eo[this.specification.type];if(h){const m=h(t.value.value,r.value.value,s);return new Fi(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,r,s,h,m,y){return t.kind==="constant"?t.value:t.evaluate(r,s,h,m,y)}}class Ao extends zt{possiblyEvaluate(t,r,s,h){if(t.value===void 0)return new Fi(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},s,h),y=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(y,y,y,r);return new Fi(this,{kind:"constant",value:v},r)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Fi(this,{kind:"constant",value:m},r)}return new Fi(this,t.expression,r)}evaluate(t,r,s,h,m,y){if(t.kind==="source"){const v=t.evaluate(r,s,h,m,y);return this._calculate(v,v,v,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},s,h),t.evaluate({zoom:Math.floor(r.zoom)},s,h),t.evaluate({zoom:Math.floor(r.zoom)+1},s,h),r):t.value}_calculate(t,r,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:s,to:r}}interpolate(t){return t}}class Xc{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},s,h);return this._calculate(m,m,m,r)}return this._calculate(t.expression.evaluate(new Ln(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Ln(Math.floor(r.zoom),r)),t.expression.evaluate(new Ln(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:s,to:r}}interpolate(t){return t}}class fr{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,h){return!!t.expression.evaluate(r,null,{},s,h)}interpolate(){return!1}}class ei{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const s=t[r];s.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new Pl(s,void 0,void 0),m=this.defaultTransitionablePropertyValues[r]=new Ba(s,void 0);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}_t("DataDrivenProperty",zt),_t("DataConstantProperty",St),_t("CrossFadedDataDrivenProperty",Ao),_t("CrossFadedProperty",Xc),_t("ColorRampProperty",fr);const rc="-transition";class xa extends bt{constructor(t,r,s){if(super(),this.id=t.id,this.type=t.type,this._globalState=s,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=bo(t.filter,s)),r.layout&&(this._unevaluatedLayout=new nc(r.layout,s)),r.paint)){this._transitionablePaint=new fn(r.paint,s);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new io(r.paint)}}setFilter(t){this.filter=t,this._featureFilter=bo(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const r in this._unevaluatedLayout._values){const s=this._unevaluatedLayout._values[r];for(const h of s.getGlobalStateRefs())t.add(h)}for(const r of this._featureFilter.getGlobalStateRefs())t.add(r);return t}getPaintAffectingGlobalStateRefs(){var t;const r=new globalThis.Map;if(this._transitionablePaint)for(const s in this._transitionablePaint._values){const h=this._transitionablePaint._values[s].value;for(const m of h.getGlobalStateRefs()){const y=(t=r.get(m))!==null&&t!==void 0?t:[];y.push({name:s,value:h.value}),r.set(m,y)}}return r}setLayoutProperty(t,r,s={}){r!=null&&this._validate(pu,`layers.${this.id}.layout.${t}`,t,r,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(rc)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,s={}){if(r!=null&&this._validate(Xu,`layers.${this.id}.paint.${t}`,t,r,s))return!1;if(t.endsWith(rc))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const b=this._transitionablePaint._values[t].value;return b.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(t,v,b)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),xn(t,((r,s)=>!(r===void 0||s==="layout"&&!Object.keys(r).length||s==="paint"&&!Object.keys(r).length)))}_validate(t,r,s,h,m={}){return(!m||m.validate!==!1)&&bl(this,t.call(Es,{key:r,layerType:this.type,objectKey:s,value:h,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Fi&&oa(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const ns={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Cl{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Hn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pr(i,t=1){let r=0,s=0;return{members:i.map((h=>{const m=ns[h.type].BYTES_PER_ELEMENT,y=r=Tl(r,Math.max(t,m)),v=h.components||1;return s=Math.max(s,m),r+=m*v,{name:h.name,type:h.type,components:v,offset:y}})),size:Tl(r,Math.max(s,t)),alignment:t}}function Tl(i,t){return Math.ceil(i/t)*t}class ti extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.int16[h+0]=r,this.int16[h+1]=s,t}}ti.prototype.bytesPerElement=4,_t("StructArrayLayout2i4",ti);class ir extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.int16[m+0]=r,this.int16[m+1]=s,this.int16[m+2]=h,t}}ir.prototype.bytesPerElement=6,_t("StructArrayLayout3i6",ir);class Eo extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,s,h)}emplace(t,r,s,h,m){const y=4*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=m,t}}Eo.prototype.bytesPerElement=8,_t("StructArrayLayout4i8",Eo);class zs extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const b=6*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=v,t}}zs.prototype.bytesPerElement=12,_t("StructArrayLayout2i4i12",zs);class Is extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const b=4*t,P=8*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.uint8[P+4]=h,this.uint8[P+5]=m,this.uint8[P+6]=y,this.uint8[P+7]=v,t}}Is.prototype.bytesPerElement=8,_t("StructArrayLayout2i4ub8",Is);class Fa extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.float32[h+0]=r,this.float32[h+1]=s,t}}Fa.prototype.bytesPerElement=8,_t("StructArrayLayout2f8",Fa);class Na extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,b,P,A){const D=this.length;return this.resize(D+1),this.emplace(D,t,r,s,h,m,y,v,b,P,A)}emplace(t,r,s,h,m,y,v,b,P,A,D){const L=10*t;return this.uint16[L+0]=r,this.uint16[L+1]=s,this.uint16[L+2]=h,this.uint16[L+3]=m,this.uint16[L+4]=y,this.uint16[L+5]=v,this.uint16[L+6]=b,this.uint16[L+7]=P,this.uint16[L+8]=A,this.uint16[L+9]=D,t}}Na.prototype.bytesPerElement=20,_t("StructArrayLayout10ui20",Na);class Al extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,b,P,A,D,L){const F=this.length;return this.resize(F+1),this.emplace(F,t,r,s,h,m,y,v,b,P,A,D,L)}emplace(t,r,s,h,m,y,v,b,P,A,D,L,F){const N=12*t;return this.int16[N+0]=r,this.int16[N+1]=s,this.int16[N+2]=h,this.int16[N+3]=m,this.uint16[N+4]=y,this.uint16[N+5]=v,this.uint16[N+6]=b,this.uint16[N+7]=P,this.int16[N+8]=A,this.int16[N+9]=D,this.int16[N+10]=L,this.int16[N+11]=F,t}}Al.prototype.bytesPerElement=24,_t("StructArrayLayout4i4ui4i24",Al);class El extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.float32[m+0]=r,this.float32[m+1]=s,this.float32[m+2]=h,t}}El.prototype.bytesPerElement=12,_t("StructArrayLayout3f12",El);class yu extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}yu.prototype.bytesPerElement=4,_t("StructArrayLayout1ul4",yu);class f extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,b,P){const A=this.length;return this.resize(A+1),this.emplace(A,t,r,s,h,m,y,v,b,P)}emplace(t,r,s,h,m,y,v,b,P,A){const D=10*t,L=5*t;return this.int16[D+0]=r,this.int16[D+1]=s,this.int16[D+2]=h,this.int16[D+3]=m,this.int16[D+4]=y,this.int16[D+5]=v,this.uint32[L+3]=b,this.uint16[D+8]=P,this.uint16[D+9]=A,t}}f.prototype.bytesPerElement=20,_t("StructArrayLayout6i1ul2ui20",f);class e extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const b=6*t;return this.int16[b+0]=r,this.int16[b+1]=s,this.int16[b+2]=h,this.int16[b+3]=m,this.int16[b+4]=y,this.int16[b+5]=v,t}}e.prototype.bytesPerElement=12,_t("StructArrayLayout2i2i2i12",e);class a extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,h,m)}emplace(t,r,s,h,m,y){const v=4*t,b=8*t;return this.float32[v+0]=r,this.float32[v+1]=s,this.float32[v+2]=h,this.int16[b+6]=m,this.int16[b+7]=y,t}}a.prototype.bytesPerElement=16,_t("StructArrayLayout2f1f2i16",a);class l extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const b=16*t,P=4*t,A=8*t;return this.uint8[b+0]=r,this.uint8[b+1]=s,this.float32[P+1]=h,this.float32[P+2]=m,this.int16[A+6]=y,this.int16[A+7]=v,t}}l.prototype.bytesPerElement=16,_t("StructArrayLayout2ub2f2i16",l);class d extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.uint16[m+0]=r,this.uint16[m+1]=s,this.uint16[m+2]=h,t}}d.prototype.bytesPerElement=6,_t("StructArrayLayout3ui6",d);class g extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne){const be=this.length;return this.resize(be+1),this.emplace(be,t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne)}emplace(t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne,be){const le=24*t,fe=12*t,Re=48*t;return this.int16[le+0]=r,this.int16[le+1]=s,this.uint16[le+2]=h,this.uint16[le+3]=m,this.uint32[fe+2]=y,this.uint32[fe+3]=v,this.uint32[fe+4]=b,this.uint16[le+10]=P,this.uint16[le+11]=A,this.uint16[le+12]=D,this.float32[fe+7]=L,this.float32[fe+8]=F,this.uint8[Re+36]=N,this.uint8[Re+37]=Z,this.uint8[Re+38]=X,this.uint32[fe+10]=ne,this.int16[le+22]=be,t}}g.prototype.bytesPerElement=48,_t("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",g);class _ extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne,be,le,fe,Re,Be,Ke,dt,at,ft,Rt,ot){const lt=this.length;return this.resize(lt+1),this.emplace(lt,t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne,be,le,fe,Re,Be,Ke,dt,at,ft,Rt,ot)}emplace(t,r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne,be,le,fe,Re,Be,Ke,dt,at,ft,Rt,ot,lt){const Ve=32*t,Bt=16*t;return this.int16[Ve+0]=r,this.int16[Ve+1]=s,this.int16[Ve+2]=h,this.int16[Ve+3]=m,this.int16[Ve+4]=y,this.int16[Ve+5]=v,this.int16[Ve+6]=b,this.int16[Ve+7]=P,this.uint16[Ve+8]=A,this.uint16[Ve+9]=D,this.uint16[Ve+10]=L,this.uint16[Ve+11]=F,this.uint16[Ve+12]=N,this.uint16[Ve+13]=Z,this.uint16[Ve+14]=X,this.uint16[Ve+15]=ne,this.uint16[Ve+16]=be,this.uint16[Ve+17]=le,this.uint16[Ve+18]=fe,this.uint16[Ve+19]=Re,this.uint16[Ve+20]=Be,this.uint16[Ve+21]=Ke,this.uint16[Ve+22]=dt,this.uint32[Bt+12]=at,this.float32[Bt+13]=ft,this.float32[Bt+14]=Rt,this.uint16[Ve+30]=ot,this.uint16[Ve+31]=lt,t}}_.prototype.bytesPerElement=64,_t("StructArrayLayout8i15ui1ul2f2ui64",_);class w extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}w.prototype.bytesPerElement=4,_t("StructArrayLayout1f4",w);class S extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.uint16[6*t+0]=r,this.float32[m+1]=s,this.float32[m+2]=h,t}}S.prototype.bytesPerElement=12,_t("StructArrayLayout1ui2f12",S);class T extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=4*t;return this.uint32[2*t+0]=r,this.uint16[m+2]=s,this.uint16[m+3]=h,t}}T.prototype.bytesPerElement=8,_t("StructArrayLayout1ul2ui8",T);class M extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.uint16[h+0]=r,this.uint16[h+1]=s,t}}M.prototype.bytesPerElement=4,_t("StructArrayLayout2ui4",M);class I extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}I.prototype.bytesPerElement=2,_t("StructArrayLayout1ui2",I);class z extends Hn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,s,h)}emplace(t,r,s,h,m){const y=4*t;return this.float32[y+0]=r,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=m,t}}z.prototype.bytesPerElement=16,_t("StructArrayLayout4f16",z);class B extends Cl{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new q(this.anchorPointX,this.anchorPointY)}}B.prototype.size=20;class W extends f{get(t){return new B(this,t)}}_t("CollisionBoxArray",W);class Y extends Cl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}Y.prototype.size=48;class K extends g{get(t){return new Y(this,t)}}_t("PlacedSymbolArray",K);class J extends Cl{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}J.prototype.size=64;class re extends _{get(t){return new J(this,t)}}_t("SymbolInstanceArray",re);class se extends w{getoffsetX(t){return this.float32[1*t+0]}}_t("GlyphOffsetArray",se);class ie extends ir{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}_t("SymbolLineVertexArray",ie);class ce extends Cl{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class pe extends S{get(t){return new ce(this,t)}}_t("TextAnchorOffsetArray",pe);class ae extends Cl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ae.prototype.size=8;class _e extends T{get(t){return new ae(this,t)}}_t("FeatureIndexArray",_e);class Le extends ti{}class Te extends ti{}class Ee extends ti{}class ke extends zs{}class ct extends Is{}class st extends Fa{}class $e extends Na{}class Pt extends Al{}class ln extends El{}class Pn extends yu{}class ar extends e{}class Fn extends l{}class Nn extends d{}class $n extends M{}const Wn=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Un}=Wn;class vn{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,s,h){const m=this.segments[this.segments.length-1];return t>vn.MAX_VERTEX_ARRAY_LENGTH&&un(`Max vertices per segment is ${vn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${vn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>vn.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(r,s,h):m}createNewSegment(t,r,s){const h={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(h.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,r,s){return this.prepareSegment(0,t,r,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,s,h){return new vn([{vertexOffset:t,primitiveOffset:r,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}function jr(i,t){return 256*(i=Dt(Math.floor(i),0,255))+Dt(Math.floor(t),0,255)}vn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,_t("SegmentVector",vn);const zr=pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ni,rs,Mo,Ui={exports:{}},Ro={exports:{}},is={exports:{}},_u=(function(){if(Mo)return Ui.exports;Mo=1;var i=(Ni||(Ni=1,Ro.exports=function(r,s){var h,m,y,v,b,P,A,D;for(m=r.length-(h=3&r.length),y=s,b=3432918353,P=461845907,D=0;D<m;)A=255&r.charCodeAt(D)|(255&r.charCodeAt(++D))<<8|(255&r.charCodeAt(++D))<<16|(255&r.charCodeAt(++D))<<24,++D,y=27492+(65535&(v=5*(65535&(y=(y^=A=(65535&(A=(A=(65535&A)*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*P+(((A>>>16)*P&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(A=0,h){case 3:A^=(255&r.charCodeAt(D+2))<<16;case 2:A^=(255&r.charCodeAt(D+1))<<8;case 1:y^=A=(65535&(A=(A=(65535&(A^=255&r.charCodeAt(D)))*b+(((A>>>16)*b&65535)<<16)&4294967295)<<15|A>>>17))*P+(((A>>>16)*P&65535)<<16)&4294967295}return y^=r.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),Ro.exports),t=(rs||(rs=1,is.exports=function(r,s){for(var h,m=r.length,y=s^m,v=0;m>=4;)h=1540483477*(65535&(h=255&r.charCodeAt(v)|(255&r.charCodeAt(++v))<<8|(255&r.charCodeAt(++v))<<16|(255&r.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++v;switch(m){case 3:y^=(255&r.charCodeAt(v+2))<<16;case 2:y^=(255&r.charCodeAt(v+1))<<8;case 1:y=1540483477*(65535&(y^=255&r.charCodeAt(v)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),is.exports);return Ui.exports=i,Ui.exports.murmur3=i,Ui.exports.murmur2=t,Ui.exports})(),Do=te(_u);class ni{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,s,h){this.ids.push(ao(t)),this.positions.push(r,s,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=ao(t);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=r?h=y:s=y+1}const m=[];for(;this.ids[s]===r;)m.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return m}static serialize(t,r){const s=new Float64Array(t.ids),h=new Uint32Array(t.positions);return oo(s,h,0,s.length-1),r&&r.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(t){const r=new ni;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function ao(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Do(String(i))}function oo(i,t,r,s){for(;r<s;){const h=i[r+s>>1];let m=r-1,y=s+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;as(i,m,y),as(t,3*m,3*y),as(t,3*m+1,3*y+1),as(t,3*m+2,3*y+2)}y-r<s-y?(oo(i,t,r,y),r=y+1):(oo(i,t,y+1,s),s=y)}}function as(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}_t("FeaturePositionMap",ni);class Dn{constructor(t,r){this.gl=t.gl,this.location=r}}class hr extends Dn{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class wi extends Dn{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class xr extends Dn{constructor(t,r){super(t,r),this.current=cn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const ic=new Float32Array(16);function ac(i){return[jr(255*i.r,255*i.g),jr(255*i.b,255*i.a)]}class Ml{constructor(t,r,s){this.value=t,this.uniformNames=r.map((h=>`u_${h}`)),this.type=s}setUniform(t,r,s){t.set(s.constantOr(this.value))}getBinding(t,r,s){return this.type==="color"?new xr(t,r):new hr(t,r)}}class Ua{constructor(t,r){this.uniformNames=r.map((s=>`u_${s}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,s,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,r,s){return s.substr(0,9)==="u_pattern"?new wi(t,r):new hr(t,r)}}class so{constructor(t,r,s,h){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map((m=>({name:`a_${m}`,type:"Float32",components:s==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(t,r,s){const h=this.paintVertexArray.length,m=this.expression.evaluate(new Ln(0,s),r,{},s.canonical,[],s.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(h,t,m)}updatePaintArray(t,r,s,h,m){const y=this.expression.evaluate(new Ln(0,m),s,h);this._setPaintValue(t,r,y)}_setPaintValue(t,r,s){if(this.type==="color"){const h=ac(s);for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sr{constructor(t,r,s,h,m,y){this.expression=t,this.uniformNames=r.map((v=>`u_${v}_t`)),this.type=s,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map((v=>({name:`a_${v}`,type:"Float32",components:s==="color"?4:2,offset:0}))),this.paintVertexArray=new y}populatePaintArray(t,r,s){const h=this.expression.evaluate(new Ln(this.zoom,s),r,{},s.canonical,[],s.formattedSection),m=this.expression.evaluate(new Ln(this.zoom+1,s),r,{},s.canonical,[],s.formattedSection),y=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(y,t,h,m)}updatePaintArray(t,r,s,h,m){const y=this.expression.evaluate(new Ln(this.zoom,m),s,h),v=this.expression.evaluate(new Ln(this.zoom+1,m),s,h);this._setPaintValue(t,r,y,v)}_setPaintValue(t,r,s,h){if(this.type==="color"){const m=ac(s),y=ac(h);for(let v=t;v<r;v++)this.paintVertexArray.emplace(v,m[0],m[1],y[0],y[1])}else{for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const s=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=Dt(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,r,s){return new hr(t,r)}}class br{constructor(t,r,s,h,m,y){this.expression=t,this.type=r,this.useIntegerZoom=s,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,r,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,r.patterns&&r.patterns[this.layerId],s.imagePositions)}updatePaintArray(t,r,s,h,m){this._setPaintValues(t,r,s.patterns&&s.patterns[this.layerId],m.imagePositions)}_setPaintValues(t,r,s,h){if(!h||!s)return;const{min:m,mid:y,max:v}=s,b=h[m],P=h[y],A=h[v];if(b&&P&&A)for(let D=t;D<r;D++)this.zoomInPaintVertexArray.emplace(D,P.tl[0],P.tl[1],P.br[0],P.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],P.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(D,P.tl[0],P.tl[1],P.br[0],P.br[1],A.tl[0],A.tl[1],A.br[0],A.br[1],P.pixelRatio,A.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,zr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,zr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class lo{constructor(t,r,s){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!s(m))continue;const y=t.paint.get(m);if(!(y instanceof Fi&&oa(y.property.specification)))continue;const v=Io(m,t.type),b=y.value,P=y.property.specification.type,A=y.property.useIntegerZoom,D=y.property.specification["property-type"],L=D==="cross-faded"||D==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=L?new Ua(b.value,v):new Ml(b.value,v,P),h.push(`/u_${m}`);else if(b.kind==="source"||L){const F=ba(m,P,"source");this.binders[m]=L?new br(b,P,A,r,F,t.id):new so(b,v,P,F),h.push(`/a_${m}`)}else{const F=ba(m,P,"composite");this.binders[m]=new Sr(b,v,P,A,r,F),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof so||r instanceof Sr?r.maxValue:0}populatePaintArrays(t,r,s){for(const h in this.binders){const m=this.binders[h];(m instanceof so||m instanceof Sr||m instanceof br)&&m.populatePaintArray(t,r,s)}}setConstantPatternPositions(t,r){for(const s in this.binders){const h=this.binders[s];h instanceof Ua&&h.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,s,h,m){let y=!1;for(const v in t){const b=r.getPositions(v);for(const P of b){const A=s.feature(P.index);for(const D in this.binders){const L=this.binders[D];if((L instanceof so||L instanceof Sr||L instanceof br)&&L.expression.isStateDependent===!0){const F=h.paint.get(D);L.expression=F.value,L.updatePaintArray(P.start,P.end,A,t[v],m),y=!0}}}}return y}defines(){const t=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Ml||s instanceof Ua)&&t.push(...s.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof so||s instanceof Sr)for(let h=0;h<s.paintVertexAttributes.length;h++)t.push(s.paintVertexAttributes[h].name);else if(s instanceof br)for(let h=0;h<zr.members.length;h++)t.push(zr.members[h].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Ml||s instanceof Ua||s instanceof Sr)for(const h of s.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const s=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Ml||m instanceof Ua||m instanceof Sr){for(const y of m.uniformNames)if(r[y]){const v=m.getBinding(t,r[y],y);s.push({name:y,property:h,binding:v})}}}return s}setUniforms(t,r,s,h){for(const{name:m,property:y,binding:v}of r)this.binders[y].setUniform(v,h,s.get(y),m)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const s=this.binders[r];if(t&&s instanceof br){const h=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof so||s instanceof Sr)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const r in this.binders){const s=this.binders[r];(s instanceof so||s instanceof Sr||s instanceof br)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof so||r instanceof Sr||r instanceof br)&&r.destroy()}}}class zo{constructor(t,r,s=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new lo(h,r,s);this.needsUpload=!1,this._featureMap=new ni,this._bufferOffset=0}populatePaintArrays(t,r,s,h){for(const m in this.programConfigurations)this.programConfigurations[m].populatePaintArrays(t,r,h);r.id!==void 0&&this._featureMap.add(r.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,s,h){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,r,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Io(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function ba(i,t,r){const s={color:{source:Fa,composite:z},number:{source:w,composite:Fa}},h=(function(m){return{"line-pattern":{source:$e,composite:$e},"fill-pattern":{source:$e,composite:$e},"fill-extrusion-pattern":{source:$e,composite:$e}}[m]})(i);return h&&h[r]||s[t][r]}_t("ConstantBinder",Ml),_t("CrossFadedConstantBinder",Ua),_t("SourceExpressionBinder",so),_t("CrossFadedCompositeBinder",br),_t("CompositeExpressionBinder",Sr),_t("ProgramConfiguration",lo,{omit:["_buffers"]}),_t("ProgramConfigurationSet",zo);const Pr=Math.pow(2,14)-1,Ls=-Pr-1;function ks(i){const t=At/i.extent,r=i.loadGeometry();for(let s=0;s<r.length;s++){const h=r[s];for(let m=0;m<h.length;m++){const y=h[m],v=Math.round(y.x*t),b=Math.round(y.y*t);y.x=Dt(v,Ls,Pr),y.y=Dt(b,Ls,Pr),(v<y.x||v>y.x+1||b<y.y||b>y.y+1)&&un("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Os(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?ks(i):[]}}const Ed=-32768;function Vf(i,t,r,s,h){i.emplaceBack(Ed+8*t+s,Ed+8*r+h)}class Bs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Te,this.indexArray=new Nn,this.segments=new vn,this.programConfigurations=new zo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){const h=this.layers[0],m=[];let y=null,v=!1,b=h.type==="heatmap";if(h.type==="circle"){const A=h;y=A.layout.get("circle-sort-key"),v=!y.isConstant(),b=b||A.paint.get("circle-pitch-alignment")==="map"}const P=b?r.subdivisionGranularity.circle:1;for(const{feature:A,id:D,index:L,sourceLayerIndex:F}of t){const N=this.layers[0]._featureFilter.needGeometry,Z=Os(A,N);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),Z,s))continue;const X=v?y.evaluate(Z,{},s):void 0,ne={id:D,properties:A.properties,type:A.type,sourceLayerIndex:F,index:L,geometry:N?Z.geometry:ks(A),patterns:{},sortKey:X};m.push(ne)}v&&m.sort(((A,D)=>A.sortKey-D.sortKey));for(const A of m){const{geometry:D,index:L,sourceLayerIndex:F}=A,N=t[L].feature;this.addFeature(A,D,L,s,P),r.featureIndex.insert(N,D,L,F,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Un),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,s,h,m=1){let y;switch(m){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const v=y.length;for(const b of r)for(const P of b){const A=P.x,D=P.y;if(A<0||A>=At||D<0||D>=At)continue;const L=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),F=L.vertexLength;for(let N=0;N<v;N++)for(let Z=0;Z<v;Z++)Vf(this.layoutVertexArray,A,D,y[Z],y[N]);for(let N=0;N<v-1;N++)for(let Z=0;Z<v-1;Z++){const X=F+N*v+Z,ne=F+(N+1)*v+Z;this.indexArray.emplaceBack(X,ne+1,X+1),this.indexArray.emplaceBack(X,ne,ne+1)}L.vertexLength+=v*v,L.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:{},canonical:h})}}function Yc(i,t){for(let r=0;r<i.length;r++)if(sc(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(sc(i,t[r]))return!0;return!!oc(i,t)}function Kc(i,t,r){return!!sc(i,t)||!!Qc(t,i,r)}function Md(i,t){if(i.length===1)return Dd(t,i[0]);for(let r=0;r<t.length;r++){const s=t[r];for(let h=0;h<s.length;h++)if(sc(i,s[h]))return!0}for(let r=0;r<i.length;r++)if(Dd(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(oc(i,t[r]))return!0;return!1}function Gf(i,t,r){if(i.length>1){if(oc(i,t))return!0;for(let s=0;s<t.length;s++)if(Qc(t[s],i,r))return!0}for(let s=0;s<i.length;s++)if(Qc(i[s],t,r))return!0;return!1}function oc(i,t){if(i.length===0||t.length===0)return!1;for(let r=0;r<i.length-1;r++){const s=i[r],h=i[r+1];for(let m=0;m<t.length-1;m++)if(Wf(s,h,t[m],t[m+1]))return!0}return!1}function Wf(i,t,r,s){return qn(i,r,s)!==qn(t,r,s)&&qn(i,t,r)!==qn(i,t,s)}function Qc(i,t,r){const s=r*r;if(t.length===1)return i.distSqr(t[0])<s;for(let h=1;h<t.length;h++)if(Rd(i,t[h-1],t[h])<s)return!0;return!1}function Rd(i,t,r){const s=t.distSqr(r);if(s===0)return i.distSqr(t);const h=((i.x-t.x)*(r.x-t.x)+(i.y-t.y)*(r.y-t.y))/s;return i.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function Dd(i,t){let r,s,h,m=!1;for(let y=0;y<i.length;y++){r=i[y];for(let v=0,b=r.length-1;v<r.length;b=v++)s=r[v],h=r[b],s.y>t.y!=h.y>t.y&&t.x<(h.x-s.x)*(t.y-s.y)/(h.y-s.y)+s.x&&(m=!m)}return m}function sc(i,t){let r=!1;for(let s=0,h=i.length-1;s<i.length;h=s++){const m=i[s],y=i[h];m.y>t.y!=y.y>t.y&&t.x<(y.x-m.x)*(t.y-m.y)/(y.y-m.y)+m.x&&(r=!r)}return r}function Zf(i,t,r){const s=r[0],h=r[2];if(i.x<s.x&&t.x<s.x||i.x>h.x&&t.x>h.x||i.y<s.y&&t.y<s.y||i.y>h.y&&t.y>h.y)return!1;const m=qn(i,t,r[0]);return m!==qn(i,t,r[1])||m!==qn(i,t,r[2])||m!==qn(i,t,r[3])}function Ir(i,t,r){const s=t.paint.get(i).value;return s.kind==="constant"?s.value:r.programConfigurations.get(t.id).getMaxValue(i)}function ri(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Jc(i,t,r,s,h){if(!t[0]&&!t[1])return i;const m=q.convert(t)._mult(h);r==="viewport"&&m._rotate(-s);const y=[];for(let v=0;v<i.length;v++)y.push(i[v].sub(m));return y}function qf({queryGeometry:i,size:t},r){return Kc(i,r,t)}function Hf({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){return Kc(i,m,t*(r.projectTileCoordinates(m.x,m.y,s,h).signedDistanceFromCamera/r.cameraToCenterDistance))}function $f({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){const y=r.projectTileCoordinates(m.x,m.y,s,h).signedDistanceFromCamera,v=t*(r.cameraToCenterDistance/y);return Kc(i,th(m,r,s,h),v)}function Xf({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){return Kc(i,th(m,r,s,h),t)}function eh({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h,pitchAlignment:m="map",pitchScale:y="map"},v){const b=m==="map"?y==="map"?qf:Hf:y==="map"?$f:Xf,P={queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h};for(const A of v)for(const D of A)if(b(P,D))return!0;return!1}function th(i,t,r,s){const h=t.projectTileCoordinates(i.x,i.y,r,s).point;return new q((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}let zd,Id;_t("CircleBucket",Bs,{omit:["layers"]});var Yf={get paint(){return Id=Id||new ei({"circle-radius":new zt(xe.paint_circle["circle-radius"]),"circle-color":new zt(xe.paint_circle["circle-color"]),"circle-blur":new zt(xe.paint_circle["circle-blur"]),"circle-opacity":new zt(xe.paint_circle["circle-opacity"]),"circle-translate":new St(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new St(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new St(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new St(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zt(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zt(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zt(xe.paint_circle["circle-stroke-opacity"])})},get layout(){return zd=zd||new ei({"circle-sort-key":new zt(xe.layout_circle["circle-sort-key"])})}};class Ld extends xa{constructor(t,r){super(t,Yf,r)}createBucket(t){return new Bs(t)}queryRadius(t){const r=t;return Ir("circle-radius",this,r)+Ir("circle-stroke-width",this,r)+ri(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:v,getElevation:b}){const P=Jc(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,y),A=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s),D=this.paint.get("circle-pitch-scale"),L=this.paint.get("circle-pitch-alignment");let F,N;return L==="map"?(F=P,N=A*y):(F=(function(Z,X,ne,be){return Z.map((le=>th(le,X,ne,be)))})(P,m,v,b),N=A),eh({queryGeometry:F,size:N,transform:m,unwrappedTileID:v,getElevation:b,pitchAlignment:L,pitchScale:D},h)}}class Xh extends Bs{}let Yh;_t("HeatmapBucket",Xh,{omit:["layers"]});var Kf={get paint(){return Yh=Yh||new ei({"heatmap-radius":new zt(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zt(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new St(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fr(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new St(xe.paint_heatmap["heatmap-opacity"])})}};function nh(i,{width:t,height:r},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*r*s)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*r*s}`)}else h=new Uint8Array(t*r*s);return i.width=t,i.height=r,i.data=h,i}function rh(i,{width:t,height:r},s){if(t===i.width&&r===i.height)return;const h=nh({},{width:t,height:r},s);ih(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,r)},s),i.width=t,i.height=r,i.data=h.data}function ih(i,t,r,s,h,m){if(h.width===0||h.height===0)return t;if(h.width>i.width||h.height>i.height||r.x>i.width-h.width||r.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||s.x>t.width-h.width||s.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,v=t.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<h.height;b++){const P=((r.y+b)*i.width+r.x)*m,A=((s.y+b)*t.width+s.x)*m;for(let D=0;D<h.width*m;D++)v[A+D]=y[P+D]}return t}class lc{constructor(t,r){nh(this,t,1,r)}resize(t){rh(this,t,1)}clone(){return new lc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,h,m){ih(t,r,s,h,m,1)}}class ji{constructor(t,r){nh(this,t,4,r)}resize(t){rh(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new ji({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,h,m){ih(t,r,s,h,m,4)}setPixel(t,r,s){const h=4*(t*this.width+r);this.data[h+0]=Math.round(255*s.r/s.a),this.data[h+1]=Math.round(255*s.g/s.a),this.data[h+2]=Math.round(255*s.b/s.a),this.data[h+3]=Math.round(255*s.a)}}function kd(i){const t={},r=i.resolution||256,s=i.clips?i.clips.length:1,h=i.image||new ji({width:r,height:s});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(y,v,b)=>{t[i.evaluationKey]=b;const P=i.expression.evaluate(t);h.setPixel(y/4/r,v/4,P)};if(i.clips)for(let y=0,v=0;y<s;++y,v+=4*r)for(let b=0,P=0;b<r;b++,P+=4){const A=b/(r-1),{start:D,end:L}=i.clips[y];m(v,P,D*(1-A)+L*A)}else for(let y=0,v=0;y<r;y++,v+=4)m(0,v,y/(r-1));return h}_t("AlphaImage",lc),_t("RGBAImage",ji);const Lo="big-fb";class Od extends xa{createBucket(t){return new Xh(t)}constructor(t,r){super(t,Kf,r),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kd({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Lo)&&this.heatmapFbos.delete(Lo)}queryRadius(t){return Ir("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:v,getElevation:b}){return eh({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(r,s)*y,transform:m,unwrappedTileID:v,getElevation:b},h)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Qf;var Jf={get paint(){return Qf=Qf||new ei({"hillshade-illumination-direction":new St(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new St(xe.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new St(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new St(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new St(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new St(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new St(xe.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new St(xe.paint_hillshade["hillshade-method"])})}};class Fs extends xa{constructor(t,r){super(t,Jf,r),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,s=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const m=Math.max(t.length,r.length,s.length,h.length);t=t.concat(Array(m-t.length).fill(t.at(-1))),r=r.concat(Array(m-r.length).fill(r.at(-1))),s=s.concat(Array(m-s.length).fill(s.at(-1))),h=h.concat(Array(m-h.length).fill(h.at(-1)));const y=r.map(Za);return{directionRadians:t.map(Za),altitudeRadians:y,shadowColor:h,highlightColor:s}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Bd;var Kh={get paint(){return Bd=Bd||new ei({"color-relief-opacity":new St(xe["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new fr(xe["paint_color-relief"]["color-relief-color"])})}};class vu{constructor(t,r,s,h){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(r,h)}update(t,r,s){const{width:h,height:m}=t,y=!(this.size&&this.size[0]===h&&this.size[1]===m||s),{context:v}=this,{gl:b}=v;if(this.useMipmap=!!(r&&r.useMipmap),b.bindTexture(b.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!r||r.premultiply!==!1)),y)this.size=[h,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Kr(t)?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,t):b.texImage2D(b.TEXTURE_2D,0,this.format,h,m,0,this.format,b.UNSIGNED_BYTE,t.data);else{const{x:P,y:A}=s||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Kr(t)?b.texSubImage2D(b.TEXTURE_2D,0,P,A,b.RGBA,b.UNSIGNED_BYTE,t):b.texSubImage2D(b.TEXTURE_2D,0,P,A,h,m,b.RGBA,b.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&b.generateMipmap(b.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,r,s){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),s!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,s||t),this.filter=t),r!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Cr{constructor(t,r,s,h=1,m=1,y=1,v=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void un(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const b=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let P=0;P<b;P++)this.data[this._idx(-1,P)]=this.data[this._idx(0,P)],this.data[this._idx(b,P)]=this.data[this._idx(b-1,P)],this.data[this._idx(P,-1)]=this.data[this._idx(P,0)],this.data[this._idx(P,b)]=this.data[this._idx(P,b-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(b,-1)]=this.data[this._idx(b-1,0)],this.data[this._idx(-1,b)]=this.data[this._idx(0,b-1)],this.data[this._idx(b,b)]=this.data[this._idx(b-1,b-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let P=0;P<b;P++)for(let A=0;A<b;A++){const D=this.get(P,A);D>this.max&&(this.max=D),D<this.min&&(this.min=D)}}get(t,r){const s=new Uint8Array(this.data.buffer),h=4*this._idx(t,r);return this.unpack(s[h],s[h+1],s[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,s){return t*this.redFactor+r*this.greenFactor+s*this.blueFactor-this.baseShift}pack(t){return ep(t,this.getUnpackVector())}getPixels(){return new ji({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,y=s*this.dim,v=s*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(s){case-1:y=v-1;break;case 1:v=y+1}const b=-r*this.dim,P=-s*this.dim;for(let A=y;A<v;A++)for(let D=h;D<m;D++)this.data[this._idx(D,A)]=t.data[this._idx(D+b,A+P)]}}function ep(i,t){const r=t[0],s=t[1],h=t[2],m=t[3],y=Math.min(r,s,h),v=Math.round((i+m)/y);return{r:Math.floor(v*y/r)%256,g:Math.floor(v*y/s)%256,b:Math.floor(v*y/h)%256}}_t("DEMData",Cr);class tm extends xa{constructor(t,r){super(t,Kh,r)}_createColorRamp(t){const r={elevationStops:[],colorStops:[]},s=this._transitionablePaint._values["color-relief-color"].value.expression;if(s instanceof Xo&&s._styleExpression.expression instanceof di){this.colorRampExpression=s;const y=s._styleExpression.expression;r.elevationStops=y.labels,r.colorStops=[];for(const v of r.elevationStops)r.colorStops.push(y.evaluate({globals:{elevation:v}}))}if(r.elevationStops.length<1&&(r.elevationStops=[0],r.colorStops=[cn.transparent]),r.elevationStops.length<2&&(r.elevationStops.push(r.elevationStops[0]+1),r.colorStops.push(r.colorStops[0])),r.elevationStops.length<=t)return r;const h={elevationStops:[],colorStops:[]},m=(r.elevationStops.length-1)/(t-1);for(let y=0;y<r.elevationStops.length-.5;y+=m)h.elevationStops.push(r.elevationStops[Math.round(y)]),h.colorStops.push(r.colorStops[Math.round(y)]);return un(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,r,s){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(r),m=new ji({width:h.colorStops.length,height:1}),y=new ji({width:h.colorStops.length,height:1});for(let v=0;v<h.elevationStops.length;v++){const b=ep(h.elevationStops[v],s);y.setPixel(0,v,new cn(b.r/255,b.g/255,b.b/255,1)),m.setPixel(0,v,h.colorStops[v])}return this.colorRampTextures={elevationTexture:new vu(t,y,t.gl.RGBA),colorTexture:new vu(t,m,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const tp=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:ah}=tp;function os(i,t,r){const s=r.patternDependencies;let h=!1;for(const m of t){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,s[v.to]=!0,s[v.from]=!0)}return h}function Qh(i,t,r,s,h){const{zoom:m}=s,y=h.patternDependencies;for(const v of t){const b=v.paint.get(`${i}-pattern`).value;if(b.kind!=="constant"){let P=b.evaluate({zoom:m-1},r,{},h.availableImages),A=b.evaluate({zoom:m},r,{},h.availableImages),D=b.evaluate({zoom:m+1},r,{},h.availableImages);P=P&&P.name?P.name:P,A=A&&A.name?A.name:A,D=D&&D.name?D.name:D,y[P]=!0,y[A]=!0,y[D]=!0,r.patterns[v.id]={min:P,mid:A,max:D}}}return r}function Fd(i,t,r,s,h){let m;if(h===(function(y,v,b,P){let A=0;for(let D=v,L=b-P;D<b;D+=P)A+=(y[L]-y[D])*(y[D+1]+y[L+1]),L=D;return A})(i,t,r,s)>0)for(let y=t;y<r;y+=s)m=Wd(y/s|0,i[y],i[y+1],m);else for(let y=r-s;y>=t;y-=s)m=Wd(y/s|0,i[y],i[y+1],m);return m&&xu(m,m.next)&&(oh(m),m=m.next),m}function ko(i,t){if(!i)return i;t||(t=i);let r,s=i;do if(r=!1,s.steiner||!xu(s,s.next)&&Lr(s.prev,s,s.next)!==0)s=s.next;else{if(oh(s),s=t=s.prev,s===s.next)break;r=!0}while(r||s!==t);return t}function wa(i,t,r,s,h,m,y){if(!i)return;!y&&m&&(function(b,P,A,D){let L=b;do L.z===0&&(L.z=Oo(L.x,L.y,P,A,D)),L.prevZ=L.prev,L.nextZ=L.next,L=L.next;while(L!==b);L.prevZ.nextZ=null,L.prevZ=null,(function(F){let N,Z=1;do{let X,ne=F;F=null;let be=null;for(N=0;ne;){N++;let le=ne,fe=0;for(let Be=0;Be<Z&&(fe++,le=le.nextZ,le);Be++);let Re=Z;for(;fe>0||Re>0&&le;)fe!==0&&(Re===0||!le||ne.z<=le.z)?(X=ne,ne=ne.nextZ,fe--):(X=le,le=le.nextZ,Re--),be?be.nextZ=X:F=X,X.prevZ=be,be=X;ne=le}be.nextZ=null,Z*=2}while(N>1)})(L)})(i,s,h,m);let v=i;for(;i.prev!==i.next;){const b=i.prev,P=i.next;if(m?Nd(i,s,h,m):np(i))t.push(b.i,i.i,P.i),oh(i),i=P.next,v=P.next;else if((i=P)===v){y?y===1?wa(i=rp(ko(i),t),t,r,s,h,m,2):y===2&&Ud(i,t,r,s,h,m):wa(ko(i),t,r,s,h,m,1);break}}}function np(i){const t=i.prev,r=i,s=i.next;if(Lr(t,r,s)>=0)return!1;const h=t.x,m=r.x,y=s.x,v=t.y,b=r.y,P=s.y,A=Math.min(h,m,y),D=Math.min(v,b,P),L=Math.max(h,m,y),F=Math.max(v,b,P);let N=s.next;for(;N!==t;){if(N.x>=A&&N.x<=L&&N.y>=D&&N.y<=F&&uc(h,v,m,b,y,P,N.x,N.y)&&Lr(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function Nd(i,t,r,s){const h=i.prev,m=i,y=i.next;if(Lr(h,m,y)>=0)return!1;const v=h.x,b=m.x,P=y.x,A=h.y,D=m.y,L=y.y,F=Math.min(v,b,P),N=Math.min(A,D,L),Z=Math.max(v,b,P),X=Math.max(A,D,L),ne=Oo(F,N,t,r,s),be=Oo(Z,X,t,r,s);let le=i.prevZ,fe=i.nextZ;for(;le&&le.z>=ne&&fe&&fe.z<=be;){if(le.x>=F&&le.x<=Z&&le.y>=N&&le.y<=X&&le!==h&&le!==y&&uc(v,A,b,D,P,L,le.x,le.y)&&Lr(le.prev,le,le.next)>=0||(le=le.prevZ,fe.x>=F&&fe.x<=Z&&fe.y>=N&&fe.y<=X&&fe!==h&&fe!==y&&uc(v,A,b,D,P,L,fe.x,fe.y)&&Lr(fe.prev,fe,fe.next)>=0))return!1;fe=fe.nextZ}for(;le&&le.z>=ne;){if(le.x>=F&&le.x<=Z&&le.y>=N&&le.y<=X&&le!==h&&le!==y&&uc(v,A,b,D,P,L,le.x,le.y)&&Lr(le.prev,le,le.next)>=0)return!1;le=le.prevZ}for(;fe&&fe.z<=be;){if(fe.x>=F&&fe.x<=Z&&fe.y>=N&&fe.y<=X&&fe!==h&&fe!==y&&uc(v,A,b,D,P,L,fe.x,fe.y)&&Lr(fe.prev,fe,fe.next)>=0)return!1;fe=fe.nextZ}return!0}function rp(i,t){let r=i;do{const s=r.prev,h=r.next.next;!xu(s,h)&&Vd(s,r,r.next,h)&&ja(s,h)&&ja(h,s)&&(t.push(s.i,r.i,h.i),oh(r),oh(r.next),r=i=h),r=r.next}while(r!==i);return ko(r)}function Ud(i,t,r,s,h,m){let y=i;do{let v=y.next.next;for(;v!==y.prev;){if(y.i!==v.i&&Si(y,v)){let b=Gd(y,v);return y=ko(y,y.next),b=ko(b,b.next),wa(y,t,r,s,h,m,0),void wa(b,t,r,s,h,m,0)}v=v.next}y=y.next}while(y!==i)}function jd(i,t){let r=i.x-t.x;return r===0&&(r=i.y-t.y,r===0)&&(r=(i.next.y-i.y)/(i.next.x-i.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function Jh(i,t){const r=(function(h,m){let y=m;const v=h.x,b=h.y;let P,A=-1/0;if(xu(h,y))return y;do{if(xu(h,y.next))return y.next;if(b<=y.y&&b>=y.next.y&&y.next.y!==y.y){const Z=y.x+(b-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(Z<=v&&Z>A&&(A=Z,P=y.x<y.next.x?y:y.next,Z===v))return P}y=y.next}while(y!==m);if(!P)return null;const D=P,L=P.x,F=P.y;let N=1/0;y=P;do{if(v>=y.x&&y.x>=L&&v!==y.x&&ed(b<F?v:A,b,L,F,b<F?A:v,b,y.x,y.y)){const Z=Math.abs(b-y.y)/(v-y.x);ja(y,h)&&(Z<N||Z===N&&(y.x>P.x||y.x===P.x&&ip(P,y)))&&(P=y,N=Z)}y=y.next}while(y!==D);return P})(i,t);if(!r)return t;const s=Gd(r,i);return ko(s,s.next),ko(r,r.next)}function ip(i,t){return Lr(i.prev,i,t.prev)<0&&Lr(t.next,i,i.next)<0}function Oo(i,t,r,s,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Zr(i){let t=i,r=i;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==i);return r}function ed(i,t,r,s,h,m,y,v){return(h-y)*(t-v)>=(i-y)*(m-v)&&(i-y)*(s-v)>=(r-y)*(t-v)&&(r-y)*(m-v)>=(h-y)*(s-v)}function uc(i,t,r,s,h,m,y,v){return!(i===y&&t===v)&&ed(i,t,r,s,h,m,y,v)}function Si(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!(function(r,s){let h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==s.i&&h.next.i!==s.i&&Vd(h,h.next,r,s))return!0;h=h.next}while(h!==r);return!1})(i,t)&&(ja(i,t)&&ja(t,i)&&(function(r,s){let h=r,m=!1;const y=(r.x+s.x)/2,v=(r.y+s.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m})(i,t)&&(Lr(i.prev,i,t.prev)||Lr(i,t.prev,t))||xu(i,t)&&Lr(i.prev,i,i.next)>0&&Lr(t.prev,t,t.next)>0)}function Lr(i,t,r){return(t.y-i.y)*(r.x-t.x)-(t.x-i.x)*(r.y-t.y)}function xu(i,t){return i.x===t.x&&i.y===t.y}function Vd(i,t,r,s){const h=Vi(Lr(i,t,r)),m=Vi(Lr(i,t,s)),y=Vi(Lr(r,s,i)),v=Vi(Lr(r,s,t));return h!==m&&y!==v||!(h!==0||!dr(i,r,t))||!(m!==0||!dr(i,s,t))||!(y!==0||!dr(r,i,s))||!(v!==0||!dr(r,t,s))}function dr(i,t,r){return t.x<=Math.max(i.x,r.x)&&t.x>=Math.min(i.x,r.x)&&t.y<=Math.max(i.y,r.y)&&t.y>=Math.min(i.y,r.y)}function Vi(i){return i>0?1:i<0?-1:0}function ja(i,t){return Lr(i.prev,i,i.next)<0?Lr(i,t,i.next)>=0&&Lr(i,i.prev,t)>=0:Lr(i,t,i.prev)<0||Lr(i,i.next,t)<0}function Gd(i,t){const r=sh(i.i,i.x,i.y),s=sh(t.i,t.x,t.y),h=i.next,m=t.prev;return i.next=t,t.prev=i,r.next=h,h.prev=r,s.next=r,r.prev=s,m.next=s,s.prev=m,s}function Wd(i,t,r,s){const h=sh(i,t,r);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function oh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function sh(i,t,r){return{i,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Pi{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Sa{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Sa.noSubdivision=new Sa({fill:new Pi(0,0),line:new Pi(0,0),tile:new Pi(0,0),stencil:new Pi(0,0),circle:1}),_t("SubdivisionGranularityExpression",Pi),_t("SubdivisionGranularitySetting",Sa);const bu=-32768,Gi=32767;class ap{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=At/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|r+32768}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(t),h=0|Math.round(r),m=this._getKey(s,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const y=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,y),this._vertexBuffer.push(s,h),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(h,m){const y=[];for(let v=0;v<m.length;v+=3){const b=m[v],P=m[v+1],A=m[v+2],D=h[2*b],L=h[2*b+1];(h[2*P]-D)*(h[2*A+1]-L)-(h[2*P+1]-L)*(h[2*A]-D)>0?(y.push(b),y.push(A),y.push(P)):(y.push(b),y.push(P),y.push(A))}return y})(this._vertexBuffer,t);const r=[],s=t.length;for(let h=0;h<s;h+=3){const m=[t[h+0],t[h+1],t[h+2]],y=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,b=1/0,P=-1/0,A=-1/0;for(let Z=0;Z<3;Z++){const X=y[2*Z],ne=y[2*Z+1];v=Math.min(v,X),P=Math.max(P,X),b=Math.min(b,ne),A=Math.max(A,ne)}if(v===P||b===A)continue;const D=Math.floor(v/this._granularityCellSize),L=Math.ceil(P/this._granularityCellSize),F=Math.floor(b/this._granularityCellSize),N=Math.ceil(A/this._granularityCellSize);if(D!==L||F!==N)for(let Z=F;Z<N;Z++){const X=this._scanlineGenerateVertexRingForCellRow(Z,y,m);Rl(this._vertexBuffer,X,r)}else r.push(...m)}return r}_scanlineGenerateVertexRingForCellRow(t,r,s){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,y=[];for(let v=0;v<3;v++){const b=r[2*v],P=r[2*v+1],A=r[2*(v+1)%6],D=r[(2*(v+1)+1)%6],L=r[2*(v+2)%6],F=r[(2*(v+2)+1)%6],N=A-b,Z=D-P,X=N===0,ne=Z===0,be=(h-P)/Z,le=(m-P)/Z,fe=Math.min(be,le),Re=Math.max(be,le);if(!ne&&(fe>=1||Re<=0)||ne&&(P<h||P>m)){D>=h&&D<=m&&y.push(s[(v+1)%3]);continue}!ne&&fe>0&&y.push(this._vertexToIndex(b+N*fe,P+Z*fe));const Be=b+N*Math.max(fe,0),Ke=b+N*Math.min(Re,1);X||this._generateIntraEdgeVertices(y,b,P,A,D,Be,Ke),!ne&&Re<1&&y.push(this._vertexToIndex(b+N*Re,P+Z*Re)),(ne||D>=h&&D<=m)&&y.push(s[(v+1)%3]),!ne&&(D<=h||D>=m)&&this._generateInterEdgeVertices(y,b,P,A,D,L,F,Ke,h,m)}return y}_generateIntraEdgeVertices(t,r,s,h,m,y,v){const b=h-r,P=m-s,A=P===0,D=A?Math.min(r,h):Math.min(y,v),L=A?Math.max(r,h):Math.max(y,v),F=Math.floor(D/this._granularityCellSize)+1,N=Math.ceil(L/this._granularityCellSize)-1;if(A?r<h:y<v)for(let Z=F;Z<=N;Z++){const X=Z*this._granularityCellSize;t.push(this._vertexToIndex(X,s+P*(X-r)/b))}else for(let Z=N;Z>=F;Z--){const X=Z*this._granularityCellSize;t.push(this._vertexToIndex(X,s+P*(X-r)/b))}}_generateInterEdgeVertices(t,r,s,h,m,y,v,b,P,A){const D=m-s,L=y-h,F=v-m,N=(P-m)/F,Z=(A-m)/F,X=Math.min(N,Z),ne=Math.max(N,Z),be=h+L*X;let le=Math.floor(Math.min(be,b)/this._granularityCellSize)+1,fe=Math.ceil(Math.max(be,b)/this._granularityCellSize)-1,Re=b<be;const Be=F===0;if(Be&&(v===P||v===A))return;if(Be||X>=1||ne<=0){const dt=s-v,at=y+(r-y)*Math.min((P-v)/dt,(A-v)/dt);le=Math.floor(Math.min(at,b)/this._granularityCellSize)+1,fe=Math.ceil(Math.max(at,b)/this._granularityCellSize)-1,Re=b<at}const Ke=D>0?A:P;if(Re)for(let dt=le;dt<=fe;dt++)t.push(this._vertexToIndex(dt*this._granularityCellSize,Ke));else for(let dt=fe;dt>=le;dt--)t.push(this._vertexToIndex(dt*this._granularityCellSize,Ke))}_generateOutline(t){const r=[];for(const s of t){const h=Va(s,this._granularity,!0),m=this._pointArrayToIndices(h),y=[];for(let v=1;v<m.length;v++)y.push(m[v-1]),y.push(m[v]);r.push(y)}return r}_handlePoles(t){let r=!1,s=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(r||s)&&this._fillPoles(t,r,s)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const s=t[r+1];s===bu&&(t[r+1]=-32767),s===Gi&&(t[r+1]=32766)}}_generatePoleQuad(t,r,s,h,m,y){h>m!=(y===bu)?(t.push(r),t.push(s),t.push(this._vertexToIndex(h,y)),t.push(s),t.push(this._vertexToIndex(m,y)),t.push(this._vertexToIndex(h,y))):(t.push(s),t.push(r),t.push(this._vertexToIndex(h,y)),t.push(this._vertexToIndex(m,y)),t.push(s),t.push(this._vertexToIndex(h,y)))}_fillPoles(t,r,s){const h=this._vertexBuffer,m=At,y=t.length;for(let v=2;v<y;v+=3){const b=t[v-2],P=t[v-1],A=t[v],D=h[2*b],L=h[2*b+1],F=h[2*P],N=h[2*P+1],Z=h[2*A],X=h[2*A+1];r&&(L===0&&N===0&&this._generatePoleQuad(t,b,P,D,F,bu),N===0&&X===0&&this._generatePoleQuad(t,P,A,F,Z,bu),X===0&&L===0&&this._generatePoleQuad(t,A,b,Z,D,bu)),s&&(L===m&&N===m&&this._generatePoleQuad(t,b,P,D,F,Gi),N===m&&X===m&&this._generatePoleQuad(t,P,A,F,Z,Gi),X===m&&L===m&&this._generatePoleQuad(t,A,b,Z,D,Gi))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:h}=(function(v){const b=[],P=[];for(const A of v)if(A.length!==0){A!==v[0]&&b.push(P.length/2);for(let D=0;D<A.length;D++)P.push(A[D].x),P.push(A[D].y)}return{flattened:P,holeIndices:b}})(t);let m;this._initializeVertices(s);try{const v=(function(P,A,D=2){const L=A&&A.length,F=L?A[0]*D:P.length;let N=Fd(P,0,F,D,!0);const Z=[];if(!N||N.next===N.prev)return Z;let X,ne,be;if(L&&(N=(function(le,fe,Re,Be){const Ke=[];for(let dt=0,at=fe.length;dt<at;dt++){const ft=Fd(le,fe[dt]*Be,dt<at-1?fe[dt+1]*Be:le.length,Be,!1);ft===ft.next&&(ft.steiner=!0),Ke.push(Zr(ft))}Ke.sort(jd);for(let dt=0;dt<Ke.length;dt++)Re=Jh(Ke[dt],Re);return Re})(P,A,N,D)),P.length>80*D){X=P[0],ne=P[1];let le=X,fe=ne;for(let Re=D;Re<F;Re+=D){const Be=P[Re],Ke=P[Re+1];Be<X&&(X=Be),Ke<ne&&(ne=Ke),Be>le&&(le=Be),Ke>fe&&(fe=Ke)}be=Math.max(le-X,fe-ne),be=be!==0?32767/be:0}return wa(N,Z,D,X,ne,be,0),Z})(s,h),b=this._convertIndices(s,v);m=this._subdivideTrianglesScanline(b)}catch(v){console.error(v)}let y=[];return r&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:y}}_convertIndices(t,r){const s=[];for(let h=0;h<r.length;h++)s.push(this._vertexToIndex(t[2*r[h]],t[2*r[h]+1]));return s}_pointArrayToIndices(t){const r=[];for(let s=0;s<t.length;s++){const h=t[s];r.push(this._vertexToIndex(h.x,h.y))}return r}}function Ns(i,t,r,s=!0){return new ap(r,t).subdividePolygonInternal(i,s)}function Va(i,t,r=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const s=i[0],h=i[i.length-1],m=r&&(s.x!==h.x||s.y!==h.y);if(t<2)return m?[...i,i[0]]:[...i];const y=Math.floor(At/t),v=[];v.push(new q(i[0].x,i[0].y));const b=i.length,P=m?b:b-1;for(let A=0;A<P;A++){const D=i[A],L=A<b-1?i[A+1]:i[0],F=D.x,N=D.y,Z=L.x,X=L.y,ne=F!==Z,be=N!==X;if(!ne&&!be)continue;const le=Z-F,fe=X-N,Re=Math.abs(le),Be=Math.abs(fe);let Ke=F,dt=N;for(;;){const ft=le>0?(Math.floor(Ke/y)+1)*y:(Math.ceil(Ke/y)-1)*y,Rt=fe>0?(Math.floor(dt/y)+1)*y:(Math.ceil(dt/y)-1)*y,ot=Math.abs(Ke-ft),lt=Math.abs(dt-Rt),Ve=Math.abs(Ke-Z),Bt=Math.abs(dt-X),Ut=ne?ot/Re:Number.POSITIVE_INFINITY,Et=be?lt/Be:Number.POSITIVE_INFINITY;if((Ve<=ot||!ne)&&(Bt<=lt||!be))break;if(Ut<Et&&ne||!be){Ke=ft,dt+=fe*Ut;const Ct=new q(Ke,Math.round(dt));v[v.length-1].x===Ct.x&&v[v.length-1].y===Ct.y||v.push(Ct)}else{Ke+=le*Et,dt=Rt;const Ct=new q(Math.round(Ke),dt);v[v.length-1].x===Ct.x&&v[v.length-1].y===Ct.y||v.push(Ct)}}const at=new q(Z,X);v[v.length-1].x===at.x&&v[v.length-1].y===at.y||v.push(at)}return v}function Rl(i,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,h=i[2*t[0]];for(let b=1;b<t.length;b++){const P=i[2*t[b]];P<h&&(h=P,s=b)}const m=t.length;let y=s,v=(y+1)%m;for(;;){const b=y-1>=0?y-1:m-1,P=(v+1)%m,A=i[2*t[b]],D=i[2*t[P]],L=i[2*t[y]],F=i[2*t[y]+1],N=i[2*t[v]+1];let Z=!1;if(A<D)Z=!0;else if(A>D)Z=!1;else{const X=N-F,ne=-(i[2*t[v]]-L),be=F<N?1:-1;((A-L)*X+(i[2*t[b]+1]-F)*ne)*be>((D-L)*X+(i[2*t[P]+1]-F)*ne)*be&&(Z=!0)}if(Z){const X=t[b],ne=t[y],be=t[v];X!==ne&&X!==be&&ne!==be&&r.push(be,ne,X),y--,y<0&&(y=m-1)}else{const X=t[P],ne=t[y],be=t[v];X!==ne&&X!==be&&ne!==be&&r.push(be,ne,X),v++,v>=m&&(v=0)}if(b===P)break}}function td(i,t,r,s,h,m,y,v,b){const P=h.length/2,A=y&&v&&b;if(P<vn.MAX_VERTEX_ARRAY_LENGTH){const D=t.prepareSegment(P,r,s),L=D.vertexLength;for(let Z=0;Z<m.length;Z+=3)s.emplaceBack(L+m[Z],L+m[Z+1],L+m[Z+2]);let F,N;D.vertexLength+=P,D.primitiveLength+=m.length/3,A&&(N=y.prepareSegment(P,r,v),F=N.vertexLength,N.vertexLength+=P);for(let Z=0;Z<h.length;Z+=2)i(h[Z],h[Z+1]);if(A)for(let Z=0;Z<b.length;Z++){const X=b[Z];for(let ne=1;ne<X.length;ne+=2)v.emplaceBack(F+X[ne-1],F+X[ne]);N.primitiveLength+=X.length/2}}else(function(D,L,F,N,Z,X){const ne=[];for(let Be=0;Be<N.length/2;Be++)ne.push(-1);const be={count:0};let le=0,fe=D.getOrCreateLatestSegment(L,F),Re=fe.vertexLength;for(let Be=2;Be<Z.length;Be+=3){const Ke=Z[Be-2],dt=Z[Be-1],at=Z[Be];let ft=ne[Ke]<le,Rt=ne[dt]<le,ot=ne[at]<le;fe.vertexLength+((ft?1:0)+(Rt?1:0)+(ot?1:0))>vn.MAX_VERTEX_ARRAY_LENGTH&&(fe=D.createNewSegment(L,F),le=be.count,ft=!0,Rt=!0,ot=!0,Re=0);const lt=wu(ne,N,X,be,Ke,ft,fe),Ve=wu(ne,N,X,be,dt,Rt,fe),Bt=wu(ne,N,X,be,at,ot,fe);F.emplaceBack(Re+lt-le,Re+Ve-le,Re+Bt-le),fe.primitiveLength++}})(t,r,s,h,m,i),A&&(function(D,L,F,N,Z,X){const ne=[];for(let Be=0;Be<N.length/2;Be++)ne.push(-1);const be={count:0};let le=0,fe=D.getOrCreateLatestSegment(L,F),Re=fe.vertexLength;for(let Be=0;Be<Z.length;Be++){const Ke=Z[Be];for(let dt=1;dt<Z[Be].length;dt+=2){const at=Ke[dt-1],ft=Ke[dt];let Rt=ne[at]<le,ot=ne[ft]<le;fe.vertexLength+((Rt?1:0)+(ot?1:0))>vn.MAX_VERTEX_ARRAY_LENGTH&&(fe=D.createNewSegment(L,F),le=be.count,Rt=!0,ot=!0,Re=0);const lt=wu(ne,N,X,be,at,Rt,fe),Ve=wu(ne,N,X,be,ft,ot,fe);F.emplaceBack(Re+lt-le,Re+Ve-le),fe.primitiveLength++}}})(y,r,v,h,b,i),t.forceNewSegmentOnNextPrepare(),y?.forceNewSegmentOnNextPrepare()}function wu(i,t,r,s,h,m,y){if(m){const v=s.count;return r(t[2*h],t[2*h+1]),i[h]=s.count,s.count++,y.vertexLength++,v}return i[h]}class uo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ee,this.indexArray=new Nn,this.indexArray2=new $n,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.segments2=new vn,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.hasPattern=os("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:b,index:P,sourceLayerIndex:A}of t){const D=this.layers[0]._featureFilter.needGeometry,L=Os(v,D);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),L,s))continue;const F=m?h.evaluate(L,{},s,r.availableImages):void 0,N={id:b,properties:v.properties,type:v.type,sourceLayerIndex:A,index:P,geometry:D?L.geometry:ks(v),patterns:{},sortKey:F};y.push(N)}m&&y.sort(((v,b)=>v.sortKey-b.sortKey));for(const v of y){const{geometry:b,index:P,sourceLayerIndex:A}=v;if(this.hasPattern){const D=Qh("fill",this.layers,v,{zoom:this.zoom},r);this.patternFeatures.push(D)}else this.addFeature(v,b,P,s,{},r.subdivisionGranularity);r.featureIndex.insert(t[P].feature,b,P,A,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}addFeatures(t,r,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ah),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,s,h,m,y){for(const v of hl(r,500)){const b=Ns(v,h,y.fill.getGranularityForZoomLevel(h.z)),P=this.layoutVertexArray;td(((A,D)=>{P.emplaceBack(A,D)}),this.segments,this.layoutVertexArray,this.indexArray,b.verticesFlattened,b.indicesTriangles,this.segments2,this.indexArray2,b.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}}let Zd,Su;_t("FillBucket",uo,{omit:["layers","patternFeatures"]});var lh={get paint(){return Su=Su||new ei({"fill-antialias":new St(xe.paint_fill["fill-antialias"]),"fill-opacity":new zt(xe.paint_fill["fill-opacity"]),"fill-color":new zt(xe.paint_fill["fill-color"]),"fill-outline-color":new zt(xe.paint_fill["fill-outline-color"]),"fill-translate":new St(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new St(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ao(xe.paint_fill["fill-pattern"])})},get layout(){return Zd=Zd||new ei({"fill-sort-key":new zt(xe.layout_fill["fill-sort-key"])})}};class uh extends xa{constructor(t,r){super(t,lh,r)}recalculate(t,r){super.recalculate(t,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new uo(t)}queryRadius(){return ri(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:s,pixelsToTileUnits:h}){return Md(Jc(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,h),r)}isTileClipped(){return!0}}const cc=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),op=pr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:sp}=cc;class ss{constructor(t,r,s,h,m){this.properties={},this.extent=s,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=h,this._values=m,t.readFields(lp,this,r)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const r=t.readVarint()+t.pos,s=[];let h,m=1,y=0,v=0,b=0;for(;t.pos<r;){if(y<=0){const P=t.readVarint();m=7&P,y=P>>3}if(y--,m===1||m===2)v+=t.readSVarint(),b+=t.readSVarint(),m===1&&(h&&s.push(h),h=[]),h&&h.push(new q(v,b));else{if(m!==7)throw new Error(`unknown command ${m}`);h&&h.push(h[0].clone())}}return h&&s.push(h),s}bbox(){const t=this._pbf;t.pos=this._geometry;const r=t.readVarint()+t.pos;let s=1,h=0,m=0,y=0,v=1/0,b=-1/0,P=1/0,A=-1/0;for(;t.pos<r;){if(h<=0){const D=t.readVarint();s=7&D,h=D>>3}if(h--,s===1||s===2)m+=t.readSVarint(),y+=t.readSVarint(),m<v&&(v=m),m>b&&(b=m),y<P&&(P=y),y>A&&(A=y);else if(s!==7)throw new Error(`unknown command ${s}`)}return[v,P,b,A]}toGeoJSON(t,r,s){const h=this.extent*Math.pow(2,s),m=this.extent*t,y=this.extent*r,v=this.loadGeometry();function b(L){return[360*(L.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(L.y+y)/h)*Math.PI))-90]}function P(L){return L.map(b)}let A;if(this.type===1){const L=[];for(const N of v)L.push(N[0]);const F=P(L);A=L.length===1?{type:"Point",coordinates:F[0]}:{type:"MultiPoint",coordinates:F}}else if(this.type===2){const L=v.map(P);A=L.length===1?{type:"LineString",coordinates:L[0]}:{type:"MultiLineString",coordinates:L}}else{if(this.type!==3)throw new Error("unknown feature type");{const L=(function(N){const Z=N.length;if(Z<=1)return[N];const X=[];let ne,be;for(let le=0;le<Z;le++){const fe=nd(N[le]);fe!==0&&(be===void 0&&(be=fe<0),be===fe<0?(ne&&X.push(ne),ne=[N[le]]):ne&&ne.push(N[le]))}return ne&&X.push(ne),X})(v),F=[];for(const N of L)F.push(N.map(P));A=F.length===1?{type:"Polygon",coordinates:F[0]}:{type:"MultiPolygon",coordinates:F}}}const D={type:"Feature",geometry:A,properties:this.properties};return this.id!=null&&(D.id=this.id),D}}function lp(i,t,r){i===1?t.id=r.readVarint():i===2?(function(s,h){const m=s.readVarint()+s.pos;for(;s.pos<m;){const y=h._keys[s.readVarint()],v=h._values[s.readVarint()];h.properties[y]=v}})(r,t):i===3?t.type=r.readVarint():i===4&&(t._geometry=r.pos)}function nd(i){let t=0;for(let r,s,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],s=i[y],t+=(s.x-r.x)*(r.y+s.y);return t}ss.types=["Unknown","Point","LineString","Polygon"];class qd{constructor(t,r){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(nm,this,r),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const r=this._pbf.readVarint()+this._pbf.pos;return new ss(this._pbf,r,this.extent,this._keys,this._values)}}function nm(i,t,r){i===15?t.version=r.readVarint():i===1?t.name=r.readString():i===5?t.extent=r.readVarint():i===2?t._features.push(r.pos):i===3?t._keys.push(r.readString()):i===4&&t._values.push((function(s){let h=null;const m=s.readVarint()+s.pos;for(;s.pos<m;){const y=s.readVarint()>>3;h=y===1?s.readString():y===2?s.readFloat():y===3?s.readDouble():y===4?s.readVarint64():y===5?s.readVarint():y===6?s.readSVarint():y===7?s.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(r))}class up{constructor(t,r){this.layers=t.readFields(Xn,{},r)}}function Xn(i,t,r){if(i===3){const s=new qd(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}const or=Math.pow(2,13);function yn(i,t,r,s,h,m,y,v){i.emplaceBack(t,r,2*Math.floor(s*or)+y,h*or*2,m*or*2,Math.round(v))}class An{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.centroidVertexArray=new Le,this.indexArray=new Nn,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.features=[],this.hasPattern=os("fill-extrusion",this.layers,r);for(const{feature:h,id:m,index:y,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,P=Os(h,b);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),P,s))continue;const A={id:m,sourceLayerIndex:v,index:y,geometry:b?P.geometry:ks(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(Qh("fill-extrusion",this.layers,A,{zoom:this.zoom},r)):this.addFeature(A,A.geometry,y,s,{},r.subdivisionGranularity),r.featureIndex.insert(h,A.geometry,y,v,this.index,!0)}}addFeatures(t,r,s){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,r,s,t.subdivisionGranularity)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,sp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,op.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,s,h,m,y){for(const v of hl(r,500)){const b={x:0,y:0,sampleCount:0},P=this.layoutVertexArray.length;this.processPolygon(b,h,t,v,y);const A=this.layoutVertexArray.length-P,D=Math.floor(b.x/b.sampleCount),L=Math.floor(b.y/b.sampleCount);for(let F=0;F<A;F++)this.centroidVertexArray.emplaceBack(D,L)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}processPolygon(t,r,s,h,m){if(h.length<1||Us(h[0]))return;for(const D of h)D.length!==0&&Yn(t,D);const y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=m.fill.getGranularityForZoomLevel(r.z),b=ss.types[s.type]==="Polygon";for(const D of h){if(D.length===0||Us(D))continue;const L=Va(D,v,b);this._generateSideFaces(L,y)}if(!b)return;const P=Ns(h,r,v,!1),A=this.layoutVertexArray;td(((D,L)=>{yn(A,D,L,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,P.verticesFlattened,P.indicesTriangles)}_generateSideFaces(t,r){let s=0;for(let h=1;h<t.length;h++){const m=t[h],y=t[h-1];if(Ga(m,y))continue;r.segment.vertexLength+4>vn.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=m.sub(y)._perp()._unit(),b=y.dist(m);s+b>32768&&(s=0),yn(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,s),yn(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,s),s+=b,yn(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,0,s),yn(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,1,s);const P=r.segment.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function Yn(i,t){for(let r=0;r<t.length;r++){const s=t[r];r===t.length-1&&t[0].x===s.x&&t[0].y===s.y||(i.x+=s.x,i.y+=s.y,i.sampleCount++)}}function Ga(i,t){return i.x===t.x&&(i.x<0||i.x>At)||i.y===t.y&&(i.y<0||i.y>At)}function Us(i){return i.every((t=>t.x<0))||i.every((t=>t.x>At))||i.every((t=>t.y<0))||i.every((t=>t.y>At))}let Pu;_t("FillExtrusionBucket",An,{omit:["layers","features"]});var Hd={get paint(){return Pu=Pu||new ei({"fill-extrusion-opacity":new St(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zt(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new St(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new St(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ao(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zt(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zt(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new St(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class js extends xa{constructor(t,r){super(t,Hd,r)}createBucket(t){return new An(t)}queryRadius(){return ri(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,pixelPosMatrix:v}){const b=Jc(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,y),P=this.paint.get("fill-extrusion-height").evaluate(r,s),A=this.paint.get("fill-extrusion-base").evaluate(r,s),D=(function(F,N){const Z=[];for(const X of F){const ne=[X.x,X.y,0,1];er(ne,ne,N),Z.push(new q(ne[0]/ne[3],ne[1]/ne[3]))}return Z})(b,v),L=(function(F,N,Z,X){const ne=[],be=[],le=X[8]*N,fe=X[9]*N,Re=X[10]*N,Be=X[11]*N,Ke=X[8]*Z,dt=X[9]*Z,at=X[10]*Z,ft=X[11]*Z;for(const Rt of F){const ot=[],lt=[];for(const Ve of Rt){const Bt=Ve.x,Ut=Ve.y,Et=X[0]*Bt+X[4]*Ut+X[12],Ct=X[1]*Bt+X[5]*Ut+X[13],gn=X[2]*Bt+X[6]*Ut+X[14],Kn=X[3]*Bt+X[7]*Ut+X[15],$r=gn+Re,pi=Kn+Be,Ji=Et+Ke,ea=Ct+dt,mi=gn+at,Qn=Kn+ft,kr=new q((Et+le)/pi,(Ct+fe)/pi);kr.z=$r/pi,ot.push(kr);const ai=new q(Ji/Qn,ea/Qn);ai.z=mi/Qn,lt.push(ai)}ne.push(ot),be.push(lt)}return[ne,be]})(h,A,P,v);return(function(F,N,Z){let X=1/0;Md(Z,N)&&(X=Vs(Z,N[0]));for(let ne=0;ne<N.length;ne++){const be=N[ne],le=F[ne];for(let fe=0;fe<be.length-1;fe++){const Re=be[fe],Be=[Re,be[fe+1],le[fe+1],le[fe],Re];Yc(Z,Be)&&(X=Math.min(X,Vs(Z,Be)))}}return X!==1/0&&X})(L[0],L[1],D)}}function mr(i,t){return i.x*t.x+i.y*t.y}function Vs(i,t){if(i.length===1){let r=0;const s=t[r++];let h;for(;!h||s.equals(h);)if(h=t[r++],!h)return 1/0;for(;r<t.length;r++){const m=t[r],y=i[0],v=h.sub(s),b=m.sub(s),P=y.sub(s),A=mr(v,v),D=mr(v,b),L=mr(b,b),F=mr(P,v),N=mr(P,b),Z=A*L-D*D,X=(L*F-D*N)/Z,ne=(A*N-D*F)/Z,be=s.z*(1-X-ne)+h.z*X+m.z*ne;if(isFinite(be))return be}return 1/0}{let r=1/0;for(const s of t)r=Math.min(r,s.z);return r}}const Cu=pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:$d}=Cu,co=pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:hc}=co,ch=Math.cos(Math.PI/180*37.5),ha=Math.pow(2,14)/.5;class hh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((r=>{this.gradients[r.id]={}})),this.layoutVertexArray=new ct,this.layoutVertexArray2=new st,this.indexArray=new Nn,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.hasPattern=os("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:b,index:P,sourceLayerIndex:A}of t){const D=this.layers[0]._featureFilter.needGeometry,L=Os(v,D);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),L,s))continue;const F=m?h.evaluate(L,{},s):void 0,N={id:b,properties:v.properties,type:v.type,sourceLayerIndex:A,index:P,geometry:D?L.geometry:ks(v),patterns:{},sortKey:F};y.push(N)}m&&y.sort(((v,b)=>v.sortKey-b.sortKey));for(const v of y){const{geometry:b,index:P,sourceLayerIndex:A}=v;if(this.hasPattern){const D=Qh("line",this.layers,v,{zoom:this.zoom},r);this.patternFeatures.push(D)}else this.addFeature(v,b,P,s,{},r.subdivisionGranularity);r.featureIndex.insert(t[P].feature,b,P,A,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}addFeatures(t,r,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,hc)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,$d),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,s,h,m,y){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),P=v.get("line-cap"),A=v.get("line-miter-limit"),D=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const L of r)this.addLine(L,t,b,P,A,D,h,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}addLine(t,r,s,h,m,y,v,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Va(t,v?b.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let le=0;le<t.length-1;le++)this.totalDistance+=t[le].dist(t[le+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const P=ss.types[r.type]==="Polygon";let A=t.length;for(;A>=2&&t[A-1].equals(t[A-2]);)A--;let D=0;for(;D<A-1&&t[D].equals(t[D+1]);)D++;if(A<(P?3:2))return;s==="bevel"&&(m=1.05);const L=this.overscaling<=16?122880/(512*this.overscaling):0,F=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let N,Z,X,ne,be;this.e1=this.e2=-1,P&&(N=t[A-2],be=t[D].sub(N)._unit()._perp());for(let le=D;le<A;le++){if(X=le===A-1?P?t[D+1]:void 0:t[le+1],X&&t[le].equals(X))continue;be&&(ne=be),N&&(Z=N),N=t[le],be=X?X.sub(N)._unit()._perp():ne,ne=ne||be;let fe=ne.add(be);fe.x===0&&fe.y===0||fe._unit();const Re=ne.x*be.x+ne.y*be.y,Be=fe.x*be.x+fe.y*be.y,Ke=Be!==0?1/Be:1/0,dt=2*Math.sqrt(2-2*Be),at=Be<ch&&Z&&X,ft=ne.x*be.y-ne.y*be.x>0;if(at&&le>D){const lt=N.dist(Z);if(lt>2*L){const Ve=N.sub(N.sub(Z)._mult(L/lt)._round());this.updateDistance(Z,Ve),this.addCurrentVertex(Ve,ne,0,0,F),Z=Ve}}const Rt=Z&&X;let ot=Rt?s:P?"butt":h;if(Rt&&ot==="round"&&(Ke<y?ot="miter":Ke<=2&&(ot="fakeround")),ot==="miter"&&Ke>m&&(ot="bevel"),ot==="bevel"&&(Ke>2&&(ot="flipbevel"),Ke<m&&(ot="miter")),Z&&this.updateDistance(Z,N),ot==="miter")fe._mult(Ke),this.addCurrentVertex(N,fe,0,0,F);else if(ot==="flipbevel"){if(Ke>100)fe=be.mult(-1);else{const lt=Ke*ne.add(be).mag()/ne.sub(be).mag();fe._perp()._mult(lt*(ft?-1:1))}this.addCurrentVertex(N,fe,0,0,F),this.addCurrentVertex(N,fe.mult(-1),0,0,F)}else if(ot==="bevel"||ot==="fakeround"){const lt=-Math.sqrt(Ke*Ke-1),Ve=ft?lt:0,Bt=ft?0:lt;if(Z&&this.addCurrentVertex(N,ne,Ve,Bt,F),ot==="fakeround"){const Ut=Math.round(180*dt/Math.PI/20);for(let Et=1;Et<Ut;Et++){let Ct=Et/Ut;if(Ct!==.5){const Kn=Ct-.5;Ct+=Ct*Kn*(Ct-1)*((1.0904+Re*(Re*(3.55645-1.43519*Re)-3.2452))*Kn*Kn+(.848013+Re*(.215638*Re-1.06021)))}const gn=be.sub(ne)._mult(Ct)._add(ne)._unit()._mult(ft?-1:1);this.addHalfVertex(N,gn.x,gn.y,!1,ft,0,F)}}X&&this.addCurrentVertex(N,be,-Ve,-Bt,F)}else if(ot==="butt")this.addCurrentVertex(N,fe,0,0,F);else if(ot==="square"){const lt=Z?1:-1;this.addCurrentVertex(N,fe,lt,lt,F)}else ot==="round"&&(Z&&(this.addCurrentVertex(N,ne,0,0,F),this.addCurrentVertex(N,ne,1,1,F,!0)),X&&(this.addCurrentVertex(N,be,-1,-1,F,!0),this.addCurrentVertex(N,be,0,0,F)));if(at&&le<A-1){const lt=N.dist(X);if(lt>2*L){const Ve=N.add(X.sub(N)._mult(L/lt)._round());this.updateDistance(N,Ve),this.addCurrentVertex(Ve,be,0,0,F),N=Ve}}}}addCurrentVertex(t,r,s,h,m,y=!1){const v=r.y*h-r.x,b=-r.y-r.x*h;this.addHalfVertex(t,r.x+r.y*s,r.y-r.x*s,y,!1,s,m),this.addHalfVertex(t,v,b,y,!0,-h,m),this.distance>ha/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,s,h,m,y))}addHalfVertex({x:t,y:r},s,h,m,y,v,b){const P=.5*(this.lineClips?this.scaledDistance*(ha-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(r<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const A=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,A,this.e2),b.primitiveLength++),y?this.e2=A:this.e1=A}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let rd,dh;_t("LineBucket",hh,{omit:["layers","patternFeatures"]});var fh={get paint(){return dh=dh||new ei({"line-opacity":new zt(xe.paint_line["line-opacity"]),"line-color":new zt(xe.paint_line["line-color"]),"line-translate":new St(xe.paint_line["line-translate"]),"line-translate-anchor":new St(xe.paint_line["line-translate-anchor"]),"line-width":new zt(xe.paint_line["line-width"]),"line-gap-width":new zt(xe.paint_line["line-gap-width"]),"line-offset":new zt(xe.paint_line["line-offset"]),"line-blur":new zt(xe.paint_line["line-blur"]),"line-dasharray":new Xc(xe.paint_line["line-dasharray"]),"line-pattern":new Ao(xe.paint_line["line-pattern"]),"line-gradient":new fr(xe.paint_line["line-gradient"])})},get layout(){return rd=rd||new ei({"line-cap":new St(xe.layout_line["line-cap"]),"line-join":new zt(xe.layout_line["line-join"]),"line-miter-limit":new St(xe.layout_line["line-miter-limit"]),"line-round-limit":new St(xe.layout_line["line-round-limit"]),"line-sort-key":new zt(xe.layout_line["line-sort-key"])})}};class Dl extends zt{possiblyEvaluate(t,r){return r=new Ln(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,s,h){return r=Vt({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,s,h)}}let ii;class zl extends xa{constructor(t,r){super(t,fh,r),this.gradientVersion=0,ii||(ii=new Dl(fh.paint.properties["line-width"].specification),ii.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!(function(s){return s._styleExpression!==void 0})(r)&&r._styleExpression.expression instanceof wr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=ii.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new hh(t)}queryRadius(t){const r=t,s=Tu(Ir("line-width",this,r),Ir("line-gap-width",this,r)),h=Ir("line-offset",this,r);return s/2+Math.abs(h)+ri(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y}){const v=Jc(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,y),b=y/2*Tu(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),P=this.paint.get("line-offset").evaluate(r,s);return P&&(h=(function(A,D){const L=[];for(let F=0;F<A.length;F++){const N=A[F],Z=[];for(let X=0;X<N.length;X++){const ne=N[X-1],be=N[X],le=N[X+1],fe=X===0?new q(0,0):be.sub(ne)._unit()._perp(),Re=X===N.length-1?new q(0,0):le.sub(be)._unit()._perp(),Be=fe._add(Re)._unit(),Ke=Be.x*Re.x+Be.y*Re.y;Ke!==0&&Be._mult(1/Ke),Z.push(Be._mult(D)._add(be))}L.push(Z)}return L})(h,P*y)),(function(A,D,L){for(let F=0;F<D.length;F++){const N=D[F];if(A.length>=3){for(let Z=0;Z<N.length;Z++)if(sc(A,N[Z]))return!0}if(Gf(A,N,L))return!0}return!1})(v,h,b)}isTileClipped(){return!0}}function Tu(i,t){return t>0?t+2*i:i}const dc=pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Xd=pr([{name:"a_projected_pos",components:3,type:"Float32"}],4);pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Yd=pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Kd=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ph=pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Qd(i,t,r){return i.sections.forEach((s=>{s.text=(function(h,m,y){const v=m.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Oa.applyArabicShaping&&(h=Oa.applyArabicShaping(h)),h})(s.text,t,r)})),i}pr([{name:"triangle",components:3,type:"Uint16"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pr([{type:"Float32",name:"offsetX"}]),pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Wi={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var qr=24;const da=4294967296,Jd=1/da,ef=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class tf{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,r,s=this.length){for(;this.pos<s;){const h=this.readVarint(),m=h>>3,y=this.pos;this.type=7&h,t(m,r,this),this.pos===y&&this.skip(h)}return r}readMessage(t,r){return this.readFields(t,r,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*da;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*da;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const r=this.buf;let s,h;return h=r[this.pos++],s=127&h,h<128?s:(h=r[this.pos++],s|=(127&h)<<7,h<128?s:(h=r[this.pos++],s|=(127&h)<<14,h<128?s:(h=r[this.pos++],s|=(127&h)<<21,h<128?s:(h=r[this.pos],s|=(15&h)<<28,(function(m,y,v){const b=v.buf;let P,A;if(A=b[v.pos++],P=(112&A)>>4,A<128||(A=b[v.pos++],P|=(127&A)<<3,A<128)||(A=b[v.pos++],P|=(127&A)<<10,A<128)||(A=b[v.pos++],P|=(127&A)<<17,A<128)||(A=b[v.pos++],P|=(127&A)<<24,A<128)||(A=b[v.pos++],P|=(1&A)<<31,A<128))return Wa(m,P,y);throw new Error("Expected varint not more than 10 bytes")})(s,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&ef?ef.decode(this.buf.subarray(r,t)):(function(s,h,m){let y="",v=h;for(;v<m;){const b=s[v];let P,A,D,L=null,F=b>239?4:b>223?3:b>191?2:1;if(v+F>m)break;F===1?b<128&&(L=b):F===2?(P=s[v+1],(192&P)==128&&(L=(31&b)<<6|63&P,L<=127&&(L=null))):F===3?(P=s[v+1],A=s[v+2],(192&P)==128&&(192&A)==128&&(L=(15&b)<<12|(63&P)<<6|63&A,(L<=2047||L>=55296&&L<=57343)&&(L=null))):F===4&&(P=s[v+1],A=s[v+2],D=s[v+3],(192&P)==128&&(192&A)==128&&(192&D)==128&&(L=(15&b)<<18|(63&P)<<12|(63&A)<<6|63&D,(L<=65535||L>=1114112)&&(L=null))),L===null?(L=65533,F=1):L>65535&&(L-=65536,y+=String.fromCharCode(L>>>10&1023|55296),L=56320|1023&L),y+=String.fromCharCode(L),v+=F}return y})(this.buf,r,t)}readBytes(){const t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r}readPackedVarint(t=[],r){const s=this.readPackedEnd();for(;this.pos<s;)t.push(this.readVarint(r));return t}readPackedSVarint(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const r=7&t;if(r===0)for(;this.buf[this.pos++]>127;);else if(r===2)this.pos=this.readVarint()+this.pos;else if(r===5)this.pos+=4;else{if(r!==1)throw new Error(`Unimplemented type: ${r}`);this.pos+=8}}writeTag(t,r){this.writeVarint(t<<3|r)}realloc(t){let r=this.length||16;for(;r<this.pos+t;)r*=2;if(r!==this.length){const s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=r}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Jd),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Jd),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(r,s){let h,m;if(r>=0?(h=r%4294967296|0,m=r/4294967296|0):(h=~(-r%4294967296),m=~(-r/4294967296),4294967295^h?h=h+1|0:(h=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,v,b){b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,y>>>=7,b.buf[b.pos++]=127&y|128,b.buf[b.pos]=127&(y>>>=7)})(h,0,s),(function(y,v){const b=(7&y)<<4;v.buf[v.pos++]|=b|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))})(m,s)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const r=this.pos;this.pos=(function(h,m,y){for(let v,b,P=0;P<m.length;P++){if(v=m.charCodeAt(P),v>55295&&v<57344){if(!b){v>56319||P+1===m.length?(h[y++]=239,h[y++]=191,h[y++]=189):b=v;continue}if(v<56320){h[y++]=239,h[y++]=191,h[y++]=189,b=v;continue}v=b-55296<<10|v-56320|65536,b=null}else b&&(h[y++]=239,h[y++]=191,h[y++]=189,b=null);v<128?h[y++]=v:(v<2048?h[y++]=v>>6|192:(v<65536?h[y++]=v>>12|224:(h[y++]=v>>18|240,h[y++]=v>>12&63|128),h[y++]=v>>6&63|128),h[y++]=63&v|128)}return y})(this.buf,t,this.pos);const s=this.pos-r;s>=128&&mh(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const r=t.length;this.writeVarint(r),this.realloc(r);for(let s=0;s<r;s++)this.buf[this.pos++]=t[s]}writeRawMessage(t,r){this.pos++;const s=this.pos;t(r,this);const h=this.pos-s;h>=128&&mh(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h}writeMessage(t,r,s){this.writeTag(t,2),this.writeRawMessage(r,s)}writePackedVarint(t,r){r.length&&this.writeMessage(t,nf,r)}writePackedSVarint(t,r){r.length&&this.writeMessage(t,fc,r)}writePackedBoolean(t,r){r.length&&this.writeMessage(t,dp,r)}writePackedFloat(t,r){r.length&&this.writeMessage(t,cp,r)}writePackedDouble(t,r){r.length&&this.writeMessage(t,hp,r)}writePackedFixed32(t,r){r.length&&this.writeMessage(t,rf,r)}writePackedSFixed32(t,r){r.length&&this.writeMessage(t,af,r)}writePackedFixed64(t,r){r.length&&this.writeMessage(t,rm,r)}writePackedSFixed64(t,r){r.length&&this.writeMessage(t,im,r)}writeBytesField(t,r){this.writeTag(t,2),this.writeBytes(r)}writeFixed32Field(t,r){this.writeTag(t,5),this.writeFixed32(r)}writeSFixed32Field(t,r){this.writeTag(t,5),this.writeSFixed32(r)}writeFixed64Field(t,r){this.writeTag(t,1),this.writeFixed64(r)}writeSFixed64Field(t,r){this.writeTag(t,1),this.writeSFixed64(r)}writeVarintField(t,r){this.writeTag(t,0),this.writeVarint(r)}writeSVarintField(t,r){this.writeTag(t,0),this.writeSVarint(r)}writeStringField(t,r){this.writeTag(t,2),this.writeString(r)}writeFloatField(t,r){this.writeTag(t,5),this.writeFloat(r)}writeDoubleField(t,r){this.writeTag(t,1),this.writeDouble(r)}writeBooleanField(t,r){this.writeVarintField(t,+r)}}function Wa(i,t,r){return r?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function mh(i,t,r){const s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(let h=r.pos-1;h>=i;h--)r.buf[h+s]=r.buf[h]}function nf(i,t){for(let r=0;r<i.length;r++)t.writeVarint(i[r])}function fc(i,t){for(let r=0;r<i.length;r++)t.writeSVarint(i[r])}function cp(i,t){for(let r=0;r<i.length;r++)t.writeFloat(i[r])}function hp(i,t){for(let r=0;r<i.length;r++)t.writeDouble(i[r])}function dp(i,t){for(let r=0;r<i.length;r++)t.writeBoolean(i[r])}function rf(i,t){for(let r=0;r<i.length;r++)t.writeFixed32(i[r])}function af(i,t){for(let r=0;r<i.length;r++)t.writeSFixed32(i[r])}function rm(i,t){for(let r=0;r<i.length;r++)t.writeFixed64(i[r])}function im(i,t){for(let r=0;r<i.length;r++)t.writeSFixed64(i[r])}function am(i,t,r){i===1&&r.readMessage(fp,t)}function fp(i,t,r){if(i===3){const{id:s,bitmap:h,width:m,height:y,left:v,top:b,advance:P}=r.readMessage(pp,{});t.push({id:s,bitmap:new lc({width:m+6,height:y+6},h),metrics:{width:m,height:y,left:v,top:b,advance:P}})}}function pp(i,t,r){i===1?t.id=r.readVarint():i===2?t.bitmap=r.readBytes():i===3?t.width=r.readVarint():i===4?t.height=r.readVarint():i===5?t.left=r.readSVarint():i===6?t.top=r.readSVarint():i===7&&(t.advance=r.readVarint())}function Au(i){let t=0,r=0;for(const y of i)t+=y.w*y.h,r=Math.max(r,y.w);i.sort(((y,v)=>v.h-y.h));const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let h=0,m=0;for(const y of i)for(let v=s.length-1;v>=0;v--){const b=s[v];if(!(y.w>b.w||y.h>b.h)){if(y.x=b.x,y.y=b.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===b.w&&y.h===b.h){const P=s.pop();P&&v<s.length&&(s[v]=P)}else y.h===b.h?(b.x+=y.w,b.w-=y.w):y.w===b.w?(b.y+=y.h,b.h-=y.h):(s.push({x:b.x+y.w,y:b.y,w:b.w-y.w,h:y.h}),b.y+=y.h,b.h-=y.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}class pc{constructor(t,{pixelRatio:r,version:s,stretchX:h,stretchY:m,content:y,textFitWidth:v,textFitHeight:b}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=y,this.version=s,this.textFitWidth=v,this.textFitHeight=b}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class of{constructor(t,r){const s={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,s,m),this.addImages(r,h,m);const{w:y,h:v}=Au(m),b=new ji({width:y||1,height:v||1});for(const P in t){const A=t[P],D=s[P].paddedRect;ji.copy(A.data,b,{x:0,y:0},{x:D.x+1,y:D.y+1},A.data)}for(const P in r){const A=r[P],D=h[P].paddedRect,L=D.x+1,F=D.y+1,N=A.data.width,Z=A.data.height;ji.copy(A.data,b,{x:0,y:0},{x:L,y:F},A.data),ji.copy(A.data,b,{x:0,y:Z-1},{x:L,y:F-1},{width:N,height:1}),ji.copy(A.data,b,{x:0,y:0},{x:L,y:F+Z},{width:N,height:1}),ji.copy(A.data,b,{x:N-1,y:0},{x:L-1,y:F},{width:1,height:Z}),ji.copy(A.data,b,{x:0,y:0},{x:L+N,y:F},{width:1,height:Z})}this.image=b,this.iconPositions=s,this.patternPositions=h}addImages(t,r,s){for(const h in t){const m=t[h],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};s.push(y),r[h]=new pc(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),r)}patchUpdatedImage(t,r,s){if(!t||!r||t.version===r.version)return;t.version=r.version;const[h,m]=t.tl;s.update(r.data,void 0,{x:h,y:m})}}var Gs;_t("ImagePosition",pc),_t("ImageAtlas",of),E.ao=void 0,(Gs=E.ao||(E.ao={}))[Gs.none=0]="none",Gs[Gs.horizontal=1]="horizontal",Gs[Gs.vertical=2]="vertical",Gs[Gs.horizontalOnly=3]="horizontalOnly";class mc{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,s){const h=new mc;return h.scale=t||1,h.fontStack=r,h.verticalAlign=s||"bottom",h}static forImage(t,r){const s=new mc;return s.imageName=t,s.verticalAlign=r||"bottom",s}}class Eu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const s=new Eu;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?s.addImageSection(m):s.addTextSection(m,r)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let r="";for(let s=0;s<t.length;s++){const h=t.charCodeAt(s+1)||null,m=t.charCodeAt(s-1)||null;r+=h&&Ds(h)&&!Wi[t[s+1]]||m&&Ds(m)&&!Wi[t[s-1]]||!Wi[t[s]]?t[s]:Wi[t[s]]}return r})(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&yh[this.text.charCodeAt(s)];s++)t++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&yh[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const s=new Eu;return s.text=this.text.substring(t,r),s.sectionIndex=this.sectionIndex.slice(t,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,r)=>Math.max(t,this.sections[r].scale)),0)}getMaxImageSize(t){let r=0,s=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const y=t[m.imageName];if(!y)continue;const v=y.displaySize;r=Math.max(r,v[0]),s=Math.max(s,v[1])}}return{maxImageWidth:r,maxImageHeight:s}}addTextSection(t,r){this.text+=t.text,this.sections.push(mc.forText(t.scale,t.fontStack||r,t.verticalAlign));const s=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(s)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void un("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(mc.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):un("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function gh(i,t,r,s,h,m,y,v,b,P,A,D,L,F,N){const Z=Eu.fromFeature(i,h);let X;D===E.ao.vertical&&Z.verticalizePunctuation();const{processBidirectionalText:ne,processStyledBidirectionalText:be}=Oa;if(ne&&Z.sections.length===1){X=[];const Re=ne(Z.toString(),cf(Z,P,m,t,s,F));for(const Be of Re){const Ke=new Eu;Ke.text=Be,Ke.sections=Z.sections;for(let dt=0;dt<Be.length;dt++)Ke.sectionIndex.push(0);X.push(Ke)}}else if(be){X=[];const Re=be(Z.text,Z.sectionIndex,cf(Z,P,m,t,s,F));for(const Be of Re){const Ke=new Eu;Ke.text=Be[0],Ke.sectionIndex=Be[1],Ke.sections=Z.sections,X.push(Ke)}}else X=(function(Re,Be){const Ke=[],dt=Re.text;let at=0;for(const ft of Be)Ke.push(Re.substring(at,ft)),at=ft;return at<dt.length&&Ke.push(Re.substring(at,dt.length)),Ke})(Z,cf(Z,P,m,t,s,F));const le=[],fe={positionedLines:le,text:Z.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:D,iconsInText:!1,verticalizable:!1};return(function(Re,Be,Ke,dt,at,ft,Rt,ot,lt,Ve,Bt,Ut){let Et=0,Ct=0,gn=0,Kn=0;const $r=ot==="right"?1:ot==="left"?0:.5,pi=qr/Ut;let Ji=0;for(const Qn of at){Qn.trim();const kr=Qn.getMaxScale(),ai={positionedGlyphs:[],lineOffset:0};Re.positionedLines[Ji]=ai;const Or=ai.positionedGlyphs;let Ti=0;if(!Qn.length()){Ct+=ft,++Ji;continue}const ta=om(dt,Qn,pi);for(let pa=0;pa<Qn.length();pa++){const Tr=Qn.getSection(pa),n=Qn.getSectionIndex(pa),o=Qn.getCharCode(pa),u=gc(lt,Bt,o);let p;if(Tr.imageName){if(Re.iconsInText=!0,Tr.scale=Tr.scale*pi,p=ad(Tr,u,kr,ta,dt),!p)continue;Ti=Math.max(Ti,p.imageOffset)}else if(p=df(Tr,o,u,ta,Be,Ke),!p)continue;const{rect:x,metrics:C,baselineOffset:O}=p;Or.push({glyph:o,imageName:Tr.imageName,x:Et,y:Ct+O+-17,vertical:u,scale:Tr.scale,fontStack:Tr.fontStack,sectionIndex:n,metrics:C,rect:x}),u?(Re.verticalizable=!0,Et+=(Tr.imageName?C.advance:qr)*Tr.scale+Ve):Et+=C.advance*Tr.scale+Ve}Or.length!==0&&(gn=Math.max(Et-Ve,gn),ff(Or,0,Or.length-1,$r)),Et=0,ai.lineOffset=Math.max(Ti,(kr-1)*qr);const Xr=ft*kr+Ti;Ct+=Xr,Kn=Math.max(Xr,Kn),++Ji}const{horizontalAlign:ea,verticalAlign:mi}=hf(Rt);(function(Qn,kr,ai,Or,Ti,ta,Xr,pa,Tr){const n=(kr-ai)*Ti;let o=0;o=ta!==Xr?-pa*Or- -17:-Or*Tr*Xr+.5*Xr;for(const u of Qn)for(const p of u.positionedGlyphs)p.x+=n,p.y+=o})(Re.positionedLines,$r,ea,mi,gn,Kn,ft,Ct,at.length),Re.top+=-mi*Ct,Re.bottom=Re.top+Ct,Re.left+=-ea*gn,Re.right=Re.left+gn})(fe,t,r,s,X,y,v,b,D,P,L,N),!(function(Re){for(const Be of Re)if(Be.positionedGlyphs.length!==0)return!1;return!0})(le)&&fe}const yh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},id={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},mp={40:!0};function sf(i,t,r,s,h,m){if(t.imageName){const y=s[t.imageName];return y?y.displaySize[0]*t.scale*qr/m+h:0}{const y=r[t.fontStack],v=y&&y[i];return v?v.metrics.advance*t.scale+h:0}}function sr(i,t,r,s){const h=Math.pow(i-t,2);return s?i<t?h/2:2*h:h+Math.abs(r)*r}function lf(i,t,r){let s=0;return i===10&&(s-=1e4),r&&(s+=150),i!==40&&i!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function gp(i,t,r,s,h,m){let y=null,v=sr(t,r,h,m);for(const b of s){const P=sr(t-b.x,r,h,m)+b.badness;P<=v&&(y=b,v=P)}return{index:i,x:t,priorBreak:y,badness:v}}function uf(i){return i?uf(i.priorBreak).concat(i.index):[]}function cf(i,t,r,s,h,m){if(!i)return[];const y=[],v=(function(D,L,F,N,Z,X){let ne=0;for(let be=0;be<D.length();be++){const le=D.getSection(be);ne+=sf(D.getCharCode(be),le,N,Z,L,X)}return ne/Math.max(1,Math.ceil(ne/F))})(i,t,r,s,h,m),b=i.text.indexOf("​")>=0;let P=0;for(let D=0;D<i.length();D++){const L=i.getSection(D),F=i.getCharCode(D);if(yh[F]||(P+=sf(F,L,s,h,t,m)),D<i.length()-1){const N=!((A=F)<11904)&&(!!en["CJK Compatibility Forms"](A)||!!en["CJK Compatibility"](A)||!!en["CJK Strokes"](A)||!!en["CJK Symbols and Punctuation"](A)||!!en["Enclosed CJK Letters and Months"](A)||!!en["Halfwidth and Fullwidth Forms"](A)||!!en["Ideographic Description Characters"](A)||!!en["Vertical Forms"](A)||ec.test(String.fromCodePoint(A)));(id[F]||N||L.imageName||D!==i.length()-2&&mp[i.getCharCode(D+1)])&&y.push(gp(D+1,P,v,y,lf(F,i.getCharCode(D+1),N&&b),!1))}}var A;return uf(gp(i.length(),P,v,y,0,!0))}function hf(i){let t=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function om(i,t,r){const s=t.getMaxScale()*qr,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(i),y=Math.max(s,m*r);return{verticalLineContentWidth:Math.max(s,h*r),horizontalLineContentHeight:y}}function _h(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function gc(i,t,r){return!(i===E.ao.horizontal||!t&&!gu(r)||t&&(yh[r]||(s=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(s)))));var s}function df(i,t,r,s,h,m){const y=m[i.fontStack],v=(function(P,A,D,L){if(P&&P.rect)return P;const F=A[D.fontStack],N=F&&F[L];return N?{rect:null,metrics:N.metrics}:null})(y&&y[t],h,i,t);if(v===null)return null;let b;if(r)b=s.verticalLineContentWidth-i.scale*qr;else{const P=_h(i.verticalAlign);b=(s.horizontalLineContentHeight-i.scale*qr)*P}return{rect:v.rect,metrics:v.metrics,baselineOffset:b}}function ad(i,t,r,s,h){const m=h[i.imageName];if(!m)return null;const y=m.paddedRect,v=m.displaySize,b={width:v[0],height:v[1],left:1,top:-3,advance:t?v[1]:v[0]};let P;if(t)P=s.verticalLineContentWidth-v[1]*i.scale;else{const A=_h(i.verticalAlign);P=(s.horizontalLineContentHeight-v[1]*i.scale)*A}return{rect:y,metrics:b,baselineOffset:P,imageOffset:(t?v[0]:v[1])*i.scale-qr*r}}function ff(i,t,r,s){if(s===0)return;const h=i[r],m=(i[r].x+h.metrics.advance*h.scale)*s;for(let y=t;y<=r;y++)i[y].x-=m}function Mu(i,t,r){const{horizontalAlign:s,verticalAlign:h}=hf(r),m=t[0]-i.displaySize[0]*s,y=t[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function Bo(i){var t,r;let s=i.left,h=i.top,m=i.right-s,y=i.bottom-h;const v=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",b=(r=i.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",P=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(b==="proportional"){if(v==="stretchOnly"&&m/y<P||v==="proportional"){const A=Math.ceil(y*P);s*=A/m,m=A}}else if(v==="proportional"&&b==="stretchOnly"&&P!==0&&m/y>P){const A=Math.ceil(m/P);h*=A/y,y=A}return{x1:s,y1:h,x2:s+m,y2:h+y}}function yc(i,t,r,s,h,m){const y=i.image;let v;if(y.content){const X=y.content,ne=y.pixelRatio||1;v=[X[0]/ne,X[1]/ne,y.displaySize[0]-X[2]/ne,y.displaySize[1]-X[3]/ne]}const b=t.left*m,P=t.right*m;let A,D,L,F;r==="width"||r==="both"?(F=h[0]+b-s[3],D=h[0]+P+s[1]):(F=h[0]+(b+P-y.displaySize[0])/2,D=F+y.displaySize[0]);const N=t.top*m,Z=t.bottom*m;return r==="height"||r==="both"?(A=h[1]+N-s[0],L=h[1]+Z+s[2]):(A=h[1]+(N+Z-y.displaySize[1])/2,L=A+y.displaySize[1]),{image:y,top:A,right:D,bottom:L,left:F,collisionPadding:v}}const Ws=128,Zs=32640;function pf(i,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ln(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:h}=r;let m=0;for(;m<s.length&&s[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<s.length&&s[y]<i+1;)y++;y=Math.min(s.length-1,y);const v=s[m],b=s[y];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:b,minSize:r.evaluate(new Ln(v)),maxSize:r.evaluate(new Ln(b)),interpolationType:h}}}function od(i,t,r){let s="never";const h=i.get(t);return h?s=h:i.get(r)&&(s="always"),s}const yp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function sd(i,t,r,s,h,m,y,v,b,P,A,D,L){const F=v?Math.min(Zs,Math.round(v[0])):0,N=v?Math.min(Zs,Math.round(v[1])):0;i.emplaceBack(t,r,Math.round(32*s),Math.round(32*h),m,y,(F<<1)+(b?1:0),N,16*P,16*A,256*D,256*L)}function vh(i,t,r){i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r)}function _p(i){for(const t of i.sections)if(To(t.text))return!0;return!1}class ld{constructor(t){this.layoutVertexArray=new Pt,this.indexArray=new Nn,this.programConfigurations=t,this.segments=new vn,this.dynamicLayoutVertexArray=new ln,this.opacityVertexArray=new Pn,this.hasVisibleVertices=!1,this.placedSymbolArray=new K}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dc.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Xd.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,yp,!0),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}_t("SymbolBuffers",ld);class mf{constructor(t,r,s){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new s,this.segments=new vn,this.collisionVertexArray=new Fn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Yd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}_t("CollisionBuffers",mf);class Il{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((y=>y.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=pf(this.zoom,r["text-size"]),this.iconSizeData=pf(this.zoom,r["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),m=s.get("symbol-z-order");this.canOverlap=od(s,"text-overlap","text-allow-overlap")!=="never"||od(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map((y=>E.ao[y]))),this.stateDependentLayerIds=this.layers.filter((y=>y.isStateDependent())).map((y=>y.id)),this.sourceID=t.sourceID}createArrays(){this.text=new ld(new zo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new ld(new zo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new se,this.lineVertexArray=new ie,this.symbolInstances=new re,this.textAnchorOffsets=new pe}calculateGlyphDependencies(t,r,s,h,m){for(let y=0;y<t.length;y++)if(r[t.charCodeAt(y)]=!0,(s||h)&&m){const v=Wi[t.charAt(y)];v&&(r[v.charCodeAt(0)]=!0)}}populate(t,r,s){const h=this.layers[0],m=h.layout,y=m.get("text-font"),v=m.get("text-field"),b=m.get("icon-image"),P=(v.value.kind!=="constant"||v.value.value instanceof Nr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),A=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,D=m.get("symbol-sort-key");if(this.features=[],!P&&!A)return;const L=r.iconDependencies,F=r.glyphDependencies,N=r.availableImages,Z=new Ln(this.zoom);for(const{feature:X,id:ne,index:be,sourceLayerIndex:le}of t){const fe=h._featureFilter.needGeometry,Re=Os(X,fe);if(!h._featureFilter.filter(Z,Re,s))continue;let Be,Ke;if(fe||(Re.geometry=ks(X)),P){const at=h.getValueAndResolveTokens("text-field",Re,s,N),ft=Nr.factory(at),Rt=this.hasRTLText=this.hasRTLText||_p(ft);(!Rt||Oa.getRTLTextPluginStatus()==="unavailable"||Rt&&Oa.isParsed())&&(Be=Qd(ft,h,Re))}if(A){const at=h.getValueAndResolveTokens("icon-image",Re,s,N);Ke=at instanceof hi?at:hi.fromString(at)}if(!Be&&!Ke)continue;const dt=this.sortFeaturesByKey?D.evaluate(Re,{},s):void 0;if(this.features.push({id:ne,text:Be,icon:Ke,index:be,sourceLayerIndex:le,geometry:Re.geometry,properties:X.properties,type:ss.types[X.type],sortKey:dt}),Ke&&(L[Ke.name]=!0),Be){const at=y.evaluate(Re,{},s).join(","),ft=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(E.ao.vertical)>=0;for(const Rt of Be.sections)if(Rt.image)L[Rt.image.name]=!0;else{const ot=mu(Be.toString()),lt=Rt.fontStack||at,Ve=F[lt]=F[lt]||{};this.calculateGlyphDependencies(Rt.text,Ve,ft,this.allowVerticalPlacement,ot)}}}m.get("symbol-placement")==="line"&&(this.features=(function(X){const ne={},be={},le=[];let fe=0;function Re(at){le.push(X[at]),fe++}function Be(at,ft,Rt){const ot=be[at];return delete be[at],be[ft]=ot,le[ot].geometry[0].pop(),le[ot].geometry[0]=le[ot].geometry[0].concat(Rt[0]),ot}function Ke(at,ft,Rt){const ot=ne[ft];return delete ne[ft],ne[at]=ot,le[ot].geometry[0].shift(),le[ot].geometry[0]=Rt[0].concat(le[ot].geometry[0]),ot}function dt(at,ft,Rt){const ot=Rt?ft[0][ft[0].length-1]:ft[0][0];return`${at}:${ot.x}:${ot.y}`}for(let at=0;at<X.length;at++){const ft=X[at],Rt=ft.geometry,ot=ft.text?ft.text.toString():null;if(!ot){Re(at);continue}const lt=dt(ot,Rt),Ve=dt(ot,Rt,!0);if(lt in be&&Ve in ne&&be[lt]!==ne[Ve]){const Bt=Ke(lt,Ve,Rt),Ut=Be(lt,Ve,le[Bt].geometry);delete ne[lt],delete be[Ve],be[dt(ot,le[Ut].geometry,!0)]=Ut,le[Bt].geometry=null}else lt in be?Be(lt,Ve,Rt):Ve in ne?Ke(lt,Ve,Rt):(Re(at),ne[lt]=fe-1,be[Ve]=fe-1)}return le.filter((at=>at.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((X,ne)=>X.sortKey-ne.sortKey))}update(t,r,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,{imagePositions:s}),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,{imagePositions:s}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const s=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(r[t.segment+1]),m=t.dist(r[t.segment]);const y={};for(let v=t.segment+1;v<r.length;v++)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=t.segment||0;v>=0;v--)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const b=y[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,r,s,h,m,y,v,b,P,A,D,L){const F=t.indexArray,N=t.layoutVertexArray,Z=t.segments.prepareSegment(4*r.length,N,F,this.canOverlap?y.sortKey:void 0),X=this.glyphOffsetArray.length,ne=Z.vertexLength,be=this.allowVerticalPlacement&&v===E.ao.vertical?Math.PI/2:0,le=y.text&&y.text.sections;for(let fe=0;fe<r.length;fe++){const{tl:Re,tr:Be,bl:Ke,br:dt,tex:at,pixelOffsetTL:ft,pixelOffsetBR:Rt,minFontScaleX:ot,minFontScaleY:lt,glyphOffset:Ve,isSDF:Bt,sectionIndex:Ut}=r[fe],Et=Z.vertexLength,Ct=Ve[1];sd(N,b.x,b.y,Re.x,Ct+Re.y,at.x,at.y,s,Bt,ft.x,ft.y,ot,lt),sd(N,b.x,b.y,Be.x,Ct+Be.y,at.x+at.w,at.y,s,Bt,Rt.x,ft.y,ot,lt),sd(N,b.x,b.y,Ke.x,Ct+Ke.y,at.x,at.y+at.h,s,Bt,ft.x,Rt.y,ot,lt),sd(N,b.x,b.y,dt.x,Ct+dt.y,at.x+at.w,at.y+at.h,s,Bt,Rt.x,Rt.y,ot,lt),vh(t.dynamicLayoutVertexArray,b,be),F.emplaceBack(Et,Et+2,Et+1),F.emplaceBack(Et+1,Et+2,Et+3),Z.vertexLength+=4,Z.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ve[0]),fe!==r.length-1&&Ut===r[fe+1].sectionIndex||t.programConfigurations.populatePaintArrays(N.length,y,y.index,{imagePositions:{},canonical:L,formattedSection:le&&le[Ut]})}t.placedSymbolArray.emplaceBack(b.x,b.y,X,this.glyphOffsetArray.length-X,ne,P,A,b.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],v,0,!1,0,D)}_addCollisionDebugVertex(t,r,s,h,m,y){return r.emplaceBack(0,0),t.emplaceBack(s.x,s.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,r,s,h,m,y,v){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),P=b.vertexLength,A=m.layoutVertexArray,D=m.collisionVertexArray,L=v.anchorX,F=v.anchorY;this._addCollisionDebugVertex(A,D,y,L,F,new q(t,r)),this._addCollisionDebugVertex(A,D,y,L,F,new q(s,r)),this._addCollisionDebugVertex(A,D,y,L,F,new q(s,h)),this._addCollisionDebugVertex(A,D,y,L,F,new q(t,h)),b.vertexLength+=4;const N=m.indexArray;N.emplaceBack(P,P+1),N.emplaceBack(P+1,P+2),N.emplaceBack(P+2,P+3),N.emplaceBack(P+3,P),b.primitiveLength+=4}addDebugCollisionBoxes(t,r,s,h){for(let m=t;m<r;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mf(ar,Kd.members,$n),this.iconCollisionBox=new mf(ar,Kd.members,$n);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,s,h,m,y,v,b,P){const A={};for(let D=r;D<s;D++){const L=t.get(D);A.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},A.textFeatureIndex=L.featureIndex;break}for(let D=h;D<m;D++){const L=t.get(D);A.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},A.verticalTextFeatureIndex=L.featureIndex;break}for(let D=y;D<v;D++){const L=t.get(D);A.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},A.iconFeatureIndex=L.featureIndex;break}for(let D=b;D<P;D++){const L=t.get(D);A.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},A.verticalIconFeatureIndex=L.featureIndex;break}return A}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const s=t.placedSymbolArray.get(r),h=s.vertexStartIndex+4*s.numGlyphs;for(let m=s.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),s=Math.cos(t),h=[],m=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const b=this.symbolInstances.get(v);h.push(0|Math.round(r*b.anchorX+s*b.anchorY)),m.push(b.featureIndex)}return y.sort(((v,b)=>h[v]-h[b]||m[b]-m[v])),y}addToSortKeyRanges(t,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)})),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ud,vp;_t("SymbolBucket",Il,{omit:["layers","collisionBoxArray","features","compareText"]}),Il.MAX_GLYPHS=65535,Il.addDynamicAttributes=vh;var gf={get paint(){return vp=vp||new ei({"icon-opacity":new zt(xe.paint_symbol["icon-opacity"]),"icon-color":new zt(xe.paint_symbol["icon-color"]),"icon-halo-color":new zt(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new zt(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zt(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new St(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new St(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new zt(xe.paint_symbol["text-opacity"]),"text-color":new zt(xe.paint_symbol["text-color"],{runtimeType:Er,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new zt(xe.paint_symbol["text-halo-color"]),"text-halo-width":new zt(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new zt(xe.paint_symbol["text-halo-blur"]),"text-translate":new St(xe.paint_symbol["text-translate"]),"text-translate-anchor":new St(xe.paint_symbol["text-translate-anchor"])})},get layout(){return ud=ud||new ei({"symbol-placement":new St(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new St(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new St(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zt(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new St(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new St(xe.layout_symbol["icon-allow-overlap"]),"icon-overlap":new St(xe.layout_symbol["icon-overlap"]),"icon-ignore-placement":new St(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new St(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new St(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new zt(xe.layout_symbol["icon-size"]),"icon-text-fit":new St(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new zt(xe.layout_symbol["icon-image"]),"icon-rotate":new zt(xe.layout_symbol["icon-rotate"]),"icon-padding":new zt(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new St(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new zt(xe.layout_symbol["icon-offset"]),"icon-anchor":new zt(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new St(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new St(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new St(xe.layout_symbol["text-rotation-alignment"]),"text-field":new zt(xe.layout_symbol["text-field"]),"text-font":new zt(xe.layout_symbol["text-font"]),"text-size":new zt(xe.layout_symbol["text-size"]),"text-max-width":new zt(xe.layout_symbol["text-max-width"]),"text-line-height":new St(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new zt(xe.layout_symbol["text-letter-spacing"]),"text-justify":new zt(xe.layout_symbol["text-justify"]),"text-radial-offset":new zt(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new St(xe.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new zt(xe.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new zt(xe.layout_symbol["text-anchor"]),"text-max-angle":new St(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new St(xe.layout_symbol["text-writing-mode"]),"text-rotate":new zt(xe.layout_symbol["text-rotate"]),"text-padding":new St(xe.layout_symbol["text-padding"]),"text-keep-upright":new St(xe.layout_symbol["text-keep-upright"]),"text-transform":new zt(xe.layout_symbol["text-transform"]),"text-offset":new zt(xe.layout_symbol["text-offset"]),"text-allow-overlap":new St(xe.layout_symbol["text-allow-overlap"]),"text-overlap":new St(xe.layout_symbol["text-overlap"]),"text-ignore-placement":new St(xe.layout_symbol["text-ignore-placement"]),"text-optional":new St(xe.layout_symbol["text-optional"])})}};class _c{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:qa,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}_t("FormatSectionOverride",_c,{omit:["defaultValue"]});class cd extends xa{constructor(t,r){super(t,gf,r)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const m of s)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,s,h){const m=this.layout.get(t).evaluate(r,{},s,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||xo(y.value)||!m?m:(function(v,b){return b.replace(/{([^{}]+)}/g,((P,A)=>v&&A in v?String(v[A]):""))})(r.properties,m)}createBucket(t){return new Il(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of gf.paint.overridableProperties){if(!cd.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),s=new _c(r),h=new cu(s,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new Xo("source",h):new ml("composite",h,r.value.zoomStops),this.paint._values[t]=new Fi(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&cd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const s=t.get("text-field"),h=gf.paint.properties[r];let m=!1;const y=v=>{for(const b of v)if(h.overrides&&h.overrides.hasOverride(b))return void(m=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Nr)y(s.value.value.sections);else if(s.value.kind==="source"||s.value.kind==="composite"){const v=P=>{m||(P instanceof _a&&Ft(P.value)===Hi?y(P.value.sections):P instanceof _s?y(P.sections):P.eachChild(v))},b=s.value;b._styleExpression&&v(b._styleExpression.expression)}return m}}let yf;var Cn={get paint(){return yf=yf||new ei({"background-color":new St(xe.paint_background["background-color"]),"background-pattern":new Xc(xe.paint_background["background-pattern"]),"background-opacity":new St(xe.paint_background["background-opacity"])})}};class _f extends xa{constructor(t,r){super(t,Cn,r)}}let xh;var vf={get paint(){return xh=xh||new ei({"raster-opacity":new St(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new St(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new St(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new St(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new St(xe.paint_raster["raster-saturation"]),"raster-contrast":new St(xe.paint_raster["raster-contrast"]),"raster-resampling":new St(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new St(xe.paint_raster["raster-fade-duration"])})}};class xp extends xa{constructor(t,r){super(t,vf,r)}}class xf extends xa{constructor(t,r){super(t,{},r),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class bh{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const hd={once:!0},Ll=63710088e-1;class qs{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qs(Zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,s=this.lat*r,h=t.lat*r,m=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((t.lng-this.lng)*r);return Ll*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof qs)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new qs(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new qs(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const bp=2*Math.PI*Ll;function wp(i){return bp*Math.cos(i*Math.PI/180)}function bf(i){return(180+i)/360}function wf(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function wh(i,t){return i/wp(t)}function Zn(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function dd(i,t){return i*wp(Zn(t))}class Hr{constructor(t,r,s=0){this.x=+t,this.y=+r,this.z=+s}static fromLngLat(t,r=0){const s=qs.convert(t);return new Hr(bf(s.lng),wf(s.lat),wh(r,s.lat))}toLngLat(){return new qs(360*this.x-180,Zn(this.y))}toAltitude(){return dd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/bp*(t=Zn(this.y),1/Math.cos(t*Math.PI/180));var t}}function Sp(i,t,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[i*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class Sh{constructor(t,r,s){if(!(function(h,m,y){return!(h<0||h>25||y<0||y>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))})(t,r,s))throw new Error(`x=${r}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=s,this.key=Ru(0,t,t,r,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,s){const h=(y=this.y,v=this.z,b=Sp(256*(m=this.x),256*(y=Math.pow(2,v)-y-1),v),P=Sp(256*(m+1),256*(y+1),v),b[0]+","+b[1]+","+P[0]+","+P[1]);var m,y,v,b,P;const A=(function(D,L,F){let N,Z="";for(let X=D;X>0;X--)N=1<<X-1,Z+=(L&N?1:0)+(F&N?2:0);return Z})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,A).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new q((t.x*r-this.x)*At,(t.y*r-this.y)*At)}toString(){return`${this.z}/${this.x}/${this.y}`}}class fd{constructor(t,r){this.wrap=t,this.canonical=r,this.key=Ru(t,r.z,r.z,r.x,r.y)}}class Qi{constructor(t,r,s,h,m){if(this.terrainRttPosMatrix32f=null,t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Sh(s,+h,+m),this.key=Ru(r,t,s,h,m)}clone(){return new Qi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new Qi(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Qi(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?Ru(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):Ru(this.wrap*+r,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const r=this.canonical.z-t.canonical.z;return!(r<0)&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Qi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new Qi(r,this.wrap,r,s,h),new Qi(r,this.wrap,r,s+1,h),new Qi(r,this.wrap,r,s,h+1),new Qi(r,this.wrap,r,s+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Qi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Qi(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new fd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Hr(t.x-this.wrap,t.y))}}function Ru(i,t,r,s,h){(i*=2)<0&&(i=-1*i-1);const m=1<<r;return(m*m*i+m*h+s).toString(36)+r.toString(36)+t.toString(36)}function vc(i,t){return t?i.properties[t]:i.id}_t("CanonicalTileID",Sh),_t("OverscaledTileID",Qi,{omit:["terrainRttPosMatrix32f"]});class Hs{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const r=new Hs;return r.extend(t(new q(this.minX,this.minY))),r.extend(t(new q(this.maxX,this.minY))),r.extend(t(new q(this.minX,this.maxY))),r.extend(t(new q(this.maxX,this.maxY))),r}static fromPoints(t){const r=new Hs;for(const s of t)r.extend(s);return r}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class pd{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const s=t[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Pp{constructor(t,r,s,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=s,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class Sf{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ts(At,16,0),this.grid3D=new ts(At,16,0),this.featureIndexArray=new _e,this.promoteId=r}insert(t,r,s,h,m,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,m);const b=y?this.grid3D:this.grid;for(let P=0;P<r.length;P++){const A=r[P],D=[1/0,1/0,-1/0,-1/0];for(let L=0;L<A.length;L++){const F=A[L];D[0]=Math.min(D[0],F.x),D[1]=Math.min(D[1],F.y),D[2]=Math.max(D[2],F.x),D[3]=Math.max(D[3],F.y)}D[0]<At&&D[1]<At&&D[2]>=0&&D[3]>=0&&b.insert(v,D[0],D[1],D[2],D[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new up(new tf(this.rawTileData)).layers,this.sourceLayerCoder=new pd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,s,h){this.loadVTLayers();const m=t.params,y=At/t.tileSize/t.scale,v=bo(m.filter,m.globalState),b=t.queryGeometry,P=t.queryPadding*y,A=Hs.fromPoints(b),D=this.grid.query(A.minX-P,A.minY-P,A.maxX+P,A.maxY+P),L=Hs.fromPoints(t.cameraQueryGeometry).expandBy(P),F=this.grid3D.query(L.minX,L.minY,L.maxX,L.maxY,((X,ne,be,le)=>(function(fe,Re,Be,Ke,dt){for(const ft of fe)if(Re<=ft.x&&Be<=ft.y&&Ke>=ft.x&&dt>=ft.y)return!0;const at=[new q(Re,Be),new q(Re,dt),new q(Ke,dt),new q(Ke,Be)];if(fe.length>2){for(const ft of at)if(sc(fe,ft))return!0}for(let ft=0;ft<fe.length-1;ft++)if(Zf(fe[ft],fe[ft+1],at))return!0;return!1})(t.cameraQueryGeometry,X-P,ne-P,be+P,le+P)));for(const X of F)D.push(X);D.sort(Tp);const N={};let Z;for(let X=0;X<D.length;X++){const ne=D[X];if(ne===Z)continue;Z=ne;const be=this.featureIndexArray.get(ne);let le=null;this.loadMatchingFeature(N,be.bucketIndex,be.sourceLayerIndex,be.featureIndex,v,m.layers,m.availableImages,r,s,h,((fe,Re,Be)=>(le||(le=ks(fe)),Re.queryIntersectsFeature({queryGeometry:b,feature:fe,featureState:Be,geometry:le,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return N}loadMatchingFeature(t,r,s,h,m,y,v,b,P,A,D){const L=this.bucketLayerIDs[r];if(y&&!L.some((X=>y.has(X))))return;const F=this.sourceLayerCoder.decode(s),N=this.vtLayers[F].feature(h);if(m.needGeometry){const X=Os(N,!0);if(!m.filter(new Ln(this.tileID.overscaledZ),X,this.tileID.canonical))return}else if(!m.filter(new Ln(this.tileID.overscaledZ),N))return;const Z=this.getId(N,F);for(let X=0;X<L.length;X++){const ne=L[X];if(y&&!y.has(ne))continue;const be=b[ne];if(!be)continue;let le={};Z&&A&&(le=A.getState(be.sourceLayer||"_geojsonTileLayer",Z));const fe=Vt({},P[ne]);fe.paint=Cp(fe.paint,be.paint,N,le,v),fe.layout=Cp(fe.layout,be.layout,N,le,v);const Re=!D||D(N,be,le);if(!Re)continue;const Be=new Pp(N,this.z,this.x,this.y,Z);Be.layer=fe;let Ke=t[ne];Ke===void 0&&(Ke=t[ne]=[]),Ke.push({featureIndex:h,feature:Be,intersectionZ:Re})}}lookupSymbolFeatures(t,r,s,h,m,y,v,b){const P={};this.loadVTLayers();const A=bo(m.filterSpec,m.globalState);for(const D of t)this.loadMatchingFeature(P,s,h,D,A,y,v,b,r);return P}hasLayer(t){for(const r of this.bucketLayerIDs)for(const s of r)if(t===s)return!0;return!1}getId(t,r){var s;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((s=t.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function Cp(i,t,r,s,h){return tr(i,((m,y)=>{const v=t instanceof io?t.get(y):null;return v&&v.evaluate?v.evaluate(r,s,h):v}))}function Tp(i,t){return t-i}function Ap(i,t,r,s,h){const m=[];for(let y=0;y<i.length;y++){const v=i[y];let b;for(let P=0;P<v.length-1;P++){let A=v[P],D=v[P+1];A.x<t&&D.x<t||(A.x<t?A=new q(t,A.y+(t-A.x)/(D.x-A.x)*(D.y-A.y))._round():D.x<t&&(D=new q(t,A.y+(t-A.x)/(D.x-A.x)*(D.y-A.y))._round()),A.y<r&&D.y<r||(A.y<r?A=new q(A.x+(r-A.y)/(D.y-A.y)*(D.x-A.x),r)._round():D.y<r&&(D=new q(A.x+(r-A.y)/(D.y-A.y)*(D.x-A.x),r)._round()),A.x>=s&&D.x>=s||(A.x>=s?A=new q(s,A.y+(s-A.x)/(D.x-A.x)*(D.y-A.y))._round():D.x>=s&&(D=new q(s,A.y+(s-A.x)/(D.x-A.x)*(D.y-A.y))._round()),A.y>=h&&D.y>=h||(A.y>=h?A=new q(A.x+(h-A.y)/(D.y-A.y)*(D.x-A.x),h)._round():D.y>=h&&(D=new q(A.x+(h-A.y)/(D.y-A.y)*(D.x-A.x),h)._round()),b&&A.equals(b[b.length-1])||(b=[A],m.push(b)),b.push(D)))))}}return m}_t("FeatureIndex",Sf,{omit:["rawTileData","sourceLayerCoder"]});class kl extends q{constructor(t,r,s,h){super(t,r),this.angle=s,h!==void 0&&(this.segment=h)}clone(){return new kl(this.x,this.y,this.angle,this.segment)}}function $s(i,t,r,s,h){if(t.segment===void 0||r===0)return!0;let m=t,y=t.segment+1,v=0;for(;v>-r/2;){if(y--,y<0)return!1;v-=i[y].dist(m),m=i[y]}v+=i[y].dist(i[y+1]),y++;const b=[];let P=0;for(;v<r/2;){const A=i[y],D=i[y+1];if(!D)return!1;let L=i[y-1].angleTo(A)-A.angleTo(D);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:L}),P+=L;v-b[0].distance>s;)P-=b.shift().angleDelta;if(P>h)return!1;y++,v+=A.dist(D)}return!0}function Pf(i){let t=0;for(let r=0;r<i.length-1;r++)t+=i[r].dist(i[r+1]);return t}function md(i,t,r){return i?.6*t*r:0}function Ep(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function sm(i,t,r,s,h,m){const y=md(r,h,m),v=Ep(r,s)*m;let b=0;const P=Pf(i)/2;for(let A=0;A<i.length-1;A++){const D=i[A],L=i[A+1],F=D.dist(L);if(b+F>P){const N=(P-b)/F,Z=eo.number(D.x,L.x,N),X=eo.number(D.y,L.y,N),ne=new kl(Z,X,L.angleTo(D),A);return ne._round(),!y||$s(i,ne,v,y,t)?ne:void 0}b+=F}}function Cf(i,t,r,s,h,m,y,v,b){const P=md(s,m,y),A=Ep(s,h),D=A*y,L=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return t-D<t/4&&(t=D+t/4),Mp(i,L?t/2*v%t:(A/2+2*m)*y*v%t,t,P,r,D,L,!1,b)}function Mp(i,t,r,s,h,m,y,v,b){const P=m/2,A=Pf(i);let D=0,L=t-r,F=[];for(let N=0;N<i.length-1;N++){const Z=i[N],X=i[N+1],ne=Z.dist(X),be=X.angleTo(Z);for(;L+r<D+ne;){L+=r;const le=(L-D)/ne,fe=eo.number(Z.x,X.x,le),Re=eo.number(Z.y,X.y,le);if(fe>=0&&fe<b&&Re>=0&&Re<b&&L-P>=0&&L+P<=A){const Be=new kl(fe,Re,be,N);Be._round(),s&&!$s(i,Be,m,s,h)||F.push(Be)}}D+=ne}return v||F.length||y||(F=Mp(i,D/2,r,s,h,m,y,!0,b)),F}function ho(i,t,r,s){const h=[],m=i.image,y=m.pixelRatio,v=m.paddedRect.w-2,b=m.paddedRect.h-2;let P={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const A=m.stretchX||[[0,v]],D=m.stretchY||[[0,b]],L=(Ve,Bt)=>Ve+Bt[1]-Bt[0],F=A.reduce(L,0),N=D.reduce(L,0),Z=v-F,X=b-N;let ne=0,be=F,le=0,fe=N,Re=0,Be=Z,Ke=0,dt=X;if(m.content&&s){const Ve=m.content,Bt=Ve[2]-Ve[0],Ut=Ve[3]-Ve[1];(m.textFitWidth||m.textFitHeight)&&(P=Bo(i)),ne=xc(A,0,Ve[0]),le=xc(D,0,Ve[1]),be=xc(A,Ve[0],Ve[2]),fe=xc(D,Ve[1],Ve[3]),Re=Ve[0]-ne,Ke=Ve[1]-le,Be=Bt-be,dt=Ut-fe}const at=P.x1,ft=P.y1,Rt=P.x2-at,ot=P.y2-ft,lt=(Ve,Bt,Ut,Et)=>{const Ct=Ph(Ve.stretch-ne,be,Rt,at),gn=Ol(Ve.fixed-Re,Be,Ve.stretch,F),Kn=Ph(Bt.stretch-le,fe,ot,ft),$r=Ol(Bt.fixed-Ke,dt,Bt.stretch,N),pi=Ph(Ut.stretch-ne,be,Rt,at),Ji=Ol(Ut.fixed-Re,Be,Ut.stretch,F),ea=Ph(Et.stretch-le,fe,ot,ft),mi=Ol(Et.fixed-Ke,dt,Et.stretch,N),Qn=new q(Ct,Kn),kr=new q(pi,Kn),ai=new q(pi,ea),Or=new q(Ct,ea),Ti=new q(gn/y,$r/y),ta=new q(Ji/y,mi/y),Xr=t*Math.PI/180;if(Xr){const n=Math.sin(Xr),o=Math.cos(Xr),u=[o,-n,n,o];Qn._matMult(u),kr._matMult(u),Or._matMult(u),ai._matMult(u)}const pa=Ve.stretch+Ve.fixed,Tr=Bt.stretch+Bt.fixed;return{tl:Qn,tr:kr,bl:Or,br:ai,tex:{x:m.paddedRect.x+1+pa,y:m.paddedRect.y+1+Tr,w:Ut.stretch+Ut.fixed-pa,h:Et.stretch+Et.fixed-Tr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ti,pixelOffsetBR:ta,minFontScaleX:Be/y/Rt,minFontScaleY:dt/y/ot,isSDF:r}};if(s&&(m.stretchX||m.stretchY)){const Ve=Tf(A,Z,F),Bt=Tf(D,X,N);for(let Ut=0;Ut<Ve.length-1;Ut++){const Et=Ve[Ut],Ct=Ve[Ut+1];for(let gn=0;gn<Bt.length-1;gn++)h.push(lt(Et,Bt[gn],Ct,Bt[gn+1]))}}else h.push(lt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return h}function xc(i,t,r){let s=0;for(const h of i)s+=Math.max(t,Math.min(r,h[1]))-Math.max(t,Math.min(r,h[0]));return s}function Tf(i,t,r){const s=[{fixed:-1,stretch:0}];for(const[h,m]of i){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return s.push({fixed:t+1,stretch:r}),s}function Ph(i,t,r,s){return i/t*r+s}function Ol(i,t,r,s){return i-t*r/s}_t("Anchor",kl);class fa{constructor(t,r,s,h,m,y,v,b,P,A){var D;if(this.boxStartIndex=t.length,P){let L=y.top,F=y.bottom;const N=y.collisionPadding;N&&(L-=N[1],F+=N[3]);let Z=F-L;Z>0&&(Z=Math.max(10,Z),this.circleDiameter=Z)}else{const L=!((D=y.image)===null||D===void 0)&&D.content&&(y.image.textFitWidth||y.image.textFitHeight)?Bo(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};L.y1=L.y1*v-b[0],L.y2=L.y2*v+b[2],L.x1=L.x1*v-b[3],L.x2=L.x2*v+b[1];const F=y.collisionPadding;if(F&&(L.x1-=F[0]*v,L.y1-=F[1]*v,L.x2+=F[2]*v,L.y2+=F[3]*v),A){const N=new q(L.x1,L.y1),Z=new q(L.x2,L.y1),X=new q(L.x1,L.y2),ne=new q(L.x2,L.y2),be=A*Math.PI/180;N._rotate(be),Z._rotate(be),X._rotate(be),ne._rotate(be),L.x1=Math.min(N.x,Z.x,X.x,ne.x),L.x2=Math.max(N.x,Z.x,X.x,ne.x),L.y1=Math.min(N.y,Z.y,X.y,ne.y),L.y2=Math.max(N.y,Z.y,X.y,ne.y)}t.emplaceBack(r.x,r.y,L.x1,L.y1,L.x2,L.y2,s,h,m)}this.boxEndIndex=t.length}}class Rp{constructor(t=[],r=(s,h)=>s<h?-1:s>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:s}=this,h=r[t];for(;t>0;){const m=t-1>>1,y=r[m];if(s(h,y)>=0)break;r[t]=y,t=m}r[t]=h}_down(t){const{data:r,compare:s}=this,h=this.length>>1,m=r[t];for(;t<h;){let y=1+(t<<1);const v=y+1;if(v<this.length&&s(r[v],r[y])<0&&(y=v),s(r[y],m)>=0)break;r[t]=r[y],t=y}r[t]=m}}function gd(i,t=1,r=!1){const s=Hs.fromPoints(i[0]),h=Math.min(s.width(),s.height());let m=h/2;const y=new Rp([],Xs),{minX:v,minY:b,maxX:P,maxY:A}=s;if(h===0)return new q(v,b);for(let F=v;F<P;F+=h)for(let N=b;N<A;N+=h)y.push(new bc(F+m,N+m,m,i));let D=(function(F){let N=0,Z=0,X=0;const ne=F[0];for(let be=0,le=ne.length,fe=le-1;be<le;fe=be++){const Re=ne[be],Be=ne[fe],Ke=Re.x*Be.y-Be.x*Re.y;Z+=(Re.x+Be.x)*Ke,X+=(Re.y+Be.y)*Ke,N+=3*Ke}return new bc(Z/N,X/N,0,F)})(i),L=y.length;for(;y.length;){const F=y.pop();(F.d>D.d||!D.d)&&(D=F,r&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,L)),F.max-D.d<=t||(m=F.h/2,y.push(new bc(F.p.x-m,F.p.y-m,m,i)),y.push(new bc(F.p.x+m,F.p.y-m,m,i)),y.push(new bc(F.p.x-m,F.p.y+m,m,i)),y.push(new bc(F.p.x+m,F.p.y+m,m,i)),L+=4)}return r&&(console.log(`num probes: ${L}`),console.log(`best distance: ${D.d}`)),D.p}function Xs(i,t){return t.max-i.max}function bc(i,t,r,s){this.p=new q(i,t),this.h=r,this.d=(function(h,m){let y=!1,v=1/0;for(let b=0;b<m.length;b++){const P=m[b];for(let A=0,D=P.length,L=D-1;A<D;L=A++){const F=P[A],N=P[L];F.y>h.y!=N.y>h.y&&h.x<(N.x-F.x)*(h.y-F.y)/(N.y-F.y)+F.x&&(y=!y),v=Math.min(v,Rd(h,F,N))}}return(y?1:-1)*Math.sqrt(v)})(this.p,s),this.max=this.d+this.h*Math.SQRT2}var Ci;E.aE=void 0,(Ci=E.aE||(E.aE={}))[Ci.center=1]="center",Ci[Ci.left=2]="left",Ci[Ci.right=3]="right",Ci[Ci.top=4]="top",Ci[Ci.bottom=5]="bottom",Ci[Ci["top-left"]=6]="top-left",Ci[Ci["top-right"]=7]="top-right",Ci[Ci["bottom-left"]=8]="bottom-left",Ci[Ci["bottom-right"]=9]="bottom-right";const Bl=Number.POSITIVE_INFINITY;function Af(i,t){return t[1]!==Bl?(function(r,s,h){let m=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),r){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(r){case"top-right":case"bottom-right":case"right":m=-s;break;case"top-left":case"bottom-left":case"left":m=s}return[m,y]})(i,t[0],t[1]):(function(r,s){let h=0,m=0;s<0&&(s=0);const y=s/Math.SQRT2;switch(r){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-s;break;case"top":m=s-7}switch(r){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,m]})(i,t[0])}function Dp(i,t,r){var s;const h=i.layout,m=(s=h.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},r);if(m){const v=m.values,b=[];for(let P=0;P<v.length;P+=2){const A=b[P]=v[P],D=v[P+1].map((L=>L*qr));A.startsWith("top")?D[1]-=7:A.startsWith("bottom")&&(D[1]+=7),b[P+1]=D}return new ci(b)}const y=h.get("text-variable-anchor");if(y){let v;v=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},r)*qr,Bl]:h.get("text-offset").evaluate(t,{},r).map((P=>P*qr));const b=[];for(const P of y)b.push(P,Af(P,v));return new ci(b)}return null}function Ef(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lm(i,t,r,s,h,m,y,v,b,P,A,D){let L=m.textMaxSize.evaluate(t,{});L===void 0&&(L=y);const F=i.layers[0].layout,N=F.get("icon-offset").evaluate(t,{},A),Z=Ip(r.horizontal),X=y/24,ne=i.tilePixelRatio*X,be=i.tilePixelRatio*L/24,le=i.tilePixelRatio*v,fe=i.tilePixelRatio*F.get("symbol-spacing"),Re=F.get("text-padding")*i.tilePixelRatio,Be=(function(Ut,Et,Ct,gn=1){const Kn=Ut.get("icon-padding").evaluate(Et,{},Ct),$r=Kn&&Kn.values;return[$r[0]*gn,$r[1]*gn,$r[2]*gn,$r[3]*gn]})(F,t,A,i.tilePixelRatio),Ke=F.get("text-max-angle")/180*Math.PI,dt=F.get("text-rotation-alignment")!=="viewport"&&F.get("symbol-placement")!=="point",at=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",ft=F.get("symbol-placement"),Rt=fe/2,ot=F.get("icon-text-fit");let lt;s&&ot!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(lt=yc(s,r.vertical,ot,F.get("icon-text-fit-padding"),N,X)),Z&&(s=yc(s,Z,ot,F.get("icon-text-fit-padding"),N,X)));const Ve=A?D.line.getGranularityForZoomLevel(A.z):1,Bt=(Ut,Et)=>{Et.x<0||Et.x>=At||Et.y<0||Et.y>=At||(function(Ct,gn,Kn,$r,pi,Ji,ea,mi,Qn,kr,ai,Or,Ti,ta,Xr,pa,Tr,n,o,u,p,x,C,O,H){const de=Ct.addToLineVertexArray(gn,Kn);let De,Xe,Je,Oe,Fe=0,tn=0,Yt=0,Jn=0,Pe=-1,we=-1;const Ae={};let Qe=Do("");if(Ct.allowVerticalPlacement&&$r.vertical){const ma=mi.layout.get("text-rotate").evaluate(p,{},O)+90;Je=new fa(Qn,gn,kr,ai,Or,$r.vertical,Ti,ta,Xr,ma),ea&&(Oe=new fa(Qn,gn,kr,ai,Or,ea,Tr,n,Xr,ma))}if(pi){const ma=mi.layout.get("icon-rotate").evaluate(p,{}),Fo=mi.layout.get("icon-text-fit")!=="none",Eh=ho(pi,ma,C,Fo),Ks=ea?ho(ea,ma,C,Fo):void 0;Xe=new fa(Qn,gn,kr,ai,Or,pi,Tr,n,!1,ma),Fe=4*Eh.length;const Mh=Ct.iconSizeData;let jl=null;Mh.kind==="source"?(jl=[Ws*mi.layout.get("icon-size").evaluate(p,{})],jl[0]>Zs&&un(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):Mh.kind==="composite"&&(jl=[Ws*x.compositeIconSizes[0].evaluate(p,{},O),Ws*x.compositeIconSizes[1].evaluate(p,{},O)],(jl[0]>Zs||jl[1]>Zs)&&un(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,Eh,jl,u,o,p,E.ao.none,gn,de.lineStartIndex,de.lineLength,-1,O),Pe=Ct.icon.placedSymbolArray.length-1,Ks&&(tn=4*Ks.length,Ct.addSymbols(Ct.icon,Ks,jl,u,o,p,E.ao.vertical,gn,de.lineStartIndex,de.lineLength,-1,O),we=Ct.icon.placedSymbolArray.length-1)}const Lt=Object.keys($r.horizontal);for(const ma of Lt){const Fo=$r.horizontal[ma];if(!De){Qe=Do(Fo.text);const Ks=mi.layout.get("text-rotate").evaluate(p,{},O);De=new fa(Qn,gn,kr,ai,Or,Fo,Ti,ta,Xr,Ks)}const Eh=Fo.positionedLines.length===1;if(Yt+=zp(Ct,gn,Fo,Ji,mi,Xr,p,pa,de,$r.vertical?E.ao.horizontal:E.ao.horizontalOnly,Eh?Lt:[ma],Ae,Pe,x,O),Eh)break}$r.vertical&&(Jn+=zp(Ct,gn,$r.vertical,Ji,mi,Xr,p,pa,de,E.ao.vertical,["vertical"],Ae,we,x,O));const wn=De?De.boxStartIndex:Ct.collisionBoxArray.length,jt=De?De.boxEndIndex:Ct.collisionBoxArray.length,Jt=Je?Je.boxStartIndex:Ct.collisionBoxArray.length,Ai=Je?Je.boxEndIndex:Ct.collisionBoxArray.length,On=Xe?Xe.boxStartIndex:Ct.collisionBoxArray.length,Ul=Xe?Xe.boxEndIndex:Ct.collisionBoxArray.length,cm=Oe?Oe.boxStartIndex:Ct.collisionBoxArray.length,py=Oe?Oe.boxEndIndex:Ct.collisionBoxArray.length;let Ys=-1;const Op=(ma,Fo)=>ma&&ma.circleDiameter?Math.max(ma.circleDiameter,Fo):Fo;Ys=Op(De,Ys),Ys=Op(Je,Ys),Ys=Op(Xe,Ys),Ys=Op(Oe,Ys);const Hm=Ys>-1?1:0;Hm&&(Ys*=H/qr),Ct.glyphOffsetArray.length>=Il.MAX_GLYPHS&&un("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),p.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,p.sortKey);const my=Dp(mi,p,O),[gy,yy]=(function(ma,Fo){const Eh=ma.length,Ks=Fo?.values;if(Ks?.length>0)for(let Mh=0;Mh<Ks.length;Mh+=2){const jl=Ks[Mh+1];ma.emplaceBack(E.aE[Ks[Mh]],jl[0],jl[1])}return[Eh,ma.length]})(Ct.textAnchorOffsets,my);Ct.symbolInstances.emplaceBack(gn.x,gn.y,Ae.right>=0?Ae.right:-1,Ae.center>=0?Ae.center:-1,Ae.left>=0?Ae.left:-1,Ae.vertical||-1,Pe,we,Qe,wn,jt,Jt,Ai,On,Ul,cm,py,kr,Yt,Jn,Fe,tn,Hm,0,Ti,Ys,gy,yy)})(i,Et,Ut,r,s,h,lt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,ne,[Re,Re,Re,Re],dt,b,le,Be,at,N,t,m,P,A,y)};if(ft==="line")for(const Ut of Ap(t.geometry,0,0,At,At)){const Et=Va(Ut,Ve),Ct=Cf(Et,fe,Ke,r.vertical||Z,s,24,be,i.overscaling,At);for(const gn of Ct)Z&&um(i,Z.text,Rt,gn)||Bt(Et,gn)}else if(ft==="line-center"){for(const Ut of t.geometry)if(Ut.length>1){const Et=Va(Ut,Ve),Ct=sm(Et,Ke,r.vertical||Z,s,24,be);Ct&&Bt(Et,Ct)}}else if(t.type==="Polygon")for(const Ut of hl(t.geometry,0)){const Et=gd(Ut,16);Bt(Va(Ut[0],Ve,!0),new kl(Et.x,Et.y,0))}else if(t.type==="LineString")for(const Ut of t.geometry){const Et=Va(Ut,Ve);Bt(Et,new kl(Et[0].x,Et[0].y,0))}else if(t.type==="Point")for(const Ut of t.geometry)for(const Et of Ut)Bt([Et],new kl(Et.x,Et.y,0))}function zp(i,t,r,s,h,m,y,v,b,P,A,D,L,F,N){const Z=(function(be,le,fe,Re,Be,Ke,dt,at){const ft=Re.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,Rt=[];for(const ot of le.positionedLines)for(const lt of ot.positionedGlyphs){if(!lt.rect)continue;const Ve=lt.rect||{};let Bt=4,Ut=!0,Et=1,Ct=0;const gn=(Be||at)&&lt.vertical,Kn=lt.metrics.advance*lt.scale/2;if(at&&le.verticalizable&&(Ct=ot.lineOffset/2-(lt.imageName?-(qr-lt.metrics.width*lt.scale)/2:(lt.scale-1)*qr)),lt.imageName){const n=dt[lt.imageName];Ut=n.sdf,Et=n.pixelRatio,Bt=1/Et}const $r=Be?[lt.x+Kn,lt.y]:[0,0];let pi=Be?[0,0]:[lt.x+Kn+fe[0],lt.y+fe[1]-Ct],Ji=[0,0];gn&&(Ji=pi,pi=[0,0]);const ea=lt.metrics.isDoubleResolution?2:1,mi=(lt.metrics.left-Bt)*lt.scale-Kn+pi[0],Qn=(-lt.metrics.top-Bt)*lt.scale+pi[1],kr=mi+Ve.w/ea*lt.scale/Et,ai=Qn+Ve.h/ea*lt.scale/Et,Or=new q(mi,Qn),Ti=new q(kr,Qn),ta=new q(mi,ai),Xr=new q(kr,ai);if(gn){const n=new q(-Kn,Kn- -17),o=-Math.PI/2,u=12-Kn,p=new q(22-u,-(lt.imageName?u:0)),x=new q(...Ji);Or._rotateAround(o,n)._add(p)._add(x),Ti._rotateAround(o,n)._add(p)._add(x),ta._rotateAround(o,n)._add(p)._add(x),Xr._rotateAround(o,n)._add(p)._add(x)}if(ft){const n=Math.sin(ft),o=Math.cos(ft),u=[o,-n,n,o];Or._matMult(u),Ti._matMult(u),ta._matMult(u),Xr._matMult(u)}const pa=new q(0,0),Tr=new q(0,0);Rt.push({tl:Or,tr:Ti,bl:ta,br:Xr,tex:Ve,writingMode:le.writingMode,glyphOffset:$r,sectionIndex:lt.sectionIndex,isSDF:Ut,pixelOffsetTL:pa,pixelOffsetBR:Tr,minFontScaleX:0,minFontScaleY:0})}return Rt})(0,r,v,h,m,y,s,i.allowVerticalPlacement),X=i.textSizeData;let ne=null;X.kind==="source"?(ne=[Ws*h.layout.get("text-size").evaluate(y,{})],ne[0]>Zs&&un(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):X.kind==="composite"&&(ne=[Ws*F.compositeTextSizes[0].evaluate(y,{},N),Ws*F.compositeTextSizes[1].evaluate(y,{},N)],(ne[0]>Zs||ne[1]>Zs)&&un(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,Z,ne,v,m,y,P,t,b.lineStartIndex,b.lineLength,L,N);for(const be of A)D[be]=i.text.placedSymbolArray.length-1;return 4*Z.length}function Ip(i){for(const t in i)return i[t];return null}function um(i,t,r,s){const h=i.compareText;if(t in h){const m=h[t];for(let y=m.length-1;y>=0;y--)if(s.dist(m[y])<r)return!0}else h[t]=[];return h[t].push(s),!1}const Lp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class yd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=s>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Lp[15&s];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new yd(v,y,m,t)}constructor(t,r=64,s=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Lp.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${s}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+b),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+b,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=r,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return Fl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,b=[0,m.length-1,0],P=[];for(;b.length;){const A=b.pop()||0,D=b.pop()||0,L=b.pop()||0;if(D-L<=v){for(let X=L;X<=D;X++){const ne=y[2*X],be=y[2*X+1];ne>=t&&ne<=s&&be>=r&&be<=h&&P.push(m[X])}continue}const F=L+D>>1,N=y[2*F],Z=y[2*F+1];N>=t&&N<=s&&Z>=r&&Z<=h&&P.push(m[F]),(A===0?t<=N:r<=Z)&&(b.push(L),b.push(F-1),b.push(1-A)),(A===0?s>=N:h>=Z)&&(b.push(F+1),b.push(D),b.push(1-A))}return P}within(t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,v=[0,h.length-1,0],b=[],P=s*s;for(;v.length;){const A=v.pop()||0,D=v.pop()||0,L=v.pop()||0;if(D-L<=y){for(let X=L;X<=D;X++)Du(m[2*X],m[2*X+1],t,r)<=P&&b.push(h[X]);continue}const F=L+D>>1,N=m[2*F],Z=m[2*F+1];Du(N,Z,t,r)<=P&&b.push(h[F]),(A===0?t-s<=N:r-s<=Z)&&(v.push(L),v.push(F-1),v.push(1-A)),(A===0?t+s>=N:r+s>=Z)&&(v.push(F+1),v.push(D),v.push(1-A))}return b}}function Fl(i,t,r,s,h,m){if(h-s<=r)return;const y=s+h>>1;wc(i,t,y,s,h,m),Fl(i,t,r,s,y-1,1-m),Fl(i,t,r,y+1,h,1-m)}function wc(i,t,r,s,h,m){for(;h>s;){if(h-s>600){const P=h-s+1,A=r-s+1,D=Math.log(P),L=.5*Math.exp(2*D/3),F=.5*Math.sqrt(D*L*(P-L)/P)*(A-P/2<0?-1:1);wc(i,t,r,Math.max(s,Math.floor(r-A*L/P+F)),Math.min(h,Math.floor(r+(P-A)*L/P+F)),m)}const y=t[2*r+m];let v=s,b=h;for(Sc(i,t,s,r),t[2*h+m]>y&&Sc(i,t,s,h);v<b;){for(Sc(i,t,v,b),v++,b--;t[2*v+m]<y;)v++;for(;t[2*b+m]>y;)b--}t[2*s+m]===y?Sc(i,t,s,b):(b++,Sc(i,t,b,h)),b<=r&&(s=b+1),r<=b&&(h=b-1)}}function Sc(i,t,r,s){Mf(i,r,s),Mf(t,2*r,2*s),Mf(t,2*r+1,2*s+1)}function Mf(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}function Du(i,t,r,s){const h=i-r,m=t-s;return h*h+m*m}var zu;E.cx=void 0,(zu=E.cx||(E.cx={})).create="create",zu.load="load",zu.fullLoad="fullLoad";let Ch=null,Nl=[];const Th=1e3/60,Ah="loadTime",Pc="fullLoadTime",kp={mark(i){performance.mark(i)},frame(i){const t=i;Ch!=null&&Nl.push(t-Ch),Ch=t},clearMetrics(){Ch=null,Nl=[],performance.clearMeasures(Ah),performance.clearMeasures(Pc);for(const i in E.cx)performance.clearMarks(E.cx[i])},getPerformanceMetrics(){performance.measure(Ah,E.cx.create,E.cx.load),performance.measure(Pc,E.cx.create,E.cx.fullLoad);const i=performance.getEntriesByName(Ah)[0].duration,t=performance.getEntriesByName(Pc)[0].duration,r=Nl.length,s=1/(Nl.reduce(((m,y)=>m+y),0)/r/1e3),h=Nl.filter((m=>m>Th)).reduce(((m,y)=>m+(y-Th)/Th),0);return{loadTime:i,fullLoadTime:t,fps:s,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};E.$=At,E.A=nt,E.B=function([i,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(r),y:i*Math.sin(t)*Math.sin(r),z:i*Math.cos(r)}},E.C=eo,E.D=St,E.E=bt,E.F=Ln,E.G=qc,E.H=function(i){if(nr==null){const t=i.navigator?i.navigator.userAgent:null;nr=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return nr},E.I=pc,E.J=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new bh((()=>this.process())),this.subscription=na(this.target,"message",(r=>this.receive(r)),!1),this.globalScope=Ar(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise(((r,s)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?na(t.signal,"abort",(()=>{m?.unsubscribe(),delete this.resolveRejects[h];const b={id:h,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(b)}),hd):null;this.resolveRejects[h]={resolve:b=>{m?.unsubscribe(),r(b)},reject:b=>{m?.unsubscribe(),s(b)}};const y=[],v=Object.assign(Object.assign({},i),{id:h,sourceMapId:this.mapId,origin:location.origin,data:ka(i.data,y)});this.target.postMessage(v,{transfer:y})}))}receive(i){const t=i.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const s=this.abortControllers[r];return delete this.abortControllers[r],void(s&&s.abort())}if(Ar(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return c(this,void 0,void 0,(function*(){if(t.type==="<response>"){const h=this.resolveRejects[i];return delete this.resolveRejects[i],h?void(t.error?h.reject(Rs(t.error)):h.resolve(Rs(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Rs(t.data),s=new AbortController;this.abortControllers[i]=s;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,r,s);this.completeTask(i,null,h)}catch(h){this.completeTask(i,h)}}))}completeTask(i,t,r){const s=[];delete this.abortControllers[i];const h={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?ka(t):null,data:ka(r,s)};this.target.postMessage(h,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},E.K=$,E.L=function(){var i=new nt(16);return nt!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},E.M=function(i,t,r){var s,h,m,y,v,b,P,A,D,L,F,N,Z=r[0],X=r[1],ne=r[2];return t===i?(i[12]=t[0]*Z+t[4]*X+t[8]*ne+t[12],i[13]=t[1]*Z+t[5]*X+t[9]*ne+t[13],i[14]=t[2]*Z+t[6]*X+t[10]*ne+t[14],i[15]=t[3]*Z+t[7]*X+t[11]*ne+t[15]):(h=t[1],m=t[2],y=t[3],v=t[4],b=t[5],P=t[6],A=t[7],D=t[8],L=t[9],F=t[10],N=t[11],i[0]=s=t[0],i[1]=h,i[2]=m,i[3]=y,i[4]=v,i[5]=b,i[6]=P,i[7]=A,i[8]=D,i[9]=L,i[10]=F,i[11]=N,i[12]=s*Z+v*X+D*ne+t[12],i[13]=h*Z+b*X+L*ne+t[13],i[14]=m*Z+P*X+F*ne+t[14],i[15]=y*Z+A*X+N*ne+t[15]),i},E.N=function(i,t,r){var s=r[0],h=r[1],m=r[2];return i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*h,i[5]=t[5]*h,i[6]=t[6]*h,i[7]=t[7]*h,i[8]=t[8]*m,i[9]=t[9]*m,i[10]=t[10]*m,i[11]=t[11]*m,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},E.O=function(i,t,r){var s=t[0],h=t[1],m=t[2],y=t[3],v=t[4],b=t[5],P=t[6],A=t[7],D=t[8],L=t[9],F=t[10],N=t[11],Z=t[12],X=t[13],ne=t[14],be=t[15],le=r[0],fe=r[1],Re=r[2],Be=r[3];return i[0]=le*s+fe*v+Re*D+Be*Z,i[1]=le*h+fe*b+Re*L+Be*X,i[2]=le*m+fe*P+Re*F+Be*ne,i[3]=le*y+fe*A+Re*N+Be*be,i[4]=(le=r[4])*s+(fe=r[5])*v+(Re=r[6])*D+(Be=r[7])*Z,i[5]=le*h+fe*b+Re*L+Be*X,i[6]=le*m+fe*P+Re*F+Be*ne,i[7]=le*y+fe*A+Re*N+Be*be,i[8]=(le=r[8])*s+(fe=r[9])*v+(Re=r[10])*D+(Be=r[11])*Z,i[9]=le*h+fe*b+Re*L+Be*X,i[10]=le*m+fe*P+Re*F+Be*ne,i[11]=le*y+fe*A+Re*N+Be*be,i[12]=(le=r[12])*s+(fe=r[13])*v+(Re=r[14])*D+(Be=r[15])*Z,i[13]=le*h+fe*b+Re*L+Be*X,i[14]=le*m+fe*P+Re*F+Be*ne,i[15]=le*y+fe*A+Re*N+Be*be,i},E.P=q,E.Q=function(i,t){const r={};for(let s=0;s<t.length;s++){const h=t[s];h in i&&(r[h]=i[h])}return r},E.R=ji,E.S=qs,E.T=vu,E.U=wf,E.V=bf,E.W=Ye,E.X=We,E.Y=Ei,E.Z=Qi,E._=c,E.a=j,E.a$=jn,E.a0=function(i,t){var r,s,h,m,y;if(!i)return t??{};if(!t)return i;let v=Object.assign({},i);if(t.removeAll&&(v={removeAll:!0}),t.remove){const b=new Set(t.remove);v.add&&(v.add=v.add.filter((A=>!b.has(A.id)))),v.update&&(v.update=v.update.filter((A=>!b.has(A.id))));const P=new Set(((r=i.add)!==null&&r!==void 0?r:[]).map((A=>A.id)));t.remove=t.remove.filter((A=>!P.has(A)))}if(t.remove){const b=new Set(v.remove?v.remove.concat(t.remove):t.remove);v.remove=Array.from(b.values())}if(t.add){const b=v.add?v.add.concat(t.add):t.add,P=new Map(b.map((A=>[A.id,A])));v.add=Array.from(P.values())}if(t.update){const b=new Map((s=v.update)===null||s===void 0?void 0:s.map((P=>[P.id,P])));for(const P of t.update){const A=(h=b.get(P.id))!==null&&h!==void 0?h:{id:P.id};P.newGeometry&&(A.newGeometry=P.newGeometry),P.addOrUpdateProperties&&(A.addOrUpdateProperties=((m=A.addOrUpdateProperties)!==null&&m!==void 0?m:[]).concat(P.addOrUpdateProperties)),P.removeProperties&&(A.removeProperties=((y=A.removeProperties)!==null&&y!==void 0?y:[]).concat(P.removeProperties)),P.removeAllProperties&&(A.removeAllProperties=!0),b.set(P.id,A)}v.update=Array.from(b.values())}return v.remove&&v.add&&(v.remove=v.remove.filter((b=>v.add.findIndex((P=>P.id===b))===-1))),v},E.a1=Hr,E.a2=Hs,E.a3=25,E.a4=Sh,E.a5=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const s of i){const h=window.document.createElement("source");Me(s)||(t.crossOrigin="Anonymous"),h.src=s,t.appendChild(h)}}))},E.a6=it,E.a7=function(){return En++},E.a8=W,E.a9=Il,E.aA=function(i){let t=1/0,r=1/0,s=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),r=Math.min(r,m.y),s=Math.max(s,m.x),h=Math.max(h,m.y);return[t,r,s,h]},E.aB=qr,E.aC=me,E.aD=function(i,t,r,s,h=!1){if(!r[0]&&!r[1])return[0,0];const m=h?s==="map"?-i.bearingInRadians:0:s==="viewport"?i.bearingInRadians:0;if(m){const y=Math.sin(m),v=Math.cos(m);r=[r[0]*v-r[1]*y,r[0]*y+r[1]*v]}return[h?r[0]:me(t,r[0],i.zoom),h?r[1]:me(t,r[1],i.zoom)]},E.aF=od,E.aG=Ef,E.aH=hf,E.aI=yd,E.aJ=pr,E.aK=Sa,E.aL=Le,E.aM=vn,E.aN=Nn,E.aO=Zt,E.aP=Ta,E.aQ=dd,E.aR=pn,E.aS=Gt,E.aT=function(i){var t=new nt(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},E.aU=function(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i},E.aV=function(i,t){var r=t[0],s=t[1],h=t[2],m=r*r+s*s+h*h;return m>0&&(m=1/Math.sqrt(m)),i[0]=t[0]*m,i[1]=t[1]*m,i[2]=t[2]*m,i},E.aW=nn,E.aX=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},E.aY=function(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i[3]=t[3]*r[3],i},E.aZ=It,E.a_=function(i,t,r){const s=t[0]*r[0]+t[1]*r[1]+t[2]*r[2];return s===0?null:(-(i[0]*r[0]+i[1]*r[1]+i[2]*r[2])-r[3])/s},E.aa=bo,E.ab=Os,E.ac=Pp,E.ad=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((r,s,h,m)=>{const y=h||m;return t[s]=!y||y.toLowerCase(),""})),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},E.ae=Za,E.af=function(i){return Math.pow(2,i)},E.ag=xt,E.ah=Dt,E.ai=85.051129,E.aj=wh,E.ak=function(i){return Math.log(i)/Math.LN2},E.al=function(i){var t=i[0],r=i[1];return t*t+r*r},E.am=function(i,t){const r=[];for(const s in i)s in t||r.push(s);return r},E.an=function(i,t){let r=0,s=0;if(i.kind==="constant")s=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,v=h?Dt(di.interpolationFactor(h,t,m,y),0,1):0;i.kind==="camera"?s=eo.number(i.minSize,i.maxSize,v):r=v}return{uSizeT:r,uSize:s}},E.ap=function(i,{uSize:t,uSizeT:r},{lowerSize:s,upperSize:h}){return i.kind==="source"?s/Ws:i.kind==="composite"?eo.number(s/Ws,h/Ws,r):t},E.aq=function(i,t){var r=t[0],s=t[1],h=t[2],m=t[3],y=t[4],v=t[5],b=t[6],P=t[7],A=t[8],D=t[9],L=t[10],F=t[11],N=t[12],Z=t[13],X=t[14],ne=t[15],be=r*v-s*y,le=r*b-h*y,fe=r*P-m*y,Re=s*b-h*v,Be=s*P-m*v,Ke=h*P-m*b,dt=A*Z-D*N,at=A*X-L*N,ft=A*ne-F*N,Rt=D*X-L*Z,ot=D*ne-F*Z,lt=L*ne-F*X,Ve=be*lt-le*ot+fe*Rt+Re*ft-Be*at+Ke*dt;return Ve?(i[0]=(v*lt-b*ot+P*Rt)*(Ve=1/Ve),i[1]=(h*ot-s*lt-m*Rt)*Ve,i[2]=(Z*Ke-X*Be+ne*Re)*Ve,i[3]=(L*Be-D*Ke-F*Re)*Ve,i[4]=(b*ft-y*lt-P*at)*Ve,i[5]=(r*lt-h*ft+m*at)*Ve,i[6]=(X*fe-N*Ke-ne*le)*Ve,i[7]=(A*Ke-L*fe+F*le)*Ve,i[8]=(y*ot-v*ft+P*dt)*Ve,i[9]=(s*ft-r*ot-m*dt)*Ve,i[10]=(N*Be-Z*fe+ne*be)*Ve,i[11]=(D*fe-A*Be-F*be)*Ve,i[12]=(v*at-y*Rt-b*dt)*Ve,i[13]=(r*Rt-s*at+h*dt)*Ve,i[14]=(Z*le-N*Re-X*be)*Ve,i[15]=(A*Re-D*le+L*be)*Ve,i):null},E.ar=ht,E.as=function(i){var t=i[0],r=i[1];return Math.sqrt(t*t+r*r)},E.at=function(i){return i[0]=0,i[1]=0,i},E.au=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i},E.av=vh,E.aw=er,E.ax=function(i,t,r,s){const h=t.y-i.y,m=t.x-i.x,y=s.y-r.y,v=s.x-r.x,b=y*m-v*h;if(b===0)return null;const P=(v*(i.y-r.y)-y*(i.x-r.x))/b;return new q(i.x+P*m,i.y+P*h)},E.ay=Ap,E.az=Yc,E.b=Kr,E.b$=class extends a{},E.b0=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},E.b1=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]},E.b2=fd,E.b3=Ru,E.b4=function(i,t,r,s,h){var m=1/Math.tan(t/2);if(i[0]=m/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0){var y=1/(s-h);i[10]=(h+s)*y,i[14]=2*h*s*y}else i[10]=-1,i[14]=-2*s;return i},E.b5=function(i){var t=new nt(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},E.b6=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[0],y=t[1],v=t[2],b=t[3],P=t[4],A=t[5],D=t[6],L=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h+P*s,i[1]=y*h+A*s,i[2]=v*h+D*s,i[3]=b*h+L*s,i[4]=P*h-m*s,i[5]=A*h-y*s,i[6]=D*h-v*s,i[7]=L*h-b*s,i},E.b7=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[4],y=t[5],v=t[6],b=t[7],P=t[8],A=t[9],D=t[10],L=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=m*h+P*s,i[5]=y*h+A*s,i[6]=v*h+D*s,i[7]=b*h+L*s,i[8]=P*h-m*s,i[9]=A*h-y*s,i[10]=D*h-v*s,i[11]=L*h-b*s,i},E.b8=function(){const i=new Float32Array(16);return xt(i),i},E.b9=function(){const i=new Float64Array(16);return xt(i),i},E.bA=function(i,t){const r=Ze(i,360),s=Ze(t,360),h=s-r,m=s>r?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},E.bB=function(i){return i[0]=0,i[1]=0,i[2]=0,i},E.bC=function(i,t,r,s){const h=Math.sqrt(i*i+t*t),m=Math.sqrt(r*r+s*s);i/=h,t/=h,r/=m,s/=m;const y=Math.acos(i*r+t*s);return-t*r+i*s>0?y:-y},E.bD=function(i,t){const r=Ze(i,2*Math.PI),s=Ze(t,2*Math.PI);return Math.min(Math.abs(r-s),Math.abs(r-s+2*Math.PI),Math.abs(r-s-2*Math.PI))},E.bE=function(){const i={},t=xe.$version;for(const r in xe.$root){const s=xe.$root[r];if(s.required){let h=null;h=r==="version"?t:s.type==="array"?[]:{},h!=null&&(i[r]=h)}}return i},E.bF=Qu,E.bG=he,E.bH=function i(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(!i(t[s],r[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(!i(t[s],r[s]))return!1;return!0}return t===r},E.bI=function(i){i=i.slice();const t=Object.create(null);for(let r=0;r<i.length;r++)t[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=hn(i[r],t[i[r].ref]));return i},E.bJ=function(i,t){if(i.type==="custom")return new xf(i,t);switch(i.type){case"background":return new _f(i,t);case"circle":return new Ld(i,t);case"color-relief":return new tm(i,t);case"fill":return new uh(i,t);case"fill-extrusion":return new js(i,t);case"heatmap":return new Od(i,t);case"hillshade":return new Fs(i,t);case"line":return new zl(i,t);case"raster":return new xp(i,t);case"symbol":return new cd(i,t)}},E.bK=vt,E.bL=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let r=[];try{if(!Mt(i.version,t.version))return[{command:"setStyle",args:[t]}];Mt(i.center,t.center)||r.push({command:"setCenter",args:[t.center]}),Mt(i.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),Mt(i.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Mt(i.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),Mt(i.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),Mt(i.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),Mt(i.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),Mt(i.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),Mt(i.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),Mt(i.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),Mt(i.light,t.light)||r.push({command:"setLight",args:[t.light]}),Mt(i.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),Mt(i.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),Mt(i.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const s={},h=[];(function(y,v,b,P){let A;for(A in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,A)&&(Object.prototype.hasOwnProperty.call(v,A)||Fr(A,b,P));for(A in v)Object.prototype.hasOwnProperty.call(v,A)&&(Object.prototype.hasOwnProperty.call(y,A)?Mt(y[A],v[A])||(y[A].type==="geojson"&&v[A].type==="geojson"&&Vn(y,v,A)?Ht(b,{command:"setGeoJSONSourceData",args:[A,v[A].data]}):Vr(A,v,b,P)):zn(A,v,b))})(i.sources,t.sources,h,s);const m=[];i.layers&&i.layers.forEach((y=>{"source"in y&&s[y.source]?r.push({command:"removeLayer",args:[y.id]}):m.push(y)})),r=r.concat(h),(function(y,v,b){v=v||[];const P=(y=y||[]).map($t),A=v.map($t),D=y.reduce(lr,{}),L=v.reduce(lr,{}),F=P.slice(),N=Object.create(null);let Z,X,ne,be,le;for(let fe=0,Re=0;fe<P.length;fe++)Z=P[fe],Object.prototype.hasOwnProperty.call(L,Z)?Re++:(Ht(b,{command:"removeLayer",args:[Z]}),F.splice(F.indexOf(Z,Re),1));for(let fe=0,Re=0;fe<A.length;fe++)Z=A[A.length-1-fe],F[F.length-1-fe]!==Z&&(Object.prototype.hasOwnProperty.call(D,Z)?(Ht(b,{command:"removeLayer",args:[Z]}),F.splice(F.lastIndexOf(Z,F.length-Re),1)):Re++,be=F[F.length-fe],Ht(b,{command:"addLayer",args:[L[Z],be]}),F.splice(F.length-fe,0,Z),N[Z]=!0);for(let fe=0;fe<A.length;fe++)if(Z=A[fe],X=D[Z],ne=L[Z],!N[Z]&&!Mt(X,ne))if(Mt(X.source,ne.source)&&Mt(X["source-layer"],ne["source-layer"])&&Mt(X.type,ne.type)){for(le in Nt(X.layout,ne.layout,b,Z,null,"setLayoutProperty"),Nt(X.paint,ne.paint,b,Z,null,"setPaintProperty"),Mt(X.filter,ne.filter)||Ht(b,{command:"setFilter",args:[Z,ne.filter]}),Mt(X.minzoom,ne.minzoom)&&Mt(X.maxzoom,ne.maxzoom)||Ht(b,{command:"setLayerZoomRange",args:[Z,ne.minzoom,ne.maxzoom]}),X)Object.prototype.hasOwnProperty.call(X,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Nt(X[le],ne[le],b,Z,le.slice(6),"setPaintProperty"):Mt(X[le],ne[le])||Ht(b,{command:"setLayerProperty",args:[Z,le,ne[le]]}));for(le in ne)Object.prototype.hasOwnProperty.call(ne,le)&&!Object.prototype.hasOwnProperty.call(X,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?Nt(X[le],ne[le],b,Z,le.slice(6),"setPaintProperty"):Mt(X[le],ne[le])||Ht(b,{command:"setLayerProperty",args:[Z,le,ne[le]]}))}else Ht(b,{command:"removeLayer",args:[Z]}),be=F[F.lastIndexOf(Z)+1],Ht(b,{command:"addLayer",args:[ne,be]})})(m,t.layers,r)}catch(s){console.warn("Unable to compute style diff:",s),r=[{command:"setStyle",args:[t]}]}return r},E.bM=function(i){const t=[],r=i.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},E.bN=tr,E.bO=xn,E.bP=class extends Dn{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},E.bQ=xr,E.bR=class extends Dn{constructor(i,t){super(i,t),this.current=ic}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},E.bS=wi,E.bT=class extends Dn{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},E.bU=class extends Dn{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},E.bV=wt,E.bW=function(i,t){var r=Math.sin(t),s=Math.cos(t);return i[0]=s,i[1]=r,i[2]=0,i[3]=-r,i[4]=s,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},E.bX=function(i,t,r){var s=t[0],h=t[1],m=t[2];return i[0]=s*r[0]+h*r[3]+m*r[6],i[1]=s*r[1]+h*r[4]+m*r[7],i[2]=s*r[2]+h*r[5]+m*r[8],i},E.bY=function(i,t,r,s,h,m,y){var v=1/(t-r),b=1/(s-h),P=1/(m-y);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*P,i[11]=0,i[12]=(t+r)*v,i[13]=(h+s)*b,i[14]=(y+m)*P,i[15]=1,i},E.bZ=class extends Dn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(4*i.length);for(let r=0;r<i.length;r++)t[4*r]=i[r].r,t[4*r+1]=i[r].g,t[4*r+2]=i[r].b,t[4*r+3]=i[r].a;this.gl.uniform4fv(this.location,t)}}},E.b_=class extends Dn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(i);this.gl.uniform1fv(this.location,t)}}},E.ba=function(){return new Float64Array(16)},E.bb=function(i,t,r){const s=new Float64Array(4);return Ue(s,i,t-90,r),s},E.bc=function(i,t,r,s){var h,m,y,v,b,P=t[0],A=t[1],D=t[2],L=t[3],F=r[0],N=r[1],Z=r[2],X=r[3];return(m=P*F+A*N+D*Z+L*X)<0&&(m=-m,F=-F,N=-N,Z=-Z,X=-X),1-m>He?(h=Math.acos(m),y=Math.sin(h),v=Math.sin((1-s)*h)/y,b=Math.sin(s*h)/y):(v=1-s,b=s),i[0]=v*P+b*F,i[1]=v*A+b*N,i[2]=v*D+b*Z,i[3]=v*L+b*X,i},E.bd=function(i){const t=new Float64Array(9);var r,s,h,m,y,v,b,P,A,D,L,F,N,Z,X,ne,be,le;D=(h=(s=i)[0])*(b=h+h),L=(m=s[1])*b,N=(y=s[2])*b,Z=y*(P=m+m),ne=(v=s[3])*b,be=v*P,le=v*(A=y+y),(r=t)[0]=1-(F=m*P)-(X=y*A),r[3]=L-le,r[6]=N+be,r[1]=L+le,r[4]=1-D-X,r[7]=Z-ne,r[2]=N-be,r[5]=Z+ne,r[8]=1-D-F;const fe=Ta(-Math.asin(Dt(t[2],-1,1)));let Re,Be;return Math.hypot(t[5],t[8])<.001?(Re=0,Be=-Ta(Math.atan2(t[3],t[4]))):(Re=Ta(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Be=Ta(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Re,pitch:fe+90,bearing:Be}},E.be=function(i,t){return i.roll==t.roll&&i.pitch==t.pitch&&i.bearing==t.bearing},E.bf=cn,E.bg=hr,E.bh=bu,E.bi=Gi,E.bj=Pi,E.bk=gt,E.bl=rt,E.bm=vr,E.bn=function(i,t,r,s,h){return gt(s,h,Dt((i-t)/(r-t),0,1))},E.bo=Ze,E.bp=function(){return new Float64Array(3)},E.bq=function(i,t,r,s){return i[0]=t[0]+r[0]*s,i[1]=t[1]+r[1]*s,i[2]=t[2]+r[2]*s,i},E.br=Ue,E.bs=function(i,t,r){var s=r[0],h=r[1],m=r[2],y=r[3],v=t[0],b=t[1],P=t[2],A=h*P-m*b,D=m*v-s*P,L=s*b-h*v;return i[0]=v+y*(A+=A)+h*(L+=L)-m*(D+=D),i[1]=b+y*D+m*A-s*L,i[2]=P+y*L+s*D-h*A,i},E.bt=function(i,t,r){const s=(h=[i[0],i[1],i[2],t[0],t[1],t[2],r[0],r[1],r[2]])[0]*((A=h[8])*(y=h[4])-(v=h[5])*(P=h[7]))+h[1]*(-A*(m=h[3])+v*(b=h[6]))+h[2]*(P*m-y*b);var h,m,y,v,b,P,A;if(s===0)return null;const D=nn([],[t[0],t[1],t[2]],[r[0],r[1],r[2]]),L=nn([],[r[0],r[1],r[2]],[i[0],i[1],i[2]]),F=nn([],[i[0],i[1],i[2]],[t[0],t[1],t[2]]),N=pn([],D,-i[3]);return Gt(N,N,pn([],L,-t[3])),Gt(N,N,pn([],F,-r[3])),pn(N,N,1/s),N},E.bu=Ll,E.bv=function(){return new Float64Array(4)},E.bw=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[0]*Math.cos(s)-h[1]*Math.sin(s),m[1]=h[0]*Math.sin(s)+h[1]*Math.cos(s),m[2]=h[2],i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},E.bx=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[0],m[1]=h[1]*Math.cos(s)-h[2]*Math.sin(s),m[2]=h[1]*Math.sin(s)+h[2]*Math.cos(s),i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},E.by=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[2]*Math.sin(s)+h[0]*Math.cos(s),m[1]=h[1],m[2]=h[2]*Math.cos(s)-h[0]*Math.sin(s),i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},E.bz=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[0],y=t[1],v=t[2],b=t[3],P=t[8],A=t[9],D=t[10],L=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h-P*s,i[1]=y*h-A*s,i[2]=v*h-D*s,i[3]=b*h-L*s,i[8]=m*s+P*h,i[9]=y*s+A*h,i[10]=v*s+D*h,i[11]=b*s+L*h,i},E.c=ge,E.c0=ph,E.c1=class extends d{},E.c2=Lo,E.c3=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},E.c4=kd,E.c5=function(i,t,r){var s=t[0],h=t[1],m=t[2],y=r[3]*s+r[7]*h+r[11]*m+r[15];return i[0]=(r[0]*s+r[4]*h+r[8]*m+r[12])/(y=y||1),i[1]=(r[1]*s+r[5]*h+r[9]*m+r[13])/y,i[2]=(r[2]*s+r[6]*h+r[10]*m+r[14])/y,i},E.c6=class extends Eo{},E.c7=class extends I{},E.c8=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},E.c9=function(i,t){var r=i[0],s=i[1],h=i[2],m=i[3],y=i[4],v=i[5],b=i[6],P=i[7],A=i[8],D=i[9],L=i[10],F=i[11],N=i[12],Z=i[13],X=i[14],ne=i[15],be=t[0],le=t[1],fe=t[2],Re=t[3],Be=t[4],Ke=t[5],dt=t[6],at=t[7],ft=t[8],Rt=t[9],ot=t[10],lt=t[11],Ve=t[12],Bt=t[13],Ut=t[14],Et=t[15];return Math.abs(r-be)<=He*Math.max(1,Math.abs(r),Math.abs(be))&&Math.abs(s-le)<=He*Math.max(1,Math.abs(s),Math.abs(le))&&Math.abs(h-fe)<=He*Math.max(1,Math.abs(h),Math.abs(fe))&&Math.abs(m-Re)<=He*Math.max(1,Math.abs(m),Math.abs(Re))&&Math.abs(y-Be)<=He*Math.max(1,Math.abs(y),Math.abs(Be))&&Math.abs(v-Ke)<=He*Math.max(1,Math.abs(v),Math.abs(Ke))&&Math.abs(b-dt)<=He*Math.max(1,Math.abs(b),Math.abs(dt))&&Math.abs(P-at)<=He*Math.max(1,Math.abs(P),Math.abs(at))&&Math.abs(A-ft)<=He*Math.max(1,Math.abs(A),Math.abs(ft))&&Math.abs(D-Rt)<=He*Math.max(1,Math.abs(D),Math.abs(Rt))&&Math.abs(L-ot)<=He*Math.max(1,Math.abs(L),Math.abs(ot))&&Math.abs(F-lt)<=He*Math.max(1,Math.abs(F),Math.abs(lt))&&Math.abs(N-Ve)<=He*Math.max(1,Math.abs(N),Math.abs(Ve))&&Math.abs(Z-Bt)<=He*Math.max(1,Math.abs(Z),Math.abs(Bt))&&Math.abs(X-Ut)<=He*Math.max(1,Math.abs(X),Math.abs(Ut))&&Math.abs(ne-Et)<=He*Math.max(1,Math.abs(ne),Math.abs(Et))},E.cA=function(i,t){j.REGISTERED_PROTOCOLS[i]=t},E.cB=function(i){delete j.REGISTERED_PROTOCOLS[i]},E.cC=function(i,t){const r={};for(let h=0;h<i.length;h++){const m=t&&t[i[h].id]||Gc(i[h]);t&&(t[i[h].id]=m);let y=r[m];y||(y=r[m]=[]),y.push(i[h])}const s=[];for(const h in r)s.push(r[h]);return s},E.cD=_t,E.cE=pd,E.cF=Sf,E.cG=of,E.cH=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=At/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],r=t.layout,s=t._unevaluatedLayout._values,h={layoutIconSize:s["icon-size"].possiblyEvaluate(new Ln(i.bucket.zoom+1),i.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Ln(i.bucket.zoom+1),i.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Ln(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:P,maxZoom:A}=i.bucket.textSizeData;h.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Ln(P),i.canonical),s["text-size"].possiblyEvaluate(new Ln(A),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:P,maxZoom:A}=i.bucket.iconSizeData;h.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Ln(P),i.canonical),s["icon-size"].possiblyEvaluate(new Ln(A),i.canonical)]}const m=r.get("text-line-height")*qr,y=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),b=r.get("text-size");for(const P of i.bucket.features){const A=r.get("text-font").evaluate(P,{},i.canonical).join(","),D=b.evaluate(P,{},i.canonical),L=h.layoutTextSize.evaluate(P,{},i.canonical),F=h.layoutIconSize.evaluate(P,{},i.canonical),N={horizontal:{},vertical:void 0},Z=P.text;let X,ne=[0,0];if(Z){const fe=Z.toString(),Re=r.get("text-letter-spacing").evaluate(P,{},i.canonical)*qr,Be=Ju(fe)?Re:0,Ke=r.get("text-anchor").evaluate(P,{},i.canonical),dt=Dp(t,P,i.canonical);if(!dt){const ot=r.get("text-radial-offset").evaluate(P,{},i.canonical);ne=ot?Af(Ke,[ot*qr,Bl]):r.get("text-offset").evaluate(P,{},i.canonical).map((lt=>lt*qr))}let at=y?"center":r.get("text-justify").evaluate(P,{},i.canonical);const ft=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(P,{},i.canonical)*qr:1/0,Rt=()=>{i.bucket.allowVerticalPlacement&&mu(fe)&&(N.vertical=gh(Z,i.glyphMap,i.glyphPositions,i.imagePositions,A,ft,m,Ke,"left",Be,ne,E.ao.vertical,!0,L,D))};if(!y&&dt){const ot=new Set;if(at==="auto")for(let Ve=0;Ve<dt.values.length;Ve+=2)ot.add(Ef(dt.values[Ve]));else ot.add(at);let lt=!1;for(const Ve of ot)if(!N.horizontal[Ve])if(lt)N.horizontal[Ve]=N.horizontal[0];else{const Bt=gh(Z,i.glyphMap,i.glyphPositions,i.imagePositions,A,ft,m,"center",Ve,Be,ne,E.ao.horizontal,!1,L,D);Bt&&(N.horizontal[Ve]=Bt,lt=Bt.positionedLines.length===1)}Rt()}else{at==="auto"&&(at=Ef(Ke));const ot=gh(Z,i.glyphMap,i.glyphPositions,i.imagePositions,A,ft,m,Ke,at,Be,ne,E.ao.horizontal,!1,L,D);ot&&(N.horizontal[at]=ot),Rt(),mu(fe)&&y&&v&&(N.vertical=gh(Z,i.glyphMap,i.glyphPositions,i.imagePositions,A,ft,m,Ke,at,Be,ne,E.ao.vertical,!1,L,D))}}let be=!1;if(P.icon&&P.icon.name){const fe=i.imageMap[P.icon.name];fe&&(X=Mu(i.imagePositions[P.icon.name],r.get("icon-offset").evaluate(P,{},i.canonical),r.get("icon-anchor").evaluate(P,{},i.canonical)),be=!!fe.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=be:i.bucket.sdfIcons!==be&&un("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(fe.pixelRatio!==i.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const le=Ip(N.horizontal)||N.vertical;i.bucket.iconsInText=!!le&&le.iconsInText,(le||X)&&lm(i.bucket,P,N,X,i.imageMap,h,L,F,ne,be,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},E.cI=hh,E.cJ=uo,E.cK=An,E.cL=up,E.cM=tf,E.cN=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},E.cO=function(i,t,r,s,h){return c(this,void 0,void 0,(function*(){if(We())try{return yield Ei(i,t,r,s,h)}catch{}return(function(m,y,v,b,P){const A=m.width,D=m.height;oi&&ga||(oi=new OffscreenCanvas(A,D),ga=oi.getContext("2d",{willReadFrequently:!0})),oi.width=A,oi.height=D,ga.drawImage(m,0,0,A,D);const L=ga.getImageData(y,v,b,P);return ga.clearRect(0,0,A,D),L.data})(i,t,r,s,h)}))},E.cP=Cr,E.cQ=te,E.cR=qd,E.cS=ss,E.cT=no,E.cU=function(i,t){const r=new Map;if(i!=null)if(i.type==="Feature")r.set(vc(i,t),i);else for(const s of i.features)r.set(vc(s,t),s);return r},E.cV=function(i,t){if(i==null)return!0;if(i.type==="Feature")return vc(i,t)!=null;if(i.type==="FeatureCollection"){const r=new Set;for(const s of i.features){const h=vc(s,t);if(h==null||r.has(h))return!1;r.add(h)}return!0}return!1},E.cW=function(i,t,r){var s,h,m,y;if(t.removeAll&&i.clear(),t.remove)for(const v of t.remove)i.delete(v);if(t.add)for(const v of t.add){const b=vc(v,r);b!=null&&i.set(b,v)}if(t.update)for(const v of t.update){let b=i.get(v.id);if(b==null)continue;const P=!v.removeAllProperties&&(((s=v.removeProperties)===null||s===void 0?void 0:s.length)>0||((h=v.addOrUpdateProperties)===null||h===void 0?void 0:h.length)>0);if((v.newGeometry||v.removeAllProperties||P)&&(b=Object.assign({},b),i.set(v.id,b),P&&(b.properties=Object.assign({},b.properties))),v.newGeometry&&(b.geometry=v.newGeometry),v.removeAllProperties)b.properties={};else if(((m=v.removeProperties)===null||m===void 0?void 0:m.length)>0)for(const A of v.removeProperties)Object.prototype.hasOwnProperty.call(b.properties,A)&&delete b.properties[A];if(((y=v.addOrUpdateProperties)===null||y===void 0?void 0:y.length)>0)for(const{key:A,value:D}of v.addOrUpdateProperties)b.properties[A]=D}},E.cX=Oa,E.ca=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},E.cb=i=>i.type==="symbol",E.cc=i=>i.type==="circle",E.cd=i=>i.type==="heatmap",E.ce=i=>i.type==="line",E.cf=i=>i.type==="fill",E.cg=i=>i.type==="fill-extrusion",E.ch=i=>i.type==="hillshade",E.ci=i=>i.type==="color-relief",E.cj=i=>i.type==="raster",E.ck=i=>i.type==="background",E.cl=i=>i.type==="custom",E.cm=yt,E.cn=function(i,t,r){const s=tt(t.x-r.x,t.y-r.y),h=tt(i.x-r.x,i.y-r.y);var m,y;return Ta(Math.atan2(s[0]*h[1]-s[1]*h[0],(m=s)[0]*(y=h)[0]+m[1]*y[1]))},E.co=Kt,E.cp=function(i,t){return gr[t]&&(i instanceof MouseEvent||i instanceof WheelEvent)},E.cq=function(i,t){return qi[t]&&"touches"in i},E.cr=function(i){return qi[i]||gr[i]},E.cs=function(i,t,r){var s=t[0],h=t[1];return i[0]=r[0]*s+r[4]*h+r[12],i[1]=r[1]*s+r[5]*h+r[13],i},E.ct=function(i,t){const{x:r,y:s}=Hr.fromLngLat(t);return!(i<0||i>25||s<0||s>=1||r<0||r>=1)},E.cu=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},E.cv=class extends ir{},E.cw=kp,E.cy=function(i){return i.message===Mi},E.cz=oe,E.d=Me,E.e=Vt,E.f=i=>c(void 0,void 0,void 0,(function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),E.g=V,E.h=i=>new Promise(((t,r)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame((()=>{s.src=Br}))},s.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});s.src=i.byteLength?URL.createObjectURL(h):Br})),E.i=Ar,E.j=(i,t)=>ye(Vt(i,{type:"json"}),t),E.k=qe,E.l=et,E.m=ye,E.n=(i,t)=>ye(Vt(i,{type:"arrayBuffer"}),t),E.o=function(i){return new tf(i).readFields(am,[])},E.p=Au,E.q=lc,E.r=ei,E.s=na,E.t=fn,E.u=en,E.v=xe,E.w=un,E.x=La,E.y=bl,E.z=Es})),Q("worker",["./shared"],(function(E){class c{constructor(j,V){this.keyCache={},j&&this.replace(j,V)}replace(j,V){this._layerConfigs={},this._layers={},this.update(j,[],V)}update(j,V,$){for(const he of j){this._layerConfigs[he.id]=he;const ye=this._layers[he.id]=E.bJ(he,$);ye._featureFilter=E.aa(ye.filter,$),this.keyCache[he.id]&&delete this.keyCache[he.id]}for(const he of V)delete this.keyCache[he],delete this._layerConfigs[he],delete this._layers[he];this.familiesBySource={};const oe=E.cC(Object.values(this._layerConfigs),this.keyCache);for(const he of oe){const ye=he.map((bt=>this._layers[bt.id])),Me=ye[0];if(Me.visibility==="none")continue;const ve=Me.source||"";let Ne=this.familiesBySource[ve];Ne||(Ne=this.familiesBySource[ve]={});const et=Me.sourceLayer||"_geojsonTileLayer";let qe=Ne[et];qe||(qe=Ne[et]=[]),qe.push(ye)}}}class q{constructor(j){const V={},$=[];for(const Me in j){const ve=j[Me],Ne=V[Me]={};for(const et in ve){const qe=ve[+et];if(!qe||qe.bitmap.width===0||qe.bitmap.height===0)continue;const bt={x:0,y:0,w:qe.bitmap.width+2,h:qe.bitmap.height+2};$.push(bt),Ne[et]={rect:bt,metrics:qe.metrics}}}const{w:oe,h:he}=E.p($),ye=new E.q({width:oe||1,height:he||1});for(const Me in j){const ve=j[Me];for(const Ne in ve){const et=ve[+Ne];if(!et||et.bitmap.width===0||et.bitmap.height===0)continue;const qe=V[Me][Ne].rect;E.q.copy(et.bitmap,ye,{x:0,y:0},{x:qe.x+1,y:qe.y+1},et.bitmap)}}this.image=ye,this.positions=V}}E.cD("GlyphAtlas",q);class te{constructor(j){this.tileID=new E.Z(j.tileID.overscaledZ,j.tileID.wrap,j.tileID.canonical.z,j.tileID.canonical.x,j.tileID.canonical.y),this.uid=j.uid,this.zoom=j.zoom,this.pixelRatio=j.pixelRatio,this.tileSize=j.tileSize,this.source=j.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=j.showCollisionBoxes,this.collectResourceTiming=!!j.collectResourceTiming,this.returnDependencies=!!j.returnDependencies,this.promoteId=j.promoteId,this.inFlightDependencies=[]}parse(j,V,$,oe,he){return E._(this,void 0,void 0,(function*(){this.status="parsing",this.data=j,this.collisionBoxArray=new E.a8;const ye=new E.cE(Object.keys(j.layers).sort()),Me=new E.cF(this.tileID,this.promoteId);Me.bucketLayerIDs=[];const ve={},Ne={featureIndex:Me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:$,subdivisionGranularity:he},et=V.familiesBySource[this.source];for(const Nt in et){const $t=j.layers[Nt];if(!$t)continue;$t.version===1&&E.w(`Vector tile source "${this.source}" layer "${Nt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lr=ye.encode(Nt),it=[];for(let yi=0;yi<$t.length;yi++){const yr=$t.feature(yi),fo=Me.getId(yr,Nt);it.push({feature:yr,id:fo,index:yi,sourceLayerIndex:lr})}for(const yi of et[Nt]){const yr=yi[0];yr.source!==this.source&&E.w(`layer.source = ${yr.source} does not equal this.source = ${this.source}`),yr.minzoom&&this.zoom<Math.floor(yr.minzoom)||yr.maxzoom&&this.zoom>=yr.maxzoom||yr.visibility!=="none"&&(Se(yi,this.zoom,$),(ve[yr.id]=yr.createBucket({index:Me.bucketLayerIDs.length,layers:yi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lr,sourceID:this.source})).populate(it,Ne,this.tileID.canonical),Me.bucketLayerIDs.push(yi.map((fo=>fo.id))))}}const qe=E.bN(Ne.glyphDependencies,(Nt=>Object.keys(Nt).map(Number)));this.inFlightDependencies.forEach((Nt=>Nt?.abort())),this.inFlightDependencies=[];let bt=Promise.resolve({});if(Object.keys(qe).length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),bt=oe.sendAsync({type:"GG",data:{stacks:qe,source:this.source,tileID:this.tileID,type:"glyphs"}},Nt)}const xe=Object.keys(Ne.iconDependencies);let Wt=Promise.resolve({});if(xe.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),Wt=oe.sendAsync({type:"GI",data:{icons:xe,source:this.source,tileID:this.tileID,type:"icons"}},Nt)}const hn=Object.keys(Ne.patternDependencies);let Mt=Promise.resolve({});if(hn.length){const Nt=new AbortController;this.inFlightDependencies.push(Nt),Mt=oe.sendAsync({type:"GI",data:{icons:hn,source:this.source,tileID:this.tileID,type:"patterns"}},Nt)}const[Ht,zn,Fr]=yield Promise.all([bt,Wt,Mt]),Vr=new q(Ht),Vn=new E.cG(zn,Fr);for(const Nt in ve){const $t=ve[Nt];$t instanceof E.a9?(Se($t.layers,this.zoom,$),E.cH({bucket:$t,glyphMap:Ht,glyphPositions:Vr.positions,imageMap:zn,imagePositions:Vn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ne.subdivisionGranularity})):$t.hasPattern&&($t instanceof E.cI||$t instanceof E.cJ||$t instanceof E.cK)&&(Se($t.layers,this.zoom,$),$t.addFeatures(Ne,this.tileID.canonical,Vn.patternPositions))}return this.status="done",{buckets:Object.values(ve).filter((Nt=>!Nt.isEmpty())),featureIndex:Me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vr.image,imageAtlas:Vn,glyphMap:this.returnDependencies?Ht:null,iconMap:this.returnDependencies?zn:null,glyphPositions:this.returnDependencies?Vr.positions:null}}))}}function Se(ge,j,V){const $=new E.F(j);for(const oe of ge)oe.recalculate($,V)}class ze{constructor(j,V,$){this.actor=j,this.layerIndex=V,this.availableImages=$,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(j,V){return E._(this,void 0,void 0,(function*(){const $=yield E.n(j.request,V);try{return{vectorTile:new E.cL(new E.cM($.data)),rawData:$.data,cacheControl:$.cacheControl,expires:$.expires}}catch(oe){const he=new Uint8Array($.data);let ye=`Unable to parse the tile at ${j.request.url}, `;throw ye+=he[0]===31&&he[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${oe.message}`,new Error(ye)}}))}loadTile(j){return E._(this,void 0,void 0,(function*(){const V=j.uid,$=!!(j&&j.request&&j.request.collectResourceTiming)&&new E.cN(j.request),oe=new te(j);this.loading[V]=oe;const he=new AbortController;oe.abort=he;try{const ye=yield this.loadVectorTile(j,he);if(delete this.loading[V],!ye)return null;const Me=ye.rawData,ve={};ye.expires&&(ve.expires=ye.expires),ye.cacheControl&&(ve.cacheControl=ye.cacheControl);const Ne={};if($){const qe=$.finish();qe&&(Ne.resourceTiming=JSON.parse(JSON.stringify(qe)))}oe.vectorTile=ye.vectorTile;const et=oe.parse(ye.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity);this.loaded[V]=oe,this.fetching[V]={rawTileData:Me,cacheControl:ve,resourceTiming:Ne};try{const qe=yield et;return E.e({rawTileData:Me.slice(0)},qe,ve,Ne)}finally{delete this.fetching[V]}}catch(ye){throw delete this.loading[V],oe.status="done",this.loaded[V]=oe,ye}}))}reloadTile(j){return E._(this,void 0,void 0,(function*(){const V=j.uid;if(!this.loaded||!this.loaded[V])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const $=this.loaded[V];if($.showCollisionBoxes=j.showCollisionBoxes,$.status==="parsing"){const oe=yield $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity);let he;if(this.fetching[V]){const{rawTileData:ye,cacheControl:Me,resourceTiming:ve}=this.fetching[V];delete this.fetching[V],he=E.e({rawTileData:ye.slice(0)},oe,Me,ve)}else he=oe;return he}if($.status==="done"&&$.vectorTile)return $.parse($.vectorTile,this.layerIndex,this.availableImages,this.actor,j.subdivisionGranularity)}))}abortTile(j){return E._(this,void 0,void 0,(function*(){const V=this.loading,$=j.uid;V&&V[$]&&V[$].abort&&(V[$].abort.abort(),delete V[$])}))}removeTile(j){return E._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[j.uid]&&delete this.loaded[j.uid]}))}}class Ce{constructor(){this.loaded={}}loadTile(j){return E._(this,void 0,void 0,(function*(){const{uid:V,encoding:$,rawImageData:oe,redFactor:he,greenFactor:ye,blueFactor:Me,baseShift:ve}=j,Ne=oe.width+2,et=oe.height+2,qe=E.b(oe)?new E.R({width:Ne,height:et},yield E.cO(oe,-1,-1,Ne,et)):oe,bt=new E.cP(V,qe,$,he,ye,Me,ve);return this.loaded=this.loaded||{},this.loaded[V]=bt,bt}))}removeTile(j){const V=this.loaded,$=j.uid;V&&V[$]&&delete V[$]}}var ue,je,Ge=(function(){if(je)return ue;function ge(V,$){if(V.length!==0){j(V[0],$);for(var oe=1;oe<V.length;oe++)j(V[oe],!$)}}function j(V,$){for(var oe=0,he=0,ye=0,Me=V.length,ve=Me-1;ye<Me;ve=ye++){var Ne=(V[ye][0]-V[ve][0])*(V[ve][1]+V[ye][1]),et=oe+Ne;he+=Math.abs(oe)>=Math.abs(Ne)?oe-et+Ne:Ne-et+oe,oe=et}oe+he>=0!=!!$&&V.reverse()}return je=1,ue=function V($,oe){var he,ye=$&&$.type;if(ye==="FeatureCollection")for(he=0;he<$.features.length;he++)V($.features[he],oe);else if(ye==="GeometryCollection")for(he=0;he<$.geometries.length;he++)V($.geometries[he],oe);else if(ye==="Feature")V($.geometry,oe);else if(ye==="Polygon")ge($.coordinates,oe);else if(ye==="MultiPolygon")for(he=0;he<$.coordinates.length;he++)ge($.coordinates[he],oe);return $}})(),Ye=E.cQ(Ge);class We extends E.cS{constructor(j,V){super(new E.cM,0,V,[],[]),this.feature=j,this.type=j.type,this.properties=j.tags?j.tags:{},"id"in j&&(typeof j.id=="string"?this.id=parseInt(j.id,10):typeof j.id!="number"||isNaN(j.id)||(this.id=j.id))}loadGeometry(){const j=[],V=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const $ of V){const oe=[];for(const he of $)oe.push(new E.P(he[0],he[1]));j.push(oe)}return j}}class He extends E.cR{constructor(j,V){super(new E.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=V?V.version:1,this.extent=V?V.extent:4096,this.length=j.length,this.features=j}feature(j){return new We(this.features[j],this.extent)}}function nt(ge,j){j.writeVarintField(15,ge.version||1),j.writeStringField(1,ge.name||""),j.writeVarintField(5,ge.extent||4096);const V={keys:[],values:[],keycache:{},valuecache:{}};for(let he=0;he<ge.length;he++)V.feature=ge.feature(he),j.writeMessage(2,wt,V);const $=V.keys;for(const he of $)j.writeStringField(3,he);const oe=V.values;for(const he of oe)j.writeMessage(4,Gt,he)}function wt(ge,j){if(!ge.feature)return;const V=ge.feature;V.id!==void 0&&j.writeVarintField(1,V.id),j.writeMessage(2,xt,ge),j.writeVarintField(3,V.type),j.writeMessage(4,ut,V)}function xt(ge,j){for(const V in ge.feature?.properties){let $=ge.feature.properties[V],oe=ge.keycache[V];if($===null)continue;oe===void 0&&(ge.keys.push(V),oe=ge.keys.length-1,ge.keycache[V]=oe),j.writeVarint(oe),typeof $!="string"&&typeof $!="boolean"&&typeof $!="number"&&($=JSON.stringify($));const he=typeof $+":"+$;let ye=ge.valuecache[he];ye===void 0&&(ge.values.push($),ye=ge.values.length-1,ge.valuecache[he]=ye),j.writeVarint(ye)}}function Tt(ge,j){return(j<<3)+(7&ge)}function It(ge){return ge<<1^ge>>31}function ut(ge,j){const V=ge.loadGeometry(),$=ge.type;let oe=0,he=0;for(const ye of V){let Me=1;$===1&&(Me=ye.length),j.writeVarint(Tt(1,Me));const ve=$===3?ye.length-1:ye.length;for(let Ne=0;Ne<ve;Ne++){Ne===1&&$!==1&&j.writeVarint(Tt(2,ve-1));const et=ye[Ne].x-oe,qe=ye[Ne].y-he;j.writeVarint(It(et)),j.writeVarint(It(qe)),oe+=et,he+=qe}ge.type===3&&j.writeVarint(Tt(7,1))}}function Gt(ge,j){const V=typeof ge;V==="string"?j.writeStringField(1,ge):V==="boolean"?j.writeBooleanField(7,ge):V==="number"&&(ge%1!=0?j.writeDoubleField(3,ge):ge<0?j.writeSVarintField(6,ge):j.writeVarintField(5,ge))}const pn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ge=>ge},nn=Math.fround||(on=new Float32Array(1),ge=>(on[0]=+ge,on[0]));var on;class jn{constructor(j){this.options=Object.assign(Object.create(pn),j),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(j){const{log:V,minZoom:$,maxZoom:oe}=this.options;V&&console.time("total time");const he=`prepare ${j.length} points`;V&&console.time(he),this.points=j;const ye=[];for(let ve=0;ve<j.length;ve++){const Ne=j[ve];if(!Ne.geometry)continue;const[et,qe]=Ne.geometry.coordinates,bt=nn(Ue(et)),xe=nn(ht(qe));ye.push(bt,xe,1/0,ve,-1,1),this.options.reduce&&ye.push(0)}let Me=this.trees[oe+1]=this._createTree(ye);V&&console.timeEnd(he);for(let ve=oe;ve>=$;ve--){const Ne=+Date.now();Me=this.trees[ve]=this._createTree(this._cluster(Me,ve)),V&&console.log("z%d: %d clusters in %dms",ve,Me.numItems,+Date.now()-Ne)}return V&&console.timeEnd("total time"),this}getClusters(j,V){let $=((j[0]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,j[1]));let he=j[2]===180?180:((j[2]+180)%360+360)%360-180;const ye=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)$=-180,he=180;else if($>he){const qe=this.getClusters([$,oe,180,ye],V),bt=this.getClusters([-180,oe,he,ye],V);return qe.concat(bt)}const Me=this.trees[this._limitZoom(V)],ve=Me.range(Ue($),ht(ye),Ue(he),ht(oe)),Ne=Me.data,et=[];for(const qe of ve){const bt=this.stride*qe;et.push(Ne[bt+5]>1?er(Ne,bt,this.clusterProps):this.points[Ne[bt+3]])}return et}getChildren(j){const V=this._getOriginId(j),$=this._getOriginZoom(j),oe="No cluster with the specified id.",he=this.trees[$];if(!he)throw new Error(oe);const ye=he.data;if(V*this.stride>=ye.length)throw new Error(oe);const Me=this.options.radius/(this.options.extent*Math.pow(2,$-1)),ve=he.within(ye[V*this.stride],ye[V*this.stride+1],Me),Ne=[];for(const et of ve){const qe=et*this.stride;ye[qe+4]===j&&Ne.push(ye[qe+5]>1?er(ye,qe,this.clusterProps):this.points[ye[qe+3]])}if(Ne.length===0)throw new Error(oe);return Ne}getLeaves(j,V,$){const oe=[];return this._appendLeaves(oe,j,V=V||10,$=$||0,0),oe}getTile(j,V,$){const oe=this.trees[this._limitZoom(j)],he=Math.pow(2,j),{extent:ye,radius:Me}=this.options,ve=Me/ye,Ne=($-ve)/he,et=($+1+ve)/he,qe={features:[]};return this._addTileFeatures(oe.range((V-ve)/he,Ne,(V+1+ve)/he,et),oe.data,V,$,he,qe),V===0&&this._addTileFeatures(oe.range(1-ve/he,Ne,1,et),oe.data,he,$,he,qe),V===he-1&&this._addTileFeatures(oe.range(0,Ne,ve/he,et),oe.data,-1,$,he,qe),qe.features.length?qe:null}getClusterExpansionZoom(j){let V=this._getOriginZoom(j)-1;for(;V<=this.options.maxZoom;){const $=this.getChildren(j);if(V++,$.length!==1)break;j=$[0].properties.cluster_id}return V}_appendLeaves(j,V,$,oe,he){const ye=this.getChildren(V);for(const Me of ye){const ve=Me.properties;if(ve&&ve.cluster?he+ve.point_count<=oe?he+=ve.point_count:he=this._appendLeaves(j,ve.cluster_id,$,oe,he):he<oe?he++:j.push(Me),j.length===$)break}return he}_createTree(j){const V=new E.aI(j.length/this.stride|0,this.options.nodeSize,Float32Array);for(let $=0;$<j.length;$+=this.stride)V.add(j[$],j[$+1]);return V.finish(),V.data=j,V}_addTileFeatures(j,V,$,oe,he,ye){for(const Me of j){const ve=Me*this.stride,Ne=V[ve+5]>1;let et,qe,bt;if(Ne)et=mn(V,ve,this.clusterProps),qe=V[ve],bt=V[ve+1];else{const hn=this.points[V[ve+3]];et=hn.properties;const[Mt,Ht]=hn.geometry.coordinates;qe=Ue(Mt),bt=ht(Ht)}const xe={type:1,geometry:[[Math.round(this.options.extent*(qe*he-$)),Math.round(this.options.extent*(bt*he-oe))]],tags:et};let Wt;Wt=Ne||this.options.generateId?V[ve+3]:this.points[V[ve+3]].id,Wt!==void 0&&(xe.id=Wt),ye.features.push(xe)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(Math.floor(+j),this.options.maxZoom+1))}_cluster(j,V){const{radius:$,extent:oe,reduce:he,minPoints:ye}=this.options,Me=$/(oe*Math.pow(2,V)),ve=j.data,Ne=[],et=this.stride;for(let qe=0;qe<ve.length;qe+=et){if(ve[qe+2]<=V)continue;ve[qe+2]=V;const bt=ve[qe],xe=ve[qe+1],Wt=j.within(ve[qe],ve[qe+1],Me),hn=ve[qe+5];let Mt=hn;for(const Ht of Wt){const zn=Ht*et;ve[zn+2]>V&&(Mt+=ve[zn+5])}if(Mt>hn&&Mt>=ye){let Ht,zn=bt*hn,Fr=xe*hn,Vr=-1;const Vn=(qe/et<<5)+(V+1)+this.points.length;for(const Nt of Wt){const $t=Nt*et;if(ve[$t+2]<=V)continue;ve[$t+2]=V;const lr=ve[$t+5];zn+=ve[$t]*lr,Fr+=ve[$t+1]*lr,ve[$t+4]=Vn,he&&(Ht||(Ht=this._map(ve,qe,!0),Vr=this.clusterProps.length,this.clusterProps.push(Ht)),he(Ht,this._map(ve,$t)))}ve[qe+4]=Vn,Ne.push(zn/Mt,Fr/Mt,1/0,Vn,-1,Mt),he&&Ne.push(Vr)}else{for(let Ht=0;Ht<et;Ht++)Ne.push(ve[qe+Ht]);if(Mt>1)for(const Ht of Wt){const zn=Ht*et;if(!(ve[zn+2]<=V)){ve[zn+2]=V;for(let Fr=0;Fr<et;Fr++)Ne.push(ve[zn+Fr])}}}}return Ne}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,V,$){if(j[V+5]>1){const ye=this.clusterProps[j[V+6]];return $?Object.assign({},ye):ye}const oe=this.points[j[V+3]].properties,he=this.options.map(oe);return $&&he===oe?Object.assign({},he):he}}function er(ge,j,V){return{type:"Feature",id:ge[j+3],properties:mn(ge,j,V),geometry:{type:"Point",coordinates:[($=ge[j],360*($-.5)),tt(ge[j+1])]}};var $}function mn(ge,j,V){const $=ge[j+5],oe=$>=1e4?`${Math.round($/1e3)}k`:$>=1e3?Math.round($/100)/10+"k":$,he=ge[j+6],ye=he===-1?{}:Object.assign({},V[he]);return Object.assign(ye,{cluster:!0,cluster_id:ge[j+3],point_count:$,point_count_abbreviated:oe})}function Ue(ge){return ge/360+.5}function ht(ge){const j=Math.sin(ge*Math.PI/180),V=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return V<0?0:V>1?1:V}function tt(ge){const j=(180-360*ge)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function At(ge,j,V,$){let oe=$;const he=j+(V-j>>1);let ye,Me=V-j;const ve=ge[j],Ne=ge[j+1],et=ge[V],qe=ge[V+1];for(let bt=j+3;bt<V;bt+=3){const xe=me(ge[bt],ge[bt+1],ve,Ne,et,qe);if(xe>oe)ye=bt,oe=xe;else if(xe===oe){const Wt=Math.abs(bt-he);Wt<Me&&(ye=bt,Me=Wt)}}oe>$&&(ye-j>3&&At(ge,j,ye,$),ge[ye+2]=oe,V-ye>3&&At(ge,ye,V,$))}function me(ge,j,V,$,oe,he){let ye=oe-V,Me=he-$;if(ye!==0||Me!==0){const ve=((ge-V)*ye+(j-$)*Me)/(ye*ye+Me*Me);ve>1?(V=oe,$=he):ve>0&&(V+=ye*ve,$+=Me*ve)}return ye=ge-V,Me=j-$,ye*ye+Me*Me}function Ze(ge,j,V,$){const oe={id:ge??null,type:j,geometry:V,tags:$,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(j==="Point"||j==="MultiPoint"||j==="LineString")gt(oe,V);else if(j==="Polygon")gt(oe,V[0]);else if(j==="MultiLineString")for(const he of V)gt(oe,he);else if(j==="MultiPolygon")for(const he of V)gt(oe,he[0]);return oe}function gt(ge,j){for(let V=0;V<j.length;V+=3)ge.minX=Math.min(ge.minX,j[V]),ge.minY=Math.min(ge.minY,j[V+1]),ge.maxX=Math.max(ge.maxX,j[V]),ge.maxY=Math.max(ge.maxY,j[V+1])}function rt(ge,j,V,$){if(!j.geometry)return;const oe=j.geometry.coordinates;if(oe&&oe.length===0)return;const he=j.geometry.type,ye=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2);let Me=[],ve=j.id;if(V.promoteId?ve=j.properties[V.promoteId]:V.generateId&&(ve=$||0),he==="Point")yt(oe,Me);else if(he==="MultiPoint")for(const Ne of oe)yt(Ne,Me);else if(he==="LineString")Kt(oe,Me,ye,!1);else if(he==="MultiLineString"){if(V.lineMetrics){for(const Ne of oe)Me=[],Kt(Ne,Me,ye,!1),ge.push(Ze(ve,"LineString",Me,j.properties));return}Dt(oe,Me,ye,!1)}else if(he==="Polygon")Dt(oe,Me,ye,!0);else{if(he!=="MultiPolygon"){if(he==="GeometryCollection"){for(const Ne of j.geometry.geometries)rt(ge,{id:ve,geometry:Ne,properties:j.properties},V,$);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ne of oe){const et=[];Dt(Ne,et,ye,!0),Me.push(et)}}ge.push(Ze(ve,he,Me,j.properties))}function yt(ge,j){j.push(Zt(ge[0]),Vt(ge[1]),0)}function Kt(ge,j,V,$){let oe,he,ye=0;for(let ve=0;ve<ge.length;ve++){const Ne=Zt(ge[ve][0]),et=Vt(ge[ve][1]);j.push(Ne,et,0),ve>0&&(ye+=$?(oe*et-Ne*he)/2:Math.sqrt(Math.pow(Ne-oe,2)+Math.pow(et-he,2))),oe=Ne,he=et}const Me=j.length-3;j[2]=1,At(j,0,Me,V),j[Me+2]=1,j.size=Math.abs(ye),j.start=0,j.end=j.size}function Dt(ge,j,V,$){for(let oe=0;oe<ge.length;oe++){const he=[];Kt(ge[oe],he,V,$),j.push(he)}}function Zt(ge){return ge/360+.5}function Vt(ge){const j=Math.sin(ge*Math.PI/180),V=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return V<0?0:V>1?1:V}function En(ge,j,V,$,oe,he,ye,Me){if($/=j,he>=(V/=j)&&ye<$)return ge;if(ye<V||he>=$)return null;const ve=[];for(const Ne of ge){const et=Ne.geometry;let qe=Ne.type;const bt=oe===0?Ne.minX:Ne.minY,xe=oe===0?Ne.maxX:Ne.maxY;if(bt>=V&&xe<$){ve.push(Ne);continue}if(xe<V||bt>=$)continue;let Wt=[];if(qe==="Point"||qe==="MultiPoint")tr(et,Wt,V,$,oe);else if(qe==="LineString")xn(et,Wt,V,$,oe,!1,Me.lineMetrics);else if(qe==="MultiLineString")qt(et,Wt,V,$,oe,!1);else if(qe==="Polygon")qt(et,Wt,V,$,oe,!0);else if(qe==="MultiPolygon")for(const hn of et){const Mt=[];qt(hn,Mt,V,$,oe,!0),Mt.length&&Wt.push(Mt)}if(Wt.length){if(Me.lineMetrics&&qe==="LineString"){for(const hn of Wt)ve.push(Ze(Ne.id,qe,hn,Ne.tags));continue}qe!=="LineString"&&qe!=="MultiLineString"||(Wt.length===1?(qe="LineString",Wt=Wt[0]):qe="MultiLineString"),qe!=="Point"&&qe!=="MultiPoint"||(qe=Wt.length===3?"Point":"MultiPoint"),ve.push(Ze(Ne.id,qe,Wt,Ne.tags))}}return ve.length?ve:null}function tr(ge,j,V,$,oe){for(let he=0;he<ge.length;he+=3){const ye=ge[he+oe];ye>=V&&ye<=$&&un(j,ge[he],ge[he+1],ge[he+2])}}function xn(ge,j,V,$,oe,he,ye){let Me=vt(ge);const ve=oe===0?qn:Ar;let Ne,et,qe=ge.start;for(let Mt=0;Mt<ge.length-3;Mt+=3){const Ht=ge[Mt],zn=ge[Mt+1],Fr=ge[Mt+2],Vr=ge[Mt+3],Vn=ge[Mt+4],Nt=oe===0?Ht:zn,$t=oe===0?Vr:Vn;let lr=!1;ye&&(Ne=Math.sqrt(Math.pow(Ht-Vr,2)+Math.pow(zn-Vn,2))),Nt<V?$t>V&&(et=ve(Me,Ht,zn,Vr,Vn,V),ye&&(Me.start=qe+Ne*et)):Nt>$?$t<$&&(et=ve(Me,Ht,zn,Vr,Vn,$),ye&&(Me.start=qe+Ne*et)):un(Me,Ht,zn,Fr),$t<V&&Nt>=V&&(et=ve(Me,Ht,zn,Vr,Vn,V),lr=!0),$t>$&&Nt<=$&&(et=ve(Me,Ht,zn,Vr,Vn,$),lr=!0),!he&&lr&&(ye&&(Me.end=qe+Ne*et),j.push(Me),Me=vt(ge)),ye&&(qe+=Ne)}let bt=ge.length-3;const xe=ge[bt],Wt=ge[bt+1],hn=oe===0?xe:Wt;hn>=V&&hn<=$&&un(Me,xe,Wt,ge[bt+2]),bt=Me.length-3,he&&bt>=3&&(Me[bt]!==Me[0]||Me[bt+1]!==Me[1])&&un(Me,Me[0],Me[1],Me[2]),Me.length&&j.push(Me)}function vt(ge){const j=[];return j.size=ge.size,j.start=ge.start,j.end=ge.end,j}function qt(ge,j,V,$,oe,he){for(const ye of ge)xn(ye,j,V,$,oe,he,!1)}function un(ge,j,V,$){ge.push(j,V,$)}function qn(ge,j,V,$,oe,he){const ye=(he-j)/($-j);return un(ge,he,V+(oe-V)*ye,1),ye}function Ar(ge,j,V,$,oe,he){const ye=(he-V)/(oe-V);return un(ge,j+($-j)*ye,he,1),ye}function nr(ge,j){const V=[];for(let $=0;$<ge.length;$++){const oe=ge[$],he=oe.type;let ye;if(he==="Point"||he==="MultiPoint"||he==="LineString")ye=Kr(oe.geometry,j);else if(he==="MultiLineString"||he==="Polygon"){ye=[];for(const Me of oe.geometry)ye.push(Kr(Me,j))}else if(he==="MultiPolygon"){ye=[];for(const Me of oe.geometry){const ve=[];for(const Ne of Me)ve.push(Kr(Ne,j));ye.push(ve)}}V.push(Ze(oe.id,he,ye,oe.tags))}return V}function Kr(ge,j){const V=[];V.size=ge.size,ge.start!==void 0&&(V.start=ge.start,V.end=ge.end);for(let $=0;$<ge.length;$+=3)V.push(ge[$]+j,ge[$+1],ge[$+2]);return V}function Br(ge,j){if(ge.transformed)return ge;const V=1<<ge.z,$=ge.x,oe=ge.y;for(const he of ge.features){const ye=he.geometry,Me=he.type;if(he.geometry=[],Me===1)for(let ve=0;ve<ye.length;ve+=2)he.geometry.push(Ei(ye[ve],ye[ve+1],j,V,$,oe));else for(let ve=0;ve<ye.length;ve++){const Ne=[];for(let et=0;et<ye[ve].length;et+=2)Ne.push(Ei(ye[ve][et],ye[ve][et+1],j,V,$,oe));he.geometry.push(Ne)}}return ge.transformed=!0,ge}function Ei(ge,j,V,$,oe,he){return[Math.round(V*(ge*$-oe)),Math.round(V*(j*$-he))]}function oi(ge,j,V,$,oe){const he=j===oe.maxZoom?0:oe.tolerance/((1<<j)*oe.extent),ye={features:[],numPoints:0,numSimplified:0,numFeatures:ge.length,source:null,x:V,y:$,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Me of ge)ga(ye,Me,he,oe);return ye}function ga(ge,j,V,$){const oe=j.geometry,he=j.type,ye=[];if(ge.minX=Math.min(ge.minX,j.minX),ge.minY=Math.min(ge.minY,j.minY),ge.maxX=Math.max(ge.maxX,j.maxX),ge.maxY=Math.max(ge.maxY,j.maxY),he==="Point"||he==="MultiPoint")for(let Me=0;Me<oe.length;Me+=3)ye.push(oe[Me],oe[Me+1]),ge.numPoints++,ge.numSimplified++;else if(he==="LineString")na(ye,oe,ge,V,!1,!1);else if(he==="MultiLineString"||he==="Polygon")for(let Me=0;Me<oe.length;Me++)na(ye,oe[Me],ge,V,he==="Polygon",Me===0);else if(he==="MultiPolygon")for(let Me=0;Me<oe.length;Me++){const ve=oe[Me];for(let Ne=0;Ne<ve.length;Ne++)na(ye,ve[Ne],ge,V,!0,Ne===0)}if(ye.length){let Me=j.tags||null;if(he==="LineString"&&$.lineMetrics){Me={};for(const Ne in j.tags)Me[Ne]=j.tags[Ne];Me.mapbox_clip_start=oe.start/oe.size,Me.mapbox_clip_end=oe.end/oe.size}const ve={geometry:ye,type:he==="Polygon"||he==="MultiPolygon"?3:he==="LineString"||he==="MultiLineString"?2:1,tags:Me};j.id!==null&&(ve.id=j.id),ge.features.push(ve)}}function na(ge,j,V,$,oe,he){const ye=$*$;if($>0&&j.size<(oe?ye:$))return void(V.numPoints+=j.length/3);const Me=[];for(let ve=0;ve<j.length;ve+=3)($===0||j[ve+2]>ye)&&(V.numSimplified++,Me.push(j[ve],j[ve+1])),V.numPoints++;oe&&(function(ve,Ne){let et=0;for(let qe=0,bt=ve.length,xe=bt-2;qe<bt;xe=qe,qe+=2)et+=(ve[qe]-ve[xe])*(ve[qe+1]+ve[xe+1]);if(et>0===Ne)for(let qe=0,bt=ve.length;qe<bt/2;qe+=2){const xe=ve[qe],Wt=ve[qe+1];ve[qe]=ve[bt-2-qe],ve[qe+1]=ve[bt-1-qe],ve[bt-2-qe]=xe,ve[bt-1-qe]=Wt}})(Me,he),ge.push(Me)}const Za={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ta{constructor(j,V){const $=(V=this.options=(function(he,ye){for(const Me in ye)he[Me]=ye[Me];return he})(Object.create(Za),V)).debug;if($&&console.time("preprocess data"),V.maxZoom<0||V.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(V.promoteId&&V.generateId)throw new Error("promoteId and generateId cannot be used together.");let oe=(function(he,ye){const Me=[];if(he.type==="FeatureCollection")for(let ve=0;ve<he.features.length;ve++)rt(Me,he.features[ve],ye,ve);else rt(Me,he.type==="Feature"?he:{geometry:he},ye);return Me})(j,V);this.tiles={},this.tileCoords=[],$&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",V.indexMaxZoom,V.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),oe=(function(he,ye){const Me=ye.buffer/ye.extent;let ve=he;const Ne=En(he,1,-1-Me,Me,0,-1,2,ye),et=En(he,1,1-Me,2+Me,0,-1,2,ye);return(Ne||et)&&(ve=En(he,1,-Me,1+Me,0,-1,2,ye)||[],Ne&&(ve=nr(Ne,1).concat(ve)),et&&(ve=ve.concat(nr(et,-1)))),ve})(oe,V),oe.length&&this.splitTile(oe,0,0,0),$&&(oe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(j,V,$,oe,he,ye,Me){const ve=[j,V,$,oe],Ne=this.options,et=Ne.debug;for(;ve.length;){oe=ve.pop(),$=ve.pop(),V=ve.pop(),j=ve.pop();const qe=1<<V,bt=qi(V,$,oe);let xe=this.tiles[bt];if(!xe&&(et>1&&console.time("creation"),xe=this.tiles[bt]=oi(j,V,$,oe,Ne),this.tileCoords.push({z:V,x:$,y:oe}),et)){et>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",V,$,oe,xe.numFeatures,xe.numPoints,xe.numSimplified),console.timeEnd("creation"));const lr=`z${V}`;this.stats[lr]=(this.stats[lr]||0)+1,this.total++}if(xe.source=j,he==null){if(V===Ne.indexMaxZoom||xe.numPoints<=Ne.indexMaxPoints)continue}else{if(V===Ne.maxZoom||V===he)continue;if(he!=null){const lr=he-V;if($!==ye>>lr||oe!==Me>>lr)continue}}if(xe.source=null,j.length===0)continue;et>1&&console.time("clipping");const Wt=.5*Ne.buffer/Ne.extent,hn=.5-Wt,Mt=.5+Wt,Ht=1+Wt;let zn=null,Fr=null,Vr=null,Vn=null,Nt=En(j,qe,$-Wt,$+Mt,0,xe.minX,xe.maxX,Ne),$t=En(j,qe,$+hn,$+Ht,0,xe.minX,xe.maxX,Ne);j=null,Nt&&(zn=En(Nt,qe,oe-Wt,oe+Mt,1,xe.minY,xe.maxY,Ne),Fr=En(Nt,qe,oe+hn,oe+Ht,1,xe.minY,xe.maxY,Ne),Nt=null),$t&&(Vr=En($t,qe,oe-Wt,oe+Mt,1,xe.minY,xe.maxY,Ne),Vn=En($t,qe,oe+hn,oe+Ht,1,xe.minY,xe.maxY,Ne),$t=null),et>1&&console.timeEnd("clipping"),ve.push(zn||[],V+1,2*$,2*oe),ve.push(Fr||[],V+1,2*$,2*oe+1),ve.push(Vr||[],V+1,2*$+1,2*oe),ve.push(Vn||[],V+1,2*$+1,2*oe+1)}}getTile(j,V,$){j=+j,V=+V,$=+$;const oe=this.options,{extent:he,debug:ye}=oe;if(j<0||j>24)return null;const Me=1<<j,ve=qi(j,V=V+Me&Me-1,$);if(this.tiles[ve])return Br(this.tiles[ve],he);ye>1&&console.log("drilling down to z%d-%d-%d",j,V,$);let Ne,et=j,qe=V,bt=$;for(;!Ne&&et>0;)et--,qe>>=1,bt>>=1,Ne=this.tiles[qi(et,qe,bt)];return Ne&&Ne.source?(ye>1&&(console.log("found parent tile z%d-%d-%d",et,qe,bt),console.time("drilling down")),this.splitTile(Ne.source,et,qe,bt,j,V,$),ye>1&&console.timeEnd("drilling down"),this.tiles[ve]?Br(this.tiles[ve],he):null):null}}function qi(ge,j,V){return 32*((1<<ge)*V+j)+ge}class gr extends ze{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(j,V){return E._(this,void 0,void 0,(function*(){const $=j.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const oe=this._geoJSONIndex.getTile($.z,$.x,$.y);if(!oe)return null;const he=new He(oe.features,{version:2,extent:E.$});let ye=(function(Me){const ve=new E.cM;return(function(Ne,et){for(const qe in Ne.layers)et.writeMessage(3,nt,Ne.layers[qe])})(Me,ve),ve.finish()})(he);return ye.byteOffset===0&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),{vectorTile:he,rawData:ye.buffer}}))}loadData(j){return E._(this,void 0,void 0,(function*(){var V;(V=this._pendingRequest)===null||V===void 0||V.abort();const $=!!(j&&j.request&&j.request.collectResourceTiming)&&new E.cN(j.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(j,this._pendingRequest);const oe=yield this._pendingData;this._geoJSONIndex=j.cluster?new jn((function({superclusterOptions:ye,clusterProperties:Me}){if(!Me||!ye)return ye;const ve={},Ne={},et={accumulated:null,zoom:0},qe={properties:null},bt=Object.keys(Me);for(const xe of bt){const[Wt,hn]=Me[xe],Mt=E.cT(hn),Ht=E.cT(typeof Wt=="string"?[Wt,["accumulated"],["get",xe]]:Wt);ve[xe]=Mt.value,Ne[xe]=Ht.value}return ye.map=xe=>{qe.properties=xe;const Wt={};for(const hn of bt)Wt[hn]=ve[hn].evaluate(et,qe);return Wt},ye.reduce=(xe,Wt)=>{qe.properties=Wt;for(const hn of bt)et.accumulated=xe[hn],xe[hn]=Ne[hn].evaluate(et,qe)},ye})(j)).load(oe.features):(function(ye,Me){return new Ta(ye,Me)})(oe,j.geojsonVtOptions),this.loaded={};const he={data:oe};if($){const ye=$.finish();ye&&(he.resourceTiming={},he.resourceTiming[j.source]=JSON.parse(JSON.stringify(ye)))}return he}catch(oe){if(delete this._pendingRequest,E.cy(oe))return{abandoned:!0};throw oe}}))}getData(){return E._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(j){const V=this.loaded;return V&&V[j.uid]?super.reloadTile(j):this.loadTile(j)}loadAndProcessGeoJSON(j,V){return E._(this,void 0,void 0,(function*(){let $=yield this.loadGeoJSON(j,V);if(delete this._pendingRequest,typeof $!="object")throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(Ye($,!0),j.filter){const oe=E.cT(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(oe.result==="error")throw new Error(oe.value.map((ye=>`${ye.key}: ${ye.message}`)).join(", "));$={type:"FeatureCollection",features:$.features.filter((ye=>oe.value.evaluate({zoom:0},ye)))}}return $}))}loadGeoJSON(j,V){return E._(this,void 0,void 0,(function*(){const{promoteId:$}=j;if(j.request){const oe=yield E.j(j.request,V);return this._dataUpdateable=E.cV(oe.data,$)?E.cU(oe.data,$):void 0,oe.data}if(typeof j.data=="string")try{const oe=JSON.parse(j.data);return this._dataUpdateable=E.cV(oe,$)?E.cU(oe,$):void 0,oe}catch{throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`)}if(!j.dataDiff)throw new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${j.source}`);return E.cW(this._dataUpdateable,j.dataDiff,$),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(j){return E._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(j){return this._geoJSONIndex.getClusterExpansionZoom(j.clusterId)}getClusterChildren(j){return this._geoJSONIndex.getChildren(j.clusterId)}getClusterLeaves(j){return this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset)}}class Mi{constructor(j){this.self=j,this.actor=new E.J(j),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(V,$)=>{if(this.externalWorkerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.externalWorkerSourceTypes[V]=$},this.self.addProtocol=E.cA,this.self.removeProtocol=E.cB,this.self.registerRTLTextPlugin=V=>{E.cX.setMethods(V)},this.actor.registerMessageHandler("LDT",((V,$)=>this._getDEMWorkerSource(V,$.source).loadTile($))),this.actor.registerMessageHandler("RDT",((V,$)=>E._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(V,$.source).removeTile($)})))),this.actor.registerMessageHandler("GCEZ",((V,$)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,$.type,$.source).getClusterExpansionZoom($)})))),this.actor.registerMessageHandler("GCC",((V,$)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,$.type,$.source).getClusterChildren($)})))),this.actor.registerMessageHandler("GCL",((V,$)=>E._(this,void 0,void 0,(function*(){return this._getWorkerSource(V,$.type,$.source).getClusterLeaves($)})))),this.actor.registerMessageHandler("LD",((V,$)=>this._getWorkerSource(V,$.type,$.source).loadData($))),this.actor.registerMessageHandler("GD",((V,$)=>this._getWorkerSource(V,$.type,$.source).getData())),this.actor.registerMessageHandler("LT",((V,$)=>this._getWorkerSource(V,$.type,$.source).loadTile($))),this.actor.registerMessageHandler("RT",((V,$)=>this._getWorkerSource(V,$.type,$.source).reloadTile($))),this.actor.registerMessageHandler("AT",((V,$)=>this._getWorkerSource(V,$.type,$.source).abortTile($))),this.actor.registerMessageHandler("RMT",((V,$)=>this._getWorkerSource(V,$.type,$.source).removeTile($))),this.actor.registerMessageHandler("RS",((V,$)=>E._(this,void 0,void 0,(function*(){if(!this.workerSources[V]||!this.workerSources[V][$.type]||!this.workerSources[V][$.type][$.source])return;const oe=this.workerSources[V][$.type][$.source];delete this.workerSources[V][$.type][$.source],oe.removeSource!==void 0&&oe.removeSource($)})))),this.actor.registerMessageHandler("RM",(V=>E._(this,void 0,void 0,(function*(){delete this.layerIndexes[V],delete this.availableImages[V],delete this.workerSources[V],delete this.demWorkerSources[V],this.globalStates.delete(V)})))),this.actor.registerMessageHandler("SR",((V,$)=>E._(this,void 0,void 0,(function*(){this.referrer=$})))),this.actor.registerMessageHandler("SRPS",((V,$)=>this._syncRTLPluginState(V,$))),this.actor.registerMessageHandler("IS",((V,$)=>E._(this,void 0,void 0,(function*(){this.self.importScripts($)})))),this.actor.registerMessageHandler("SI",((V,$)=>this._setImages(V,$))),this.actor.registerMessageHandler("UL",((V,$)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(V).update($.layers,$.removedIds,this._getGlobalState(V))})))),this.actor.registerMessageHandler("UGS",((V,$)=>E._(this,void 0,void 0,(function*(){const oe=this._getGlobalState(V);for(const he in $)oe[he]=$[he]})))),this.actor.registerMessageHandler("SL",((V,$)=>E._(this,void 0,void 0,(function*(){this._getLayerIndex(V).replace($,this._getGlobalState(V))}))))}_getGlobalState(j){let V=this.globalStates.get(j);return V||(V={},this.globalStates.set(j,V)),V}_setImages(j,V){return E._(this,void 0,void 0,(function*(){this.availableImages[j]=V;for(const $ in this.workerSources[j]){const oe=this.workerSources[j][$];for(const he in oe)oe[he].availableImages=V}}))}_syncRTLPluginState(j,V){return E._(this,void 0,void 0,(function*(){return yield E.cX.syncState(V,this.self.importScripts)}))}_getAvailableImages(j){let V=this.availableImages[j];return V||(V=[]),V}_getLayerIndex(j){let V=this.layerIndexes[j];return V||(V=this.layerIndexes[j]=new c),V}_getWorkerSource(j,V,$){if(this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][V]||(this.workerSources[j][V]={}),!this.workerSources[j][V][$]){const oe={sendAsync:(he,ye)=>(he.targetMapId=j,this.actor.sendAsync(he,ye))};switch(V){case"vector":this.workerSources[j][V][$]=new ze(oe,this._getLayerIndex(j),this._getAvailableImages(j));break;case"geojson":this.workerSources[j][V][$]=new gr(oe,this._getLayerIndex(j),this._getAvailableImages(j));break;default:this.workerSources[j][V][$]=new this.externalWorkerSourceTypes[V](oe,this._getLayerIndex(j),this._getAvailableImages(j))}}return this.workerSources[j][V][$]}_getDEMWorkerSource(j,V){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][V]||(this.demWorkerSources[j][V]=new Ce),this.demWorkerSources[j][V]}}return E.i(self)&&(self.worker=new Mi(self)),Mi})),Q("index",["exports","./shared"],(function(E,c){var q="5.7.3";function te(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let Se,ze;const Ce={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,a){const l=requestAnimationFrame((g=>{d(),e(g)})),{unsubscribe:d}=c.s(f.signal,"abort",(()=>{d(),cancelAnimationFrame(l),a(c.c())}),!1)},frameAsync(f){return new Promise(((e,a)=>{this.frame(f,e,a)}))},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,a.drawImage(f,0,0,f.width,f.height),a},resolveURL:f=>(Se||(Se=document.createElement("a")),Se.href=f,Se.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ze==null&&(ze=matchMedia("(prefers-reduced-motion: reduce)")),ze.matches)}};class ue{static testProp(e){if(!ue.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in ue.docStyle)return e[a];return e[0]}static create(e,a,l){const d=window.document.createElement(e);return a!==void 0&&(d.className=a),l&&l.appendChild(d),d}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){ue.docStyle&&ue.selectProp&&(ue.userSelect=ue.docStyle[ue.selectProp],ue.docStyle[ue.selectProp]="none")}static enableDrag(){ue.docStyle&&ue.selectProp&&(ue.docStyle[ue.selectProp]=ue.userSelect)}static setTransform(e,a){e.style[ue.transformProp]=a}static addEventListener(e,a,l,d={}){e.addEventListener(a,l,"passive"in d?d:d.capture)}static removeEventListener(e,a,l,d={}){e.removeEventListener(a,l,"passive"in d?d:d.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ue.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ue.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ue.suppressClickInternal,!0)}),0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,l){const d=a.boundingClientRect;return new c.P((l.clientX-d.left)/a.x-e.clientLeft,(l.clientY-d.top)/a.y-e.clientTop)}static mousePos(e,a){const l=ue.getScale(e);return ue.getPoint(e,l,a)}static touchPos(e,a){const l=[],d=ue.getScale(e);for(let g=0;g<a.length;g++)l.push(ue.getPoint(e,d,a[g]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const d of l)d.remove();return ue.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const l of a)ue.removeAttributes(l),ue.clean(l)}static removeAttributes(e){for(const{name:a,value:l}of e.attributes)ue.isPossiblyDangerous(a,l)&&e.removeAttribute(a)}}ue.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ue.selectProp=ue.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ue.transformProp=ue.testProp(["transform","WebkitTransform"]);const je={supported:!1,testSupport:function(f){!We&&Ye&&(He?nt(f):Ge=f)}};let Ge,Ye,We=!1,He=!1;function nt(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,Ye),f.isContextLost())return;je.supported=!0}catch{}f.deleteTexture(e),We=!0}var wt;typeof document<"u"&&(Ye=document.createElement("img"),Ye.onload=()=>{Ge&&nt(Ge),Ge=null,He=!0},Ye.onerror=()=>{We=!0,Ge=null},Ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(f){let e,a,l,d;f.resetRequestQueue=()=>{e=[],a=0,l=0,d={}},f.addThrottleControl=S=>{const T=l++;return d[T]=S,T},f.removeThrottleControl=S=>{delete d[S],_()},f.getImage=(S,T,M=!0)=>new Promise(((I,z)=>{je.supported&&(S.headers||(S.headers={}),S.headers.accept="image/webp,*/*"),c.e(S,{type:"image"}),e.push({abortController:T,requestParameters:S,supportImageRefresh:M,state:"queued",onError:B=>{z(B)},onSuccess:B=>{I(B)}}),_()}));const g=S=>c._(this,void 0,void 0,(function*(){S.state="running";const{requestParameters:T,supportImageRefresh:M,onError:I,onSuccess:z,abortController:B}=S,W=M===!1&&!c.i(self)&&!c.g(T.url)&&(!T.headers||Object.keys(T.headers).reduce(((J,re)=>J&&re==="accept"),!0));a++;const Y=W?w(T,B):c.m(T,B);try{const J=yield Y;delete S.abortController,S.state="completed",J.data instanceof HTMLImageElement||c.b(J.data)?z(J):J.data&&z({data:yield(K=J.data,typeof createImageBitmap=="function"?c.f(K):c.h(K)),cacheControl:J.cacheControl,expires:J.expires})}catch(J){delete S.abortController,I(J)}finally{a--,_()}var K})),_=()=>{const S=(()=>{for(const T of Object.keys(d))if(d[T]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let T=a;T<S&&e.length>0;T++){const M=e.shift();M.abortController.signal.aborted?T--:g(M)}},w=(S,T)=>new Promise(((M,I)=>{const z=new Image,B=S.url,W=S.credentials;W&&W==="include"?z.crossOrigin="use-credentials":(W&&W==="same-origin"||!c.d(B))&&(z.crossOrigin="anonymous"),T.signal.addEventListener("abort",(()=>{z.src="",I(c.c())})),z.fetchPriority="high",z.onload=()=>{z.onerror=z.onload=null,M({data:z})},z.onerror=()=>{z.onerror=z.onload=null,T.signal.aborted||I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},z.src=B}))})(wt||(wt={})),wt.resetRequestQueue();class xt{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function Tt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const a=[];for(const{id:l,url:d}of f){const g=`${l}${d}`;a.indexOf(g)===-1&&(a.push(g),e.push({id:l,url:d}))}}return e}function It(f,e,a){try{const l=new URL(f);return l.pathname+=`${e}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ut(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class Gt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let l=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,a){if(!e)return!0;let l=0;for(const d of e){if(d[0]<l||d[1]<d[0]||a<d[1])return!1;l=d[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const l=a.spriteData,d=l&&l.width||a.data.width,g=l&&l.height||a.data.height;return!(e[0]<0||d<e[0]||e[1]<0||g<e[1]||e[2]<0||d<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,l=!0){const d=this.getImage(e);if(l&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((a,l)=>{let d=!0;if(!this.isLoaded())for(const g of e)this.images[g]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})}))}_getImagesForIds(e){const a={};for(const l of e){let d=this.getImage(l);d||(this.fire(new c.l("styleimagemissing",{id:l})),d=this.getImage(l)),d?a[l]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],l=this.getImage(e);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const d={w:l.data.width+2,h:l.data.height+2,x:0,y:0},g=new c.I(d,l);this.patterns[e]={bin:d,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const g in this.patterns)e.push(this.patterns[g].bin);const{w:a,h:l}=c.p(e),d=this.atlasImage;d.resize({width:a||1,height:l||1});for(const g in this.patterns){const{bin:_}=this.patterns[g],w=_.x+1,S=_.y+1,T=this.getImage(g).data,M=T.width,I=T.height;c.R.copy(T,d,{x:0,y:0},{x:w,y:S},{width:M,height:I}),c.R.copy(T,d,{x:0,y:I-1},{x:w,y:S-1},{width:M,height:1}),c.R.copy(T,d,{x:0,y:0},{x:w,y:S+I},{width:M,height:1}),c.R.copy(T,d,{x:M-1,y:0},{x:w-1,y:S},{width:1,height:I}),c.R.copy(T,d,{x:0,y:0},{x:w+M,y:S},{width:1,height:I})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||c.w(`Image with ID: "${a}" was not found`),ut(l)&&this.updateImage(a,l)}}}const pn=1e20;function nn(f,e,a,l,d,g,_,w,S){for(let T=e;T<e+l;T++)on(f,a*g+T,g,d,_,w,S);for(let T=a;T<a+d;T++)on(f,T*g+e,1,l,_,w,S)}function on(f,e,a,l,d,g,_){g[0]=0,_[0]=-pn,_[1]=pn,d[0]=f[e];for(let w=1,S=0,T=0;w<l;w++){d[w]=f[e+w*a];const M=w*w;do{const I=g[S];T=(d[w]-d[I]+M-I*I)/(w-I)/2}while(T<=_[S]&&--S>-1);S++,g[S]=w,_[S]=T,_[S+1]=pn}for(let w=0,S=0;w<l;w++){for(;_[S+1]<w;)S++;const T=g[S],M=w-T;f[e+w*a]=d[T]+M*M}}class jn{constructor(e,a,l){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,(function*(){const a=[];for(const g in e)for(const _ of e[g])a.push(this._getAndCacheGlyphsPromise(g,_));const l=yield Promise.all(a),d={};for(const{stack:g,id:_,glyph:w}of l)d[g]||(d[g]={}),d[g][_]=w&&{id:w.id,bitmap:w.bitmap.clone(),metrics:w.metrics};return d}))}_getAndCacheGlyphsPromise(e,a){return c._(this,void 0,void 0,(function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let d=l.glyphs[a];if(d!==void 0)return{stack:e,id:a,glyph:d};if(d=this._tinySDF(l,e,a),d)return l.glyphs[a]=d,{stack:e,id:a,glyph:d};const g=Math.floor(a/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[g])return{stack:e,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[g]){const w=jn.loadGlyphRange(e,g,this.url,this.requestManager);l.requests[g]=w}const _=yield l.requests[g];for(const w in _)this._doesCharSupportLocalGlyph(+w)||(l.glyphs[+w]=_[+w]);return l.ranges[g]=!0,{stack:e,id:a,glyph:_[a]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,a,l){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(l))return;let g=e.tinySDF;if(!g){let w="400";/bold/i.test(a)?w="900":/medium/i.test(a)?w="500":/light/i.test(a)&&(w="200"),g=e.tinySDF=new jn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:d,fontWeight:w})}const _=g.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}jn.loadGlyphRange=function(f,e,a,l){return c._(this,void 0,void 0,(function*(){const d=256*e,g=d+255,_=l.transformRequest(a.replace("{fontstack}",f).replace("{range}",`${d}-${g}`),"Glyphs"),w=yield c.n(_,new AbortController);if(!w||!w.data)throw new Error(`Could not load glyph range. range: ${e}, ${d}-${g}`);const S={};for(const T of c.o(w.data))S[T.id]=T;return S}))},jn.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:a=8,cutoff:l=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:_="normal",lang:w=null}={}){this.buffer=e,this.cutoff=l,this.radius=a,this.lang=w;const S=this.size=f+4*e,T=this._createCanvas(S),M=this.ctx=T.getContext("2d",{willReadFrequently:!0});M.font=`${_} ${g} ${f}px ${d}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Uint16Array(S)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(f),_=Math.ceil(a),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),S=Math.min(this.size-this.buffer,_+Math.ceil(l)),T=w+2*this.buffer,M=S+2*this.buffer,I=Math.max(T*M,0),z=new Uint8ClampedArray(I),B={data:z,width:T,height:M,glyphWidth:w,glyphHeight:S,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(w===0||S===0)return B;const{ctx:W,buffer:Y,gridInner:K,gridOuter:J}=this;this.lang&&(W.lang=this.lang),W.clearRect(Y,Y,w,S),W.fillText(f,Y,Y+_);const re=W.getImageData(Y,Y,w,S);J.fill(pn,0,I),K.fill(0,0,I);for(let se=0;se<S;se++)for(let ie=0;ie<w;ie++){const ce=re.data[4*(se*w+ie)+3]/255;if(ce===0)continue;const pe=(se+Y)*T+ie+Y;if(ce===1)J[pe]=0,K[pe]=pn;else{const ae=.5-ce;J[pe]=ae>0?ae*ae:0,K[pe]=ae<0?ae*ae:0}}nn(J,0,0,T,M,T,this.f,this.v,this.z),nn(K,Y,Y,w,S,T,this.f,this.v,this.z);for(let se=0;se<I;se++){const ie=Math.sqrt(J[se])-Math.sqrt(K[se]);z[se]=Math.round(255-255*(ie/this.radius+this.cutoff))}return B}};class er{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,a){return c.B(e.expression.evaluate(a))}interpolate(e,a,l){return{x:c.C.number(e.x,a.x,l),y:c.C.number(e.y,a.y,l),z:c.C.number(e.z,a.z,l)}}}let mn;class Ue extends c.E{constructor(e){super(),mn=mn||new c.r({anchor:new c.D(c.v.light.anchor),position:new er,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(mn,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(c.x,e,a))for(const l in e){const d=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),d):this._transitionable.setValue(l,d)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l){return(!l||l.validate!==!1)&&c.y(this,e.call(c.z,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ht=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class tt extends c.E{constructor(e){super(),this._transitionable=new c.t(ht,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,a={}){if(!this._validate(c.G,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const d=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),d):this._transitionable.setValue(l,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l={}){return l?.validate!==!1&&c.y(this,e.call(c.z,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class At{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const l=e.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,a)),this.dashEntry[l]}getDashRanges(e,a,l){const d=[];let g=e.length%2==1?-e[e.length-1]*l:0,_=e[0]*l,w=!0;d.push({left:g,right:_,isDash:w,zeroLength:e[0]===0});let S=e[0];for(let T=1;T<e.length;T++){w=!w;const M=e[T];g=S*l,S+=M,_=S*l,d.push({left:g,right:_,isDash:w,zeroLength:M===0})}return d}addRoundDash(e,a,l){const d=a/2;for(let g=-l;g<=l;g++){const _=this.width*(this.nextRow+l+g);let w=0,S=e[w];for(let T=0;T<this.width;T++){T/S.right>1&&(S=e[++w]);const M=Math.abs(T-S.left),I=Math.abs(T-S.right),z=Math.min(M,I);let B;const W=g/l*(d+1);if(S.isDash){const Y=d-Math.abs(W);B=Math.sqrt(z*z+Y*Y)}else B=d-Math.sqrt(z*z+W*W);this.data[_+T]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(e){for(let w=e.length-1;w>=0;--w){const S=e[w],T=e[w+1];S.zeroLength?e.splice(w,1):T&&T.isDash===S.isDash&&(T.left=S.left,e.splice(w,1))}const a=e[0],l=e[e.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const d=this.width*this.nextRow;let g=0,_=e[g];for(let w=0;w<this.width;w++){w/_.right>1&&(_=e[++g]);const S=Math.abs(w-_.left),T=Math.abs(w-_.right),M=Math.min(S,T);this.data[d+w]=Math.max(0,Math.min(255,(_.isDash?M:-M)+128))}}addDash(e,a){const l=a?7:0,d=2*l+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let w=0;w<e.length;w++)g+=e[w];if(g!==0){const w=this.width/g,S=this.getDashRanges(e,this.width,w);a?this.addRoundDash(S,w,l):this.addRegularDash(S)}const _={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:g};return this.nextRow+=d,this.dirty=!0,_}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const me="maplibre_preloaded_worker_pool";class Ze{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ze.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[me]}numActive(){return Object.keys(this.active).length}}const gt=Math.floor(Ce.hardwareConcurrency/2);let rt,yt;function Kt(){return rt||(rt=new Ze),rt}Ze.workerCount=c.H(globalThis)?Math.max(Math.min(gt,3),1):1;class Dt{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let d=0;d<l.length;d++){const g=new c.J(l[d],a);g.name=`Worker ${d}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const l=[];for(const d of this.actors)l.push(d.sendAsync({type:e,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const l of this.actors)l.registerMessageHandler(e,a)}}function Zt(){return yt||(yt=new Dt(Kt(),c.K),yt.registerMessageHandler("GR",((f,e,a)=>c.m(e,a)))),yt}function Vt(f,e){const a=c.L();return c.M(a,a,[1,1,0]),c.N(a,a,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?c.O(a,a,f.calculatePosMatrix(e.toUnwrapped())):a}function En(f,e,a,l,d,g,_){var w;const S=(function(z,B,W){if(z)for(const Y of z){const K=B[Y];if(K&&K.source===W&&K.type==="fill-extrusion")return!0}else for(const Y in B){const K=B[Y];if(K.source===W&&K.type==="fill-extrusion")return!0}return!1})((w=d?.layers)!==null&&w!==void 0?w:null,e,f.id),T=g.maxPitchScaleFactor(),M=f.tilesIn(l,T,S);M.sort(tr);const I=[];for(const z of M)I.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(e,a,f._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,d,g,T,Vt(f.transform,z.tileID),_?(B,W)=>_(z.tileID,B,W):void 0)});return(function(z,B){for(const W in z)for(const Y of z[W])xn(Y,B);return z})((function(z){const B={},W={};for(const Y of z){const K=Y.queryResults,J=Y.wrappedTileID,re=W[J]=W[J]||{};for(const se in K){const ie=K[se],ce=re[se]=re[se]||{},pe=B[se]=B[se]||[];for(const ae of ie)ce[ae.featureIndex]||(ce[ae.featureIndex]=!0,pe.push(ae))}}return B})(I),f)}function tr(f,e){const a=f.tileID,l=e.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function xn(f,e){const a=f.feature,l=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function vt(f,e,a){return c._(this,void 0,void 0,(function*(){let l=f;if(f.url?l=(yield c.j(e.transformRequest(f.url,"Source"),a)).data:yield Ce.frameAsync(a),!l)return null;const d=c.Q(c.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(d.vectorLayerIds=l.vector_layers.map((g=>g.id))),d}))}class qt{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const a=this._sw,l=this._ne;let d,g;if(e instanceof c.S)d=e,g=e;else{if(!(e instanceof qt))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(qt.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(d=e._sw,g=e._ne,!d||!g)return this}return a||l?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),l.lng=Math.max(g.lng,l.lng),l.lat=Math.max(g.lat,l.lat)):(this._sw=new c.S(d.lng,d.lat),this._ne=new c.S(g.lng,g.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:l}=c.S.convert(e);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(e){return e instanceof qt?e:e&&new qt(e)}static fromLngLat(e,a=0){const l=360*a/40075017,d=l/Math.cos(Math.PI/180*e.lat);return new qt(new c.S(e.lng-d,e.lat-l),new c.S(e.lng+d,e.lat+l))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),a=new c.S(this._ne.lng,this._ne.lat);return new qt(e,e.lng>a.lng?new c.S(a.lng+360,a.lat):a)}}class un{constructor(e,a,l){this.bounds=qt.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),l=Math.floor(c.V(this.bounds.getWest())*a),d=Math.floor(c.U(this.bounds.getNorth())*a),g=Math.ceil(c.V(this.bounds.getEast())*a),_=Math.ceil(c.U(this.bounds.getSouth())*a);return e.x>=l&&e.x<g&&e.y>=d&&e.y<_}}class qn extends c.E{constructor(e,a,l,d){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield vt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new un(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((g,_)=>{e.reloadPromise={resolve:g,reject:_}}))}else e.actor=this.dispatcher.getActor(),d="LT";e.abortController=new AbortController;try{const g=yield e.actor.sendAsync({type:d,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Ar extends c.E{constructor(e,a,l,d){super(),this.id=e,this.dispatcher=l,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.Q(a,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield vt(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new un(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield wt.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const d=this.map.painter.context,g=d.gl,_=l.data;e.texture=this.map.painter.getTileTexture(_.width),e.texture?e.texture.update(_,{useMipmap:!0}):(e.texture=new c.T(d,_,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class nr extends Ar{constructor(e,a,l,d){super(e,a,l,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const d=yield wt.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(d&&d.data){const g=d.data;this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&e.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const _=c.b(g)&&c.W()?g:yield this.readImageNow(g),w={type:this.type,uid:e.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const S=yield e.actor.sendAsync({type:"LDT",data:w});e.dem=S,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(d){if(delete e.abortController,e.aborted)e.state="unloaded";else if(d)throw e.state="errored",d}}))}readImageNow(e){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.X()){const a=e.width+2,l=e.height+2;try{return new c.R({width:a,height:l},yield c.Y(e,-1,-1,a,l))}catch{}}return Ce.getImageData(e,1)}))}_getNeighboringTiles(e){const a=e.canonical,l=Math.pow(2,a.z),d=(a.x-1+l)%l,g=a.x===0?e.wrap-1:e.wrap,_=(a.x+1+l)%l,w=a.x+1===l?e.wrap+1:e.wrap,S={};return S[new c.Z(e.overscaledZ,g,a.z,d,a.y).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,a.z,_,a.y).key]={backfilled:!1},a.y>0&&(S[new c.Z(e.overscaledZ,g,a.z,d,a.y-1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,a.z,_,a.y-1).key]={backfilled:!1}),a.y+1<l&&(S[new c.Z(e.overscaledZ,g,a.z,d,a.y+1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},S[new c.Z(e.overscaledZ,w,a.z,_,a.y+1).key]={backfilled:!1}),S}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class Kr extends c.E{constructor(e,a,l,d){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(d),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,(function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map((a=>a.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,(function*(){const e=new qt,a=yield this.getData();let l;switch(a.type){case"FeatureCollection":l=a.features.map((d=>this.getCoordinatesFromGeometry(d.geometry))).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(a.geometry);break;default:l=this.getCoordinatesFromGeometry(a)}if(l.length==0)return e;for(let d=0;d<l.length-1;d+=2)e.extend([l[d],l[d+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:l}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:e,diff:a}=this._pendingWorkerUpdate;if(!e&&!a)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const l=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(l.request=this.map._requestManager.transformRequest(Ce.resolveURL(e),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||d.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=d.data;let g=null;d.resourceTiming&&d.resourceTiming[this.id]&&(g=d.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(_,{resourceTiming:g}),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(d){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(d))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(d,this.map.painter,a==="RT")}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Br extends c.E{constructor(e,a,l,d){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(e){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield wt.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(c.a1.fromLngLat);var l;return this.tileID=(function(d){const g=c.a2.fromPoints(d),_=g.width(),w=g.height(),S=Math.max(_,w),T=Math.max(0,Math.floor(-Math.log(S)/Math.LN2)),M=Math.pow(2,T);return new c.a4(T,Math.floor((g.minX+g.maxX)/2*M),Math.floor((g.minY+g.maxY)/2*M))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((d=>this.tileID.getTilePoint(d)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new c.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:l,maxX:d,maxY:g}=c.a2.fromPoints(e),_={};for(let w=0;w<=c.a3;w++){const S=Math.pow(2,w),T=Math.floor(a*S),M=Math.floor(l*S),I=Math.floor(d*S),z=Math.floor(g*S);_[w]={minTileX:T,minTileY:M,maxTileX:I,maxTileY:z}}return _}}class Ei extends Br{constructor(e,a,l,d){super(e,a,l,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a5(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class oi extends Br{constructor(e,a,l,d){super(e,a,l,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((g=>!Array.isArray(g)||g.length!==2||g.some((_=>typeof _!="number"))))||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(a,this.canvas,l.RGBA,{premultiply:!0});let d=!1;for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,d=!0)}d&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ga={},na=f=>{switch(f){case"geojson":return Kr;case"image":return Br;case"raster":return Ar;case"raster-dem":return nr;case"vector":return qn;case"video":return Ei;case"canvas":return oi}return ga[f]},Za="RTLPluginLoaded";class Ta extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Zt()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=Ce.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(Za))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let qi=null;function gr(){return qi||(qi=new Ta),qi}class Mi{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a7(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(d,g){const _={};if(!g)return _;for(const w of d){const S=w.layerIds.map((T=>g.getLayer(T))).filter(Boolean);if(S.length!==0){w.layers=S,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map((T=>S.filter((M=>M.id===T))[0])));for(const T of S)_[T.id]=w}}return _})(e.buckets,a?.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a9){if(this.hasSymbolBuckets=!0,!l)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a9&&g.hasRTLText){this.hasRTLText=!0,gr().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const d=this.buckets[l];d.uploadPending()&&d.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,l,d,g,_,w,S,T,M,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:g,scale:_,tileSize:this.tileSize,pixelPosMatrix:M,transform:S,params:w,queryPadding:this.queryPadding*T,getElevation:I},e,a,l):{}}querySourceFeatures(e,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const d=l.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",_=d._geojsonTileLayer||d[g];if(!_)return;const w=c.aa(a?.filter,a?.globalState),{z:S,x:T,y:M}=this.tileID.canonical,I={z:S,x:T,y:M};for(let z=0;z<_.length;z++){const B=_.feature(z);if(w.needGeometry){const K=c.ab(B,!0);if(!w.filter(new c.F(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!w.filter(new c.F(this.tileID.overscaledZ),B))continue;const W=l.getId(B,g),Y=new c.ac(B,S,T,M,W);Y.tile=I,e.push(Y)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const l=c.ad(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let d=!1;if(this.expirationTime>l)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const g=this.expirationTime-a;g?this.expirationTime=l+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const g=this.buckets[d],_=g.layers[0].sourceLayer||"_geojsonTileLayer",w=l[_],S=e[_];if(!w||!S||Object.keys(S).length===0)continue;g.update(S,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const T=a&&a.style&&a.style.getLayer(d);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ce.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ce.now()+e}setDependencies(e,a){const l={};for(const d of a)l[d]=!0;this.dependencies[e]=l}hasDependency(e,a){for(const l of e){const d=this.dependencies[l];if(d){for(const g of a)if(d[g])return!0}}return!1}}class ge{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,l){const d=e.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:a,timeout:void 0};if(l!==void 0&&(g.timeout=setTimeout((()=>{this.remove(e,g)}),l)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const l=e.wrapped().key,d=a===void 0?0:this.data[l].indexOf(a),g=this.data[l][d];return this.data[l].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(g.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const l in this.data)for(const d of this.data[l])e(d.value)||a.push(d);for(const l of a)this.remove(l.value.tileID,l)}}class j{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,l){const d=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},c.e(this.stateChanges[e][d],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==d&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][d]===null){this.deletedStates[e][d]={};for(const g in this.state[e][d])l[g]||(this.deletedStates[e][d][g]=null)}else for(const g in l)this.deletedStates[e]&&this.deletedStates[e][d]&&this.deletedStates[e][d][g]===null&&delete this.deletedStates[e][d][g]}removeFeatureState(e,a,l){if(this.deletedStates[e]===null)return;const d=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&a!==void 0)this.deletedStates[e][d]!==null&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][l]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][d])for(l in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][l]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,a){const l=String(a),d=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][a];if(g===null)return{};for(const _ in g)delete d[_]}return d}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const l={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const _ in this.stateChanges[d])this.state[d][_]||(this.state[d][_]={}),c.e(this.state[d][_],this.stateChanges[d][_]),g[_]=this.state[d][_];l[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(this.deletedStates[d]===null)for(const _ in this.state[d])g[_]={},this.state[d][_]={};else for(const _ in this.deletedStates[d]){if(this.deletedStates[d][_]===null)this.state[d][_]={};else for(const w of Object.keys(this.deletedStates[d][_]))delete this.state[d][_][w];g[_]=this.state[d][_]}l[d]=l[d]||{},c.e(l[d],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const d in e)e[d].setFeatureState(l,a)}}const V=89.25;function $(f,e){const a=c.ah(e.lat,-c.ai,c.ai);return new c.P(c.V(e.lng)*f,c.U(a)*f)}function oe(f,e){return new c.a1(e.x/f,e.y/f).toLngLat()}function he(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-f.pitch)),Math.tan(c.ae(V-f.pitch)))}function ye(f,e){const a=f.canonical,l=e/c.af(a.z),d=a.x+Math.pow(2,a.z)*f.wrap,g=c.ag(new Float64Array(16));return c.M(g,g,[d*l,a.y*l,0]),c.N(g,g,[l/c.$,l/c.$,1]),g}function Me(f,e,a,l,d){const g=c.a1.fromLngLat(f,e),_=d*c.aj(1,f.lat),w=_*Math.cos(c.ae(a)),S=Math.sqrt(_*_-w*w),T=S*Math.sin(c.ae(-l)),M=S*Math.cos(c.ae(-l));return new c.a1(g.x+T,g.y+M,g.z+w)}function ve(f,e,a){const l=e.intersectsFrustum(f);if(!a||l===0)return l;const d=e.intersectsPlane(a);return d===0?0:l===2&&d===2?2:1}function Ne(f,e,a){let l=0;const d=(a-e)/10;for(let g=0;g<10;g++)l+=d*Math.pow(Math.cos(e+(g+.5)/10*(a-e)),f);return l}function et(f,e){return function(a,l,d,g,_){const w=2*((f-1)/c.ak(Math.cos(c.ae(V-_))/Math.cos(c.ae(V)))-1),S=Math.acos(d/g),T=2*Ne(w-1,0,c.ae(_/2)),M=Math.min(c.ae(V),S+c.ae(_/2)),I=Ne(w-1,Math.min(M,S-c.ae(_/2)),M),z=Math.atan(l/d),B=Math.hypot(l,d);let W=a;return W+=c.ak(g/B/Math.max(.5,Math.cos(c.ae(_/2)))),W+=w*c.ak(Math.cos(z))/2,W-=c.ak(Math.max(1,I/T/e))/2,W}}const qe=et(9.314,3);function bt(f,e){const a=(e.roundZoom?Math.round:Math.floor)(f.zoom+c.ak(f.tileSize/e.tileSize));return Math.max(0,a)}function xe(f,e){const a=f.getCameraFrustum(),l=f.getClippingPlane(),d=f.screenPointToMercatorCoordinate(f.getCameraPoint()),g=c.a1.fromLngLat(f.center,f.elevation);d.z=g.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const _=f.getCoveringTilesDetailsProvider(),w=_.allowVariableZoom(f,e),S=bt(f,e),T=e.minzoom||0,M=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,I=Math.min(Math.max(0,S),M),z=Math.pow(2,I),B=[z*d.x,z*d.y,0],W=[z*g.x,z*g.y,0],Y=Math.hypot(g.x-d.x,g.y-d.y),K=Math.abs(g.z-d.z),J=Math.hypot(Y,K),re=ce=>({zoom:0,x:0,y:0,wrap:ce,fullyVisible:!1}),se=[],ie=[];if(f.renderWorldCopies&&_.allowWorldCopies())for(let ce=1;ce<=3;ce++)se.push(re(-ce)),se.push(re(ce));for(se.push(re(0));se.length>0;){const ce=se.pop(),pe=ce.x,ae=ce.y;let _e=ce.fullyVisible;const Le={x:pe,y:ae,z:ce.zoom},Te=_.getTileBoundingVolume(Le,ce.wrap,f.elevation,e);if(!_e){const st=ve(a,Te,l);if(st===0)continue;_e=st===2}const Ee=_.distanceToTile2d(d.x,d.y,Le,Te);let ke=S;w&&(ke=(e.calculateTileZoom||qe)(f.zoom+c.ak(f.tileSize/e.tileSize),Ee,K,J,f.fov)),ke=(e.roundZoom?Math.round:Math.floor)(ke),ke=Math.max(0,ke);const ct=Math.min(ke,M);if(ce.wrap=_.getWrap(g,Le,ce.wrap),ce.zoom>=ct){if(ce.zoom<T)continue;const st=I-ce.zoom,$e=B[0]-.5-(pe<<st),Pt=B[1]-.5-(ae<<st),ln=e.reparseOverscaled?Math.max(ce.zoom,ke):ce.zoom;ie.push({tileID:new c.Z(ce.zoom===M?ln:ce.zoom,ce.wrap,ce.zoom,pe,ae),distanceSq:c.al([W[0]-.5-pe,W[1]-.5-ae]),tileDistanceToCamera:Math.sqrt($e*$e+Pt*Pt)})}else for(let st=0;st<4;st++)se.push({zoom:ce.zoom+1,x:(pe<<1)+st%2,y:(ae<<1)+(st>>1),wrap:ce.wrap,fullyVisible:_e})}return ie.sort(((ce,pe)=>ce.distanceSq-pe.distanceSq)).map((ce=>ce.tileID))}const Wt=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class hn extends c.E{constructor(e,a,l){super(),this.id=e,this.dispatcher=l,this.on("data",(d=>this._dataHandler(d))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((d,g,_,w)=>{const S=new(na(g.type))(d,g,_,w);if(S.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${S.id}`);return S})(e,a,l,this),this._tiles={},this._cache=new ge(0,(d=>this._unloadTile(d))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new j,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,l){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,l)}catch(d){e.state="errored",d.status!==404?this._source.fire(new c.k(d,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const l=this._tiles[a];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Mt).map((e=>e.key))}getRenderableIds(e){const a=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&a.push(this._tiles[l]);return e?a.sort(((l,d)=>{const g=l.tileID,_=d.tileID,w=new c.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),S=new c.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-_.overscaledZ||S.y-w.y||S.x-w.x})).map((l=>l.tileID.key)):a.map((l=>l.tileID)).sort(Mt).map((l=>l.key))}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)e?this._reloadTile(a,"expired"):this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(e,a){return c._(this,void 0,void 0,(function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,e,a))}))}_tileLoaded(e,a,l){e.timeAdded=Ce.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const g=a[d];if(e.neighboringTiles&&e.neighboringTiles[g]){const _=this.getTileByID(g);l(e,_),l(_,e)}}function l(d,g){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let _=g.tileID.canonical.x-d.tileID.canonical.x;const w=g.tileID.canonical.y-d.tileID.canonical.y,S=Math.pow(2,d.tileID.canonical.z),T=g.tileID.key;_===0&&w===0||Math.abs(w)>1||(Math.abs(_)>1&&(Math.abs(_+S)===1?_+=S:Math.abs(_-S)===1&&(_-=S)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,_,w),d.neighboringTiles&&d.neighboringTiles[T]&&(d.neighboringTiles[T].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a){const l=Object.values(e),d=this._getLoadedDescendents(l);for(const g of l){const _=d[g.key];if(!_)continue;const w=g.overscaledZ+hn.maxUnderzooming;let S=1/0;for(const T of _){const M=T.tileID.overscaledZ;M<=w&&M<S&&(S=M)}if(S!==1/0)for(const T of _)T.tileID.overscaledZ===S&&(a[T.tileID.key]=T.tileID)}}_getLoadedDescendents(e){var a;const l={};for(const d in this._tiles){const g=this._tiles[d];if(g.hasData())for(const _ of e)g.tileID.isChildOf(_)&&(l[a=_.key]||(l[a]=[])).push(g)}return l}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=a?l:null}for(let l=e.overscaledZ-1;l>=a;l--){const d=e.scaledTo(l),g=this._getLoadedTile(d);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,d=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(g)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const l={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),l[g.tileID.key]=g}this._tiles=l;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(e,a,l,d){const g={},_={},w=Object.keys(e),S=Ce.now();for(const T of w){const M=e[T],I=this._tiles[T];if(!I||I.fadeEndTime!==0&&I.fadeEndTime<=S)continue;const z=this.findLoadedParent(M,a),B=this.findLoadedSibling(M),W=z||B||null;W&&(this._addTile(W.tileID),g[W.tileID.key]=W.tileID),_[T]=M}this._retainLoadedChildren(_,e);for(const T in g)e[T]||(this._coveredTiles[T]=!0,e[T]=g[T]);if(d){const T={},M={};for(const I of l)this._tiles[I.key].hasData()?T[I.key]=I:M[I.key]=I;for(const I in M){const z=M[I].children(this._source.maxzoom);this._tiles[z[0].key]&&this._tiles[z[1].key]&&this._tiles[z[2].key]&&this._tiles[z[3].key]&&(T[z[0].key]=e[z[0].key]=z[0],T[z[1].key]=e[z[1].key]=z[1],T[z[2].key]=e[z[2].key]=z[2],T[z[3].key]=e[z[3].key]=z[3],delete M[I])}for(const I in M){const z=M[I],B=this.findLoadedParent(z,this._source.minzoom),W=this.findLoadedSibling(z),Y=B||W||null;if(Y){T[Y.tileID.key]=e[Y.tileID.key]=Y.tileID;for(const K in T)T[K].isChildOf(Y.tileID)&&delete T[K]}}for(const I in this._tiles)T[I]||(this._coveredTiles[I]=!0)}}update(e,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((T=>new c.Z(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y))):(l=xe(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((T=>this._source.hasTile(T))))):l=[];const d=bt(e,this._source),g=Math.max(d-hn.maxOverzooming,this._source.minzoom);if(this.usedForTerrain){const T={};for(const M of l)if(M.canonical.z>this._source.minzoom){const I=M.scaledTo(M.canonical.z-1);T[I.key]=I;const z=M.scaledTo(Math.max(this._source.minzoom,Math.min(M.canonical.z,5)));T[z.key]=z}l=l.concat(Object.values(T))}const _=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const w=this._updateRetainedTiles(l,d);Ht(this._source.type)&&this._updateCoveredAndRetainedTiles(w,g,l,a);for(const T in w)this._tiles[T].clearFadeHold();const S=c.am(this._tiles,w);for(const T of S){const M=this._tiles[T];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(T)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var l;const d={},g={},_=Math.max(a-hn.maxOverzooming,this._source.minzoom),w={};for(const S of e){const T=this._addTile(S);d[S.key]=S,T.hasData()||a<this._source.maxzoom&&(w[S.key]=S)}this._retainLoadedChildren(w,d);for(const S of e){let T=this._tiles[S.key];if(T.hasData())continue;if(a+1>this._source.maxzoom){const I=S.children(this._source.maxzoom)[0],z=this.getTile(I);if(z&&z.hasData()){d[I.key]=I;continue}}else{const I=S.children(this._source.maxzoom);if(I.length===4&&d[I[0].key]&&d[I[1].key]&&d[I[2].key]&&d[I[3].key]||I.length===1&&d[I[0].key])continue}let M=T.wasRequested();for(let I=S.overscaledZ-1;I>=_;--I){const z=S.scaledTo(I);if(g[z.key])break;if(g[z.key]=!0,T=this.getTile(z),!T&&M&&(T=this._addTile(z)),T){const B=T.hasData();if((B||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||M)&&(d[z.key]=z),M=T.wasRequested(),B)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let l,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){l=this._loadedParentTiles[d.key];break}a.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(l=this._getLoadedTile(g),l)break;d=g}for(const g of a)this._loadedParentTiles[g]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const a=this._tiles[e].tileID,l=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=l}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const l=a;return a||(a=new Mi(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,l||this._source.fire(new c.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=a.getExpiryTimeout();l&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),l))}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some((l=>l.equals(this._tiles[a].tileID.canonical)))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){const a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,l){const d=[],g=this.transform;if(!g)return d;const _=g.getCoveringTilesDetailsProvider().allowWorldCopies(),w=l?g.getCameraQueryGeometry(e):e,S=B=>g.screenPointToMercatorCoordinate(B,this.terrain),T=this.transformBbox(e,S,!_),M=this.transformBbox(w,S,!_),I=this.getIds(),z=c.a2.fromPoints(M);for(let B=0;B<I.length;B++){const W=this._tiles[I[B]];if(W.holdingForFade())continue;const Y=_?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],K=Math.pow(2,g.zoom-W.tileID.overscaledZ),J=a*W.queryPadding*c.$/W.tileSize/K;for(const re of Y){const se=z.map((ie=>re.getTilePoint(new c.a1(ie.x,ie.y))));if(se.expandBy(J),se.intersects(Wt)){const ie=T.map((pe=>re.getTilePoint(pe))),ce=M.map((pe=>re.getTilePoint(pe)));d.push({tile:W,tileID:_?re:re.unwrapTo(0),queryGeometry:ie,cameraQueryGeometry:ce,scale:K})}}}return d}transformBbox(e,a,l){let d=e.map(a);if(l){const g=c.a2.fromPoints(e);g.shrinkBy(.001*Math.min(g.width(),g.height()));const _=g.map(a);c.a2.fromPoints(d).covers(_)||(d=d.map((w=>w.x>.5?new c.a1(w.x-1,w.y,w.z):w)))}return d}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((l=>this._tiles[l].tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(Ht(this._source.type)){const e=Ce.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,l){this._state.updateState(e=e||"_geojsonTileLayer",a,l)}removeFeatureState(e,a,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,l)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,l){const d=this._tiles[e];d&&d.setDependencies(a,l)}reloadTilesForDependencies(e,a){for(const l in this._tiles)this._tiles[l].hasDependency(e,a)&&this._reloadTile(l,"reloading");this._cache.filter((l=>!l.hasDependency(e,a)))}}function Mt(f,e){const a=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-a||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Ht(f){return f==="raster"||f==="image"||f==="video"}hn.maxOverzooming=10,hn.maxUnderzooming=3;class zn{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ah(e,0,1);let a=1,l=this._distances[a];const d=e*this.paddedLength+this.padding;for(;l<d&&a<this._distances.length;)l=this._distances[++a];const g=a-1,_=this._distances[g],w=l-_,S=w>0?(d-_)/w:0;return this.points[g].mult(1-S).add(this.points[a].mult(S))}}function Fr(f,e){let a=!0;return f==="always"||f!=="never"&&e!=="never"||(a=!1),a}class Vr{constructor(e,a,l){const d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(a/l);for(let _=0;_<this.xCellCount*this.yCellCount;_++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,l,d,g){this._forEachCell(a,l,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)}insertCircle(e,a,l,d){this._forEachCell(a-d,l-d,a+d,l+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(l),this.circles.push(d)}_insertBoxCell(e,a,l,d,g,_){this.boxCells[g].push(_)}_insertCircleCell(e,a,l,d,g,_){this.circleCells[g].push(_)}_query(e,a,l,d,g,_,w){if(l<0||e>this.width||d<0||a>this.height)return[];const S=[];if(e<=0&&a<=0&&this.width<=l&&this.height<=d){if(g)return[{key:null,x1:e,y1:a,x2:l,y2:d}];for(let T=0;T<this.boxKeys.length;T++)S.push({key:this.boxKeys[T],x1:this.bboxes[4*T],y1:this.bboxes[4*T+1],x2:this.bboxes[4*T+2],y2:this.bboxes[4*T+3]});for(let T=0;T<this.circleKeys.length;T++){const M=this.circles[3*T],I=this.circles[3*T+1],z=this.circles[3*T+2];S.push({key:this.circleKeys[T],x1:M-z,y1:I-z,x2:M+z,y2:I+z})}}else this._forEachCell(e,a,l,d,this._queryCell,S,{hitTest:g,overlapMode:_,seenUids:{box:{},circle:{}}},w);return S}query(e,a,l,d){return this._query(e,a,l,d,!1,null)}hitTest(e,a,l,d,g,_){return this._query(e,a,l,d,!0,g,_).length>0}hitTestCircle(e,a,l,d,g){const _=e-l,w=e+l,S=a-l,T=a+l;if(w<0||_>this.width||T<0||S>this.height)return!1;const M=[];return this._forEachCell(_,S,w,T,this._queryCellCircle,M,{hitTest:!0,overlapMode:d,circle:{x:e,y:a,radius:l},seenUids:{box:{},circle:{}}},g),M.length>0}_queryCell(e,a,l,d,g,_,w,S){const{seenUids:T,hitTest:M,overlapMode:I}=w,z=this.boxCells[g];if(z!==null){const W=this.bboxes;for(const Y of z)if(!T.box[Y]){T.box[Y]=!0;const K=4*Y,J=this.boxKeys[Y];if(e<=W[K+2]&&a<=W[K+3]&&l>=W[K+0]&&d>=W[K+1]&&(!S||S(J))&&(!M||!Fr(I,J.overlapMode))&&(_.push({key:J,x1:W[K],y1:W[K+1],x2:W[K+2],y2:W[K+3]}),M))return!0}}const B=this.circleCells[g];if(B!==null){const W=this.circles;for(const Y of B)if(!T.circle[Y]){T.circle[Y]=!0;const K=3*Y,J=this.circleKeys[Y];if(this._circleAndRectCollide(W[K],W[K+1],W[K+2],e,a,l,d)&&(!S||S(J))&&(!M||!Fr(I,J.overlapMode))){const re=W[K],se=W[K+1],ie=W[K+2];if(_.push({key:J,x1:re-ie,y1:se-ie,x2:re+ie,y2:se+ie}),M)return!0}}}return!1}_queryCellCircle(e,a,l,d,g,_,w,S){const{circle:T,seenUids:M,overlapMode:I}=w,z=this.boxCells[g];if(z!==null){const W=this.bboxes;for(const Y of z)if(!M.box[Y]){M.box[Y]=!0;const K=4*Y,J=this.boxKeys[Y];if(this._circleAndRectCollide(T.x,T.y,T.radius,W[K+0],W[K+1],W[K+2],W[K+3])&&(!S||S(J))&&!Fr(I,J.overlapMode))return _.push(!0),!0}}const B=this.circleCells[g];if(B!==null){const W=this.circles;for(const Y of B)if(!M.circle[Y]){M.circle[Y]=!0;const K=3*Y,J=this.circleKeys[Y];if(this._circlesCollide(W[K],W[K+1],W[K+2],T.x,T.y,T.radius)&&(!S||S(J))&&!Fr(I,J.overlapMode))return _.push(!0),!0}}}_forEachCell(e,a,l,d,g,_,w,S){const T=this._convertToXCellCoord(e),M=this._convertToYCellCoord(a),I=this._convertToXCellCoord(l),z=this._convertToYCellCoord(d);for(let B=T;B<=I;B++)for(let W=M;W<=z;W++)if(g.call(this,e,a,l,d,this.xCellCount*W+B,_,w,S))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,l,d,g,_){const w=d-e,S=g-a,T=l+_;return T*T>w*w+S*S}_circleAndRectCollide(e,a,l,d,g,_,w){const S=(_-d)/2,T=Math.abs(e-(d+S));if(T>S+l)return!1;const M=(w-g)/2,I=Math.abs(a-(g+M));if(I>M+l)return!1;if(T<=S||I<=M)return!0;const z=T-S,B=I-M;return z*z+B*B<=l*l}}function Vn(f,e,a){const l=c.L();if(!f){const{vecSouth:I,vecEast:z}=$t(e),B=te();B[0]=z[0],B[1]=z[1],B[2]=I[0],B[3]=I[1],d=B,(M=(_=(g=B)[0])*(T=g[3])-(S=g[2])*(w=g[1]))&&(d[0]=T*(M=1/M),d[1]=-w*M,d[2]=-S*M,d[3]=_*M),l[0]=B[0],l[1]=B[1],l[4]=B[2],l[5]=B[3]}var d,g,_,w,S,T,M;return c.N(l,l,[1/a,1/a,1]),l}function Nt(f,e,a,l){if(f){const d=c.L();if(!e){const{vecSouth:g,vecEast:_}=$t(a);d[0]=_[0],d[1]=_[1],d[4]=g[0],d[5]=g[1]}return c.N(d,d,[l,l,1]),d}return a.pixelsToClipSpaceMatrix}function $t(f){const e=Math.cos(f.rollInRadians),a=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),d=Math.cos(f.bearingInRadians),g=Math.sin(f.bearingInRadians),_=c.ar();_[0]=-d*l*a-g*e,_[1]=-g*l*a+d*e;const w=c.as(_);w<1e-9?c.at(_):c.au(_,_,1/w);const S=c.ar();S[0]=d*l*e-g*a,S[1]=g*l*e+d*a;const T=c.as(S);return T<1e-9?c.at(S):c.au(S,S,1/T),{vecEast:S,vecSouth:_}}function lr(f,e,a,l){let d;l?(d=[f,e,l(f,e),1],c.aw(d,d,a)):(d=[f,e,0,1],ls(d,d,a));const g=d[3];return{point:new c.P(d[0]/g,d[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function it(f,e){return .5+f/e*.5}function yi(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function yr(f,e,a,l,d,g,_,w,S,T,M,I,z){const B=a?f.textSizeData:f.iconSizeData,W=c.an(B,e.transform.zoom),Y=[256/e.width*2+1,256/e.height*2+1],K=a?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;K.clear();const J=f.lineVertexArray,re=a?f.text.placedSymbolArray:f.icon.placedSymbolArray,se=e.transform.width/e.transform.height;let ie=!1;for(let ce=0;ce<re.length;ce++){const pe=re.get(ce);if(pe.hidden||pe.writingMode===c.ao.vertical&&!ie){Ha(pe.numGlyphs,K);continue}ie=!1;const ae=new c.P(pe.anchorX,pe.anchorY),_e={getElevation:z,pitchedLabelPlaneMatrix:l,lineVertexArray:J,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:ae,unwrappedTileID:S,width:T,height:M,translation:I},Le=ur(pe.anchorX,pe.anchorY,_e);if(!yi(Le.point,Y)){Ha(pe.numGlyphs,K);continue}const Te=it(e.transform.cameraToCenterDistance,Le.signedDistanceFromCamera),Ee=c.ap(B,W,pe),ke=g?Ee*e.transform.getPitchedTextCorrection(pe.anchorX,pe.anchorY,S)/Te:Ee*Te,ct=pt({projectionContext:_e,pitchedLabelPlaneMatrixInverse:d,symbol:pe,fontSize:ke,flip:!1,keepUpright:_,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:se,rotateToLine:w});ie=ct.useVertical,(ct.notEnoughRoom||ie||ct.needsFlipping&&pt({projectionContext:_e,pitchedLabelPlaneMatrixInverse:d,symbol:pe,fontSize:ke,flip:!0,keepUpright:_,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:K,aspectRatio:se,rotateToLine:w}).notEnoughRoom)&&Ha(pe.numGlyphs,K)}a?f.text.dynamicLayoutVertexBuffer.updateData(K):f.icon.dynamicLayoutVertexBuffer.updateData(K)}function fo(f,e,a,l,d,g,_,w){const S=g.glyphStartIndex+g.numGlyphs,T=g.lineStartIndex,M=g.lineStartIndex+g.lineLength,I=e.getoffsetX(g.glyphStartIndex),z=e.getoffsetX(S-1),B=Hi(f*I,a,l,d,g.segment,T,M,w,_);if(!B)return null;const W=Hi(f*z,a,l,d,g.segment,T,M,w,_);return W?w.projectionCache.anyProjectionOccluded?null:{first:B,last:W}:null}function qa(f,e,a,l){return f===c.ao.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*l?{useVertical:!0}:(f===c.ao.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function pt(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:d,flip:g,keepUpright:_,glyphOffsetArray:w,dynamicLayoutVertexArray:S,aspectRatio:T,rotateToLine:M}=f,I=d/24,z=l.lineOffsetX*I,B=l.lineOffsetY*I;let W;if(l.numGlyphs>1){const Y=l.glyphStartIndex+l.numGlyphs,K=l.lineStartIndex,J=l.lineStartIndex+l.lineLength,re=fo(I,w,z,B,g,l,M,e);if(!re)return{notEnoughRoom:!0};const se=ya(re.first.point.x,re.first.point.y,e,a),ie=ya(re.last.point.x,re.last.point.y,e,a);if(_&&!g){const ce=qa(l.writingMode,se,ie,T);if(ce)return ce}W=[re.first];for(let ce=l.glyphStartIndex+1;ce<Y-1;ce++){const pe=Hi(I*w.getoffsetX(ce),z,B,g,l.segment,K,J,e,M);if(!pe)return{notEnoughRoom:!0};W.push(pe)}W.push(re.last)}else{if(_&&!g){const K=Er(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,J=l.lineStartIndex+l.segment+1,re=new c.P(e.lineVertexArray.getx(J),e.lineVertexArray.gety(J)),se=Er(re.x,re.y,e),ie=se.signedDistanceFromCamera>0?se.point:rn(e.tileAnchorPoint,re,K,1,e),ce=ya(K.x,K.y,e,a),pe=ya(ie.x,ie.y,e,a),ae=qa(l.writingMode,ce,pe,T);if(ae)return ae}const Y=Hi(I*w.getoffsetX(l.glyphStartIndex),z,B,g,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,M);if(!Y||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[Y]}for(const Y of W)c.av(S,Y.point,Y.angle);return{}}function rn(f,e,a,l,d){const g=f.add(f.sub(e)._unit()),_=Er(g.x,g.y,d).point,w=a.sub(_);return a.add(w._mult(l/w.mag()))}function Qt(f,e,a){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const d=new c.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),g=Er(d.x,d.y,e);if(g.signedDistanceFromCamera>0)return l.projections[f]=g.point,l.anyProjectionOccluded=l.anyProjectionOccluded||g.isOccluded,g.point;const _=f-a.direction;return rn(a.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(_),e.lineVertexArray.gety(_)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Er(f,e,a){const l=f+a.translation[0],d=e+a.translation[1];let g;return a.pitchWithMap?(g=lr(l,d,a.pitchedLabelPlaneMatrix,a.getElevation),g.isOccluded=!1):(g=a.transform.projectTileCoordinates(l,d,a.unwrappedTileID,a.getElevation),g.point.x=(.5*g.point.x+.5)*a.width,g.point.y=(.5*-g.point.y+.5)*a.height),g}function ya(f,e,a,l){if(a.pitchWithMap){const d=[f,e,0,1];return c.aw(d,d,l),a.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],a.unwrappedTileID,a.getElevation).point}return{x:f/a.width*2-1,y:1-e/a.height*2}}function ur(f,e,a){return a.transform.projectTileCoordinates(f,e,a.unwrappedTileID,a.getElevation)}function an(f,e,a){return f._unit()._perp()._mult(e*a)}function Vl(f,e,a,l,d,g,_,w,S){if(w.projectionCache.offsets[f])return w.projectionCache.offsets[f];const T=a.add(e);if(f+S.direction<l||f+S.direction>=d)return w.projectionCache.offsets[f]=T,T;const M=Qt(f+S.direction,w,S),I=an(M.sub(a),_,S.direction),z=a.add(I),B=M.add(I);return w.projectionCache.offsets[f]=c.ax(g,T,z,B)||T,w.projectionCache.offsets[f]}function Hi(f,e,a,l,d,g,_,w,S){const T=l?f-e:f+e;let M=T>0?1:-1,I=0;l&&(M*=-1,I=Math.PI),M<0&&(I+=Math.PI);let z,B=M>0?g+d:g+d+1;w.projectionCache.cachedAnchorPoint?z=w.projectionCache.cachedAnchorPoint:(z=Er(w.tileAnchorPoint.x,w.tileAnchorPoint.y,w).point,w.projectionCache.cachedAnchorPoint=z);let W,Y,K=z,J=z,re=0,se=0;const ie=Math.abs(T),ce=[];let pe;for(;re+se<=ie;){if(B+=M,B<g||B>=_)return null;re+=se,J=K,Y=W;const Le={absOffsetX:ie,direction:M,distanceFromAnchor:re,previousVertex:J};if(K=Qt(B,w,Le),a===0)ce.push(J),pe=K.sub(J);else{let Te;const Ee=K.sub(J);Te=Ee.mag()===0?an(Qt(B+M,w,Le).sub(K),a,M):an(Ee,a,M),Y||(Y=J.add(Te)),W=Vl(B,Te,K,g,_,Y,a,w,Le),ce.push(Y),pe=W.sub(Y)}se=pe.mag()}const ae=pe._mult((ie-re)/se)._add(Y||J),_e=I+Math.atan2(K.y-J.y,K.x-J.x);return ce.push(ae),{point:ae,angle:S?_e:0,path:ce}}const po=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ha(f,e){for(let a=0;a<f;a++){const l=e.length;e.resize(l+4),e.float32.set(po,3*l)}}function ls(f,e,a){const l=e[0],d=e[1];return f[0]=a[0]*l+a[4]*d+a[12],f[1]=a[1]*l+a[5]*d+a[13],f[3]=a[3]*l+a[7]*d+a[15],f}const _r=100;class Lu{constructor(e,a=new Vr(e.width+200,e.height+200,25),l=new Vr(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+_r,this.screenBottomBoundary=e.height+_r,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,l,d,g,_,w,S,T,M,I,z){const B=this.projectAndGetPerspectiveRatio(e.anchorPointX+S[0],e.anchorPointY+S[1],g,M,z),W=l*B.perspectiveRatio;let Y;if(_||w)Y=this._projectCollisionBox(e,W,d,g,_,w,S,B,M,I,z);else{const pe=B.x+(I?I.x*W:0),ae=B.y+(I?I.y*W:0);Y={allPointsOccluded:!1,box:[pe+e.x1*W,ae+e.y1*W,pe+e.x2*W,ae+e.y2*W]}}const[K,J,re,se]=Y.box,ie=_?Y.allPointsOccluded:B.isOccluded;let ce=ie;return ce||(ce=B.perspectiveRatio<this.perspectiveRatioCutoff),ce||(ce=!this.isInsideGrid(K,J,re,se)),ce||a!=="always"&&this.grid.hitTest(K,J,re,se,a,T)?{box:[K,J,re,se],placeable:!1,offscreen:!1,occluded:ie}:{box:[K,J,re,se],placeable:!0,offscreen:this.isOffscreen(K,J,re,se),occluded:ie}}placeCollisionCircles(e,a,l,d,g,_,w,S,T,M,I,z,B,W){const Y=[],K=new c.P(a.anchorX,a.anchorY),J=this.getPerspectiveRatio(K.x,K.y,_,W),re=(T?g*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,_)/J:g*J)/c.aB,se={getElevation:W,pitchedLabelPlaneMatrix:w,lineVertexArray:l,pitchWithMap:T,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:K,unwrappedTileID:_,width:this.transform.width,height:this.transform.height,translation:B},ie=fo(re,d,a.lineOffsetX*re,a.lineOffsetY*re,!1,a,!1,se);let ce=!1,pe=!1,ae=!0;if(ie){const _e=.5*I*J+z,Le=new c.P(-100,-100),Te=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Ee=new zn,ke=ie.first,ct=ie.last;let st=[];for(let ln=ke.path.length-1;ln>=1;ln--)st.push(ke.path[ln]);for(let ln=1;ln<ct.path.length;ln++)st.push(ct.path[ln]);const $e=2.5*_e;if(T){const ln=this.projectPathToScreenSpace(st,se);st=ln.some((Pn=>Pn.signedDistanceFromCamera<=0))?[]:ln.map((Pn=>Pn.point))}let Pt=[];if(st.length>0){const ln=st[0].clone(),Pn=st[0].clone();for(let ar=1;ar<st.length;ar++)ln.x=Math.min(ln.x,st[ar].x),ln.y=Math.min(ln.y,st[ar].y),Pn.x=Math.max(Pn.x,st[ar].x),Pn.y=Math.max(Pn.y,st[ar].y);Pt=ln.x>=Le.x&&Pn.x<=Te.x&&ln.y>=Le.y&&Pn.y<=Te.y?[st]:Pn.x<Le.x||ln.x>Te.x||Pn.y<Le.y||ln.y>Te.y?[]:c.ay([st],Le.x,Le.y,Te.x,Te.y)}for(const ln of Pt){Ee.reset(ln,.25*_e);let Pn=0;Pn=Ee.length<=.5*_e?1:Math.ceil(Ee.paddedLength/$e)+1;for(let ar=0;ar<Pn;ar++){const Fn=ar/Math.max(Pn-1,1),Nn=Ee.lerp(Fn),$n=Nn.x+_r,Wn=Nn.y+_r;Y.push($n,Wn,_e,0);const Un=$n-_e,vn=Wn-_e,jr=$n+_e,zr=Wn+_e;if(ae=ae&&this.isOffscreen(Un,vn,jr,zr),pe=pe||this.isInsideGrid(Un,vn,jr,zr),e!=="always"&&this.grid.hitTestCircle($n,Wn,_e,e,M)&&(ce=!0,!S))return{circles:[],offscreen:!1,collisionDetected:ce}}}}return{circles:!S&&ce||!pe||J<this.perspectiveRatioCutoff?[]:Y,offscreen:ae,collisionDetected:ce}}projectPathToScreenSpace(e,a){const l=(function(d,g){const _=c.L();return c.aq(_,g.pitchedLabelPlaneMatrix),d.map((w=>{const S=lr(w.x,w.y,_,g.getElevation),T=g.transform.projectTileCoordinates(S.point.x,S.point.y,g.unwrappedTileID,g.getElevation);return T.point.x=(.5*T.point.x+.5)*g.width,T.point.y=(.5*-T.point.y+.5)*g.height,T}))})(e,a);return(function(d){let g=0,_=0,w=0,S=0;for(let T=0;T<d.length;T++)d[T].isOccluded?(w=T+1,S=0):(S++,S>_&&(_=S,g=w));return d.slice(g,g+_)})(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new c.a2;for(const I of e){const z=new c.P(I.x+_r,I.y+_r);l.extend(z),a.push(z)}const{minX:d,minY:g,maxX:_,maxY:w}=l,S=this.grid.query(d,g,_,w).concat(this.ignoredGrid.query(d,g,_,w)),T={},M={};for(const I of S){const z=I.key;if(T[z.bucketInstanceId]===void 0&&(T[z.bucketInstanceId]={}),T[z.bucketInstanceId][z.featureIndex])continue;const B=[new c.P(I.x1,I.y1),new c.P(I.x2,I.y1),new c.P(I.x2,I.y2),new c.P(I.x1,I.y2)];c.az(a,B)&&(T[z.bucketInstanceId][z.featureIndex]=!0,M[z.bucketInstanceId]===void 0&&(M[z.bucketInstanceId]=[]),M[z.bucketInstanceId].push(z.featureIndex))}return M}insertCollisionBox(e,a,l,d,g,_){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:g,collisionGroupID:_,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,l,d,g,_){const w=l?this.ignoredGrid:this.grid,S={bucketInstanceId:d,featureIndex:g,collisionGroupID:_,overlapMode:a};for(let T=0;T<e.length;T+=4)w.insertCircle(S,e[T],e[T+1],e[T+2])}projectAndGetPerspectiveRatio(e,a,l,d,g){if(g){let _;d?(_=[e,a,d(e,a),1],c.aw(_,_,g)):(_=[e,a,0,1],ls(_,_,g));const w=_[3];return{x:(_[0]/w+1)/2*this.transform.width+_r,y:(-_[1]/w+1)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/w*.5,isOccluded:!1,signedDistanceFromCamera:w}}{const _=this.transform.projectTileCoordinates(e,a,l,d);return{x:(_.point.x+1)/2*this.transform.width+_r,y:(1-_.point.y)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5,isOccluded:_.isOccluded,signedDistanceFromCamera:_.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,l,d){const g=this.transform.projectTileCoordinates(e,a,l,d);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,a,l,d){return l<_r||e>=this.screenRightBoundary||d<_r||a>this.screenBottomBoundary}isInsideGrid(e,a,l,d){return l>=0&&e<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=c.ag([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,l,d,g,_,w,S,T,M,I){let z=1,B=0,W=0,Y=1;const K=e.anchorPointX+w[0],J=e.anchorPointY+w[1];if(_&&!g){const st=this.projectAndGetPerspectiveRatio(K+1,J,d,T,I),$e=st.x-S.x,Pt=Math.atan((st.y-S.y)/$e)+($e<0?Math.PI:0),ln=Math.sin(Pt),Pn=Math.cos(Pt);z=Pn,B=ln,W=-ln,Y=Pn}else if(!_&&g){const st=$t(this.transform);z=st.vecEast[0],B=st.vecEast[1],W=st.vecSouth[0],Y=st.vecSouth[1]}let re=S.x,se=S.y,ie=a;g&&(re=K,se=J,ie=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ie*=this.transform.getPitchedTextCorrection(K,J,d),M||(ie*=c.ah(.5+S.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),M&&(re+=z*M.x*ie+W*M.y*ie,se+=B*M.x*ie+Y*M.y*ie);const ce=e.x1*ie,pe=e.x2*ie,ae=(ce+pe)/2,_e=e.y1*ie,Le=e.y2*ie,Te=(_e+Le)/2,Ee=[{offsetX:ce,offsetY:_e},{offsetX:ae,offsetY:_e},{offsetX:pe,offsetY:_e},{offsetX:pe,offsetY:Te},{offsetX:pe,offsetY:Le},{offsetX:ae,offsetY:Le},{offsetX:ce,offsetY:Le},{offsetX:ce,offsetY:Te}];let ke=[];for(const{offsetX:st,offsetY:$e}of Ee)ke.push(new c.P(re+z*st+W*$e,se+B*st+Y*$e));let ct=!1;if(g){const st=ke.map(($e=>this.projectAndGetPerspectiveRatio($e.x,$e.y,d,T,I)));ct=st.some(($e=>!$e.isOccluded)),ke=st.map(($e=>new c.P($e.x,$e.y)))}else ct=!0;return{box:c.aA(ke),allPointsOccluded:!ct}}}class si{constructor(e,a,l,d){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):d&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class In{constructor(e,a,l,d,g){this.text=new si(e?e.text:null,a,l,g),this.icon=new si(e?e.icon:null,a,d,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $a{constructor(e,a,l){this.text=e,this.icon=a,this.skipFade=l}}class us{constructor(e,a,l,d,g){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=d,this.tileID=g}}class ku{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[e]}}function ra(f,e,a,l,d){const{horizontalAlign:g,verticalAlign:_}=c.aH(f);return new c.P(-(g-.5)*e+l[0]*d,-(_-.5)*a+l[1]*d)}class Xa{constructor(e,a,l,d,g){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new Lu(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new ku(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(l,d)=>a.getElevation(e,l,d):null}getBucketParts(e,a,l,d){const g=l.getBucket(a),_=l.latestFeatureIndex;if(!g||!_||a.id!==g.layerIds[0])return;const w=l.collisionBoxArray,S=g.layers[0].layout,T=g.layers[0].paint,M=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),I=l.tileSize/c.$,z=l.tileID.toUnwrapped(),B=S.get("text-rotation-alignment")==="map",W=c.aC(l,1,this.transform.zoom),Y=c.aD(this.collisionIndex.transform,l,T.get("text-translate"),T.get("text-translate-anchor")),K=c.aD(this.collisionIndex.transform,l,T.get("icon-translate"),T.get("icon-translate-anchor")),J=Vn(B,this.transform,W);this.retainedQueryData[g.bucketInstanceId]=new us(g.bucketInstanceId,_,g.sourceLayerIndex,g.index,l.tileID);const re={bucket:g,layout:S,translationText:Y,translationIcon:K,unwrappedTileID:z,pitchedLabelPlaneMatrix:J,scale:M,textPixelRatio:I,holdingForFade:l.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:c.an(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(d)for(const se of g.sortKeyRanges){const{sortKey:ie,symbolInstanceStart:ce,symbolInstanceEnd:pe}=se;e.push({sortKey:ie,symbolInstanceStart:ce,symbolInstanceEnd:pe,parameters:re})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:re})}attemptAnchorPlacement(e,a,l,d,g,_,w,S,T,M,I,z,B,W,Y,K,J,re,se,ie){const ce=c.aE[e.textAnchor],pe=[e.textOffset0,e.textOffset1],ae=ra(ce,l,d,pe,g),_e=this.collisionIndex.placeCollisionBox(a,z,S,T,M,w,_,K,I.predicate,se,ae,ie);if((!re||this.collisionIndex.placeCollisionBox(re,z,S,T,M,w,_,J,I.predicate,se,ae,ie).placeable)&&_e.placeable){let Le;if(this.prevPlacement&&this.prevPlacement.variableOffsets[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID]&&this.prevPlacement.placements[B.crossTileID].text&&(Le=this.prevPlacement.variableOffsets[B.crossTileID].anchor),B.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[B.crossTileID]={textOffset:pe,width:l,height:d,anchor:ce,textBoxScale:g,prevAnchor:Le},this.markUsedJustification(W,ce,B,Y),W.allowVerticalPlacement&&(this.markUsedOrientation(W,Y,B),this.placedOrientations[B.crossTileID]=Y),{shift:ae,placedGlyphBoxes:_e}}}placeLayerBucketPart(e,a,l){const{bucket:d,layout:g,translationText:_,translationIcon:w,unwrappedTileID:S,pitchedLabelPlaneMatrix:T,textPixelRatio:M,holdingForFade:I,collisionBoxArray:z,partiallyEvaluatedTextSize:B,collisionGroup:W}=e.parameters,Y=g.get("text-optional"),K=g.get("icon-optional"),J=c.aF(g,"text-overlap","text-allow-overlap"),re=J==="always",se=c.aF(g,"icon-overlap","icon-allow-overlap"),ie=se==="always",ce=g.get("text-rotation-alignment")==="map",pe=g.get("text-pitch-alignment")==="map",ae=g.get("icon-text-fit")!=="none",_e=g.get("symbol-z-order")==="viewport-y",Le=re&&(ie||!d.hasIconData()||K),Te=ie&&(re||!d.hasTextData()||Y);!d.collisionArrays&&z&&d.deserializeCollisionBoxes(z);const Ee=this.retainedQueryData[d.bucketInstanceId].tileID,ke=this._getTerrainElevationFunc(Ee),ct=this.transform.getFastPathSimpleProjectionMatrix(Ee),st=($e,Pt,ln)=>{var Pn,ar;if(a[$e.crossTileID])return;if(I)return void(this.placements[$e.crossTileID]=new $a(!1,!1,!1));let Fn=!1,Nn=!1,$n=!0,Wn=null,Un={box:null,placeable:!1,offscreen:null,occluded:!1},vn={placeable:!1},jr=null,zr=null,Ni=null,rs=0,Mo=0,Ui=0;Pt.textFeatureIndex?rs=Pt.textFeatureIndex:$e.useRuntimeCollisionCircles&&(rs=$e.featureIndex),Pt.verticalTextFeatureIndex&&(Mo=Pt.verticalTextFeatureIndex);const Ro=Pt.textBox;if(Ro){const ni=Dn=>{let hr=c.ao.horizontal;if(d.allowVerticalPlacement&&!Dn&&this.prevPlacement){const wi=this.prevPlacement.placedOrientations[$e.crossTileID];wi&&(this.placedOrientations[$e.crossTileID]=wi,hr=wi,this.markUsedOrientation(d,hr,$e))}return hr},ao=(Dn,hr)=>{if(d.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&Pt.verticalTextBox){for(const wi of d.writingModes)if(wi===c.ao.vertical?(Un=hr(),vn=Un):Un=Dn(),Un&&Un.placeable)break}else Un=Dn()},oo=$e.textAnchorOffsetStartIndex,as=$e.textAnchorOffsetEndIndex;if(as===oo){const Dn=(hr,wi)=>{const xr=this.collisionIndex.placeCollisionBox(hr,J,M,Ee,S,pe,ce,_,W.predicate,ke,void 0,ct);return xr&&xr.placeable&&(this.markUsedOrientation(d,wi,$e),this.placedOrientations[$e.crossTileID]=wi),xr};ao((()=>Dn(Ro,c.ao.horizontal)),(()=>{const hr=Pt.verticalTextBox;return d.allowVerticalPlacement&&$e.numVerticalGlyphVertices>0&&hr?Dn(hr,c.ao.vertical):{box:null,offscreen:null}})),ni(Un&&Un.placeable)}else{let Dn=c.aE[(ar=(Pn=this.prevPlacement)===null||Pn===void 0?void 0:Pn.variableOffsets[$e.crossTileID])===null||ar===void 0?void 0:ar.anchor];const hr=(xr,ic,ac)=>{const Ml=xr.x2-xr.x1,Ua=xr.y2-xr.y1,so=$e.textBoxScale,Sr=ae&&se==="never"?ic:null;let br=null,lo=J==="never"?1:2,zo="never";Dn&&lo++;for(let Io=0;Io<lo;Io++){for(let ba=oo;ba<as;ba++){const Pr=d.textAnchorOffsets.get(ba);if(Dn&&Pr.textAnchor!==Dn)continue;const Ls=this.attemptAnchorPlacement(Pr,xr,Ml,Ua,so,ce,pe,M,Ee,S,W,zo,$e,d,ac,_,w,Sr,ke);if(Ls&&(br=Ls.placedGlyphBoxes,br&&br.placeable))return Fn=!0,Wn=Ls.shift,br}Dn?Dn=null:zo=J}return l&&!br&&(br={box:this.collisionIndex.placeCollisionBox(Ro,"always",M,Ee,S,pe,ce,_,W.predicate,ke,void 0,ct).box,offscreen:!1,placeable:!1,occluded:!1}),br};ao((()=>hr(Ro,Pt.iconBox,c.ao.horizontal)),(()=>{const xr=Pt.verticalTextBox;return d.allowVerticalPlacement&&(!Un||!Un.placeable)&&$e.numVerticalGlyphVertices>0&&xr?hr(xr,Pt.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Un&&(Fn=Un.placeable,$n=Un.offscreen);const wi=ni(Un&&Un.placeable);if(!Fn&&this.prevPlacement){const xr=this.prevPlacement.variableOffsets[$e.crossTileID];xr&&(this.variableOffsets[$e.crossTileID]=xr,this.markUsedJustification(d,xr.anchor,$e,wi))}}}if(jr=Un,Fn=jr&&jr.placeable,$n=jr&&jr.offscreen,$e.useRuntimeCollisionCircles){const ni=d.text.placedSymbolArray.get($e.centerJustifiedTextSymbolIndex),ao=c.ap(d.textSizeData,B,ni),oo=g.get("text-padding");zr=this.collisionIndex.placeCollisionCircles(J,ni,d.lineVertexArray,d.glyphOffsetArray,ao,S,T,l,pe,W.predicate,$e.collisionCircleDiameter,oo,_,ke),zr.circles.length&&zr.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),Fn=re||zr.circles.length>0&&!zr.collisionDetected,$n=$n&&zr.offscreen}if(Pt.iconFeatureIndex&&(Ui=Pt.iconFeatureIndex),Pt.iconBox){const ni=ao=>this.collisionIndex.placeCollisionBox(ao,se,M,Ee,S,pe,ce,w,W.predicate,ke,ae&&Wn?Wn:void 0,ct);vn&&vn.placeable&&Pt.verticalIconBox?(Ni=ni(Pt.verticalIconBox),Nn=Ni.placeable):(Ni=ni(Pt.iconBox),Nn=Ni.placeable),$n=$n&&Ni.offscreen}const is=Y||$e.numHorizontalGlyphVertices===0&&$e.numVerticalGlyphVertices===0,_u=K||$e.numIconVertices===0;is||_u?_u?is||(Nn=Nn&&Fn):Fn=Nn&&Fn:Nn=Fn=Nn&&Fn;const Do=Nn&&Ni.placeable;if(Fn&&jr.placeable&&this.collisionIndex.insertCollisionBox(jr.box,J,g.get("text-ignore-placement"),d.bucketInstanceId,vn&&vn.placeable&&Mo?Mo:rs,W.ID),Do&&this.collisionIndex.insertCollisionBox(Ni.box,se,g.get("icon-ignore-placement"),d.bucketInstanceId,Ui,W.ID),zr&&Fn&&this.collisionIndex.insertCollisionCircles(zr.circles,J,g.get("text-ignore-placement"),d.bucketInstanceId,rs,W.ID),l&&this.storeCollisionData(d.bucketInstanceId,ln,Pt,jr,Ni,zr),$e.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[$e.crossTileID]=new $a((Fn||Le)&&!jr?.occluded,(Nn||Te)&&!Ni?.occluded,$n||d.justReloaded),a[$e.crossTileID]=!0};if(_e){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const $e=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Pt=$e.length-1;Pt>=0;--Pt){const ln=$e[Pt];st(d.symbolInstances.get(ln),d.collisionArrays[ln],ln)}}else for(let $e=e.symbolInstanceStart;$e<e.symbolInstanceEnd;$e++)st(d.symbolInstances.get($e),d.collisionArrays[$e],$e);d.justReloaded=!1}storeCollisionData(e,a,l,d,g,_){if(l.textBox||l.iconBox){let w,S;this.collisionBoxArrays.has(e)?w=this.collisionBoxArrays.get(e):(w=new Map,this.collisionBoxArrays.set(e,w)),w.has(a)?S=w.get(a):(S={text:null,icon:null},w.set(a,S)),l.textBox&&(S.text=d.box),l.iconBox&&(S.icon=g.box)}if(_){let w=this.collisionCircleArrays[e];w===void 0&&(w=this.collisionCircleArrays[e]=[]);for(let S=0;S<_.circles.length;S+=4)w.push(_.circles[S+0]-_r),w.push(_.circles[S+1]-_r),w.push(_.circles[S+2]),w.push(_.collisionDetected?1:0)}}markUsedJustification(e,a,l,d){let g;g=d===c.ao.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aG(a)];const _=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const w of _)w>=0&&(e.text.placedSymbolArray.get(w).crossTileID=g>=0&&w!==g?0:l.crossTileID)}markUsedOrientation(e,a,l){const d=a===c.ao.horizontal||a===c.ao.horizontalOnly?a:0,g=a===c.ao.vertical?a:0,_=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const w of _)e.text.placedSymbolArray.get(w).placedOrientation=d;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(e):1,g=a?a.opacities:{},_=a?a.variableOffsets:{},w=a?a.placedOrientations:{};for(const S in this.placements){const T=this.placements[S],M=g[S];M?(this.opacities[S]=new In(M,d,T.text,T.icon),l=l||T.text!==M.text.placed||T.icon!==M.icon.placed):(this.opacities[S]=new In(null,d,T.text,T.icon,T.skipFade),l=l||T.text||T.icon)}for(const S in g){const T=g[S];if(!this.opacities[S]){const M=new In(T,d,!1,!1);M.isHidden()||(this.opacities[S]=M,l=l||T.text.placed||T.icon.placed)}}for(const S in _)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=_[S]);for(const S in w)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=w[S]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const l={};for(const d of a){const g=d.getBucket(e);g&&d.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,d.tileID,l,d.collisionBoxArray)}}updateBucketOpacities(e,a,l,d){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const g=e.layers[0],_=g.layout,w=new In(null,0,!1,!1,!0),S=_.get("text-allow-overlap"),T=_.get("icon-allow-overlap"),M=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),I=_.get("text-rotation-alignment")==="map",z=_.get("text-pitch-alignment")==="map",B=_.get("icon-text-fit")!=="none",W=new In(null,0,S&&(T||!e.hasIconData()||_.get("icon-optional")),T&&(S||!e.hasTextData()||_.get("text-optional")),!0);!e.collisionArrays&&d&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(d);const Y=(J,re,se)=>{for(let ie=0;ie<re/4;ie++)J.opacityVertexArray.emplaceBack(se);J.hasVisibleVertices=J.hasVisibleVertices||se!==tl},K=this.collisionBoxArrays.get(e.bucketInstanceId);for(let J=0;J<e.symbolInstances.length;J++){const re=e.symbolInstances.get(J),{numHorizontalGlyphVertices:se,numVerticalGlyphVertices:ie,crossTileID:ce}=re;let pe=this.opacities[ce];l[ce]?pe=w:pe||(pe=W,this.opacities[ce]=pe),l[ce]=!0;const ae=re.numIconVertices>0,_e=this.placedOrientations[re.crossTileID],Le=_e===c.ao.vertical,Te=_e===c.ao.horizontal||_e===c.ao.horizontalOnly;if(se>0||ie>0){const ke=el(pe.text);Y(e.text,se,Le?tl:ke),Y(e.text,ie,Te?tl:ke);const ct=pe.text.isHidden();[re.rightJustifiedTextSymbolIndex,re.centerJustifiedTextSymbolIndex,re.leftJustifiedTextSymbolIndex].forEach((Pt=>{Pt>=0&&(e.text.placedSymbolArray.get(Pt).hidden=ct||Le?1:0)})),re.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(re.verticalPlacedTextSymbolIndex).hidden=ct||Te?1:0);const st=this.variableOffsets[re.crossTileID];st&&this.markUsedJustification(e,st.anchor,re,_e);const $e=this.placedOrientations[re.crossTileID];$e&&(this.markUsedJustification(e,"left",re,$e),this.markUsedOrientation(e,$e,re))}if(ae){const ke=el(pe.icon),ct=!(B&&re.verticalPlacedIconSymbolIndex&&Le);re.placedIconSymbolIndex>=0&&(Y(e.icon,re.numIconVertices,ct?ke:tl),e.icon.placedSymbolArray.get(re.placedIconSymbolIndex).hidden=pe.icon.isHidden()),re.verticalPlacedIconSymbolIndex>=0&&(Y(e.icon,re.numVerticalIconVertices,ct?tl:ke),e.icon.placedSymbolArray.get(re.verticalPlacedIconSymbolIndex).hidden=pe.icon.isHidden())}const Ee=K&&K.has(J)?K.get(J):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const ke=e.collisionArrays[J];if(ke){let ct=new c.P(0,0);if(ke.textBox||ke.verticalTextBox){let st=!0;if(M){const $e=this.variableOffsets[ce];$e?(ct=ra($e.anchor,$e.width,$e.height,$e.textOffset,$e.textBoxScale),I&&ct._rotate(z?-this.transform.bearingInRadians:this.transform.bearingInRadians)):st=!1}if(ke.textBox||ke.verticalTextBox){let $e;ke.textBox&&($e=Le),ke.verticalTextBox&&($e=Te),Gl(e.textCollisionBox.collisionVertexArray,pe.text.placed,!st||$e,Ee.text,ct.x,ct.y)}}if(ke.iconBox||ke.verticalIconBox){const st=!!(!Te&&ke.verticalIconBox);let $e;ke.iconBox&&($e=st),ke.verticalIconBox&&($e=!st),Gl(e.iconCollisionBox.collisionVertexArray,pe.icon.placed,$e,Ee.icon,B?ct.x:0,B?ct.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function Gl(f,e,a,l,d,g){l&&l.length!==0||(l=[0,0,0,0]);const _=l[0]-_r,w=l[1]-_r,S=l[2]-_r,T=l[3]-_r;f.emplaceBack(e?1:0,a?1:0,d||0,g||0,_,w),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,S,w),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,S,T),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,_,T)}const Ih=Math.pow(2,25),Tc=Math.pow(2,24),li=Math.pow(2,17),Ac=Math.pow(2,16),wd=Math.pow(2,9),Ou=Math.pow(2,8),Lh=Math.pow(2,1);function el(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,a=Math.floor(127*f.opacity);return a*Ih+e*Tc+a*li+e*Ac+a*wd+e*Ou+a*Lh+e}const tl=0;class $i{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,l,d,g){const _=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(_,d,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(((w,S)=>w.sortKey-S.sortKey)));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,g())return!0;return!1}}class Wl{constructor(e,a,l,d,g,_,w,S){this.placement=new Xa(e,a,_,w,S),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,a,l){const d=Ce.now(),g=()=>!this._forceFullPlacement&&Ce.now()-d>2;for(;this._currentPlacementIndex>=0;){const _=a[e[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=w)&&(!_.maxzoom||_.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new $i(_)),this._inProgressLayer.continuePlacement(l[_.source],this.placement,this._showCollisionBoxes,_,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const cs=512/c.$/2;class Zl{constructor(e,a,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const d=new Map;for(let g=0;g<a.length;g++){const _=a.get(g),w=_.key,S=d.get(w);S?S.push(_):d.set(w,[_])}for(const[g,_]of d){const w={positions:_.map((S=>({x:Math.floor(S.anchorX*cs),y:Math.floor(S.anchorY*cs)}))),crossTileIDs:_.map((S=>S.crossTileID))};if(w.positions.length>128){const S=new c.aI(w.positions.length,16,Uint16Array);for(const{x:T,y:M}of w.positions)S.add(T,M);S.finish(),delete w.positions,w.index=S}this._symbolsByKey[g]=w}}getScaledCoordinates(e,a){const{x:l,y:d,z:g}=this.tileID.canonical,{x:_,y:w,z:S}=a.canonical,T=cs/Math.pow(2,S-g),M=(w*c.$+e.anchorY)*T,I=d*c.$*cs;return{x:Math.floor((_*c.$+e.anchorX)*T-l*c.$*cs),y:Math.floor(M-I)}}findMatches(e,a,l){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<e.length;g++){const _=e.get(g);if(_.crossTileID)continue;const w=this._symbolsByKey[_.key];if(!w)continue;const S=this.getScaledCoordinates(_,a);if(w.index){const T=w.index.range(S.x-d,S.y-d,S.x+d,S.y+d).sort();for(const M of T){const I=w.crossTileIDs[M];if(!l[I]){l[I]=!0,_.crossTileID=I;break}}}else if(w.positions)for(let T=0;T<w.positions.length;T++){const M=w.positions[T],I=w.crossTileIDs[T];if(Math.abs(M.x-S.x)<=d&&Math.abs(M.y-S.y)<=d&&!l[I]){l[I]=!0,_.crossTileID=I;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class No{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class kh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const l in this.indexes){const d=this.indexes[l],g={};for(const _ in d){const w=d[_];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+a),g[w.tileID.key]=w}this.indexes[l]=g}this.lng=e}addBucket(e,a,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const d=this.usedCrossTileIDs[e.overscaledZ];for(const g in this.indexes){const _=this.indexes[g];if(Number(g)>e.overscaledZ)for(const w in _){const S=_[w];S.tileID.isChildOf(e)&&S.findMatches(a.symbolInstances,e,d)}else{const w=_[e.scaledTo(Number(g)).key];w&&w.findMatches(a.symbolInstances,e,d)}}for(let g=0;g<a.symbolInstances.length;g++){const _=a.symbolInstances.get(g);_.crossTileID||(_.crossTileID=l.generate(),d[_.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Zl(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const l of a.getCrossTileIDsLists())for(const d of l)delete this.usedCrossTileIDs[e][d]}removeStaleBuckets(e){let a=!1;for(const l in this.indexes){const d=this.indexes[l];for(const g in d)e[d[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,d[g]),delete d[g],a=!0)}return a}}class hs{constructor(){this.layerIndexes={},this.crossTileIDs=new No,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,l){let d=this.layerIndexes[e.id];d===void 0&&(d=this.layerIndexes[e.id]=new kh);let g=!1;const _={};d.handleWrapJump(l);for(const w of a){const S=w.getBucket(e);S&&e.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(w.tileID,S,this.crossTileIDs)&&(g=!0),_[S.bucketInstanceId]=!0)}return d.removeStaleBuckets(_)&&(g=!0),g}pruneUnusedLayers(e){const a={};e.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var Ya="void main() {fragColor=vec4(1.0);}";const Aa={prelude:dn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:dn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:dn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:dn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:dn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:dn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:dn(Ya,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:dn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:dn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:dn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:dn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:dn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:dn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:dn(Ya,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:dn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:dn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:dn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:dn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:dn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:dn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:dn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:dn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:dn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:dn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:dn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:dn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:dn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:dn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:dn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:dn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:dn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:dn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:dn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:dn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:dn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function dn(f,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),d=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=g?g.concat(d):d,w={};return{fragmentSource:f=f.replace(a,((S,T,M,I,z)=>(w[z]=!0,T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
in ${M} ${I} ${z};
#else
uniform ${M} ${I} u_${z};
#endif
`:`
#ifdef HAS_UNIFORM_u_${z}
    ${M} ${I} ${z} = u_${z};
#endif
`))),vertexSource:e=e.replace(a,((S,T,M,I,z)=>{const B=I==="float"?"vec2":"vec4",W=z.match(/color/)?"color":B;return w[z]?T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${M} ${B} a_${z};
out ${M} ${I} ${z};
#else
uniform ${M} ${I} u_${z};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = a_${z};
#else
    ${M} ${I} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = unpack_mix_${W}(a_${z}, u_${z}_t);
#else
    ${M} ${I} ${z} = u_${z};
#endif
`:T==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${M} ${B} a_${z};
#else
uniform ${M} ${I} u_${z};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${M} ${I} ${z} = a_${z};
#else
    ${M} ${I} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${M} ${I} ${z} = unpack_mix_${W}(a_${z}, u_${z}_t);
#else
    ${M} ${I} ${z} = u_${z};
#endif
`})),staticAttributes:l,staticUniforms:_}}class Uo{constructor(e,a,l){this.vertexBuffer=e,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Ka=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const mo="#define PROJECTION_MERCATOR",ds="mercator";class cn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return ds}get shaderDefine(){return mo}get shaderPreludeCode(){return Aa.projectionMercator}get vertexShaderPreludeCode(){return Aa.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,l,d,g){if(this._cachedMesh)return this._cachedMesh;const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(c.$,0),_.emplaceBack(0,c.$),_.emplaceBack(c.$,c.$);const w=e.createVertexBuffer(_,Ka.members),S=c.aM.simpleSegment(0,0,4,2),T=new c.aN;T.emplaceBack(1,0,2),T.emplaceBack(1,2,3);const M=e.createIndexBuffer(T);return this._cachedMesh=new Uo(w,M,S),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class go{constructor(e=0,a=0,l=0,d=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=l,this.right=d}interpolate(e,a,l){return a.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,a.top,l)),a.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,a.bottom,l)),a.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,a.left,l)),a.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,a.right,l)),this}getCenter(e,a){const l=c.ah((this.left+e-this.right)/2,0,e),d=c.ah((this.top+a-this.bottom)/2,0,a);return new c.P(l,d)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new go(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function nl(f,e){if(!f.renderWorldCopies||f.lngRange)return;const a=e.lng-f.center.lng;e.lng+=a>180?-360:a<-180?360:0}function yo(f){return Math.max(0,Math.floor(f))}class Nr{constructor(e,a,l,d,g,_){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=a||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=g??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=yo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new go,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=yo(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new go(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,a&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=c.aO(e,-180,180)*Math.PI/180;var l,d,g,_,w,S,T,M,I;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=te(),l=this._rotationMatrix,g=-this._bearingInRadians,_=(d=this._rotationMatrix)[0],w=d[1],S=d[2],T=d[3],M=Math.sin(g),I=Math.cos(g),l[0]=_*I+S*M,l[1]=w*I+T*M,l[2]=_*-M+S*I,l[3]=w*-M+T*I)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=c.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(e){e=c.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.getConstrained(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=c.af(a),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,l){this._unmodified=!1,this._edgeInsets.interpolate(e,a,l),this._constrain(),this._calcMatrices()}resize(e,a,l=!0){this._width=e,this._height=a,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new qt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(e,a){return this._callbacks.getConstrained(e,a)}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:l,minY:d,maxX:g,maxY:_}=c.a2.fromPoints(a).extend(e);return[new c.P(l,d),new c.P(g,d),new c.P(g,_),new c.P(l,_),new c.P(l,d)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.ag(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.ag(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,l,d){const g=l!==void 0?l:this.bearing,_=d=d!==void 0?d:this.pitch,w=c.a1.fromLngLat(e,a),S=-Math.cos(c.ae(_)),T=Math.sin(c.ae(_)),M=T*Math.sin(c.ae(g)),I=-T*Math.cos(c.ae(g));let z=this.elevation;const B=a-z;let W;S*B>=0||Math.abs(S)<.1?(W=1e4,z=a+W*S):W=-B/S;let Y,K,J=c.aQ(1,w.y),re=0;do{if(re+=1,re>10)break;K=W/J,Y=new c.a1(w.x+M*K,w.y+I*K),J=1/Y.meterInMercatorCoordinateUnits()}while(Math.abs(W-K*J)>1e-12);return{center:Y.toLngLat(),elevation:z,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/K/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=c.aj(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/a,d=c.a1.fromLngLat(this.center,this.elevation),g=Me(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const _=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),c.aQ(g.z,d.y),this.bearing,this.pitch);this._elevation=_.elevation,this._center=_.center,this.setZoom(_.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/c.$,1/a/c.$]}}class Gr{constructor(e,a){this.min=e,this.max=a,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],l=c.aT(this.min),d=c.aT(this.max);for(let g=0;g<a.length;g++)l[g]=a[g]?this.min[g]:this.center[g],d[g]=a[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new Gr(l,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let l=0;l<e.planes.length;l++){const d=this.intersectsPlane(e.planes[l]);if(d===0)return 0;d===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],l=e[3];for(let d=0;d<3;d++)e[d]>0?(a+=e[d]*this.min[d],l+=e[d]*this.max[d]):(l+=e[d]*this.min[d],a+=e[d]*this.max[d]);return a>=0?2:l<0?0:1}}class ui{distanceToTile2d(e,a,l,d){const g=d.distanceX([e,a]),_=d.distanceY([e,a]);return Math.hypot(g,_)}getWrap(e,a,l){return l}getTileBoundingVolume(e,a,l,d){var g,_;let w=0,S=0;if(d?.terrain){const M=new c.Z(e.z,a,e.z,e.x,e.y),I=d.terrain.getMinMaxElevation(M);w=(g=I.minElevation)!==null&&g!==void 0?g:Math.min(0,l),S=(_=I.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}const T=1<<e.z;return new Gr([a+e.x/T,e.y/T,w],[a+(e.x+1)/T,(e.y+1)/T,S])}allowVariableZoom(e,a){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,d=c.ah(78.5-l/2,0,60);return!!a.terrain||e.pitch>d}allowWorldCopies(){return!0}prepareNextFrame(){}}class Mr{constructor(e,a,l){this.points=e,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(e,a=1,l=0,d,g){const _=g?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],w=Math.pow(2,l),S=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((z=>(function(B,W,Y,K){const J=c.aw([],B,W),re=1/J[3]/Y*K;return c.aY(J,J,[re,re,1/J[3],re])})(z,e,a,w)));d&&(function(z,B,W,Y){const K=Y?4:0,J=Y?0:4;let re=0;const se=[],ie=[];for(let ae=0;ae<4;ae++){const _e=c.aU([],z[ae+J],z[ae+K]),Le=c.aZ(_e);c.aR(_e,_e,1/Le),se.push(Le),ie.push(_e)}for(let ae=0;ae<4;ae++){const _e=c.a_(z[ae+K],ie[ae],W);re=_e!==null&&_e>=0?Math.max(re,_e):Math.max(re,se[ae])}const ce=(function(ae,_e){const Le=c.aU([],ae[_e[0]],ae[_e[1]]),Te=c.aU([],ae[_e[2]],ae[_e[1]]),Ee=[0,0,0,0];return c.aV(Ee,c.aW([],Le,Te)),Ee[3]=-c.aX(Ee,ae[_e[0]]),Ee})(z,B),pe=(function(ae,_e){const Le=c.a$(ae),Te=c.b0([],ae,1/Le),Ee=c.aU([],_e,c.aR([],Te,c.aX(_e,Te))),ke=c.a$(Ee);if(ke>0){const ct=Math.sqrt(1-Te[3]*Te[3]),st=c.aR([],Te,-Te[3]),$e=c.aS([],st,c.aR([],Ee,ct/ke));return c.b1(_e,$e)}return null})(W,ce);if(pe!==null){const ae=pe/c.aX(ie[0],ce);re=Math.min(re,ae)}for(let ae=0;ae<4;ae++){const _e=Math.min(re,se[ae]);z[ae+J]=[z[ae+K][0]+ie[ae][0]*_e,z[ae+K][1]+ie[ae][1]*_e,z[ae+K][2]+ie[ae][2]*_e,1]}})(S,_[0],d,g);const T=_.map((z=>{const B=c.aU([],S[z[0]],S[z[1]]),W=c.aU([],S[z[2]],S[z[1]]),Y=c.aV([],c.aW([],B,W)),K=-c.aX(Y,S[z[1]]);return Y.concat(K)})),M=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],I=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const z of S)for(let B=0;B<3;B++)M[B]=Math.min(M[B],z[B]),I[B]=Math.max(I[B],z[B]);return new Mr(S,T,new Gr(M,I))}}class Rn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e,a,l,d,g){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(_,w)=>this.getConstrained(_,w)},e,a,l,d,g),this._coveringTilesDetailsProvider=new ui}clone(){const e=new Rn;return e.apply(this),e}apply(e,a,l){this._helper.apply(e,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new c.b2(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),d=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),_=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),w=Math.floor(Math.min(l.x,d.x,g.x,_.x)),S=Math.floor(Math.max(l.x,d.x,g.x,_.x)),T=1;for(let M=w-T;M<=S+T;M++)M!==0&&a.push(new c.b2(M,e))}return a}getCameraFrustum(){return Mr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,a){const l=c.aj(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(a,l),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),_=c.a1.fromLngLat(e),w=new c.a1(_.x-(d.x-g.x),_.y-(d.y-g.y));this.setCenter(w?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(c.a1.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const l=a||0,d=[e.x,e.y,0,1],g=[e.x,e.y,1,1];c.aw(d,d,this._pixelMatrixInverse),c.aw(g,g,this._pixelMatrixInverse);const _=d[3],w=g[3],S=d[1]/_,T=g[1]/w,M=d[2]/_,I=g[2]/w,z=M===I?0:(l-M)/(I-M);return new c.a1(c.C.number(d[0]/_,g[0]/w,z)/this.worldSize,c.C.number(S,T,z)/this.worldSize,l)}coordinatePoint(e,a=0,l=this._pixelMatrix){const d=[e.x*this.worldSize,e.y*this.worldSize,a,1];return c.aw(d,d,l),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const e=Math.max(0,this._helper._height/2-he(this));return new qt().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-he(this)}calculatePosMatrix(e,a=!1,l){var d;const g=(d=e.key)!==null&&d!==void 0?d:c.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),_=a?this._alignedPosMatrixCache:this._posMatrixCache;if(_.has(g)){const T=_.get(g);return l?T.f32:T.f64}const w=ye(e,this.worldSize);c.O(w,a?this._alignedProjMatrix:this._viewProjMatrix,w);const S={f64:w,f32:new Float32Array(w)};return _.set(g,S),l?S.f32:S.f64}calculateFogMatrix(e){const a=e.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const d=ye(e,this.worldSize);return c.O(d,this._fogMatrix,d),l.set(a,new Float32Array(d)),l.get(a)}getConstrained(e,a){a=c.ah(+a,this.minZoom,this.maxZoom);const l={center:new c.S(e.lng,e.lat),zoom:a};let d=this._helper._lngRange;if(!this._helper._renderWorldCopies&&d===null){const se=179.9999999999;d=[-se,se]}const g=this.tileSize*c.af(l.zoom);let _=0,w=g,S=0,T=g,M=0,I=0;const{x:z,y:B}=this.size;if(this._helper._latRange){const se=this._helper._latRange;_=c.U(se[1])*g,w=c.U(se[0])*g,w-_<B&&(M=B/(w-_))}d&&(S=c.aO(c.V(d[0])*g,0,g),T=c.aO(c.V(d[1])*g,0,g),T<S&&(T+=g),T-S<z&&(I=z/(T-S)));const{x:W,y:Y}=$(g,e);let K,J;const re=Math.max(I||0,M||0);if(re){const se=new c.P(I?(T+S)/2:W,M?(w+_)/2:Y);return l.center=oe(g,se).wrap(),l.zoom+=c.ak(re),l}if(this._helper._latRange){const se=B/2;Y-se<_&&(J=_+se),Y+se>w&&(J=w-se)}if(d){const se=(S+T)/2;let ie=W;this._helper._renderWorldCopies&&(ie=c.aO(W,se-g/2,se+g/2));const ce=z/2;ie-ce<S&&(K=S+ce),ie+ce>T&&(K=T-ce)}if(K!==void 0||J!==void 0){const se=new c.P(K??W,J??Y);l.center=oe(g,se).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}_calculateNearFarZIfNeeded(e,a,l){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-d*this._helper._pixelPerMeter/Math.cos(a),_=d<0?g:e,w=Math.PI/2+this.pitchInRadians,S=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+l.y/this.height),T=Math.sin(S)*_/Math.sin(c.ah(Math.PI-w-S,.01,Math.PI-.01)),M=he(this),I=Math.atan(M/this._helper.cameraToCenterDistance),z=c.ae(.75),B=I>z?2*I*(.5+l.y/(2*M)):z,W=Math.sin(B)*_/Math.sin(c.ah(Math.PI-w-B,.01,Math.PI-.01)),Y=Math.min(T,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*Y+_),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=$(this.worldSize,this.center),l=a.x,d=a.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const g=c.ae(Math.min(this.pitch,V)),_=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g));let w;this._calculateNearFarZIfNeeded(_,g,e),w=new Float64Array(16),c.b4(w,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,w),w[8]=2*-e.x/this._helper._width,w[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b5(w),c.N(w,w,[1,-1,1]),c.M(w,w,[0,0,-this._helper.cameraToCenterDistance]),c.b6(w,w,-this.rollInRadians),c.b7(w,w,this.pitchInRadians),c.b6(w,w,-this.bearingInRadians),c.M(w,w,[-l,-d,0]),this._mercatorMatrix=c.N([],w,[this.worldSize,this.worldSize,this.worldSize]),c.N(w,w,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,w),c.M(w,w,[0,0,-this.elevation]),this._viewProjMatrix=w,this._invViewProjMatrix=c.aq([],w);const S=[0,0,-1,1];c.aw(S,S,this._invViewProjMatrix),this._cameraPosition=[S[0]/S[3],S[1]/S[3],S[2]/S[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,_,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-l,-d,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,w);const T=this._helper._width%2/2,M=this._helper._height%2/2,I=Math.cos(this.bearingInRadians),z=Math.sin(-this.bearingInRadians),B=l-Math.round(l)+I*T+z*M,W=d-Math.round(d)+I*M+z*T,Y=new Float64Array(w);if(c.M(Y,Y,[B>.5?B-1:B,W>.5?W-1:W,0]),this._alignedProjMatrix=Y,w=c.aq(new Float64Array(16),this._pixelMatrix),!w)throw new Error("failed to invert matrix");this._pixelMatrixInverse=w,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aw(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Me(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const l=c.a1.fromLngLat(e),d=[l.x*this.worldSize,l.y*this.worldSize,a,1];return c.aw(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(e){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:d}=e,g=this._helper.getMercatorTileCoordinates(a),_=a?this.calculatePosMatrix(a,l,!0):null;let w;return w=a&&a.terrainRttPosMatrix32f&&d?a.terrainRttPosMatrix32f:_||c.b8(),{mainMatrix:w,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:w}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,l){return 1}transformLightDirection(e){return c.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,l,d){const g=this.calculatePosMatrix(l);let _;d?(_=[e,a,d(e,a),1],c.aw(_,_,g)):(_=[e,a,0,1],ls(_,_,g));const w=_[3];return{point:new c.P(_[0]/w,_[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const l=c.a1.fromLngLat(e,a),d=l.meterInMercatorCoordinateUnits(),g=c.b9();return c.M(g,g,[l.x,l.y,l.z]),c.b6(g,g,Math.PI),c.b7(g,g,Math.PI/2),c.N(g,g,[-d,d,d]),g}getProjectionDataForCustomLayer(e=!0){const a=new c.Z(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),d=ye(a,this.worldSize);c.O(d,this._viewProjMatrix,d),l.tileMercatorCoords=[0,0,1,1];const g=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],_=c.ba();return c.N(_,d,g),l.fallbackMatrix=_,l.mainMatrix=_,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Qa(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ci(f){if(f.useSlerp)if(f.k<1){const e=c.bb(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),a=c.bb(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);c.bc(l,e,a,f.k);const d=c.bd(l);f.tr.setRoll(d.roll),f.tr.setPitch(d.pitch),f.tr.setBearing(d.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(c.C.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(c.C.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(c.C.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function hi(f,e,a,l,d){const g=d.padding,_=$(d.worldSize,a.getNorthWest()),w=$(d.worldSize,a.getNorthEast()),S=$(d.worldSize,a.getSouthEast()),T=$(d.worldSize,a.getSouthWest()),M=c.ae(-l),I=_.rotate(M),z=w.rotate(M),B=S.rotate(M),W=T.rotate(M),Y=new c.P(Math.max(I.x,z.x,W.x,B.x),Math.max(I.y,z.y,W.y,B.y)),K=new c.P(Math.min(I.x,z.x,W.x,B.x),Math.min(I.y,z.y,W.y,B.y)),J=Y.sub(K),re=(d.width-(g.left+g.right+e.left+e.right))/J.x,se=(d.height-(g.top+g.bottom+e.top+e.bottom))/J.y;if(se<0||re<0)return void Qa();const ie=Math.min(c.ak(d.scale*Math.min(re,se)),f.maxZoom),ce=c.P.convert(f.offset),pe=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ae(l)),ae=ce.add(pe).mult(d.scale/c.af(ie));return{center:oe(d.worldSize,_.add(S).div(2).sub(ae)),zoom:ie,bearing:l}}class vr{get useGlobeControls(){return!1}handlePanInertia(e,a){const l=e.mag(),d=Math.abs(he(a));return{easingOffset:e.mult(Math.min(.75*d/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,l){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,a,l,d,g){return hi(e,a,l,d,g)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(c.S.convert(a.center))}handleEaseTo(e,a){const l=e.zoom,d=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},_={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},w=a.zoom!==void 0,S=!e.isPaddingEqual(a.padding);let T=!1;const M=w?+a.zoom:e.zoom;let I=e.centerPoint.add(a.offsetAsPoint);const z=e.screenPointToLocation(I),{center:B,zoom:W}=e.getConstrained(c.S.convert(a.center||z),M??l);nl(e,B);const Y=$(e.worldSize,z),K=$(e.worldSize,B).sub(Y),J=c.af(W-l);return T=W!==l,{easeFunc:re=>{if(T&&e.setZoom(c.C.number(l,W,re)),c.be(g,_)||ci({startEulerAngles:g,endEulerAngles:_,tr:e,k:re,useSlerp:g.roll!=_.roll}),S&&(e.interpolatePadding(d,a.padding,re),I=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const se=c.af(e.zoom-l),ie=W>l?Math.min(2,J):Math.max(.5,J),ce=Math.pow(ie,1-re),pe=oe(e.worldSize,Y.add(K.mult(re*ce)).mult(se));e.setLocationAtPoint(e.renderWorldCopies?pe.wrap():pe,I)}},isZooming:T,elevationCenter:B}}handleFlyTo(e,a){const l=a.zoom!==void 0,d=e.zoom,g=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),l?+a.zoom:d),_=g.center,w=g.zoom;nl(e,_);const S=$(e.worldSize,a.locationAtOffset),T=$(e.worldSize,_).sub(S),M=T.mag(),I=c.af(w-d);let z;if(a.minZoom!==void 0){const B=Math.min(+a.minZoom,d,w),W=e.getConstrained(_,B).zoom;z=c.af(W-d)}return{easeFunc:(B,W,Y,K)=>{e.setZoom(B===1?w:d+c.ak(W));const J=B===1?_:oe(e.worldSize,S.add(T.mult(Y)).mult(W));e.setLocationAtPoint(e.renderWorldCopies?J.wrap():J,K)},scaleOfZoom:I,targetCenter:_,scaleOfMinZoom:z,pixelPathLength:M}}}class Gn{constructor(e,a,l){this.blendFunction=e,this.blendColor=a,this.mask=l}}Gn.Replace=[1,0],Gn.disabled=new Gn(Gn.Replace,c.bf.transparent,[!1,!1,!1,!1]),Gn.unblended=new Gn(Gn.Replace,c.bf.transparent,[!0,!0,!0,!0]),Gn.alphaBlended=new Gn([1,771],c.bf.transparent,[!0,!0,!0,!0]);const Ja=2305;class Ft{constructor(e,a,l){this.enable=e,this.mode=a,this.frontFace=l}}Ft.disabled=new Ft(!1,1029,Ja),Ft.backCCW=new Ft(!0,1029,Ja),Ft.frontCCW=new Ft(!0,1028,Ja);class Xt{constructor(e,a,l){this.func=e,this.mask=a,this.range=l}}Xt.ReadOnly=!1,Xt.ReadWrite=!0,Xt.disabled=new Xt(519,Xt.ReadOnly,[0,1]);const _a=7680;class _n{constructor(e,a,l,d,g,_){this.test=e,this.ref=a,this.mask=l,this.fail=d,this.depthFail=g,this.pass=_}}_n.disabled=new _n({func:519,mask:0},0,0,_a,_a,_a);const rr=new WeakMap;function _i(f){var e;if(rr.has(f))return rr.get(f);{const a=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return rr.set(f,a),a}}class ia{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const d=new c.aL;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const g=new c.aN;g.emplaceBack(0,1,2),this._fullscreenTriangle=new Uo(a.createVertexBuffer(d,Ka.members),a.createIndexBuffer(g),c.aM.simpleSegment(0,0,d.length,g.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const _=l.createTexture();l.bindTexture(l.TEXTURE_2D,_),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(_),_i(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const l=this._cachedRenderContext.context,d=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,d.TRIANGLES,Xt.disabled,_n.disabled,Gn.unblended,Ft.disabled,((g,_)=>({u_input:g,u_output_expected:_}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&_i(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const g=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&_i(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ia._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const jo=c.$/128;function Ec(f,e){const a=f.granularity!==void 0?Math.max(f.granularity,1):1,l=a+(f.generateBorders?2:0),d=a+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),g=l+1,_=d+1,w=f.generateBorders?-1:0,S=f.generateBorders||f.extendToNorthPole?-1:0,T=a+(f.generateBorders?1:0),M=a+(f.generateBorders||f.extendToSouthPole?1:0),I=g*_,z=l*d*6,B=g*_>65536;if(B&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=B||e==="32bit",Y=new Int16Array(2*I);let K=0;for(let se=S;se<=M;se++)for(let ie=w;ie<=T;ie++){let ce=ie/a*c.$;ie===-1&&(ce=-jo),ie===a+1&&(ce=c.$+jo);let pe=se/a*c.$;se===-1&&(pe=f.extendToNorthPole?c.bh:-jo),se===a+1&&(pe=f.extendToSouthPole?c.bi:c.$+jo),Y[K++]=ce,Y[K++]=pe}const J=W?new Uint32Array(z):new Uint16Array(z);let re=0;for(let se=0;se<d;se++)for(let ie=0;ie<l;ie++){const ce=ie+1+se*g,pe=ie+(se+1)*g,ae=ie+1+(se+1)*g;J[re++]=ie+se*g,J[re++]=pe,J[re++]=ce,J[re++]=ce,J[re++]=pe,J[re++]=ae}return{vertices:Y.buffer.slice(0),indices:J.buffer.slice(0),uses32bitIndices:W}}const Vo=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class fs{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Aa.projectionGlobe}get vertexShaderPreludeCode(){return Aa.projectionMercator.vertexSource}get subdivisionGranularity(){return Vo}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new ia(e));const a=c.U(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(a,l),g=Ce.now();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=g);const _=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(_))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,l,d,g){const _=(g==="stencil"?Vo.stencil:Vo.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:_,generateBorders:l,extendToNorthPole:a.y===0&&d,extendToSouthPole:a.y===(1<<a.z)-1&&d})}_getMesh(e,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const d=(function(g,_){const w=Ec(_,"16bit"),S=c.aL.deserialize({arrayBuffer:w.vertices,length:w.vertices.byteLength/2/2}),T=c.aN.deserialize({arrayBuffer:w.indices,length:w.indices.byteLength/2/3});return new Uo(g.createVertexBuffer(S,Ka.members),g.createIndexBuffer(T),c.aM.simpleSegment(0,0,S.length,T.length))})(e,a);return this._tileMeshCache[l]=d,d}recalculate(e){}hasTransition(){const e=Ce.now();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Go=new c.r({type:new c.D(c.v.projection.type)});class ps extends c.E{constructor(e){super(),this._transitionable=new c.t(Go,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new cn,this._verticalPerspectiveProjection=new fs}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,l,d,g){return this.currentProjection.getMeshFromTileID(e,a,l,d,g)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function ql(f){const e=rl(f.worldSize,f.center.lat);return 2*Math.PI*e}function Ea(f,e,a,l,d){const g=1/(1<<d),_=e/c.$*g+l*g,w=c.bo((f/c.$*g+a*g)*Math.PI*2+Math.PI,2*Math.PI),S=2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI,T=Math.cos(S),M=new Float64Array(3);return M[0]=Math.sin(w)*T,M[1]=Math.sin(S),M[2]=Math.cos(w)*T,M}function Qr(f){return(function(e,a){const l=Math.cos(a),d=new Float64Array(3);return d[0]=Math.sin(e)*l,d[1]=Math.sin(a),d[2]=Math.cos(e)*l,d})(f.lng*Math.PI/180,f.lat*Math.PI/180)}function rl(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function ms(f){const e=Math.asin(f[1])/Math.PI*180,a=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(a>1e-6){const l=f[0]/a,d=Math.acos(f[2]/a),g=(l>0?d:-d)/Math.PI*180;return new c.S(c.aO(g,-180,180),e)}return new c.S(0,e)}function gs(f){return Math.cos(f*Math.PI/180)}function wr(f,e){const a=gs(f),l=gs(e);return c.ak(l/a)}function Oh(f,e){const a=f.rotate(e.bearingInRadians),l=e.zoom+wr(e.center.lat,0),d=c.bk(1/gs(e.center.lat),1/gs(Math.min(Math.abs(e.center.lat),60)),c.bn(l,7,3,0,1)),g=360/ql({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-a.x*g*d,c.ah(e.center.lat+a.y*g,-c.ai,c.ai))}function Hl(f){const e=.5*f,a=Math.sin(e),l=Math.cos(e);return Math.log(a+l)-Math.log(l-a)}function Mc(f,e,a,l){const d=f.lat+a*l;if(Math.abs(a)>1){const g=(Math.sign(f.lat+a)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,_=Math.abs(f.lat+a)*Math.PI/180,w=Hl(g+l*(_-g)),S=Hl(g),T=Hl(_);return new c.S(f.lng+e*((w-S)/(T-S)),d)}return new c.S(f.lng+e*l,d)}class Bh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,l,d){const g=`${e.z}_${e.x}_${e.y}_${d?.terrain?"t":""}`,_=this._cache.get(g);if(_)return _;const w=this._cachePrevious.get(g);if(w)return this._cache.set(g,w),w;const S=this._boundingVolumeFactory(e,a,l,d);return this._cache.set(g,S),this._hadAnyChanges=!0,S}}class il{constructor(e,a,l,d){this.min=l,this.max=d,this.points=e,this.planes=a}static fromAabb(e,a){const l=[];for(let d=0;d<8;d++)l.push([1&~d?e[0]:a[0],(d>>1&1)==1?a[1]:e[1],(d>>2&1)==1?a[2]:e[2]]);return new il(l,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,l){const d=c.br([],l[0],l[1],l[2]),g=c.bs([],[a[0],0,0],d),_=c.bs([],[0,a[1],0],d),w=c.bs([],[0,0,a[2]],d),S=[...e],T=[...e];for(let I=0;I<8;I++)for(let z=0;z<3;z++){const B=e[z]+g[z]*(1&~I?-1:1)+_[z]*((I>>1&1)==1?1:-1)+w[z]*((I>>2&1)==1?1:-1);S[z]=Math.min(S[z],B),T[z]=Math.max(T[z],B)}const M=[];for(let I=0;I<8;I++){const z=[...e];c.aS(z,z,c.aR([],g,1&~I?-1:1)),c.aS(z,z,c.aR([],_,(I>>1&1)==1?1:-1)),c.aS(z,z,c.aR([],w,(I>>2&1)==1?1:-1)),M.push(z)}return new il(M,[[...g,-c.aX(g,M[0])],[..._,-c.aX(_,M[0])],[...w,-c.aX(w,M[0])],[-g[0],-g[1],-g[2],-c.aX(g,M[7])],[-_[0],-_[1],-_[2],-c.aX(_,M[7])],[-w[0],-w[1],-w[2],-c.aX(w,M[7])]],S,T)}intersectsFrustum(e){let a=!0;const l=this.points.length,d=this.planes.length,g=e.planes.length,_=e.points.length;for(let w=0;w<g;w++){const S=e.planes[w];let T=0;for(let M=0;M<l;M++){const I=this.points[M];S[0]*I[0]+S[1]*I[1]+S[2]*I[2]+S[3]>=0&&T++}if(T===0)return 0;T<l&&(a=!1)}if(a)return 2;for(let w=0;w<d;w++){const S=this.planes[w];let T=0;for(let M=0;M<_;M++){const I=e.points[M];S[0]*I[0]+S[1]*I[1]+S[2]*I[2]+S[3]>=0&&T++}if(T===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let l=0;for(let d=0;d<a;d++){const g=this.points[d];e[0]*g[0]+e[1]*g[1]+e[2]*g[2]+e[3]>=0&&l++}return l===a?2:l===0?0:1}}function di(f,e,a){const l=f-e;return l<0?-l:Math.max(0,l-a)}function $l(f,e,a,l,d){const g=f-a;let _;return _=g<0?Math.min(-g,1+g-d):g>1?Math.min(Math.max(g-d,0),1-g):0,Math.max(_,di(e,l,d))}class eo{constructor(){this._boundingVolumeCache=new Bh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,l,d){const g=1<<l.z,_=1/g,w=l.x/g,S=l.y/g;let T=2;return T=Math.min(T,$l(e,a,w,S,_)),T=Math.min(T,$l(e,a,w+.5,-S-_,_)),T=Math.min(T,$l(e,a,w+.5,2-S-_,_)),T}getWrap(e,a,l){const d=1<<a.z,g=1/d,_=a.x/d,w=di(e.x,_,g),S=di(e.x,_-1,g),T=di(e.x,_+1,g),M=Math.min(w,S,T);return M===T?1:M===S?-1:0}allowVariableZoom(e,a){return bt(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,l,d){return this._boundingVolumeCache.getTileBoundingVolume(e,a,l,d)}_computeTileBoundingVolume(e,a,l,d){var g,_;let w=0,S=0;if(d?.terrain){const T=new c.Z(e.z,a,e.z,e.x,e.y),M=d.terrain.getMinMaxElevation(T);w=(g=M.minElevation)!==null&&g!==void 0?g:Math.min(0,l),S=(_=M.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}if(w/=c.bu,S/=c.bu,w+=1,S+=1,e.z<=0)return il.fromAabb([-S,-S,-S],[S,S,S]);if(e.z===1)return il.fromAabb([e.x===0?-S:0,e.y===0?0:-S,-S],[e.x===0?0:S,e.y===0?S:0,S]);{const T=[Ea(0,0,e.x,e.y,e.z),Ea(c.$,0,e.x,e.y,e.z),Ea(c.$,c.$,e.x,e.y,e.z),Ea(0,c.$,e.x,e.y,e.z)],M=[];for(const Ee of T)M.push(c.aR([],Ee,S));if(S!==w)for(const Ee of T)M.push(c.aR([],Ee,w));e.y===0&&M.push([0,1,0]),e.y===(1<<e.z)-1&&M.push([0,-1,0]);const I=[1,1,1],z=[-1,-1,-1];for(const Ee of M)for(let ke=0;ke<3;ke++)I[ke]=Math.min(I[ke],Ee[ke]),z[ke]=Math.max(z[ke],Ee[ke]);const B=Ea(c.$/2,c.$/2,e.x,e.y,e.z),W=c.aW([],[0,1,0],B);c.aV(W,W);const Y=c.aW([],B,W);c.aV(Y,Y);const K=c.aW([],T[2],T[1]);c.aV(K,K);const J=c.aW([],T[0],T[3]);c.aV(J,J),M.push(c.aR([],B,S)),e.y>=(1<<e.z)/2&&M.push(c.aR([],Ea(c.$/2,0,e.x,e.y,e.z),S)),e.y<(1<<e.z)/2&&M.push(c.aR([],Ea(c.$/2,c.$,e.x,e.y,e.z),S));const re=ys(B,M),se=ys(Y,M),ie=[-B[0],-B[1],-B[2],re.max],ce=[B[0],B[1],B[2],-re.min],pe=[-Y[0],-Y[1],-Y[2],se.max],ae=[Y[0],Y[1],Y[2],-se.min],_e=[...K,0],Le=[...J,0],Te=[];return e.y===0?Te.push(c.bt(Le,_e,ie),c.bt(Le,_e,ce)):Te.push(c.bt(pe,_e,ie),c.bt(pe,_e,ce),c.bt(pe,Le,ie),c.bt(pe,Le,ce)),e.y===(1<<e.z)-1?Te.push(c.bt(Le,_e,ie),c.bt(Le,_e,ce)):Te.push(c.bt(ae,_e,ie),c.bt(ae,_e,ce),c.bt(ae,Le,ie),c.bt(ae,Le,ce)),new il(Te,[ie,ce,pe,ae,_e,Le],I,z)}}}function ys(f,e){let a=1/0,l=-1/0;for(const d of e){const g=c.aX(f,d);a=Math.min(a,g),l=Math.max(l,g)}return{min:a,max:l}}class Xl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._coveringTilesDetailsProvider=new eo}clone(){const e=new Xl;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:l}=e,d=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,l=this.cameraToCenterDistance/e,d=Math.sin(a)*l,g=Math.cos(a)*l+1,_=1/Math.sqrt(d*d+g*g)*1;let w=-d,S=g;const T=Math.sqrt(w*w+S*S);w/=T,S/=T;const M=[0,w,S];c.bw(M,M,[0,0,0],-this.bearingInRadians),c.bx(M,M,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(M,M,[0,0,0],this.center.lng*Math.PI/180);const I=1/c.aZ(M);return c.aR(M,M,I),[...M,-_*I]}isLocationOccluded(e){return!this.isSurfacePointVisible(Qr(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,d=Math.cos(l),g=[Math.sin(a)*d,Math.sin(l),Math.cos(a)*d],_=[g[2],0,-g[0]],w=[0,0,0];c.aW(w,_,g),c.aV(_,_),c.aV(w,w);const S=[0,0,0];return c.aV(S,[_[0]*e[0]+w[0]*e[1]+g[0]*e[2],_[1]*e[0]+w[1]*e[1]+g[1]*e[2],_[2]*e[0]+w[2]*e[1]+g[2]*e[2]]),S}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,l){const d=(function(w,S,T){const M=1/(1<<T.z);return new c.a1(w/c.$*M+T.x*M,S/c.$*M+T.y*M)})(e,a,l.canonical),g=(_=d.y,[c.bo(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI]);var _;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,a,l,d){const g=l.canonical,_=Ea(e,a,g.x,g.y,g.z),w=1+(d?d(e,a):0)/c.bu,S=[_[0]*w,_[1]*w,_[2]*w,1];c.aw(S,S,this._globeViewProjMatrixNoCorrection);const T=this._cachedClippingPlane,M=T[0]*_[0]+T[1]*_[1]+T[2]*_[2]+T[3]<0;return{point:new c.P(S[0]/S[3],S[1]/S[3]),signedDistanceFromCamera:S[3],isOccluded:M}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=rl(this.worldSize,this.center.lat),a=c.ba(),l=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b4(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;a[8]=2*-d.x/this._helper._width,a[9]=2*d.y/this._helper._height,this._projectionMatrix=c.b5(a),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,a),c.M(a,a,[0,0,-this.cameraToCenterDistance]),c.b6(a,a,this.rollInRadians),c.b7(a,a,-this.pitchInRadians),c.b6(a,a,this.bearingInRadians),c.M(a,a,[0,0,-e]);const g=c.bp();g[0]=e,g[1]=e,g[2]=e,c.b7(l,a,this.center.lat*Math.PI/180),c.bz(l,l,-this.center.lng*Math.PI/180),c.N(l,l,g),this._globeViewProjMatrixNoCorrection=l,c.b7(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(a,a,-this.center.lng*Math.PI/180),c.N(a,a,g),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,l);const _=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bw(this._cameraPosition,this._cameraPosition,_,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,_,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,_,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,_,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,_,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const w=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(w,w,[1,1,-1]),this._cachedFrustum=Mr.fromInvProjectionMatrix(w,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const a=c.ba();return c.ag(a),a}getVisibleUnwrappedCoordinates(e){return[new c.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Qr(e);c.aR(l,l,1+a/c.bu);const d=c.bv();return c.aw(d,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,a),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,a)],d=[];for(const I of l)d.push(this.unprojectScreenPoint(I));let g=0,_=0,w=0,S=0;const T=this.center;for(const I of d){const z=c.bA(T.lng,I.lng),B=c.bA(T.lat,I.lat);z<_&&(_=z),z>g&&(g=z),B<S&&(S=B),B>w&&(w=B)}const M=[T.lng+_,T.lat+S,T.lng+g,T.lat+w];return this.isSurfacePointOnScreen([0,1,0])&&(M[3]=90,M[0]=-180,M[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(M[1]=-90,M[0]=-180,M[2]=180),new qt(M)}getConstrained(e,a){const l=c.ah(e.lat,-c.ai,c.ai),d=c.ah(+a,this.minZoom+wr(0,l),this.maxZoom);return{center:new c.S(e.lng,l),zoom:d}}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}setLocationAtPoint(e,a){const l=Qr(this.unprojectScreenPoint(a)),d=Qr(e),g=c.bp();c.bB(g);const _=c.bp();c.by(_,l,g,-this.center.lng*Math.PI/180),c.bx(_,_,g,this.center.lat*Math.PI/180);const w=d[0]*d[0]+d[2]*d[2],S=_[0]*_[0];if(w<S)return;const T=Math.sqrt(w-S),M=-T,I=c.bC(d[0],d[2],_[0],T),z=c.bC(d[0],d[2],_[0],M),B=c.bp();c.by(B,d,g,-I);const W=c.bC(B[1],B[2],_[1],_[2]),Y=c.bp();c.by(Y,d,g,-z);const K=c.bC(Y[1],Y[2],_[1],_[2]),J=.5*Math.PI,re=W>=-J&&W<=J,se=K>=-J&&K<=J;let ie,ce;if(re&&se){const Le=this.center.lng*Math.PI/180,Te=this.center.lat*Math.PI/180;c.bD(I,Le)+c.bD(W,Te)<c.bD(z,Le)+c.bD(K,Te)?(ie=I,ce=W):(ie=z,ce=K)}else if(re)ie=I,ce=W;else{if(!se)return;ie=z,ce=K}const pe=ie/Math.PI*180,ae=ce/Math.PI*180,_e=this.center.lat;this.setCenter(new c.S(pe,c.ah(ae,-90,90))),this.setZoom(this.zoom+wr(_e,this.center.lat))}locationToScreenPoint(e,a){const l=Qr(e);if(a){const d=a.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aR(l,l,1+d/c.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new c.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l)return l}return c.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,a){const l=this._cameraPosition,d=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,d)}getRayDirectionFromPixel(e){const a=c.bv();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,c.aw(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=c.bp();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const d=c.bp();return c.aV(d,l),d}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const l=c.aX(e,a),d=c.bp(),g=c.bp();c.aR(g,a,l),c.aU(d,e,g);const _=1-c.aX(d,d);if(_<0)return null;const w=c.aX(e,e)-1,S=-l+(l<0?1:-1)*Math.sqrt(_),T=w/S,M=S;return{tMin:Math.min(T,M),tMax:Math.max(T,M)}}unprojectScreenPoint(e){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(e),d=this.rayPlanetIntersection(a,l);if(d){const M=c.bp();c.aS(M,a,[l[0]*d.tMin,l[1]*d.tMin,l[2]*d.tMin]);const I=c.bp();return c.aV(I,M),ms(I)}const g=this._cachedClippingPlane,_=g[0]*l[0]+g[1]*l[1]+g[2]*l[2],w=-c.b1(g,a)/_,S=c.bp();if(w>0)c.aS(S,a,[l[0]*w,l[1]*w,l[2]*w]);else{const M=c.bp();c.aS(M,a,[2*l[0],2*l[1],2*l[2]]);const I=c.b1(this._cachedClippingPlane,M);c.aU(S,M,[this._cachedClippingPlane[0]*I,this._cachedClippingPlane[1]*I,this._cachedClippingPlane[2]*I])}const T=(function(M){const I=c.bp();return I[0]=M[0]*-M[3],I[1]=M[1]*-M[3],I[2]=M[2]*-M[3],{center:I,radius:Math.sqrt(1-M[3]*M[3])}})(g);return ms((function(M,I,z){const B=c.bp();c.aU(B,z,M);const W=c.bp();return c.bq(W,M,B,I/c.a$(B)),W})(T.center,T.radius,S))}getMatrixForModel(e,a){const l=c.S.convert(e),d=1/c.bu,g=c.b9();return c.bz(g,g,l.lng/180*Math.PI),c.b7(g,g,-l.lat/180*Math.PI),c.M(g,g,[0,0,1+a/c.bu]),c.b7(g,g,.5*Math.PI),c.N(g,g,[d,d,d]),g}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class Yl{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._globeness=1,this._mercatorTransform=new Rn,this._verticalPerspectiveTransform=new Xl}clone(){const e=new Yl;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,l){const d=this._mercatorTransform.getPitchedTextCorrection(e,a,l),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,l);return c.bk(d,g,this._globeness)}projectTileCoordinates(e,a,l,d){return this.currentTransform.projectTileCoordinates(e,a,l,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,a){return this.currentTransform.getConstrained(e,a)}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class vi{get useGlobeControls(){return!0}handlePanInertia(e,a){const l=Oh(e,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const l=e.around,d=a.screenPointToLocation(l);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const g=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const _=a.zoom-g;if(_===0)return;const w=c.bA(a.center.lng,d.lng),S=w/(Math.abs(w/180)+1),T=c.bA(a.center.lat,d.lat),M=a.getRayDirectionFromPixel(l),I=a.cameraPosition,z=-1*c.aX(I,M),B=c.bp();c.aS(B,I,[M[0]*z,M[1]*z,M[2]*z]);const W=c.aZ(B)-1,Y=Math.exp(.5*-Math.max(W-.3,0)),K=rl(a.worldSize,a.center.lat)/Math.min(a.width,a.height),J=c.bn(K,.9,.5,1,.25),re=(1-c.af(-_))*Math.min(Y,J),se=a.center.lat,ie=a.zoom,ce=new c.S(a.center.lng+S*re,c.ah(a.center.lat+T*re,-c.ai,c.ai));a.setLocationAtPoint(d,l);const pe=a.center,ae=c.bn(Math.abs(w),45,85,0,1),_e=c.bn(K,.75,.35,0,1),Le=Math.pow(Math.max(ae,_e),.25),Te=c.bA(pe.lng,ce.lng),Ee=c.bA(pe.lat,ce.lat);a.setCenter(new c.S(pe.lng+Te*Le,pe.lat+Ee*Le).wrap()),a.setZoom(ie+wr(se,a.center.lat))}handleMapControlsPan(e,a,l){if(!e.panDelta)return;const d=a.center.lat,g=a.zoom;a.setCenter(Oh(e.panDelta,a).wrap()),a.setZoom(g+wr(d,a.center.lat))}cameraForBoxAndBearing(e,a,l,d,g){const _=hi(e,a,l,d,g),w=a.left/g.width*2-1,S=(g.width-a.right)/g.width*2-1,T=a.top/g.height*-2+1,M=(g.height-a.bottom)/g.height*-2+1,I=c.bA(l.getWest(),l.getEast())<0,z=I?l.getEast():l.getWest(),B=I?l.getWest():l.getEast(),W=Math.max(l.getNorth(),l.getSouth()),Y=Math.min(l.getNorth(),l.getSouth()),K=z+.5*c.bA(z,B),J=W+.5*c.bA(W,Y),re=g.clone();re.setCenter(_.center),re.setBearing(_.bearing),re.setPitch(0),re.setRoll(0),re.setZoom(_.zoom);const se=re.modelViewProjectionMatrix,ie=[Qr(l.getNorthWest()),Qr(l.getNorthEast()),Qr(l.getSouthWest()),Qr(l.getSouthEast()),Qr(new c.S(B,J)),Qr(new c.S(z,J)),Qr(new c.S(K,W)),Qr(new c.S(K,Y))],ce=Qr(_.center);let pe=Number.POSITIVE_INFINITY;for(const ae of ie)w<0&&(pe=vi.getLesserNonNegativeNonNull(pe,vi.solveVectorScale(ae,ce,se,"x",w))),S>0&&(pe=vi.getLesserNonNegativeNonNull(pe,vi.solveVectorScale(ae,ce,se,"x",S))),T>0&&(pe=vi.getLesserNonNegativeNonNull(pe,vi.solveVectorScale(ae,ce,se,"y",T))),M<0&&(pe=vi.getLesserNonNegativeNonNull(pe,vi.solveVectorScale(ae,ce,se,"y",M)));if(Number.isFinite(pe)&&pe!==0)return _.zoom=re.zoom+c.ak(pe),_;Qa()}handleJumpToCenterZoom(e,a){const l=e.center.lat,d=e.getConstrained(a.center?c.S.convert(a.center):e.center,e.zoom).center;e.setCenter(d.wrap());const g=a.zoom!==void 0?+a.zoom:e.zoom+wr(l,d.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,a){const l=e.zoom,d=e.center,g=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},w={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},S=a.zoom!==void 0,T=!e.isPaddingEqual(a.padding);let M=!1;const I=a.center?c.S.convert(a.center):d,z=e.getConstrained(I,l).center;nl(e,z);const B=e.clone();B.setCenter(z),B.setZoom(S?+a.zoom:l+wr(d.lat,I.lat)),B.setBearing(a.bearing);const W=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));B.setLocationAtPoint(z,W);const Y=(a.offset&&a.offsetAsPoint.mag())>0?B.center:z,K=S?+a.zoom:l+wr(d.lat,Y.lat),J=l+wr(d.lat,0),re=K+wr(Y.lat,0),se=c.bA(d.lng,Y.lng),ie=c.bA(d.lat,Y.lat),ce=c.af(re-J);return M=K!==l,{easeFunc:pe=>{if(c.be(_,w)||ci({startEulerAngles:_,endEulerAngles:w,tr:e,k:pe,useSlerp:_.roll!=w.roll}),T&&e.interpolatePadding(g,a.padding,pe),a.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const ae=re>J?Math.min(2,ce):Math.max(.5,ce),_e=Math.pow(ae,1-pe),Le=Mc(d,se,ie,pe*_e);e.setCenter(Le.wrap())}if(M){const ae=c.C.number(J,re,pe)+wr(0,e.center.lat);e.setZoom(ae)}},isZooming:M,elevationCenter:Y}}handleFlyTo(e,a){const l=a.zoom!==void 0,d=e.center,g=e.zoom,_=e.padding,w=!e.isPaddingEqual(a.padding),S=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),g).center,T=l?+a.zoom:e.zoom+wr(e.center.lat,S.lat),M=e.clone();M.setCenter(S),M.setZoom(T),M.setBearing(a.bearing);const I=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));M.setLocationAtPoint(S,I);const z=M.center;nl(e,z);const B=(function(ie,ce,pe){const ae=Qr(ce),_e=Qr(pe),Le=c.aX(ae,_e),Te=Math.acos(Le),Ee=ql(ie);return Te/(2*Math.PI)*Ee})(e,d,z),W=g+wr(d.lat,0),Y=T+wr(z.lat,0),K=c.af(Y-W);let J;if(typeof a.minZoom=="number"){const ie=+a.minZoom+wr(z.lat,0),ce=Math.min(ie,W,Y)+wr(0,z.lat),pe=e.getConstrained(z,ce).zoom+wr(z.lat,0);J=c.af(pe-W)}const re=c.bA(d.lng,z.lng),se=c.bA(d.lat,z.lat);return{easeFunc:(ie,ce,pe,ae)=>{const _e=Mc(d,re,se,pe);w&&e.interpolatePadding(_,a.padding,ie);const Le=ie===1?z:_e;e.setCenter(Le.wrap());const Te=W+c.ak(ce);e.setZoom(ie===1?T:Te+wr(0,Le.lat))},scaleOfZoom:K,targetCenter:z,scaleOfMinZoom:J,pixelPathLength:B}}static solveVectorScale(e,a,l,d,g){const _=d==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],w=[l[3],l[7],l[11],l[15]],S=e[0]*_[0]+e[1]*_[1]+e[2]*_[2],T=e[0]*w[0]+e[1]*w[1]+e[2]*w[2],M=a[0]*_[0]+a[1]*_[1]+a[2]*_[2],I=a[0]*w[0]+a[1]*w[1]+a[2]*w[2];return M+g*T===S+g*I||w[3]*(S-M)+_[3]*(I-T)+S*I==M*T?null:(M+_[3]-g*I-g*w[3])/(M-S-g*I+g*T)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class Rc{constructor(e){this._globe=e,this._mercatorCameraHelper=new vr,this._verticalPerspectiveCameraHelper=new vi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,l){this.currentHelper.handleMapControlsPan(e,a,l)}cameraForBoxAndBearing(e,a,l,d,g){return this.currentHelper.cameraForBoxAndBearing(e,a,l,d,g)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const Bu=(f,e)=>c.y(f,e&&e.filter((a=>a.identifier!=="source.canvas"))),Sd=c.bE();class Dc extends c.E{constructor(e,a={}){var l,d;super(),this._rtlPluginLoaded=()=>{for(const _ in this.sourceCaches){const w=this.sourceCaches[_].getSource().type;w!=="vector"&&w!=="geojson"||this.sourceCaches[_].reload()}},this.map=e,this.dispatcher=new Dt(Kt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((_,w)=>this.getGlyphs(_,w))),this.dispatcher.registerMessageHandler("GI",((_,w)=>this.getImages(_,w))),this.imageManager=new Gt,this.imageManager.setEventedParent(this);const g=((l=e._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((d=document.documentElement)===null||d===void 0?void 0:d.lang)||void 0;this.glyphManager=new jn(e._requestManager,a.localIdeographFontFamily,g),this.lineAtlas=new At(256,512),this.crossTileSymbolIndex=new hs,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),gr().on(Za,this._rtlPluginLoaded),this.on("data",(_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const w=this.sourceCaches[_.sourceId];if(!w)return;const S=w.getSource();if(S&&S.vectorLayerIds)for(const T in this._layers){const M=this._layers[T];M.source===S.id&&this._validateLayer(M)}}))}setGlobalStateProperty(e,a){var l,d,g;this._checkLoaded();const _=a===null?(g=(d=(l=this.stylesheet.state)===null||l===void 0?void 0:l[e])===null||d===void 0?void 0:d.default)!==null&&g!==void 0?g:null:a;if(c.bH(_,this._globalState[e]))return this;this._globalState[e]=_,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const l in e)!c.bH(this._globalState[l],e[l].default)&&(a.push(l),this._globalState[l]=e[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set,l={};for(const d of e){l[d]=this._globalState[d];for(const g in this._layers){const _=this._layers[g],w=_.getLayoutAffectingGlobalStateRefs(),S=_.getPaintAffectingGlobalStateRefs();if(w.has(d)&&a.add(_.source),S.has(d))for(const{name:T,value:M}of S.get(d))this._updatePaintProperty(_,T,M)}}this.dispatcher.broadcast("UGS",l);for(const d in this.sourceCaches)a.has(d)&&(this._reloadSource(d),this._changed=!0)}loadURL(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.j(d,this._loadStyleRequest).then((_=>{this._loadStyleRequest=null,this._load(_.data,a,l)})).catch((_=>{this._loadStyleRequest=null,_&&!g.signal.aborted&&this.fire(new c.k(_))}))}loadJSON(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,Ce.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Sd,{validate:!1})}_load(e,a,l){var d,g;let _=a.transformStyle?a.transformStyle(l,e):e;if(!a.validate||!Bu(this,c.z(_))){_=Object.assign({},_),this._loaded=!0,this.stylesheet=_;for(const w in _.sources)this.addSource(w,_.sources[w],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new Ue(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new tt(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e;const a=c.bI(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",a),this._order=a.map((l=>l.id)),this._layers={},this._serializedLayers=null;for(const l of a){const d=c.bJ(l,this._globalState);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(e,a=!1,l=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(g,_,w,S){return c._(this,void 0,void 0,(function*(){const T=Tt(g),M=w>1?"@2x":"",I={},z={};for(const{id:B,url:W}of T){const Y=_.transformRequest(It(W,M,".json"),"SpriteJSON");I[B]=c.j(Y,S);const K=_.transformRequest(It(W,M,".png"),"SpriteImage");z[B]=wt.getImage(K,S)}return yield Promise.all([...Object.values(I),...Object.values(z)]),(function(B,W){return c._(this,void 0,void 0,(function*(){const Y={};for(const K in B){Y[K]={};const J=Ce.getImageCanvasContext((yield W[K]).data),re=(yield B[K]).data;for(const se in re){const{width:ie,height:ce,x:pe,y:ae,sdf:_e,pixelRatio:Le,stretchX:Te,stretchY:Ee,content:ke,textFitWidth:ct,textFitHeight:st}=re[se];Y[K][se]={data:null,pixelRatio:Le,sdf:_e,stretchX:Te,stretchY:Ee,content:ke,textFitWidth:ct,textFitHeight:st,spriteData:{width:ie,height:ce,x:pe,y:ae,context:J}}}}return Y}))})(I,z)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((g=>{if(this._spriteRequest=null,g)for(const _ in g){this._spritesImagesIds[_]=[];const w=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter((S=>!(S in g))):[];for(const S of w)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in g[_]){const T=_==="default"?S:`${_}:${S}`;this._spritesImagesIds[_].push(T),T in this.imageManager.images?this.imageManager.updateImage(T,g[_][S],!1):this.imageManager.addImage(T,g[_][S]),a&&(this._changedImages[T]=!0)}}})).catch((g=>{this._spriteRequest=null,d=g,this.fire(new c.k(d))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(d)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.sourceCaches[e.source];if(!a)return;const l=e.sourceLayer;if(!l)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${d.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?c.bK(l):l);const d=[];for(const g of e)if(l[g]){const _=a?c.bK(l[g]):l[g];d.push(_)}return d}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const d=this._layers[l];d.type!=="custom"&&(e[l]=d.serialize())}return e}hasTransitions(){var e,a,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(d.length||g.length)&&this._updateWorkerLayers(d,g);for(const _ in this._updatedSources){const w=this._updatedSources[_];if(w==="reload")this._reloadSource(_);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const d in this.sourceCaches){const g=this.sourceCaches[d];l[d]=g.used,g.used=!1}for(const d of this._order){const g=this._layers[d];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const d in l){const g=this.sourceCaches[d];!!l[d]!=!!g.used&&g.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var l;this._checkLoaded();const d=this.serialize();if(e=a.transformStyle?a.transformStyle(d,e):e,((l=a.validate)===null||l===void 0||l)&&Bu(this,c.z(e)))return!1;(e=c.bK(e)).layers=c.bI(e.layers);const g=c.bL(d,e),_=this._getOperationsToPerform(g);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const w of _.operations)w();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],l=[];for(const d of e)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,d.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,d.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,d.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,d.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,d.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,d.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,d.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,d.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,d.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,d.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,d.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,d.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,d.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,d.args)));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,d.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(d.command)}return{operations:a,unimplemented:l}}addImage(e,a){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.z.source,`sources.${e}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[e]=new hn(e,a,this.dispatcher);d.style=this,d.setEventedParent(this,(()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:e}))),d.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,l={}){this._checkLoaded();const d=e.id;if(this.getLayer(d))return void this.fire(new c.k(new Error(`Layer "${d}" already exists on this map.`)));let g;if(e.type==="custom"){if(Bu(this,c.bM(e)))return;g=c.bJ(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(d,e.source),e=c.bK(e),e=c.e(e,{source:d})),this._validate(c.z.layer,`layers.${d}`,e,{arrayIndex:-1},l))return;g=c.bJ(e,this._globalState),this._validateLayer(g),g.setEventedParent(this,{layer:{id:d}})}const _=a?this._order.indexOf(a):this._order.length;if(a&&_===-1)this.fire(new c.k(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(_,0,d),this._layerOrderChanged=!0,this._layers[d]=g,this._removedLayers[d]&&g.source&&g.type!=="custom"){const w=this._removedLayers[d];delete this._removedLayers[d],w.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const l=this._order.indexOf(e);this._order.splice(l,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(d,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,l){this._checkLoaded();const d=this.getLayer(e);d?d.minzoom===a&&d.maxzoom===l||(a!=null&&(d.minzoom=a),l!=null&&(d.maxzoom=l),this._updateLayer(d)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,l={}){this._checkLoaded();const d=this.getLayer(e);if(d){if(!c.bH(d.filter,a))return a==null?(d.setFilter(void 0),void this._updateLayer(d)):void(this._validate(c.z.filter,`layers.${d.id}.filter`,a,null,l)||(d.setFilter(c.bK(a)),this._updateLayer(d)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bK(this.getLayer(e).filter)}setLayoutProperty(e,a,l,d={}){this._checkLoaded();const g=this.getLayer(e);g?c.bH(g.getLayoutProperty(a),l)||(g.setLayoutProperty(a,l,d),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const l=this.getLayer(e);if(l)return l.getLayoutProperty(a);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,l,d={}){this._checkLoaded();const g=this.getLayer(e);g?c.bH(g.getPaintProperty(a),l)||this._updatePaintProperty(g,a,l,d):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,l,d={}){e.setPaintProperty(a,l,d)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const l=e.source,d=e.sourceLayer,g=this.sourceCaches[l];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const _=g.getSource().type;_==="geojson"&&d?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||d?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(d,e.id,a)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const l=e.source,d=this.sourceCaches[l];if(d===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const g=d.getSource().type,_=g==="vector"?e.sourceLayer:void 0;g!=="vector"||_?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(_,e.id,a):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,l=e.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),d.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bN(this.sourceCaches,(g=>g.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,d=this.stylesheet;return c.bO({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:e,layers:a,terrain:l},(g=>g!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=_=>this._layers[_].type==="fill-extrusion",l={},d=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(a(w)){l[w]=_;for(const S of e){const T=S[w];if(T)for(const M of T)d.push(M)}}}d.sort(((_,w)=>w.intersectionZ-_.intersectionZ));const g=[];for(let _=this._order.length-1;_>=0;_--){const w=this._order[_];if(a(w))for(let S=d.length-1;S>=0;S--){const T=d[S].feature;if(l[T.layer.id]<_)break;g.push(T),d.pop()}else for(const S of e){const T=S[w];if(T)for(const M of T)g.push(M.feature)}}return g}queryRenderedFeatures(e,a,l){a&&a.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const T of a.layers){const M=this._layers[T];if(!M)return this.fire(new c.k(new Error(`The layer '${T}' does not exist in the map's style and cannot be queried for features.`))),[];d[M.source]=!0}}const g=[];a.availableImages=this._availableImages;const _=this._serializedAllLayers(),w=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,S=Object.assign(Object.assign({},a),{layers:w,globalState:this._globalState});for(const T in this.sourceCaches)a.layers&&!d[T]||g.push(En(this.sourceCaches[T],this._layers,_,e,S,l,this.map.terrain?(M,I,z)=>this.map.terrain.getElevation(M,I,z):void 0));return this.placement&&g.push((function(T,M,I,z,B,W,Y){const K={},J=W.queryRenderedSymbols(z),re=[];for(const se of Object.keys(J).map(Number))re.push(Y[se]);re.sort(tr);for(const se of re){const ie=se.featureIndex.lookupSymbolFeatures(J[se.bucketInstanceId],M,se.bucketIndex,se.sourceLayerIndex,{filterSpec:B.filter,globalState:B.globalState},B.layers,B.availableImages,T);for(const ce in ie){const pe=K[ce]=K[ce]||[],ae=ie[ce];ae.sort(((_e,Le)=>{const Te=se.featureSortOrder;if(Te){const Ee=Te.indexOf(_e.featureIndex);return Te.indexOf(Le.featureIndex)-Ee}return Le.featureIndex-_e.featureIndex}));for(const _e of ae)pe.push(_e)}}return(function(se,ie,ce){for(const pe in se)for(const ae of se[pe])xn(ae,ce[ie[pe].source]);return se})(K,T,I)})(this._layers,_,this.sourceCaches,e,S,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,a){a?.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.sourceCaches[e];return l?(function(d,g){const _=d.getRenderableIds().map((T=>d.getTileByID(T))),w=[],S={};for(let T=0;T<_.length;T++){const M=_[T],I=M.tileID.canonical.key;S[I]||(S[I]=!0,M.querySourceFeatures(w,g))}return w})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const l=this.light.getLight();let d=!1;for(const _ in e)if(!c.bH(e[_],l[_])){d=!0;break}if(!d)return;const g={now:Ce.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const l=this.getSky();let d=!1;if(!e&&!l)return;if(e&&!l)d=!0;else if(!e&&l)d=!0;else for(const _ in e)if(!c.bH(e[_],l[_])){d=!0;break}if(!d)return;const g={now:Ce.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(g)}_setProjectionInternal(e){const a=(function(l){if(Array.isArray(l)){const d=new ps({type:l});return{projection:d,transform:new Yl,cameraHelper:new Rc(d)}}switch(l){case"mercator":return{projection:new cn,transform:new Rn,cameraHelper:new vr};case"globe":{const d=new ps({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:d,transform:new Yl,cameraHelper:new Rc(d)}}case"vertical-perspective":return{projection:new fs,transform:new Xl,cameraHelper:new vi};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new cn,transform:new Rn,cameraHelper:new vr}}})(e);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,a,l,d,g={}){return(!g||g.validate!==!1)&&Bu(this,e.call(c.z,c.e({key:a,style:this.serialize(),value:l,styleSpec:c.v},d)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),gr().off(Za,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const l=this.sourceCaches[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,l,d,g=!1){let _=!1,w=!1;const S={};for(const T of this._order){const M=this._layers[T];if(M.type!=="symbol")continue;if(!S[M.source]){const z=this.sourceCaches[M.source];S[M.source]=z.getRenderableIds(!0).map((B=>z.getTileByID(B))).sort(((B,W)=>W.tileID.overscaledZ-B.tileID.overscaledZ||(B.tileID.isLessThan(W.tileID)?-1:1)))}const I=this.crossTileSymbolIndex.addLayer(M,S[M.source],e.center.lng);_=_||I}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ce.now(),e.zoom))&&(this.pauseablePlacement=new Wl(e,this.map.terrain,this._order,g,a,l,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ce.now()),w=!0),_&&this.pauseablePlacement.placement.setStale()),w||_)for(const T of this._order){const M=this._layers[T];M.type==="symbol"&&this.placement.updateLayerOpacities(M,S[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ce.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,a,l={},d){this._checkLoaded();const g=[{id:e,url:a}],_=[...Tt(this.stylesheet.sprite),...g];this._validate(c.z.sprite,"sprite",_,null,l)||(this.stylesheet.sprite=_,this._loadSprite(g,!0,d))}removeSprite(e){this._checkLoaded();const a=Tt(this.stylesheet.sprite);if(a.find((l=>l.id===e))){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===e)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Tt(this.stylesheet.sprite)}setSprite(e,a={},l){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Pd=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Cd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,l,d,g,_,w,S,T){this.context=e;let M=this.boundPaintVertexBuffers.length!==d.length;for(let I=0;!M&&I<d.length;I++)this.boundPaintVertexBuffers[I]!==d[I]&&(M=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||M||this.boundIndexBuffer!==g||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==T?this.freshBind(a,l,d,g,_,w,S,T):(e.bindVertexArray.set(this.vao),w&&w.bind(),g&&g.dynamicDraw&&g.bind(),S&&S.bind(),T&&T.bind())}freshBind(e,a,l,d,g,_,w,S){const T=e.numAttributes,M=this.context,I=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=S,a.enableAttributes(I,e);for(const z of l)z.enableAttributes(I,e);_&&_.enableAttributes(I,e),w&&w.enableAttributes(I,e),S&&S.enableAttributes(I,e),a.bind(),a.setVertexAttribPointers(I,e,g);for(const z of l)z.bind(),z.setVertexAttribPointers(I,e,g);_&&(_.bind(),_.setVertexAttribPointers(I,e,g)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(I,e,g)),S&&(S.bind(),S.setVertexAttribPointers(I,e,g)),M.currentNumAttributes=T}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Fu=(f,e,a,l,d)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),zc={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function _s(f){const e=[];for(let a=0;a<f.length;a++){if(f[a]===null)continue;const l=f[a].split(" ");e.push(l.pop())}return e}class Ic{constructor(e,a,l,d,g,_,w,S,T=[]){const M=e.gl;this.program=M.createProgram();const I=_s(a.staticAttributes),z=l?l.getBinderAttributes():[],B=I.concat(z),W=Aa.prelude.staticUniforms?_s(Aa.prelude.staticUniforms):[],Y=w.staticUniforms?_s(w.staticUniforms):[],K=a.staticUniforms?_s(a.staticUniforms):[],J=l?l.getBinderUniforms():[],re=W.concat(Y).concat(K).concat(J),se=[];for(const Te of re)se.indexOf(Te)<0&&se.push(Te);const ie=l?l.defines():[];_i(M)&&ie.unshift("#version 300 es"),g&&ie.push("#define OVERDRAW_INSPECTOR;"),_&&ie.push("#define TERRAIN3D;"),S&&ie.push(S),T&&ie.push(...T);let ce=ie.concat(Aa.prelude.fragmentSource,w.fragmentSource,a.fragmentSource).join(`
`),pe=ie.concat(Aa.prelude.vertexSource,w.vertexSource,a.vertexSource).join(`
`);_i(M)||(ce=(function(Te){return Te.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ce),pe=(function(Te){return Te.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(pe));const ae=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(ae,ce),M.compileShader(ae),!M.getShaderParameter(ae,M.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${M.getShaderInfoLog(ae)}`);M.attachShader(this.program,ae);const _e=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);if(M.shaderSource(_e,pe),M.compileShader(_e),!M.getShaderParameter(_e,M.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${M.getShaderInfoLog(_e)}`);M.attachShader(this.program,_e),this.attributes={};const Le={};this.numAttributes=B.length;for(let Te=0;Te<this.numAttributes;Te++)B[Te]&&(M.bindAttribLocation(this.program,Te,B[Te]),this.attributes[B[Te]]=Te);if(M.linkProgram(this.program),!M.getProgramParameter(this.program,M.LINK_STATUS))throw new Error(`Program failed to link: ${M.getProgramInfoLog(this.program)}`);M.deleteShader(_e),M.deleteShader(ae);for(let Te=0;Te<se.length;Te++){const Ee=se[Te];if(Ee&&!Le[Ee]){const ke=M.getUniformLocation(this.program,Ee);ke&&(Le[Ee]=ke)}}this.fixedUniforms=d(e,Le),this.terrainUniforms=((Te,Ee)=>({u_depth:new c.bP(Te,Ee.u_depth),u_terrain:new c.bP(Te,Ee.u_terrain),u_terrain_dim:new c.bg(Te,Ee.u_terrain_dim),u_terrain_matrix:new c.bR(Te,Ee.u_terrain_matrix),u_terrain_unpack:new c.bS(Te,Ee.u_terrain_unpack),u_terrain_exaggeration:new c.bg(Te,Ee.u_terrain_exaggeration)}))(e,Le),this.projectionUniforms=((Te,Ee)=>({u_projection_matrix:new c.bR(Te,Ee.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(Te,Ee.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(Te,Ee.u_projection_clipping_plane),u_projection_transition:new c.bg(Te,Ee.u_projection_transition),u_projection_fallback_matrix:new c.bR(Te,Ee.u_projection_fallback_matrix)}))(e,Le),this.binderUniforms=l?l.getUniforms(e,Le):[]}draw(e,a,l,d,g,_,w,S,T,M,I,z,B,W,Y,K,J,re,se){const ie=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(d),e.setColorMode(g),e.setCullFace(_),S){e.activeTexture.set(ie.TEXTURE2),ie.bindTexture(ie.TEXTURE_2D,S.depthTexture),e.activeTexture.set(ie.TEXTURE3),ie.bindTexture(ie.TEXTURE_2D,S.texture);for(const pe in this.terrainUniforms)this.terrainUniforms[pe].set(S[pe])}if(T)for(const pe in T)this.projectionUniforms[zc[pe]].set(T[pe]);if(w)for(const pe in this.fixedUniforms)this.fixedUniforms[pe].set(w[pe]);K&&K.setUniforms(e,this.binderUniforms,W,{zoom:Y});let ce=0;switch(a){case ie.LINES:ce=2;break;case ie.TRIANGLES:ce=3;break;case ie.LINE_STRIP:ce=1}for(const pe of B.get()){const ae=pe.vaos||(pe.vaos={});(ae[M]||(ae[M]=new Cd)).bind(e,this,I,K?K.getPaintVertexBuffers():[],z,pe.vertexOffset,J,re,se),ie.drawElements(a,pe.primitiveLength*ce,ie.UNSIGNED_SHORT,pe.primitiveOffset*ce*2)}}}function al(f,e,a){const l=1/c.aC(a,1,e.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,e.transform.tileZoom)/d,_=g*(a.tileID.canonical.x+a.tileID.wrap*d),w=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[_>>16,w>>16],u_pixel_coord_lower:[65535&_,65535&w]}}const Ri=(f,e,a,l)=>{const d=f.style.light,g=d.properties.get("position"),_=[g.x,g.y,g.z],w=c.bV();d.properties.get("anchor")==="viewport"&&c.bW(w,f.transform.bearingInRadians),c.bX(_,_,w);const S=f.transform.transformLightDirection(_),T=d.properties.get("color");return{u_lightpos:_,u_lightpos_globe:S,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:l}},Td=(f,e,a,l,d,g,_)=>c.e(Ri(f,e,a,l),al(g,f,_),{u_height_factor:-Math.pow(2,d.overscaledZ)/_.tileSize/8}),Kl=(f,e,a,l)=>c.e(al(e,f,a),{u_fill_translate:l}),ol=(f,e)=>({u_world:f,u_fill_translate:e}),sl=(f,e,a,l,d)=>c.e(Kl(f,e,a,d),{u_world:l}),Fh=(f,e,a,l,d)=>{const g=f.transform;let _,w,S=0;if(a.paint.get("circle-pitch-alignment")==="map"){const T=c.aC(e,1,g.zoom);_=!0,w=[T,T],S=T/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*d}else _=!1,w=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+_,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:w,u_globe_extrude_scale:S,u_translate:l}},Ql=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),ll=f=>({u_viewport_size:[f.width,f.height]}),vs=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),Nh=(f,e,a,l)=>{const d=c.aC(f,1,e)/(c.$*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aC(f,1,e),u_intensity:a,u_globe_extrude_scale:d}},Lc=(f,e,a,l)=>{const d=c.L();c.bY(d,0,f.width,f.height,0,0,1);const g=f.context.gl;return{u_matrix:d,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},Uh=(f,e,a)=>{const l=a.paint.get("hillshade-accent-color");let d;switch(a.paint.get("hillshade-method")){case"basic":d=4;break;case"combined":d=1;break;case"igor":d=2;break;case"multidirectional":d=3;break;default:d=0}const g=a.getIlluminationProperties();for(let _=0;_<g.directionRadians.length;_++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(g.directionRadians[_]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:xs(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:g.altitudeRadians,u_azimuths:g.directionRadians,u_accent:l,u_method:d,u_highlights:g.highlightColor,u_shadows:g.shadowColor}},kc=(f,e)=>{const a=e.stride,l=c.L();return c.bY(l,0,c.$,-c.$,0,0,1),c.M(l,l,[0,-c.$,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function xs(f,e){const a=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.a1(0,l/a).toLngLat().lat,new c.a1(0,(l+1)/a).toLngLat().lat]}const ul=(f,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:f.paint.get("color-relief-opacity")}),Nu=(f,e,a,l)=>{const d=f.transform;return{u_translation:tu(f,e,a),u_ratio:l/c.aC(e,1,d.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Jl=(f,e,a,l,d)=>c.e(Nu(f,e,a,l),{u_image:0,u_image_height:d}),Oc=(f,e,a,l,d)=>{const g=f.transform,_=eu(e,g);return{u_translation:tu(f,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.aC(e,1,g.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[_,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Wo=(f,e,a,l,d,g)=>{const _=f.lineAtlas,w=eu(e,f.transform),S=a.layout.get("line-cap")==="round",T=_.getDash(d.from,S),M=_.getDash(d.to,S),I=T.width*g.fromScale,z=M.width*g.toScale;return c.e(Nu(f,e,a,l),{u_patternscale_a:[w/I,-T.height/2],u_patternscale_b:[w/z,-M.height/2],u_sdfgamma:_.width/(256*Math.min(I,z)*f.pixelRatio)/2,u_image:0,u_tex_y_a:T.y,u_tex_y_b:M.y,u_mix:g.t})};function eu(f,e){return 1/c.aC(f,1,e.tileZoom)}function tu(f,e,a){return c.aD(f.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const cl=(f,e,a,l,d)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(g=l.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:jh(l.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var g,_};function jh(f){f*=Math.PI/180;const e=Math.sin(f),a=Math.cos(f);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const hl=(f,e,a,l,d,g,_,w,S,T,M,I,z)=>{const B=_.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:B.cameraToCenterDistance,u_pitch:B.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:B.width/B.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+M,u_pitch_with_map:+l,u_is_along_line:d,u_is_variable_anchor:g,u_texsize:I,u_texture:0,u_translation:T,u_pitched_scale:z}},Vh=(f,e,a,l,d,g,_,w,S,T,M,I,z,B)=>{const W=_.transform;return c.e(hl(f,e,a,l,d,g,_,w,S,T,M,I,B),{u_gamma_scale:l?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:1})},Ad=(f,e,a,l,d,g,_,w,S,T,M,I,z)=>c.e(Vh(f,e,a,l,d,g,_,w,S,T,!0,M,0,z),{u_texsize_icon:I,u_texture_icon:1}),Gh=(f,e)=>({u_opacity:f,u_color:e}),Wh=(f,e,a,l,d)=>c.e((function(g,_,w,S){const T=w.imageManager.getPattern(g.from.toString()),M=w.imageManager.getPattern(g.to.toString()),{width:I,height:z}=w.imageManager.getPixelSize(),B=Math.pow(2,S.tileID.overscaledZ),W=S.tileSize*Math.pow(2,w.transform.tileZoom)/B,Y=W*(S.tileID.canonical.x+S.tileID.wrap*B),K=W*S.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:T.tl,u_pattern_br_a:T.br,u_pattern_tl_b:M.tl,u_pattern_br_b:M.br,u_texsize:[I,z],u_mix:_.t,u_pattern_size_a:T.displaySize,u_pattern_size_b:M.displaySize,u_scale_a:_.fromScale,u_scale_b:_.toScale,u_tile_units_to_pixels:1/c.aC(S,1,w.transform.tileZoom),u_pixel_coord_upper:[Y>>16,K>>16],u_pixel_coord_lower:[65535&Y,65535&K]}})(a,d,e,l),{u_opacity:f}),Bc=(f,e)=>{},Di={fillExtrusion:(f,e)=>({u_lightpos:new c.bT(f,e.u_lightpos),u_lightpos_globe:new c.bT(f,e.u_lightpos_globe),u_lightintensity:new c.bg(f,e.u_lightintensity),u_lightcolor:new c.bT(f,e.u_lightcolor),u_vertical_gradient:new c.bg(f,e.u_vertical_gradient),u_opacity:new c.bg(f,e.u_opacity),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new c.bT(f,e.u_lightpos),u_lightpos_globe:new c.bT(f,e.u_lightpos_globe),u_lightintensity:new c.bg(f,e.u_lightintensity),u_lightcolor:new c.bT(f,e.u_lightcolor),u_vertical_gradient:new c.bg(f,e.u_vertical_gradient),u_height_factor:new c.bg(f,e.u_height_factor),u_opacity:new c.bg(f,e.u_opacity),u_fill_translate:new c.bU(f,e.u_fill_translate),u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new c.bU(f,e.u_world),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new c.bU(f,e.u_world),u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade),u_fill_translate:new c.bU(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_scale_with_map:new c.bP(f,e.u_scale_with_map),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_extrude_scale:new c.bU(f,e.u_extrude_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(f,e.u_globe_extrude_scale),u_translate:new c.bU(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new c.bU(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new c.bU(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new c.bQ(f,e.u_color),u_overlay:new c.bP(f,e.u_overlay),u_overlay_scale:new c.bg(f,e.u_overlay_scale)}),depth:Bc,clippingMask:Bc,heatmap:(f,e)=>({u_extrude_scale:new c.bg(f,e.u_extrude_scale),u_intensity:new c.bg(f,e.u_intensity),u_globe_extrude_scale:new c.bg(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new c.bR(f,e.u_matrix),u_world:new c.bU(f,e.u_world),u_image:new c.bP(f,e.u_image),u_color_ramp:new c.bP(f,e.u_color_ramp),u_opacity:new c.bg(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new c.bP(f,e.u_image),u_latrange:new c.bU(f,e.u_latrange),u_exaggeration:new c.bg(f,e.u_exaggeration),u_altitudes:new c.b_(f,e.u_altitudes),u_azimuths:new c.b_(f,e.u_azimuths),u_accent:new c.bQ(f,e.u_accent),u_method:new c.bP(f,e.u_method),u_shadows:new c.bZ(f,e.u_shadows),u_highlights:new c.bZ(f,e.u_highlights)}),hillshadePrepare:(f,e)=>({u_matrix:new c.bR(f,e.u_matrix),u_image:new c.bP(f,e.u_image),u_dimension:new c.bU(f,e.u_dimension),u_zoom:new c.bg(f,e.u_zoom),u_unpack:new c.bS(f,e.u_unpack)}),colorRelief:(f,e)=>({u_image:new c.bP(f,e.u_image),u_unpack:new c.bS(f,e.u_unpack),u_dimension:new c.bU(f,e.u_dimension),u_elevation_stops:new c.bP(f,e.u_elevation_stops),u_color_stops:new c.bP(f,e.u_color_stops),u_color_ramp_size:new c.bP(f,e.u_color_ramp_size),u_opacity:new c.bg(f,e.u_opacity)}),line:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_image:new c.bP(f,e.u_image),u_image_height:new c.bg(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_texsize:new c.bU(f,e.u_texsize),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_image:new c.bP(f,e.u_image),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_patternscale_a:new c.bU(f,e.u_patternscale_a),u_patternscale_b:new c.bU(f,e.u_patternscale_b),u_sdfgamma:new c.bg(f,e.u_sdfgamma),u_image:new c.bP(f,e.u_image),u_tex_y_a:new c.bg(f,e.u_tex_y_a),u_tex_y_b:new c.bg(f,e.u_tex_y_b),u_mix:new c.bg(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new c.bU(f,e.u_tl_parent),u_scale_parent:new c.bg(f,e.u_scale_parent),u_buffer_scale:new c.bg(f,e.u_buffer_scale),u_fade_t:new c.bg(f,e.u_fade_t),u_opacity:new c.bg(f,e.u_opacity),u_image0:new c.bP(f,e.u_image0),u_image1:new c.bP(f,e.u_image1),u_brightness_low:new c.bg(f,e.u_brightness_low),u_brightness_high:new c.bg(f,e.u_brightness_high),u_saturation_factor:new c.bg(f,e.u_saturation_factor),u_contrast_factor:new c.bg(f,e.u_contrast_factor),u_spin_weights:new c.bT(f,e.u_spin_weights),u_coords_top:new c.bS(f,e.u_coords_top),u_coords_bottom:new c.bS(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texture:new c.bP(f,e.u_texture),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texture:new c.bP(f,e.u_texture),u_gamma_scale:new c.bg(f,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_is_halo:new c.bP(f,e.u_is_halo),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texsize_icon:new c.bU(f,e.u_texsize_icon),u_texture:new c.bP(f,e.u_texture),u_texture_icon:new c.bP(f,e.u_texture_icon),u_gamma_scale:new c.bg(f,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_is_halo:new c.bP(f,e.u_is_halo),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new c.bg(f,e.u_opacity),u_color:new c.bQ(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new c.bg(f,e.u_opacity),u_image:new c.bP(f,e.u_image),u_pattern_tl_a:new c.bU(f,e.u_pattern_tl_a),u_pattern_br_a:new c.bU(f,e.u_pattern_br_a),u_pattern_tl_b:new c.bU(f,e.u_pattern_tl_b),u_pattern_br_b:new c.bU(f,e.u_pattern_br_b),u_texsize:new c.bU(f,e.u_texsize),u_mix:new c.bg(f,e.u_mix),u_pattern_size_a:new c.bU(f,e.u_pattern_size_a),u_pattern_size_b:new c.bU(f,e.u_pattern_size_b),u_scale_a:new c.bg(f,e.u_scale_a),u_scale_b:new c.bg(f,e.u_scale_b),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new c.bP(f,e.u_texture),u_ele_delta:new c.bg(f,e.u_ele_delta),u_fog_matrix:new c.bR(f,e.u_fog_matrix),u_fog_color:new c.bQ(f,e.u_fog_color),u_fog_ground_blend:new c.bg(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(f,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(f,e.u_horizon_color),u_horizon_fog_blend:new c.bg(f,e.u_horizon_fog_blend),u_is_globe_mode:new c.bg(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new c.bg(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new c.bP(f,e.u_texture),u_terrain_coords_id:new c.bg(f,e.u_terrain_coords_id),u_ele_delta:new c.bg(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new c.bg(f,e.u_input),u_output_expected:new c.bg(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new c.bT(f,e.u_sun_pos),u_atmosphere_blend:new c.bg(f,e.u_atmosphere_blend),u_globe_position:new c.bT(f,e.u_globe_position),u_globe_radius:new c.bg(f,e.u_globe_radius),u_inv_proj_matrix:new c.bR(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new c.bQ(f,e.u_sky_color),u_horizon_color:new c.bQ(f,e.u_horizon_color),u_horizon:new c.bU(f,e.u_horizon),u_horizon_normal:new c.bU(f,e.u_horizon_normal),u_sky_horizon_blend:new c.bg(f,e.u_sky_horizon_blend),u_sky_blend:new c.bg(f,e.u_sky_blend)})};class dl{constructor(e,a,l){this.context=e;const d=e.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const nu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class to{constructor(e,a,l,d){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=e;const g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let l=0;l<this.attributes.length;l++){const d=a.attributes[this.attributes[l].name];d!==void 0&&e.enableVertexAttribArray(d)}}setVertexAttribPointers(e,a,l){for(let d=0;d<this.attributes.length;d++){const g=this.attributes[d],_=a.attributes[g.name];_!==void 0&&e.vertexAttribPointer(_,g.components,e[nu[g.type]],!1,this.itemSize,g.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Sn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Uu extends Sn{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ru extends Sn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Zh extends Sn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Zo extends Sn{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class _o extends Sn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class bs extends Sn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Fc extends Sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class qh extends Sn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class ws extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class fl extends Sn{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class ju extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class Hh extends Sn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class qo extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class iu extends Sn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class au extends Sn{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ou extends Sn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Nc extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class Ss extends Sn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class su extends Sn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Ps extends Sn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class aa extends Sn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Vu extends Sn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class va extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Gu extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Jr extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class zi extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class vo extends Sn{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Cs extends Sn{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const l=this.gl;_i(l)?l.bindVertexArray(e):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Ts extends Sn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class lu extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class Ho extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class oa extends Sn{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class Uc extends oa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class pl extends oa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class sn extends oa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const uu="Framebuffer is not complete";class sa{constructor(e,a,l,d,g){this.context=e,this.width=a,this.height=l;const _=e.gl,w=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new Uc(e,w),d)this.depthAttachment=g?new sn(e,w):new pl(e,w);else if(g)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error(uu)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Wu{constructor(e){var a,l;if(this.gl=e,this.clearColor=new Uu(this),this.clearDepth=new ru(this),this.clearStencil=new Zh(this),this.colorMask=new Zo(this),this.depthMask=new _o(this),this.stencilMask=new bs(this),this.stencilFunc=new Fc(this),this.stencilOp=new qh(this),this.stencilTest=new ws(this),this.depthRange=new fl(this),this.depthTest=new ju(this),this.depthFunc=new Hh(this),this.blend=new qo(this),this.blendFunc=new iu(this),this.blendColor=new au(this),this.blendEquation=new ou(this),this.cullFace=new Nc(this),this.cullFaceSide=new Ss(this),this.frontFace=new su(this),this.program=new Ps(this),this.activeTexture=new aa(this),this.viewport=new Vu(this),this.bindFramebuffer=new va(this),this.bindRenderbuffer=new Gu(this),this.bindTexture=new Jr(this),this.bindVertexBuffer=new zi(this),this.bindElementBuffer=new vo(this),this.bindVertexArray=new Cs(this),this.pixelStoreUnpack=new Ts(this),this.pixelStoreUnpackPremultiplyAlpha=new lu(this),this.pixelStoreUnpackFlipY=new Ho(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),_i(e)){this.HALF_FLOAT=e.HALF_FLOAT;const d=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:d?.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:d?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const d=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=d?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new dl(this,e,a)}createVertexBuffer(e,a,l){return new to(this,e,a,l)}createRenderbuffer(e,a,l){const d=this.gl,g=d.createRenderbuffer();return this.bindRenderbuffer.set(g),d.renderbufferStorage(d.RENDERBUFFER,e,a,l),this.bindRenderbuffer.set(null),g}createFramebuffer(e,a,l,d){return new sa(this,e,a,l,d)}clear({color:e,depth:a,stencil:l}){const d=this.gl;let g=0;e&&(g|=d.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(g|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),d.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bH(e.blendFunction,Gn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return _i(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return _i(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let xi;function jc(f,e,a,l,d){const g=f.context,_=f.transform,w=g.gl,S=f.useProgram("collisionBox"),T=[];let M=0,I=0;for(let J=0;J<l.length;J++){const re=l[J],se=e.getTile(re).getBucket(a);if(!se)continue;const ie=d?se.textCollisionBox:se.iconCollisionBox,ce=se.collisionCircleArray;ce.length>0&&(T.push({circleArray:ce,circleOffset:I,coord:re}),M+=ce.length/4,I=M),ie&&S.draw(g,w.LINES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Ft.disabled,Ql(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),_.getProjectionData({overscaledTileID:re,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,null,f.transform.zoom,null,null,ie.collisionVertexBuffer)}if(!d||!T.length)return;const z=f.useProgram("collisionCircle"),B=new c.b$;B.resize(4*M),B._trim();let W=0;for(const J of T)for(let re=0;re<J.circleArray.length/4;re++){const se=4*re,ie=J.circleArray[se+0],ce=J.circleArray[se+1],pe=J.circleArray[se+2],ae=J.circleArray[se+3];B.emplace(W++,ie,ce,pe,ae,0),B.emplace(W++,ie,ce,pe,ae,1),B.emplace(W++,ie,ce,pe,ae,2),B.emplace(W++,ie,ce,pe,ae,3)}(!xi||xi.length<2*M)&&(xi=(function(J){const re=2*J,se=new c.c1;se.resize(re),se._trim();for(let ie=0;ie<re;ie++){const ce=6*ie;se.uint16[ce+0]=4*ie+0,se.uint16[ce+1]=4*ie+1,se.uint16[ce+2]=4*ie+2,se.uint16[ce+3]=4*ie+2,se.uint16[ce+4]=4*ie+3,se.uint16[ce+5]=4*ie+0}return se})(M));const Y=g.createIndexBuffer(xi,!0),K=g.createVertexBuffer(B,c.c0.members,!0);for(const J of T){const re=ll(f.transform);z.draw(g,w.TRIANGLES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Ft.disabled,re,f.style.map.terrain&&f.style.map.terrain.getTerrainData(J.coord),null,a.id,K,Y,c.aM.simpleSegment(0,2*J.circleOffset,J.circleArray.length,J.circleArray.length/2),null,f.transform.zoom,null,null,null)}K.destroy(),Y.destroy()}const Zu=c.ag(new Float32Array(16));function $o(f,e,a,l,d,g){const{horizontalAlign:_,verticalAlign:w}=c.aH(f);return new c.P((-(_-.5)*e/d+l[0])*g,(-(w-.5)*a/d+l[1])*g)}function Vc(f,e,a,l,d,g){const _=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let w=l.mult(g);a||(w=w.rotate(-d));const S=_.add(w);return lr(S.x,S.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const w=Er(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),S=Math.atan(w.y/w.x)+(w.x<0?Math.PI:0);return f.add(l.rotate(S))}return f.add(l)}function cu(f,e,a,l,d,g,_,w,S,T,M,I){const z=f.text.placedSymbolArray,B=f.text.dynamicLayoutVertexArray,W=f.icon.dynamicLayoutVertexArray,Y={};B.clear();for(let K=0;K<z.length;K++){const J=z.get(K),re=J.hidden||!J.crossTileID||f.allowVerticalPlacement&&!J.placedOrientation?null:l[J.crossTileID];if(re){const se=new c.P(J.anchorX,J.anchorY),ie={getElevation:I,width:d.width,height:d.height,pitchedLabelPlaneMatrix:g,pitchWithMap:a,transform:d,tileAnchorPoint:se,translation:T,unwrappedTileID:M},ce=a?ur(se.x,se.y,ie):Er(se.x,se.y,ie),pe=it(d.cameraToCenterDistance,ce.signedDistanceFromCamera);let ae=c.ap(f.textSizeData,w,J)*pe/c.aB;a&&(ae*=f.tilePixelRatio/_);const{width:_e,height:Le,anchor:Te,textOffset:Ee,textBoxScale:ke}=re,ct=$o(Te,_e,Le,Ee,ke,ae),st=d.getPitchedTextCorrection(se.x+T[0],se.y+T[1],M),$e=Vc(ce.point,ie,e,ct,-d.bearingInRadians,st),Pt=f.allowVerticalPlacement&&J.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let ln=0;ln<J.numGlyphs;ln++)c.av(B,$e,Pt);S&&J.associatedIconIndex>=0&&(Y[J.associatedIconIndex]={shiftedAnchor:$e,angle:Pt})}else Ha(J.numGlyphs,B)}if(S){W.clear();const K=f.icon.placedSymbolArray;for(let J=0;J<K.length;J++){const re=K.get(J);if(re.hidden)Ha(re.numGlyphs,W);else{const se=Y[J];if(se)for(let ie=0;ie<re.numGlyphs;ie++)c.av(W,se.shiftedAnchor,se.angle);else Ha(re.numGlyphs,W)}}f.icon.dynamicLayoutVertexBuffer.updateData(W)}f.text.dynamicLayoutVertexBuffer.updateData(B)}function xo(f,e,a){return a.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function no(f,e,a,l,d,g,_,w,S,T,M,I,z){const B=f.context,W=B.gl,Y=f.transform,K=w==="map",J=S==="map",re=w!=="viewport"&&a.layout.get("symbol-placement")!=="point",se=K&&!J&&!re,ie=!a.layout.get("symbol-sort-key").isConstant();let ce=!1;const pe=f.getDepthModeForSublayer(0,Xt.ReadOnly),ae=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),_e=[],Le=Y.getCircleRadiusCorrection();for(const Te of l){const Ee=e.getTile(Te),ke=Ee.getBucket(a);if(!ke)continue;const ct=d?ke.text:ke.icon;if(!ct||!ct.segments.get().length||!ct.hasVisibleVertices)continue;const st=ct.programConfigurations.get(a.id),$e=d||ke.sdfIcons,Pt=d?ke.textSizeData:ke.iconSizeData,ln=J||Y.pitch!==0,Pn=f.useProgram(xo($e,d,ke),st),ar=c.an(Pt,Y.zoom),Fn=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Te);let Nn,$n,Wn,Un,vn=[0,0],jr=null;if(d)$n=Ee.glyphAtlasTexture,Wn=W.LINEAR,Nn=Ee.glyphAtlasTexture.size,ke.iconsInText&&(vn=Ee.imageAtlasTexture.size,jr=Ee.imageAtlasTexture,Un=ln||f.options.rotating||f.options.zooming||Pt.kind==="composite"||Pt.kind==="camera"?W.LINEAR:W.NEAREST);else{const Dn=a.layout.get("icon-size").constantOr(0)!==1||ke.iconsNeedLinear;$n=Ee.imageAtlasTexture,Wn=$e||f.options.rotating||f.options.zooming||Dn||ln?W.LINEAR:W.NEAREST,Nn=Ee.imageAtlasTexture.size}const zr=c.aC(Ee,1,f.transform.zoom),Ni=Vn(K,f.transform,zr),rs=c.L();c.aq(rs,Ni);const Mo=Nt(J,K,f.transform,zr),Ui=c.aD(Y,Ee,g,_),Ro=Y.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!z,applyTerrainMatrix:!0}),is=ae&&ke.hasTextData(),_u=a.layout.get("icon-text-fit")!=="none"&&is&&ke.hasIconData();if(re){const Dn=f.style.map.terrain?(wi,xr)=>f.style.map.terrain.getElevation(Te,wi,xr):null,hr=a.layout.get("text-rotation-alignment")==="map";yr(ke,f,d,Ni,rs,J,T,hr,Te.toUnwrapped(),Y.width,Y.height,Ui,Dn)}const Do=d&&ae||_u,ni=re||Do?Zu:J?Ni:f.transform.clipSpaceToPixelsMatrix,ao=$e&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let oo;oo=$e?ke.iconsInText?Ad(Pt.kind,ar,se,J,re,Do,f,ni,Mo,Ui,Nn,vn,Le):Vh(Pt.kind,ar,se,J,re,Do,f,ni,Mo,Ui,d,Nn,0,Le):hl(Pt.kind,ar,se,J,re,Do,f,ni,Mo,Ui,d,Nn,Le);const as={program:Pn,buffers:ct,uniformValues:oo,projectionData:Ro,atlasTexture:$n,atlasTextureIcon:jr,atlasInterpolation:Wn,atlasInterpolationIcon:Un,isSDF:$e,hasHalo:ao};if(ie&&ke.canOverlap){ce=!0;const Dn=ct.segments.get();for(const hr of Dn)_e.push({segments:new c.aM([hr]),sortKey:hr.sortKey,state:as,terrainData:Fn})}else _e.push({segments:ct.segments,sortKey:0,state:as,terrainData:Fn})}ce&&_e.sort(((Te,Ee)=>Te.sortKey-Ee.sortKey));for(const Te of _e){const Ee=Te.state;if(B.activeTexture.set(W.TEXTURE0),Ee.atlasTexture.bind(Ee.atlasInterpolation,W.CLAMP_TO_EDGE),Ee.atlasTextureIcon&&(B.activeTexture.set(W.TEXTURE1),Ee.atlasTextureIcon&&Ee.atlasTextureIcon.bind(Ee.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),Ee.isSDF){const ke=Ee.uniformValues;Ee.hasHalo&&(ke.u_is_halo=1,Xo(Ee.buffers,Te.segments,a,f,Ee.program,pe,M,I,ke,Ee.projectionData,Te.terrainData)),ke.u_is_halo=0}Xo(Ee.buffers,Te.segments,a,f,Ee.program,pe,M,I,Ee.uniformValues,Ee.projectionData,Te.terrainData)}}function Xo(f,e,a,l,d,g,_,w,S,T,M){const I=l.context;d.draw(I,I.gl.TRIANGLES,g,_,w,Ft.backCCW,S,M,T,a.id,f.layoutVertexBuffer,f.indexBuffer,e,a.paint,l.transform.zoom,f.programConfigurations.get(a.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function ml(f,e,a,l,d){const g=f.context,_=g.gl,w=_n.disabled,S=new Gn([_.ONE,_.ONE],c.bf.transparent,[!0,!0,!0,!0]),T=e.getBucket(a);if(!T)return;const M=l.key;let I=a.heatmapFbos.get(M);I||(I=bi(g,e.tileSize,e.tileSize),a.heatmapFbos.set(M,I)),g.bindFramebuffer.set(I.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:c.bf.transparent});const z=T.programConfigurations.get(a.id),B=f.useProgram("heatmap",z,!d),W=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Y=f.style.map.terrain.getTerrainData(l);B.draw(g,_.TRIANGLES,Xt.disabled,w,S,Ft.disabled,Nh(e,f.transform.zoom,a.paint.get("heatmap-intensity"),1),Y,W,a.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,a.paint,f.transform.zoom,z)}function la(f,e,a,l,d){const g=f.context,_=g.gl,w=f.transform;g.setColorMode(f.colorModeForRenderPass());const S=Ma(g,e),T=a.key,M=e.heatmapFbos.get(T);if(!M)return;g.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,M.colorAttachment.get()),g.activeTexture.set(_.TEXTURE1),S.bind(_.LINEAR,_.CLAMP_TO_EDGE);const I=w.getProjectionData({overscaledTileID:a,applyTerrainMatrix:d,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(g,_.TRIANGLES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Ft.disabled,Lc(f,e,0,1),null,I,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,w.zoom),M.destroy(),e.heatmapFbos.delete(T)}function bi(f,e,a){var l,d;const g=f.gl,_=g.createTexture();g.bindTexture(g.TEXTURE_2D,_),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);const w=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:g.UNSIGNED_BYTE,S=(d=f.RGBA16F)!==null&&d!==void 0?d:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,S,e,a,0,g.RGBA,w,null);const T=f.createFramebuffer(e,a,!1,!1);return T.colorAttachment.set(_),T}function Ma(f,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function ua(f,e,a,l,d){if(!a||!l||!l.imageAtlas)return;const g=l.imageAtlas.patternPositions;let _=g[a.to.toString()],w=g[a.from.toString()];if(!_&&w&&(_=w),!w&&_&&(w=_),!_||!w){const S=d.getPaintProperty(e);_=g[S],w=g[S]}_&&w&&f.setConstantPatternPositions(_,w)}function Ii(f,e,a,l,d,g,_,w){const S=f.context.gl,T="fill-pattern",M=a.paint.get(T),I=M&&M.constantOr(1),z=a.getCrossfadeParameters();let B,W,Y,K,J;const re=f.transform,se=a.paint.get("fill-translate"),ie=a.paint.get("fill-translate-anchor");_?(W=I&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=S.LINES):(W=I?"fillPattern":"fill",B=S.TRIANGLES);const ce=M.constantOr(null);for(const pe of l){const ae=e.getTile(pe);if(I&&!ae.patternsLoaded())continue;const _e=ae.getBucket(a);if(!_e)continue;const Le=_e.programConfigurations.get(a.id),Te=f.useProgram(W,Le),Ee=f.style.map.terrain&&f.style.map.terrain.getTerrainData(pe);I&&(f.context.activeTexture.set(S.TEXTURE0),ae.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Le.updatePaintBuffers(z)),ua(Le,T,ce,ae,a);const ke=re.getProjectionData({overscaledTileID:pe,applyGlobeMatrix:!w,applyTerrainMatrix:!0}),ct=c.aD(re,ae,se,ie);if(_){K=_e.indexBuffer2,J=_e.segments2;const $e=[S.drawingBufferWidth,S.drawingBufferHeight];Y=W==="fillOutlinePattern"&&I?sl(f,z,ae,$e,ct):ol($e,ct)}else K=_e.indexBuffer,J=_e.segments,Y=I?Kl(f,z,ae,ct):{u_fill_translate:ct};const st=f.stencilModeForClipping(pe);Te.draw(f.context,B,d,st,g,Ft.backCCW,Y,Ee,ke,a.id,_e.layoutVertexBuffer,K,J,a.paint,f.transform.zoom,Le)}}function Ra(f,e,a,l,d,g,_,w){const S=f.context,T=S.gl,M="fill-extrusion-pattern",I=a.paint.get(M),z=I.constantOr(1),B=a.getCrossfadeParameters(),W=a.paint.get("fill-extrusion-opacity"),Y=I.constantOr(null),K=f.transform;for(const J of l){const re=e.getTile(J),se=re.getBucket(a);if(!se)continue;const ie=f.style.map.terrain&&f.style.map.terrain.getTerrainData(J),ce=se.programConfigurations.get(a.id),pe=f.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ce);z&&(f.context.activeTexture.set(T.TEXTURE0),re.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),ce.updatePaintBuffers(B));const ae=K.getProjectionData({overscaledTileID:J,applyGlobeMatrix:!w,applyTerrainMatrix:!0});ua(ce,M,Y,re,a);const _e=c.aD(K,re,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Le=a.paint.get("fill-extrusion-vertical-gradient"),Te=z?Td(f,Le,W,_e,J,B,re):Ri(f,Le,W,_e);pe.draw(S,S.gl.TRIANGLES,d,g,_,Ft.backCCW,Te,ie,ae,a.id,se.layoutVertexBuffer,se.indexBuffer,se.segments,a.paint,f.transform.zoom,ce,f.style.map.terrain&&se.centroidVertexBuffer)}}function qu(f,e,a,l,d,g,_,w,S){var T;const M=f.style.projection,I=f.context,z=f.transform,B=I.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],Y=f.useProgram("hillshade",null,!1,W),K=!f.options.moving;for(const J of l){const re=e.getTile(J),se=re.fbo;if(!se)continue;const ie=M.getMeshFromTileID(I,J.canonical,w,!0,"raster"),ce=(T=f.style.map.terrain)===null||T===void 0?void 0:T.getTerrainData(J);I.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,se.colorAttachment.get());const pe=z.getProjectionData({overscaledTileID:J,aligned:K,applyGlobeMatrix:!S,applyTerrainMatrix:!0});Y.draw(I,B.TRIANGLES,g,d[J.overscaledZ],_,Ft.backCCW,Uh(f,re,a),ce,pe,a.id,ie.vertexBuffer,ie.indexBuffer,ie.segments)}}function bo(f,e,a,l,d,g,_,w,S){var T;const M=f.style.projection,I=f.context,z=f.transform,B=I.gl,W=f.useProgram("colorRelief"),Y=!f.options.moving;let K=!0,J=0;for(const re of l){const se=e.getTile(re),ie=se.dem;if(K){const Te=B.getParameter(B.MAX_TEXTURE_SIZE),{elevationTexture:Ee,colorTexture:ke}=a.getColorRampTextures(I,Te,ie.getUnpackVector());I.activeTexture.set(B.TEXTURE1),Ee.bind(B.NEAREST,B.CLAMP_TO_EDGE),I.activeTexture.set(B.TEXTURE4),ke.bind(B.LINEAR,B.CLAMP_TO_EDGE),K=!1,J=Ee.size[0]}if(!ie||!ie.data)continue;const ce=ie.stride,pe=ie.getPixels();if(I.activeTexture.set(B.TEXTURE0),I.pixelStoreUnpackPremultiplyAlpha.set(!1),se.demTexture=se.demTexture||f.getTileTexture(ce),se.demTexture){const Te=se.demTexture;Te.update(pe,{premultiply:!1}),Te.bind(B.LINEAR,B.CLAMP_TO_EDGE)}else se.demTexture=new c.T(I,pe,B.RGBA,{premultiply:!1}),se.demTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const ae=M.getMeshFromTileID(I,re.canonical,w,!0,"raster"),_e=(T=f.style.map.terrain)===null||T===void 0?void 0:T.getTerrainData(re),Le=z.getProjectionData({overscaledTileID:re,aligned:Y,applyGlobeMatrix:!S,applyTerrainMatrix:!0});W.draw(I,B.TRIANGLES,g,d[re.overscaledZ],_,Ft.backCCW,ul(a,se.dem,J),_e,Le,a.id,ae.vertexBuffer,ae.indexBuffer,ae.segments)}}const hu=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Wr(f,e,a,l,d,g,_,w,S=!1,T=!1){const M=l[l.length-1].overscaledZ,I=f.context,z=I.gl,B=f.useProgram("raster"),W=f.transform,Y=f.style.projection,K=f.colorModeForRenderPass(),J=!f.options.moving;for(const re of l){const se=f.getDepthModeForSublayer(re.overscaledZ-M,a.paint.get("raster-opacity")===1?Xt.ReadWrite:Xt.ReadOnly,z.LESS),ie=e.getTile(re);ie.registerFadeDuration(a.paint.get("raster-fade-duration"));const ce=e.findLoadedParent(re,0),pe=e.findLoadedSibling(re),ae=cr(ie,ce||pe||null,e,a,f.transform,f.style.map.terrain);let _e,Le;const Te=a.paint.get("raster-resampling")==="nearest"?z.NEAREST:z.LINEAR;I.activeTexture.set(z.TEXTURE0),ie.texture.bind(Te,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),I.activeTexture.set(z.TEXTURE1),ce?(ce.texture.bind(Te,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),_e=Math.pow(2,ce.tileID.overscaledZ-ie.tileID.overscaledZ),Le=[ie.tileID.canonical.x*_e%1,ie.tileID.canonical.y*_e%1]):ie.texture.bind(Te,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST),ie.texture.useMipmap&&I.extTextureFilterAnisotropic&&f.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const Ee=f.style.map.terrain&&f.style.map.terrain.getTerrainData(re),ke=W.getProjectionData({overscaledTileID:re,aligned:J,applyGlobeMatrix:!T,applyTerrainMatrix:!0}),ct=cl(Le||[0,0],_e||1,ae,a,w),st=Y.getMeshFromTileID(I,re.canonical,g,_,"raster");B.draw(I,z.TRIANGLES,se,d?d[re.overscaledZ]:_n.disabled,K,S?Ft.frontCCW:Ft.backCCW,ct,Ee,ke,a.id,st.vertexBuffer,st.indexBuffer,st.segments)}}function cr(f,e,a,l,d,g){const _=l.paint.get("raster-fade-duration");if(!g&&_>0){const w=Ce.now(),S=(w-f.timeAdded)/_,T=e?(w-e.timeAdded)/_:-1,M=a.getSource(),I=bt(d,{tileSize:M.tileSize,roundZoom:M.roundZoom}),z=!e||Math.abs(e.tileID.overscaledZ-I)>Math.abs(f.tileID.overscaledZ-I),B=z&&f.refreshedUponExpiration?1:c.ah(z?S:1-T,0,1);return f.refreshedUponExpiration&&S>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-B}:{opacity:B,mix:0}}return{opacity:1,mix:0}}const Mn=new c.bf(1,0,0,1),Yo=new c.bf(0,1,0,1),Da=new c.bf(0,0,1,1),gl=new c.bf(1,0,1,1),wo=new c.bf(0,1,1,1);function Gc(f,e,a,l){Bn(f,0,e+a/2,f.transform.width,a,l)}function Hu(f,e,a,l){Bn(f,e-a/2,0,a,f.transform.height,l)}function Bn(f,e,a,l,d,g){const _=f.context,w=_.gl;w.enable(w.SCISSOR_TEST),w.scissor(e*f.pixelRatio,a*f.pixelRatio,l*f.pixelRatio,d*f.pixelRatio),_.clear({color:g}),w.disable(w.SCISSOR_TEST)}function za(f,e,a){const l=f.context,d=l.gl,g=f.useProgram("debug"),_=Xt.disabled,w=_n.disabled,S=f.colorModeForRenderPass(),T="$debug",M=f.style.map.terrain&&f.style.map.terrain.getTerrainData(a);l.activeTexture.set(d.TEXTURE0);const I=e.getTileByID(a.key).latestRawTileData,z=Math.floor((I&&I.byteLength||0)/1024),B=e.getTile(a).tileSize,W=512/Math.min(B,512)*(a.overscaledZ/f.transform.zoom)*.5;let Y=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(Y+=` => ${a.overscaledZ}`),(function(J,re){J.initDebugOverlayCanvas();const se=J.debugOverlayCanvas,ie=J.context.gl,ce=J.debugOverlayCanvas.getContext("2d");ce.clearRect(0,0,se.width,se.height),ce.shadowColor="white",ce.shadowBlur=2,ce.lineWidth=1.5,ce.strokeStyle="white",ce.textBaseline="top",ce.font="bold 36px Open Sans, sans-serif",ce.fillText(re,5,5),ce.strokeText(re,5,5),J.debugOverlayTexture.update(se),J.debugOverlayTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE)})(f,`${Y} ${z}kB`);const K=f.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(l,d.TRIANGLES,_,w,Gn.alphaBlended,Ft.disabled,vs(c.bf.transparent,W),null,K,T,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),g.draw(l,d.LINE_STRIP,_,w,S,Ft.disabled,vs(c.bf.red),M,K,T,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function Xi(f,e,a,l){const{isRenderingGlobe:d}=l,g=f.context,_=g.gl,w=f.transform,S=f.colorModeForRenderPass(),T=f.getDepthModeFor3D(),M=f.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]);for(const I of a){const z=e.getTerrainMesh(I.tileID),B=f.renderToTexture.getTexture(I),W=e.getTerrainData(I.tileID);g.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,B.texture);const Y=e.getMeshFrameDelta(w.zoom),K=w.calculateFogMatrix(I.tileID.toUnwrapped()),J=Fu(Y,K,f.style.sky,w.pitch,d),re=w.getProjectionData({overscaledTileID:I.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});M.draw(g,_.TRIANGLES,T,_n.disabled,S,Ft.backCCW,J,W,re,"terrain",z.vertexBuffer,z.indexBuffer,z.segments)}}function Ko(f,e){if(!e.mesh){const a=new c.aL;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new c.aN;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new Uo(f.createVertexBuffer(a,Ka.members),f.createIndexBuffer(l),c.aM.simpleSegment(0,0,a.length,l.length))}return e.mesh}class yl{constructor(e,a){this.context=new Wu(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=hn.maxUnderzooming+hn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new hs}resize(e,a,l){if(this.width=Math.floor(e*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const e=this.context,a=new c.aL;a.emplaceBack(0,0),a.emplaceBack(c.$,0),a.emplaceBack(0,c.$),a.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(a,Ka.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const l=new c.aL;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(l,Ka.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const d=new c.c6;d.emplaceBack(0,0,0,0),d.emplaceBack(c.$,0,c.$,0),d.emplaceBack(0,c.$,0,c.$),d.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(d,Pd.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const g=new c.aL;g.emplaceBack(0,0),g.emplaceBack(c.$,0),g.emplaceBack(0,c.$),g.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,Ka.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(_,Ka.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const w=new c.c7;w.emplaceBack(0),w.emplaceBack(1),w.emplaceBack(3),w.emplaceBack(2),w.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(w);const S=new c.aN;S.emplaceBack(1,0,2),S.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(S);const T=this.context.gl;this.stencilClearMode=new _n({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO),this.tileExtentMesh=new Uo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.L();c.bY(l,0,this.width,this.height,0,0,1),c.N(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const d={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,Xt.disabled,this.stencilClearMode,Gn.disabled,Ft.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const d=this.context;d.setColorMode(Gn.disabled),d.setDepthMode(Xt.disabled);const g={};for(const _ of a)g[_.key]=this.nextStencilID++;this._renderTileMasks(g,a,l,!0),this._renderTileMasks(g,a,l,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,a,l,d){const g=this.context,_=g.gl,w=this.style.projection,S=this.transform,T=this.useProgram("clippingMask");for(const M of a){const I=e[M.key],z=this.style.map.terrain&&this.style.map.terrain.getTerrainData(M),B=w.getMeshFromTileID(this.context,M.canonical,d,!0,"stencil"),W=S.getProjectionData({overscaledTileID:M,applyGlobeMatrix:!l,applyTerrainMatrix:!0});T.draw(g,_.TRIANGLES,Xt.disabled,new _n({func:_.ALWAYS,mask:0},I,255,_.KEEP,_.KEEP,_.REPLACE),Gn.disabled,l?Ft.disabled:Ft.backCCW,null,z,W,"$clipping",B.vertexBuffer,B.indexBuffer,B.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,l=this.style.projection,d=this.transform,g=this.useProgram("depth"),_=this.getDepthModeFor3D(),w=xe(d,{tileSize:d.tileSize});for(const S of w){const T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(S),M=l.getMeshFromTileID(this.context,S.canonical,!0,!0,"raster"),I=d.getProjectionData({overscaledTileID:S,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,a.TRIANGLES,_,_n.disabled,Gn.disabled,Ft.backCCW,null,T,I,"$clipping",M.vertexBuffer,M.indexBuffer,M.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new _n({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new _n({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,l=e.sort(((_,w)=>w.overscaledZ-_.overscaledZ)),d=l[l.length-1].overscaledZ,g=l[0].overscaledZ-d+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const _={};for(let w=0;w<g;w++)_[w+d]=new _n({func:a.GEQUAL,mask:255},w+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[_,l]}return[{[d]:_n.disabled},l]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,l=e.sort(((_,w)=>w.overscaledZ-_.overscaledZ)),d=l[l.length-1].overscaledZ,g=l[0].overscaledZ-d+1;if(this.clearStencil(),g>1){const _={},w={};for(let S=0;S<g;S++)_[S+d]=new _n({func:a.GREATER,mask:255},g+1+S,255,a.KEEP,a.KEEP,a.REPLACE),w[S+d]=new _n({func:a.GREATER,mask:255},1+S,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*g+1,[_,w,l]}return this.nextStencilID=3,[{[d]:new _n({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[d]:new _n({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Gn([e.CONSTANT_COLOR,e.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Gn.unblended:Gn.alphaBlended}getDepthModeForSublayer(e,a,l){if(!this.opaquePassEnabledForLayer())return Xt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Xt(l||this.context.gl.LEQUAL,a,[d,d])}getDepthModeFor3D(){return new Xt(this.context.gl.LEQUAL,Xt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var l,d;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(Ce.now()),this.imageManager.beginFrame();const g=this.style._order,_=this.style.sourceCaches,w={},S={},T={},M={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const z in _){const B=_[z];B.used&&B.prepare(this.context),w[z]=B.getVisibleCoordinates(!1),S[z]=w[z].slice().reverse(),T[z]=B.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<g.length;z++)if(this.style._layers[g[z]].is3D()){this.opaquePassCutoff=z;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const z of g){const B=this.style._layers[z];if(!B.hasOffscreenPass()||B.isHidden(this.transform.zoom))continue;const W=S[B.source];(B.type==="custom"||W.length)&&this.renderLayer(this,_[B.source],B,W,M)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:z=>this.useProgram(z)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(z,B){const W=z.context,Y=W.gl,K=((pe,ae,_e)=>{const Le=Math.cos(ae.rollInRadians),Te=Math.sin(ae.rollInRadians),Ee=he(ae),ke=ae.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:pe.properties.get("sky-color"),u_horizon_color:pe.properties.get("horizon-color"),u_horizon:[(ae.width/2-Ee*Te)*_e,(ae.height/2+Ee*Le)*_e],u_horizon_normal:[-Te,Le],u_sky_horizon_blend:pe.properties.get("sky-horizon-blend")*ae.height/2*_e,u_sky_blend:ke}})(B,z.style.map.transform,z.pixelRatio),J=new Xt(Y.LEQUAL,Xt.ReadWrite,[0,1]),re=_n.disabled,se=z.colorModeForRenderPass(),ie=z.useProgram("sky"),ce=Ko(W,B);ie.draw(W,Y.TRIANGLES,J,re,se,Ft.disabled,K,null,void 0,"sky",ce.vertexBuffer,ce.indexBuffer,ce.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[g[this.currentLayer]],B=_[z.source],W=w[z.source];this._renderTileClippingMasks(z,W,!1),this.renderLayer(this,B,z,W,M)}this.renderPass="translucent";let I=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const z=this.style._layers[g[this.currentLayer]],B=_[z.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(z,M))continue;this.opaquePassEnabledForLayer()||I||(I=!0,M.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(z.type==="symbol"?T:S)[z.source];this._renderTileClippingMasks(z,w[z.source],!!this.renderToTexture),this.renderLayer(this,B,z,W,M)}if(M.isRenderingGlobe&&(function(z,B,W){const Y=z.context,K=Y.gl,J=z.useProgram("atmosphere"),re=new Xt(K.LEQUAL,Xt.ReadOnly,[0,1]),se=z.transform,ie=(function(ke,ct){const st=ke.properties.get("position"),$e=[-st.x,-st.y,-st.z],Pt=c.ag(new Float64Array(16));return ke.properties.get("anchor")==="map"&&(c.b6(Pt,Pt,ct.rollInRadians),c.b7(Pt,Pt,-ct.pitchInRadians),c.b6(Pt,Pt,ct.bearingInRadians),c.b7(Pt,Pt,ct.center.lat*Math.PI/180),c.bz(Pt,Pt,-ct.center.lng*Math.PI/180)),c.c5($e,$e,Pt),$e})(W,z.transform),ce=se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),pe=B.properties.get("atmosphere-blend")*ce.projectionTransition;if(pe===0)return;const ae=rl(se.worldSize,se.center.lat),_e=se.inverseProjectionMatrix,Le=new Float64Array(4);Le[3]=1,c.aw(Le,Le,se.modelViewProjectionMatrix),Le[0]/=Le[3],Le[1]/=Le[3],Le[2]/=Le[3],Le[3]=1,c.aw(Le,Le,_e),Le[0]/=Le[3],Le[1]/=Le[3],Le[2]/=Le[3],Le[3]=1;const Te=((ke,ct,st,$e,Pt)=>({u_sun_pos:ke,u_atmosphere_blend:ct,u_globe_position:st,u_globe_radius:$e,u_inv_proj_matrix:Pt}))(ie,pe,[Le[0],Le[1],Le[2]],ae,_e),Ee=Ko(Y,B);J.draw(Y,K.TRIANGLES,re,_n.disabled,Gn.alphaBlended,Ft.disabled,Te,null,null,"atmosphere",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const z=(function(B,W){let Y=null;const K=Object.values(B._layers).flatMap((ie=>ie.source&&!ie.isHidden(W)?[B.sourceCaches[ie.source]]:[])),J=K.filter((ie=>ie.getSource().type==="vector")),re=K.filter((ie=>ie.getSource().type!=="vector")),se=ie=>{(!Y||Y.getSource().maxzoom<ie.getSource().maxzoom)&&(Y=ie)};return J.forEach((ie=>se(ie))),Y||re.forEach((ie=>se(ie))),Y})(this.style,this.transform.zoom);z&&(function(B,W,Y){for(let K=0;K<Y.length;K++)za(B,W,Y[K])})(this,z,z.getVisibleCoordinates())}this.options.showPadding&&(function(z){const B=z.transform.padding;Gc(z,z.transform.height-(B.top||0),3,Mn),Gc(z,B.bottom||0,3,Yo),Hu(z,B.left||0,3,Da),Hu(z,z.transform.width-(B.right||0),3,gl);const W=z.transform.centerPoint;(function(Y,K,J,re){Bn(Y,K-1,J-10,2,20,re),Bn(Y,K-10,J-1,20,2,re)})(z,W.x,z.transform.height-W.y,wo)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=e?!c.c8(a,l):!c.c9(a,l)),d||(d=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(c.ca(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(g,_){const w=g.context,S=w.gl,T=g.transform,M=Gn.unblended,I=new Xt(S.LEQUAL,Xt.ReadWrite,[0,1]),z=_.sourceCache.getRenderableTiles(),B=g.useProgram("terrainDepth");w.bindFramebuffer.set(_.getFramebuffer("depth").framebuffer),w.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),w.clear({color:c.bf.transparent,depth:1});for(const W of z){const Y=_.getTerrainMesh(W.tileID),K=_.getTerrainData(W.tileID),J=T.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),re={u_ele_delta:_.getMeshFrameDelta(T.zoom)};B.draw(w,S.TRIANGLES,I,_n.disabled,M,Ft.backCCW,re,K,J,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}w.bindFramebuffer.set(null),w.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain),(function(g,_){const w=g.context,S=w.gl,T=g.transform,M=Gn.unblended,I=new Xt(S.LEQUAL,Xt.ReadWrite,[0,1]),z=_.getCoordsTexture(),B=_.sourceCache.getRenderableTiles(),W=g.useProgram("terrainCoords");w.bindFramebuffer.set(_.getFramebuffer("coords").framebuffer),w.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),w.clear({color:c.bf.transparent,depth:1}),_.coordsIndex=[];for(const Y of B){const K=_.getTerrainMesh(Y.tileID),J=_.getTerrainData(Y.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,z.texture);const re={u_terrain_coords_id:(255-_.coordsIndex.length)/255,u_texture:0,u_ele_delta:_.getMeshFrameDelta(T.zoom)},se=T.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(w,S.TRIANGLES,I,_n.disabled,M,Ft.backCCW,re,J,se,"terrain",K.vertexBuffer,K.indexBuffer,K.segments),_.coordsIndex.push(Y.tileID.key)}w.bindFramebuffer.set(null),w.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain))}renderLayer(e,a,l,d,g){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(d||[]).length)&&(this.id=l.id,c.cb(l)?(function(_,w,S,T,M,I){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:z}=I,B=_n.disabled,W=_.colorModeForRenderPass();(S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(Y,K,J,re,se,ie,ce,pe,ae){const _e=K.transform,Le=K.style.map.terrain,Te=se==="map",Ee=ie==="map";for(const ke of Y){const ct=re.getTile(ke),st=ct.getBucket(J);if(!st||!st.text||!st.text.segments.get().length)continue;const $e=c.an(st.textSizeData,_e.zoom),Pt=c.aC(ct,1,K.transform.zoom),ln=Vn(Te,K.transform,Pt),Pn=J.layout.get("icon-text-fit")!=="none"&&st.hasIconData();if($e){const ar=Math.pow(2,_e.zoom-ct.tileID.overscaledZ),Fn=Le?(Nn,$n)=>Le.getElevation(ke,Nn,$n):null;cu(st,Te,Ee,ae,_e,ln,ar,$e,Pn,c.aD(_e,ct,ce,pe),ke.toUnwrapped(),Fn)}}})(T,_,S,w,S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),M),S.paint.get("icon-opacity").constantOr(1)!==0&&no(_,w,S,T,!1,S.paint.get("icon-translate"),S.paint.get("icon-translate-anchor"),S.layout.get("icon-rotation-alignment"),S.layout.get("icon-pitch-alignment"),S.layout.get("icon-keep-upright"),B,W,z),S.paint.get("text-opacity").constantOr(1)!==0&&no(_,w,S,T,!0,S.paint.get("text-translate"),S.paint.get("text-translate-anchor"),S.layout.get("text-rotation-alignment"),S.layout.get("text-pitch-alignment"),S.layout.get("text-keep-upright"),B,W,z),w.map.showCollisionBoxes&&(jc(_,w,S,T,!0),jc(_,w,S,T,!1))})(e,a,l,d,this.style.placement.variableOffsets,g):c.cc(l)?(function(_,w,S,T,M){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:I}=M,z=S.paint.get("circle-opacity"),B=S.paint.get("circle-stroke-width"),W=S.paint.get("circle-stroke-opacity"),Y=!S.layout.get("circle-sort-key").isConstant();if(z.constantOr(1)===0&&(B.constantOr(1)===0||W.constantOr(1)===0))return;const K=_.context,J=K.gl,re=_.transform,se=_.getDepthModeForSublayer(0,Xt.ReadOnly),ie=_n.disabled,ce=_.colorModeForRenderPass(),pe=[],ae=re.getCircleRadiusCorrection();for(let _e=0;_e<T.length;_e++){const Le=T[_e],Te=w.getTile(Le),Ee=Te.getBucket(S);if(!Ee)continue;const ke=S.paint.get("circle-translate"),ct=S.paint.get("circle-translate-anchor"),st=c.aD(re,Te,ke,ct),$e=Ee.programConfigurations.get(S.id),Pt=_.useProgram("circle",$e),ln=Ee.layoutVertexBuffer,Pn=Ee.indexBuffer,ar=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Le),Fn={programConfiguration:$e,program:Pt,layoutVertexBuffer:ln,indexBuffer:Pn,uniformValues:Fh(_,Te,S,st,ae),terrainData:ar,projectionData:re.getProjectionData({overscaledTileID:Le,applyGlobeMatrix:!I,applyTerrainMatrix:!0})};if(Y){const Nn=Ee.segments.get();for(const $n of Nn)pe.push({segments:new c.aM([$n]),sortKey:$n.sortKey,state:Fn})}else pe.push({segments:Ee.segments,sortKey:0,state:Fn})}Y&&pe.sort(((_e,Le)=>_e.sortKey-Le.sortKey));for(const _e of pe){const{programConfiguration:Le,program:Te,layoutVertexBuffer:Ee,indexBuffer:ke,uniformValues:ct,terrainData:st,projectionData:$e}=_e.state;Te.draw(K,J.TRIANGLES,se,ie,ce,Ft.backCCW,ct,st,$e,S.id,Ee,ke,_e.segments,S.paint,_.transform.zoom,Le)}})(e,a,l,d,g):c.cd(l)?(function(_,w,S,T,M){if(S.paint.get("heatmap-opacity")===0)return;const I=_.context,{isRenderingToTexture:z,isRenderingGlobe:B}=M;if(_.style.map.terrain){for(const W of T){const Y=w.getTile(W);w.hasRenderableParent(W)||(_.renderPass==="offscreen"?ml(_,Y,S,W,B):_.renderPass==="translucent"&&la(_,S,W,z,B))}I.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?(function(W,Y,K,J){const re=W.context,se=re.gl,ie=W.transform,ce=_n.disabled,pe=new Gn([se.ONE,se.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(ae,_e,Le){const Te=ae.gl;ae.activeTexture.set(Te.TEXTURE1),ae.viewport.set([0,0,_e.width/4,_e.height/4]);let Ee=Le.heatmapFbos.get(c.c2);Ee?(Te.bindTexture(Te.TEXTURE_2D,Ee.colorAttachment.get()),ae.bindFramebuffer.set(Ee.framebuffer)):(Ee=bi(ae,_e.width/4,_e.height/4),Le.heatmapFbos.set(c.c2,Ee))})(re,W,K),re.clear({color:c.bf.transparent});for(let ae=0;ae<J.length;ae++){const _e=J[ae];if(Y.hasRenderableParent(_e))continue;const Le=Y.getTile(_e),Te=Le.getBucket(K);if(!Te)continue;const Ee=Te.programConfigurations.get(K.id),ke=W.useProgram("heatmap",Ee),ct=ie.getProjectionData({overscaledTileID:_e,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),st=ie.getCircleRadiusCorrection();ke.draw(re,se.TRIANGLES,Xt.disabled,ce,pe,Ft.backCCW,Nh(Le,ie.zoom,K.paint.get("heatmap-intensity"),st),null,ct,K.id,Te.layoutVertexBuffer,Te.indexBuffer,Te.segments,K.paint,ie.zoom,Ee)}re.viewport.set([0,0,W.width,W.height])})(_,w,S,T):_.renderPass==="translucent"&&(function(W,Y){const K=W.context,J=K.gl;K.setColorMode(W.colorModeForRenderPass());const re=Y.heatmapFbos.get(c.c2);re&&(K.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,re.colorAttachment.get()),K.activeTexture.set(J.TEXTURE1),Ma(K,Y).bind(J.LINEAR,J.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(K,J.TRIANGLES,Xt.disabled,_n.disabled,W.colorModeForRenderPass(),Ft.disabled,Lc(W,Y,0,1),null,null,Y.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,Y.paint,W.transform.zoom))})(_,S)})(e,a,l,d,g):c.ce(l)?(function(_,w,S,T,M){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:I}=M,z=S.paint.get("line-opacity"),B=S.paint.get("line-width");if(z.constantOr(1)===0||B.constantOr(1)===0)return;const W=_.getDepthModeForSublayer(0,Xt.ReadOnly),Y=_.colorModeForRenderPass(),K=S.paint.get("line-dasharray"),J=S.paint.get("line-pattern"),re=J.constantOr(1),se=S.paint.get("line-gradient"),ie=S.getCrossfadeParameters(),ce=re?"linePattern":K?"lineSDF":se?"lineGradient":"line",pe=_.context,ae=pe.gl,_e=_.transform;let Le=!0;for(const Te of T){const Ee=w.getTile(Te);if(re&&!Ee.patternsLoaded())continue;const ke=Ee.getBucket(S);if(!ke)continue;const ct=ke.programConfigurations.get(S.id),st=_.context.program.get(),$e=_.useProgram(ce,ct),Pt=Le||$e.program!==st,ln=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Te),Pn=J.constantOr(null);if(Pn&&Ee.imageAtlas){const Wn=Ee.imageAtlas,Un=Wn.patternPositions[Pn.to.toString()],vn=Wn.patternPositions[Pn.from.toString()];Un&&vn&&ct.setConstantPatternPositions(Un,vn)}const ar=_e.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),Fn=_e.getPixelScale(),Nn=re?Oc(_,Ee,S,Fn,ie):K?Wo(_,Ee,S,Fn,K,ie):se?Jl(_,Ee,S,Fn,ke.lineClipsArray.length):Nu(_,Ee,S,Fn);if(re)pe.activeTexture.set(ae.TEXTURE0),Ee.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),ct.updatePaintBuffers(ie);else if(K&&(Pt||_.lineAtlas.dirty))pe.activeTexture.set(ae.TEXTURE0),_.lineAtlas.bind(pe);else if(se){const Wn=ke.gradients[S.id];let Un=Wn.texture;if(S.gradientVersion!==Wn.version){let vn=256;if(S.stepInterpolant){const jr=w.getSource().maxzoom,zr=Te.canonical.z===jr?Math.ceil(1<<_.transform.maxZoom-Te.canonical.z):1;vn=c.ah(c.c3(ke.maxLineLength/c.$*1024*zr),256,pe.maxTextureSize)}Wn.gradient=c.c4({expression:S.gradientExpression(),evaluationKey:"lineProgress",resolution:vn,image:Wn.gradient||void 0,clips:ke.lineClipsArray}),Wn.texture?Wn.texture.update(Wn.gradient):Wn.texture=new c.T(pe,Wn.gradient,ae.RGBA),Wn.version=S.gradientVersion,Un=Wn.texture}pe.activeTexture.set(ae.TEXTURE0),Un.bind(S.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}const $n=_.stencilModeForClipping(Te);$e.draw(pe,ae.TRIANGLES,W,$n,Y,Ft.disabled,Nn,ln,ar,S.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,S.paint,_.transform.zoom,ct,ke.layoutVertexBuffer2),Le=!1}})(e,a,l,d,g):c.cf(l)?(function(_,w,S,T,M){const I=S.paint.get("fill-color"),z=S.paint.get("fill-opacity");if(z.constantOr(1)===0)return;const{isRenderingToTexture:B}=M,W=_.colorModeForRenderPass(),Y=S.paint.get("fill-pattern"),K=_.opaquePassEnabledForLayer()&&!Y.constantOr(1)&&I.constantOr(c.bf.transparent).a===1&&z.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===K){const J=_.getDepthModeForSublayer(1,_.renderPass==="opaque"?Xt.ReadWrite:Xt.ReadOnly);Ii(_,w,S,T,J,W,!1,B)}if(_.renderPass==="translucent"&&S.paint.get("fill-antialias")){const J=_.getDepthModeForSublayer(S.getPaintProperty("fill-outline-color")?2:0,Xt.ReadOnly);Ii(_,w,S,T,J,W,!0,B)}})(e,a,l,d,g):c.cg(l)?(function(_,w,S,T,M){const I=S.paint.get("fill-extrusion-opacity");if(I===0)return;const{isRenderingToTexture:z}=M;if(_.renderPass==="translucent"){const B=new Xt(_.context.gl.LEQUAL,Xt.ReadWrite,_.depthRangeFor3D);if(I!==1||S.paint.get("fill-extrusion-pattern").constantOr(1))Ra(_,w,S,T,B,_n.disabled,Gn.disabled,z),Ra(_,w,S,T,B,_.stencilModeFor3D(),_.colorModeForRenderPass(),z);else{const W=_.colorModeForRenderPass();Ra(_,w,S,T,B,_n.disabled,W,z)}}})(e,a,l,d,g):c.ch(l)?(function(_,w,S,T,M){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const{isRenderingToTexture:I}=M,z=_.context,B=_.style.projection.useSubdivision,W=_.getDepthModeForSublayer(0,Xt.ReadOnly),Y=_.colorModeForRenderPass();if(_.renderPass==="offscreen")(function(K,J,re,se,ie,ce,pe){const ae=K.context,_e=ae.gl;for(const Le of re){const Te=J.getTile(Le),Ee=Te.dem;if(!Ee||!Ee.data||!Te.needsHillshadePrepare)continue;const ke=Ee.dim,ct=Ee.stride,st=Ee.getPixels();if(ae.activeTexture.set(_e.TEXTURE1),ae.pixelStoreUnpackPremultiplyAlpha.set(!1),Te.demTexture=Te.demTexture||K.getTileTexture(ct),Te.demTexture){const Pt=Te.demTexture;Pt.update(st,{premultiply:!1}),Pt.bind(_e.NEAREST,_e.CLAMP_TO_EDGE)}else Te.demTexture=new c.T(ae,st,_e.RGBA,{premultiply:!1}),Te.demTexture.bind(_e.NEAREST,_e.CLAMP_TO_EDGE);ae.activeTexture.set(_e.TEXTURE0);let $e=Te.fbo;if(!$e){const Pt=new c.T(ae,{width:ke,height:ke,data:null},_e.RGBA);Pt.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),$e=Te.fbo=ae.createFramebuffer(ke,ke,!0,!1),$e.colorAttachment.set(Pt.texture)}ae.bindFramebuffer.set($e.framebuffer),ae.viewport.set([0,0,ke,ke]),K.useProgram("hillshadePrepare").draw(ae,_e.TRIANGLES,ie,ce,pe,Ft.disabled,kc(Te.tileID,Ee),null,null,se.id,K.rasterBoundsBuffer,K.quadTriangleIndexBuffer,K.rasterBoundsSegments),Te.needsHillshadePrepare=!1}})(_,w,T,S,W,_n.disabled,Y),z.viewport.set([0,0,_.width,_.height]);else if(_.renderPass==="translucent")if(B){const[K,J,re]=_.stencilConfigForOverlapTwoPass(T);qu(_,w,S,re,K,W,Y,!1,I),qu(_,w,S,re,J,W,Y,!0,I)}else{const[K,J]=_.getStencilConfigForOverlapAndUpdateStencilID(T);qu(_,w,S,J,K,W,Y,!1,I)}})(e,a,l,d,g):c.ci(l)?(function(_,w,S,T,M){if(_.renderPass!=="translucent"||!T.length)return;const{isRenderingToTexture:I}=M,z=_.style.projection.useSubdivision,B=_.getDepthModeForSublayer(0,Xt.ReadOnly),W=_.colorModeForRenderPass();if(z){const[Y,K,J]=_.stencilConfigForOverlapTwoPass(T);bo(_,w,S,J,Y,B,W,!1,I),bo(_,w,S,J,K,B,W,!0,I)}else{const[Y,K]=_.getStencilConfigForOverlapAndUpdateStencilID(T);bo(_,w,S,K,Y,B,W,!1,I)}})(e,a,l,d,g):c.cj(l)?(function(_,w,S,T,M){if(_.renderPass!=="translucent"||S.paint.get("raster-opacity")===0||!T.length)return;const{isRenderingToTexture:I}=M,z=w.getSource(),B=_.style.projection.useSubdivision;if(z instanceof Br)Wr(_,w,S,T,null,!1,!1,z.tileCoords,z.flippedWindingOrder,I);else if(B){const[W,Y,K]=_.stencilConfigForOverlapTwoPass(T);Wr(_,w,S,K,W,!1,!0,hu,!1,I),Wr(_,w,S,K,Y,!0,!0,hu,!1,I)}else{const[W,Y]=_.getStencilConfigForOverlapAndUpdateStencilID(T);Wr(_,w,S,Y,W,!1,!0,hu,!1,I)}})(e,a,l,d,g):c.ck(l)?(function(_,w,S,T,M){const I=S.paint.get("background-color"),z=S.paint.get("background-opacity");if(z===0)return;const{isRenderingToTexture:B}=M,W=_.context,Y=W.gl,K=_.style.projection,J=_.transform,re=J.tileSize,se=S.paint.get("background-pattern");if(_.isPatternMissing(se))return;const ie=!se&&I.a===1&&z===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==ie)return;const ce=_n.disabled,pe=_.getDepthModeForSublayer(0,ie==="opaque"?Xt.ReadWrite:Xt.ReadOnly),ae=_.colorModeForRenderPass(),_e=_.useProgram(se?"backgroundPattern":"background"),Le=T||xe(J,{tileSize:re,terrain:_.style.map.terrain});se&&(W.activeTexture.set(Y.TEXTURE0),_.imageManager.bind(_.context));const Te=S.getCrossfadeParameters();for(const Ee of Le){const ke=J.getProjectionData({overscaledTileID:Ee,applyGlobeMatrix:!B,applyTerrainMatrix:!0}),ct=se?Wh(z,_,se,{tileID:Ee,tileSize:re},Te):Gh(z,I),st=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ee),$e=K.getMeshFromTileID(W,Ee.canonical,!1,!0,"raster");_e.draw(W,Y.TRIANGLES,pe,ce,ae,Ft.backCCW,ct,st,ke,S.id,$e.vertexBuffer,$e.indexBuffer,$e.segments)}})(e,0,l,d,g):c.cl(l)&&(function(_,w,S,T){const{isRenderingGlobe:M}=T,I=_.context,z=S.implementation,B=_.style.projection,W=_.transform,Y=W.getProjectionDataForCustomLayer(M),K={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:B.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${B.shaderPreludeCode.vertexSource}`,define:B.shaderDefine},defaultProjectionData:Y},J=z.renderingMode?z.renderingMode:"2d";if(_.renderPass==="offscreen"){const re=z.prerender;re&&(_.setCustomLayerDefaults(),I.setColorMode(_.colorModeForRenderPass()),re.call(z,I.gl,K),I.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),I.setColorMode(_.colorModeForRenderPass()),I.setStencilMode(_n.disabled);const re=J==="3d"?_.getDepthModeFor3D():_.getDepthModeForSublayer(0,Xt.ReadOnly);I.setDepthMode(re),z.render(I.gl,K),I.setDirty(),_.setBaseState(),I.bindFramebuffer.set(null)}})(e,0,l,g))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!a||!l}useProgram(e,a,l=!1,d=[]){this.cache=this.cache||{};const g=!!this.style.map.terrain,_=this.style.projection,w=l?Aa.projectionMercator:_.shaderPreludeCode,S=l?mo:_.shaderDefine,T=e+(a?a.cacheKey:"")+`/${l?ds:_.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"")+(d?`/${d.join("/")}`:"");return this.cache[T]||(this.cache[T]=new Ic(this.context,Aa[e],a,Di[e],this._showOverdrawInspector,g,w,S,d)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function So(f,e){let a,l=!1,d=null,g=null;const _=()=>{d=null,l&&(f.apply(g,a),d=setTimeout(_,e),l=!1)};return(...w)=>(l=!0,g=this,a=w,d||_(),d)}class Li{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(l=d)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let d=l;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${l}`);let g=window.location.hash.replace(d,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let _=window.location.href.replace(/(#.+)?$/,g);_=_.replace("&&","&"),window.history.replaceState(window.history.state,null,_)},this._updateHash=So(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,d=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,d),_=Math.round(a.lng*g)/g,w=Math.round(a.lat*g)/g,S=this._map.getBearing(),T=this._map.getPitch();let M="";if(M+=e?`/${_}/${w}/${l}`:`${l}/${w}/${_}`,(S||T)&&(M+="/"+Math.round(10*S)/10),T&&(M+=`/${Math.round(T)}`),this._hashName){const I=this._hashName;let z=!1;const B=window.location.hash.slice(1).split("&").map((W=>{const Y=W.split("=")[0];return Y===I?(z=!0,`${Y}=${M}`):W})).filter((W=>W));return z||B.push(`${I}=${M}`),`#${B.join("&")}`}return`#${M}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const a=+e[0],l=+(e[3]||0),d=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const Yi={linearity:.3,easing:c.cm(0,0,.3,1)},ca=c.e({deceleration:2500,maxSpeed:1400},Yi),du=c.e({deceleration:20,maxSpeed:1400},Yi),$u=c.e({deceleration:1e3,maxSpeed:360},Yi),_l=c.e({deceleration:1e3,maxSpeed:90},Yi),fu=c.e({deceleration:1e3,maxSpeed:360},Yi);class Qo{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ce.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=Ce.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,a.roll+=g.rollDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const g=Ki(a.pan.mag(),l,c.e({},ca,e||{})),_=a.pan.mult(g.amount/a.pan.mag()),w=this._map.cameraHelper.handlePanInertia(_,this._map.transform);d.center=w.easingCenter,d.offset=w.easingOffset,Rr(d,g)}if(a.zoom){const g=Ki(a.zoom,l,du);d.zoom=this._map.transform.zoom+g.amount,Rr(d,g)}if(a.bearing){const g=Ki(a.bearing,l,$u);d.bearing=this._map.transform.bearing+c.ah(g.amount,-179,179),Rr(d,g)}if(a.pitch){const g=Ki(a.pitch,l,_l);d.pitch=this._map.transform.pitch+g.amount,Rr(d,g)}if(a.roll){const g=Ki(a.roll,l,fu);d.roll=this._map.transform.roll+c.ah(g.amount,-179,179),Rr(d,g)}if(d.zoom||d.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;d.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function Rr(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function Ki(f,e,a){const{maxSpeed:l,linearity:d,deceleration:g}=a,_=c.ah(f*d/(e/1e3),-l,l),w=Math.abs(_)/(g*d);return{easing:a.easing,duration:1e3*w,amount:_*(w/2)}}class ki extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l,d={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const g=ue.mousePos(a.getCanvas(),l),_=a.unproject(g);super(e,c.e({point:g,lngLat:_,originalEvent:l},d)),this._defaultPrevented=!1,this.target=a}}class vl extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){const d=e==="touchend"?l.changedTouches:l.touches,g=ue.touchPos(a.getCanvasContainer(),d),_=g.map((S=>a.unproject(S))),w=g.reduce(((S,T,M,I)=>S.add(T.div(I.length))),new c.P(0,0));super(e,{points:g,point:w,lngLats:_,lngLat:a.unproject(w),originalEvent:l}),this._defaultPrevented=!1}}class Wc extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class $h{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Wc(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new ki(e.type,this._map,e))}mouseup(e){this._map.fire(new ki(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ki(e.type,this._map,e))}dblclick(e){return this._firePreventable(new ki(e.type,this._map,e))}mouseover(e){this._map.fire(new ki(e.type,this._map,e))}mouseout(e){this._map.fire(new ki(e.type,this._map,e))}touchstart(e){return this._firePreventable(new vl(e.type,this._map,e))}touchmove(e){this._map.fire(new vl(e.type,this._map,e))}touchend(e){this._map.fire(new vl(e.type,this._map,e))}touchcancel(e){this._map.fire(new vl(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ur{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new ki(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ki("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new ki(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Jo{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class As{constructor(e,a){this._map=e,this._tr=new Jo(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(ue.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=l,this._box||(this._box=ue.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const g=Math.min(d.x,l.x),_=Math.max(d.x,l.x),w=Math.min(d.y,l.y),S=Math.max(d.y,l.y);ue.setTransform(this._box,`translate(${g}px,${w}px)`),this._box.style.width=_-g+"px",this._box.style.height=S-w+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const l=this._startPos,d=a;if(this.reset(),ue.suppressClick(),l.x!==d.x||l.y!==d.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(l,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ue.remove(this._box),this._box=null),ue.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new c.l(e,{originalEvent:a}))}}function es(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const a={};for(let l=0;l<f.length;l++)a[f[l].identifier]=e[l];return a}class xl{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=(function(d){const g=new c.P(0,0);for(const _ of d)g._add(_);return g.div(d.length)})(a),this.touches=es(l,a)))}touchmove(e,a,l){if(this.aborted||!this.centroid)return;const d=es(l,a);for(const g in this.touches){const _=d[g];(!_||_.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,a,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Po{constructor(e){this.singleTap=new xl(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,l){this.singleTap.touchstart(e,a,l)}touchmove(e,a,l){this.singleTap.touchmove(e,a,l)}touchend(e,a,l){const d=this.singleTap.touchend(e,a,l);if(d){const g=e.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(d)<30;if(g&&_||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class fi{constructor(e){this._tr=new Jo(e),this._zoomIn=new Po({numTouches:1,numTaps:2}),this._zoomOut=new Po({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,l){this._zoomIn.touchstart(e,a,l),this._zoomOut.touchstart(e,a,l)}touchmove(e,a,l){this._zoomIn.touchmove(e,a,l),this._zoomOut.touchmove(e,a,l)}touchend(e,a,l){const d=this._zoomIn.touchend(e,a,l),g=this._zoomOut.touchend(e,a,l),_=this._tr;return d?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(d)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Oi{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const d=Array.isArray(a)?a[0]:a;return!this._moved&&d.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(l,d))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ue.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Zc=0,Ia=2,Es={[Zc]:1,[Ia]:2};class La{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=ue.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(a,l){const d=Es[l];return a.buttons===void 0||(a.buttons&d)!==d})(e,this._eventButton)}isValidEndEvent(e){return ue.mouseButton(e)===this._eventButton}}class qc{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class Xu{constructor(e=new La({checkCorrectEvent:()=>!0}),a=new qc){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,l){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const pu=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class bl{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,l){return this._calculateTransform(e,a,l)}touchmove(e,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,l){this._calculateTransform(e,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,l){l.length>0&&(this._active=!0);const d=es(l,a),g=new c.P(0,0),_=new c.P(0,0);let w=0;for(const T in d){const M=d[T],I=this._touches[T];I&&(g._add(M),_._add(M.sub(I)),w++,d[T]=M)}if(this._touches=d,this._shouldBePrevented(w)||!_.mag())return;const S=_.div(w);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(w),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ts{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,l){if(!this._firstTwoTouches)return;e.preventDefault();const[d,g]=this._firstTwoTouches,_=Bi(l,a,d),w=Bi(l,a,g);if(!_||!w)return;const S=this._aroundCenter?null:_.add(w).div(2);return this._move([_,w],S,e)}touchend(e,a,l){if(!this._firstTwoTouches)return;const[d,g]=this._firstTwoTouches,_=Bi(l,a,d),w=Bi(l,a,g);_&&w||(this._active&&ue.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Bi(f,e,a){for(let l=0;l<f.length;l++)if(f[l].identifier===a)return e[l]}function _t(f,e){return Math.log(f/e)/Math.LN2}class Yu extends ts{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(_t(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_t(this._distance,l),pinchAround:a}}}function Ms(f,e){return 180*f.angleWith(e)/Math.PI}class Ku extends ts{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,l){const d=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ms(this._vector,d),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,l=Ms(e,this._startVector);return Math.abs(l)<a}}function ka(f){return Math.abs(f.y)>Math.abs(f.x)}class Rs extends ts{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,l){super.touchstart(e,a,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,ka(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,g,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(d.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,l){if(this._valid!==void 0)return this._valid;const d=e.mag()>=2,g=a.mag()>=2;if(!d&&!g)return;if(!d||!g)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const _=e.y>0==a.y>0;return ka(e)&&ka(a)&&_}}const Qu={panStep:100,bearingStep:15,pitchStep:10};class en{constructor(e){this._tr=new Jo(e);const a=Qu;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,l=0,d=0,g=0,_=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?d=1:(e.preventDefault(),_=-1);break;case 40:e.shiftKey?d=-1:(e.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:w=>{const S=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:mu,zoom:a?Math.round(S.zoom)+a*(e.shiftKey?2:1):S.zoom,bearing:S.bearing+l*this._bearingStep,pitch:S.pitch+d*this._pitchStep,offset:[-g*this._panStep,-_*this._panStep],center:S.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function mu(f){return f*(2-f)}const Ju=4.000244140625,ro=1/450;class Co{constructor(e,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new Jo(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=ro}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=Ce.now(),d=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%Ju==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=ue.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.S.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const w=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=w),typeof this._targetZoom=="number"&&(this._targetZoom+=w)}if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Ju?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&S!==0&&(S=1/S);const T=typeof this._targetZoom!="number"?e.scale:c.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.ak(T*S)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,d=this._easing;let g,_=!1;if(this._type==="wheel"&&l&&d){const w=Ce.now()-this._lastWheelEventTime,S=Math.min((w+5)/200,1),T=d(S);g=c.C.number(l,a,T),S<1?this._frameId||(this._frameId=!0):_=!0}else g=a,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!_,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=c.co;if(this._prevEase){const l=this._prevEase,d=(Ce.now()-l.start)/l.duration,g=l.easing(d+.01)-l.easing(d),_=.27/Math.sqrt(g*g+1e-4)*.01,w=Math.sqrt(.0729-_*_);a=c.cm(_,w,.25,1)}return this._prevEase={start:Ce.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class wl{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class ec{constructor(e){this._tr=new Jo(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gu{constructor(){this._tap=new Po({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,l){if(!this._swipePoint)if(this._tapTime){const d=a[0],g=e.timeStamp-this._tapTime<500,_=this._tapPoint.dist(d)<30;g&&_?l.length>0&&(this._swipePoint=d,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,a,l)}touchmove(e,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const d=a[0],g=d.y-this._swipePoint.y;return this._swipePoint=d,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,a,l)}touchend(e,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const d=this._tap.touchend(e,a,l);d&&(this._tapTime=e.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ds{constructor(e,a,l){this._el=e,this._mousePan=a,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Sl{constructor(e,a,l,d){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class tc{constructor(e,a,l,d){this._el=e,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Hc{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ue.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=l,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ue.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const To=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class Oa extends c.l{}function Ln(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class $c{constructor(e,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,g)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=d.type==="renderFrame"?void 0:d,w={needsRenderFrame:!1},S={},T={};for(const{handlerName:z,handler:B,allowed:W}of this._handlers){if(!B.isEnabled())continue;let Y;if(this._blockedByActive(T,W,z))B.reset();else if(B[g||d.type]){if(c.cp(d,g||d.type)){const K=ue.mousePos(this._map.getCanvas(),d);Y=B[g||d.type](d,K)}else if(c.cq(d,g||d.type)){const K=this._getMapTouches(d.touches),J=ue.touchPos(this._map.getCanvas(),K);Y=B[g||d.type](d,J,K)}else c.cr(g||d.type)||(Y=B[g||d.type](d));this.mergeHandlerResult(w,S,Y,z,_),Y&&Y.needsRenderFrame&&this._triggerRenderFrame()}(Y||B.isActive())&&(T[z]=B)}const M={};for(const z in this._previousActiveHandlers)T[z]||(M[z]=_);this._previousActiveHandlers=T,(Object.keys(M).length||Ln(w))&&(this._changes.push([w,S,M]),this._triggerRenderFrame()),(Object.keys(T).length||Ln(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:I}=w;I&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],I(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qo(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,g,_]of this._listeners)ue.addEventListener(d,g,d===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[e,a,l]of this._listeners)ue.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new $h(a,e));const d=a.boxZoom=new As(a,e);this._add("boxZoom",d),e.interactive&&e.boxZoom&&d.enable();const g=a.cooperativeGestures=new Hc(a,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();const _=new fi(a),w=new ec(a);a.doubleClickZoom=new wl(w,_),this._add("tapZoom",_),this._add("clickZoom",w),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const S=new gu;this._add("tapDragZoom",S);const T=a.touchPitch=new Rs(a);this._add("touchPitch",T),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const M=()=>a.project(a.getCenter()),I=(function({enable:ie,clickTolerance:ce,aroundCenter:pe=!0,minPixelCenterThreshold:ae=100,rotateDegreesPerPixelMoved:_e=.8},Le){const Te=new La({checkCorrectEvent:Ee=>ue.mouseButton(Ee)===0&&Ee.ctrlKey||ue.mouseButton(Ee)===2&&!Ee.ctrlKey});return new Oi({clickTolerance:ce,move:(Ee,ke)=>{const ct=Le();if(pe&&Math.abs(ct.y-Ee.y)>ae)return{bearingDelta:c.cn(new c.P(Ee.x,ke.y),ke,ct)};let st=(ke.x-Ee.x)*_e;return pe&&ke.y<ct.y&&(st=-st),{bearingDelta:st}},moveStateManager:Te,enable:ie,assignEvents:pu})})(e,M),z=(function({enable:ie,clickTolerance:ce,pitchDegreesPerPixelMoved:pe=-.5}){const ae=new La({checkCorrectEvent:_e=>ue.mouseButton(_e)===0&&_e.ctrlKey||ue.mouseButton(_e)===2});return new Oi({clickTolerance:ce,move:(_e,Le)=>({pitchDelta:(Le.y-_e.y)*pe}),moveStateManager:ae,enable:ie,assignEvents:pu})})(e),B=(function({enable:ie,clickTolerance:ce,rollDegreesPerPixelMoved:pe=.3},ae){const _e=new La({checkCorrectEvent:Le=>ue.mouseButton(Le)===2&&Le.ctrlKey});return new Oi({clickTolerance:ce,move:(Le,Te)=>{const Ee=ae();let ke=(Te.x-Le.x)*pe;return Te.y<Ee.y&&(ke=-ke),{rollDelta:ke}},moveStateManager:_e,enable:ie,assignEvents:pu})})(e,M);a.dragRotate=new Sl(e,I,z,B),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",z,["mouseRotate","mouseRoll"]),this._add("mouseRoll",B,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const W=(function({enable:ie,clickTolerance:ce}){const pe=new La({checkCorrectEvent:ae=>ue.mouseButton(ae)===0&&!ae.ctrlKey});return new Oi({clickTolerance:ce,move:(ae,_e)=>({around:_e,panDelta:_e.sub(ae)}),activateOnStart:!0,moveStateManager:pe,enable:ie,assignEvents:pu})})(e),Y=new bl(e,a);a.dragPan=new Ds(l,W,Y),this._add("mousePan",W),this._add("touchPan",Y,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const K=new Ku,J=new Yu;a.touchZoomRotate=new tc(l,J,K,S),this._add("touchRotate",K,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);const re=a.scrollZoom=new Co(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",re,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const se=a.keyboard=new en(a);this._add("keyboard",se),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Ur(a))}_add(e,a,l){this._handlers.push({handlerName:e,handler:a,allowed:l}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!To(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,l){for(const d in e)if(d!==l&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const l of e)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(e,a,l,d,g){if(!l)return;c.e(e,l);const _={handlerName:d,originalEvent:l.originalEvent||g};l.zoomDelta!==void 0&&(a.zoom=_),l.panDelta!==void 0&&(a.drag=_),l.rollDelta!==void 0&&(a.roll=_),l.pitchDelta!==void 0&&(a.pitch=_),l.bearingDelta!==void 0&&(a.rotate=_)}_applyChanges(){const e={},a={},l={};for(const[d,g,_]of this._changes)d.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(e.rollDelta=(e.rollDelta||0)+d.rollDelta),d.around!==void 0&&(e.around=d.around),d.pinchAround!==void 0&&(e.pinchAround=d.pinchAround),d.noInertia&&(e.noInertia=d.noInertia),c.e(a,g),c.e(l,_);this._updateMapTransform(e,a,l),this._changes=[]}_updateMapTransform(e,a,l){const d=this._map,g=d._getTransformForUpdate(),_=d.terrain;if(!(Ln(e)||_&&this._terrainMovement))return this._fireEvents(a,l,!0);d._stop(!0);let{panDelta:w,zoomDelta:S,bearingDelta:T,pitchDelta:M,rollDelta:I,around:z,pinchAround:B}=e;B!==void 0&&(z=B),z=z||d.transform.centerPoint,_&&!g.isPointOnMapSurface(z)&&(z=g.centerPoint);const W={panDelta:w,zoomDelta:S,rollDelta:I,pitchDelta:M,bearingDelta:T,around:z};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(z)&&(z=g.centerPoint);const Y=z.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(w?z.sub(w):z);_?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,g),this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(w))):this._map.cameraHelper.handleMapControlsPan(W,g,Y):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(W,g,Y))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,g),this._map.cameraHelper.handleMapControlsPan(W,g,Y)),d._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,l,!0)}_fireEvents(e,a,l){const d=To(this._eventsInProgress),g=To(e),_={};for(const I in e){const{originalEvent:z}=e[I];this._eventsInProgress[I]||(_[`${I}start`]=z),this._eventsInProgress[I]=e[I]}!d&&g&&this._fireEvent("movestart",g.originalEvent);for(const I in _)this._fireEvent(I,_[I]);g&&this._fireEvent("move",g.originalEvent);for(const I in e){const{originalEvent:z}=e[I];this._fireEvent(I,z)}const w={};let S;for(const I in this._eventsInProgress){const{handlerName:z,originalEvent:B}=this._eventsInProgress[I];this._handlersById[z].isActive()||(delete this._eventsInProgress[I],S=a[z]||B,w[`${I}end`]=S)}for(const I in w)this._fireEvent(I,w[I]);const T=To(this._eventsInProgress),M=(d||g)&&!T;if(M&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const I=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&I.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(I)}if(l&&M){this._updatingCamera=!0;const I=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=B=>B!==0&&-this._bearingSnap<B&&B<this._bearingSnap;!I||!I.essential&&Ce.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:S})),z(this._map.getBearing())&&this._map.resetNorth()):(z(I.bearing||this._map.getBearing())&&(I.bearing=0),I.freezeElevation=!0,this._map.easeTo(I,{originalEvent:S})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new c.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Oa("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Pl extends c.E{constructor(e,a,l){super(),this._renderFrameCallback=()=>{const d=Math.min((Ce.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},a),l)}panTo(e,a,l){return this.easeTo(c.e({center:e},a),l)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,l){return this.easeTo(c.e({zoom:e},a),l)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)).fire(new c.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,l){return this.easeTo(c.e({bearing:e},a),l)}resetNorth(e,a){return this.rotateTo(0,c.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=qt.convert(e).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,a)}_cameraForBoxAndBearing(e,a,l,d){const g={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const T=d.padding;d.padding={top:T,bottom:T,right:T,left:T}}const _=c.e(g,d.padding);d.padding=_;const w=this.transform,S=new qt(e,a);return this.cameraHelper.cameraForBoxAndBearing(d,_,S,l,w)}fitBounds(e,a,l){return this._fitInternal(this.cameraForBounds(e,a),a,l)}fitScreenCoordinates(e,a,l,d,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(a)),l,d),d,g)}_fitInternal(e,a,l){return e?(delete(a=c.e(e,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(e,a){this.stop();const l=this._getTransformForUpdate();let d=!1,g=!1,_=!1;const w=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const S=l.zoom!==w;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(d=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(g=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(_=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)),S&&this.fire(new c.l("zoomstart",a)).fire(new c.l("zoom",a)).fire(new c.l("zoomend",a)),d&&this.fire(new c.l("rotatestart",a)).fire(new c.l("rotate",a)).fire(new c.l("rotateend",a)),g&&this.fire(new c.l("pitchstart",a)).fire(new c.l("pitch",a)).fire(new c.l("pitchend",a)),_&&this.fire(new c.l("rollstart",a)).fire(new c.l("roll",a)).fire(new c.l("rollend",a)),this.fire(new c.l("moveend",a))}calculateCameraOptionsFromTo(e,a,l,d=0){const g=c.a1.fromLngLat(e,a),_=c.a1.fromLngLat(l,d),w=_.x-g.x,S=_.y-g.y,T=_.z-g.z,M=Math.hypot(w,S,T);if(M===0)throw new Error("Can't calculate camera options with same From and To");const I=Math.hypot(w,S),z=c.ak(this.transform.cameraToCenterDistance/M/this.transform.tileSize),B=180*Math.atan2(w,-S)/Math.PI;let W=180*Math.acos(I/M)/Math.PI;return W=T<0?90-W:90+W,{center:_.toLngLat(),elevation:d,zoom:z,pitch:W,bearing:B}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,l,d,g){const _=this.transform.calculateCenterFromCameraLngLatAlt(e,a,l,d);return{center:_.center,elevation:_.elevation,zoom:_.zoom,bearing:l,pitch:d,roll:g}}easeTo(e,a){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.co},e)).animate===!1||!e.essential&&Ce.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),d=this.getBearing(),g=l.pitch,_=l.roll,w="bearing"in e?this._normalizeBearing(e.bearing,d):d,S="pitch"in e?+e.pitch:g,T="roll"in e?this._normalizeBearing(e.roll,_):_,M="padding"in e?e.padding:l.padding,I=c.P.convert(e.offset);let z,B;e.around&&(z=c.S.convert(e.around),B=l.locationToScreenPoint(z));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},Y=this.cameraHelper.handleEaseTo(l,{bearing:w,pitch:S,roll:T,padding:M,around:z,aroundPoint:B,offsetAsPoint:I,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||d!==w,this._pitching=this._pitching||S!==g,this._rolling=this._rolling||T!==_,this._padding=!l.isPaddingEqual(M),this._zooming=this._zooming||Y.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,W),this.terrain&&this._prepareElevation(Y.elevationCenter),this._ease((K=>{Y.easeFunc(K),this.terrain&&!e.freezeElevation&&this._updateElevation(K),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(K=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,K)}),e),this}_prepareEase(e,a,l={}){this._moving=!0,a||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(a-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),l=e.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(l<d){const g=this.calculateCameraOptionsFromTo(a,d,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push((d=>this._elevateCameraIfInsideTerrain(d))),this.transformCameraUpdate&&a.push((d=>this.transformCameraUpdate(d))),!a.length)return;const l=e.clone();for(const d of a){const g=l.clone(),{center:_,zoom:w,roll:S,pitch:T,bearing:M,elevation:I}=d(g);_&&g.setCenter(_),I!==void 0&&g.setElevation(I),w!==void 0&&g.setZoom(w),S!==void 0&&g.setRoll(S),T!==void 0&&g.setPitch(T),M!==void 0&&g.setBearing(M),l.apply(g)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,d=this._rotating,g=this._pitching,_=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),d&&this.fire(new c.l("rotateend",e)),g&&this.fire(new c.l("pitchend",e)),_&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,a){if(!e.essential&&Ce.prefersReducedMotion){const ke=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(ke,a)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},e);const l=this._getTransformForUpdate(),d=l.bearing,g=l.pitch,_=l.roll,w=l.padding,S="bearing"in e?this._normalizeBearing(e.bearing,d):d,T="pitch"in e?+e.pitch:g,M="roll"in e?this._normalizeBearing(e.roll,_):_,I="padding"in e?e.padding:l.padding,z=c.P.convert(e.offset);let B=l.centerPoint.add(z);const W=l.screenPointToLocation(B),Y=this.cameraHelper.handleFlyTo(l,{bearing:S,pitch:T,roll:M,padding:I,locationAtOffset:W,offsetAsPoint:z,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let K=e.curve;const J=Math.max(l.width,l.height),re=J/Y.scaleOfZoom,se=Y.pixelPathLength;typeof Y.scaleOfMinZoom=="number"&&(K=Math.sqrt(J/Y.scaleOfMinZoom/se*2));const ie=K*K;function ce(ke){const ct=(re*re-J*J+(ke?-1:1)*ie*ie*se*se)/(2*(ke?re:J)*ie*se);return Math.log(Math.sqrt(ct*ct+1)-ct)}function pe(ke){return(Math.exp(ke)-Math.exp(-ke))/2}function ae(ke){return(Math.exp(ke)+Math.exp(-ke))/2}const _e=ce(!1);let Le=function(ke){return ae(_e)/ae(_e+K*ke)},Te=function(ke){return J*((ae(_e)*(pe(ct=_e+K*ke)/ae(ct))-pe(_e))/ie)/se;var ct},Ee=(ce(!0)-_e)/K;if(Math.abs(se)<2e-6||!isFinite(Ee)){if(Math.abs(J-re)<1e-6)return this.easeTo(e,a);const ke=re<J?-1:1;Ee=Math.abs(Math.log(re/J))/K,Te=()=>0,Le=ct=>Math.exp(ke*K*ct)}return e.duration="duration"in e?+e.duration:1e3*Ee/("screenSpeed"in e?+e.screenSpeed/K:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=d!==S,this._pitching=T!==g,this._rolling=M!==_,this._padding=!l.isPaddingEqual(I),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(Y.targetCenter),this._ease((ke=>{const ct=ke*Ee,st=1/Le(ct),$e=Te(ct);this._rotating&&l.setBearing(c.C.number(d,S,ke)),this._pitching&&l.setPitch(c.C.number(g,T,ke)),this._rolling&&l.setRoll(c.C.number(_,M,ke)),this._padding&&(l.interpolatePadding(w,I,ke),B=l.centerPoint.add(z)),Y.easeFunc(ke,st,$e,B),this.terrain&&!e.freezeElevation&&this._updateElevation(ke),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,a,l){l.animate===!1||l.duration===0?(e(1),a()):(this._easeStart=Ce.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=c.aO(e,-180,180);const l=Math.abs(e-a);return Math.abs(e-360-a)<l&&(e-=360),Math.abs(e+360-a)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const Ba={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class fn{constructor(e=Ba){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ue.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ue.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ue.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ue.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const l=this._map._getUIString(`AttributionControl.${a}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((d=>typeof d!="string"?"":d))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const g=a[d];if(g.used||g.usedForTerrain){const _=g.getSource();_.attribution&&e.indexOf(_.attribution)<0&&e.push(_.attribution)}}e=e.filter((d=>String(d).trim())),e.sort(((d,g)=>d.length-g.length)),e=e.filter(((d,g)=>{for(let _=g+1;_<e.length;_++)if(e[_].indexOf(d)>=0)return!1;return!0}));const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=ue.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class kn{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ue.create("div","maplibregl-ctrl");const a=ue.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ue.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Dr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const d of l)if(d.id===e)return void(d.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var nc=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Fi extends c.E{constructor(e){super(),this._lastTilesetChange=Ce.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];const l={};for(const d of xe(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),c.bY(d.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[d.key]=new Mi(d,this.tileSize),this._lastTilesetChange=Ce.now());for(const d in this._tiles)l[d]||delete this._tiles[d]}freeRtt(e){for(const a in this._tiles){const l=this._tiles[a];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const l of this._renderableTilesKeys){const d=this._tiles[l].tileID,g=e.clone(),_=c.ba();if(d.canonical.equals(e.canonical))c.bY(_,0,c.$,c.$,0,0,1);else if(d.canonical.isChildOf(e.canonical)){const w=d.canonical.z-e.canonical.z,S=d.canonical.x-(d.canonical.x>>w<<w),T=d.canonical.y-(d.canonical.y>>w<<w),M=c.$>>w;c.bY(_,0,M,M,0,0,1),c.M(_,_,[-S*M,-T*M,0])}else{if(!e.canonical.isChildOf(d.canonical))continue;{const w=e.canonical.z-d.canonical.z,S=e.canonical.x-(e.canonical.x>>w<<w),T=e.canonical.y-(e.canonical.y>>w<<w),M=c.$>>w;c.bY(_,0,c.$,c.$,0,0,1),c.M(_,_,[S*M,T*M,0]),c.N(_,_,[1/2**w,1/2**w,0])}}g.terrainRttPosMatrix32f=new Float32Array(_),a[l]=g}return a}_getTerrainCoordsForTileRanges(e,a){const l={};for(const d of this._renderableTilesKeys){const g=this._tiles[d].tileID;if(!this._isWithinTileRanges(g,a))continue;const _=e.clone(),w=c.ba();if(g.canonical.z===e.canonical.z){const S=e.canonical.x-g.canonical.x,T=e.canonical.y-g.canonical.y;c.bY(w,0,c.$,c.$,0,0,1),c.M(w,w,[S*c.$,T*c.$,0])}else if(g.canonical.z>e.canonical.z){const S=g.canonical.z-e.canonical.z,T=g.canonical.x-(g.canonical.x>>S<<S),M=g.canonical.y-(g.canonical.y>>S<<S),I=e.canonical.x-(g.canonical.x>>S),z=e.canonical.y-(g.canonical.y>>S),B=c.$>>S;c.bY(w,0,B,B,0,0,1),c.M(w,w,[-T*B+I*c.$,-M*B+z*c.$,0])}else{const S=e.canonical.z-g.canonical.z,T=e.canonical.x-(e.canonical.x>>S<<S),M=e.canonical.y-(e.canonical.y>>S<<S),I=(e.canonical.x>>S)-g.canonical.x,z=(e.canonical.y>>S)-g.canonical.y,B=c.$<<S;c.bY(w,0,B,B,0,0,1),c.M(w,w,[T*c.$+I*B,M*c.$+z*B,0])}_.terrainRttPosMatrix32f=new Float32Array(w),l[d]=_}return l}getSourceTile(e,a){const l=this.sourceCache._source;let d=e.overscaledZ-this.deltaZoom;if(d>l.maxzoom&&(d=l.maxzoom),d<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(d).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&a)for(;d>=l.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(d--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class io{constructor(e,a,l){this._meshCache={},this.painter=e,this.sourceCache=new Fi(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,l,d=c.$){var g;if(!(a>=0&&a<d&&l>=0&&l<d))return 0;const _=this.getTerrainData(e),w=(g=_.tile)===null||g===void 0?void 0:g.dem;if(!w)return 0;const S=c.cs([],[a/d*c.$,l/d*c.$],_.u_terrain_matrix),T=[S[0]*w.dim,S[1]*w.dim],M=Math.floor(T[0]),I=Math.floor(T[1]),z=T[0]-M,B=T[1]-I;return w.get(M,I)*(1-z)*(1-B)+w.get(M+1,I)*z*(1-B)+w.get(M,I+1)*(1-z)*B+w.get(M+1,I+1)*z*B}getElevationForLngLatZoom(e,a){if(!c.ct(a,e.wrap()))return 0;const{tileID:l,mercatorX:d,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(l,d%c.$,g%c.$,c.$)}getElevation(e,a,l,d=c.$){return this.getDEMElevation(e,a,l,d)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const d=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(d,g,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new c.T(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a+a.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const d=this.sourceCache.sourceCache._source.maxzoom;let g=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=d?g=e.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=e.canonical.x-(e.canonical.x>>g<<g),w=e.canonical.y-(e.canonical.y>>g<<g),S=c.cu(new Float64Array(16),[1/(c.$<<g),1/(c.$<<g),0]);c.M(S,S,[_*c.$,w*c.$,0]),this._demMatrixCache[e.key]={matrix:S,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,l=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,d))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,_=0;g<this._coordsTextureSize;g++)for(let w=0;w<this._coordsTextureSize;w++,_+=4)a[_+0]=255&w,a[_+1]=255&g,a[_+2]=w>>8<<4|g>>8,a[_+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new c.T(e,l,e.gl.RGBA,{premultiply:!1});return d.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,d=l.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),_=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),w=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(g,w-_-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const S=a[0]+(a[2]>>4<<8),T=a[1]+((15&a[2])<<8),M=this.coordsIndex[255-a[3]],I=M&&this.sourceCache.getTileByID(M);if(!I)return null;const z=this._coordsTextureSize,B=(1<<I.tileID.canonical.z)*z;return new c.a1((I.tileID.canonical.x*z+S)/B+I.tileID.wrap,(I.tileID.canonical.y*z+T)/B,this.getElevation(I.tileID,S,T,z))}depthAtPoint(e){const a=new Uint8Array(4),l=this.painter.context,d=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,d=l&&e.canonical.y===0,g=l&&e.canonical.y===(1<<e.canonical.z)-1,_=`m_${d?"n":""}_${g?"s":""}`;if(this._meshCache[_])return this._meshCache[_];const w=this.painter.context,S=new c.cv,T=new c.aN,M=this.meshSize,I=c.$/M,z=M*M;for(let ae=0;ae<=M;ae++)for(let _e=0;_e<=M;_e++)S.emplaceBack(_e*I,ae*I,0);for(let ae=0;ae<z;ae+=M+1)for(let _e=0;_e<M;_e++)T.emplaceBack(_e+ae,M+_e+ae+1,M+_e+ae+2),T.emplaceBack(_e+ae,M+_e+ae+2,_e+ae+1);const B=S.length,W=B+(M+1),Y=(M+1)*M,K=d?c.bh:0,J=d?0:1,re=g?c.bi:c.$,se=g?0:1;for(let ae=0;ae<=M;ae++)S.emplaceBack(ae*I,K,J);for(let ae=0;ae<=M;ae++)S.emplaceBack(ae*I,re,se);for(let ae=0;ae<M;ae++)T.emplaceBack(Y+ae,W+ae,W+ae+1),T.emplaceBack(Y+ae,W+ae+1,Y+ae+1),T.emplaceBack(0+ae,B+ae+1,B+ae),T.emplaceBack(0+ae,0+ae+1,B+ae+1);const ie=S.length,ce=ie+2*(M+1);for(const ae of[0,1])for(let _e=0;_e<=M;_e++)for(const Le of[0,1])S.emplaceBack(ae*c.$,_e*I,Le);for(let ae=0;ae<2*M;ae+=2)T.emplaceBack(ie+ae,ie+ae+1,ie+ae+3),T.emplaceBack(ie+ae,ie+ae+3,ie+ae+2),T.emplaceBack(ce+ae,ce+ae+3,ce+ae+1),T.emplaceBack(ce+ae,ce+ae+2,ce+ae+3);const pe=new Uo(w.createVertexBuffer(S,nc.members),w.createIndexBuffer(T),c.aM.simpleSegment(0,0,S.length,T.length));return this._meshCache[_]=pe,pe}getMeshFrameDelta(e){return 2*Math.PI*c.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var l;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(l=this.getMinMaxElevation(d).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,a){const l=c.a1.fromLngLat(e.wrap()),d=(1<<a)*c.$,g=l.x*d,_=l.y*d,w=Math.floor(g/c.$),S=Math.floor(_/c.$);return{tileID:new c.Z(a,0,a,w,S),mercatorX:g,mercatorY:_}}}class St{constructor(e,a,l){this._context=e,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:e,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>e.id!==a)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const zt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Ao{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new St(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((l=>!e._layers[l].isHidden(a))),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const d=e.sourceCaches[l].getVisibleCoordinates(),g=e.sourceCaches[l].getSource(),_=g instanceof Br?g.terrainTileRanges:null;for(const w of d){const S=this.terrain.sourceCache.getTerrainCoords(w,_);for(const T in S)this._coordsAscending[l][T]||(this._coordsAscending[l][T]=[]),this._coordsAscending[l][T].push(S[T])}}this._coordsAscendingStr={};for(const l of e._order){const d=e._layers[l],g=d.source;if(zt[d.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(const _ in this._coordsAscending[g])this._coordsAscendingStr[g][_]=this._coordsAscending[g][_].map((w=>w.key)).sort().join()}}for(const l of this._renderableTiles)for(const d in this._coordsAscendingStr){const g=this._coordsAscendingStr[d][l.tileID.key];g&&g!==l.rttCoords[d]&&(l.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),d=e.type,g=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(zt[d]&&(this._prevType&&zt[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(e.id),!_))return!0;if(zt[this._prevType]||zt[d]&&_){this._prevType=d;const w=this._stacks.length-1,S=this._stacks[w]||[];for(const T of this._renderableTiles){if(this.pool.isFull()&&(Xi(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(T),T.rtt[w]){const I=this.pool.getObjectForId(T.rtt[w].id);if(I.stamp===T.rtt[w].stamp){this.pool.useObject(I);continue}}const M=this.pool.getOrCreateFreeObject();this.pool.useObject(M),this.pool.stampObject(M),T.rtt[w]={id:M.id,stamp:M.stamp},g.context.bindFramebuffer.set(M.fbo.framebuffer),g.context.clear({color:c.bf.transparent,stencil:0}),g.currentStencilSource=void 0;for(let I=0;I<S.length;I++){const z=g.style._layers[S[I]],B=z.source?this._coordsAscending[z.source][T.tileID.key]:[T.tileID];g.context.viewport.set([0,0,M.fbo.width,M.fbo.height]),g._renderTileClippingMasks(z,B,!0),g.renderLayer(g,g.style.sourceCaches[z.source],z,B,l),z.source&&(T.rttCoords[z.source]=this._coordsAscendingStr[z.source][T.tileID.key])}}return Xi(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),zt[d]}return!1}}const Xc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},fr=q,ei={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ba,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},rc={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class xa{constructor(e,a,l=!1){this.mousedown=g=>{this.startMove(g,ue.mousePos(this.element,g)),ue.addEventListener(window,"mousemove",this.mousemove),ue.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,ue.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHandler.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ue.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),ue.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=ue.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const d=new Xu;this._rotatePitchHandler=new Oi({clickTolerance:3,move:(g,_)=>{const w=a.getBoundingClientRect(),S=new c.P((w.bottom-w.top)/2,(w.right-w.left)/2);return{bearingDelta:c.cn(new c.P(g.x,_.y),_,S),pitchDelta:l?-.5*(_.y-g.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=e,ue.addEventListener(a,"mousedown",this.mousedown),ue.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),ue.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),ue.disableDrag()}move(e,a){const l=this.map,{bearingDelta:d,pitchDelta:g}=this._rotatePitchHandler.dragMove(e,a)||{};d&&l.setBearing(l.getBearing()+d),g&&l.setPitch(l.getPitch()+g)}off(){const e=this.element;ue.removeEventListener(e,"mousedown",this.mousedown),ue.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend),ue.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ue.enableDrag(),ue.removeEventListener(window,"mousemove",this.mousemove),ue.removeEventListener(window,"mouseup",this.mouseup),ue.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ue.removeEventListener(window,"touchend",this.touchend)}}let ns;function Cl(f,e,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return f?.wrap();const d=new c.S(f.lng,f.lat);if(f=new c.S(f.lng,f.lat),e){const g=new c.S(f.lng-360,f.lat),_=new c.S(f.lng+360,f.lat),w=a.locationToScreenPoint(f).distSqr(e);a.locationToScreenPoint(g).distSqr(e)<w?f=g:a.locationToScreenPoint(_).distSqr(e)<w&&(f=_)}for(;Math.abs(f.lng-a.center.lng)>180;){const g=a.locationToScreenPoint(f);if(g.x>=0&&g.y>=0&&g.x<=a.width&&g.y<=a.height)break;f.lng>a.center.lng?f.lng-=360:f.lng+=360}return f.lng!==d.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(f))?f:d}const Hn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pr(f,e,a){const l=f.classList;for(const d in Hn)l.remove(`maplibregl-${a}-anchor-${d}`);l.add(`maplibregl-${a}-anchor-${e}`)}class Tl extends c.E{constructor(e){if(super(),this._onKeyPress=a=>{const l=a.code,d=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=Cl(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),ue.setTransform(this._element,`${Hn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${d}`),Ce.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue.create("div");const a=ue.createNS("http://www.w3.org/2000/svg","svg"),l=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${l}`);const g=ue.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const _=ue.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const w=ue.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const S=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const J of S){const re=ue.createNS("http://www.w3.org/2000/svg","ellipse");re.setAttributeNS(null,"opacity","0.04"),re.setAttributeNS(null,"cx","10.5"),re.setAttributeNS(null,"cy","5.80029008"),re.setAttributeNS(null,"rx",J.rx),re.setAttributeNS(null,"ry",J.ry),w.appendChild(re)}const T=ue.createNS("http://www.w3.org/2000/svg","g");T.setAttributeNS(null,"fill",this._color);const M=ue.createNS("http://www.w3.org/2000/svg","path");M.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),T.appendChild(M);const I=ue.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"opacity","0.25"),I.setAttributeNS(null,"fill","#000000");const z=ue.createNS("http://www.w3.org/2000/svg","path");z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),I.appendChild(z);const B=ue.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(6.0, 7.0)"),B.setAttributeNS(null,"fill","#FFFFFF");const W=ue.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Y=ue.createNS("http://www.w3.org/2000/svg","circle");Y.setAttributeNS(null,"fill","#000000"),Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"cx","5.5"),Y.setAttributeNS(null,"cy","5.5"),Y.setAttributeNS(null,"r","5.4999962");const K=ue.createNS("http://www.w3.org/2000/svg","circle");K.setAttributeNS(null,"fill","#FFFFFF"),K.setAttributeNS(null,"cx","5.5"),K.setAttributeNS(null,"cy","5.5"),K.setAttributeNS(null,"r","5.4999962"),W.appendChild(Y),W.appendChild(K),_.appendChild(w),_.appendChild(T),_.appendChild(I),_.appendChild(B),_.appendChild(W),a.appendChild(_),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),pr(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ue.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const d=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,l;const d=(a=this._map)===null||a===void 0?void 0:a.terrain,g=this._map.transform.isLocationOccluded(this._lngLat);if(!d||g){const B=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==B&&(this._element.style.opacity=B))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const _=this._map,w=_.terrain.depthAtPoint(this._pos),S=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,S)-w<.006)return void(this._element.style.opacity=this._opacity);const T=-this._offset.y/_.transform.pixelsPerMeter,M=Math.sin(_.getPitch()*Math.PI/180)*T,I=_.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),z=_.transform.lngLatToCameraDepth(this._lngLat,S+M)-I>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&z&&this._popup.remove(),this._element.style.opacity=z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const ti={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ir=0,Eo=!1;const zs={maxWidth:100,unit:"metric"};function Is(f,e,a){const l=a&&a.maxWidth||100,d=f._container.clientHeight/2,g=f._container.clientWidth/2,_=f.unproject([g-l/2,d]),w=f.unproject([g+l/2,d]),S=Math.round(f.project(w).x-f.project(_).x),T=Math.min(l,S,f._container.clientWidth),M=_.distanceTo(w);if(a&&a.unit==="imperial"){const I=3.2808*M;I>5280?Fa(e,T,I/5280,f._getUIString("ScaleControl.Miles")):Fa(e,T,I,f._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Fa(e,T,M/1852,f._getUIString("ScaleControl.NauticalMiles")):M>=1e3?Fa(e,T,M/1e3,f._getUIString("ScaleControl.Kilometers")):Fa(e,T,M,f._getUIString("ScaleControl.Meters"))}function Fa(f,e,a,l){const d=(function(g){const _=Math.pow(10,`${Math.floor(g)}`.length-1);let w=g/_;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:(function(S){const T=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*T)/T})(w),_*w})(a);f.style.width=e*(d/a)+"px",f.innerHTML=`${d}&nbsp;${l}`}const Na={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Al=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function El(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,f),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-f),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(f,0),right:new c.P(-f,0)}}if(f instanceof c.P||Array.isArray(f)){const e=c.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(f.center||[0,0]),top:c.P.convert(f.top||[0,0]),"top-left":c.P.convert(f["top-left"]||[0,0]),"top-right":c.P.convert(f["top-right"]||[0,0]),bottom:c.P.convert(f.bottom||[0,0]),"bottom-left":c.P.convert(f["bottom-left"]||[0,0]),"bottom-right":c.P.convert(f["bottom-right"]||[0,0]),left:c.P.convert(f.left||[0,0]),right:c.P.convert(f.right||[0,0])}}return El(new c.P(0,0))}const yu=q;E.AJAXError=c.cz,E.Event=c.l,E.Evented=c.E,E.LngLat=c.S,E.MercatorCoordinate=c.a1,E.Point=c.P,E.addProtocol=c.cA,E.config=c.a,E.removeProtocol=c.cB,E.AttributionControl=fn,E.BoxZoomHandler=As,E.CanvasSource=oi,E.CooperativeGesturesHandler=Hc,E.DoubleClickZoomHandler=wl,E.DragPanHandler=Ds,E.DragRotateHandler=Sl,E.EdgeInsets=go,E.FullscreenControl=class extends c.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ue.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=ue.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ue.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},E.GeoJSONSource=Kr,E.GeolocateControl=class extends c.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new c.S(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,d=this._map.getBearing(),g=c.e({bearing:d},this.options.fitBoundsOptions),_=qt.fromLngLat(a,l);this._map.fitBounds(_,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Eo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=ue.create("button","maplibregl-ctrl-geolocate",this._container),ue.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Tl({element:this._dotElement}),this._circleElement=ue.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Tl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},ti,f)}onAdd(f){return this._map=f,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(e=!1){if(ns!==void 0&&!e)return ns;if(window.navigator.permissions===void 0)return ns=!!window.navigator.geolocation,ns;try{ns=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{ns=!!window.navigator.geolocation}return ns}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ue.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ir=0,Eo=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),a=f.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const f=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&f))return;const e=this._map.project(f),a=this._map.unproject([e.x+100,e.y]),l=f.distanceTo(a)/100,d=2*this._accuracy/l;this._circleElement.style.width=`${d.toFixed(2)}px`,this._circleElement.style.height=`${d.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ir--,Eo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ir++,ir>1?(f={maximumAge:6e5,timeout:0},Eo=!0):(f=this.options.positionOptions,Eo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},E.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ue.create("button","maplibregl-ctrl-globe",this._container),ue.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ue.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},E.Hash=Li,E.ImageSource=Br,E.KeyboardHandler=en,E.LngLatBounds=qt,E.LogoControl=kn,E.Map=class extends Pl{constructor(f){var e,a;c.cw.mark(c.cx.create);const l=Object.assign(Object.assign(Object.assign({},ei),f),{canvasContextAttributes:Object.assign(Object.assign({},ei.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new Rn,g=new vr;if(l.minZoom!==void 0&&d.setMinZoom(l.minZoom),l.maxZoom!==void 0&&d.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&d.setMinPitch(l.minPitch),l.maxPitch!==void 0&&d.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&d.setRenderWorldCopies(l.renderWorldCopies),super(d,g,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Dr,this._controls=[],this._mapId=c.a7(),this._contextLost=w=>{w.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:w}))},this._contextRestored=w=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:w}))},this._onMapScroll=w=>{if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},Xc),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=wt.addThrottleControl((()=>this.isMoving())),this._requestManager=new xt(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let w=!1;const S=So((T=>{this._trackResize&&!this._removed&&(this.resize(T),this.redraw())}),50);this._resizeObserver=new ResizeObserver((T=>{w?S(T):w=!0})),this._resizeObserver.observe(this._container)}this.handlers=new $c(this,l),this._hash=l.hash&&new Li(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const _=typeof l.style=="string"||((a=(e=l.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,_),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new fn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new kn,l.logoPosition),this.on("style.load",(()=>{if(_||this._resizeTransform(),this.transform.unmodified){const w=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(w)}})),this.on("data",(w=>{this._update(w.dataType==="style"),this.fire(new c.l(`${w.dataType}data`,w))})),this.on("dataloading",(w=>{this.fire(new c.l(`${w.dataType}dataloading`,w))})),this.on("dataabort",(w=>{this.fire(new c.l("sourcedataabort",w))}))}_getMapId(){return this._mapId}setGlobalStateProperty(f,e){return this.style.setGlobalStateProperty(f,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}coveringTiles(f){return xe(this.transform,f)}calculateCameraOptionsFromTo(f,e,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,a,l)}resize(f,e=!0){const[a,l]=this._containerDimensions(),d=this._getClampedPixelRatio(a,l);if(this._resizeCanvas(a,l,d),this.painter.resize(a,l,d),this.painter.overLimit()){const _=this.painter.context.gl;this._maxCanvasSize=[_.drawingBufferWidth,_.drawingBufferHeight];const w=this._getClampedPixelRatio(a,l);this._resizeCanvas(a,l,w),this.painter.resize(a,l,w)}this._resizeTransform(e);const g=!this._moving;return g&&(this.stop(),this.fire(new c.l("movestart",f)).fire(new c.l("move",f))),this.fire(new c.l("resize",f)),g&&this.fire(new c.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[a,l]=this._containerDimensions();this.transform.resize(a,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,l,f)}_getClampedPixelRatio(f,e){const{0:a,1:l}=this._maxCanvasSize,d=this.getPixelRatio(),g=f*d,_=e*d;return Math.min(g>a?a/g:1,_>l?l/_:1)*d}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(qt.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(c.S.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(c.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,a){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:g=>{const _=e.filter((S=>this.getLayer(S))),w=_.length!==0?this.queryRenderedFeatures(g.point,{layers:_}):[];w.length?l||(l=!0,a.call(this,new ki(f,this,g.originalEvent,{features:w}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:_=>{const w=e.filter((S=>this.getLayer(S)));(w.length!==0?this.queryRenderedFeatures(_.point,{layers:w}):[]).length?l=!0:l&&(l=!1,a.call(this,new ki(f,this,_.originalEvent)))},mouseout:_=>{l&&(l=!1,a.call(this,new ki(f,this,_.originalEvent)))}}}}{const l=d=>{const g=e.filter((w=>this.getLayer(w))),_=g.length!==0?this.queryRenderedFeatures(d.point,{layers:g}):[];_.length&&(d.features=_,a.call(this,d),delete d.features)};return{layers:e,listener:a,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,a){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let d=0;d<l.length;d++){const g=l[d];if(g.listener===a&&g.layers.length===e.length&&g.layers.every((_=>e.includes(_)))){for(const _ in g.delegates)this.off(_,g.delegates[_]);return void l.splice(d,1)}}}on(f,e,a){if(a===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,d=this._createDelegatedListener(f,l,a);this._saveDelegatedListener(f,d);for(const g in d.delegates)this.on(g,d.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,a)}}}once(f,e,a){if(a===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,d=this._createDelegatedListener(f,l,a);for(const g in d.delegates){const _=d.delegates[g];d.delegates[g]=(...w)=>{this._removeDelegatedListener(f,l,a),_(...w)}}this._saveDelegatedListener(f,d);for(const g in d.delegates)this.once(g,d.delegates[g]);return this}off(f,e,a){return a===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let a;const l=f instanceof c.P||Array.isArray(f),d=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},d instanceof c.P||typeof d[0]=="number")a=[c.P.convert(d)];else{const g=c.P.convert(d[0]),_=c.P.convert(d[1]);a=[g,new c.P(_.x,g.y),_,new c.P(g.x,_.y),g]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var a,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(f,e)));const d=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Dc(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,d):this.style.loadJSON(f,e,d),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Dc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const a=this._requestManager.transformRequest(f,"Style");c.j(a,new AbortController).then((l=>{this._updateDiff(l.data,e)})).catch((l=>{l&&this.fire(new c.k(l))}))}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===f.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===f.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new io(this.painter,e,f),this.painter.renderToTexture=new Ao(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const a=f[e]._tiles;for(const l in a){const d=a[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,e,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=et(Math.max(1,f),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=et(Math.max(1,f),Math.max(1,e));return this._update(!0),this}refreshTiles(f,e){const a=this.style.sourceCaches[f];if(!a)throw new Error(`There is no source cache with ID "${f}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map((l=>new c.a4(l.z,l.x,l.y))))}addImage(f,e,a={}){const{pixelRatio:l=1,sdf:d=!1,stretchX:g,stretchY:_,content:w,textFitWidth:S,textFitHeight:T}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:M,height:I,data:z}=e,B=e;return this.style.addImage(f,{data:new c.R({width:M,height:I},new Uint8Array(z)),pixelRatio:l,stretchX:g,stretchY:_,content:w,textFitWidth:S,textFitHeight:T,sdf:d,version:0,userImage:B}),B.onAdd&&B.onAdd(this,f),this}}{const{width:M,height:I,data:z}=Ce.getImageData(e);this.style.addImage(f,{data:new c.R({width:M,height:I},z),pixelRatio:l,stretchX:g,stretchY:_,content:w,textFitWidth:S,textFitHeight:T,sdf:d,version:0})}}updateImage(f,e){const a=this.style.getImage(f);if(!a)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?Ce.getImageData(e):e,{width:d,height:g,data:_}=l;if(d===void 0||g===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||g!==a.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(e instanceof HTMLImageElement||c.b(e));return a.data.replace(_,w),this.style.updateImage(f,a),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return wt.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,a){return this.style.setLayerZoomRange(f,e,a),this._update(!0)}setFilter(f,e,a={}){return this.style.setFilter(f,e,a),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,a,l={}){return this.style.setPaintProperty(f,e,a,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,a,l={}){return this.style.setLayoutProperty(f,e,a,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,a,(l=>{l||this._update(!0)})),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,(a=>{a||this._update(!0)})),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=ue.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ue.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const d=this._controlContainer=ue.create("div","maplibregl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((_=>{g[_]=ue.create("div",`maplibregl-ctrl-${_} `,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,a){this._canvas.width=Math.floor(a*f),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!a){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new yl(a,this.transform),je.testSupport(a)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,a,l,d,g;const _=this._idleTriggered?this._fadeDuration:0,w=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let S=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,z=Ce.now();this.style.zoomHistory.update(I,z);const B=new c.F(I,{now:z,fadeDuration:_,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=B.crossFadingFactor();W===1&&W===this._crossFadingFactor||(S=!0,this._crossFadingFactor=W),this.style.update(B)}const T=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==w;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||T)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,_,this._crossSourceCollisions,T),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||S)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const M=this._sourcesDirty||this._styleDirty||this._placementDirty;return M||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||M||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),wt.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ue.remove(this._canvasContainer),ue.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,Ce.frame(this._frameRequest,(f=>{c.cw.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!c.cy(e)&&!(function(a){return a.message===uu})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return fr}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},E.MapMouseEvent=ki,E.MapTouchEvent=vl,E.MapWheelEvent=Wc,E.Marker=Tl,E.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},rc,f),this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),ue.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),ue.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=ue.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new xa(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ue.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const a=ue.create("button",f,this._container);return a.type="button",a.addEventListener("click",e),a}},E.Popup=class extends c.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&ue.remove(this._content),this._container&&(ue.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ue.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ue.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const _ of this.options.className.split(" "))this._container.classList.add(_);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=Cl(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const d=El(this.options.offset);if(!l){const _=this._container.offsetWidth,w=this._container.offsetHeight;let S;S=a.y+d.bottom.y<w?["top"]:a.y>this._map.transform.height-w?["bottom"]:[],a.x<_/2?S.push("left"):a.x>this._map.transform.width-_/2&&S.push("right"),l=S.length===0?"bottom":S.join("-")}let g=a.add(d[l]);this.options.subpixelPositioning||(g=g.round()),ue.setTransform(this._container,`${Hn[l]} translate(${g.x}px,${g.y}px)`),pr(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Na),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.S.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=f;l=a.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ue.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=ue.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Al);f&&f.focus()}},E.RasterDEMTileSource=nr,E.RasterTileSource=Ar,E.ScaleControl=class{constructor(f){this._onMove=()=>{Is(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Is(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},zs),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ue.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},E.ScrollZoomHandler=Co,E.Style=Dc,E.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=ue.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ue.create("button","maplibregl-ctrl-terrain",this._container),ue.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ue.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},E.TwoFingersTouchPitchHandler=Rs,E.TwoFingersTouchRotateHandler=Ku,E.TwoFingersTouchZoomHandler=Yu,E.TwoFingersTouchZoomRotateHandler=tc,E.VectorTileSource=qn,E.VideoSource=Ei,E.addSourceType=(f,e)=>c._(void 0,void 0,void 0,(function*(){if(na(f))throw new Error(`A source type called "${f}" already exists.`);((a,l)=>{ga[a]=l})(f,e)})),E.clearPrewarmedResources=function(){const f=rt;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(me),rt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},E.createTileMesh=Ec,E.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},E.getRTLTextPluginStatus=function(){return gr().getRTLTextPluginStatus()},E.getVersion=function(){return yu},E.getWorkerCount=function(){return Ze.workerCount},E.getWorkerUrl=function(){return c.a.WORKER_URL},E.importScriptInWorkers=function(f){return Zt().broadcast("IS",f)},E.prewarm=function(){Kt().acquire(me)},E.setMaxParallelImageRequests=function(f){c.a.MAX_PARALLEL_IMAGE_REQUESTS=f},E.setRTLTextPlugin=function(f,e){return gr().setRTLTextPlugin(f,e)},E.setWorkerCount=function(f){Ze.workerCount=f},E.setWorkerUrl=function(f){c.a.WORKER_URL=f}}));var ee=G;return ee}))})(Up)),Up.exports}var x_=v_();const b_=wg(x_);class w_{container=null;onAdd(U){const G=document.createElement("div");G.className="maplibregl-ctrl maplibregl-ctrl-group simple-zoom-ctrl",G.style.position="absolute",G.style.right="0px",G.style.transform="translateY(100%)",G.style.display="flex",G.style.flexDirection="column",G.style.gap="6px",G.style.background="rgba(255,255,255,0.9)",G.style.borderRadius="6px",G.style.padding="6px",G.style.boxShadow="0 1px 6px rgba(0,0,0,0.15)",G.style.userSelect="none";const k=(E,c)=>{const q=document.createElement("button");return q.innerText=E,q.title=E,q.style.width="24px",q.style.height="24px",q.style.display="flex",q.style.alignItems="center",q.style.justifyContent="center",q.style.border="none",q.style.background="transparent",q.style.cursor="pointer",q.style.fontSize="22px",q.onpointerdown=te=>te.stopPropagation(),q.onclick=c,q},Q=k("+",()=>U.easeTo({zoom:U.getZoom()+1})),ee=k("−",()=>U.easeTo({zoom:U.getZoom()-1}));return G.appendChild(Q),G.appendChild(ee),this.container=G,G}onRemove(){this.container?.parentNode?.removeChild(this.container),this.container=null}}function S_({mapContainerRef:R,callback:U}){const G=mt.useRef(null);return mt.useEffect(()=>{if(!G.current)return G.current=new b_.Map({container:R.current,style:"https://demotiles.maplibre.org/style.json",center:[43,43],zoom:3,attributionControl:!1}),G.current.addControl(new w_),G.current?.on("click",k=>{const Q=G.current?.queryRenderedFeatures(k.point,{layers:["countries-fill"]});if(Q?.length){const E=Q[0].properties?.NAME.toLowerCase();U(E)}}),()=>{G.current?.remove(),G.current=null}},[]),Ie.jsx("div",{ref:R,className:"w-full h-40"})}function Xp(R,U=[]){let G=[];function k(ee,E){const c=mt.createContext(E),q=G.length;G=[...G,E];const te=ze=>{const{scope:Ce,children:ue,...je}=ze,Ge=Ce?.[R]?.[q]||c,Ye=mt.useMemo(()=>je,Object.values(je));return Ie.jsx(Ge.Provider,{value:Ye,children:ue})};te.displayName=ee+"Provider";function Se(ze,Ce){const ue=Ce?.[R]?.[q]||c,je=mt.useContext(ue);if(je)return je;if(E!==void 0)return E;throw new Error(`\`${ze}\` must be used within \`${ee}\``)}return[te,Se]}const Q=()=>{const ee=G.map(E=>mt.createContext(E));return function(c){const q=c?.[R]||ee;return mt.useMemo(()=>({[`__scope${R}`]:{...c,[R]:q}}),[c,q])}};return Q.scopeName=R,[k,P_(Q,...U)]}function P_(...R){const U=R[0];if(R.length===1)return U;const G=()=>{const k=R.map(Q=>({useScope:Q(),scopeName:Q.scopeName}));return function(ee){const E=k.reduce((c,{useScope:q,scopeName:te})=>{const ze=q(ee)[`__scope${te}`];return{...c,...ze}},{});return mt.useMemo(()=>({[`__scope${U.scopeName}`]:E}),[E])}};return G.scopeName=U.scopeName,G}function C_(R){const U=R+"CollectionProvider",[G,k]=Xp(U),[Q,ee]=G(U,{collectionRef:{current:null},itemMap:new Map}),E=Ge=>{const{scope:Ye,children:We}=Ge,He=gi.useRef(null),nt=gi.useRef(new Map).current;return Ie.jsx(Q,{scope:Ye,itemMap:nt,collectionRef:He,children:We})};E.displayName=U;const c=R+"CollectionSlot",q=Wp(c),te=gi.forwardRef((Ge,Ye)=>{const{scope:We,children:He}=Ge,nt=ee(c,We),wt=kf(Ye,nt.collectionRef);return Ie.jsx(q,{ref:wt,children:He})});te.displayName=c;const Se=R+"CollectionItemSlot",ze="data-radix-collection-item",Ce=Wp(Se),ue=gi.forwardRef((Ge,Ye)=>{const{scope:We,children:He,...nt}=Ge,wt=gi.useRef(null),xt=kf(Ye,wt),Tt=ee(Se,We);return gi.useEffect(()=>(Tt.itemMap.set(wt,{ref:wt,...nt}),()=>void Tt.itemMap.delete(wt))),Ie.jsx(Ce,{[ze]:"",ref:xt,children:He})});ue.displayName=Se;function je(Ge){const Ye=ee(R+"CollectionConsumer",Ge);return gi.useCallback(()=>{const He=Ye.collectionRef.current;if(!He)return[];const nt=Array.from(He.querySelectorAll(`[${ze}]`));return Array.from(Ye.itemMap.values()).sort((Tt,It)=>nt.indexOf(Tt.ref.current)-nt.indexOf(It.ref.current))},[Ye.collectionRef,Ye.itemMap])}return[{Provider:E,Slot:te,ItemSlot:ue},je,k]}function Ng(R,U,{checkForDefaultPrevented:G=!0}={}){return function(Q){if(R?.(Q),G===!1||!Q.defaultPrevented)return U?.(Q)}}var Of=globalThis?.document?mt.useLayoutEffect:()=>{},T_=Sg[" useInsertionEffect ".trim().toString()]||Of;function zm({prop:R,defaultProp:U,onChange:G=()=>{},caller:k}){const[Q,ee,E]=A_({defaultProp:U,onChange:G}),c=R!==void 0,q=c?R:Q;{const Se=mt.useRef(R!==void 0);mt.useEffect(()=>{const ze=Se.current;ze!==c&&console.warn(`${k} is changing from ${ze?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),Se.current=c},[c,k])}const te=mt.useCallback(Se=>{if(c){const ze=E_(Se)?Se(R):Se;ze!==R&&E.current?.(ze)}else ee(Se)},[c,R,ee,E]);return[q,te]}function A_({defaultProp:R,onChange:U}){const[G,k]=mt.useState(R),Q=mt.useRef(G),ee=mt.useRef(U);return T_(()=>{ee.current=U},[U]),mt.useEffect(()=>{Q.current!==G&&(ee.current?.(G),Q.current=G)},[G,Q]),[G,k,ee]}function E_(R){return typeof R=="function"}Pg();var M_=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],zh=M_.reduce((R,U)=>{const G=Wp(`Primitive.${U}`),k=mt.forwardRef((Q,ee)=>{const{asChild:E,...c}=Q,q=E?G:U;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Ie.jsx(q,{...c,ref:ee})});return k.displayName=`Primitive.${U}`,{...R,[U]:k}},{});function R_(R,U){return mt.useReducer((G,k)=>U[G][k]??G,R)}var Ug=R=>{const{present:U,children:G}=R,k=D_(U),Q=typeof G=="function"?G({present:k.isPresent}):mt.Children.only(G),ee=kf(k.ref,z_(Q));return typeof G=="function"||k.isPresent?mt.cloneElement(Q,{ref:ee}):null};Ug.displayName="Presence";function D_(R){const[U,G]=mt.useState(),k=mt.useRef(null),Q=mt.useRef(R),ee=mt.useRef("none"),E=R?"mounted":"unmounted",[c,q]=R_(E,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return mt.useEffect(()=>{const te=Np(k.current);ee.current=c==="mounted"?te:"none"},[c]),Of(()=>{const te=k.current,Se=Q.current;if(Se!==R){const Ce=ee.current,ue=Np(te);R?q("MOUNT"):ue==="none"||te?.display==="none"?q("UNMOUNT"):q(Se&&Ce!==ue?"ANIMATION_OUT":"UNMOUNT"),Q.current=R}},[R,q]),Of(()=>{if(U){let te;const Se=U.ownerDocument.defaultView??window,ze=ue=>{const Ge=Np(k.current).includes(CSS.escape(ue.animationName));if(ue.target===U&&Ge&&(q("ANIMATION_END"),!Q.current)){const Ye=U.style.animationFillMode;U.style.animationFillMode="forwards",te=Se.setTimeout(()=>{U.style.animationFillMode==="forwards"&&(U.style.animationFillMode=Ye)})}},Ce=ue=>{ue.target===U&&(ee.current=Np(k.current))};return U.addEventListener("animationstart",Ce),U.addEventListener("animationcancel",ze),U.addEventListener("animationend",ze),()=>{Se.clearTimeout(te),U.removeEventListener("animationstart",Ce),U.removeEventListener("animationcancel",ze),U.removeEventListener("animationend",ze)}}else q("ANIMATION_END")},[U,q]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:mt.useCallback(te=>{k.current=te?getComputedStyle(te):null,G(te)},[])}}function Np(R){return R?.animationName||"none"}function z_(R){let U=Object.getOwnPropertyDescriptor(R.props,"ref")?.get,G=U&&"isReactWarning"in U&&U.isReactWarning;return G?R.ref:(U=Object.getOwnPropertyDescriptor(R,"ref")?.get,G=U&&"isReactWarning"in U&&U.isReactWarning,G?R.props.ref:R.props.ref||R.ref)}var I_=Sg[" useId ".trim().toString()]||(()=>{}),L_=0;function jg(R){const[U,G]=mt.useState(I_());return Of(()=>{G(k=>k??String(L_++))},[R]),U?`radix-${U}`:""}var Yp="Collapsible",[k_,Vg]=Xp(Yp),[O_,Im]=k_(Yp),Gg=mt.forwardRef((R,U)=>{const{__scopeCollapsible:G,open:k,defaultOpen:Q,disabled:ee,onOpenChange:E,...c}=R,[q,te]=zm({prop:k,defaultProp:Q??!1,onChange:E,caller:Yp});return Ie.jsx(O_,{scope:G,disabled:ee,contentId:jg(),open:q,onOpenToggle:mt.useCallback(()=>te(Se=>!Se),[te]),children:Ie.jsx(zh.div,{"data-state":km(q),"data-disabled":ee?"":void 0,...c,ref:U})})});Gg.displayName=Yp;var Wg="CollapsibleTrigger",Zg=mt.forwardRef((R,U)=>{const{__scopeCollapsible:G,...k}=R,Q=Im(Wg,G);return Ie.jsx(zh.button,{type:"button","aria-controls":Q.contentId,"aria-expanded":Q.open||!1,"data-state":km(Q.open),"data-disabled":Q.disabled?"":void 0,disabled:Q.disabled,...k,ref:U,onClick:Ng(R.onClick,Q.onOpenToggle)})});Zg.displayName=Wg;var Lm="CollapsibleContent",qg=mt.forwardRef((R,U)=>{const{forceMount:G,...k}=R,Q=Im(Lm,R.__scopeCollapsible);return Ie.jsx(Ug,{present:G||Q.open,children:({present:ee})=>Ie.jsx(B_,{...k,ref:U,present:ee})})});qg.displayName=Lm;var B_=mt.forwardRef((R,U)=>{const{__scopeCollapsible:G,present:k,children:Q,...ee}=R,E=Im(Lm,G),[c,q]=mt.useState(k),te=mt.useRef(null),Se=kf(U,te),ze=mt.useRef(0),Ce=ze.current,ue=mt.useRef(0),je=ue.current,Ge=E.open||c,Ye=mt.useRef(Ge),We=mt.useRef(void 0);return mt.useEffect(()=>{const He=requestAnimationFrame(()=>Ye.current=!1);return()=>cancelAnimationFrame(He)},[]),Of(()=>{const He=te.current;if(He){We.current=We.current||{transitionDuration:He.style.transitionDuration,animationName:He.style.animationName},He.style.transitionDuration="0s",He.style.animationName="none";const nt=He.getBoundingClientRect();ze.current=nt.height,ue.current=nt.width,Ye.current||(He.style.transitionDuration=We.current.transitionDuration,He.style.animationName=We.current.animationName),q(k)}},[E.open,k]),Ie.jsx(zh.div,{"data-state":km(E.open),"data-disabled":E.disabled?"":void 0,id:E.contentId,hidden:!Ge,...ee,ref:Se,style:{"--radix-collapsible-content-height":Ce?`${Ce}px`:void 0,"--radix-collapsible-content-width":je?`${je}px`:void 0,...R.style},children:Ge&&Q})});function km(R){return R?"open":"closed"}var F_=Gg,N_=Zg,U_=qg,j_=mt.createContext(void 0);function V_(R){const U=mt.useContext(j_);return R||U||"ltr"}var Js="Accordion",G_=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Om,W_,Z_]=C_(Js),[Kp]=Xp(Js,[Z_,Vg]),Bm=Vg(),Hg=gi.forwardRef((R,U)=>{const{type:G,...k}=R,Q=k,ee=k;return Ie.jsx(Om.Provider,{scope:R.__scopeAccordion,children:G==="multiple"?Ie.jsx(X_,{...ee,ref:U}):Ie.jsx($_,{...Q,ref:U})})});Hg.displayName=Js;var[$g,q_]=Kp(Js),[Xg,H_]=Kp(Js,{collapsible:!1}),$_=gi.forwardRef((R,U)=>{const{value:G,defaultValue:k,onValueChange:Q=()=>{},collapsible:ee=!1,...E}=R,[c,q]=zm({prop:G,defaultProp:k??"",onChange:Q,caller:Js});return Ie.jsx($g,{scope:R.__scopeAccordion,value:gi.useMemo(()=>c?[c]:[],[c]),onItemOpen:q,onItemClose:gi.useCallback(()=>ee&&q(""),[ee,q]),children:Ie.jsx(Xg,{scope:R.__scopeAccordion,collapsible:ee,children:Ie.jsx(Yg,{...E,ref:U})})})}),X_=gi.forwardRef((R,U)=>{const{value:G,defaultValue:k,onValueChange:Q=()=>{},...ee}=R,[E,c]=zm({prop:G,defaultProp:k??[],onChange:Q,caller:Js}),q=gi.useCallback(Se=>c((ze=[])=>[...ze,Se]),[c]),te=gi.useCallback(Se=>c((ze=[])=>ze.filter(Ce=>Ce!==Se)),[c]);return Ie.jsx($g,{scope:R.__scopeAccordion,value:E,onItemOpen:q,onItemClose:te,children:Ie.jsx(Xg,{scope:R.__scopeAccordion,collapsible:!0,children:Ie.jsx(Yg,{...ee,ref:U})})})}),[Y_,Qp]=Kp(Js),Yg=gi.forwardRef((R,U)=>{const{__scopeAccordion:G,disabled:k,dir:Q,orientation:ee="vertical",...E}=R,c=gi.useRef(null),q=kf(c,U),te=W_(G),ze=V_(Q)==="ltr",Ce=Ng(R.onKeyDown,ue=>{if(!G_.includes(ue.key))return;const je=ue.target,Ge=te().filter(ut=>!ut.ref.current?.disabled),Ye=Ge.findIndex(ut=>ut.ref.current===je),We=Ge.length;if(Ye===-1)return;ue.preventDefault();let He=Ye;const nt=0,wt=We-1,xt=()=>{He=Ye+1,He>wt&&(He=nt)},Tt=()=>{He=Ye-1,He<nt&&(He=wt)};switch(ue.key){case"Home":He=nt;break;case"End":He=wt;break;case"ArrowRight":ee==="horizontal"&&(ze?xt():Tt());break;case"ArrowDown":ee==="vertical"&&xt();break;case"ArrowLeft":ee==="horizontal"&&(ze?Tt():xt());break;case"ArrowUp":ee==="vertical"&&Tt();break}const It=He%We;Ge[It].ref.current?.focus()});return Ie.jsx(Y_,{scope:G,disabled:k,direction:Q,orientation:ee,children:Ie.jsx(Om.Slot,{scope:G,children:Ie.jsx(zh.div,{...E,"data-orientation":ee,ref:q,onKeyDown:k?void 0:Ce})})})}),Zp="AccordionItem",[K_,Fm]=Kp(Zp),Kg=gi.forwardRef((R,U)=>{const{__scopeAccordion:G,value:k,...Q}=R,ee=Qp(Zp,G),E=q_(Zp,G),c=Bm(G),q=jg(),te=k&&E.value.includes(k)||!1,Se=ee.disabled||R.disabled;return Ie.jsx(K_,{scope:G,open:te,disabled:Se,triggerId:q,children:Ie.jsx(F_,{"data-orientation":ee.orientation,"data-state":ry(te),...c,...Q,ref:U,disabled:Se,open:te,onOpenChange:ze=>{ze?E.onItemOpen(k):E.onItemClose(k)}})})});Kg.displayName=Zp;var Qg="AccordionHeader",Jg=gi.forwardRef((R,U)=>{const{__scopeAccordion:G,...k}=R,Q=Qp(Js,G),ee=Fm(Qg,G);return Ie.jsx(zh.h3,{"data-orientation":Q.orientation,"data-state":ry(ee.open),"data-disabled":ee.disabled?"":void 0,...k,ref:U})});Jg.displayName=Qg;var Am="AccordionTrigger",ey=gi.forwardRef((R,U)=>{const{__scopeAccordion:G,...k}=R,Q=Qp(Js,G),ee=Fm(Am,G),E=H_(Am,G),c=Bm(G);return Ie.jsx(Om.ItemSlot,{scope:G,children:Ie.jsx(N_,{"aria-disabled":ee.open&&!E.collapsible||void 0,"data-orientation":Q.orientation,id:ee.triggerId,...c,...k,ref:U})})});ey.displayName=Am;var ty="AccordionContent",ny=gi.forwardRef((R,U)=>{const{__scopeAccordion:G,...k}=R,Q=Qp(Js,G),ee=Fm(ty,G),E=Bm(G);return Ie.jsx(U_,{role:"region","aria-labelledby":ee.triggerId,"data-orientation":Q.orientation,...E,...k,ref:U,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...R.style}})});ny.displayName=ty;function ry(R){return R?"open":"closed"}var Q_=Hg,J_=Kg,e0=Jg,t0=ey,n0=ny;/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=R=>R.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i0=R=>R.replace(/^([A-Z])|[\s-_]+(\w)/g,(U,G,k)=>k?k.toUpperCase():G.toLowerCase()),dg=R=>{const U=i0(R);return U.charAt(0).toUpperCase()+U.slice(1)},iy=(...R)=>R.filter((U,G,k)=>!!U&&U.trim()!==""&&k.indexOf(U)===G).join(" ").trim(),a0=R=>{for(const U in R)if(U.startsWith("aria-")||U==="role"||U==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var o0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=mt.forwardRef(({color:R="currentColor",size:U=24,strokeWidth:G=2,absoluteStrokeWidth:k,className:Q="",children:ee,iconNode:E,...c},q)=>mt.createElement("svg",{ref:q,...o0,width:U,height:U,stroke:R,strokeWidth:k?Number(G)*24/Number(U):G,className:iy("lucide",Q),...!ee&&!a0(c)&&{"aria-hidden":"true"},...c},[...E.map(([te,Se])=>mt.createElement(te,Se)),...Array.isArray(ee)?ee:[ee]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=(R,U)=>{const G=mt.forwardRef(({className:k,...Q},ee)=>mt.createElement(s0,{ref:ee,iconNode:U,className:iy(`lucide-${r0(dg(R))}`,`lucide-${R}`,k),...Q}));return G.displayName=dg(R),G};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],u0=Nm("arrow-left",l0);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],h0=Nm("arrow-right",c0);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],f0=Nm("chevron-down",d0);function p0({...R}){return Ie.jsx(Q_,{"data-slot":"accordion",...R})}function xm({className:R,...U}){return Ie.jsx(J_,{"data-slot":"accordion-item",className:Ca("border-b last:border-b-0",R),...U})}function bm({className:R,children:U,...G}){return Ie.jsx(e0,{className:"flex",children:Ie.jsxs(t0,{"data-slot":"accordion-trigger",className:Ca("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",R),...G,children:[U,Ie.jsx(f0,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function wm({className:R,children:U,...G}){return Ie.jsx(n0,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...G,children:Ie.jsx("div",{className:Ca("pt-0 pb-4",R),children:U})})}function Sm(){return Ie.jsxs(p0,{type:"single",collapsible:!0,className:"w-full",defaultValue:"item-1",children:[Ie.jsxs(xm,{value:"item-1",children:[Ie.jsx(bm,{children:"What is this project?"}),Ie.jsxs(wm,{className:"flex flex-col gap-4 text-balance",children:[Ie.jsx("p",{children:"Every place hums with its own rhythm—some promise opportunity, others serenity, some quietly drain the soul."}),Ie.jsx("p",{children:"The art lies in discerning what truly matters when choosing where to root yourself."})]})]}),Ie.jsxs(xm,{value:"item-2",children:[Ie.jsx(bm,{children:"Shipping Details"}),Ie.jsxs(wm,{className:"flex flex-col gap-4 text-balance",children:[Ie.jsx("p",{children:"We offer worldwide shipping through trusted courier partners. Standard delivery takes 3-5 business days, while express shipping ensures delivery within 1-2 business days."}),Ie.jsx("p",{children:"All orders are carefully packaged and fully insured. Track your shipment in real-time through our dedicated tracking portal."})]})]}),Ie.jsxs(xm,{value:"item-3",children:[Ie.jsx(bm,{children:"Return Policy"}),Ie.jsxs(wm,{className:"flex flex-col gap-4 text-balance",children:[Ie.jsx("p",{children:"We stand behind our products with a comprehensive 30-day return policy. If you're not completely satisfied, simply return the item in its original condition."}),Ie.jsx("p",{children:"Our hassle-free return process includes free return shipping and full refunds processed within 48 hours of receiving the returned item."})]})]})]})}function jp({className:R,...U}){return Ie.jsx("div",{"data-slot":"card",className:Ca("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",R),...U})}function Vp({className:R,...U}){return Ie.jsx("div",{"data-slot":"card-header",className:Ca("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",R),...U})}function vd({className:R,...U}){return Ie.jsx("div",{"data-slot":"card-title",className:Ca("leading-none font-semibold",R),...U})}function Gp({className:R,...U}){return Ie.jsx("div",{"data-slot":"card-content",className:Ca("px-6",R),...U})}function ay({className:R,...U}){return Ie.jsx("div",{"data-slot":"card-footer",className:Ca("flex items-center px-6 [.border-t]:pt-6",R),...U})}function m0(R){return Object.prototype.toString.call(R)==="[object Object]"}function fg(R){return m0(R)||Array.isArray(R)}function g0(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Um(R,U){const G=Object.keys(R),k=Object.keys(U);if(G.length!==k.length)return!1;const Q=JSON.stringify(Object.keys(R.breakpoints||{})),ee=JSON.stringify(Object.keys(U.breakpoints||{}));return Q!==ee?!1:G.every(E=>{const c=R[E],q=U[E];return typeof c=="function"?`${c}`==`${q}`:!fg(c)||!fg(q)?c===q:Um(c,q)})}function pg(R){return R.concat().sort((U,G)=>U.name>G.name?1:-1).map(U=>U.options)}function y0(R,U){if(R.length!==U.length)return!1;const G=pg(R),k=pg(U);return G.every((Q,ee)=>{const E=k[ee];return Um(Q,E)})}function jm(R){return typeof R=="number"}function Em(R){return typeof R=="string"}function Jp(R){return typeof R=="boolean"}function mg(R){return Object.prototype.toString.call(R)==="[object Object]"}function Yr(R){return Math.abs(R)}function Vm(R){return Math.sign(R)}function Lf(R,U){return Yr(R-U)}function _0(R,U){if(R===0||U===0||Yr(R)<=Yr(U))return 0;const G=Lf(Yr(R),Yr(U));return Yr(G/R)}function v0(R){return Math.round(R*100)/100}function Bf(R){return Ff(R).map(Number)}function Qs(R){return R[jf(R)]}function jf(R){return Math.max(0,R.length-1)}function Gm(R,U){return U===jf(R)}function gg(R,U=0){return Array.from(Array(R),(G,k)=>U+k)}function Ff(R){return Object.keys(R)}function oy(R,U){return[R,U].reduce((G,k)=>(Ff(k).forEach(Q=>{const ee=G[Q],E=k[Q],c=mg(ee)&&mg(E);G[Q]=c?oy(ee,E):E}),G),{})}function Mm(R,U){return typeof U.MouseEvent<"u"&&R instanceof U.MouseEvent}function x0(R,U){const G={start:k,center:Q,end:ee};function k(){return 0}function Q(q){return ee(q)/2}function ee(q){return U-q}function E(q,te){return Em(R)?G[R](q):R(U,q,te)}return{measure:E}}function Nf(){let R=[];function U(Q,ee,E,c={passive:!0}){let q;if("addEventListener"in Q)Q.addEventListener(ee,E,c),q=()=>Q.removeEventListener(ee,E,c);else{const te=Q;te.addListener(E),q=()=>te.removeListener(E)}return R.push(q),k}function G(){R=R.filter(Q=>Q())}const k={add:U,clear:G};return k}function b0(R,U,G,k){const Q=Nf(),ee=1e3/60;let E=null,c=0,q=0;function te(){Q.add(R,"visibilitychange",()=>{R.hidden&&je()})}function Se(){ue(),Q.clear()}function ze(Ye){if(!q)return;E||(E=Ye,G(),G());const We=Ye-E;for(E=Ye,c+=We;c>=ee;)G(),c-=ee;const He=c/ee;k(He),q&&(q=U.requestAnimationFrame(ze))}function Ce(){q||(q=U.requestAnimationFrame(ze))}function ue(){U.cancelAnimationFrame(q),E=null,c=0,q=0}function je(){E=null,c=0}return{init:te,destroy:Se,start:Ce,stop:ue,update:G,render:k}}function w0(R,U){const G=U==="rtl",k=R==="y",Q=k?"y":"x",ee=k?"x":"y",E=!k&&G?-1:1,c=Se(),q=ze();function te(je){const{height:Ge,width:Ye}=je;return k?Ge:Ye}function Se(){return k?"top":G?"right":"left"}function ze(){return k?"bottom":G?"left":"right"}function Ce(je){return je*E}return{scroll:Q,cross:ee,startEdge:c,endEdge:q,measureSize:te,direction:Ce}}function Dh(R=0,U=0){const G=Yr(R-U);function k(te){return te<R}function Q(te){return te>U}function ee(te){return k(te)||Q(te)}function E(te){return ee(te)?k(te)?R:U:te}function c(te){return G?te-G*Math.ceil((te-U)/G):te}return{length:G,max:U,min:R,constrain:E,reachedAny:ee,reachedMax:Q,reachedMin:k,removeOffset:c}}function sy(R,U,G){const{constrain:k}=Dh(0,R),Q=R+1;let ee=E(U);function E(Ce){return G?Yr((Q+Ce)%Q):k(Ce)}function c(){return ee}function q(Ce){return ee=E(Ce),ze}function te(Ce){return Se().set(c()+Ce)}function Se(){return sy(R,c(),G)}const ze={get:c,set:q,add:te,clone:Se};return ze}function S0(R,U,G,k,Q,ee,E,c,q,te,Se,ze,Ce,ue,je,Ge,Ye,We,He){const{cross:nt,direction:wt}=R,xt=["INPUT","SELECT","TEXTAREA"],Tt={passive:!1},It=Nf(),ut=Nf(),Gt=Dh(50,225).constrain(ue.measure(20)),pn={mouse:300,touch:400},nn={mouse:500,touch:600},on=je?43:25;let jn=!1,er=0,mn=0,Ue=!1,ht=!1,tt=!1,At=!1;function me(vt){if(!He)return;function qt(qn){(Jp(He)||He(vt,qn))&&Dt(qn)}const un=U;It.add(un,"dragstart",qn=>qn.preventDefault(),Tt).add(un,"touchmove",()=>{},Tt).add(un,"touchend",()=>{}).add(un,"touchstart",qt).add(un,"mousedown",qt).add(un,"touchcancel",Vt).add(un,"contextmenu",Vt).add(un,"click",En,!0)}function Ze(){It.clear(),ut.clear()}function gt(){const vt=At?G:U;ut.add(vt,"touchmove",Zt,Tt).add(vt,"touchend",Vt).add(vt,"mousemove",Zt,Tt).add(vt,"mouseup",Vt)}function rt(vt){const qt=vt.nodeName||"";return xt.includes(qt)}function yt(){return(je?nn:pn)[At?"mouse":"touch"]}function Kt(vt,qt){const un=ze.add(Vm(vt)*-1),qn=Se.byDistance(vt,!je).distance;return je||Yr(vt)<Gt?qn:Ye&&qt?qn*.5:Se.byIndex(un.get(),0).distance}function Dt(vt){const qt=Mm(vt,k);At=qt,tt=je&&qt&&!vt.buttons&&jn,jn=Lf(Q.get(),E.get())>=2,!(qt&&vt.button!==0)&&(rt(vt.target)||(Ue=!0,ee.pointerDown(vt),te.useFriction(0).useDuration(0),Q.set(E),gt(),er=ee.readPoint(vt),mn=ee.readPoint(vt,nt),Ce.emit("pointerDown")))}function Zt(vt){if(!Mm(vt,k)&&vt.touches.length>=2)return Vt(vt);const un=ee.readPoint(vt),qn=ee.readPoint(vt,nt),Ar=Lf(un,er),nr=Lf(qn,mn);if(!ht&&!At&&(!vt.cancelable||(ht=Ar>nr,!ht)))return Vt(vt);const Kr=ee.pointerMove(vt);Ar>Ge&&(tt=!0),te.useFriction(.3).useDuration(.75),c.start(),Q.add(wt(Kr)),vt.preventDefault()}function Vt(vt){const un=Se.byDistance(0,!1).index!==ze.get(),qn=ee.pointerUp(vt)*yt(),Ar=Kt(wt(qn),un),nr=_0(qn,Ar),Kr=on-10*nr,Br=We+nr/50;ht=!1,Ue=!1,ut.clear(),te.useDuration(Kr).useFriction(Br),q.distance(Ar,!je),At=!1,Ce.emit("pointerUp")}function En(vt){tt&&(vt.stopPropagation(),vt.preventDefault(),tt=!1)}function tr(){return Ue}return{init:me,destroy:Ze,pointerDown:tr}}function P0(R,U){let k,Q;function ee(ze){return ze.timeStamp}function E(ze,Ce){const je=`client${(Ce||R.scroll)==="x"?"X":"Y"}`;return(Mm(ze,U)?ze:ze.touches[0])[je]}function c(ze){return k=ze,Q=ze,E(ze)}function q(ze){const Ce=E(ze)-E(Q),ue=ee(ze)-ee(k)>170;return Q=ze,ue&&(k=ze),Ce}function te(ze){if(!k||!Q)return 0;const Ce=E(Q)-E(k),ue=ee(ze)-ee(k),je=ee(ze)-ee(Q)>170,Ge=Ce/ue;return ue&&!je&&Yr(Ge)>.1?Ge:0}return{pointerDown:c,pointerMove:q,pointerUp:te,readPoint:E}}function C0(){function R(G){const{offsetTop:k,offsetLeft:Q,offsetWidth:ee,offsetHeight:E}=G;return{top:k,right:Q+ee,bottom:k+E,left:Q,width:ee,height:E}}return{measure:R}}function T0(R){function U(k){return R*(k/100)}return{measure:U}}function A0(R,U,G,k,Q,ee,E){const c=[R].concat(k);let q,te,Se=[],ze=!1;function Ce(Ye){return Q.measureSize(E.measure(Ye))}function ue(Ye){if(!ee)return;te=Ce(R),Se=k.map(Ce);function We(He){for(const nt of He){if(ze)return;const wt=nt.target===R,xt=k.indexOf(nt.target),Tt=wt?te:Se[xt],It=Ce(wt?R:k[xt]);if(Yr(It-Tt)>=.5){Ye.reInit(),U.emit("resize");break}}}q=new ResizeObserver(He=>{(Jp(ee)||ee(Ye,He))&&We(He)}),G.requestAnimationFrame(()=>{c.forEach(He=>q.observe(He))})}function je(){ze=!0,q&&q.disconnect()}return{init:ue,destroy:je}}function E0(R,U,G,k,Q,ee){let E=0,c=0,q=Q,te=ee,Se=R.get(),ze=0;function Ce(){const Tt=k.get()-R.get(),It=!q;let ut=0;return It?(E=0,G.set(k),R.set(k),ut=Tt):(G.set(R),E+=Tt/q,E*=te,Se+=E,R.add(E),ut=Se-ze),c=Vm(ut),ze=Se,xt}function ue(){const Tt=k.get()-U.get();return Yr(Tt)<.001}function je(){return q}function Ge(){return c}function Ye(){return E}function We(){return nt(Q)}function He(){return wt(ee)}function nt(Tt){return q=Tt,xt}function wt(Tt){return te=Tt,xt}const xt={direction:Ge,duration:je,velocity:Ye,seek:Ce,settled:ue,useBaseFriction:He,useBaseDuration:We,useFriction:wt,useDuration:nt};return xt}function M0(R,U,G,k,Q){const ee=Q.measure(10),E=Q.measure(50),c=Dh(.1,.99);let q=!1;function te(){return!(q||!R.reachedAny(G.get())||!R.reachedAny(U.get()))}function Se(ue){if(!te())return;const je=R.reachedMin(U.get())?"min":"max",Ge=Yr(R[je]-U.get()),Ye=G.get()-U.get(),We=c.constrain(Ge/E);G.subtract(Ye*We),!ue&&Yr(Ye)<ee&&(G.set(R.constrain(G.get())),k.useDuration(25).useBaseFriction())}function ze(ue){q=!ue}return{shouldConstrain:te,constrain:Se,toggleActive:ze}}function R0(R,U,G,k,Q){const ee=Dh(-U+R,0),E=ze(),c=Se(),q=Ce();function te(je,Ge){return Lf(je,Ge)<=1}function Se(){const je=E[0],Ge=Qs(E),Ye=E.lastIndexOf(je),We=E.indexOf(Ge)+1;return Dh(Ye,We)}function ze(){return G.map((je,Ge)=>{const{min:Ye,max:We}=ee,He=ee.constrain(je),nt=!Ge,wt=Gm(G,Ge);return nt?We:wt||te(Ye,He)?Ye:te(We,He)?We:He}).map(je=>parseFloat(je.toFixed(3)))}function Ce(){if(U<=R+Q)return[ee.max];if(k==="keepSnaps")return E;const{min:je,max:Ge}=c;return E.slice(je,Ge)}return{snapsContained:q,scrollContainLimit:c}}function D0(R,U,G){const k=U[0],Q=G?k-R:Qs(U);return{limit:Dh(Q,k)}}function z0(R,U,G,k){const ee=U.min+.1,E=U.max+.1,{reachedMin:c,reachedMax:q}=Dh(ee,E);function te(Ce){return Ce===1?q(G.get()):Ce===-1?c(G.get()):!1}function Se(Ce){if(!te(Ce))return;const ue=R*(Ce*-1);k.forEach(je=>je.add(ue))}return{loop:Se}}function I0(R){const{max:U,length:G}=R;function k(ee){const E=ee-U;return G?E/-G:0}return{get:k}}function L0(R,U,G,k,Q){const{startEdge:ee,endEdge:E}=R,{groupSlides:c}=Q,q=ze().map(U.measure),te=Ce(),Se=ue();function ze(){return c(k).map(Ge=>Qs(Ge)[E]-Ge[0][ee]).map(Yr)}function Ce(){return k.map(Ge=>G[ee]-Ge[ee]).map(Ge=>-Yr(Ge))}function ue(){return c(te).map(Ge=>Ge[0]).map((Ge,Ye)=>Ge+q[Ye])}return{snaps:te,snapsAligned:Se}}function k0(R,U,G,k,Q,ee){const{groupSlides:E}=Q,{min:c,max:q}=k,te=Se();function Se(){const Ce=E(ee),ue=!R||U==="keepSnaps";return G.length===1?[ee]:ue?Ce:Ce.slice(c,q).map((je,Ge,Ye)=>{const We=!Ge,He=Gm(Ye,Ge);if(We){const nt=Qs(Ye[0])+1;return gg(nt)}if(He){const nt=jf(ee)-Qs(Ye)[0]+1;return gg(nt,Qs(Ye)[0])}return je})}return{slideRegistry:te}}function O0(R,U,G,k,Q){const{reachedAny:ee,removeOffset:E,constrain:c}=k;function q(je){return je.concat().sort((Ge,Ye)=>Yr(Ge)-Yr(Ye))[0]}function te(je){const Ge=R?E(je):c(je),Ye=U.map((He,nt)=>({diff:Se(He-Ge,0),index:nt})).sort((He,nt)=>Yr(He.diff)-Yr(nt.diff)),{index:We}=Ye[0];return{index:We,distance:Ge}}function Se(je,Ge){const Ye=[je,je+G,je-G];if(!R)return je;if(!Ge)return q(Ye);const We=Ye.filter(He=>Vm(He)===Ge);return We.length?q(We):Qs(Ye)-G}function ze(je,Ge){const Ye=U[je]-Q.get(),We=Se(Ye,Ge);return{index:je,distance:We}}function Ce(je,Ge){const Ye=Q.get()+je,{index:We,distance:He}=te(Ye),nt=!R&&ee(Ye);if(!Ge||nt)return{index:We,distance:je};const wt=U[We]-He,xt=je+Se(wt,0);return{index:We,distance:xt}}return{byDistance:Ce,byIndex:ze,shortcut:Se}}function B0(R,U,G,k,Q,ee,E){function c(ze){const Ce=ze.distance,ue=ze.index!==U.get();ee.add(Ce),Ce&&(k.duration()?R.start():(R.update(),R.render(1),R.update())),ue&&(G.set(U.get()),U.set(ze.index),E.emit("select"))}function q(ze,Ce){const ue=Q.byDistance(ze,Ce);c(ue)}function te(ze,Ce){const ue=U.clone().set(ze),je=Q.byIndex(ue.get(),Ce);c(je)}return{distance:q,index:te}}function F0(R,U,G,k,Q,ee,E,c){const q={passive:!0,capture:!0};let te=0;function Se(ue){if(!c)return;function je(Ge){if(new Date().getTime()-te>10)return;E.emit("slideFocusStart"),R.scrollLeft=0;const He=G.findIndex(nt=>nt.includes(Ge));jm(He)&&(Q.useDuration(0),k.index(He,0),E.emit("slideFocus"))}ee.add(document,"keydown",ze,!1),U.forEach((Ge,Ye)=>{ee.add(Ge,"focus",We=>{(Jp(c)||c(ue,We))&&je(Ye)},q)})}function ze(ue){ue.code==="Tab"&&(te=new Date().getTime())}return{init:Se}}function If(R){let U=R;function G(){return U}function k(q){U=E(q)}function Q(q){U+=E(q)}function ee(q){U-=E(q)}function E(q){return jm(q)?q:q.get()}return{get:G,set:k,add:Q,subtract:ee}}function ly(R,U){const G=R.scroll==="x"?E:c,k=U.style;let Q=null,ee=!1;function E(Ce){return`translate3d(${Ce}px,0px,0px)`}function c(Ce){return`translate3d(0px,${Ce}px,0px)`}function q(Ce){if(ee)return;const ue=v0(R.direction(Ce));ue!==Q&&(k.transform=G(ue),Q=ue)}function te(Ce){ee=!Ce}function Se(){ee||(k.transform="",U.getAttribute("style")||U.removeAttribute("style"))}return{clear:Se,to:q,toggleActive:te}}function N0(R,U,G,k,Q,ee,E,c,q){const Se=Bf(Q),ze=Bf(Q).reverse(),Ce=We().concat(He());function ue(It,ut){return It.reduce((Gt,pn)=>Gt-Q[pn],ut)}function je(It,ut){return It.reduce((Gt,pn)=>ue(Gt,ut)>0?Gt.concat([pn]):Gt,[])}function Ge(It){return ee.map((ut,Gt)=>({start:ut-k[Gt]+.5+It,end:ut+U-.5+It}))}function Ye(It,ut,Gt){const pn=Ge(ut);return It.map(nn=>{const on=Gt?0:-G,jn=Gt?G:0,er=Gt?"end":"start",mn=pn[nn][er];return{index:nn,loopPoint:mn,slideLocation:If(-1),translate:ly(R,q[nn]),target:()=>c.get()>mn?on:jn}})}function We(){const It=E[0],ut=je(ze,It);return Ye(ut,G,!1)}function He(){const It=U-E[0]-1,ut=je(Se,It);return Ye(ut,-G,!0)}function nt(){return Ce.every(({index:It})=>{const ut=Se.filter(Gt=>Gt!==It);return ue(ut,U)<=.1})}function wt(){Ce.forEach(It=>{const{target:ut,translate:Gt,slideLocation:pn}=It,nn=ut();nn!==pn.get()&&(Gt.to(nn),pn.set(nn))})}function xt(){Ce.forEach(It=>It.translate.clear())}return{canLoop:nt,clear:xt,loop:wt,loopPoints:Ce}}function U0(R,U,G){let k,Q=!1;function ee(q){if(!G)return;function te(Se){for(const ze of Se)if(ze.type==="childList"){q.reInit(),U.emit("slidesChanged");break}}k=new MutationObserver(Se=>{Q||(Jp(G)||G(q,Se))&&te(Se)}),k.observe(R,{childList:!0})}function E(){k&&k.disconnect(),Q=!0}return{init:ee,destroy:E}}function j0(R,U,G,k){const Q={};let ee=null,E=null,c,q=!1;function te(){c=new IntersectionObserver(je=>{q||(je.forEach(Ge=>{const Ye=U.indexOf(Ge.target);Q[Ye]=Ge}),ee=null,E=null,G.emit("slidesInView"))},{root:R.parentElement,threshold:k}),U.forEach(je=>c.observe(je))}function Se(){c&&c.disconnect(),q=!0}function ze(je){return Ff(Q).reduce((Ge,Ye)=>{const We=parseInt(Ye),{isIntersecting:He}=Q[We];return(je&&He||!je&&!He)&&Ge.push(We),Ge},[])}function Ce(je=!0){if(je&&ee)return ee;if(!je&&E)return E;const Ge=ze(je);return je&&(ee=Ge),je||(E=Ge),Ge}return{init:te,destroy:Se,get:Ce}}function V0(R,U,G,k,Q,ee){const{measureSize:E,startEdge:c,endEdge:q}=R,te=G[0]&&Q,Se=je(),ze=Ge(),Ce=G.map(E),ue=Ye();function je(){if(!te)return 0;const He=G[0];return Yr(U[c]-He[c])}function Ge(){if(!te)return 0;const He=ee.getComputedStyle(Qs(k));return parseFloat(He.getPropertyValue(`margin-${q}`))}function Ye(){return G.map((He,nt,wt)=>{const xt=!nt,Tt=Gm(wt,nt);return xt?Ce[nt]+Se:Tt?Ce[nt]+ze:wt[nt+1][c]-He[c]}).map(Yr)}return{slideSizes:Ce,slideSizesWithGaps:ue,startGap:Se,endGap:ze}}function G0(R,U,G,k,Q,ee,E,c,q){const{startEdge:te,endEdge:Se,direction:ze}=R,Ce=jm(G);function ue(We,He){return Bf(We).filter(nt=>nt%He===0).map(nt=>We.slice(nt,nt+He))}function je(We){return We.length?Bf(We).reduce((He,nt,wt)=>{const xt=Qs(He)||0,Tt=xt===0,It=nt===jf(We),ut=Q[te]-ee[xt][te],Gt=Q[te]-ee[nt][Se],pn=!k&&Tt?ze(E):0,nn=!k&&It?ze(c):0,on=Yr(Gt-nn-(ut+pn));return wt&&on>U+q&&He.push(nt),It&&He.push(We.length),He},[]).map((He,nt,wt)=>{const xt=Math.max(wt[nt-1]||0);return We.slice(xt,He)}):[]}function Ge(We){return Ce?ue(We,G):je(We)}return{groupSlides:Ge}}function W0(R,U,G,k,Q,ee,E){const{align:c,axis:q,direction:te,startIndex:Se,loop:ze,duration:Ce,dragFree:ue,dragThreshold:je,inViewThreshold:Ge,slidesToScroll:Ye,skipSnaps:We,containScroll:He,watchResize:nt,watchSlides:wt,watchDrag:xt,watchFocus:Tt}=ee,It=2,ut=C0(),Gt=ut.measure(U),pn=G.map(ut.measure),nn=w0(q,te),on=nn.measureSize(Gt),jn=T0(on),er=x0(c,on),mn=!ze&&!!He,Ue=ze||!!He,{slideSizes:ht,slideSizesWithGaps:tt,startGap:At,endGap:me}=V0(nn,Gt,pn,G,Ue,Q),Ze=G0(nn,on,Ye,ze,Gt,pn,At,me,It),{snaps:gt,snapsAligned:rt}=L0(nn,er,Gt,pn,Ze),yt=-Qs(gt)+Qs(tt),{snapsContained:Kt,scrollContainLimit:Dt}=R0(on,yt,rt,He,It),Zt=mn?Kt:rt,{limit:Vt}=D0(yt,Zt,ze),En=sy(jf(Zt),Se,ze),tr=En.clone(),xn=Bf(G),vt=({dragHandler:j,scrollBody:V,scrollBounds:$,options:{loop:oe}})=>{oe||$.constrain(j.pointerDown()),V.seek()},qt=({scrollBody:j,translate:V,location:$,offsetLocation:oe,previousLocation:he,scrollLooper:ye,slideLooper:Me,dragHandler:ve,animation:Ne,eventHandler:et,scrollBounds:qe,options:{loop:bt}},xe)=>{const Wt=j.settled(),hn=!qe.shouldConstrain(),Mt=bt?Wt:Wt&&hn,Ht=Mt&&!ve.pointerDown();Ht&&Ne.stop();const zn=$.get()*xe+he.get()*(1-xe);oe.set(zn),bt&&(ye.loop(j.direction()),Me.loop()),V.to(oe.get()),Ht&&et.emit("settle"),Mt||et.emit("scroll")},un=b0(k,Q,()=>vt(ge),j=>qt(ge,j)),qn=.68,Ar=Zt[En.get()],nr=If(Ar),Kr=If(Ar),Br=If(Ar),Ei=If(Ar),oi=E0(nr,Br,Kr,Ei,Ce,qn),ga=O0(ze,Zt,yt,Vt,Ei),na=B0(un,En,tr,oi,ga,Ei,E),Za=I0(Vt),Ta=Nf(),qi=j0(U,G,E,Ge),{slideRegistry:gr}=k0(mn,He,Zt,Dt,Ze,xn),Mi=F0(R,G,gr,na,oi,Ta,E,Tt),ge={ownerDocument:k,ownerWindow:Q,eventHandler:E,containerRect:Gt,slideRects:pn,animation:un,axis:nn,dragHandler:S0(nn,R,k,Q,Ei,P0(nn,Q),nr,un,na,oi,ga,En,E,jn,ue,je,We,qn,xt),eventStore:Ta,percentOfView:jn,index:En,indexPrevious:tr,limit:Vt,location:nr,offsetLocation:Br,previousLocation:Kr,options:ee,resizeHandler:A0(U,E,Q,G,nn,nt,ut),scrollBody:oi,scrollBounds:M0(Vt,Br,Ei,oi,jn),scrollLooper:z0(yt,Vt,Br,[nr,Br,Kr,Ei]),scrollProgress:Za,scrollSnapList:Zt.map(Za.get),scrollSnaps:Zt,scrollTarget:ga,scrollTo:na,slideLooper:N0(nn,on,yt,ht,tt,gt,Zt,Br,G),slideFocus:Mi,slidesHandler:U0(U,E,wt),slidesInView:qi,slideIndexes:xn,slideRegistry:gr,slidesToScroll:Ze,target:Ei,translate:ly(nn,U)};return ge}function Z0(){let R={},U;function G(te){U=te}function k(te){return R[te]||[]}function Q(te){return k(te).forEach(Se=>Se(U,te)),q}function ee(te,Se){return R[te]=k(te).concat([Se]),q}function E(te,Se){return R[te]=k(te).filter(ze=>ze!==Se),q}function c(){R={}}const q={init:G,emit:Q,off:E,on:ee,clear:c};return q}const q0={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function H0(R){function U(ee,E){return oy(ee,E||{})}function G(ee){const E=ee.breakpoints||{},c=Ff(E).filter(q=>R.matchMedia(q).matches).map(q=>E[q]).reduce((q,te)=>U(q,te),{});return U(ee,c)}function k(ee){return ee.map(E=>Ff(E.breakpoints||{})).reduce((E,c)=>E.concat(c),[]).map(R.matchMedia)}return{mergeOptions:U,optionsAtMedia:G,optionsMediaQueries:k}}function $0(R){let U=[];function G(ee,E){return U=E.filter(({options:c})=>R.optionsAtMedia(c).active!==!1),U.forEach(c=>c.init(ee,R)),E.reduce((c,q)=>Object.assign(c,{[q.name]:q}),{})}function k(){U=U.filter(ee=>ee.destroy())}return{init:G,destroy:k}}function qp(R,U,G){const k=R.ownerDocument,Q=k.defaultView,ee=H0(Q),E=$0(ee),c=Nf(),q=Z0(),{mergeOptions:te,optionsAtMedia:Se,optionsMediaQueries:ze}=ee,{on:Ce,off:ue,emit:je}=q,Ge=nn;let Ye=!1,We,He=te(q0,qp.globalOptions),nt=te(He),wt=[],xt,Tt,It;function ut(){const{container:xn,slides:vt}=nt;Tt=(Em(xn)?R.querySelector(xn):xn)||R.children[0];const un=Em(vt)?Tt.querySelectorAll(vt):vt;It=[].slice.call(un||Tt.children)}function Gt(xn){const vt=W0(R,Tt,It,k,Q,xn,q);if(xn.loop&&!vt.slideLooper.canLoop()){const qt=Object.assign({},xn,{loop:!1});return Gt(qt)}return vt}function pn(xn,vt){Ye||(He=te(He,xn),nt=Se(He),wt=vt||wt,ut(),We=Gt(nt),ze([He,...wt.map(({options:qt})=>qt)]).forEach(qt=>c.add(qt,"change",nn)),nt.active&&(We.translate.to(We.location.get()),We.animation.init(),We.slidesInView.init(),We.slideFocus.init(tr),We.eventHandler.init(tr),We.resizeHandler.init(tr),We.slidesHandler.init(tr),We.options.loop&&We.slideLooper.loop(),Tt.offsetParent&&It.length&&We.dragHandler.init(tr),xt=E.init(tr,wt)))}function nn(xn,vt){const qt=Ze();on(),pn(te({startIndex:qt},xn),vt),q.emit("reInit")}function on(){We.dragHandler.destroy(),We.eventStore.clear(),We.translate.clear(),We.slideLooper.clear(),We.resizeHandler.destroy(),We.slidesHandler.destroy(),We.slidesInView.destroy(),We.animation.destroy(),E.destroy(),c.clear()}function jn(){Ye||(Ye=!0,c.clear(),on(),q.emit("destroy"),q.clear())}function er(xn,vt,qt){!nt.active||Ye||(We.scrollBody.useBaseFriction().useDuration(vt===!0?0:nt.duration),We.scrollTo.index(xn,qt||0))}function mn(xn){const vt=We.index.add(1).get();er(vt,xn,-1)}function Ue(xn){const vt=We.index.add(-1).get();er(vt,xn,1)}function ht(){return We.index.add(1).get()!==Ze()}function tt(){return We.index.add(-1).get()!==Ze()}function At(){return We.scrollSnapList}function me(){return We.scrollProgress.get(We.offsetLocation.get())}function Ze(){return We.index.get()}function gt(){return We.indexPrevious.get()}function rt(){return We.slidesInView.get()}function yt(){return We.slidesInView.get(!1)}function Kt(){return xt}function Dt(){return We}function Zt(){return R}function Vt(){return Tt}function En(){return It}const tr={canScrollNext:ht,canScrollPrev:tt,containerNode:Vt,internalEngine:Dt,destroy:jn,off:ue,on:Ce,emit:je,plugins:Kt,previousScrollSnap:gt,reInit:Ge,rootNode:Zt,scrollNext:mn,scrollPrev:Ue,scrollProgress:me,scrollSnapList:At,scrollTo:er,selectedScrollSnap:Ze,slideNodes:En,slidesInView:rt,slidesNotInView:yt};return pn(U,G),setTimeout(()=>q.emit("init"),0),tr}qp.globalOptions=void 0;function Wm(R={},U=[]){const G=mt.useRef(R),k=mt.useRef(U),[Q,ee]=mt.useState(),[E,c]=mt.useState(),q=mt.useCallback(()=>{Q&&Q.reInit(G.current,k.current)},[Q]);return mt.useEffect(()=>{Um(G.current,R)||(G.current=R,q())},[R,q]),mt.useEffect(()=>{y0(k.current,U)||(k.current=U,q())},[U,q]),mt.useEffect(()=>{if(g0()&&E){qp.globalOptions=Wm.globalOptions;const te=qp(E,G.current,k.current);return ee(te),()=>te.destroy()}else ee(void 0)},[E,ee]),[c,Q]}Wm.globalOptions=void 0;const uy=mt.createContext(null);function em(){const R=mt.useContext(uy);if(!R)throw new Error("useCarousel must be used within a <Carousel />");return R}function X0({orientation:R="horizontal",opts:U,setApi:G,plugins:k,className:Q,children:ee,...E}){const[c,q]=Wm({...U,axis:R==="horizontal"?"x":"y"},k),[te,Se]=mt.useState(!1),[ze,Ce]=mt.useState(!1),ue=mt.useCallback(We=>{We&&(Se(We.canScrollPrev()),Ce(We.canScrollNext()))},[]),je=mt.useCallback(()=>{q?.scrollPrev()},[q]),Ge=mt.useCallback(()=>{q?.scrollNext()},[q]),Ye=mt.useCallback(We=>{We.key==="ArrowLeft"?(We.preventDefault(),je()):We.key==="ArrowRight"&&(We.preventDefault(),Ge())},[je,Ge]);return mt.useEffect(()=>{!q||!G||G(q)},[q,G]),mt.useEffect(()=>{if(q)return ue(q),q.on("reInit",ue),q.on("select",ue),()=>{q?.off("select",ue)}},[q,ue]),Ie.jsx(uy.Provider,{value:{carouselRef:c,api:q,opts:U,orientation:R||(U?.axis==="y"?"vertical":"horizontal"),scrollPrev:je,scrollNext:Ge,canScrollPrev:te,canScrollNext:ze},children:Ie.jsx("div",{onKeyDownCapture:Ye,className:Ca("relative",Q),role:"region","aria-roledescription":"carousel","data-slot":"carousel",...E,children:ee})})}function Y0({className:R,...U}){const{carouselRef:G,orientation:k}=em();return Ie.jsx("div",{ref:G,className:"overflow-hidden","data-slot":"carousel-content",children:Ie.jsx("div",{className:Ca("flex",k==="horizontal"?"-ml-4":"-mt-4 flex-col",R),...U})})}function K0({className:R,...U}){const{orientation:G}=em();return Ie.jsx("div",{role:"group","aria-roledescription":"slide","data-slot":"carousel-item",className:Ca("min-w-0 shrink-0 grow-0 basis-full",G==="horizontal"?"pl-4":"pt-4",R),...U})}function Q0({className:R,variant:U="outline",size:G="icon",...k}){const{orientation:Q,scrollPrev:ee,canScrollPrev:E}=em();return Ie.jsxs(Uf,{"data-slot":"carousel-previous",variant:U,size:G,className:Ca("absolute size-8 rounded-full",Q==="horizontal"?"top-1/2 -left-12 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",R),disabled:!E,onClick:ee,...k,children:[Ie.jsx(u0,{}),Ie.jsx("span",{className:"sr-only",children:"Previous slide"})]})}function J0({className:R,variant:U="outline",size:G="icon",...k}){const{orientation:Q,scrollNext:ee,canScrollNext:E}=em();return Ie.jsxs(Uf,{"data-slot":"carousel-next",variant:U,size:G,className:Ca("absolute size-8 rounded-full",Q==="horizontal"?"top-1/2 -right-12 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",R),disabled:!E,onClick:ee,...k,children:[Ie.jsx(h0,{}),Ie.jsx("span",{className:"sr-only",children:"Next slide"})]})}var Zm="Progress",qm=100,[ev]=Xp(Zm),[tv,nv]=ev(Zm),cy=mt.forwardRef((R,U)=>{const{__scopeProgress:G,value:k=null,max:Q,getValueLabel:ee=rv,...E}=R;(Q||Q===0)&&!yg(Q)&&console.error(iv(`${Q}`,"Progress"));const c=yg(Q)?Q:qm;k!==null&&!_g(k,c)&&console.error(av(`${k}`,"Progress"));const q=_g(k,c)?k:null,te=Hp(q)?ee(q,c):void 0;return Ie.jsx(tv,{scope:G,value:q,max:c,children:Ie.jsx(zh.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Hp(q)?q:void 0,"aria-valuetext":te,role:"progressbar","data-state":fy(q,c),"data-value":q??void 0,"data-max":c,...E,ref:U})})});cy.displayName=Zm;var hy="ProgressIndicator",dy=mt.forwardRef((R,U)=>{const{__scopeProgress:G,...k}=R,Q=nv(hy,G);return Ie.jsx(zh.div,{"data-state":fy(Q.value,Q.max),"data-value":Q.value??void 0,"data-max":Q.max,...k,ref:U})});dy.displayName=hy;function rv(R,U){return`${Math.round(R/U*100)}%`}function fy(R,U){return R==null?"indeterminate":R===U?"complete":"loading"}function Hp(R){return typeof R=="number"}function yg(R){return Hp(R)&&!isNaN(R)&&R>0}function _g(R,U){return Hp(R)&&!isNaN(R)&&R<=U&&R>=0}function iv(R,U){return`Invalid prop \`max\` of value \`${R}\` supplied to \`${U}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${qm}\`.`}function av(R,U){return`Invalid prop \`value\` of value \`${R}\` supplied to \`${U}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${qm} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var ov=cy,sv=dy;function $p({className:R,value:U,...G}){return Ie.jsx(ov,{"data-slot":"progress",className:Ca("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",R),...G,children:Ie.jsx(sv,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(U||0)}%)`}})})}function vg(R){return R.toLowerCase().split(" ").map(U=>U.charAt(0).toUpperCase()+U.slice(1)).join(" ")}function xg({countryName:R,happiness:U}){return Ie.jsxs(X0,{className:"w-2/3 max-w-xs",opts:{loop:!0},children:[Ie.jsx(Y0,{children:Array.from({length:3}).map((G,k)=>Ie.jsx(K0,{children:Ie.jsx("div",{className:"p-1",children:Ie.jsxs(jp,{className:"bg-accent",children:[Ie.jsxs(Vp,{children:[k===0&&Ie.jsx(vd,{children:"Happy Countries"}),k===1&&Ie.jsx(vd,{children:"Strengths"}),k===2&&Ie.jsx(vd,{children:"Weaknesses"})]}),Ie.jsxs(Gp,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:[k===0?Ie.jsxs(Ie.Fragment,{children:[U&&Ie.jsxs(Ie.Fragment,{children:[Ie.jsxs("p",{children:[vg(R)," has the happiness rate of"," ",U]}),U?Ie.jsx($p,{value:U*10,className:"mb-5"}):Ie.jsx($p,{value:0,className:"mb-5"})]}),!U&&Ie.jsx(Ie.Fragment,{children:R?Ie.jsxs("p",{children:["No data for ",vg(R)]}):Ie.jsx("p",{children:"Click on the map to see happiness data!"})})]}):Ie.jsx(Ie.Fragment,{}),k===1&&Ie.jsx("p",{children:"+15% from expected"}),k===2&&Ie.jsx("p",{children:"-15% from expected"})]}),k===0?Ie.jsx(ay,{className:"mt-auto flex-col gap-2",children:Ie.jsx(Uf,{type:"submit",className:"w-full",disabled:!U,children:"Profile"})}):Ie.jsx(Ie.Fragment,{})]})})},k))}),Ie.jsx(Q0,{}),Ie.jsx(J0,{})]})}function bg(R){return R.toLowerCase().split(" ").map(U=>U.charAt(0).toUpperCase()+U.slice(1)).join(" ")}function lv({countryName:R,happiness:U}){return Ie.jsxs("div",{className:"w-full flex flex-row justify-center items-center gap-4",children:[Ie.jsxs(jp,{className:"bg-accent",children:[Ie.jsx(Vp,{children:Ie.jsx(vd,{children:"Strengths"})}),Ie.jsx(Gp,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:Ie.jsx("p",{children:"+15% from expected"})})]}),Ie.jsxs(jp,{className:"bg-accent",children:[Ie.jsx(Vp,{children:Ie.jsx(vd,{children:"Happy Countries"})}),Ie.jsxs(Gp,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:[U&&Ie.jsxs(Ie.Fragment,{children:[Ie.jsxs("p",{children:[bg(R)," has the happiness rate of ",U]}),U?Ie.jsx($p,{value:U*10,className:"mb-5"}):Ie.jsx($p,{value:0,className:"mb-5"})]}),!U&&Ie.jsx(Ie.Fragment,{children:R?Ie.jsxs("p",{children:["No data for ",bg(R)]}):Ie.jsx("p",{children:"Click on the map to see happiness data!"})})]}),Ie.jsx(ay,{className:"mt-auto flex-col gap-2",children:Ie.jsx(Uf,{type:"submit",className:"w-full",disabled:!U,children:"Profile"})})]}),Ie.jsxs(jp,{className:"bg-accent",children:[Ie.jsx(Vp,{children:Ie.jsx(vd,{children:"Weaknesses"})}),Ie.jsx(Gp,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:Ie.jsx("p",{children:"-15% from expected"})})]})]})}function uv(){const[R,U]=mt.useState(""),[G,k]=mt.useState(""),[Q,ee]=mt.useState(null),E=mt.useRef(null);return mt.useEffect(()=>{if(R){const c=ym.find(q=>q.Country_clean===R)||null;ee(c)}},[R]),Ie.jsxs("div",{className:"container w-full h-screen bg-primary-foreground font-display",children:[Ie.jsxs("div",{className:"bg-primary text-primary-foreground flex flex-row justify-between items-center gap-4 p-3 w-full h-20",children:[Ie.jsxs("div",{className:"flex flex-row justify-start items-center gap-4",children:[Ie.jsx("a",{href:"",target:"_blank",children:Ie.jsx("img",{src:Ey,className:"logo h-14",alt:"Vite logo"})}),Ie.jsx("h1",{children:"Happiness Report"})]}),Ie.jsxs("div",{className:"flex w-full max-w-sm items-center gap-2",children:[Ie.jsx(y_,{type:"email",placeholder:"Find a country",value:G,onChange:c=>k(c.target.value),onKeyDown:c=>{if(c.key==="Enter"){const q=ym.find(te=>te.Country_clean.toLowerCase()===G.toLowerCase());U(q?q.Country_clean:G),k("")}}}),Ie.jsx(Uf,{type:"button",variant:"outline",className:"bg-primary",onClick:()=>{const c=ym.find(q=>q.Country_clean.toLowerCase()===G.toLowerCase());c&&(U(c.Country_clean),k(""))},children:"Search"})]})]}),Ie.jsx("div",{className:"card m-5 p-4 flex flex-col justify-center items-center gap-4 relative rounded-full h-1/3",ref:E,children:Ie.jsx(S_,{mapContainerRef:E,callback:U})}),Ie.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 md:hidden",children:[Ie.jsx(xg,{countryName:R,happiness:Q?.Happiness,countryStrength:"Strength",countryWeakness:"Weakness"}),Ie.jsx("div",{className:"px-10 mb-5 w-full flex flex-row justify-center items-center",children:Ie.jsxs("div",{className:"w-60",children:[Ie.jsx("h2",{children:"About"}),Ie.jsx(Sm,{})]})})]}),Ie.jsxs("div",{className:"hidden md:flex lg:hidden flex-row justify-center items-center gap-15",children:[Ie.jsx(xg,{countryName:R,happiness:Q?.Happiness,countryStrength:"Strength",countryWeakness:"Weakness"}),Ie.jsxs("div",{className:"flex-1 max-w-70",children:[Ie.jsx("h2",{children:"About"}),Ie.jsx(Sm,{})]})]}),Ie.jsxs("div",{className:"hidden lg:flex flex-row justify-center items-center gap-15",children:[Ie.jsx("div",{className:"flex-1 max-w-xl",children:Ie.jsx(lv,{countryName:R,happiness:Q?.Happiness,countryStrength:"Strength",countryWeakness:"Weakness"})}),Ie.jsxs("div",{className:"flex-1 max-w-70",children:[Ie.jsx("h2",{children:"About"}),Ie.jsx(Sm,{})]})]})]})}function cv(){return Ie.jsx(uv,{})}Ay.createRoot(document.getElementById("root")).render(Ie.jsx(mt.StrictMode,{children:Ie.jsx(cv,{})}));
