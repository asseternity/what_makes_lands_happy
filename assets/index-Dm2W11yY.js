function H_(b,R){for(var L=0;L<R.length;L++){const D=R[L];if(typeof D!="string"&&!Array.isArray(D)){for(const j in D)if(j!=="default"&&!(j in b)){const G=Object.getOwnPropertyDescriptor(D,j);G&&Object.defineProperty(b,j,G.get?G:{enumerable:!0,get:()=>D[j]})}}}return Object.freeze(Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}))}(function(){const R=document.createElement("link").relList;if(R&&R.supports&&R.supports("modulepreload"))return;for(const j of document.querySelectorAll('link[rel="modulepreload"]'))D(j);new MutationObserver(j=>{for(const G of j)if(G.type==="childList")for(const A of G.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&D(A)}).observe(document,{childList:!0,subtree:!0});function L(j){const G={};return j.integrity&&(G.integrity=j.integrity),j.referrerPolicy&&(G.referrerPolicy=j.referrerPolicy),j.crossOrigin==="use-credentials"?G.credentials="include":j.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function D(j){if(j.ep)return;j.ep=!0;const G=L(j);fetch(j.href,G)}})();function ug(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}var Nm={exports:{}},Hf={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rg;function G_(){if(Rg)return Hf;Rg=1;var b=Symbol.for("react.transitional.element"),R=Symbol.for("react.fragment");function L(D,j,G){var A=null;if(G!==void 0&&(A=""+G),j.key!==void 0&&(A=""+j.key),"key"in j){G={};for(var c in j)c!=="key"&&(G[c]=j[c])}else G=j;return j=G.ref,{$$typeof:b,type:D,key:A,ref:j!==void 0?j:null,props:G}}return Hf.Fragment=R,Hf.jsx=L,Hf.jsxs=L,Hf}var Dg;function Z_(){return Dg||(Dg=1,Nm.exports=G_()),Nm.exports}var _e=Z_(),Um={exports:{}},bn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ig;function q_(){if(Ig)return bn;Ig=1;var b=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),G=Symbol.for("react.consumer"),A=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),Y=Symbol.for("react.memo"),he=Symbol.for("react.lazy"),we=Symbol.iterator;function ge(ve){return ve===null||typeof ve!="object"?null:(ve=we&&ve[we]||ve["@@iterator"],typeof ve=="function"?ve:null)}var ne={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Re=Object.assign,ye={};function ze(ve,Xe,vt){this.props=ve,this.context=Xe,this.refs=ye,this.updater=vt||ne}ze.prototype.isReactComponent={},ze.prototype.setState=function(ve,Xe){if(typeof ve!="object"&&typeof ve!="function"&&ve!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ve,Xe,"setState")},ze.prototype.forceUpdate=function(ve){this.updater.enqueueForceUpdate(this,ve,"forceUpdate")};function De(){}De.prototype=ze.prototype;function ke(ve,Xe,vt){this.props=ve,this.context=Xe,this.refs=ye,this.updater=vt||ne}var He=ke.prototype=new De;He.constructor=ke,Re(He,ze.prototype),He.isPureReactComponent=!0;var it=Array.isArray,at={H:null,A:null,T:null,S:null,V:null},wt=Object.prototype.hasOwnProperty;function ft(ve,Xe,vt,st,xt,Kt){return vt=Kt.ref,{$$typeof:b,type:ve,key:Xe,ref:vt!==void 0?vt:null,props:Kt}}function ot(ve,Xe){return ft(ve.type,Xe,void 0,void 0,void 0,ve.props)}function Bt(ve){return typeof ve=="object"&&ve!==null&&ve.$$typeof===b}function cn(ve){var Xe={"=":"=0",":":"=2"};return"$"+ve.replace(/[=:]/g,function(vt){return Xe[vt]})}var nn=/\/+/g;function on(ve,Xe){return typeof ve=="object"&&ve!==null&&ve.key!=null?cn(""+ve.key):Xe.toString(36)}function jn(){}function er(ve){switch(ve.status){case"fulfilled":return ve.value;case"rejected":throw ve.reason;default:switch(typeof ve.status=="string"?ve.then(jn,jn):(ve.status="pending",ve.then(function(Xe){ve.status==="pending"&&(ve.status="fulfilled",ve.value=Xe)},function(Xe){ve.status==="pending"&&(ve.status="rejected",ve.reason=Xe)})),ve.status){case"fulfilled":return ve.value;case"rejected":throw ve.reason}}throw ve}function mn(ve,Xe,vt,st,xt){var Kt=typeof ve;(Kt==="undefined"||Kt==="boolean")&&(ve=null);var It=!1;if(ve===null)It=!0;else switch(Kt){case"bigint":case"string":case"number":It=!0;break;case"object":switch(ve.$$typeof){case b:case R:It=!0;break;case he:return It=ve._init,mn(It(ve._payload),Xe,vt,st,xt)}}if(It)return xt=xt(ve),It=st===""?"."+on(ve,0):st,it(xt)?(vt="",It!=null&&(vt=It.replace(nn,"$&/")+"/"),mn(xt,Xe,vt,"",function(En){return En})):xt!=null&&(Bt(xt)&&(xt=ot(xt,vt+(xt.key==null||ve&&ve.key===xt.key?"":(""+xt.key).replace(nn,"$&/")+"/")+It)),Xe.push(xt)),1;It=0;var Zt=st===""?".":st+":";if(it(ve))for(var Ht=0;Ht<ve.length;Ht++)st=ve[Ht],Kt=Zt+on(st,Ht),It+=mn(st,Xe,vt,Kt,xt);else if(Ht=ge(ve),typeof Ht=="function")for(ve=Ht.call(ve),Ht=0;!(st=ve.next()).done;)st=st.value,Kt=Zt+on(st,Ht++),It+=mn(st,Xe,vt,Kt,xt);else if(Kt==="object"){if(typeof ve.then=="function")return mn(er(ve),Xe,vt,st,xt);throw Xe=String(ve),Error("Objects are not valid as a React child (found: "+(Xe==="[object Object]"?"object with keys {"+Object.keys(ve).join(", ")+"}":Xe)+"). If you meant to render a collection of children, use an array instead.")}return It}function We(ve,Xe,vt){if(ve==null)return ve;var st=[],xt=0;return mn(ve,st,"","",function(Kt){return Xe.call(vt,Kt,xt++)}),st}function mt(ve){if(ve._status===-1){var Xe=ve._result;Xe=Xe(),Xe.then(function(vt){(ve._status===0||ve._status===-1)&&(ve._status=1,ve._result=vt)},function(vt){(ve._status===0||ve._status===-1)&&(ve._status=2,ve._result=vt)}),ve._status===-1&&(ve._status=0,ve._result=Xe)}if(ve._status===1)return ve._result.default;throw ve._result}var rt=typeof reportError=="function"?reportError:function(ve){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Xe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ve=="object"&&ve!==null&&typeof ve.message=="string"?String(ve.message):String(ve),error:ve});if(!window.dispatchEvent(Xe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ve);return}console.error(ve)};function Et(){}return bn.Children={map:We,forEach:function(ve,Xe,vt){We(ve,function(){Xe.apply(this,arguments)},vt)},count:function(ve){var Xe=0;return We(ve,function(){Xe++}),Xe},toArray:function(ve){return We(ve,function(Xe){return Xe})||[]},only:function(ve){if(!Bt(ve))throw Error("React.Children.only expected to receive a single React element child.");return ve}},bn.Component=ze,bn.Fragment=L,bn.Profiler=j,bn.PureComponent=ke,bn.StrictMode=D,bn.Suspense=H,bn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=at,bn.__COMPILER_RUNTIME={__proto__:null,c:function(ve){return at.H.useMemoCache(ve)}},bn.cache=function(ve){return function(){return ve.apply(null,arguments)}},bn.cloneElement=function(ve,Xe,vt){if(ve==null)throw Error("The argument must be a React element, but you passed "+ve+".");var st=Re({},ve.props),xt=ve.key,Kt=void 0;if(Xe!=null)for(It in Xe.ref!==void 0&&(Kt=void 0),Xe.key!==void 0&&(xt=""+Xe.key),Xe)!wt.call(Xe,It)||It==="key"||It==="__self"||It==="__source"||It==="ref"&&Xe.ref===void 0||(st[It]=Xe[It]);var It=arguments.length-2;if(It===1)st.children=vt;else if(1<It){for(var Zt=Array(It),Ht=0;Ht<It;Ht++)Zt[Ht]=arguments[Ht+2];st.children=Zt}return ft(ve.type,xt,void 0,void 0,Kt,st)},bn.createContext=function(ve){return ve={$$typeof:A,_currentValue:ve,_currentValue2:ve,_threadCount:0,Provider:null,Consumer:null},ve.Provider=ve,ve.Consumer={$$typeof:G,_context:ve},ve},bn.createElement=function(ve,Xe,vt){var st,xt={},Kt=null;if(Xe!=null)for(st in Xe.key!==void 0&&(Kt=""+Xe.key),Xe)wt.call(Xe,st)&&st!=="key"&&st!=="__self"&&st!=="__source"&&(xt[st]=Xe[st]);var It=arguments.length-2;if(It===1)xt.children=vt;else if(1<It){for(var Zt=Array(It),Ht=0;Ht<It;Ht++)Zt[Ht]=arguments[Ht+2];xt.children=Zt}if(ve&&ve.defaultProps)for(st in It=ve.defaultProps,It)xt[st]===void 0&&(xt[st]=It[st]);return ft(ve,Kt,void 0,void 0,null,xt)},bn.createRef=function(){return{current:null}},bn.forwardRef=function(ve){return{$$typeof:c,render:ve}},bn.isValidElement=Bt,bn.lazy=function(ve){return{$$typeof:he,_payload:{_status:-1,_result:ve},_init:mt}},bn.memo=function(ve,Xe){return{$$typeof:Y,type:ve,compare:Xe===void 0?null:Xe}},bn.startTransition=function(ve){var Xe=at.T,vt={};at.T=vt;try{var st=ve(),xt=at.S;xt!==null&&xt(vt,st),typeof st=="object"&&st!==null&&typeof st.then=="function"&&st.then(Et,rt)}catch(Kt){rt(Kt)}finally{at.T=Xe}},bn.unstable_useCacheRefresh=function(){return at.H.useCacheRefresh()},bn.use=function(ve){return at.H.use(ve)},bn.useActionState=function(ve,Xe,vt){return at.H.useActionState(ve,Xe,vt)},bn.useCallback=function(ve,Xe){return at.H.useCallback(ve,Xe)},bn.useContext=function(ve){return at.H.useContext(ve)},bn.useDebugValue=function(){},bn.useDeferredValue=function(ve,Xe){return at.H.useDeferredValue(ve,Xe)},bn.useEffect=function(ve,Xe,vt){var st=at.H;if(typeof vt=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return st.useEffect(ve,Xe)},bn.useId=function(){return at.H.useId()},bn.useImperativeHandle=function(ve,Xe,vt){return at.H.useImperativeHandle(ve,Xe,vt)},bn.useInsertionEffect=function(ve,Xe){return at.H.useInsertionEffect(ve,Xe)},bn.useLayoutEffect=function(ve,Xe){return at.H.useLayoutEffect(ve,Xe)},bn.useMemo=function(ve,Xe){return at.H.useMemo(ve,Xe)},bn.useOptimistic=function(ve,Xe){return at.H.useOptimistic(ve,Xe)},bn.useReducer=function(ve,Xe,vt){return at.H.useReducer(ve,Xe,vt)},bn.useRef=function(ve){return at.H.useRef(ve)},bn.useState=function(ve){return at.H.useState(ve)},bn.useSyncExternalStore=function(ve,Xe,vt){return at.H.useSyncExternalStore(ve,Xe,vt)},bn.useTransition=function(){return at.H.useTransition()},bn.version="19.1.1",bn}var zg;function hg(){return zg||(zg=1,Um.exports=q_()),Um.exports}var Ee=hg();const gi=ug(Ee),yy=H_({__proto__:null,default:gi},[Ee]);var jm={exports:{}},Gf={},Vm={exports:{}},Hm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lg;function W_(){return Lg||(Lg=1,(function(b){function R(We,mt){var rt=We.length;We.push(mt);e:for(;0<rt;){var Et=rt-1>>>1,ve=We[Et];if(0<j(ve,mt))We[Et]=mt,We[rt]=ve,rt=Et;else break e}}function L(We){return We.length===0?null:We[0]}function D(We){if(We.length===0)return null;var mt=We[0],rt=We.pop();if(rt!==mt){We[0]=rt;e:for(var Et=0,ve=We.length,Xe=ve>>>1;Et<Xe;){var vt=2*(Et+1)-1,st=We[vt],xt=vt+1,Kt=We[xt];if(0>j(st,rt))xt<ve&&0>j(Kt,st)?(We[Et]=Kt,We[xt]=rt,Et=xt):(We[Et]=st,We[vt]=rt,Et=vt);else if(xt<ve&&0>j(Kt,rt))We[Et]=Kt,We[xt]=rt,Et=xt;else break e}}return mt}function j(We,mt){var rt=We.sortIndex-mt.sortIndex;return rt!==0?rt:We.id-mt.id}if(b.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var G=performance;b.unstable_now=function(){return G.now()}}else{var A=Date,c=A.now();b.unstable_now=function(){return A.now()-c}}var H=[],Y=[],he=1,we=null,ge=3,ne=!1,Re=!1,ye=!1,ze=!1,De=typeof setTimeout=="function"?setTimeout:null,ke=typeof clearTimeout=="function"?clearTimeout:null,He=typeof setImmediate<"u"?setImmediate:null;function it(We){for(var mt=L(Y);mt!==null;){if(mt.callback===null)D(Y);else if(mt.startTime<=We)D(Y),mt.sortIndex=mt.expirationTime,R(H,mt);else break;mt=L(Y)}}function at(We){if(ye=!1,it(We),!Re)if(L(H)!==null)Re=!0,wt||(wt=!0,on());else{var mt=L(Y);mt!==null&&mn(at,mt.startTime-We)}}var wt=!1,ft=-1,ot=5,Bt=-1;function cn(){return ze?!0:!(b.unstable_now()-Bt<ot)}function nn(){if(ze=!1,wt){var We=b.unstable_now();Bt=We;var mt=!0;try{e:{Re=!1,ye&&(ye=!1,ke(ft),ft=-1),ne=!0;var rt=ge;try{t:{for(it(We),we=L(H);we!==null&&!(we.expirationTime>We&&cn());){var Et=we.callback;if(typeof Et=="function"){we.callback=null,ge=we.priorityLevel;var ve=Et(we.expirationTime<=We);if(We=b.unstable_now(),typeof ve=="function"){we.callback=ve,it(We),mt=!0;break t}we===L(H)&&D(H),it(We)}else D(H);we=L(H)}if(we!==null)mt=!0;else{var Xe=L(Y);Xe!==null&&mn(at,Xe.startTime-We),mt=!1}}break e}finally{we=null,ge=rt,ne=!1}mt=void 0}}finally{mt?on():wt=!1}}}var on;if(typeof He=="function")on=function(){He(nn)};else if(typeof MessageChannel<"u"){var jn=new MessageChannel,er=jn.port2;jn.port1.onmessage=nn,on=function(){er.postMessage(null)}}else on=function(){De(nn,0)};function mn(We,mt){ft=De(function(){We(b.unstable_now())},mt)}b.unstable_IdlePriority=5,b.unstable_ImmediatePriority=1,b.unstable_LowPriority=4,b.unstable_NormalPriority=3,b.unstable_Profiling=null,b.unstable_UserBlockingPriority=2,b.unstable_cancelCallback=function(We){We.callback=null},b.unstable_forceFrameRate=function(We){0>We||125<We?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ot=0<We?Math.floor(1e3/We):5},b.unstable_getCurrentPriorityLevel=function(){return ge},b.unstable_next=function(We){switch(ge){case 1:case 2:case 3:var mt=3;break;default:mt=ge}var rt=ge;ge=mt;try{return We()}finally{ge=rt}},b.unstable_requestPaint=function(){ze=!0},b.unstable_runWithPriority=function(We,mt){switch(We){case 1:case 2:case 3:case 4:case 5:break;default:We=3}var rt=ge;ge=We;try{return mt()}finally{ge=rt}},b.unstable_scheduleCallback=function(We,mt,rt){var Et=b.unstable_now();switch(typeof rt=="object"&&rt!==null?(rt=rt.delay,rt=typeof rt=="number"&&0<rt?Et+rt:Et):rt=Et,We){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=rt+ve,We={id:he++,callback:mt,priorityLevel:We,startTime:rt,expirationTime:ve,sortIndex:-1},rt>Et?(We.sortIndex=rt,R(Y,We),L(H)===null&&We===L(Y)&&(ye?(ke(ft),ft=-1):ye=!0,mn(at,rt-Et))):(We.sortIndex=ve,R(H,We),Re||ne||(Re=!0,wt||(wt=!0,on()))),We},b.unstable_shouldYield=cn,b.unstable_wrapCallback=function(We){var mt=ge;return function(){var rt=ge;ge=mt;try{return We.apply(this,arguments)}finally{ge=rt}}}})(Hm)),Hm}var kg;function $_(){return kg||(kg=1,Vm.exports=W_()),Vm.exports}var Gm={exports:{}},Ca={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Og;function X_(){if(Og)return Ca;Og=1;var b=hg();function R(H){var Y="https://react.dev/errors/"+H;if(1<arguments.length){Y+="?args[]="+encodeURIComponent(arguments[1]);for(var he=2;he<arguments.length;he++)Y+="&args[]="+encodeURIComponent(arguments[he])}return"Minified React error #"+H+"; visit "+Y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function L(){}var D={d:{f:L,r:function(){throw Error(R(522))},D:L,C:L,L,m:L,X:L,S:L,M:L},p:0,findDOMNode:null},j=Symbol.for("react.portal");function G(H,Y,he){var we=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:j,key:we==null?null:""+we,children:H,containerInfo:Y,implementation:he}}var A=b.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(H,Y){if(H==="font")return"";if(typeof Y=="string")return Y==="use-credentials"?Y:""}return Ca.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Ca.createPortal=function(H,Y){var he=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y||Y.nodeType!==1&&Y.nodeType!==9&&Y.nodeType!==11)throw Error(R(299));return G(H,Y,null,he)},Ca.flushSync=function(H){var Y=A.T,he=D.p;try{if(A.T=null,D.p=2,H)return H()}finally{A.T=Y,D.p=he,D.d.f()}},Ca.preconnect=function(H,Y){typeof H=="string"&&(Y?(Y=Y.crossOrigin,Y=typeof Y=="string"?Y==="use-credentials"?Y:"":void 0):Y=null,D.d.C(H,Y))},Ca.prefetchDNS=function(H){typeof H=="string"&&D.d.D(H)},Ca.preinit=function(H,Y){if(typeof H=="string"&&Y&&typeof Y.as=="string"){var he=Y.as,we=c(he,Y.crossOrigin),ge=typeof Y.integrity=="string"?Y.integrity:void 0,ne=typeof Y.fetchPriority=="string"?Y.fetchPriority:void 0;he==="style"?D.d.S(H,typeof Y.precedence=="string"?Y.precedence:void 0,{crossOrigin:we,integrity:ge,fetchPriority:ne}):he==="script"&&D.d.X(H,{crossOrigin:we,integrity:ge,fetchPriority:ne,nonce:typeof Y.nonce=="string"?Y.nonce:void 0})}},Ca.preinitModule=function(H,Y){if(typeof H=="string")if(typeof Y=="object"&&Y!==null){if(Y.as==null||Y.as==="script"){var he=c(Y.as,Y.crossOrigin);D.d.M(H,{crossOrigin:he,integrity:typeof Y.integrity=="string"?Y.integrity:void 0,nonce:typeof Y.nonce=="string"?Y.nonce:void 0})}}else Y==null&&D.d.M(H)},Ca.preload=function(H,Y){if(typeof H=="string"&&typeof Y=="object"&&Y!==null&&typeof Y.as=="string"){var he=Y.as,we=c(he,Y.crossOrigin);D.d.L(H,he,{crossOrigin:we,integrity:typeof Y.integrity=="string"?Y.integrity:void 0,nonce:typeof Y.nonce=="string"?Y.nonce:void 0,type:typeof Y.type=="string"?Y.type:void 0,fetchPriority:typeof Y.fetchPriority=="string"?Y.fetchPriority:void 0,referrerPolicy:typeof Y.referrerPolicy=="string"?Y.referrerPolicy:void 0,imageSrcSet:typeof Y.imageSrcSet=="string"?Y.imageSrcSet:void 0,imageSizes:typeof Y.imageSizes=="string"?Y.imageSizes:void 0,media:typeof Y.media=="string"?Y.media:void 0})}},Ca.preloadModule=function(H,Y){if(typeof H=="string")if(Y){var he=c(Y.as,Y.crossOrigin);D.d.m(H,{as:typeof Y.as=="string"&&Y.as!=="script"?Y.as:void 0,crossOrigin:he,integrity:typeof Y.integrity=="string"?Y.integrity:void 0})}else D.d.m(H)},Ca.requestFormReset=function(H){D.d.r(H)},Ca.unstable_batchedUpdates=function(H,Y){return H(Y)},Ca.useFormState=function(H,Y,he){return A.H.useFormState(H,Y,he)},Ca.useFormStatus=function(){return A.H.useHostTransitionStatus()},Ca.version="19.1.1",Ca}var Bg;function _y(){if(Bg)return Gm.exports;Bg=1;function b(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b)}catch(R){console.error(R)}}return b(),Gm.exports=X_(),Gm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fg;function Y_(){if(Fg)return Gf;Fg=1;var b=$_(),R=hg(),L=_y();function D(n){var o="https://react.dev/errors/"+n;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function j(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function G(n){var o=n,u=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(u=o.return),n=o.return;while(n)}return o.tag===3?u:null}function A(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function c(n){if(G(n)!==n)throw Error(D(188))}function H(n){var o=n.alternate;if(!o){if(o=G(n),o===null)throw Error(D(188));return o!==n?null:n}for(var u=n,p=o;;){var x=u.return;if(x===null)break;var T=x.alternate;if(T===null){if(p=x.return,p!==null){u=p;continue}break}if(x.child===T.child){for(T=x.child;T;){if(T===u)return c(x),n;if(T===p)return c(x),o;T=T.sibling}throw Error(D(188))}if(u.return!==p.return)u=x,p=T;else{for(var F=!1,X=x.child;X;){if(X===u){F=!0,u=x,p=T;break}if(X===p){F=!0,p=x,u=T;break}X=X.sibling}if(!F){for(X=T.child;X;){if(X===u){F=!0,u=T,p=x;break}if(X===p){F=!0,p=T,u=x;break}X=X.sibling}if(!F)throw Error(D(189))}}if(u.alternate!==p)throw Error(D(190))}if(u.tag!==3)throw Error(D(188));return u.stateNode.current===u?n:o}function Y(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n;for(n=n.child;n!==null;){if(o=Y(n),o!==null)return o;n=n.sibling}return null}var he=Object.assign,we=Symbol.for("react.element"),ge=Symbol.for("react.transitional.element"),ne=Symbol.for("react.portal"),Re=Symbol.for("react.fragment"),ye=Symbol.for("react.strict_mode"),ze=Symbol.for("react.profiler"),De=Symbol.for("react.provider"),ke=Symbol.for("react.consumer"),He=Symbol.for("react.context"),it=Symbol.for("react.forward_ref"),at=Symbol.for("react.suspense"),wt=Symbol.for("react.suspense_list"),ft=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),Bt=Symbol.for("react.activity"),cn=Symbol.for("react.memo_cache_sentinel"),nn=Symbol.iterator;function on(n){return n===null||typeof n!="object"?null:(n=nn&&n[nn]||n["@@iterator"],typeof n=="function"?n:null)}var jn=Symbol.for("react.client.reference");function er(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===jn?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Re:return"Fragment";case ze:return"Profiler";case ye:return"StrictMode";case at:return"Suspense";case wt:return"SuspenseList";case Bt:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case ne:return"Portal";case He:return(n.displayName||"Context")+".Provider";case ke:return(n._context.displayName||"Context")+".Consumer";case it:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ft:return o=n.displayName||null,o!==null?o:er(n.type)||"Memo";case ot:o=n._payload,n=n._init;try{return er(n(o))}catch{}}return null}var mn=Array.isArray,We=R.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,mt=L.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,rt={pending:!1,data:null,method:null,action:null},Et=[],ve=-1;function Xe(n){return{current:n}}function vt(n){0>ve||(n.current=Et[ve],Et[ve]=null,ve--)}function st(n,o){ve++,Et[ve]=n.current,n.current=o}var xt=Xe(null),Kt=Xe(null),It=Xe(null),Zt=Xe(null);function Ht(n,o){switch(st(It,o),st(Kt,n),st(xt,null),o.nodeType){case 9:case 11:n=(n=o.documentElement)&&(n=n.namespaceURI)?kc(n):0;break;default:if(n=o.tagName,o=o.namespaceURI)o=kc(o),n=Pu(o,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}vt(xt),st(xt,n)}function En(){vt(xt),vt(Kt),vt(It)}function tr(n){n.memoizedState!==null&&st(Zt,n);var o=xt.current,u=Pu(o,n.type);o!==u&&(st(Kt,n),st(xt,u))}function xn(n){Kt.current===n&&(vt(xt),vt(Kt)),Zt.current===n&&(vt(Zt),z._currentValue=rt)}var St=Object.prototype.hasOwnProperty,qt=b.unstable_scheduleCallback,un=b.unstable_cancelCallback,qn=b.unstable_shouldYield,Ar=b.unstable_requestPaint,nr=b.unstable_now,Kr=b.unstable_getCurrentPriorityLevel,Br=b.unstable_ImmediatePriority,Mi=b.unstable_UserBlockingPriority,oi=b.unstable_NormalPriority,ya=b.unstable_LowPriority,ra=b.unstable_IdlePriority,qa=b.log,Aa=b.unstable_setDisableYieldValue,Wi=null,gr=null;function Ri(n){if(typeof qa=="function"&&Aa(n),gr&&typeof gr.setStrictMode=="function")try{gr.setStrictMode(Wi,n)}catch{}}var xe=Math.clz32?Math.clz32:K,Z=Math.log,q=Math.LN2;function K(n){return n>>>=0,n===0?32:31-(Z(n)/q|0)|0}var se=256,de=4194304;function be(n){var o=n&42;if(o!==0)return o;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function Be(n,o,u){var p=n.pendingLanes;if(p===0)return 0;var x=0,T=n.suspendedLanes,F=n.pingedLanes;n=n.warmLanes;var X=p&134217727;return X!==0?(p=X&~T,p!==0?x=be(p):(F&=X,F!==0?x=be(F):u||(u=X&~n,u!==0&&(x=be(u))))):(X=p&~T,X!==0?x=be(X):F!==0?x=be(F):u||(u=p&~n,u!==0&&(x=be(u)))),x===0?0:o!==0&&o!==x&&(o&T)===0&&(T=x&-x,u=o&-o,T>=u||T===32&&(u&4194048)!==0)?o:x}function Pe(n,o){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&o)===0}function qe(n,o){switch(n){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nt(){var n=se;return se<<=1,(se&4194048)===0&&(se=256),n}function Ye(){var n=de;return de<<=1,(de&62914560)===0&&(de=4194304),n}function Pt(n){for(var o=[],u=0;31>u;u++)o.push(n);return o}function Ce(n,o){n.pendingLanes|=o,o!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Gt(n,o,u,p,x,T){var F=n.pendingLanes;n.pendingLanes=u,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=u,n.entangledLanes&=u,n.errorRecoveryDisabledLanes&=u,n.shellSuspendCounter=0;var X=n.entanglements,fe=n.expirationTimes,Ne=n.hiddenUpdates;for(u=F&~u;0<u;){var Qe=31-xe(u),tt=1<<Qe;X[Qe]=0,fe[Qe]=-1;var Ve=Ne[Qe];if(Ve!==null)for(Ne[Qe]=null,Qe=0;Qe<Ve.length;Qe++){var Ze=Ve[Qe];Ze!==null&&(Ze.lane&=-536870913)}u&=~tt}p!==0&&dn(n,p,0),T!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=T&~(F&~o))}function dn(n,o,u){n.pendingLanes|=o,n.suspendedLanes&=~o;var p=31-xe(o);n.entangledLanes|=o,n.entanglements[p]=n.entanglements[p]|1073741824|u&4194090}function Rt(n,o){var u=n.entangledLanes|=o;for(n=n.entanglements;u;){var p=31-xe(u),x=1<<p;x&o|n[p]&o&&(n[p]|=o),u&=~x}}function Wt(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function In(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Fr(){var n=mt.p;return n!==0?n:(n=window.event,n===void 0?32:yt(n.type))}function Vr(n,o){var u=mt.p;try{return mt.p=n,o()}finally{mt.p=u}}var Vn=Math.random().toString(36).slice(2),Ut="__reactFiber$"+Vn,$t="__reactProps$"+Vn,lr="__reactContainer$"+Vn,lt="__reactEvents$"+Vn,_i="__reactListeners$"+Vn,yr="__reactHandles$"+Vn,po="__reactResources$"+Vn,Wa="__reactMarker$"+Vn;function _t(n){delete n[Ut],delete n[$t],delete n[lt],delete n[_i],delete n[yr]}function rn(n){var o=n[Ut];if(o)return o;for(var u=n.parentNode;u;){if(o=u[lr]||u[Ut]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(n=Nf(n);n!==null;){if(u=n[Ut])return u;n=Nf(n)}return o}n=u,u=n.parentNode}return null}function Qt(n){if(n=n[Ut]||n[lr]){var o=n.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return n}return null}function Er(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n.stateNode;throw Error(D(33))}function _a(n){var o=n[po];return o||(o=n[po]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function cr(n){n[Wa]=!0}var an=new Set,Wl={};function $i(n,o){mo(n,o),mo(n+"Capture",o)}function mo(n,o){for(Wl[n]=o,n=0;n<o.length;n++)an.add(o[n])}var $a=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),cs={},_r={};function Nc(n){return St.call(_r,n)?!0:St.call(cs,n)?!1:$a.test(n)?_r[n]=!0:(cs[n]=!0,!1)}function si(n,o,u){if(Nc(o))if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":n.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){n.removeAttribute(o);return}}n.setAttribute(o,""+u)}}function zn(n,o,u){if(u===null)n.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttribute(o,""+u)}}function Xa(n,o,u,p){if(p===null)n.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(u);return}n.setAttributeNS(o,u,""+p)}}var us,Uc;function ia(n){if(us===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);us=o&&o[1]||"",Uc=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+us+n+Uc}var Ya=!1;function $l(n,o){if(!n||Ya)return"";Ya=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var tt=function(){throw Error()};if(Object.defineProperty(tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(tt,[])}catch(Ze){var Ve=Ze}Reflect.construct(n,[],tt)}else{try{tt.call()}catch(Ze){Ve=Ze}n.call(tt.prototype)}}else{try{throw Error()}catch(Ze){Ve=Ze}(tt=n())&&typeof tt.catch=="function"&&tt.catch(function(){})}}catch(Ze){if(Ze&&Ve&&typeof Ze.stack=="string")return[Ze.stack,Ve.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=p.DetermineComponentFrameRoot(),F=T[0],X=T[1];if(F&&X){var fe=F.split(`
`),Ne=X.split(`
`);for(x=p=0;p<fe.length&&!fe[p].includes("DetermineComponentFrameRoot");)p++;for(;x<Ne.length&&!Ne[x].includes("DetermineComponentFrameRoot");)x++;if(p===fe.length||x===Ne.length)for(p=fe.length-1,x=Ne.length-1;1<=p&&0<=x&&fe[p]!==Ne[x];)x--;for(;1<=p&&0<=x;p--,x--)if(fe[p]!==Ne[x]){if(p!==1||x!==1)do if(p--,x--,0>x||fe[p]!==Ne[x]){var Qe=`
`+fe[p].replace(" at new "," at ");return n.displayName&&Qe.includes("<anonymous>")&&(Qe=Qe.replace("<anonymous>",n.displayName)),Qe}while(1<=p&&0<=x);break}}}finally{Ya=!1,Error.prepareStackTrace=u}return(u=n?n.displayName||n.name:"")?ia(u):""}function Nh(n){switch(n.tag){case 26:case 27:case 5:return ia(n.type);case 16:return ia("Lazy");case 13:return ia("Suspense");case 19:return ia("SuspenseList");case 0:case 15:return $l(n.type,!1);case 11:return $l(n.type.render,!1);case 1:return $l(n.type,!0);case 31:return ia("Activity");default:return""}}function Iu(n){try{var o="";do o+=Nh(n),n=n.return;while(n);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function li(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function zu(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function kd(n){var o=zu(n)?"checked":"value",u=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),p=""+n[o];if(!n.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var x=u.get,T=u.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return x.call(this)},set:function(F){p=""+F,T.call(this,F)}}),Object.defineProperty(n,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(F){p=""+F},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function jc(n){n._valueTracker||(n._valueTracker=kd(n))}function Uh(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return n&&(p=zu(n)?n.checked?"true":"false":n.value),n=p,n!==u?(o.setValue(n),!0):!1}function rl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var il=/[\n"\\]/g;function Xi(n){return n.replace(il,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Xl(n,o,u,p,x,T,F,X){n.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?n.type=F:n.removeAttribute("type"),o!=null?F==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+li(o)):n.value!==""+li(o)&&(n.value=""+li(o)):F!=="submit"&&F!=="reset"||n.removeAttribute("value"),o!=null?Yl(n,F,li(o)):u!=null?Yl(n,F,li(u)):p!=null&&n.removeAttribute("value"),x==null&&T!=null&&(n.defaultChecked=!!T),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?n.name=""+li(X):n.removeAttribute("name")}function hs(n,o,u,p,x,T,F,X){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.type=T),o!=null||u!=null){if(!(T!=="submit"&&T!=="reset"||o!=null))return;u=u!=null?""+li(u):"",o=o!=null?""+li(o):u,X||o===n.value||(n.value=o),n.defaultValue=o}p=p??x,p=typeof p!="function"&&typeof p!="symbol"&&!!p,n.checked=X?n.checked:!!p,n.defaultChecked=!!p,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(n.name=F)}function Yl(n,o,u){o==="number"&&rl(n.ownerDocument)===n||n.defaultValue===""+u||(n.defaultValue=""+u)}function Uo(n,o,u,p){if(n=n.options,o){o={};for(var x=0;x<u.length;x++)o["$"+u[x]]=!0;for(u=0;u<n.length;u++)x=o.hasOwnProperty("$"+n[u].value),n[u].selected!==x&&(n[u].selected=x),x&&p&&(n[u].defaultSelected=!0)}else{for(u=""+li(u),o=null,x=0;x<n.length;x++){if(n[x].value===u){n[x].selected=!0,p&&(n[x].defaultSelected=!0);return}o!==null||n[x].disabled||(o=n[x])}o!==null&&(o.selected=!0)}}function jh(n,o,u){if(o!=null&&(o=""+li(o),o!==n.value&&(n.value=o),u==null)){n.defaultValue!==o&&(n.defaultValue=o);return}n.defaultValue=u!=null?""+li(u):""}function ds(n,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(D(92));if(mn(p)){if(1<p.length)throw Error(D(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=li(o),n.defaultValue=u,p=n.textContent,p===u&&p!==""&&p!==null&&(n.value=p)}function Ka(n,o){if(o){var u=n.firstChild;if(u&&u===n.lastChild&&u.nodeType===3){u.nodeValue=o;return}}n.textContent=o}var Ea=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fn(n,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?n.setProperty(o,""):o==="float"?n.cssFloat="":n[o]="":p?n.setProperty(o,u):typeof u!="number"||u===0||Ea.has(o)?o==="float"?n.cssFloat=u:n[o]=(""+u).trim():n[o]=u+"px"}function jo(n,o,u){if(o!=null&&typeof o!="object")throw Error(D(62));if(n=n.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?n.setProperty(p,""):p==="float"?n.cssFloat="":n[p]="");for(var x in o)p=o[x],o.hasOwnProperty(x)&&u[x]!==p&&fn(n,x,p)}else for(var T in o)o.hasOwnProperty(T)&&fn(n,T,o[T])}function Qa(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var go=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),fs=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hn(n){return fs.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var yo=null;function al(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var _o=null,Nr=null;function Hr(n){var o=Qt(n);if(o&&(n=o.stateNode)){var u=n[$t]||null;e:switch(n=o.stateNode,o.type){case"input":if(Xl(n,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=n;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Xi(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==n&&p.form===n.form){var x=p[$t]||null;if(!x)throw Error(D(90));Xl(p,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===n.form&&Uh(p)}break e;case"textarea":jh(n,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Uo(n,!!u.multiple,o,!1)}}}var ci=!1;function Mr(n,o,u){if(ci)return n(o,u);ci=!0;try{var p=n(o);return p}finally{if(ci=!1,(_o!==null||Nr!==null)&&(bh(),_o&&(o=_o,n=Nr,Nr=_o=null,Hr(o),n)))for(o=0;o<n.length;o++)Hr(n[o])}}function Rn(n,o){var u=n.stateNode;if(u===null)return null;var p=u[$t]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(n=n.type,p=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!p;break e;default:n=!1}if(n)return null;if(u&&typeof u!="function")throw Error(D(231,o,typeof u));return u}var Ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ui=!1;if(Ja)try{var hi={};Object.defineProperty(hi,"passive",{get:function(){ui=!0}}),window.addEventListener("test",hi,hi),window.removeEventListener("test",hi,hi)}catch{ui=!1}var vr=null,Hn=null,eo=null;function Nt(){if(eo)return eo;var n,o=Hn,u=o.length,p,x="value"in vr?vr.value:vr.textContent,T=x.length;for(n=0;n<u&&o[n]===x[n];n++);var F=u-n;for(p=1;p<=F&&o[u-p]===x[T-p];p++);return eo=x.slice(n,1<p?1-p:void 0)}function Xt(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function va(){return!0}function _n(){return!1}function rr(n){function o(u,p,x,T,F){this._reactName=u,this._targetInst=x,this.type=p,this.nativeEvent=T,this.target=F,this.currentTarget=null;for(var X in n)n.hasOwnProperty(X)&&(u=n[X],this[X]=u?u(T):T[X]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?va:_n,this.isPropagationStopped=_n,this}return he(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=va)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=va)},persist:function(){},isPersistent:va}),o}var vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aa=rr(vi),Vo=he({},vi,{view:0,detail:0}),Lu=rr(Vo),Ho,ps,Go,ms=he({},Vo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_s,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Go&&(Go&&n.type==="mousemove"?(Ho=n.screenX-Go.screenX,ps=n.screenY-Go.screenY):ps=Ho=0,Go=n),Ho)},movementY:function(n){return"movementY"in n?n.movementY:ps}}),Kl=rr(ms),Ma=he({},ms,{dataTransfer:0}),Qr=rr(Ma),ol=he({},Vo,{relatedTarget:0}),gs=rr(ol),ys=he({},vi,{animationName:0,elapsedTime:0,pseudoElement:0}),wr=rr(ys),Vh=he({},vi,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ql=rr(Vh),ku=he({},vi,{data:0}),Hh=rr(ku),sl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},di={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function to(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=Jl[n])?!!o[n]:!1}function _s(){return to}var ec=he({},Vo,{key:function(n){if(n.key){var o=sl[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=Xt(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?di[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_s,charCode:function(n){return n.type==="keypress"?Xt(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Xt(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),tc=rr(ec),xi=he({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ou=rr(xi),Vc=he({},Vo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_s}),Od=rr(Vc),Bu=he({},vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bd=rr(Bu),Fd=he({},ms,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Hc=rr(Fd),Fu=he({},vi,{newState:0,oldState:0}),vs=rr(Fu),Nu=[9,13,27,32],ll=Ja&&"CompositionEvent"in window,Di=null;Ja&&"documentMode"in document&&(Di=document.documentMode);var Nd=Ja&&"TextEvent"in window&&!Di,nc=Ja&&(!ll||Di&&8<Di&&11>=Di),cl=" ",ul=!1;function Gh(n,o){switch(n){case"keyup":return Nu.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function rc(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var hl=!1;function xs(n,o){switch(n){case"compositionend":return rc(o);case"keypress":return o.which!==32?null:(ul=!0,cl);case"textInput":return n=o.data,n===cl&&ul?null:n;default:return null}}function Zh(n,o){if(hl)return n==="compositionend"||!ll&&Gh(n,o)?(n=Nt(),eo=Hn=vr=null,hl=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return nc&&o.locale!=="ko"?null:o.data;default:return null}}var Uu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qh(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!Uu[n.type]:o==="textarea"}function ju(n,o,u,p){_o?Nr?Nr.push(p):Nr=[p]:_o=p,o=yd(o,"onChange"),0<o.length&&(u=new aa("onChange","change",null,u,p),n.push({event:u,listeners:o}))}var bs=null,dl=null;function Gc(n){Rf(n,0)}function ic(n){var o=Er(n);if(Uh(o))return n}function Vu(n,o){if(n==="change")return o}var Zo=!1;if(Ja){var ac;if(Ja){var oc="oninput"in document;if(!oc){var fl=document.createElement("div");fl.setAttribute("oninput","return;"),oc=typeof fl.oninput=="function"}ac=oc}else ac=!1;Zo=ac&&(!document.documentMode||9<document.documentMode)}function Wh(){bs&&(bs.detachEvent("onpropertychange",pl),dl=bs=null)}function pl(n){if(n.propertyName==="value"&&ic(dl)){var o=[];ju(o,dl,n,al(n)),Mr(Gc,o)}}function $h(n,o,u){n==="focusin"?(Wh(),bs=o,dl=u,bs.attachEvent("onpropertychange",pl)):n==="focusout"&&Wh()}function Ud(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return ic(dl)}function Xh(n,o){if(n==="click")return ic(o)}function Yh(n,o){if(n==="input"||n==="change")return ic(o)}function Hu(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Ii=typeof Object.is=="function"?Object.is:Hu;function ml(n,o){if(Ii(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var u=Object.keys(n),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var x=u[p];if(!St.call(o,x)||!Ii(n[x],o[x]))return!1}return!0}function sc(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function no(n,o){var u=sc(n);n=0;for(var p;u;){if(u.nodeType===3){if(p=n+u.textContent.length,n<=o&&p>=o)return{node:u,offset:o-n};n=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=sc(u)}}function Sn(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?Sn(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function Zc(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var o=rl(n.document);o instanceof n.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)n=o.contentWindow;else break;o=rl(n.document)}return o}function lc(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}var Kh=Ja&&"documentMode"in document&&11>=document.documentMode,qo=null,vo=null,ws=null,Gu=!1;function Qh(n,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Gu||qo==null||qo!==rl(p)||(p=qo,"selectionStart"in p&&lc(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),ws&&ml(ws,p)||(ws=p,p=yd(vo,"onSelect"),0<p.length&&(o=new aa("onSelect","select",null,o,u),n.push({event:o,listeners:p}),o.target=qo)))}function Ss(n,o){var u={};return u[n.toLowerCase()]=o.toLowerCase(),u["Webkit"+n]="webkit"+o,u["Moz"+n]="moz"+o,u}var gl={animationend:Ss("Animation","AnimationEnd"),animationiteration:Ss("Animation","AnimationIteration"),animationstart:Ss("Animation","AnimationStart"),transitionrun:Ss("Transition","TransitionRun"),transitionstart:Ss("Transition","TransitionStart"),transitioncancel:Ss("Transition","TransitionCancel"),transitionend:Ss("Transition","TransitionEnd")},qc={},Jh={};Ja&&(Jh=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Wo(n){if(qc[n])return qc[n];if(!gl[n])return n;var o=gl[n],u;for(u in o)if(o.hasOwnProperty(u)&&u in Jh)return qc[n]=o[u];return n}var cc=Wo("animationend"),uc=Wo("animationiteration"),hc=Wo("animationstart"),Zu=Wo("transitionrun"),Ps=Wo("transitionstart"),dc=Wo("transitioncancel"),Cs=Wo("transitionend"),oa=new Map,Wc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wc.push("scrollEnd");function xa(n,o){oa.set(n,o),$i(o,[n])}var $c=new WeakMap;function Jr(n,o){if(typeof n=="object"&&n!==null){var u=$c.get(n);return u!==void 0?u:(o={value:n,source:o,stack:Iu(o)},$c.set(n,o),o)}return{value:n,source:o,stack:Iu(o)}}var zi=[],xo=0,Ts=0;function As(){for(var n=xo,o=Ts=xo=0;o<n;){var u=zi[o];zi[o++]=null;var p=zi[o];zi[o++]=null;var x=zi[o];zi[o++]=null;var T=zi[o];if(zi[o++]=null,p!==null&&x!==null){var F=p.pending;F===null?x.next=x:(x.next=F.next,F.next=x),p.pending=x}T!==0&&qu(u,x,T)}}function fc(n,o,u,p){zi[xo++]=n,zi[xo++]=o,zi[xo++]=u,zi[xo++]=p,Ts|=p,n.lanes|=p,n=n.alternate,n!==null&&(n.lanes|=p)}function $o(n,o,u,p){return fc(n,o,u,p),yl(n)}function sa(n,o){return fc(n,null,null,o),yl(n)}function qu(n,o,u){n.lanes|=u;var p=n.alternate;p!==null&&(p.lanes|=u);for(var x=!1,T=n.return;T!==null;)T.childLanes|=u,p=T.alternate,p!==null&&(p.childLanes|=u),T.tag===22&&(n=T.stateNode,n===null||n._visibility&1||(x=!0)),n=T,T=T.return;return n.tag===3?(T=n.stateNode,x&&o!==null&&(x=31-xe(u),n=T.hiddenUpdates,p=n[x],p===null?n[x]=[o]:p.push(o),o.lane=u|536870912),T):null}function yl(n){if(50<xh)throw xh=0,df=null,Error(D(185));for(var o=n.return;o!==null;)n=o,o=n.return;return n.tag===3?n.stateNode:null}var sn={};function pc(n,o,u,p){this.tag=n,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(n,o,u,p){return new pc(n,o,u,p)}function Xc(n){return n=n.prototype,!(!n||!n.isReactComponent)}function bi(n,o){var u=n.alternate;return u===null?(u=la(n.tag,o,n.key,n.mode),u.elementType=n.elementType,u.type=n.type,u.stateNode=n.stateNode,u.alternate=n,n.alternate=u):(u.pendingProps=o,u.type=n.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=n.flags&65011712,u.childLanes=n.childLanes,u.lanes=n.lanes,u.child=n.child,u.memoizedProps=n.memoizedProps,u.memoizedState=n.memoizedState,u.updateQueue=n.updateQueue,o=n.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=n.sibling,u.index=n.index,u.ref=n.ref,u.refCleanup=n.refCleanup,u}function Wu(n,o){n.flags&=65011714;var u=n.alternate;return u===null?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=u.childLanes,n.lanes=u.lanes,n.child=u.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=u.memoizedProps,n.memoizedState=u.memoizedState,n.updateQueue=u.updateQueue,n.type=u.type,o=u.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),n}function Yc(n,o,u,p,x,T){var F=0;if(p=n,typeof n=="function")Xc(n)&&(F=1);else if(typeof n=="string")F=t(n,u,xt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case Bt:return n=la(31,u,o,x),n.elementType=Bt,n.lanes=T,n;case Re:return Xo(u.children,x,T,o);case ye:F=8,x|=24;break;case ze:return n=la(12,u,o,x|2),n.elementType=ze,n.lanes=T,n;case at:return n=la(13,u,o,x),n.elementType=at,n.lanes=T,n;case wt:return n=la(19,u,o,x),n.elementType=wt,n.lanes=T,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case De:case He:F=10;break e;case ke:F=9;break e;case it:F=11;break e;case ft:F=14;break e;case ot:F=16,p=null;break e}F=29,u=Error(D(130,n===null?"null":typeof n,"")),p=null}return o=la(F,u,o,x),o.elementType=n,o.type=p,o.lanes=T,o}function Xo(n,o,u,p){return n=la(7,n,p,o),n.lanes=u,n}function $u(n,o,u){return n=la(6,n,null,o),n.lanes=u,n}function mc(n,o,u){return o=la(4,n.children!==null?n.children:[],n.key,o),o.lanes=u,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}var bo=[],ro=0,Yo=null,_l=0,ca=[],wi=0,Ra=null,ua=1,Li="";function Da(n,o){bo[ro++]=_l,bo[ro++]=Yo,Yo=n,_l=o}function Kc(n,o,u){ca[wi++]=ua,ca[wi++]=Li,ca[wi++]=Ra,Ra=n;var p=ua;n=Li;var x=32-xe(p)-1;p&=~(1<<x),u+=1;var T=32-xe(o)+x;if(30<T){var F=x-x%5;T=(p&(1<<F)-1).toString(32),p>>=F,x-=F,ua=1<<32-xe(o)+x|u<<x|p,Li=T+n}else ua=1<<T|u<<x|p,Li=n}function wo(n){n.return!==null&&(Da(n,1),Kc(n,1,0))}function gc(n){for(;n===Yo;)Yo=bo[--ro],bo[ro]=null,_l=bo[--ro],bo[ro]=null;for(;n===Ra;)Ra=ca[--wi],ca[wi]=null,Li=ca[--wi],ca[wi]=null,ua=ca[--wi],ca[wi]=null}var Gr=null,ur=null,Mn=!1,Ko=null,Ia=!1,vl=Error(D(519));function So(n){var o=Error(D(418,""));throw Qo(Jr(o,n)),vl}function Xu(n){var o=n.stateNode,u=n.type,p=n.memoizedProps;switch(o[Ut]=n,o[$t]=p,u){case"dialog":Cn("cancel",o),Cn("close",o);break;case"iframe":case"object":case"embed":Cn("load",o);break;case"video":case"audio":for(u=0;u<Su.length;u++)Cn(Su[u],o);break;case"source":Cn("error",o);break;case"img":case"image":case"link":Cn("error",o),Cn("load",o);break;case"details":Cn("toggle",o);break;case"input":Cn("invalid",o),hs(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),jc(o);break;case"select":Cn("invalid",o);break;case"textarea":Cn("invalid",o),ds(o,p.value,p.defaultValue,p.children),jc(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||kf(o.textContent,u)?(p.popover!=null&&(Cn("beforetoggle",o),Cn("toggle",o)),p.onScroll!=null&&Cn("scroll",o),p.onScrollEnd!=null&&Cn("scrollend",o),p.onClick!=null&&(o.onclick=Eh),o=!0):o=!1,o||So(n)}function Qc(n){for(Gr=n.return;Gr;)switch(Gr.tag){case 5:case 13:Ia=!1;return;case 27:case 3:Ia=!0;return;default:Gr=Gr.return}}function Bn(n){if(n!==Gr)return!1;if(!Mn)return Qc(n),Mn=!0,!1;var o=n.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=n.type,u=!(u!=="form"&&u!=="button")||$s(n.type,n.memoizedProps)),u=!u),u&&ur&&So(n),Qc(n),o===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(D(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8)if(u=n.data,u==="/$"){if(o===0){ur=fo(n.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;n=n.nextSibling}ur=null}}else o===27?(o=ur,Xs(n.type)?(n=Cu,Cu=null,ur=n):ur=o):ur=Gr?fo(n.stateNode.nextSibling):null;return!0}function za(){ur=Gr=null,Mn=!1}function Yi(){var n=Ko;return n!==null&&(da===null?da=n:da.push.apply(da,n),Ko=null),n}function Qo(n){Ko===null?Ko=[n]:Ko.push(n)}var xl=Xe(null),Po=null,ki=null;function Ki(n,o,u){st(xl,o._currentValue),o._currentValue=u}function ha(n){n._currentValue=xl.current,vt(xl)}function yc(n,o,u){for(;n!==null;){var p=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),n===u)break;n=n.return}}function Jc(n,o,u,p){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var T=x.dependencies;if(T!==null){var F=x.child;T=T.firstContext;e:for(;T!==null;){var X=T;T=x;for(var fe=0;fe<o.length;fe++)if(X.context===o[fe]){T.lanes|=u,X=T.alternate,X!==null&&(X.lanes|=u),yc(T.return,u,n),p||(F=null);break e}T=X.next}}else if(x.tag===18){if(F=x.return,F===null)throw Error(D(341));F.lanes|=u,T=F.alternate,T!==null&&(T.lanes|=u),yc(F,u,n),F=null}else F=x.child;if(F!==null)F.return=x;else for(F=x;F!==null;){if(F===n){F=null;break}if(x=F.sibling,x!==null){x.return=F.return,F=x;break}F=F.return}x=F}}function bl(n,o,u,p){n=null;for(var x=o,T=!1;x!==null;){if(!T){if((x.flags&524288)!==0)T=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var F=x.alternate;if(F===null)throw Error(D(387));if(F=F.memoizedProps,F!==null){var X=x.type;Ii(x.pendingProps.value,F.value)||(n!==null?n.push(X):n=[X])}}else if(x===Zt.current){if(F=x.alternate,F===null)throw Error(D(387));F.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(z):n=[z])}x=x.return}n!==null&&Jc(o,n,u,p),o.flags|=262144}function _c(n){for(n=n.firstContext;n!==null;){if(!Ii(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Jo(n){Po=n,ki=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Rr(n){return Oi(Po,n)}function Qi(n,o){return Po===null&&Jo(n),Oi(n,o)}function Oi(n,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ki===null){if(n===null)throw Error(D(308));ki=o,n.dependencies={lanes:0,firstContext:o},n.flags|=524288}else ki=ki.next=o;return u}var wl=typeof AbortController<"u"?AbortController:function(){var n=[],o=this.signal={aborted:!1,addEventListener:function(u,p){n.push(p)}};this.abort=function(){o.aborted=!0,n.forEach(function(u){return u()})}},Yu=b.unstable_scheduleCallback,ed=b.unstable_NormalPriority,Ur={$$typeof:He,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function es(){return{controller:new wl,data:new Map,refCount:0}}function Es(n){n.refCount--,n.refCount===0&&Yu(ed,function(){n.controller.abort()})}var ts=null,Sl=0,Co=0,fi=null;function Bi(n,o){if(ts===null){var u=ts=[];Sl=0,Co=Ch(),fi={status:"pending",value:void 0,then:function(p){u.push(p)}}}return Sl++,o.then(Ku,Ku),o}function Ku(){if(--Sl===0&&ts!==null){fi!==null&&(fi.status="fulfilled");var n=ts;ts=null,Co=0,fi=null;for(var o=0;o<n.length;o++)(0,n[o])()}}function La(n,o){var u=[],p={status:"pending",value:null,reason:null,then:function(x){u.push(x)}};return n.then(function(){p.status="fulfilled",p.value=o;for(var x=0;x<u.length;x++)(0,u[x])(o)},function(x){for(p.status="rejected",p.reason=x,x=0;x<u.length;x++)(0,u[x])(void 0)}),p}var Ms=We.S;We.S=function(n,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Bi(n,o),Ms!==null&&Ms(n,o)};var ka=Xe(null);function Qu(){var n=ka.current;return n!==null?n:or.pooledCache}function eu(n,o){o===null?st(ka,ka.current):st(ka,o.pool)}function vc(){var n=Qu();return n===null?null:{parent:Ur._currentValue,pool:n}}var Pl=Error(D(460)),ns=Error(D(474)),Fi=Error(D(542)),bt={then:function(){}};function tu(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Rs(){}function nu(n,o,u){switch(u=n[u],u===void 0?n.push(o):u!==o&&(o.then(Rs,Rs),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,ru(n),n;default:if(typeof o.status=="string")o.then(Rs,Rs);else{if(n=or,n!==null&&100<n.shellSuspendCounter)throw Error(D(482));n=o,n.status="pending",n.then(function(p){if(o.status==="pending"){var x=o;x.status="fulfilled",x.value=p}},function(p){if(o.status==="pending"){var x=o;x.status="rejected",x.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,ru(n),n}throw Oa=o,Pl}}var Oa=null;function Ds(){if(Oa===null)throw Error(D(459));var n=Oa;return Oa=null,n}function ru(n){if(n===Pl||n===Fi)throw Error(D(483))}var en=!1;function xc(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function iu(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function io(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function To(n,o,u){var p=n.updateQueue;if(p===null)return null;if(p=p.shared,(Xn&2)!==0){var x=p.pending;return x===null?o.next=o:(o.next=x.next,x.next=o),p.pending=o,o=yl(n),qu(n,null,u),o}return fc(n,p,o,u),yl(n)}function Cl(n,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var p=o.lanes;p&=n.pendingLanes,u|=p,o.lanes=u,Rt(n,u)}}function au(n,o){var u=n.updateQueue,p=n.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var x=null,T=null;if(u=u.firstBaseUpdate,u!==null){do{var F={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};T===null?x=T=F:T=T.next=F,u=u.next}while(u!==null);T===null?x=T=o:T=T.next=o}else x=T=o;u={baseState:p.baseState,firstBaseUpdate:x,lastBaseUpdate:T,shared:p.shared,callbacks:p.callbacks},n.updateQueue=u;return}n=u.lastBaseUpdate,n===null?u.firstBaseUpdate=o:n.next=o,u.lastBaseUpdate=o}var bc=!1;function Is(){if(bc){var n=fi;if(n!==null)throw n}}function Tl(n,o,u,p){bc=!1;var x=n.updateQueue;en=!1;var T=x.firstBaseUpdate,F=x.lastBaseUpdate,X=x.shared.pending;if(X!==null){x.shared.pending=null;var fe=X,Ne=fe.next;fe.next=null,F===null?T=Ne:F.next=Ne,F=fe;var Qe=n.alternate;Qe!==null&&(Qe=Qe.updateQueue,X=Qe.lastBaseUpdate,X!==F&&(X===null?Qe.firstBaseUpdate=Ne:X.next=Ne,Qe.lastBaseUpdate=fe))}if(T!==null){var tt=x.baseState;F=0,Qe=Ne=fe=null,X=T;do{var Ve=X.lane&-536870913,Ze=Ve!==X.lane;if(Ze?(An&Ve)===Ve:(p&Ve)===Ve){Ve!==0&&Ve===Co&&(bc=!0),Qe!==null&&(Qe=Qe.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var tn=n,Yt=X;Ve=o;var Jn=u;switch(Yt.tag){case 1:if(tn=Yt.payload,typeof tn=="function"){tt=tn.call(Jn,tt,Ve);break e}tt=tn;break e;case 3:tn.flags=tn.flags&-65537|128;case 0:if(tn=Yt.payload,Ve=typeof tn=="function"?tn.call(Jn,tt,Ve):tn,Ve==null)break e;tt=he({},tt,Ve);break e;case 2:en=!0}}Ve=X.callback,Ve!==null&&(n.flags|=64,Ze&&(n.flags|=8192),Ze=x.callbacks,Ze===null?x.callbacks=[Ve]:Ze.push(Ve))}else Ze={lane:Ve,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Qe===null?(Ne=Qe=Ze,fe=tt):Qe=Qe.next=Ze,F|=Ve;if(X=X.next,X===null){if(X=x.shared.pending,X===null)break;Ze=X,X=Ze.next,Ze.next=null,x.lastBaseUpdate=Ze,x.shared.pending=null}}while(!0);Qe===null&&(fe=tt),x.baseState=fe,x.firstBaseUpdate=Ne,x.lastBaseUpdate=Qe,T===null&&(x.shared.lanes=0),Hs|=F,n.lanes=F,n.memoizedState=tt}}function ou(n,o){if(typeof n!="function")throw Error(D(191,n));n.call(o)}function Ju(n,o){var u=n.callbacks;if(u!==null)for(n.callbacks=null,n=0;n<u.length;n++)ou(u[n],o)}var Ao=Xe(null),Ba=Xe(0);function Ln(n,o){n=Vs,st(Ba,n),st(Ao,o),Vs=n|o.baseLanes}function eh(){st(Ba,Vs),st(Ao,Ao.current)}function Al(){Vs=Ba.current,vt(Ao),vt(Ba)}var Fa=0,pn=null,kn=null,Dr=null,su=!1,Ni=!1,ao=!1,Ct=0,zt=0,Eo=null,th=0;function fr(){throw Error(D(321))}function ei(n,o){if(o===null)return!1;for(var u=0;u<o.length&&u<n.length;u++)if(!Ii(n[u],o[u]))return!1;return!0}function lu(n,o,u,p,x,T){return Fa=T,pn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,We.H=n===null||n.memoizedState===null?oo:so,ao=!1,T=u(p,x),ao=!1,Ni&&(T=rs(o,u,p,x)),ba(n),T}function ba(n){We.H=ni;var o=kn!==null&&kn.next!==null;if(Fa=0,Dr=kn=pn=null,su=!1,zt=0,Eo=null,o)throw Error(D(300));n===null||zr||(n=n.dependencies,n!==null&&_c(n)&&(zr=!0))}function rs(n,o,u,p){pn=n;var x=0;do{if(Ni&&(Eo=null),zt=0,Ni=!1,25<=x)throw Error(D(301));if(x+=1,Dr=kn=null,n.updateQueue!=null){var T=n.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}We.H=os,T=o(u,p)}while(Ni);return T}function El(){var n=We.H,o=n.useState()[0];return o=typeof o.then=="function"?zs(o):o,n=n.useState()[0],(kn!==null?kn.memoizedState:null)!==n&&(pn.flags|=1024),o}function Wn(){var n=Ct!==0;return Ct=0,n}function pr(n,o,u){o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~u}function Ml(n){if(su){for(n=n.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}su=!1}Fa=0,Dr=kn=pn=null,Ni=!1,zt=Ct=0,Eo=null}function ti(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?pn.memoizedState=Dr=n:Dr=Dr.next=n,Dr}function ir(){if(kn===null){var n=pn.alternate;n=n!==null?n.memoizedState:null}else n=kn.next;var o=Dr===null?pn.memoizedState:Dr.next;if(o!==null)Dr=o,kn=n;else{if(n===null)throw pn.alternate===null?Error(D(467)):Error(D(310));kn=n,n={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},Dr===null?pn.memoizedState=Dr=n:Dr=Dr.next=n}return Dr}function Mo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zs(n){var o=zt;return zt+=1,Eo===null&&(Eo=[]),n=nu(Eo,n,o),o=pn,(Dr===null?o.memoizedState:Dr.next)===null&&(o=o.alternate,We.H=o===null||o.memoizedState===null?oo:so),n}function Ls(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return zs(n);if(n.$$typeof===He)return Rr(n)}throw Error(D(438,String(n)))}function Na(n){var o=null,u=pn.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=pn.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(x){return x.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Mo(),pn.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(n),p=0;p<n;p++)u[p]=cn;return o.index++,u}function Ua(n,o){return typeof o=="function"?o(n):o}function Rl(n){var o=ir();return Dl(o,kn,n)}function Dl(n,o,u){var p=n.queue;if(p===null)throw Error(D(311));p.lastRenderedReducer=u;var x=n.baseQueue,T=p.pending;if(T!==null){if(x!==null){var F=x.next;x.next=T.next,T.next=F}o.baseQueue=x=T,p.pending=null}if(T=n.baseState,x===null)n.memoizedState=T;else{o=x.next;var X=F=null,fe=null,Ne=o,Qe=!1;do{var tt=Ne.lane&-536870913;if(tt!==Ne.lane?(An&tt)===tt:(Fa&tt)===tt){var Ve=Ne.revertLane;if(Ve===0)fe!==null&&(fe=fe.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),tt===Co&&(Qe=!0);else if((Fa&Ve)===Ve){Ne=Ne.next,Ve===Co&&(Qe=!0);continue}else tt={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},fe===null?(X=fe=tt,F=T):fe=fe.next=tt,pn.lanes|=Ve,Hs|=Ve;tt=Ne.action,ao&&u(T,tt),T=Ne.hasEagerState?Ne.eagerState:u(T,tt)}else Ve={lane:tt,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},fe===null?(X=fe=Ve,F=T):fe=fe.next=Ve,pn.lanes|=tt,Hs|=tt;Ne=Ne.next}while(Ne!==null&&Ne!==o);if(fe===null?F=T:fe.next=X,!Ii(T,n.memoizedState)&&(zr=!0,Qe&&(u=fi,u!==null)))throw u;n.memoizedState=T,n.baseState=F,n.baseQueue=fe,p.lastRenderedState=T}return x===null&&(p.lanes=0),[n.memoizedState,p.dispatch]}function wc(n){var o=ir(),u=o.queue;if(u===null)throw Error(D(311));u.lastRenderedReducer=n;var p=u.dispatch,x=u.pending,T=o.memoizedState;if(x!==null){u.pending=null;var F=x=x.next;do T=n(T,F.action),F=F.next;while(F!==x);Ii(T,o.memoizedState)||(zr=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),u.lastRenderedState=T}return[T,p]}function f(n,o,u){var p=pn,x=ir(),T=Mn;if(T){if(u===void 0)throw Error(D(407));u=u()}else u=o();var F=!Ii((kn||x).memoizedState,u);F&&(x.memoizedState=u,zr=!0),x=x.queue;var X=l.bind(null,p,x,n);if(Se(2048,8,X,[n]),x.getSnapshot!==o||F||Dr!==null&&Dr.memoizedState.tag&1){if(p.flags|=2048,ae(9,ue(),a.bind(null,p,x,u,o),null),or===null)throw Error(D(349));T||(Fa&124)!==0||e(p,o,u)}return u}function e(n,o,u){n.flags|=16384,n={getSnapshot:o,value:u},o=pn.updateQueue,o===null?(o=Mo(),pn.updateQueue=o,o.stores=[n]):(u=o.stores,u===null?o.stores=[n]:u.push(n))}function a(n,o,u,p){o.value=u,o.getSnapshot=p,d(o)&&g(n)}function l(n,o,u){return u(function(){d(o)&&g(n)})}function d(n){var o=n.getSnapshot;n=n.value;try{var u=o();return!Ii(n,u)}catch{return!0}}function g(n){var o=sa(n,2);o!==null&&fa(o,n,2)}function _(n){var o=ti();if(typeof n=="function"){var u=n;if(n=u(),ao){Ri(!0);try{u()}finally{Ri(!1)}}}return o.memoizedState=o.baseState=n,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:n},o}function S(n,o,u,p){return n.baseState=u,Dl(n,kn,typeof p=="function"?p:Ua)}function P(n,o,u,p,x){if(as(n))throw Error(D(485));if(n=o.action,n!==null){var T={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){T.listeners.push(F)}};We.T!==null?u(!0):T.isTransition=!1,p(T),u=o.pending,u===null?(T.next=o.pending=T,E(o,T)):(T.next=u.next,o.pending=u.next=T)}}function E(n,o){var u=o.action,p=o.payload,x=n.state;if(o.isTransition){var T=We.T,F={};We.T=F;try{var X=u(x,p),fe=We.S;fe!==null&&fe(F,X),I(n,o,X)}catch(Ne){k(n,o,Ne)}finally{We.T=T}}else try{T=u(x,p),I(n,o,T)}catch(Ne){k(n,o,Ne)}}function I(n,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){O(n,o,p)},function(p){return k(n,o,p)}):O(n,o,u)}function O(n,o,u){o.status="fulfilled",o.value=u,N(o),n.state=u,o=n.pending,o!==null&&(u=o.next,u===o?n.pending=null:(u=u.next,o.next=u,E(n,u)))}function k(n,o,u){var p=n.pending;if(n.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,N(o),o=o.next;while(o!==p)}n.action=null}function N(n){n=n.listeners;for(var o=0;o<n.length;o++)(0,n[o])()}function W(n,o){return o}function J(n,o){if(Mn){var u=or.formState;if(u!==null){e:{var p=pn;if(Mn){if(ur){t:{for(var x=ur,T=Ia;x.nodeType!==8;){if(!T){x=null;break t}if(x=fo(x.nextSibling),x===null){x=null;break t}}T=x.data,x=T==="F!"||T==="F"?x:null}if(x){ur=fo(x.nextSibling),p=x.data==="F!";break e}}So(p)}p=!1}p&&(o=u[0])}}return u=ti(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:W,lastRenderedState:o},u.queue=p,u=Ro.bind(null,pn,p),p.dispatch=u,p=_(!1),T=Do.bind(null,pn,!1,p.queue),p=ti(),x={state:o,dispatch:null,action:n,pending:null},p.queue=x,u=P.bind(null,pn,x,T,u),x.dispatch=u,p.memoizedState=n,[o,u,!1]}function ee(n){var o=ir();return te(o,kn,n)}function te(n,o,u){if(o=Dl(n,o,W)[0],n=Rl(Ua)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var p=zs(o)}catch(F){throw F===Pl?Fi:F}else p=o;o=ir();var x=o.queue,T=x.dispatch;return u!==o.memoizedState&&(pn.flags|=2048,ae(9,ue(),ie.bind(null,x,u),null)),[p,T,n]}function ie(n,o){n.action=o}function le(n){var o=ir(),u=kn;if(u!==null)return te(o,u,n);ir(),o=o.memoizedState,u=ir();var p=u.queue.dispatch;return u.memoizedState=n,[o,p,!1]}function ae(n,o,u,p){return n={tag:n,create:u,deps:p,inst:o,next:null},o=pn.updateQueue,o===null&&(o=Mo(),pn.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=n.next=n:(p=u.next,u.next=n,n.next=p,o.lastEffect=n),n}function ue(){return{destroy:void 0,resource:void 0}}function me(){return ir().memoizedState}function oe(n,o,u,p){var x=ti();p=p===void 0?null:p,pn.flags|=n,x.memoizedState=ae(1|o,ue(),u,p)}function Se(n,o,u,p){var x=ir();p=p===void 0?null:p;var T=x.memoizedState.inst;kn!==null&&p!==null&&ei(p,kn.memoizedState.deps)?x.memoizedState=ae(o,T,u,p):(pn.flags|=n,x.memoizedState=ae(1|o,T,u,p))}function Ue(n,o){oe(8390656,8,n,o)}function Ie(n,o){Se(2048,8,n,o)}function Oe(n,o){return Se(4,2,n,o)}function je(n,o){return Se(4,4,n,o)}function pt(n,o){if(typeof o=="function"){n=n();var u=o(n);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function ht(n,o,u){u=u!=null?u.concat([n]):null,Se(4,4,pt.bind(null,o,n),u)}function Ke(){}function Tt(n,o){var u=ir();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&ei(o,p[1])?p[0]:(u.memoizedState=[n,o],n)}function ln(n,o){var u=ir();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&ei(o,p[1]))return p[0];if(p=n(),ao){Ri(!0);try{n()}finally{Ri(!1)}}return u.memoizedState=[p,o],p}function Pn(n,o,u){return u===void 0||(Fa&1073741824)!==0?n.memoizedState=o:(n.memoizedState=u,n=qr(),pn.lanes|=n,Hs|=n,u)}function ar(n,o,u,p){return Ii(u,o)?u:Ao.current!==null?(n=Pn(n,u,p),Ii(n,o)||(zr=!0),n):(Fa&42)===0?(zr=!0,n.memoizedState=u):(n=qr(),pn.lanes|=n,Hs|=n,o)}function Fn(n,o,u,p,x){var T=mt.p;mt.p=T!==0&&8>T?T:8;var F=We.T,X={};We.T=X,Do(n,!1,o,u);try{var fe=x(),Ne=We.S;if(Ne!==null&&Ne(X,fe),fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Qe=La(fe,p);ji(n,o,Qe,Zi(n))}else ji(n,o,p,Zi(n))}catch(tt){ji(n,o,{then:function(){},status:"rejected",reason:tt},Zi())}finally{mt.p=T,We.T=F}}function Nn(){}function $n(n,o,u,p){if(n.tag!==5)throw Error(D(476));var x=Gn(n).queue;Fn(n,x,o,rt,u===null?Nn:function(){return Un(n),u(p)})}function Gn(n){var o=n.memoizedState;if(o!==null)return o;o={memoizedState:rt,baseState:rt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:rt},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:u},next:null},n.memoizedState=o,n=n.alternate,n!==null&&(n.memoizedState=o),o}function Un(n){var o=Gn(n).next.queue;ji(n,o,{},Zi())}function vn(){return Rr(z)}function jr(){return ir().memoizedState}function Ir(){return ir().memoizedState}function Ui(n){for(var o=n.return;o!==null;){switch(o.tag){case 24:case 3:var u=Zi();n=io(u);var p=To(o,n,u);p!==null&&(fa(p,o,u),Cl(p,o,u)),o={cache:es()},n.payload=o;return}o=o.return}}function is(n,o,u){var p=Zi();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},as(n)?Sc(o,u):(u=$o(n,o,u,p),u!==null&&(fa(u,n,p),Io(u,o,p)))}function Ro(n,o,u){var p=Zi();ji(n,o,u,p)}function ji(n,o,u,p){var x={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(as(n))Sc(o,x);else{var T=n.alternate;if(n.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var F=o.lastRenderedState,X=T(F,u);if(x.hasEagerState=!0,x.eagerState=X,Ii(X,F))return fc(n,o,x,0),or===null&&As(),!1}catch{}finally{}if(u=$o(n,o,x,p),u!==null)return fa(u,n,p),Io(u,o,p),!0}return!1}function Do(n,o,u,p){if(p={lane:2,revertLane:Ch(),action:p,hasEagerState:!1,eagerState:null,next:null},as(n)){if(o)throw Error(D(479))}else o=$o(n,u,p,2),o!==null&&fa(o,n,2)}function as(n){var o=n.alternate;return n===pn||o!==null&&o===pn}function Sc(n,o){Ni=su=!0;var u=n.pending;u===null?o.next=o:(o.next=u.next,u.next=o),n.pending=o}function Io(n,o,u){if((u&4194048)!==0){var p=o.lanes;p&=n.pendingLanes,u|=p,o.lanes=u,Rt(n,u)}}var ni={readContext:Rr,use:Ls,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useLayoutEffect:fr,useInsertionEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useSyncExternalStore:fr,useId:fr,useHostTransitionStatus:fr,useFormState:fr,useActionState:fr,useOptimistic:fr,useMemoCache:fr,useCacheRefresh:fr},oo={readContext:Rr,use:Ls,useCallback:function(n,o){return ti().memoizedState=[n,o===void 0?null:o],n},useContext:Rr,useEffect:Ue,useImperativeHandle:function(n,o,u){u=u!=null?u.concat([n]):null,oe(4194308,4,pt.bind(null,o,n),u)},useLayoutEffect:function(n,o){return oe(4194308,4,n,o)},useInsertionEffect:function(n,o){oe(4,2,n,o)},useMemo:function(n,o){var u=ti();o=o===void 0?null:o;var p=n();if(ao){Ri(!0);try{n()}finally{Ri(!1)}}return u.memoizedState=[p,o],p},useReducer:function(n,o,u){var p=ti();if(u!==void 0){var x=u(o);if(ao){Ri(!0);try{u(o)}finally{Ri(!1)}}}else x=o;return p.memoizedState=p.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},p.queue=n,n=n.dispatch=is.bind(null,pn,n),[p.memoizedState,n]},useRef:function(n){var o=ti();return n={current:n},o.memoizedState=n},useState:function(n){n=_(n);var o=n.queue,u=Ro.bind(null,pn,o);return o.dispatch=u,[n.memoizedState,u]},useDebugValue:Ke,useDeferredValue:function(n,o){var u=ti();return Pn(u,n,o)},useTransition:function(){var n=_(!1);return n=Fn.bind(null,pn,n.queue,!0,!1),ti().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,o,u){var p=pn,x=ti();if(Mn){if(u===void 0)throw Error(D(407));u=u()}else{if(u=o(),or===null)throw Error(D(349));(An&124)!==0||e(p,o,u)}x.memoizedState=u;var T={value:u,getSnapshot:o};return x.queue=T,Ue(l.bind(null,p,T,n),[n]),p.flags|=2048,ae(9,ue(),a.bind(null,p,T,u,o),null),u},useId:function(){var n=ti(),o=or.identifierPrefix;if(Mn){var u=Li,p=ua;u=(p&~(1<<32-xe(p)-1)).toString(32)+u,o="«"+o+"R"+u,u=Ct++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=th++,o="«"+o+"r"+u.toString(32)+"»";return n.memoizedState=o},useHostTransitionStatus:vn,useFormState:J,useActionState:J,useOptimistic:function(n){var o=ti();o.memoizedState=o.baseState=n;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Do.bind(null,pn,!0,u),u.dispatch=o,[n,o]},useMemoCache:Na,useCacheRefresh:function(){return ti().memoizedState=Ui.bind(null,pn)}},so={readContext:Rr,use:Ls,useCallback:Tt,useContext:Rr,useEffect:Ie,useImperativeHandle:ht,useInsertionEffect:Oe,useLayoutEffect:je,useMemo:ln,useReducer:Rl,useRef:me,useState:function(){return Rl(Ua)},useDebugValue:Ke,useDeferredValue:function(n,o){var u=ir();return ar(u,kn.memoizedState,n,o)},useTransition:function(){var n=Rl(Ua)[0],o=ir().memoizedState;return[typeof n=="boolean"?n:zs(n),o]},useSyncExternalStore:f,useId:jr,useHostTransitionStatus:vn,useFormState:ee,useActionState:ee,useOptimistic:function(n,o){var u=ir();return S(u,kn,n,o)},useMemoCache:Na,useCacheRefresh:Ir},os={readContext:Rr,use:Ls,useCallback:Tt,useContext:Rr,useEffect:Ie,useImperativeHandle:ht,useInsertionEffect:Oe,useLayoutEffect:je,useMemo:ln,useReducer:wc,useRef:me,useState:function(){return wc(Ua)},useDebugValue:Ke,useDeferredValue:function(n,o){var u=ir();return kn===null?Pn(u,n,o):ar(u,kn.memoizedState,n,o)},useTransition:function(){var n=wc(Ua)[0],o=ir().memoizedState;return[typeof n=="boolean"?n:zs(n),o]},useSyncExternalStore:f,useId:jr,useHostTransitionStatus:vn,useFormState:le,useActionState:le,useOptimistic:function(n,o){var u=ir();return kn!==null?S(u,kn,n,o):(u.baseState=n,[n,u.queue.dispatch])},useMemoCache:Na,useCacheRefresh:Ir},Dn=null,hr=0;function Si(n){var o=hr;return hr+=1,Dn===null&&(Dn=[]),nu(Dn,n,o)}function xr(n,o){o=o.props.ref,n.ref=o!==void 0?o:null}function cu(n,o){throw o.$$typeof===we?Error(D(525)):(n=Object.prototype.toString.call(o),Error(D(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n)))}function uu(n){var o=n._init;return o(n._payload)}function Il(n){function o(Me,Ae){if(n){var Le=Me.deletions;Le===null?(Me.deletions=[Ae],Me.flags|=16):Le.push(Ae)}}function u(Me,Ae){if(!n)return null;for(;Ae!==null;)o(Me,Ae),Ae=Ae.sibling;return null}function p(Me){for(var Ae=new Map;Me!==null;)Me.key!==null?Ae.set(Me.key,Me):Ae.set(Me.index,Me),Me=Me.sibling;return Ae}function x(Me,Ae){return Me=bi(Me,Ae),Me.index=0,Me.sibling=null,Me}function T(Me,Ae,Le){return Me.index=Le,n?(Le=Me.alternate,Le!==null?(Le=Le.index,Le<Ae?(Me.flags|=67108866,Ae):Le):(Me.flags|=67108866,Ae)):(Me.flags|=1048576,Ae)}function F(Me){return n&&Me.alternate===null&&(Me.flags|=67108866),Me}function X(Me,Ae,Le,et){return Ae===null||Ae.tag!==6?(Ae=$u(Le,Me.mode,et),Ae.return=Me,Ae):(Ae=x(Ae,Le),Ae.return=Me,Ae)}function fe(Me,Ae,Le,et){var Lt=Le.type;return Lt===Re?Qe(Me,Ae,Le.props.children,et,Le.key):Ae!==null&&(Ae.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===ot&&uu(Lt)===Ae.type)?(Ae=x(Ae,Le.props),xr(Ae,Le),Ae.return=Me,Ae):(Ae=Yc(Le.type,Le.key,Le.props,null,Me.mode,et),xr(Ae,Le),Ae.return=Me,Ae)}function Ne(Me,Ae,Le,et){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==Le.containerInfo||Ae.stateNode.implementation!==Le.implementation?(Ae=mc(Le,Me.mode,et),Ae.return=Me,Ae):(Ae=x(Ae,Le.children||[]),Ae.return=Me,Ae)}function Qe(Me,Ae,Le,et,Lt){return Ae===null||Ae.tag!==7?(Ae=Xo(Le,Me.mode,et,Lt),Ae.return=Me,Ae):(Ae=x(Ae,Le),Ae.return=Me,Ae)}function tt(Me,Ae,Le){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Ae=$u(""+Ae,Me.mode,Le),Ae.return=Me,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case ge:return Le=Yc(Ae.type,Ae.key,Ae.props,null,Me.mode,Le),xr(Le,Ae),Le.return=Me,Le;case ne:return Ae=mc(Ae,Me.mode,Le),Ae.return=Me,Ae;case ot:var et=Ae._init;return Ae=et(Ae._payload),tt(Me,Ae,Le)}if(mn(Ae)||on(Ae))return Ae=Xo(Ae,Me.mode,Le,null),Ae.return=Me,Ae;if(typeof Ae.then=="function")return tt(Me,Si(Ae),Le);if(Ae.$$typeof===He)return tt(Me,Qi(Me,Ae),Le);cu(Me,Ae)}return null}function Ve(Me,Ae,Le,et){var Lt=Ae!==null?Ae.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Lt!==null?null:X(Me,Ae,""+Le,et);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case ge:return Le.key===Lt?fe(Me,Ae,Le,et):null;case ne:return Le.key===Lt?Ne(Me,Ae,Le,et):null;case ot:return Lt=Le._init,Le=Lt(Le._payload),Ve(Me,Ae,Le,et)}if(mn(Le)||on(Le))return Lt!==null?null:Qe(Me,Ae,Le,et,null);if(typeof Le.then=="function")return Ve(Me,Ae,Si(Le),et);if(Le.$$typeof===He)return Ve(Me,Ae,Qi(Me,Le),et);cu(Me,Le)}return null}function Ze(Me,Ae,Le,et,Lt){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return Me=Me.get(Le)||null,X(Ae,Me,""+et,Lt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case ge:return Me=Me.get(et.key===null?Le:et.key)||null,fe(Ae,Me,et,Lt);case ne:return Me=Me.get(et.key===null?Le:et.key)||null,Ne(Ae,Me,et,Lt);case ot:var wn=et._init;return et=wn(et._payload),Ze(Me,Ae,Le,et,Lt)}if(mn(et)||on(et))return Me=Me.get(Le)||null,Qe(Ae,Me,et,Lt,null);if(typeof et.then=="function")return Ze(Me,Ae,Le,Si(et),Lt);if(et.$$typeof===He)return Ze(Me,Ae,Le,Qi(Ae,et),Lt);cu(Ae,et)}return null}function tn(Me,Ae,Le,et){for(var Lt=null,wn=null,Vt=Ae,Jt=Ae=0,Ei=null;Vt!==null&&Jt<Le.length;Jt++){Vt.index>Jt?(Ei=Vt,Vt=null):Ei=Vt.sibling;var On=Ve(Me,Vt,Le[Jt],et);if(On===null){Vt===null&&(Vt=Ei);break}n&&Vt&&On.alternate===null&&o(Me,Vt),Ae=T(On,Ae,Jt),wn===null?Lt=On:wn.sibling=On,wn=On,Vt=Ei}if(Jt===Le.length)return u(Me,Vt),Mn&&Da(Me,Jt),Lt;if(Vt===null){for(;Jt<Le.length;Jt++)Vt=tt(Me,Le[Jt],et),Vt!==null&&(Ae=T(Vt,Ae,Jt),wn===null?Lt=Vt:wn.sibling=Vt,wn=Vt);return Mn&&Da(Me,Jt),Lt}for(Vt=p(Vt);Jt<Le.length;Jt++)Ei=Ze(Vt,Me,Jt,Le[Jt],et),Ei!==null&&(n&&Ei.alternate!==null&&Vt.delete(Ei.key===null?Jt:Ei.key),Ae=T(Ei,Ae,Jt),wn===null?Lt=Ei:wn.sibling=Ei,wn=Ei);return n&&Vt.forEach(function(Hl){return o(Me,Hl)}),Mn&&Da(Me,Jt),Lt}function Yt(Me,Ae,Le,et){if(Le==null)throw Error(D(151));for(var Lt=null,wn=null,Vt=Ae,Jt=Ae=0,Ei=null,On=Le.next();Vt!==null&&!On.done;Jt++,On=Le.next()){Vt.index>Jt?(Ei=Vt,Vt=null):Ei=Vt.sibling;var Hl=Ve(Me,Vt,On.value,et);if(Hl===null){Vt===null&&(Vt=Ei);break}n&&Vt&&Hl.alternate===null&&o(Me,Vt),Ae=T(Hl,Ae,Jt),wn===null?Lt=Hl:wn.sibling=Hl,wn=Hl,Vt=Ei}if(On.done)return u(Me,Vt),Mn&&Da(Me,Jt),Lt;if(Vt===null){for(;!On.done;Jt++,On=Le.next())On=tt(Me,On.value,et),On!==null&&(Ae=T(On,Ae,Jt),wn===null?Lt=On:wn.sibling=On,wn=On);return Mn&&Da(Me,Jt),Lt}for(Vt=p(Vt);!On.done;Jt++,On=Le.next())On=Ze(Vt,Me,Jt,On.value,et),On!==null&&(n&&On.alternate!==null&&Vt.delete(On.key===null?Jt:On.key),Ae=T(On,Ae,Jt),wn===null?Lt=On:wn.sibling=On,wn=On);return n&&Vt.forEach(function(Fm){return o(Me,Fm)}),Mn&&Da(Me,Jt),Lt}function Jn(Me,Ae,Le,et){if(typeof Le=="object"&&Le!==null&&Le.type===Re&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case ge:e:{for(var Lt=Le.key;Ae!==null;){if(Ae.key===Lt){if(Lt=Le.type,Lt===Re){if(Ae.tag===7){u(Me,Ae.sibling),et=x(Ae,Le.props.children),et.return=Me,Me=et;break e}}else if(Ae.elementType===Lt||typeof Lt=="object"&&Lt!==null&&Lt.$$typeof===ot&&uu(Lt)===Ae.type){u(Me,Ae.sibling),et=x(Ae,Le.props),xr(et,Le),et.return=Me,Me=et;break e}u(Me,Ae);break}else o(Me,Ae);Ae=Ae.sibling}Le.type===Re?(et=Xo(Le.props.children,Me.mode,et,Le.key),et.return=Me,Me=et):(et=Yc(Le.type,Le.key,Le.props,null,Me.mode,et),xr(et,Le),et.return=Me,Me=et)}return F(Me);case ne:e:{for(Lt=Le.key;Ae!==null;){if(Ae.key===Lt)if(Ae.tag===4&&Ae.stateNode.containerInfo===Le.containerInfo&&Ae.stateNode.implementation===Le.implementation){u(Me,Ae.sibling),et=x(Ae,Le.children||[]),et.return=Me,Me=et;break e}else{u(Me,Ae);break}else o(Me,Ae);Ae=Ae.sibling}et=mc(Le,Me.mode,et),et.return=Me,Me=et}return F(Me);case ot:return Lt=Le._init,Le=Lt(Le._payload),Jn(Me,Ae,Le,et)}if(mn(Le))return tn(Me,Ae,Le,et);if(on(Le)){if(Lt=on(Le),typeof Lt!="function")throw Error(D(150));return Le=Lt.call(Le),Yt(Me,Ae,Le,et)}if(typeof Le.then=="function")return Jn(Me,Ae,Si(Le),et);if(Le.$$typeof===He)return Jn(Me,Ae,Qi(Me,Le),et);cu(Me,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint"?(Le=""+Le,Ae!==null&&Ae.tag===6?(u(Me,Ae.sibling),et=x(Ae,Le),et.return=Me,Me=et):(u(Me,Ae),et=$u(Le,Me.mode,et),et.return=Me,Me=et),F(Me)):u(Me,Ae)}return function(Me,Ae,Le,et){try{hr=0;var Lt=Jn(Me,Ae,Le,et);return Dn=null,Lt}catch(Vt){if(Vt===Pl||Vt===Fi)throw Vt;var wn=la(29,Vt,null,Me.mode);return wn.lanes=et,wn.return=Me,wn}finally{}}}var ja=Il(!0),lo=Il(!1),Sr=Xe(null),br=null;function co(n){var o=n.alternate;st(Pr,Pr.current&1),st(Sr,n),br===null&&(o===null||Ao.current!==null||o.memoizedState!==null)&&(br=n)}function zo(n){if(n.tag===22){if(st(Pr,Pr.current),st(Sr,n),br===null){var o=n.alternate;o!==null&&o.memoizedState!==null&&(br=n)}}else Lo()}function Lo(){st(Pr,Pr.current),st(Sr,Sr.current)}function wa(n){vt(Sr),br===n&&(br=null),vt(Pr)}var Pr=Xe(0);function ks(n){for(var o=n;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||Ff(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Os(n,o,u,p){o=n.memoizedState,u=u(p,o),u=u==null?o:he({},o,u),n.memoizedState=u,n.lanes===0&&(n.updateQueue.baseState=u)}var Bs={enqueueSetState:function(n,o,u){n=n._reactInternals;var p=Zi(),x=io(p);x.payload=o,u!=null&&(x.callback=u),o=To(n,x,p),o!==null&&(fa(o,n,p),Cl(o,n,p))},enqueueReplaceState:function(n,o,u){n=n._reactInternals;var p=Zi(),x=io(p);x.tag=1,x.payload=o,u!=null&&(x.callback=u),o=To(n,x,p),o!==null&&(fa(o,n,p),Cl(o,n,p))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var u=Zi(),p=io(u);p.tag=2,o!=null&&(p.callback=o),o=To(n,p,u),o!==null&&(fa(o,n,u),Cl(o,n,u))}};function jd(n,o,u,p,x,T,F){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(p,T,F):o.prototype&&o.prototype.isPureReactComponent?!ml(u,p)||!ml(x,T):!0}function ip(n,o,u,p){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==n&&Bs.enqueueReplaceState(o,o.state,null)}function Fs(n,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(n=n.defaultProps){u===o&&(u=he({},u));for(var x in n)u[x]===void 0&&(u[x]=n[x])}return u}var nh=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function rh(n){nh(n)}function Vd(n){console.error(n)}function ap(n){nh(n)}function hu(n,o){try{var u=n.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function op(n,o,u){try{var p=n.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function ih(n,o,u){return u=io(u),u.tag=3,u.payload={element:null},u.callback=function(){hu(n,o)},u}function Hd(n){return n=io(n),n.tag=3,n}function Gd(n,o,u,p){var x=u.type.getDerivedStateFromError;if(typeof x=="function"){var T=p.value;n.payload=function(){return x(T)},n.callback=function(){op(o,u,p)}}var F=u.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(n.callback=function(){op(o,u,p),typeof x!="function"&&(Ll===null?Ll=new Set([this]):Ll.add(this));var X=p.stack;this.componentDidCatch(p.value,{componentStack:X!==null?X:""})})}function du(n,o,u,p,x){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&bl(o,u,x,!0),u=Sr.current,u!==null){switch(u.tag){case 13:return br===null?yf():u.alternate===null&&mr===0&&(mr=3),u.flags&=-257,u.flags|=65536,u.lanes=x,p===bt?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),bf(n,p,x)),!1;case 22:return u.flags|=65536,p===bt?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),bf(n,p,x)),!1}throw Error(D(435,u.tag))}return bf(n,p,x),yf(),!1}if(Mn)return o=Sr.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=x,p!==vl&&(n=Error(D(422),{cause:p}),Qo(Jr(n,u)))):(p!==vl&&(o=Error(D(423),{cause:p}),Qo(Jr(o,u))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,p=Jr(p,u),x=ih(n.stateNode,p,x),au(n,x),mr!==4&&(mr=2)),!1;var T=Error(D(520),{cause:p});if(T=Jr(T,u),gh===null?gh=[T]:gh.push(T),mr!==4&&(mr=2),o===null)return!0;p=Jr(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,n=x&-x,u.lanes|=n,n=ih(u.stateNode,p,n),au(u,n),!1;case 1:if(o=u.type,T=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ll===null||!Ll.has(T))))return u.flags|=65536,x&=-x,u.lanes|=x,x=Hd(x),Gd(x,n,u,p),au(u,x),!1}u=u.return}while(u!==null);return!1}var sp=Error(D(461)),zr=!1;function ri(n,o,u,p){o.child=n===null?lo(o,null,u,p):ja(o,n.child,u,p)}function ah(n,o,u,p,x){u=u.render;var T=o.ref;if("ref"in p){var F={};for(var X in p)X!=="ref"&&(F[X]=p[X])}else F=p;return Jo(o),p=lu(n,o,u,F,T,x),X=Wn(),n!==null&&!zr?(pr(n,o,x),ko(n,o,x)):(Mn&&X&&wo(o),o.flags|=1,ri(n,o,p,x),o.child)}function lp(n,o,u,p,x){if(n===null){var T=u.type;return typeof T=="function"&&!Xc(T)&&T.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=T,cp(n,o,T,p,x)):(n=Yc(u.type,null,p,o,o.mode,x),n.ref=o.ref,n.return=o,o.child=n)}if(T=n.child,!Xd(n,x)){var F=T.memoizedProps;if(u=u.compare,u=u!==null?u:ml,u(F,p)&&n.ref===o.ref)return ko(n,o,x)}return o.flags|=1,n=bi(T,p),n.ref=o.ref,n.return=o,o.child=n}function cp(n,o,u,p,x){if(n!==null){var T=n.memoizedProps;if(ml(T,p)&&n.ref===o.ref)if(zr=!1,o.pendingProps=p=T,Xd(n,x))(n.flags&131072)!==0&&(zr=!0);else return o.lanes=n.lanes,ko(n,o,x)}return sh(n,o,u,p,x)}function up(n,o,u){var p=o.pendingProps,x=p.children,T=n!==null?n.memoizedState:null;if(p.mode==="hidden"){if((o.flags&128)!==0){if(p=T!==null?T.baseLanes|u:u,n!==null){for(x=o.child=n.child,T=0;x!==null;)T=T|x.lanes|x.childLanes,x=x.sibling;o.childLanes=T&~p}else o.childLanes=0,o.child=null;return hp(n,o,p,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},n!==null&&eu(o,T!==null?T.cachePool:null),T!==null?Ln(o,T):eh(),zo(o);else return o.lanes=o.childLanes=536870912,hp(n,o,T!==null?T.baseLanes|u:u,u)}else T!==null?(eu(o,T.cachePool),Ln(o,T),Lo(),o.memoizedState=null):(n!==null&&eu(o,null),eh(),Lo());return ri(n,o,x,u),o.child}function hp(n,o,u,p){var x=Qu();return x=x===null?null:{parent:Ur._currentValue,pool:x},o.memoizedState={baseLanes:u,cachePool:x},n!==null&&eu(o,null),eh(),zo(o),n!==null&&bl(n,o,p,!0),null}function oh(n,o){var u=o.ref;if(u===null)n!==null&&n.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(D(284));(n===null||n.ref!==u)&&(o.flags|=4194816)}}function sh(n,o,u,p,x){return Jo(o),u=lu(n,o,u,p,void 0,x),p=Wn(),n!==null&&!zr?(pr(n,o,x),ko(n,o,x)):(Mn&&p&&wo(o),o.flags|=1,ri(n,o,u,x),o.child)}function Zd(n,o,u,p,x,T){return Jo(o),o.updateQueue=null,u=rs(o,p,u,x),ba(n),p=Wn(),n!==null&&!zr?(pr(n,o,T),ko(n,o,T)):(Mn&&p&&wo(o),o.flags|=1,ri(n,o,u,T),o.child)}function qd(n,o,u,p,x){if(Jo(o),o.stateNode===null){var T=sn,F=u.contextType;typeof F=="object"&&F!==null&&(T=Rr(F)),T=new u(p,T),o.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=Bs,o.stateNode=T,T._reactInternals=o,T=o.stateNode,T.props=p,T.state=o.memoizedState,T.refs={},xc(o),F=u.contextType,T.context=typeof F=="object"&&F!==null?Rr(F):sn,T.state=o.memoizedState,F=u.getDerivedStateFromProps,typeof F=="function"&&(Os(o,u,F,p),T.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(F=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),F!==T.state&&Bs.enqueueReplaceState(T,T.state,null),Tl(o,p,T,x),Is(),T.state=o.memoizedState),typeof T.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(n===null){T=o.stateNode;var X=o.memoizedProps,fe=Fs(u,X);T.props=fe;var Ne=T.context,Qe=u.contextType;F=sn,typeof Qe=="object"&&Qe!==null&&(F=Rr(Qe));var tt=u.getDerivedStateFromProps;Qe=typeof tt=="function"||typeof T.getSnapshotBeforeUpdate=="function",X=o.pendingProps!==X,Qe||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(X||Ne!==F)&&ip(o,T,p,F),en=!1;var Ve=o.memoizedState;T.state=Ve,Tl(o,p,T,x),Is(),Ne=o.memoizedState,X||Ve!==Ne||en?(typeof tt=="function"&&(Os(o,u,tt,p),Ne=o.memoizedState),(fe=en||jd(o,u,fe,p,Ve,Ne,F))?(Qe||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(o.flags|=4194308)):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=Ne),T.props=p,T.state=Ne,T.context=F,p=fe):(typeof T.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{T=o.stateNode,iu(n,o),F=o.memoizedProps,Qe=Fs(u,F),T.props=Qe,tt=o.pendingProps,Ve=T.context,Ne=u.contextType,fe=sn,typeof Ne=="object"&&Ne!==null&&(fe=Rr(Ne)),X=u.getDerivedStateFromProps,(Ne=typeof X=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(F!==tt||Ve!==fe)&&ip(o,T,p,fe),en=!1,Ve=o.memoizedState,T.state=Ve,Tl(o,p,T,x),Is();var Ze=o.memoizedState;F!==tt||Ve!==Ze||en||n!==null&&n.dependencies!==null&&_c(n.dependencies)?(typeof X=="function"&&(Os(o,u,X,p),Ze=o.memoizedState),(Qe=en||jd(o,u,Qe,p,Ve,Ze,fe)||n!==null&&n.dependencies!==null&&_c(n.dependencies))?(Ne||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(p,Ze,fe),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(p,Ze,fe)),typeof T.componentDidUpdate=="function"&&(o.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof T.componentDidUpdate!="function"||F===n.memoizedProps&&Ve===n.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||F===n.memoizedProps&&Ve===n.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=Ze),T.props=p,T.state=Ze,T.context=fe,p=Qe):(typeof T.componentDidUpdate!="function"||F===n.memoizedProps&&Ve===n.memoizedState||(o.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||F===n.memoizedProps&&Ve===n.memoizedState||(o.flags|=1024),p=!1)}return T=p,oh(n,o),p=(o.flags&128)!==0,T||p?(T=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:T.render(),o.flags|=1,n!==null&&p?(o.child=ja(o,n.child,null,x),o.child=ja(o,null,u,x)):ri(n,o,u,x),o.memoizedState=T.state,n=o.child):n=ko(n,o,x),n}function dp(n,o,u,p){return za(),o.flags|=256,ri(n,o,u,p),o.child}var Wd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function td(n){return{baseLanes:n,cachePool:vc()}}function nd(n,o,u){return n=n!==null?n.childLanes&~u:0,o&&(n|=ho),n}function fp(n,o,u){var p=o.pendingProps,x=!1,T=(o.flags&128)!==0,F;if((F=T)||(F=n!==null&&n.memoizedState===null?!1:(Pr.current&2)!==0),F&&(x=!0,o.flags&=-129),F=(o.flags&32)!==0,o.flags&=-33,n===null){if(Mn){if(x?co(o):Lo(),Mn){var X=ur,fe;if(fe=X){e:{for(fe=X,X=Ia;fe.nodeType!==8;){if(!X){X=null;break e}if(fe=fo(fe.nextSibling),fe===null){X=null;break e}}X=fe}X!==null?(o.memoizedState={dehydrated:X,treeContext:Ra!==null?{id:ua,overflow:Li}:null,retryLane:536870912,hydrationErrors:null},fe=la(18,null,null,0),fe.stateNode=X,fe.return=o,o.child=fe,Gr=o,ur=null,fe=!0):fe=!1}fe||So(o)}if(X=o.memoizedState,X!==null&&(X=X.dehydrated,X!==null))return Ff(X)?o.lanes=32:o.lanes=536870912,null;wa(o)}return X=p.children,p=p.fallback,x?(Lo(),x=o.mode,X=ch({mode:"hidden",children:X},x),p=Xo(p,x,u,null),X.return=o,p.return=o,X.sibling=p,o.child=X,x=o.child,x.memoizedState=td(u),x.childLanes=nd(n,F,u),o.memoizedState=Wd,p):(co(o),lh(o,X))}if(fe=n.memoizedState,fe!==null&&(X=fe.dehydrated,X!==null)){if(T)o.flags&256?(co(o),o.flags&=-257,o=uh(n,o,u)):o.memoizedState!==null?(Lo(),o.child=n.child,o.flags|=128,o=null):(Lo(),x=p.fallback,X=o.mode,p=ch({mode:"visible",children:p.children},X),x=Xo(x,X,u,null),x.flags|=2,p.return=o,x.return=o,p.sibling=x,o.child=p,ja(o,n.child,null,u),p=o.child,p.memoizedState=td(u),p.childLanes=nd(n,F,u),o.memoizedState=Wd,o=x);else if(co(o),Ff(X)){if(F=X.nextSibling&&X.nextSibling.dataset,F)var Ne=F.dgst;F=Ne,p=Error(D(419)),p.stack="",p.digest=F,Qo({value:p,source:null,stack:null}),o=uh(n,o,u)}else if(zr||bl(n,o,u,!1),F=(u&n.childLanes)!==0,zr||F){if(F=or,F!==null&&(p=u&-u,p=(p&42)!==0?1:Wt(p),p=(p&(F.suspendedLanes|u))!==0?0:p,p!==0&&p!==fe.retryLane))throw fe.retryLane=p,sa(n,p),fa(F,n,p),sp;X.data==="$?"||yf(),o=uh(n,o,u)}else X.data==="$?"?(o.flags|=192,o.child=n.child,o=null):(n=fe.treeContext,ur=fo(X.nextSibling),Gr=o,Mn=!0,Ko=null,Ia=!1,n!==null&&(ca[wi++]=ua,ca[wi++]=Li,ca[wi++]=Ra,ua=n.id,Li=n.overflow,Ra=o),o=lh(o,p.children),o.flags|=4096);return o}return x?(Lo(),x=p.fallback,X=o.mode,fe=n.child,Ne=fe.sibling,p=bi(fe,{mode:"hidden",children:p.children}),p.subtreeFlags=fe.subtreeFlags&65011712,Ne!==null?x=bi(Ne,x):(x=Xo(x,X,u,null),x.flags|=2),x.return=o,p.return=o,p.sibling=x,o.child=p,p=x,x=o.child,X=n.child.memoizedState,X===null?X=td(u):(fe=X.cachePool,fe!==null?(Ne=Ur._currentValue,fe=fe.parent!==Ne?{parent:Ne,pool:Ne}:fe):fe=vc(),X={baseLanes:X.baseLanes|u,cachePool:fe}),x.memoizedState=X,x.childLanes=nd(n,F,u),o.memoizedState=Wd,p):(co(o),u=n.child,n=u.sibling,u=bi(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,n!==null&&(F=o.deletions,F===null?(o.deletions=[n],o.flags|=16):F.push(n)),o.child=u,o.memoizedState=null,u)}function lh(n,o){return o=ch({mode:"visible",children:o},n.mode),o.return=n,n.child=o}function ch(n,o){return n=la(22,n,null,o),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function uh(n,o,u){return ja(o,n.child,null,u),n=lh(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function fu(n,o,u){n.lanes|=o;var p=n.alternate;p!==null&&(p.lanes|=o),yc(n.return,o,u)}function Vi(n,o,u,p,x){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:x}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=p,T.tail=u,T.tailMode=x)}function $d(n,o,u){var p=o.pendingProps,x=p.revealOrder,T=p.tail;if(ri(n,o,p.children,u),p=Pr.current,(p&2)!==0)p=p&1|2,o.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&fu(n,u,o);else if(n.tag===19)fu(n,u,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}p&=1}switch(st(Pr,p),x){case"forwards":for(u=o.child,x=null;u!==null;)n=u.alternate,n!==null&&ks(n)===null&&(x=u),u=u.sibling;u=x,u===null?(x=o.child,o.child=null):(x=u.sibling,u.sibling=null),Vi(o,!1,x,u,T);break;case"backwards":for(u=null,x=o.child,o.child=null;x!==null;){if(n=x.alternate,n!==null&&ks(n)===null){o.child=x;break}n=x.sibling,x.sibling=u,u=x,x=n}Vi(o,!0,u,null,T);break;case"together":Vi(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ko(n,o,u){if(n!==null&&(o.dependencies=n.dependencies),Hs|=o.lanes,(u&o.childLanes)===0)if(n!==null){if(bl(n,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(n!==null&&o.child!==n.child)throw Error(D(153));if(o.child!==null){for(n=o.child,u=bi(n,n.pendingProps),o.child=u,u.return=o;n.sibling!==null;)n=n.sibling,u=u.sibling=bi(n,n.pendingProps),u.return=o;u.sibling=null}return o.child}function Xd(n,o){return(n.lanes&o)!==0?!0:(n=n.dependencies,!!(n!==null&&_c(n)))}function pp(n,o,u){switch(o.tag){case 3:Ht(o,o.stateNode.containerInfo),Ki(o,Ur,n.memoizedState.cache),za();break;case 27:case 5:tr(o);break;case 4:Ht(o,o.stateNode.containerInfo);break;case 10:Ki(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(co(o),o.flags|=128,null):(u&o.child.childLanes)!==0?fp(n,o,u):(co(o),n=ko(n,o,u),n!==null?n.sibling:null);co(o);break;case 19:var x=(n.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(bl(n,o,u,!1),p=(u&o.childLanes)!==0),x){if(p)return $d(n,o,u);o.flags|=128}if(x=o.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),st(Pr,Pr.current),p)break;return null;case 22:case 23:return o.lanes=0,up(n,o,u);case 24:Ki(o,Ur,n.memoizedState.cache)}return ko(n,o,u)}function mp(n,o,u){if(n!==null)if(n.memoizedProps!==o.pendingProps)zr=!0;else{if(!Xd(n,u)&&(o.flags&128)===0)return zr=!1,pp(n,o,u);zr=(n.flags&131072)!==0}else zr=!1,Mn&&(o.flags&1048576)!==0&&Kc(o,_l,o.index);switch(o.lanes=0,o.tag){case 16:e:{n=o.pendingProps;var p=o.elementType,x=p._init;if(p=x(p._payload),o.type=p,typeof p=="function")Xc(p)?(n=Fs(p,n),o.tag=1,o=qd(null,o,p,n,u)):(o.tag=0,o=sh(null,o,p,n,u));else{if(p!=null){if(x=p.$$typeof,x===it){o.tag=11,o=ah(null,o,p,n,u);break e}else if(x===ft){o.tag=14,o=lp(null,o,p,n,u);break e}}throw o=er(p)||p,Error(D(306,o,""))}}return o;case 0:return sh(n,o,o.type,o.pendingProps,u);case 1:return p=o.type,x=Fs(p,o.pendingProps),qd(n,o,p,x,u);case 3:e:{if(Ht(o,o.stateNode.containerInfo),n===null)throw Error(D(387));p=o.pendingProps;var T=o.memoizedState;x=T.element,iu(n,o),Tl(o,p,null,u);var F=o.memoizedState;if(p=F.cache,Ki(o,Ur,p),p!==T.cache&&Jc(o,[Ur],u,!0),Is(),p=F.element,T.isDehydrated)if(T={element:p,isDehydrated:!1,cache:F.cache},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){o=dp(n,o,p,u);break e}else if(p!==x){x=Jr(Error(D(424)),o),Qo(x),o=dp(n,o,p,u);break e}else{switch(n=o.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(ur=fo(n.firstChild),Gr=o,Mn=!0,Ko=null,Ia=!0,u=lo(o,null,p,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(za(),p===x){o=ko(n,o,u);break e}ri(n,o,p,u)}o=o.child}return o;case 26:return oh(n,o),n===null?(u=Sd(o.type,null,o.pendingProps,null))?o.memoizedState=u:Mn||(u=o.type,n=o.pendingProps,p=Ji(It.current).createElement(u),p[Ut]=o,p[$t]=n,Wr(p,u,n),cr(p),o.stateNode=p):o.memoizedState=Sd(o.type,n.memoizedProps,o.pendingProps,n.memoizedState),null;case 27:return tr(o),n===null&&Mn&&(p=o.stateNode=Rh(o.type,o.pendingProps,It.current),Gr=o,Ia=!0,x=ur,Xs(o.type)?(Cu=x,ur=fo(p.firstChild)):ur=x),ri(n,o,o.pendingProps.children,u),oh(n,o),n===null&&(o.flags|=4194304),o.child;case 5:return n===null&&Mn&&((x=p=ur)&&(p=Gp(p,o.type,o.pendingProps,Ia),p!==null?(o.stateNode=p,Gr=o,ur=fo(p.firstChild),Ia=!1,x=!0):x=!1),x||So(o)),tr(o),x=o.type,T=o.pendingProps,F=n!==null?n.memoizedProps:null,p=T.children,$s(x,T)?p=null:F!==null&&$s(x,F)&&(o.flags|=32),o.memoizedState!==null&&(x=lu(n,o,El,null,null,u),z._currentValue=x),oh(n,o),ri(n,o,p,u),o.child;case 6:return n===null&&Mn&&((n=u=ur)&&(u=km(u,o.pendingProps,Ia),u!==null?(o.stateNode=u,Gr=o,ur=null,n=!0):n=!1),n||So(o)),null;case 13:return fp(n,o,u);case 4:return Ht(o,o.stateNode.containerInfo),p=o.pendingProps,n===null?o.child=ja(o,null,p,u):ri(n,o,p,u),o.child;case 11:return ah(n,o,o.type,o.pendingProps,u);case 7:return ri(n,o,o.pendingProps,u),o.child;case 8:return ri(n,o,o.pendingProps.children,u),o.child;case 12:return ri(n,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,Ki(o,o.type,p.value),ri(n,o,p.children,u),o.child;case 9:return x=o.type._context,p=o.pendingProps.children,Jo(o),x=Rr(x),p=p(x),o.flags|=1,ri(n,o,p,u),o.child;case 14:return lp(n,o,o.type,o.pendingProps,u);case 15:return cp(n,o,o.type,o.pendingProps,u);case 19:return $d(n,o,u);case 31:return p=o.pendingProps,u=o.mode,p={mode:p.mode,children:p.children},n===null?(u=ch(p,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=bi(n.child,p),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return up(n,o,u);case 24:return Jo(o),p=Rr(Ur),n===null?(x=Qu(),x===null&&(x=or,T=es(),x.pooledCache=T,T.refCount++,T!==null&&(x.pooledCacheLanes|=u),x=T),o.memoizedState={parent:p,cache:x},xc(o),Ki(o,Ur,x)):((n.lanes&u)!==0&&(iu(n,o),Tl(o,null,null,u),Is()),x=n.memoizedState,T=o.memoizedState,x.parent!==p?(x={parent:p,cache:p},o.memoizedState=x,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=x),Ki(o,Ur,p)):(p=T.cache,Ki(o,Ur,p),p!==x.cache&&Jc(o,[Ur],u,!0))),ri(n,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(D(156,o.tag))}function Ns(n){n.flags|=4}function Yd(n,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!r(o)){if(o=Sr.current,o!==null&&((An&4194048)===An?br!==null:(An&62914560)!==An&&(An&536870912)===0||o!==br))throw Oa=bt,ns;n.flags|=8192}}function rd(n,o){o!==null&&(n.flags|=4),n.flags&16384&&(o=n.tag!==22?Ye():536870912,n.lanes|=o,gu|=o)}function Pc(n,o){if(!Mn)switch(n.tailMode){case"hidden":o=n.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?n.tail=null:u.sibling=null;break;case"collapsed":u=n.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:p.sibling=null}}function Cr(n){var o=n.alternate!==null&&n.alternate.child===n.child,u=0,p=0;if(o)for(var x=n.child;x!==null;)u|=x.lanes|x.childLanes,p|=x.subtreeFlags&65011712,p|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)u|=x.lanes|x.childLanes,p|=x.subtreeFlags,p|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=p,n.childLanes=u,o}function gp(n,o,u){var p=o.pendingProps;switch(gc(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(o),null;case 1:return Cr(o),null;case 3:return u=o.stateNode,p=null,n!==null&&(p=n.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),ha(Ur),En(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(n===null||n.child===null)&&(Bn(o)?Ns(o):n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Yi())),Cr(o),null;case 26:return u=o.memoizedState,n===null?(Ns(o),u!==null?(Cr(o),Yd(o,u)):(Cr(o),o.flags&=-16777217)):u?u!==n.memoizedState?(Ns(o),Cr(o),Yd(o,u)):(Cr(o),o.flags&=-16777217):(n.memoizedProps!==p&&Ns(o),Cr(o),o.flags&=-16777217),null;case 27:xn(o),u=It.current;var x=o.type;if(n!==null&&o.stateNode!=null)n.memoizedProps!==p&&Ns(o);else{if(!p){if(o.stateNode===null)throw Error(D(166));return Cr(o),null}n=xt.current,Bn(o)?Xu(o):(n=Rh(x,p,u),o.stateNode=n,Ns(o))}return Cr(o),null;case 5:if(xn(o),u=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==p&&Ns(o);else{if(!p){if(o.stateNode===null)throw Error(D(166));return Cr(o),null}if(n=xt.current,Bn(o))Xu(o);else{switch(x=Ji(It.current),n){case 1:n=x.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:n=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":n=x.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":n=x.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":n=x.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof p.is=="string"?x.createElement("select",{is:p.is}):x.createElement("select"),p.multiple?n.multiple=!0:p.size&&(n.size=p.size);break;default:n=typeof p.is=="string"?x.createElement(u,{is:p.is}):x.createElement(u)}}n[Ut]=o,n[$t]=p;e:for(x=o.child;x!==null;){if(x.tag===5||x.tag===6)n.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===o)break e;for(;x.sibling===null;){if(x.return===null||x.return===o)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}o.stateNode=n;e:switch(Wr(n,u,p),u){case"button":case"input":case"select":case"textarea":n=!!p.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Ns(o)}}return Cr(o),o.flags&=-16777217,null;case 6:if(n&&o.stateNode!=null)n.memoizedProps!==p&&Ns(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(D(166));if(n=It.current,Bn(o)){if(n=o.stateNode,u=o.memoizedProps,p=null,x=Gr,x!==null)switch(x.tag){case 27:case 5:p=x.memoizedProps}n[Ut]=o,n=!!(n.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||kf(n.nodeValue,u)),n||So(o)}else n=Ji(n).createTextNode(p),n[Ut]=o,o.stateNode=n}return Cr(o),null;case 13:if(p=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=Bn(o),p!==null&&p.dehydrated!==null){if(n===null){if(!x)throw Error(D(318));if(x=o.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(D(317));x[Ut]=o}else za(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Cr(o),x=!1}else x=Yi(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return o.flags&256?(wa(o),o):(wa(o),null)}if(wa(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=p!==null,n=n!==null&&n.memoizedState!==null,u){p=o.child,x=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(x=p.alternate.memoizedState.cachePool.pool);var T=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(T=p.memoizedState.cachePool.pool),T!==x&&(p.flags|=2048)}return u!==n&&u&&(o.child.flags|=8192),rd(o,o.updateQueue),Cr(o),null;case 4:return En(),n===null&&If(o.stateNode.containerInfo),Cr(o),null;case 10:return ha(o.type),Cr(o),null;case 19:if(vt(Pr),x=o.memoizedState,x===null)return Cr(o),null;if(p=(o.flags&128)!==0,T=x.rendering,T===null)if(p)Pc(x,!1);else{if(mr!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if(T=ks(n),T!==null){for(o.flags|=128,Pc(x,!1),n=T.updateQueue,o.updateQueue=n,rd(o,n),o.subtreeFlags=0,n=u,u=o.child;u!==null;)Wu(u,n),u=u.sibling;return st(Pr,Pr.current&1|2),o.child}n=n.sibling}x.tail!==null&&nr()>_h&&(o.flags|=128,p=!0,Pc(x,!1),o.lanes=4194304)}else{if(!p)if(n=ks(T),n!==null){if(o.flags|=128,p=!0,n=n.updateQueue,o.updateQueue=n,rd(o,n),Pc(x,!0),x.tail===null&&x.tailMode==="hidden"&&!T.alternate&&!Mn)return Cr(o),null}else 2*nr()-x.renderingStartTime>_h&&u!==536870912&&(o.flags|=128,p=!0,Pc(x,!1),o.lanes=4194304);x.isBackwards?(T.sibling=o.child,o.child=T):(n=x.last,n!==null?n.sibling=T:o.child=T,x.last=T)}return x.tail!==null?(o=x.tail,x.rendering=o,x.tail=o.sibling,x.renderingStartTime=nr(),o.sibling=null,n=Pr.current,st(Pr,p?n&1|2:n&1),o):(Cr(o),null);case 22:case 23:return wa(o),Al(),p=o.memoizedState!==null,n!==null?n.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?(u&536870912)!==0&&(o.flags&128)===0&&(Cr(o),o.subtreeFlags&6&&(o.flags|=8192)):Cr(o),u=o.updateQueue,u!==null&&rd(o,u.retryQueue),u=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),n!==null&&vt(ka),null;case 24:return u=null,n!==null&&(u=n.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),ha(Ur),Cr(o),null;case 25:return null;case 30:return null}throw Error(D(156,o.tag))}function Mm(n,o){switch(gc(o),o.tag){case 1:return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return ha(Ur),En(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 26:case 27:case 5:return xn(o),null;case 13:if(wa(o),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(D(340));za()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return vt(Pr),null;case 4:return En(),null;case 10:return ha(o.type),null;case 22:case 23:return wa(o),Al(),n!==null&&vt(ka),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 24:return ha(Ur),null;case 25:return null;default:return null}}function yp(n,o){switch(gc(o),o.tag){case 3:ha(Ur),En();break;case 26:case 27:case 5:xn(o);break;case 4:En();break;case 13:wa(o);break;case 19:vt(Pr);break;case 10:ha(o.type);break;case 22:case 23:wa(o),Al(),n!==null&&vt(ka);break;case 24:ha(Ur)}}function hh(n,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var x=p.next;u=x;do{if((u.tag&n)===n){p=void 0;var T=u.create,F=u.inst;p=T(),F.destroy=p}u=u.next}while(u!==x)}}catch(X){sr(o,o.return,X)}}function ss(n,o,u){try{var p=o.updateQueue,x=p!==null?p.lastEffect:null;if(x!==null){var T=x.next;p=T;do{if((p.tag&n)===n){var F=p.inst,X=F.destroy;if(X!==void 0){F.destroy=void 0,x=o;var fe=u,Ne=X;try{Ne()}catch(Qe){sr(x,fe,Qe)}}}p=p.next}while(p!==T)}}catch(Qe){sr(o,o.return,Qe)}}function id(n){var o=n.updateQueue;if(o!==null){var u=n.stateNode;try{Ju(o,u)}catch(p){sr(n,n.return,p)}}}function Kd(n,o,u){u.props=Fs(n.type,n.memoizedProps),u.state=n.memoizedState;try{u.componentWillUnmount()}catch(p){sr(n,o,p)}}function Oo(n,o){try{var u=n.ref;if(u!==null){switch(n.tag){case 26:case 27:case 5:var p=n.stateNode;break;case 30:p=n.stateNode;break;default:p=n.stateNode}typeof u=="function"?n.refCleanup=u(p):u.current=p}}catch(x){sr(n,o,x)}}function Sa(n,o){var u=n.ref,p=n.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(x){sr(n,o,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(x){sr(n,o,x)}else u.current=null}function _p(n){var o=n.type,u=n.memoizedProps,p=n.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(x){sr(n,n.return,x)}}function Qd(n,o,u){try{var p=n.stateNode;Np(p,n.type,u,o),p[$t]=o}catch(x){sr(n,n.return,x)}}function vp(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Xs(n.type)||n.tag===4}function Jd(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||vp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Xs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ef(n,o,u){var p=n.tag;if(p===5||p===6)n=n.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(n,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(n),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Eh));else if(p!==4&&(p===27&&Xs(n.type)&&(u=n.stateNode,o=null),n=n.child,n!==null))for(ef(n,o,u),n=n.sibling;n!==null;)ef(n,o,u),n=n.sibling}function ad(n,o,u){var p=n.tag;if(p===5||p===6)n=n.stateNode,o?u.insertBefore(n,o):u.appendChild(n);else if(p!==4&&(p===27&&Xs(n.type)&&(u=n.stateNode),n=n.child,n!==null))for(ad(n,o,u),n=n.sibling;n!==null;)ad(n,o,u),n=n.sibling}function xp(n){var o=n.stateNode,u=n.memoizedProps;try{for(var p=n.type,x=o.attributes;x.length;)o.removeAttributeNode(x[0]);Wr(o,p,u),o[Ut]=n,o[$t]=u}catch(T){sr(n,n.return,T)}}var Bo=!1,Zr=!1,od=!1,pu=typeof WeakSet=="function"?WeakSet:Set,Pi=null;function Lr(n,o){if(n=n.containerInfo,Mh=ce,n=Zc(n),lc(n)){if("selectionStart"in n)var u={start:n.selectionStart,end:n.selectionEnd};else e:{u=(u=n.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var x=p.anchorOffset,T=p.focusNode;p=p.focusOffset;try{u.nodeType,T.nodeType}catch{u=null;break e}var F=0,X=-1,fe=-1,Ne=0,Qe=0,tt=n,Ve=null;t:for(;;){for(var Ze;tt!==u||x!==0&&tt.nodeType!==3||(X=F+x),tt!==T||p!==0&&tt.nodeType!==3||(fe=F+p),tt.nodeType===3&&(F+=tt.nodeValue.length),(Ze=tt.firstChild)!==null;)Ve=tt,tt=Ze;for(;;){if(tt===n)break t;if(Ve===u&&++Ne===x&&(X=F),Ve===T&&++Qe===p&&(fe=F),(Ze=tt.nextSibling)!==null)break;tt=Ve,Ve=tt.parentNode}tt=Ze}u=X===-1||fe===-1?null:{start:X,end:fe}}else u=null}u=u||{start:0,end:0}}else u=null;for(vd={focusedElem:n,selectionRange:u},ce=!1,Pi=o;Pi!==null;)if(o=Pi,n=o.child,(o.subtreeFlags&1024)!==0&&n!==null)n.return=o,Pi=n;else for(;Pi!==null;){switch(o=Pi,T=o.alternate,n=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&T!==null){n=void 0,u=o,x=T.memoizedProps,T=T.memoizedState,p=u.stateNode;try{var tn=Fs(u.type,x,u.elementType===u.type);n=p.getSnapshotBeforeUpdate(tn,T),p.__reactInternalSnapshotBeforeUpdate=n}catch(Yt){sr(u,u.return,Yt)}}break;case 3:if((n&1024)!==0){if(n=o.stateNode.containerInfo,u=n.nodeType,u===9)bd(n);else if(u===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":bd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(D(163))}if(n=o.sibling,n!==null){n.return=o.return,Pi=n;break}Pi=o.return}}function Cc(n,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Us(n,u),p&4&&hh(5,u);break;case 1:if(Us(n,u),p&4)if(n=u.stateNode,o===null)try{n.componentDidMount()}catch(F){sr(u,u.return,F)}else{var x=Fs(u.type,o.memoizedProps);o=o.memoizedState;try{n.componentDidUpdate(x,o,n.__reactInternalSnapshotBeforeUpdate)}catch(F){sr(u,u.return,F)}}p&64&&id(u),p&512&&Oo(u,u.return);break;case 3:if(Us(n,u),p&64&&(n=u.updateQueue,n!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Ju(n,o)}catch(F){sr(u,u.return,F)}}break;case 27:o===null&&p&4&&xp(u);case 26:case 5:Us(n,u),o===null&&p&4&&_p(u),p&512&&Oo(u,u.return);break;case 12:Us(n,u);break;case 13:Us(n,u),p&4&&rf(n,u),p&64&&(n=u.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(u=Sf.bind(null,u),Zp(n,u))));break;case 22:if(p=u.memoizedState!==null||Bo,!p){o=o!==null&&o.memoizedState!==null||Zr,x=Bo;var T=Zr;Bo=p,(Zr=o)&&!T?zl(n,u,(u.subtreeFlags&8772)!==0):Us(n,u),Bo=x,Zr=T}break;case 30:break;default:Us(n,u)}}function tf(n){var o=n.alternate;o!==null&&(n.alternate=null,tf(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&_t(o)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var dr=null,Hi=!1;function Va(n,o,u){for(u=u.child;u!==null;)nf(n,o,u),u=u.sibling}function nf(n,o,u){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(Wi,u)}catch{}switch(u.tag){case 26:Zr||Sa(u,o),Va(n,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Zr||Sa(u,o);var p=dr,x=Hi;Xs(u.type)&&(dr=u.stateNode,Hi=!1),Va(n,o,u),Nl(u.stateNode),dr=p,Hi=x;break;case 5:Zr||Sa(u,o);case 6:if(p=dr,x=Hi,dr=null,Va(n,o,u),dr=p,Hi=x,dr!==null)if(Hi)try{(dr.nodeType===9?dr.body:dr.nodeName==="HTML"?dr.ownerDocument.body:dr).removeChild(u.stateNode)}catch(T){sr(u,o,T)}else try{dr.removeChild(u.stateNode)}catch(T){sr(u,o,T)}break;case 18:dr!==null&&(Hi?(n=dr,Bf(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,u.stateNode),Or(n)):Bf(dr,u.stateNode));break;case 4:p=dr,x=Hi,dr=u.stateNode.containerInfo,Hi=!0,Va(n,o,u),dr=p,Hi=x;break;case 0:case 11:case 14:case 15:Zr||ss(2,u,o),Zr||ss(4,u,o),Va(n,o,u);break;case 1:Zr||(Sa(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&Kd(u,o,p)),Va(n,o,u);break;case 21:Va(n,o,u);break;case 22:Zr=(p=Zr)||u.memoizedState!==null,Va(n,o,u),Zr=p;break;default:Va(n,o,u)}}function rf(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Or(n)}catch(u){sr(o,o.return,u)}}function dh(n){switch(n.tag){case 13:case 19:var o=n.stateNode;return o===null&&(o=n.stateNode=new pu),o;case 22:return n=n.stateNode,o=n._retryCache,o===null&&(o=n._retryCache=new pu),o;default:throw Error(D(435,n.tag))}}function fh(n,o){var u=dh(n);o.forEach(function(p){var x=Pf.bind(null,n,p);u.has(p)||(u.add(p),p.then(x,x))})}function Ci(n,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var x=u[p],T=n,F=o,X=F;e:for(;X!==null;){switch(X.tag){case 27:if(Xs(X.type)){dr=X.stateNode,Hi=!1;break e}break;case 5:dr=X.stateNode,Hi=!1;break e;case 3:case 4:dr=X.stateNode.containerInfo,Hi=!0;break e}X=X.return}if(dr===null)throw Error(D(160));nf(T,F,x),dr=null,Hi=!1,T=x.alternate,T!==null&&(T.return=null),x.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Tc(o,n),o=o.sibling}var Pa=null;function Tc(n,o){var u=n.alternate,p=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Ci(o,n),Gi(n),p&4&&(ss(3,n,n.return),hh(3,n),ss(5,n,n.return));break;case 1:Ci(o,n),Gi(n),p&512&&(Zr||u===null||Sa(u,u.return)),p&64&&Bo&&(n=n.updateQueue,n!==null&&(p=n.callbacks,p!==null&&(u=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var x=Pa;if(Ci(o,n),Gi(n),p&512&&(Zr||u===null||Sa(u,u.return)),p&4){var T=u!==null?u.memoizedState:null;if(p=n.memoizedState,u===null)if(p===null)if(n.stateNode===null){e:{p=n.type,u=n.memoizedProps,x=x.ownerDocument||x;t:switch(p){case"title":T=x.getElementsByTagName("title")[0],(!T||T[Wa]||T[Ut]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=x.createElement(p),x.head.insertBefore(T,x.querySelector("head > title"))),Wr(T,p,u),T[Ut]=n,cr(T),p=T;break e;case"link":var F=Kp("link","href",x).get(p+(u.href||""));if(F){for(var X=0;X<F.length;X++)if(T=F[X],T.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&T.getAttribute("rel")===(u.rel==null?null:u.rel)&&T.getAttribute("title")===(u.title==null?null:u.title)&&T.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){F.splice(X,1);break t}}T=x.createElement(p),Wr(T,p,u),x.head.appendChild(T);break;case"meta":if(F=Kp("meta","content",x).get(p+(u.content||""))){for(X=0;X<F.length;X++)if(T=F[X],T.getAttribute("content")===(u.content==null?null:""+u.content)&&T.getAttribute("name")===(u.name==null?null:u.name)&&T.getAttribute("property")===(u.property==null?null:u.property)&&T.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&T.getAttribute("charset")===(u.charSet==null?null:u.charSet)){F.splice(X,1);break t}}T=x.createElement(p),Wr(T,p,u),x.head.appendChild(T);break;default:throw Error(D(468,p))}T[Ut]=n,cr(T),p=T}n.stateNode=p}else i(x,n.type,n.stateNode);else n.stateNode=Dh(x,p,n.memoizedProps);else T!==p?(T===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):T.count--,p===null?i(x,n.type,n.stateNode):Dh(x,p,n.memoizedProps)):p===null&&n.stateNode!==null&&Qd(n,n.memoizedProps,u.memoizedProps)}break;case 27:Ci(o,n),Gi(n),p&512&&(Zr||u===null||Sa(u,u.return)),u!==null&&p&4&&Qd(n,n.memoizedProps,u.memoizedProps);break;case 5:if(Ci(o,n),Gi(n),p&512&&(Zr||u===null||Sa(u,u.return)),n.flags&32){x=n.stateNode;try{Ka(x,"")}catch(Ze){sr(n,n.return,Ze)}}p&4&&n.stateNode!=null&&(x=n.memoizedProps,Qd(n,x,u!==null?u.memoizedProps:x)),p&1024&&(od=!0);break;case 6:if(Ci(o,n),Gi(n),p&4){if(n.stateNode===null)throw Error(D(162));p=n.memoizedProps,u=n.stateNode;try{u.nodeValue=p}catch(Ze){sr(n,n.return,Ze)}}break;case 3:if(Mu=null,x=Pa,Pa=wd(o.containerInfo),Ci(o,n),Pa=x,Gi(n),p&4&&u!==null&&u.memoizedState.isDehydrated)try{Or(o.containerInfo)}catch(Ze){sr(n,n.return,Ze)}od&&(od=!1,bp(n));break;case 4:p=Pa,Pa=wd(n.stateNode.containerInfo),Ci(o,n),Gi(n),Pa=p;break;case 12:Ci(o,n),Gi(n);break;case 13:Ci(o,n),Gi(n),n.child.flags&8192&&n.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(cd=nr()),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,fh(n,p)));break;case 22:x=n.memoizedState!==null;var fe=u!==null&&u.memoizedState!==null,Ne=Bo,Qe=Zr;if(Bo=Ne||x,Zr=Qe||fe,Ci(o,n),Zr=Qe,Bo=Ne,Gi(n),p&8192)e:for(o=n.stateNode,o._visibility=x?o._visibility&-2:o._visibility|1,x&&(u===null||fe||Bo||Zr||Ha(n)),u=null,o=n;;){if(o.tag===5||o.tag===26){if(u===null){fe=u=o;try{if(T=fe.stateNode,x)F=T.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none";else{X=fe.stateNode;var tt=fe.memoizedProps.style,Ve=tt!=null&&tt.hasOwnProperty("display")?tt.display:null;X.style.display=Ve==null||typeof Ve=="boolean"?"":(""+Ve).trim()}}catch(Ze){sr(fe,fe.return,Ze)}}}else if(o.tag===6){if(u===null){fe=o;try{fe.stateNode.nodeValue=x?"":fe.memoizedProps}catch(Ze){sr(fe,fe.return,Ze)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===n)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break e;for(;o.sibling===null;){if(o.return===null||o.return===n)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=n.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,fh(n,u))));break;case 19:Ci(o,n),Gi(n),p&4&&(p=n.updateQueue,p!==null&&(n.updateQueue=null,fh(n,p)));break;case 30:break;case 21:break;default:Ci(o,n),Gi(n)}}function Gi(n){var o=n.flags;if(o&2){try{for(var u,p=n.return;p!==null;){if(vp(p)){u=p;break}p=p.return}if(u==null)throw Error(D(160));switch(u.tag){case 27:var x=u.stateNode,T=Jd(n);ad(n,T,x);break;case 5:var F=u.stateNode;u.flags&32&&(Ka(F,""),u.flags&=-33);var X=Jd(n);ad(n,X,F);break;case 3:case 4:var fe=u.stateNode.containerInfo,Ne=Jd(n);ef(n,Ne,fe);break;default:throw Error(D(161))}}catch(Qe){sr(n,n.return,Qe)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function bp(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var o=n;bp(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),n=n.sibling}}function Us(n,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Cc(n,o.alternate,o),o=o.sibling}function Ha(n){for(n=n.child;n!==null;){var o=n;switch(o.tag){case 0:case 11:case 14:case 15:ss(4,o,o.return),Ha(o);break;case 1:Sa(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Kd(o,o.return,u),Ha(o);break;case 27:Nl(o.stateNode);case 26:case 5:Sa(o,o.return),Ha(o);break;case 22:o.memoizedState===null&&Ha(o);break;case 30:Ha(o);break;default:Ha(o)}n=n.sibling}}function zl(n,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,x=n,T=o,F=T.flags;switch(T.tag){case 0:case 11:case 15:zl(x,T,u),hh(4,T);break;case 1:if(zl(x,T,u),p=T,x=p.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(Ne){sr(p,p.return,Ne)}if(p=T,x=p.updateQueue,x!==null){var X=p.stateNode;try{var fe=x.shared.hiddenCallbacks;if(fe!==null)for(x.shared.hiddenCallbacks=null,x=0;x<fe.length;x++)ou(fe[x],X)}catch(Ne){sr(p,p.return,Ne)}}u&&F&64&&id(T),Oo(T,T.return);break;case 27:xp(T);case 26:case 5:zl(x,T,u),u&&p===null&&F&4&&_p(T),Oo(T,T.return);break;case 12:zl(x,T,u);break;case 13:zl(x,T,u),u&&F&4&&rf(x,T);break;case 22:T.memoizedState===null&&zl(x,T,u),Oo(T,T.return);break;case 30:break;default:zl(x,T,u)}o=o.sibling}}function sd(n,o){var u=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(u=n.memoizedState.cachePool.pool),n=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(n=o.memoizedState.cachePool.pool),n!==u&&(n!=null&&n.refCount++,u!=null&&Es(u))}function Ac(n,o){n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&Es(n))}function uo(n,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)af(n,o,u,p),o=o.sibling}function af(n,o,u,p){var x=o.flags;switch(o.tag){case 0:case 11:case 15:uo(n,o,u,p),x&2048&&hh(9,o);break;case 1:uo(n,o,u,p);break;case 3:uo(n,o,u,p),x&2048&&(n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&Es(n)));break;case 12:if(x&2048){uo(n,o,u,p),n=o.stateNode;try{var T=o.memoizedProps,F=T.id,X=T.onPostCommit;typeof X=="function"&&X(F,o.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(fe){sr(o,o.return,fe)}}else uo(n,o,u,p);break;case 13:uo(n,o,u,p);break;case 23:break;case 22:T=o.stateNode,F=o.alternate,o.memoizedState!==null?T._visibility&2?uo(n,o,u,p):ph(n,o):T._visibility&2?uo(n,o,u,p):(T._visibility|=2,Ec(n,o,u,p,(o.subtreeFlags&10256)!==0)),x&2048&&sd(F,o);break;case 24:uo(n,o,u,p),x&2048&&Ac(o.alternate,o);break;default:uo(n,o,u,p)}}function Ec(n,o,u,p,x){for(x=x&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var T=n,F=o,X=u,fe=p,Ne=F.flags;switch(F.tag){case 0:case 11:case 15:Ec(T,F,X,fe,x),hh(8,F);break;case 23:break;case 22:var Qe=F.stateNode;F.memoizedState!==null?Qe._visibility&2?Ec(T,F,X,fe,x):ph(T,F):(Qe._visibility|=2,Ec(T,F,X,fe,x)),x&&Ne&2048&&sd(F.alternate,F);break;case 24:Ec(T,F,X,fe,x),x&&Ne&2048&&Ac(F.alternate,F);break;default:Ec(T,F,X,fe,x)}o=o.sibling}}function ph(n,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=n,p=o,x=p.flags;switch(p.tag){case 22:ph(u,p),x&2048&&sd(p.alternate,p);break;case 24:ph(u,p),x&2048&&Ac(p.alternate,p);break;default:ph(u,p)}o=o.sibling}}var mh=8192;function mu(n){if(n.subtreeFlags&mh)for(n=n.child;n!==null;)wp(n),n=n.sibling}function wp(n){switch(n.tag){case 26:mu(n),n.flags&mh&&n.memoizedState!==null&&m(Pa,n.memoizedState,n.memoizedProps);break;case 5:mu(n);break;case 3:case 4:var o=Pa;Pa=wd(n.stateNode.containerInfo),mu(n),Pa=o;break;case 22:n.memoizedState===null&&(o=n.alternate,o!==null&&o.memoizedState!==null?(o=mh,mh=16777216,mu(n),mh=o):mu(n));break;default:mu(n)}}function Sp(n){var o=n.alternate;if(o!==null&&(n=o.child,n!==null)){o.child=null;do o=n.sibling,n.sibling=null,n=o;while(n!==null)}}function ls(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pi=p,of(p,n)}Sp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Pp(n),n=n.sibling}function Pp(n){switch(n.tag){case 0:case 11:case 15:ls(n),n.flags&2048&&ss(9,n,n.return);break;case 3:ls(n);break;case 12:ls(n);break;case 22:var o=n.stateNode;n.memoizedState!==null&&o._visibility&2&&(n.return===null||n.return.tag!==13)?(o._visibility&=-3,ld(n)):ls(n);break;default:ls(n)}}function ld(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Pi=p,of(p,n)}Sp(n)}for(n=n.child;n!==null;){switch(o=n,o.tag){case 0:case 11:case 15:ss(8,o,o.return),ld(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,ld(o));break;default:ld(o)}n=n.sibling}}function of(n,o){for(;Pi!==null;){var u=Pi;switch(u.tag){case 0:case 11:case 15:ss(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Es(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Pi=p;else e:for(u=n;Pi!==null;){p=Pi;var x=p.sibling,T=p.return;if(tf(p),p===u){Pi=null;break e}if(x!==null){x.return=T,Pi=x;break e}Pi=T}}}var Rm={getCacheForType:function(n){var o=Rr(Ur),u=o.data.get(n);return u===void 0&&(u=n(),o.data.set(n,u)),u}},Cp=typeof WeakMap=="function"?WeakMap:Map,Xn=0,or=null,yn=null,An=0,Yn=0,Ga=null,js=!1,Mc=!1,sf=!1,Vs=0,mr=0,Hs=0,Rc=0,lf=0,ho=0,gu=0,gh=null,da=null,yh=!1,cd=0,_h=1/0,vh=null,Ll=null,ii=0,kl=null,Dc=null,yu=0,cf=0,uf=null,hf=null,xh=0,df=null;function Zi(){if((Xn&2)!==0&&An!==0)return An&-An;if(We.T!==null){var n=Co;return n!==0?n:Ch()}return Fr()}function qr(){ho===0&&(ho=(An&536870912)===0||Mn?nt():536870912);var n=Sr.current;return n!==null&&(n.flags|=32),ho}function fa(n,o,u){(n===or&&(Yn===2||Yn===9)||n.cancelPendingCommit!==null)&&(_u(n,0),Za(n,An,ho,!1)),Ce(n,u),((Xn&2)===0||n!==or)&&(n===or&&((Xn&2)===0&&(Rc|=u),mr===4&&Za(n,An,ho,!1)),Fo(n))}function ff(n,o,u){if((Xn&6)!==0)throw Error(D(327));var p=!u&&(o&124)===0&&(o&n.expiredLanes)===0||Pe(n,o),x=p?Im(n,o):_f(n,o,!0),T=p;do{if(x===0){Mc&&!p&&Za(n,o,0,!1);break}else{if(u=n.current.alternate,T&&!mf(u)){x=_f(n,o,!1),T=!1;continue}if(x===2){if(T=o,n.errorRecoveryDisabledLanes&T)var F=0;else F=n.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){o=F;e:{var X=n;x=gh;var fe=X.current.memoizedState.isDehydrated;if(fe&&(_u(X,F).flags|=256),F=_f(X,F,!1),F!==2){if(sf&&!fe){X.errorRecoveryDisabledLanes|=T,Rc|=T,x=4;break e}T=da,da=x,T!==null&&(da===null?da=T:da.push.apply(da,T))}x=F}if(T=!1,x!==2)continue}}if(x===1){_u(n,0),Za(n,o,0,!0);break}e:{switch(p=n,T=x,T){case 0:case 1:throw Error(D(345));case 4:if((o&4194048)!==o)break;case 6:Za(p,o,ho,!js);break e;case 2:da=null;break;case 3:case 5:break;default:throw Error(D(329))}if((o&62914560)===o&&(x=cd+300-nr(),10<x)){if(Za(p,o,ho,!js),Be(p,0,!0)!==0)break e;p.timeoutHandle=Of(pf.bind(null,p,u,da,vh,yh,o,ho,Rc,gu,js,T,2,-0,0),x);break e}pf(p,u,da,vh,yh,o,ho,Rc,gu,js,T,0,-0,0)}}break}while(!0);Fo(n)}function pf(n,o,u,p,x,T,F,X,fe,Ne,Qe,tt,Ve,Ze){if(n.timeoutHandle=-1,tt=o.subtreeFlags,(tt&8192||(tt&16785408)===16785408)&&(s={stylesheets:null,count:0,unsuspend:h},wp(o),tt=y(),tt!==null)){n.cancelPendingCommit=tt(Gs.bind(null,n,o,T,u,p,x,F,X,fe,Qe,1,Ve,Ze)),Za(n,T,F,!Ne);return}Gs(n,o,T,u,p,x,F,X,fe)}function mf(n){for(var o=n;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var x=u[p],T=x.getSnapshot;x=x.value;try{if(!Ii(T(),x))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Za(n,o,u,p){o&=~lf,o&=~Rc,n.suspendedLanes|=o,n.pingedLanes&=~o,p&&(n.warmLanes|=o),p=n.expirationTimes;for(var x=o;0<x;){var T=31-xe(x),F=1<<T;p[T]=-1,x&=~F}u!==0&&dn(n,u,o)}function bh(){return(Xn&6)===0?(wu(0),!1):!0}function gf(){if(yn!==null){if(Yn===0)var n=yn.return;else n=yn,ki=Po=null,Ml(n),Dn=null,hr=0,n=yn;for(;n!==null;)yp(n.alternate,n),n=n.return;yn=null}}function _u(n,o){var u=n.timeoutHandle;u!==-1&&(n.timeoutHandle=-1,jp(u)),u=n.cancelPendingCommit,u!==null&&(n.cancelPendingCommit=null,u()),gf(),or=n,yn=u=bi(n.current,null),An=o,Yn=0,Ga=null,js=!1,Mc=Pe(n,o),sf=!1,gu=ho=lf=Rc=Hs=mr=0,da=gh=null,yh=!1,(o&8)!==0&&(o|=o&32);var p=n.entangledLanes;if(p!==0)for(n=n.entanglements,p&=o;0<p;){var x=31-xe(p),T=1<<x;o|=n[x],p&=~T}return Vs=o,As(),u}function Tp(n,o){pn=null,We.H=ni,o===Pl||o===Fi?(o=Ds(),Yn=3):o===ns?(o=Ds(),Yn=4):Yn=o===sp?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ga=o,yn===null&&(mr=1,hu(n,Jr(o,n.current)))}function Ap(){var n=We.H;return We.H=ni,n===null?ni:n}function Ep(){var n=We.A;return We.A=Rm,n}function yf(){mr=4,js||(An&4194048)!==An&&Sr.current!==null||(Mc=!0),(Hs&134217727)===0&&(Rc&134217727)===0||or===null||Za(or,An,ho,!1)}function _f(n,o,u){var p=Xn;Xn|=2;var x=Ap(),T=Ep();(or!==n||An!==o)&&(vh=null,_u(n,o)),o=!1;var F=mr;e:do try{if(Yn!==0&&yn!==null){var X=yn,fe=Ga;switch(Yn){case 8:gf(),F=6;break e;case 3:case 2:case 9:case 6:Sr.current===null&&(o=!0);var Ne=Yn;if(Yn=0,Ga=null,Ic(n,X,fe,Ne),u&&Mc){F=0;break e}break;default:Ne=Yn,Yn=0,Ga=null,Ic(n,X,fe,Ne)}}Dm(),F=mr;break}catch(Qe){Tp(n,Qe)}while(!0);return o&&n.shellSuspendCounter++,ki=Po=null,Xn=p,We.H=x,We.A=T,yn===null&&(or=null,An=0,As()),F}function Dm(){for(;yn!==null;)Mp(yn)}function Im(n,o){var u=Xn;Xn|=2;var p=Ap(),x=Ep();or!==n||An!==o?(vh=null,_h=nr()+500,_u(n,o)):Mc=Pe(n,o);e:do try{if(Yn!==0&&yn!==null){o=yn;var T=Ga;t:switch(Yn){case 1:Yn=0,Ga=null,Ic(n,o,T,1);break;case 2:case 9:if(tu(T)){Yn=0,Ga=null,Rp(o);break}o=function(){Yn!==2&&Yn!==9||or!==n||(Yn=7),Fo(n)},T.then(o,o);break e;case 3:Yn=7;break e;case 4:Yn=5;break e;case 7:tu(T)?(Yn=0,Ga=null,Rp(o)):(Yn=0,Ga=null,Ic(n,o,T,7));break;case 5:var F=null;switch(yn.tag){case 26:F=yn.memoizedState;case 5:case 27:var X=yn;if(!F||r(F)){Yn=0,Ga=null;var fe=X.sibling;if(fe!==null)yn=fe;else{var Ne=X.return;Ne!==null?(yn=Ne,vu(Ne)):yn=null}break t}}Yn=0,Ga=null,Ic(n,o,T,5);break;case 6:Yn=0,Ga=null,Ic(n,o,T,6);break;case 8:gf(),mr=6;break e;default:throw Error(D(462))}}zm();break}catch(Qe){Tp(n,Qe)}while(!0);return ki=Po=null,We.H=p,We.A=x,Xn=u,yn!==null?0:(or=null,An=0,As(),mr)}function zm(){for(;yn!==null&&!qn();)Mp(yn)}function Mp(n){var o=mp(n.alternate,n,Vs);n.memoizedProps=n.pendingProps,o===null?vu(n):yn=o}function Rp(n){var o=n,u=o.alternate;switch(o.tag){case 15:case 0:o=Zd(u,o,o.pendingProps,o.type,void 0,An);break;case 11:o=Zd(u,o,o.pendingProps,o.type.render,o.ref,An);break;case 5:Ml(o);default:yp(u,o),o=yn=Wu(o,Vs),o=mp(u,o,Vs)}n.memoizedProps=n.pendingProps,o===null?vu(n):yn=o}function Ic(n,o,u,p){ki=Po=null,Ml(o),Dn=null,hr=0;var x=o.return;try{if(du(n,x,o,u,An)){mr=1,hu(n,Jr(u,n.current)),yn=null;return}}catch(T){if(x!==null)throw yn=x,T;mr=1,hu(n,Jr(u,n.current)),yn=null;return}o.flags&32768?(Mn||p===1?n=!0:Mc||(An&536870912)!==0?n=!1:(js=n=!0,(p===2||p===9||p===3||p===6)&&(p=Sr.current,p!==null&&p.tag===13&&(p.flags|=16384))),vf(o,n)):vu(o)}function vu(n){var o=n;do{if((o.flags&32768)!==0){vf(o,js);return}n=o.return;var u=gp(o.alternate,o,Vs);if(u!==null){yn=u;return}if(o=o.sibling,o!==null){yn=o;return}yn=o=n}while(o!==null);mr===0&&(mr=5)}function vf(n,o){do{var u=Mm(n.alternate,n);if(u!==null){u.flags&=32767,yn=u;return}if(u=n.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(n=n.sibling,n!==null)){yn=n;return}yn=n=u}while(n!==null);mr=6,yn=null}function Gs(n,o,u,p,x,T,F,X,fe){n.cancelPendingCommit=null;do ud();while(ii!==0);if((Xn&6)!==0)throw Error(D(327));if(o!==null){if(o===n.current)throw Error(D(177));if(T=o.lanes|o.childLanes,T|=Ts,Gt(n,u,T,F,X,fe),n===or&&(yn=or=null,An=0),Dc=o,kl=n,yu=u,cf=T,uf=x,hf=p,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Lm(oi,function(){return Dp(),null})):(n.callbackNode=null,n.callbackPriority=0),p=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||p){p=We.T,We.T=null,x=mt.p,mt.p=2,F=Xn,Xn|=4;try{Lr(n,o,u)}finally{Xn=F,mt.p=x,We.T=p}}ii=1,xu(),zc(),wh()}}function xu(){if(ii===1){ii=0;var n=kl,o=Dc,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=We.T,We.T=null;var p=mt.p;mt.p=2;var x=Xn;Xn|=4;try{Tc(o,n);var T=vd,F=Zc(n.containerInfo),X=T.focusedElem,fe=T.selectionRange;if(F!==X&&X&&X.ownerDocument&&Sn(X.ownerDocument.documentElement,X)){if(fe!==null&&lc(X)){var Ne=fe.start,Qe=fe.end;if(Qe===void 0&&(Qe=Ne),"selectionStart"in X)X.selectionStart=Ne,X.selectionEnd=Math.min(Qe,X.value.length);else{var tt=X.ownerDocument||document,Ve=tt&&tt.defaultView||window;if(Ve.getSelection){var Ze=Ve.getSelection(),tn=X.textContent.length,Yt=Math.min(fe.start,tn),Jn=fe.end===void 0?Yt:Math.min(fe.end,tn);!Ze.extend&&Yt>Jn&&(F=Jn,Jn=Yt,Yt=F);var Me=no(X,Yt),Ae=no(X,Jn);if(Me&&Ae&&(Ze.rangeCount!==1||Ze.anchorNode!==Me.node||Ze.anchorOffset!==Me.offset||Ze.focusNode!==Ae.node||Ze.focusOffset!==Ae.offset)){var Le=tt.createRange();Le.setStart(Me.node,Me.offset),Ze.removeAllRanges(),Yt>Jn?(Ze.addRange(Le),Ze.extend(Ae.node,Ae.offset)):(Le.setEnd(Ae.node,Ae.offset),Ze.addRange(Le))}}}}for(tt=[],Ze=X;Ze=Ze.parentNode;)Ze.nodeType===1&&tt.push({element:Ze,left:Ze.scrollLeft,top:Ze.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<tt.length;X++){var et=tt[X];et.element.scrollLeft=et.left,et.element.scrollTop=et.top}}ce=!!Mh,vd=Mh=null}finally{Xn=x,mt.p=p,We.T=u}}n.current=o,ii=2}}function zc(){if(ii===2){ii=0;var n=kl,o=Dc,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=We.T,We.T=null;var p=mt.p;mt.p=2;var x=Xn;Xn|=4;try{Cc(n,o.alternate,o)}finally{Xn=x,mt.p=p,We.T=u}}ii=3}}function wh(){if(ii===4||ii===3){ii=0,Ar();var n=kl,o=Dc,u=yu,p=hf;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?ii=5:(ii=0,Dc=kl=null,Sh(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(Ll=null),In(u),o=o.stateNode,gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(Wi,o,void 0,(o.current.flags&128)===128)}catch{}if(p!==null){o=We.T,x=mt.p,mt.p=2,We.T=null;try{for(var T=n.onRecoverableError,F=0;F<p.length;F++){var X=p[F];T(X.value,{componentStack:X.stack})}}finally{We.T=o,mt.p=x}}(yu&3)!==0&&ud(),Fo(n),x=n.pendingLanes,(u&4194090)!==0&&(x&42)!==0?n===df?xh++:(xh=0,df=n):xh=0,wu(0)}}function Sh(n,o){(n.pooledCacheLanes&=o)===0&&(o=n.pooledCache,o!=null&&(n.pooledCache=null,Es(o)))}function ud(n){return xu(),zc(),wh(),Dp()}function Dp(){if(ii!==5)return!1;var n=kl,o=cf;cf=0;var u=In(yu),p=We.T,x=mt.p;try{mt.p=32>u?32:u,We.T=null,u=uf,uf=null;var T=kl,F=yu;if(ii=0,Dc=kl=null,yu=0,(Xn&6)!==0)throw Error(D(331));var X=Xn;if(Xn|=4,Pp(T.current),af(T,T.current,F,u),Xn=X,wu(0,!1),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(Wi,T)}catch{}return!0}finally{mt.p=x,We.T=p,Sh(n,o)}}function xf(n,o,u){o=Jr(u,o),o=ih(n.stateNode,o,2),n=To(n,o,2),n!==null&&(Ce(n,2),Fo(n))}function sr(n,o,u){if(n.tag===3)xf(n,n,u);else for(;o!==null;){if(o.tag===3){xf(o,n,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Ll===null||!Ll.has(p))){n=Jr(u,n),u=Hd(2),p=To(o,u,2),p!==null&&(Gd(u,p,o,n),Ce(p,2),Fo(p));break}}o=o.return}}function bf(n,o,u){var p=n.pingCache;if(p===null){p=n.pingCache=new Cp;var x=new Set;p.set(o,x)}else x=p.get(o),x===void 0&&(x=new Set,p.set(o,x));x.has(u)||(sf=!0,x.add(u),n=Ip.bind(null,n,o,u),o.then(n,n))}function Ip(n,o,u){var p=n.pingCache;p!==null&&p.delete(o),n.pingedLanes|=n.suspendedLanes&u,n.warmLanes&=~u,or===n&&(An&u)===u&&(mr===4||mr===3&&(An&62914560)===An&&300>nr()-cd?(Xn&2)===0&&_u(n,0):lf|=u,gu===An&&(gu=0)),Fo(n)}function wf(n,o){o===0&&(o=Ye()),n=sa(n,o),n!==null&&(Ce(n,o),Fo(n))}function Sf(n){var o=n.memoizedState,u=0;o!==null&&(u=o.retryLane),wf(n,u)}function Pf(n,o){var u=0;switch(n.tag){case 13:var p=n.stateNode,x=n.memoizedState;x!==null&&(u=x.retryLane);break;case 19:p=n.stateNode;break;case 22:p=n.stateNode._retryCache;break;default:throw Error(D(314))}p!==null&&p.delete(o),wf(n,u)}function Lm(n,o){return qt(n,o)}var Ph=null,bu=null,Cf=!1,hd=!1,Tf=!1,Lc=0;function Fo(n){n!==bu&&n.next===null&&(bu===null?Ph=bu=n:bu=bu.next=n),hd=!0,Cf||(Cf=!0,fd())}function wu(n,o){if(!Tf&&hd){Tf=!0;do for(var u=!1,p=Ph;p!==null;){if(n!==0){var x=p.pendingLanes;if(x===0)var T=0;else{var F=p.suspendedLanes,X=p.pingedLanes;T=(1<<31-xe(42|n)+1)-1,T&=x&~(F&~X),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(u=!0,zp(p,T))}else T=An,T=Be(p,p===or?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(T&3)===0||Pe(p,T)||(u=!0,zp(p,T));p=p.next}while(u);Tf=!1}}function Zs(){qs()}function qs(){hd=Cf=!1;var n=0;Lc!==0&&(Up()&&(n=Lc),Lc=0);for(var o=nr(),u=null,p=Ph;p!==null;){var x=p.next,T=Af(p,o);T===0?(p.next=null,u===null?Ph=x:u.next=x,x===null&&(bu=u)):(u=p,(n!==0||(T&3)!==0)&&(hd=!0)),p=x}wu(n)}function Af(n,o){for(var u=n.suspendedLanes,p=n.pingedLanes,x=n.expirationTimes,T=n.pendingLanes&-62914561;0<T;){var F=31-xe(T),X=1<<F,fe=x[F];fe===-1?((X&u)===0||(X&p)!==0)&&(x[F]=qe(X,o)):fe<=o&&(n.expiredLanes|=X),T&=~X}if(o=or,u=An,u=Be(n,n===o?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p=n.callbackNode,u===0||n===o&&(Yn===2||Yn===9)||n.cancelPendingCommit!==null)return p!==null&&p!==null&&un(p),n.callbackNode=null,n.callbackPriority=0;if((u&3)===0||Pe(n,u)){if(o=u&-u,o===n.callbackPriority)return o;switch(p!==null&&un(p),In(u)){case 2:case 8:u=Mi;break;case 32:u=oi;break;case 268435456:u=ra;break;default:u=oi}return p=dd.bind(null,n),u=qt(u,p),n.callbackPriority=o,n.callbackNode=u,o}return p!==null&&p!==null&&un(p),n.callbackPriority=2,n.callbackNode=null,2}function dd(n,o){if(ii!==0&&ii!==5)return n.callbackNode=null,n.callbackPriority=0,null;var u=n.callbackNode;if(ud()&&n.callbackNode!==u)return null;var p=An;return p=Be(n,n===or?p:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),p===0?null:(ff(n,p,o),Af(n,nr()),n.callbackNode!=null&&n.callbackNode===u?dd.bind(null,n):null)}function zp(n,o){if(ud())return null;ff(n,o,!0)}function fd(){Hp(function(){(Xn&6)!==0?qt(Br,Zs):qs()})}function Ch(){return Lc===0&&(Lc=nt()),Lc}function Lp(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:hn(""+n)}function pd(n,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,n.id&&u.setAttribute("form",n.id),o.parentNode.insertBefore(u,o),n=new FormData(n),u.parentNode.removeChild(u),n}function Ef(n,o,u,p,x){if(o==="submit"&&u&&u.stateNode===x){var T=Lp((x[$t]||null).action),F=p.submitter;F&&(o=(o=F[$t]||null)?Lp(o.formAction):F.getAttribute("formAction"),o!==null&&(T=o,F=null));var X=new aa("action","action",null,p,x);n.push({event:X,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(Lc!==0){var fe=F?pd(x,F):new FormData(x);$n(u,{pending:!0,data:fe,method:x.method,action:T},null,fe)}}else typeof T=="function"&&(X.preventDefault(),fe=F?pd(x,F):new FormData(x),$n(u,{pending:!0,data:fe,method:x.method,action:T},T,fe))},currentTarget:x}]})}}for(var Ol=0;Ol<Wc.length;Ol++){var md=Wc[Ol],kp=md.toLowerCase(),Mf=md[0].toUpperCase()+md.slice(1);xa(kp,"on"+Mf)}xa(cc,"onAnimationEnd"),xa(uc,"onAnimationIteration"),xa(hc,"onAnimationStart"),xa("dblclick","onDoubleClick"),xa("focusin","onFocus"),xa("focusout","onBlur"),xa(Zu,"onTransitionRun"),xa(Ps,"onTransitionStart"),xa(dc,"onTransitionCancel"),xa(Cs,"onTransitionEnd"),mo("onMouseEnter",["mouseout","mouseover"]),mo("onMouseLeave",["mouseout","mouseover"]),mo("onPointerEnter",["pointerout","pointerover"]),mo("onPointerLeave",["pointerout","pointerover"]),$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$i("onBeforeInput",["compositionend","keypress","textInput","paste"]),$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Su="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Su));function Rf(n,o){o=(o&4)!==0;for(var u=0;u<n.length;u++){var p=n[u],x=p.event;p=p.listeners;e:{var T=void 0;if(o)for(var F=p.length-1;0<=F;F--){var X=p[F],fe=X.instance,Ne=X.currentTarget;if(X=X.listener,fe!==T&&x.isPropagationStopped())break e;T=X,x.currentTarget=Ne;try{T(x)}catch(Qe){nh(Qe)}x.currentTarget=null,T=fe}else for(F=0;F<p.length;F++){if(X=p[F],fe=X.instance,Ne=X.currentTarget,X=X.listener,fe!==T&&x.isPropagationStopped())break e;T=X,x.currentTarget=Ne;try{T(x)}catch(Qe){nh(Qe)}x.currentTarget=null,T=fe}}}}function Cn(n,o){var u=o[lt];u===void 0&&(u=o[lt]=new Set);var p=n+"__bubble";u.has(p)||(Op(o,n,2,!1),u.add(p))}function Df(n,o,u){var p=0;o&&(p|=4),Op(u,n,p,o)}var Th="_reactListening"+Math.random().toString(36).slice(2);function If(n){if(!n[Th]){n[Th]=!0,an.forEach(function(u){u!=="selectionchange"&&(gd.has(u)||Df(u,!1,n),Df(u,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[Th]||(o[Th]=!0,Df("selectionchange",!1,o))}}function Op(n,o,u,p){switch(yt(o)){case 2:var x=pe;break;case 8:x=Fe;break;default:x=Ge}u=x.bind(null,o,u,n),x=void 0,!ui||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(x=!0),p?x!==void 0?n.addEventListener(o,u,{capture:!0,passive:x}):n.addEventListener(o,u,!0):x!==void 0?n.addEventListener(o,u,{passive:x}):n.addEventListener(o,u,!1)}function zf(n,o,u,p,x){var T=p;if((o&1)===0&&(o&2)===0&&p!==null)e:for(;;){if(p===null)return;var F=p.tag;if(F===3||F===4){var X=p.stateNode.containerInfo;if(X===x)break;if(F===4)for(F=p.return;F!==null;){var fe=F.tag;if((fe===3||fe===4)&&F.stateNode.containerInfo===x)return;F=F.return}for(;X!==null;){if(F=rn(X),F===null)return;if(fe=F.tag,fe===5||fe===6||fe===26||fe===27){p=T=F;continue e}X=X.parentNode}}p=p.return}Mr(function(){var Ne=T,Qe=al(u),tt=[];e:{var Ve=oa.get(n);if(Ve!==void 0){var Ze=aa,tn=n;switch(n){case"keypress":if(Xt(u)===0)break e;case"keydown":case"keyup":Ze=tc;break;case"focusin":tn="focus",Ze=gs;break;case"focusout":tn="blur",Ze=gs;break;case"beforeblur":case"afterblur":Ze=gs;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ze=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ze=Qr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ze=Od;break;case cc:case uc:case hc:Ze=wr;break;case Cs:Ze=Bd;break;case"scroll":case"scrollend":Ze=Lu;break;case"wheel":Ze=Hc;break;case"copy":case"cut":case"paste":Ze=Ql;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ze=Ou;break;case"toggle":case"beforetoggle":Ze=vs}var Yt=(o&4)!==0,Jn=!Yt&&(n==="scroll"||n==="scrollend"),Me=Yt?Ve!==null?Ve+"Capture":null:Ve;Yt=[];for(var Ae=Ne,Le;Ae!==null;){var et=Ae;if(Le=et.stateNode,et=et.tag,et!==5&&et!==26&&et!==27||Le===null||Me===null||(et=Rn(Ae,Me),et!=null&&Yt.push(Ah(Ae,et,Le))),Jn)break;Ae=Ae.return}0<Yt.length&&(Ve=new Ze(Ve,tn,null,u,Qe),tt.push({event:Ve,listeners:Yt}))}}if((o&7)===0){e:{if(Ve=n==="mouseover"||n==="pointerover",Ze=n==="mouseout"||n==="pointerout",Ve&&u!==yo&&(tn=u.relatedTarget||u.fromElement)&&(rn(tn)||tn[lr]))break e;if((Ze||Ve)&&(Ve=Qe.window===Qe?Qe:(Ve=Qe.ownerDocument)?Ve.defaultView||Ve.parentWindow:window,Ze?(tn=u.relatedTarget||u.toElement,Ze=Ne,tn=tn?rn(tn):null,tn!==null&&(Jn=G(tn),Yt=tn.tag,tn!==Jn||Yt!==5&&Yt!==27&&Yt!==6)&&(tn=null)):(Ze=null,tn=Ne),Ze!==tn)){if(Yt=Kl,et="onMouseLeave",Me="onMouseEnter",Ae="mouse",(n==="pointerout"||n==="pointerover")&&(Yt=Ou,et="onPointerLeave",Me="onPointerEnter",Ae="pointer"),Jn=Ze==null?Ve:Er(Ze),Le=tn==null?Ve:Er(tn),Ve=new Yt(et,Ae+"leave",Ze,u,Qe),Ve.target=Jn,Ve.relatedTarget=Le,et=null,rn(Qe)===Ne&&(Yt=new Yt(Me,Ae+"enter",tn,u,Qe),Yt.target=Le,Yt.relatedTarget=Jn,et=Yt),Jn=et,Ze&&tn)t:{for(Yt=Ze,Me=tn,Ae=0,Le=Yt;Le;Le=Bl(Le))Ae++;for(Le=0,et=Me;et;et=Bl(et))Le++;for(;0<Ae-Le;)Yt=Bl(Yt),Ae--;for(;0<Le-Ae;)Me=Bl(Me),Le--;for(;Ae--;){if(Yt===Me||Me!==null&&Yt===Me.alternate)break t;Yt=Bl(Yt),Me=Bl(Me)}Yt=null}else Yt=null;Ze!==null&&Ws(tt,Ve,Ze,Yt,!1),tn!==null&&Jn!==null&&Ws(tt,Jn,tn,Yt,!0)}}e:{if(Ve=Ne?Er(Ne):window,Ze=Ve.nodeName&&Ve.nodeName.toLowerCase(),Ze==="select"||Ze==="input"&&Ve.type==="file")var Lt=Vu;else if(qh(Ve))if(Zo)Lt=Yh;else{Lt=Ud;var wn=$h}else Ze=Ve.nodeName,!Ze||Ze.toLowerCase()!=="input"||Ve.type!=="checkbox"&&Ve.type!=="radio"?Ne&&Qa(Ne.elementType)&&(Lt=Vu):Lt=Xh;if(Lt&&(Lt=Lt(n,Ne))){ju(tt,Lt,u,Qe);break e}wn&&wn(n,Ve,Ne),n==="focusout"&&Ne&&Ve.type==="number"&&Ne.memoizedProps.value!=null&&Yl(Ve,"number",Ve.value)}switch(wn=Ne?Er(Ne):window,n){case"focusin":(qh(wn)||wn.contentEditable==="true")&&(qo=wn,vo=Ne,ws=null);break;case"focusout":ws=vo=qo=null;break;case"mousedown":Gu=!0;break;case"contextmenu":case"mouseup":case"dragend":Gu=!1,Qh(tt,u,Qe);break;case"selectionchange":if(Kh)break;case"keydown":case"keyup":Qh(tt,u,Qe)}var Vt;if(ll)e:{switch(n){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else hl?Gh(n,u)&&(Jt="onCompositionEnd"):n==="keydown"&&u.keyCode===229&&(Jt="onCompositionStart");Jt&&(nc&&u.locale!=="ko"&&(hl||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&hl&&(Vt=Nt()):(vr=Qe,Hn="value"in vr?vr.value:vr.textContent,hl=!0)),wn=yd(Ne,Jt),0<wn.length&&(Jt=new Hh(Jt,n,null,u,Qe),tt.push({event:Jt,listeners:wn}),Vt?Jt.data=Vt:(Vt=rc(u),Vt!==null&&(Jt.data=Vt)))),(Vt=Nd?xs(n,u):Zh(n,u))&&(Jt=yd(Ne,"onBeforeInput"),0<Jt.length&&(wn=new Hh("onBeforeInput","beforeinput",null,u,Qe),tt.push({event:wn,listeners:Jt}),wn.data=Vt)),Ef(tt,n,Ne,u,Qe)}Rf(tt,o)})}function Ah(n,o,u){return{instance:n,listener:o,currentTarget:u}}function yd(n,o){for(var u=o+"Capture",p=[];n!==null;){var x=n,T=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||T===null||(x=Rn(n,u),x!=null&&p.unshift(Ah(n,x,T)),x=Rn(n,o),x!=null&&p.push(Ah(n,x,T))),n.tag===3)return p;n=n.return}return[]}function Bl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Ws(n,o,u,p,x){for(var T=o._reactName,F=[];u!==null&&u!==p;){var X=u,fe=X.alternate,Ne=X.stateNode;if(X=X.tag,fe!==null&&fe===p)break;X!==5&&X!==26&&X!==27||Ne===null||(fe=Ne,x?(Ne=Rn(u,T),Ne!=null&&F.unshift(Ah(u,Ne,fe))):x||(Ne=Rn(u,T),Ne!=null&&F.push(Ah(u,Ne,fe)))),u=u.return}F.length!==0&&n.push({event:o,listeners:F})}var Bp=/\r\n?/g,Fp=/\u0000|\uFFFD/g;function Lf(n){return(typeof n=="string"?n:""+n).replace(Bp,`
`).replace(Fp,"")}function kf(n,o){return o=Lf(o),Lf(n)===o}function Eh(){}function Zn(n,o,u,p,x,T){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||Ka(n,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&Ka(n,""+p);break;case"className":zn(n,"class",p);break;case"tabIndex":zn(n,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":zn(n,u,p);break;case"style":jo(n,p,T);break;case"data":if(o!=="object"){zn(n,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){n.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(u);break}p=hn(""+p),n.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){n.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(u==="formAction"?(o!=="input"&&Zn(n,o,"name",x.name,x,null),Zn(n,o,"formEncType",x.formEncType,x,null),Zn(n,o,"formMethod",x.formMethod,x,null),Zn(n,o,"formTarget",x.formTarget,x,null)):(Zn(n,o,"encType",x.encType,x,null),Zn(n,o,"method",x.method,x,null),Zn(n,o,"target",x.target,x,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){n.removeAttribute(u);break}p=hn(""+p),n.setAttribute(u,p);break;case"onClick":p!=null&&(n.onclick=Eh);break;case"onScroll":p!=null&&Cn("scroll",n);break;case"onScrollEnd":p!=null&&Cn("scrollend",n);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(D(61));if(u=p.__html,u!=null){if(x.children!=null)throw Error(D(60));n.innerHTML=u}}break;case"multiple":n.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":n.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){n.removeAttribute("xlink:href");break}u=hn(""+p),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,""+p):n.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,""):n.removeAttribute(u);break;case"capture":case"download":p===!0?n.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?n.setAttribute(u,p):n.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?n.setAttribute(u,p):n.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?n.removeAttribute(u):n.setAttribute(u,p);break;case"popover":Cn("beforetoggle",n),Cn("toggle",n),si(n,"popover",p);break;case"xlinkActuate":Xa(n,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Xa(n,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Xa(n,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Xa(n,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Xa(n,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Xa(n,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":si(n,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=go.get(u)||u,si(n,u,p))}}function _d(n,o,u,p,x,T){switch(u){case"style":jo(n,p,T);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(D(61));if(u=p.__html,u!=null){if(x.children!=null)throw Error(D(60));n.innerHTML=u}}break;case"children":typeof p=="string"?Ka(n,p):(typeof p=="number"||typeof p=="bigint")&&Ka(n,""+p);break;case"onScroll":p!=null&&Cn("scroll",n);break;case"onScrollEnd":p!=null&&Cn("scrollend",n);break;case"onClick":p!=null&&(n.onclick=Eh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(x=u.endsWith("Capture"),o=u.slice(2,x?u.length-7:void 0),T=n[$t]||null,T=T!=null?T[u]:null,typeof T=="function"&&n.removeEventListener(o,T,x),typeof p=="function")){typeof T!="function"&&T!==null&&(u in n?n[u]=null:n.hasAttribute(u)&&n.removeAttribute(u)),n.addEventListener(o,p,x);break e}u in n?n[u]=p:p===!0?n.setAttribute(u,""):si(n,u,p)}}}function Wr(n,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Cn("error",n),Cn("load",n);var p=!1,x=!1,T;for(T in u)if(u.hasOwnProperty(T)){var F=u[T];if(F!=null)switch(T){case"src":p=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(D(137,o));default:Zn(n,o,T,F,u,null)}}x&&Zn(n,o,"srcSet",u.srcSet,u,null),p&&Zn(n,o,"src",u.src,u,null);return;case"input":Cn("invalid",n);var X=T=F=x=null,fe=null,Ne=null;for(p in u)if(u.hasOwnProperty(p)){var Qe=u[p];if(Qe!=null)switch(p){case"name":x=Qe;break;case"type":F=Qe;break;case"checked":fe=Qe;break;case"defaultChecked":Ne=Qe;break;case"value":T=Qe;break;case"defaultValue":X=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(D(137,o));break;default:Zn(n,o,p,Qe,u,null)}}hs(n,T,X,fe,Ne,F,x,!1),jc(n);return;case"select":Cn("invalid",n),p=F=T=null;for(x in u)if(u.hasOwnProperty(x)&&(X=u[x],X!=null))switch(x){case"value":T=X;break;case"defaultValue":F=X;break;case"multiple":p=X;default:Zn(n,o,x,X,u,null)}o=T,u=F,n.multiple=!!p,o!=null?Uo(n,!!p,o,!1):u!=null&&Uo(n,!!p,u,!0);return;case"textarea":Cn("invalid",n),T=x=p=null;for(F in u)if(u.hasOwnProperty(F)&&(X=u[F],X!=null))switch(F){case"value":p=X;break;case"defaultValue":x=X;break;case"children":T=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(D(91));break;default:Zn(n,o,F,X,u,null)}ds(n,p,x,T),jc(n);return;case"option":for(fe in u)if(u.hasOwnProperty(fe)&&(p=u[fe],p!=null))switch(fe){case"selected":n.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Zn(n,o,fe,p,u,null)}return;case"dialog":Cn("beforetoggle",n),Cn("toggle",n),Cn("cancel",n),Cn("close",n);break;case"iframe":case"object":Cn("load",n);break;case"video":case"audio":for(p=0;p<Su.length;p++)Cn(Su[p],n);break;case"image":Cn("error",n),Cn("load",n);break;case"details":Cn("toggle",n);break;case"embed":case"source":case"link":Cn("error",n),Cn("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in u)if(u.hasOwnProperty(Ne)&&(p=u[Ne],p!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(D(137,o));default:Zn(n,o,Ne,p,u,null)}return;default:if(Qa(o)){for(Qe in u)u.hasOwnProperty(Qe)&&(p=u[Qe],p!==void 0&&_d(n,o,Qe,p,u,void 0));return}}for(X in u)u.hasOwnProperty(X)&&(p=u[X],p!=null&&Zn(n,o,X,p,u,null))}function Np(n,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,T=null,F=null,X=null,fe=null,Ne=null,Qe=null;for(Ze in u){var tt=u[Ze];if(u.hasOwnProperty(Ze)&&tt!=null)switch(Ze){case"checked":break;case"value":break;case"defaultValue":fe=tt;default:p.hasOwnProperty(Ze)||Zn(n,o,Ze,null,p,tt)}}for(var Ve in p){var Ze=p[Ve];if(tt=u[Ve],p.hasOwnProperty(Ve)&&(Ze!=null||tt!=null))switch(Ve){case"type":T=Ze;break;case"name":x=Ze;break;case"checked":Ne=Ze;break;case"defaultChecked":Qe=Ze;break;case"value":F=Ze;break;case"defaultValue":X=Ze;break;case"children":case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(D(137,o));break;default:Ze!==tt&&Zn(n,o,Ve,Ze,p,tt)}}Xl(n,F,X,fe,Ne,Qe,T,x);return;case"select":Ze=F=X=Ve=null;for(T in u)if(fe=u[T],u.hasOwnProperty(T)&&fe!=null)switch(T){case"value":break;case"multiple":Ze=fe;default:p.hasOwnProperty(T)||Zn(n,o,T,null,p,fe)}for(x in p)if(T=p[x],fe=u[x],p.hasOwnProperty(x)&&(T!=null||fe!=null))switch(x){case"value":Ve=T;break;case"defaultValue":X=T;break;case"multiple":F=T;default:T!==fe&&Zn(n,o,x,T,p,fe)}o=X,u=F,p=Ze,Ve!=null?Uo(n,!!u,Ve,!1):!!p!=!!u&&(o!=null?Uo(n,!!u,o,!0):Uo(n,!!u,u?[]:"",!1));return;case"textarea":Ze=Ve=null;for(X in u)if(x=u[X],u.hasOwnProperty(X)&&x!=null&&!p.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:Zn(n,o,X,null,p,x)}for(F in p)if(x=p[F],T=u[F],p.hasOwnProperty(F)&&(x!=null||T!=null))switch(F){case"value":Ve=x;break;case"defaultValue":Ze=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(D(91));break;default:x!==T&&Zn(n,o,F,x,p,T)}jh(n,Ve,Ze);return;case"option":for(var tn in u)if(Ve=u[tn],u.hasOwnProperty(tn)&&Ve!=null&&!p.hasOwnProperty(tn))switch(tn){case"selected":n.selected=!1;break;default:Zn(n,o,tn,null,p,Ve)}for(fe in p)if(Ve=p[fe],Ze=u[fe],p.hasOwnProperty(fe)&&Ve!==Ze&&(Ve!=null||Ze!=null))switch(fe){case"selected":n.selected=Ve&&typeof Ve!="function"&&typeof Ve!="symbol";break;default:Zn(n,o,fe,Ve,p,Ze)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Yt in u)Ve=u[Yt],u.hasOwnProperty(Yt)&&Ve!=null&&!p.hasOwnProperty(Yt)&&Zn(n,o,Yt,null,p,Ve);for(Ne in p)if(Ve=p[Ne],Ze=u[Ne],p.hasOwnProperty(Ne)&&Ve!==Ze&&(Ve!=null||Ze!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Ve!=null)throw Error(D(137,o));break;default:Zn(n,o,Ne,Ve,p,Ze)}return;default:if(Qa(o)){for(var Jn in u)Ve=u[Jn],u.hasOwnProperty(Jn)&&Ve!==void 0&&!p.hasOwnProperty(Jn)&&_d(n,o,Jn,void 0,p,Ve);for(Qe in p)Ve=p[Qe],Ze=u[Qe],!p.hasOwnProperty(Qe)||Ve===Ze||Ve===void 0&&Ze===void 0||_d(n,o,Qe,Ve,p,Ze);return}}for(var Me in u)Ve=u[Me],u.hasOwnProperty(Me)&&Ve!=null&&!p.hasOwnProperty(Me)&&Zn(n,o,Me,null,p,Ve);for(tt in p)Ve=p[tt],Ze=u[tt],!p.hasOwnProperty(tt)||Ve===Ze||Ve==null&&Ze==null||Zn(n,o,tt,Ve,p,Ze)}var Mh=null,vd=null;function Ji(n){return n.nodeType===9?n:n.ownerDocument}function kc(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Pu(n,o){if(n===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&o==="foreignObject"?0:n}function $s(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var xd=null;function Up(){var n=window.event;return n&&n.type==="popstate"?n===xd?!1:(xd=n,!0):(xd=null,!1)}var Of=typeof setTimeout=="function"?setTimeout:void 0,jp=typeof clearTimeout=="function"?clearTimeout:void 0,Vp=typeof Promise=="function"?Promise:void 0,Hp=typeof queueMicrotask=="function"?queueMicrotask:typeof Vp<"u"?function(n){return Vp.resolve(null).then(n).catch(Fl)}:Of;function Fl(n){setTimeout(function(){throw n})}function Xs(n){return n==="head"}function Bf(n,o){var u=o,p=0,x=0;do{var T=u.nextSibling;if(n.removeChild(u),T&&T.nodeType===8)if(u=T.data,u==="/$"){if(0<p&&8>p){u=p;var F=n.ownerDocument;if(u&1&&Nl(F.documentElement),u&2&&Nl(F.body),u&4)for(u=F.head,Nl(u),F=u.firstChild;F;){var X=F.nextSibling,fe=F.nodeName;F[Wa]||fe==="SCRIPT"||fe==="STYLE"||fe==="LINK"&&F.rel.toLowerCase()==="stylesheet"||u.removeChild(F),F=X}}if(x===0){n.removeChild(T),Or(o);return}x--}else u==="$"||u==="$?"||u==="$!"?x++:p=u.charCodeAt(0)-48;else p=0;u=T}while(u);Or(o)}function bd(n){var o=n.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":bd(u),_t(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}n.removeChild(u)}}function Gp(n,o,u,p){for(;n.nodeType===1;){var x=u;if(n.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(p){if(!n[Wa])switch(o){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(T=n.getAttribute("rel"),T==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(T!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(T=n.getAttribute("src"),(T!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&T&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(o==="input"&&n.type==="hidden"){var T=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===T)return n}else return n;if(n=fo(n.nextSibling),n===null)break}return null}function km(n,o,u){if(o==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!u||(n=fo(n.nextSibling),n===null))return null;return n}function Ff(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function Zp(n,o){var u=n.ownerDocument;if(n.data!=="$?"||u.readyState==="complete")o();else{var p=function(){o(),u.removeEventListener("DOMContentLoaded",p)};u.addEventListener("DOMContentLoaded",p),n._reactRetry=p}}function fo(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return n}var Cu=null;function Nf(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var u=n.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return n;o--}else u==="/$"&&o++}n=n.previousSibling}return null}function Rh(n,o,u){switch(o=Ji(u),n){case"html":if(n=o.documentElement,!n)throw Error(D(452));return n;case"head":if(n=o.head,!n)throw Error(D(453));return n;case"body":if(n=o.body,!n)throw Error(D(454));return n;default:throw Error(D(451))}}function Nl(n){for(var o=n.attributes;o.length;)n.removeAttributeNode(o[0]);_t(n)}var pa=new Map,qp=new Set;function wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ys=mt.d;mt.d={f:Tu,r:Ti,D:Wp,C:jf,L:Om,m:$p,X:Bm,S:Xp,M:Yp};function Tu(){var n=Ys.f(),o=bh();return n||o}function Ti(n){var o=Qt(n);o!==null&&o.tag===5&&o.type==="form"?Un(o):Ys.r(n)}var Ul=typeof document>"u"?null:document;function Uf(n,o,u){var p=Ul;if(p&&typeof o=="string"&&o){var x=Xi(o);x='link[rel="'+n+'"][href="'+x+'"]',typeof u=="string"&&(x+='[crossorigin="'+u+'"]'),qp.has(x)||(qp.add(x),n={rel:n,crossOrigin:u,href:o},p.querySelector(x)===null&&(o=p.createElement("link"),Wr(o,"link",n),cr(o),p.head.appendChild(o)))}}function Wp(n){Ys.D(n),Uf("dns-prefetch",n,null)}function jf(n,o){Ys.C(n,o),Uf("preconnect",n,o)}function Om(n,o,u){Ys.L(n,o,u);var p=Ul;if(p&&n&&o){var x='link[rel="preload"][as="'+Xi(o)+'"]';o==="image"&&u&&u.imageSrcSet?(x+='[imagesrcset="'+Xi(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(x+='[imagesizes="'+Xi(u.imageSizes)+'"]')):x+='[href="'+Xi(n)+'"]';var T=x;switch(o){case"style":T=jl(n);break;case"script":T=Oc(n)}pa.has(T)||(n=he({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:n,as:o},u),pa.set(T,n),p.querySelector(x)!==null||o==="style"&&p.querySelector(Au(T))||o==="script"&&p.querySelector(Bc(T))||(o=p.createElement("link"),Wr(o,"link",n),cr(o),p.head.appendChild(o)))}}function $p(n,o){Ys.m(n,o);var u=Ul;if(u&&n){var p=o&&typeof o.as=="string"?o.as:"script",x='link[rel="modulepreload"][as="'+Xi(p)+'"][href="'+Xi(n)+'"]',T=x;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=Oc(n)}if(!pa.has(T)&&(n=he({rel:"modulepreload",href:n},o),pa.set(T,n),u.querySelector(x)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Bc(T)))return}p=u.createElement("link"),Wr(p,"link",n),cr(p),u.head.appendChild(p)}}}function Xp(n,o,u){Ys.S(n,o,u);var p=Ul;if(p&&n){var x=_a(p).hoistableStyles,T=jl(n);o=o||"default";var F=x.get(T);if(!F){var X={loading:0,preload:null};if(F=p.querySelector(Au(T)))X.loading=5;else{n=he({rel:"stylesheet",href:n,"data-precedence":o},u),(u=pa.get(T))&&Ih(n,u);var fe=F=p.createElement("link");cr(fe),Wr(fe,"link",n),fe._p=new Promise(function(Ne,Qe){fe.onload=Ne,fe.onerror=Qe}),fe.addEventListener("load",function(){X.loading|=1}),fe.addEventListener("error",function(){X.loading|=2}),X.loading|=4,Vl(F,o,p)}F={type:"stylesheet",instance:F,count:1,state:X},x.set(T,F)}}}function Bm(n,o){Ys.X(n,o);var u=Ul;if(u&&n){var p=_a(u).hoistableScripts,x=Oc(n),T=p.get(x);T||(T=u.querySelector(Bc(x)),T||(n=he({src:n,async:!0},o),(o=pa.get(x))&&zh(n,o),T=u.createElement("script"),cr(T),Wr(T,"link",n),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(x,T))}}function Yp(n,o){Ys.M(n,o);var u=Ul;if(u&&n){var p=_a(u).hoistableScripts,x=Oc(n),T=p.get(x);T||(T=u.querySelector(Bc(x)),T||(n=he({src:n,async:!0,type:"module"},o),(o=pa.get(x))&&zh(n,o),T=u.createElement("script"),cr(T),Wr(T,"link",n),u.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(x,T))}}function Sd(n,o,u,p){var x=(x=It.current)?wd(x):null;if(!x)throw Error(D(446));switch(n){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=jl(u.href),u=_a(x).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){n=jl(u.href);var T=_a(x).hoistableStyles,F=T.get(n);if(F||(x=x.ownerDocument||x,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(n,F),(T=x.querySelector(Au(n)))&&!T._p&&(F.instance=T,F.state.loading=5),pa.has(n)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},pa.set(n,u),T||Vf(x,n,u,F.state))),o&&p===null)throw Error(D(528,""));return F}if(o&&p!==null)throw Error(D(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Oc(u),u=_a(x).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(D(444,n))}}function jl(n){return'href="'+Xi(n)+'"'}function Au(n){return'link[rel="stylesheet"]['+n+"]"}function Eu(n){return he({},n,{"data-precedence":n.precedence,precedence:null})}function Vf(n,o,u,p){n.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=n.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Wr(o,"link",u),cr(o),n.head.appendChild(o))}function Oc(n){return'[src="'+Xi(n)+'"]'}function Bc(n){return"script[async]"+n}function Dh(n,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=n.querySelector('style[data-href~="'+Xi(u.href)+'"]');if(p)return o.instance=p,cr(p),p;var x=he({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(n.ownerDocument||n).createElement("style"),cr(p),Wr(p,"style",x),Vl(p,u.precedence,n),o.instance=p;case"stylesheet":x=jl(u.href);var T=n.querySelector(Au(x));if(T)return o.state.loading|=4,o.instance=T,cr(T),T;p=Eu(u),(x=pa.get(x))&&Ih(p,x),T=(n.ownerDocument||n).createElement("link"),cr(T);var F=T;return F._p=new Promise(function(X,fe){F.onload=X,F.onerror=fe}),Wr(T,"link",p),o.state.loading|=4,Vl(T,u.precedence,n),o.instance=T;case"script":return T=Oc(u.src),(x=n.querySelector(Bc(T)))?(o.instance=x,cr(x),x):(p=u,(x=pa.get(T))&&(p=he({},u),zh(p,x)),n=n.ownerDocument||n,x=n.createElement("script"),cr(x),Wr(x,"link",p),n.head.appendChild(x),o.instance=x);case"void":return null;default:throw Error(D(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(p=o.instance,o.state.loading|=4,Vl(p,u.precedence,n));return o.instance}function Vl(n,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=p.length?p[p.length-1]:null,T=x,F=0;F<p.length;F++){var X=p[F];if(X.dataset.precedence===o)T=X;else if(T!==x)break}T?T.parentNode.insertBefore(n,T.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(n,o.firstChild))}function Ih(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.title==null&&(n.title=o.title)}function zh(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.integrity==null&&(n.integrity=o.integrity)}var Mu=null;function Kp(n,o,u){if(Mu===null){var p=new Map,x=Mu=new Map;x.set(u,p)}else x=Mu,p=x.get(u),p||(p=new Map,x.set(u,p));if(p.has(n))return p;for(p.set(n,null),u=u.getElementsByTagName(n),x=0;x<u.length;x++){var T=u[x];if(!(T[Wa]||T[Ut]||n==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var F=T.getAttribute(o)||"";F=n+F;var X=p.get(F);X?X.push(T):p.set(F,[T])}}return p}function i(n,o,u){n=n.ownerDocument||n,n.head.insertBefore(u,o==="title"?n.querySelector("head > title"):null)}function t(n,o,u){if(u===1||o.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return n=o.disabled,typeof o.precedence=="string"&&n==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function r(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var s=null;function h(){}function m(n,o,u){if(s===null)throw Error(D(475));var p=s;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var x=jl(u.href),T=n.querySelector(Au(x));if(T){n=T._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(p.count++,p=v.bind(p),n.then(p,p)),o.state.loading|=4,o.instance=T,cr(T);return}T=n.ownerDocument||n,u=Eu(u),(x=pa.get(x))&&Ih(u,x),T=T.createElement("link"),cr(T);var F=T;F._p=new Promise(function(X,fe){F.onload=X,F.onerror=fe}),Wr(T,"link",u),o.instance=T}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,n),(n=o.state.preload)&&(o.state.loading&3)===0&&(p.count++,o=v.bind(p),n.addEventListener("load",o),n.addEventListener("error",o))}}function y(){if(s===null)throw Error(D(475));var n=s;return n.stylesheets&&n.count===0&&C(n,n.stylesheets),0<n.count?function(o){var u=setTimeout(function(){if(n.stylesheets&&C(n,n.stylesheets),n.unsuspend){var p=n.unsuspend;n.unsuspend=null,p()}},6e4);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(u)}}:null}function v(){if(this.count--,this.count===0){if(this.stylesheets)C(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var w=null;function C(n,o){n.stylesheets=null,n.unsuspend!==null&&(n.count++,w=new Map,o.forEach(M,n),w=null,v.call(n))}function M(n,o){if(!(o.state.loading&4)){var u=w.get(n);if(u)var p=u.get(null);else{u=new Map,w.set(n,u);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<x.length;T++){var F=x[T];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(u.set(F.dataset.precedence,F),p=F)}p&&u.set(null,p)}x=o.instance,F=x.getAttribute("data-precedence"),T=u.get(F)||p,T===p&&u.set(null,x),u.set(F,x),this.count++,p=v.bind(this),x.addEventListener("load",p),x.addEventListener("error",p),T?T.parentNode.insertBefore(x,T.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),o.state.loading|=4}}var z={$$typeof:He,Provider:null,Consumer:null,_currentValue:rt,_currentValue2:rt,_threadCount:0};function B(n,o,u,p,x,T,F,X){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pt(0),this.hiddenUpdates=Pt(null),this.identifierPrefix=p,this.onUncaughtError=x,this.onCaughtError=T,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function U(n,o,u,p,x,T,F,X,fe,Ne,Qe,tt){return n=new B(n,o,u,F,X,fe,Ne,tt),o=1,T===!0&&(o|=24),T=la(3,null,null,o),n.current=T,T.stateNode=n,o=es(),o.refCount++,n.pooledCache=o,o.refCount++,T.memoizedState={element:p,isDehydrated:u,cache:o},xc(T),n}function V(n){return n?(n=sn,n):sn}function $(n,o,u,p,x,T){x=V(x),p.context===null?p.context=x:p.pendingContext=x,p=io(o),p.payload={element:u},T=T===void 0?null:T,T!==null&&(p.callback=T),u=To(n,p,o),u!==null&&(fa(u,n,o),Cl(u,n,o))}function Q(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var u=n.retryLane;n.retryLane=u!==0&&u<o?u:o}}function re(n,o){Q(n,o),(n=n.alternate)&&Q(n,o)}function Te(n){if(n.tag===13){var o=sa(n,67108864);o!==null&&fa(o,n,67108864),re(n,67108864)}}var ce=!0;function pe(n,o,u,p){var x=We.T;We.T=null;var T=mt.p;try{mt.p=2,Ge(n,o,u,p)}finally{mt.p=T,We.T=x}}function Fe(n,o,u,p){var x=We.T;We.T=null;var T=mt.p;try{mt.p=8,Ge(n,o,u,p)}finally{mt.p=T,We.T=x}}function Ge(n,o,u,p){if(ce){var x=Je(p);if(x===null)zf(n,o,p,gt,u),gn(n,p);else if($r(x,n,o,u,p))p.stopPropagation();else if(gn(n,p),o&4&&-1<At.indexOf(n)){for(;x!==null;){var T=Qt(x);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var F=be(T.pendingLanes);if(F!==0){var X=T;for(X.pendingLanes|=2,X.entangledLanes|=2;F;){var fe=1<<31-xe(F);X.entanglements[1]|=fe,F&=~fe}Fo(T),(Xn&6)===0&&(_h=nr()+500,wu(0))}}break;case 13:X=sa(T,2),X!==null&&fa(X,T,2),bh(),re(T,2)}if(T=Je(p),T===null&&zf(n,o,p,gt,u),T===x)break;x=T}x!==null&&p.stopPropagation()}else zf(n,o,p,null,u)}}function Je(n){return n=al(n),ct(n)}var gt=null;function ct(n){if(gt=null,n=rn(n),n!==null){var o=G(n);if(o===null)n=null;else{var u=o.tag;if(u===13){if(n=A(o),n!==null)return n;n=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}return gt=n,null}function yt(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Kr()){case Br:return 2;case Mi:return 8;case oi:case ya:return 32;case ra:return 268435456;default:return 32}default:return 32}}var Dt=!1,ut=null,dt=null,$e=null,Ft=new Map,jt=new Map,Mt=[],At="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gn(n,o){switch(n){case"focusin":case"focusout":ut=null;break;case"dragenter":case"dragleave":dt=null;break;case"mouseover":case"mouseout":$e=null;break;case"pointerover":case"pointerout":Ft.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":jt.delete(o.pointerId)}}function Kn(n,o,u,p,x,T){return n===null||n.nativeEvent!==T?(n={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:T,targetContainers:[x]},o!==null&&(o=Qt(o),o!==null&&Te(o)),n):(n.eventSystemFlags|=p,o=n.targetContainers,x!==null&&o.indexOf(x)===-1&&o.push(x),n)}function $r(n,o,u,p,x){switch(o){case"focusin":return ut=Kn(ut,n,o,u,p,x),!0;case"dragenter":return dt=Kn(dt,n,o,u,p,x),!0;case"mouseover":return $e=Kn($e,n,o,u,p,x),!0;case"pointerover":var T=x.pointerId;return Ft.set(T,Kn(Ft.get(T)||null,n,o,u,p,x)),!0;case"gotpointercapture":return T=x.pointerId,jt.set(T,Kn(jt.get(T)||null,n,o,u,p,x)),!0}return!1}function pi(n){var o=rn(n.target);if(o!==null){var u=G(o);if(u!==null){if(o=u.tag,o===13){if(o=A(u),o!==null){n.blockedOn=o,Vr(n.priority,function(){if(u.tag===13){var p=Zi();p=Wt(p);var x=sa(u,p);x!==null&&fa(x,u,p),re(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){n.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ea(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var u=Je(n.nativeEvent);if(u===null){u=n.nativeEvent;var p=new u.constructor(u.type,u);yo=p,u.target.dispatchEvent(p),yo=null}else return o=Qt(u),o!==null&&Te(o),n.blockedOn=u,!1;o.shift()}return!0}function ta(n,o,u){ea(n)&&u.delete(o)}function mi(){Dt=!1,ut!==null&&ea(ut)&&(ut=null),dt!==null&&ea(dt)&&(dt=null),$e!==null&&ea($e)&&($e=null),Ft.forEach(ta),jt.forEach(ta)}function Qn(n,o){n.blockedOn===o&&(n.blockedOn=null,Dt||(Dt=!0,b.unstable_scheduleCallback(b.unstable_NormalPriority,mi)))}var kr=null;function ai(n){kr!==n&&(kr=n,b.unstable_scheduleCallback(b.unstable_NormalPriority,function(){kr===n&&(kr=null);for(var o=0;o<n.length;o+=3){var u=n[o],p=n[o+1],x=n[o+2];if(typeof p!="function"){if(ct(p||u)===null)continue;break}var T=Qt(u);T!==null&&(n.splice(o,3),o-=3,$n(T,{pending:!0,data:x,method:u.method,action:p},p,x))}}))}function Or(n){function o(fe){return Qn(fe,n)}ut!==null&&Qn(ut,n),dt!==null&&Qn(dt,n),$e!==null&&Qn($e,n),Ft.forEach(o),jt.forEach(o);for(var u=0;u<Mt.length;u++){var p=Mt[u];p.blockedOn===n&&(p.blockedOn=null)}for(;0<Mt.length&&(u=Mt[0],u.blockedOn===null);)pi(u),u.blockedOn===null&&Mt.shift();if(u=(n.ownerDocument||n).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var x=u[p],T=u[p+1],F=x[$t]||null;if(typeof T=="function")F||ai(u);else if(F){var X=null;if(T&&T.hasAttribute("formAction")){if(x=T,F=T[$t]||null)X=F.formAction;else if(ct(x)!==null)continue}else X=F.action;typeof X=="function"?u[p+1]=X:(u.splice(p,3),p-=3),ai(u)}}}function Ai(n){this._internalRoot=n}na.prototype.render=Ai.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(D(409));var u=o.current,p=Zi();$(u,p,n,o,null,null)},na.prototype.unmount=Ai.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;$(n.current,2,null,n,null,null),bh(),o[lr]=null}};function na(n){this._internalRoot=n}na.prototype.unstable_scheduleHydration=function(n){if(n){var o=Fr();n={blockedOn:null,target:n,priority:o};for(var u=0;u<Mt.length&&o!==0&&o<Mt[u].priority;u++);Mt.splice(u,0,n),u===0&&pi(n)}};var Xr=R.version;if(Xr!=="19.1.1")throw Error(D(527,Xr,"19.1.1"));mt.findDOMNode=function(n){var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(D(188)):(n=Object.keys(n).join(","),Error(D(268,n)));return n=H(o),n=n!==null?Y(n):null,n=n===null?null:n.stateNode,n};var ma={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:We,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tr.isDisabled&&Tr.supportsFiber)try{Wi=Tr.inject(ma),gr=Tr}catch{}}return Gf.createRoot=function(n,o){if(!j(n))throw Error(D(299));var u=!1,p="",x=rh,T=Vd,F=ap,X=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(x=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(F=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(X=o.unstable_transitionCallbacks)),o=U(n,1,!1,null,null,u,p,x,T,F,X,null),n[lr]=o.current,If(n),new Ai(o)},Gf.hydrateRoot=function(n,o,u){if(!j(n))throw Error(D(299));var p=!1,x="",T=rh,F=Vd,X=ap,fe=null,Ne=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(T=u.onUncaughtError),u.onCaughtError!==void 0&&(F=u.onCaughtError),u.onRecoverableError!==void 0&&(X=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(fe=u.unstable_transitionCallbacks),u.formState!==void 0&&(Ne=u.formState)),o=U(n,1,!0,o,u??null,p,x,T,F,X,fe,Ne),o.context=V(null),u=o.current,p=Zi(),p=Wt(p),x=io(p),x.callback=null,To(u,x,p),u=p,o.current.lanes=u,Ce(o,u),Fo(o),n[lr]=o.current,If(n),new na(o)},Gf.version="19.1.1",Gf}var Ng;function K_(){if(Ng)return jm.exports;Ng=1;function b(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b)}catch(R){console.error(R)}}return b(),jm.exports=Y_(),jm.exports}var Q_=K_();const J_="/what_makes_lands_happy/world-map-svgrepo-com.svg",Pd=JSON.parse('[{"Country":"Finland","Country_clean":"finland","Region":"Western Europe","Happiness":7.741,"Median Salary":4238.9,"Average Salary":4978.86,"Lowest Salary":1257.93,"Highest Salary":22093.02,"Infant Survival Rate":1000,"Alcohol Consumption Rate":8.8,"Life Expectancy":81.1,"Netflix (USD/month)":13.54,"Women Safety Index":0.924,"Average Winter Temperature":-12.356432,"Average Summer Temperature":-4.902662,"Population":5540745,"Energy Per Capita":58966.16,"% of Power from Fossil Fuels":10.769,"% of Power from Nuclear":34.333,"% of Power from Renewables":54.898,"% of Agricultural Land":7.4618100417,"% of Forest Land":73.7264996577,"Territory":303947.7,"Average Rainfall":536,"Corruption":0.1622093022,"Wheat Production (tonnes)":2640555,"Rye Production (tonnes)":1200,"Potatoes Production (tonnes)":38388000,"Meat, chicken Production (tonnes)":54950,"Avocados Production (tonnes)":2243396.8,"Petrol Price (USD/liter)":2.64,"Daily Oil Consumption (Barrels)":210030,"CO2 Emissions (ton per capita)":7.372854761},{"Country":"Denmark","Country_clean":"denmark","Region":"Western Europe","Happiness":7.583,"Median Salary":5084.99,"Average Salary":5779.04,"Lowest Salary":1458.92,"Highest Salary":25637.39,"Infant Survival Rate":1000,"Alcohol Consumption Rate":9.64,"Life Expectancy":86,"Netflix (USD/month)":15.04,"Women Safety Index":0.932,"Average Winter Temperature":1.278225,"Average Summer Temperature":5.266599,"Population":5882261,"Energy Per Capita":32197.939,"% of Power from Fossil Fuels":16.037,"% of Power from Nuclear":0,"% of Power from Renewables":83.963,"% of Agricultural Land":65.45,"% of Forest Land":15.7345,"Territory":40000,"Average Rainfall":703,"Corruption":0.1622093022,"Wheat Production (tonnes)":37885740,"Rye Production (tonnes)":2000,"Potatoes Production (tonnes)":28781776,"Meat, chicken Production (tonnes)":94712,"Avocados Production (tonnes)":2300,"Petrol Price (USD/liter)":2.65,"Daily Oil Consumption (Barrels)":158194,"CO2 Emissions (ton per capita)":5.107988509},{"Country":"Iceland","Country_clean":"iceland","Region":"Western Europe","Happiness":7.525,"Median Salary":4661.2,"Average Salary":5049.03,"Lowest Salary":1273.23,"Highest Salary":22464.51,"Infant Survival Rate":1000,"Alcohol Consumption Rate":7.45,"Life Expectancy":82.7,"Netflix (USD/month)":14.67,"Women Safety Index":0.924,"Average Winter Temperature":-4.115238,"Average Summer Temperature":-3.5402563,"Population":372899,"Energy Per Capita":165870.875,"% of Power from Fossil Fuels":0,"% of Power from Nuclear":0,"% of Power from Renewables":99.986,"% of Agricultural Land":18.5659030051,"% of Forest Land":0.5157522563,"Territory":100830,"Average Rainfall":1940,"Corruption":0.2001170814,"Wheat Production (tonnes)":1290.74,"Rye Production (tonnes)":46331.4,"Potatoes Production (tonnes)":294,"Meat, chicken Production (tonnes)":2790,"Avocados Production (tonnes)":84114,"Petrol Price (USD/liter)":2.6,"Daily Oil Consumption (Barrels)":19090,"CO2 Emissions (ton per capita)":4.548442258},{"Country":"Sweden","Country_clean":"sweden","Region":"Western Europe","Happiness":7.344,"Median Salary":3568.16,"Average Salary":4144.56,"Lowest Salary":1043,"Highest Salary":18389.75,"Infant Survival Rate":1000,"Alcohol Consumption Rate":7.3,"Life Expectancy":82.4,"Netflix (USD/month)":14.2,"Women Safety Index":0.926,"Average Winter Temperature":-8.132298,"Average Summer Temperature":-2.8563125,"Population":10549347,"Energy Per Capita":59926.805,"% of Power from Fossil Fuels":1.782,"% of Power from Nuclear":29.835,"% of Power from Renewables":68.383,"% of Agricultural Land":7.3730207707,"% of Forest Land":68.6990689582,"Territory":407283.54,"Average Rainfall":624,"Corruption":0.1622093022,"Wheat Production (tonnes)":5007.8,"Rye Production (tonnes)":34011.166,"Potatoes Production (tonnes)":3368,"Meat, chicken Production (tonnes)":279,"Avocados Production (tonnes)":38349.266,"Petrol Price (USD/liter)":2.3,"Daily Oil Consumption (Barrels)":322109,"CO2 Emissions (ton per capita)":3.405037919},{"Country":"Israel","Country_clean":"israel","Region":"Middle East and North Africa","Happiness":7.341,"Median Salary":null,"Average Salary":null,"Lowest Salary":null,"Highest Salary":null,"Infant Survival Rate":1000,"Alcohol Consumption Rate":2.62,"Life Expectancy":82.5,"Netflix (USD/month)":15.05,"Women Safety Index":0.703,"Average Winter Temperature":13.687662,"Average Summer Temperature":13.979397,"Population":9038309,"Energy Per Capita":33643.016,"% of Power from Fossil Fuels":93.227,"% of Power from Nuclear":0,"% of Power from Renewables":9.508,"% of Agricultural Land":29.7365988909,"% of Forest Land":6.4695009242,"Territory":21640,"Average Rainfall":435,"Corruption":0.2001170814,"Wheat Production (tonnes)":85400,"Rye Production (tonnes)":6347351.2,"Potatoes Production (tonnes)":1379223,"Meat, chicken Production (tonnes)":7098960,"Avocados Production (tonnes)":41217,"Petrol Price (USD/liter)":2.1,"Daily Oil Consumption (Barrels)":236249,"CO2 Emissions (ton per capita)":6.919593718},{"Country":"Netherlands","Country_clean":"netherlands","Region":"Western Europe","Happiness":7.319,"Median Salary":4756.87,"Average Salary":5179.7,"Lowest Salary":1427.06,"Highest Salary":22515.86,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":81.9,"Netflix (USD/month)":13.54,"Women Safety Index":0.908,"Average Winter Temperature":3.8456993,"Average Summer Temperature":6.0171475,"Population":17564014,"Energy Per Capita":56000.762,"% of Power from Fossil Fuels":56.704,"% of Power from Nuclear":3.425,"% of Power from Renewables":39.871,"% of Agricultural Land":53.8164538165,"% of Forest Land":11.001980992,"Territory":33670,"Average Rainfall":778,"Corruption":0.1622093022,"Wheat Production (tonnes)":86110,"Rye Production (tonnes)":1142391.36,"Potatoes Production (tonnes)":14154907,"Meat, chicken Production (tonnes)":3756,"Avocados Production (tonnes)":5300,"Petrol Price (USD/liter)":2.47,"Daily Oil Consumption (Barrels)":937098,"CO2 Emissions (ton per capita)":8.437074627},{"Country":"Norway","Country_clean":"norway","Region":"Western Europe","Happiness":7.302,"Median Salary":4420.02,"Average Salary":4786.34,"Lowest Salary":1208.23,"Highest Salary":21281.57,"Infant Survival Rate":1000,"Alcohol Consumption Rate":5.97,"Life Expectancy":81.8,"Netflix (USD/month)":12.17,"Women Safety Index":0.92,"Average Winter Temperature":-8.88361,"Average Summer Temperature":-4.446233,"Population":5434319,"Energy Per Capita":96926.234,"% of Power from Fossil Fuels":1.028,"% of Power from Nuclear":0,"% of Power from Renewables":98.972,"% of Agricultural Land":2.7040382134,"% of Forest Land":33.4581491751,"Territory":364270,"Average Rainfall":1414,"Corruption":0.1814468056,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":2.7,"Daily Oil Consumption (Barrels)":204090,"CO2 Emissions (ton per capita)":6.722269985},{"Country":"Luxembourg","Country_clean":"luxembourg","Region":"Western Europe","Happiness":7.122,"Median Salary":4767.44,"Average Salary":5211.42,"Lowest Salary":1310.78,"Highest Salary":23150.11,"Infant Survival Rate":1000,"Alcohol Consumption Rate":11.12,"Life Expectancy":82,"Netflix (USD/month)":null,"Women Safety Index":0.924,"Average Winter Temperature":1.5896153,"Average Summer Temperature":2.84097,"Population":647599,"Energy Per Capita":60334.328,"% of Power from Fossil Fuels":14.159,"% of Power from Nuclear":0,"% of Power from Renewables":85.841,"% of Agricultural Land":51.5879058133,"% of Forest Land":34.4538272104,"Territory":2574.46,"Average Rainfall":934,"Corruption":0.1622093022,"Wheat Production (tonnes)":22278900,"Rye Production (tonnes)":2792668.5,"Potatoes Production (tonnes)":2749.14,"Meat, chicken Production (tonnes)":187,"Avocados Production (tonnes)":23943,"Petrol Price (USD/liter)":2.09,"Daily Oil Consumption (Barrels)":56194,"CO2 Emissions (ton per capita)":15.30642656},{"Country":"Switzerland","Country_clean":"switzerland","Region":"Western Europe","Happiness":7.06,"Median Salary":9836.07,"Average Salary":11292.9,"Lowest Salary":2850.27,"Highest Salary":50363.93,"Infant Survival Rate":1000,"Alcohol Consumption Rate":9.61,"Life Expectancy":83.4,"Netflix (USD/month)":20.46,"Women Safety Index":0.928,"Average Winter Temperature":-2.5467072,"Average Summer Temperature":-1.4338865,"Population":8740472,"Energy Per Capita":33350.754,"% of Power from Fossil Fuels":3.631,"% of Power from Nuclear":36.964,"% of Power from Renewables":59.406,"% of Agricultural Land":37.9496922649,"% of Forest Land":32.2086033203,"Territory":39509.63,"Average Rainfall":1537,"Corruption":0.2001170814,"Wheat Production (tonnes)":702495.4,"Rye Production (tonnes)":118594,"Potatoes Production (tonnes)":6485000,"Meat, chicken Production (tonnes)":100.8,"Avocados Production (tonnes)":226048.64,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":228194,"CO2 Emissions (ton per capita)":4.359041462},{"Country":"Australia","Country_clean":"australia","Region":"North America and ANZ","Happiness":7.057,"Median Salary":4306.45,"Average Salary":4903.23,"Lowest Salary":1236.13,"Highest Salary":21774.19,"Infant Survival Rate":999,"Alcohol Consumption Rate":9.71,"Life Expectancy":82.8,"Netflix (USD/month)":12.12,"Women Safety Index":0.902,"Average Winter Temperature":28.664902,"Average Summer Temperature":29.092043,"Population":26177413,"Energy Per Capita":63458.84,"% of Power from Fossil Fuels":67.697,"% of Power from Nuclear":0,"% of Power from Renewables":32.303,"% of Agricultural Land":47.2592374955,"% of Forest Land":17.4213145572,"Territory":7692020,"Average Rainfall":534,"Corruption":0.1621359587,"Wheat Production (tonnes)":1970363.6,"Rye Production (tonnes)":269,"Potatoes Production (tonnes)":767261.1,"Meat, chicken Production (tonnes)":1191322,"Avocados Production (tonnes)":202541,"Petrol Price (USD/liter)":1.38,"Daily Oil Consumption (Barrels)":1114645,"CO2 Emissions (ton per capita)":15.23826715},{"Country":"New Zealand","Country_clean":"new zealand","Region":"North America and ANZ","Happiness":7.029,"Median Salary":4196.41,"Average Salary":4870.06,"Lowest Salary":1227.54,"Highest Salary":21656.29,"Infant Survival Rate":1000,"Alcohol Consumption Rate":8.7,"Life Expectancy":81.6,"Netflix (USD/month)":12.53,"Women Safety Index":0.904,"Average Winter Temperature":15.329823,"Average Summer Temperature":16.2116,"Population":5185288,"Energy Per Capita":44939.27,"% of Power from Fossil Fuels":14.444,"% of Power from Nuclear":0,"% of Power from Renewables":85.556,"% of Agricultural Land":38.6426645399,"% of Forest Land":37.6306509438,"Territory":263310,"Average Rainfall":1732,"Corruption":0.1743465513,"Wheat Production (tonnes)":93719040,"Rye Production (tonnes)":1116969.72,"Potatoes Production (tonnes)":919200,"Meat, chicken Production (tonnes)":4000,"Avocados Production (tonnes)":271591.974,"Petrol Price (USD/liter)":2.07,"Daily Oil Consumption (Barrels)":166913,"CO2 Emissions (ton per capita)":6.830414187},{"Country":"Costa Rica","Country_clean":"costa rica","Region":"Latin America and Caribbean","Happiness":6.955,"Median Salary":4016.06,"Average Salary":4427.01,"Lowest Salary":1115.16,"Highest Salary":19613.34,"Infant Survival Rate":999,"Alcohol Consumption Rate":3.45,"Life Expectancy":79.6,"Netflix (USD/month)":12.99,"Women Safety Index":0.743,"Average Winter Temperature":22.746216,"Average Summer Temperature":23.510368,"Population":5180829,"Energy Per Capita":11957.598,"% of Power from Fossil Fuels":1.979,"% of Power from Nuclear":0,"% of Power from Renewables":98.021,"% of Agricultural Land":35.4680767724,"% of Forest Land":59.7579318449,"Territory":51060,"Average Rainfall":2926,"Corruption":0.1670125574,"Wheat Production (tonnes)":195069710,"Rye Production (tonnes)":124200,"Potatoes Production (tonnes)":695604,"Meat, chicken Production (tonnes)":569.91,"Avocados Production (tonnes)":380,"Petrol Price (USD/liter)":1.55,"Daily Oil Consumption (Barrels)":55000,"CO2 Emissions (ton per capita)":1.632471558},{"Country":"Kuwait","Country_clean":"kuwait","Region":"Middle East and North Africa","Happiness":6.951,"Median Salary":null,"Average Salary":null,"Lowest Salary":null,"Highest Salary":null,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":74.7,"Netflix (USD/month)":null,"Women Safety Index":0.742,"Average Winter Temperature":14.190281,"Average Summer Temperature":16.082039,"Population":4268873,"Energy Per Capita":103882.75,"% of Power from Fossil Fuels":99.93,"% of Power from Nuclear":0,"% of Power from Renewables":0.258,"% of Agricultural Land":8.4175084175,"% of Forest Land":0.3507295174,"Territory":17820,"Average Rainfall":121,"Corruption":0.1987654865,"Wheat Production (tonnes)":413533,"Rye Production (tonnes)":433732.2,"Potatoes Production (tonnes)":190000,"Meat, chicken Production (tonnes)":371700,"Avocados Production (tonnes)":264535,"Petrol Price (USD/liter)":0.34,"Daily Oil Consumption (Barrels)":359000,"CO2 Emissions (ton per capita)":22.0224164},{"Country":"Austria","Country_clean":"austria","Region":"Western Europe","Happiness":6.905,"Median Salary":3572.94,"Average Salary":4016.91,"Lowest Salary":1014.8,"Highest Salary":17864.69,"Infant Survival Rate":1000,"Alcohol Consumption Rate":12.32,"Life Expectancy":81.5,"Netflix (USD/month)":14.67,"Women Safety Index":0.911,"Average Winter Temperature":-1.6856745,"Average Summer Temperature":-0.967524,"Population":8939617,"Energy Per Capita":42685.379,"% of Power from Fossil Fuels":23.713,"% of Power from Nuclear":0,"% of Power from Renewables":76.287,"% of Agricultural Land":31.4767256423,"% of Forest Land":47.2944740669,"Territory":82520,"Average Rainfall":1110,"Corruption":0.1622093022,"Wheat Production (tonnes)":1041825,"Rye Production (tonnes)":4076,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":125900,"Avocados Production (tonnes)":260,"Petrol Price (USD/liter)":2.13,"Daily Oil Consumption (Barrels)":262352,"CO2 Emissions (ton per capita)":7.293984252},{"Country":"Canada","Country_clean":"canada","Region":"North America and ANZ","Happiness":6.9,"Median Salary":6311.03,"Average Salary":7352.94,"Lowest Salary":1850,"Highest Salary":32720.59,"Infant Survival Rate":998,"Alcohol Consumption Rate":8.1,"Life Expectancy":82.2,"Netflix (USD/month)":11.87,"Women Safety Index":0.885,"Average Winter Temperature":-19.196556,"Average Summer Temperature":-14.700624,"Population":38454327,"Energy Per Capita":102160.289,"% of Power from Fossil Fuels":17.368,"% of Power from Nuclear":12.888,"% of Power from Renewables":69.744,"% of Agricultural Land":6.4845767861,"% of Forest Land":39.4701279256,"Territory":8788700,"Average Rainfall":537,"Corruption":0.1705811173,"Wheat Production (tonnes)":96520,"Rye Production (tonnes)":10210326,"Potatoes Production (tonnes)":13000,"Meat, chicken Production (tonnes)":17203.52,"Avocados Production (tonnes)":31000,"Petrol Price (USD/liter)":1.79,"Daily Oil Consumption (Barrels)":2486301,"CO2 Emissions (ton per capita)":15.43061283},{"Country":"Belgium","Country_clean":"belgium","Region":"Western Europe","Happiness":6.894,"Median Salary":5729.39,"Average Salary":6522.2,"Lowest Salary":1997.89,"Highest Salary":27378.44,"Infant Survival Rate":1000,"Alcohol Consumption Rate":12.6,"Life Expectancy":81.1,"Netflix (USD/month)":15.24,"Women Safety Index":0.902,"Average Winter Temperature":2.9873695,"Average Summer Temperature":4.751282,"Population":11655930,"Energy Per Capita":58395.824,"% of Power from Fossil Fuels":27.892,"% of Power from Nuclear":46.659,"% of Power from Renewables":25.449,"% of Agricultural Land":45.1013870542,"% of Forest Land":22.7642007926,"Territory":30280,"Average Rainfall":847,"Corruption":0.1622093022,"Wheat Production (tonnes)":240533,"Rye Production (tonnes)":219,"Potatoes Production (tonnes)":171,"Meat, chicken Production (tonnes)":14934,"Avocados Production (tonnes)":51351,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":631522,"CO2 Emissions (ton per capita)":8.095583954},{"Country":"Ireland","Country_clean":"ireland","Region":"Western Europe","Happiness":6.838,"Median Salary":3021.14,"Average Salary":3399.58,"Lowest Salary":856.24,"Highest Salary":15151.16,"Infant Survival Rate":1000,"Alcohol Consumption Rate":10.75,"Life Expectancy":81.4,"Netflix (USD/month)":14.67,"Women Safety Index":0.892,"Average Winter Temperature":5.0232058,"Average Summer Temperature":7.5741353,"Population":5023109,"Energy Per Capita":37761.402,"% of Power from Fossil Fuels":61.381,"% of Power from Nuclear":0,"% of Power from Renewables":38.619,"% of Agricultural Land":62.9554362026,"% of Forest Land":11.4097837132,"Territory":68890,"Average Rainfall":1118,"Corruption":0.1622093022,"Wheat Production (tonnes)":1290.74,"Rye Production (tonnes)":46331.4,"Potatoes Production (tonnes)":294,"Meat, chicken Production (tonnes)":2790,"Avocados Production (tonnes)":84114,"Petrol Price (USD/liter)":2.07,"Daily Oil Consumption (Barrels)":152404,"CO2 Emissions (ton per capita)":7.245143221},{"Country":"Czechia","Country_clean":"czech republic","Region":"Central and Eastern Europe","Happiness":6.822,"Median Salary":2310.03,"Average Salary":2653.06,"Lowest Salary":668.69,"Highest Salary":11810.68,"Infant Survival Rate":1000,"Alcohol Consumption Rate":12.68,"Life Expectancy":78.8,"Netflix (USD/month)":11.49,"Women Safety Index":0.884,"Average Winter Temperature":-0.254366,"Average Summer Temperature":1.0374577,"Population":10493986,"Energy Per Capita":44242.148,"% of Power from Fossil Fuels":51.251,"% of Power from Nuclear":36.412,"% of Power from Renewables":12.337,"% of Agricultural Land":45.7305605114,"% of Forest Land":34.7066980209,"Territory":77186.83,"Average Rainfall":677,"Corruption":0.1467373222,"Wheat Production (tonnes)":122501976,"Rye Production (tonnes)":5116,"Potatoes Production (tonnes)":631,"Meat, chicken Production (tonnes)":123700,"Avocados Production (tonnes)":4200,"Petrol Price (USD/liter)":2,"Daily Oil Consumption (Barrels)":179956,"CO2 Emissions (ton per capita)":9.022786158},{"Country":"Lithuania","Country_clean":"lithuania","Region":"Central and Eastern Europe","Happiness":6.818,"Median Salary":903.87466,"Average Salary":997.90189,"Lowest Salary":251.75032,"Highest Salary":4428.3792,"Infant Survival Rate":1000,"Alcohol Consumption Rate":15.19,"Life Expectancy":73.6,"Netflix (USD/month)":11.29,"Women Safety Index":0.886,"Average Winter Temperature":-4.2955937,"Average Summer Temperature":1.70184,"Population":2750055,"Energy Per Capita":23151.053,"% of Power from Fossil Fuels":25.18,"% of Power from Nuclear":0,"% of Power from Renewables":74.82,"% of Agricultural Land":46.9222168983,"% of Forest Land":35.1807490816,"Territory":62610,"Average Rainfall":656,"Corruption":0.1467373222,"Wheat Production (tonnes)":15983841,"Rye Production (tonnes)":21420,"Potatoes Production (tonnes)":26995,"Meat, chicken Production (tonnes)":1391220,"Avocados Production (tonnes)":17200,"Petrol Price (USD/liter)":2.14,"Daily Oil Consumption (Barrels)":61612,"CO2 Emissions (ton per capita)":4.198076022},{"Country":"United Kingdom","Country_clean":"united kingdom","Region":"Western Europe","Happiness":6.749,"Median Salary":6300,"Average Salary":7235.37,"Lowest Salary":1829.27,"Highest Salary":32214.63,"Infant Survival Rate":997,"Alcohol Consumption Rate":10.66,"Life Expectancy":81.2,"Netflix (USD/month)":13.2,"Women Safety Index":0.86,"Average Winter Temperature":4.4938073,"Average Summer Temperature":6.856918,"Population":67508936,"Energy Per Capita":30097.885,"% of Power from Fossil Fuels":43.729,"% of Power from Nuclear":14.823,"% of Power from Renewables":41.448,"% of Agricultural Land":71.1575290373,"% of Forest Land":13.2214553797,"Territory":241930,"Average Rainfall":1220,"Corruption":0.1743465513,"Wheat Production (tonnes)":14336835.8,"Rye Production (tonnes)":56256.17,"Potatoes Production (tonnes)":157125,"Meat, chicken Production (tonnes)":70221,"Avocados Production (tonnes)":238651.706,"Petrol Price (USD/liter)":2.22,"Daily Oil Consumption (Barrels)":1583896,"CO2 Emissions (ton per capita)":5.220514488},{"Country":"Slovenia","Country_clean":"slovenia","Region":"Central and Eastern Europe","Happiness":6.743,"Median Salary":1934.46,"Average Salary":2093.02,"Lowest Salary":528.54,"Highest Salary":9302.33,"Infant Survival Rate":1000,"Alcohol Consumption Rate":10.46,"Life Expectancy":88,"Netflix (USD/month)":null,"Women Safety Index":0.824,"Average Winter Temperature":0.9988481,"Average Summer Temperature":1.4752173,"Population":2119844,"Energy Per Capita":34391.094,"% of Power from Fossil Fuels":28.259,"% of Power from Nuclear":42.125,"% of Power from Renewables":29.616,"% of Agricultural Land":30.3410738762,"% of Forest Land":61.3711140025,"Territory":20136.4,"Average Rainfall":1162,"Corruption":0.1467373222,"Wheat Production (tonnes)":645031.8,"Rye Production (tonnes)":168.6,"Potatoes Production (tonnes)":7326446,"Meat, chicken Production (tonnes)":4000,"Avocados Production (tonnes)":163.4,"Petrol Price (USD/liter)":1.62,"Daily Oil Consumption (Barrels)":52298,"CO2 Emissions (ton per capita)":6.512209378},{"Country":"United Arab Emirates","Country_clean":"united arab emirates","Region":"Middle East and North Africa","Happiness":6.733,"Median Salary":3324.25,"Average Salary":3896.46,"Lowest Salary":708.45,"Highest Salary":18637.6,"Infant Survival Rate":999,"Alcohol Consumption Rate":1.91,"Life Expectancy":77.1,"Netflix (USD/month)":13.99,"Women Safety Index":0.868,"Average Winter Temperature":20.363506,"Average Summer Temperature":20.625269,"Population":9441129,"Energy Per Capita":148576.547,"% of Power from Fossil Fuels":82.508,"% of Power from Nuclear":12.992,"% of Power from Renewables":4.5,"% of Agricultural Land":5.5133976345,"% of Forest Land":4.4677555618,"Territory":71020,"Average Rainfall":78,"Corruption":0.1655614674,"Wheat Production (tonnes)":46614014.4,"Rye Production (tonnes)":72513,"Potatoes Production (tonnes)":136000,"Meat, chicken Production (tonnes)":60000,"Avocados Production (tonnes)":43039.038,"Petrol Price (USD/liter)":1.1,"Daily Oil Consumption (Barrels)":896000,"CO2 Emissions (ton per capita)":19.32956328},{"Country":"United States","Country_clean":"united states","Region":"North America and ANZ","Happiness":6.725,"Median Salary":6966,"Average Salary":7925,"Lowest Salary":2000,"Highest Salary":35250,"Infant Survival Rate":977,"Alcohol Consumption Rate":8.82,"Life Expectancy":79.3,"Netflix (USD/month)":13.99,"Women Safety Index":0.823,"Average Winter Temperature":-2.7272227,"Average Summer Temperature":0.94223034,"Population":338289857,"Energy Per Capita":78754.273,"% of Power from Fossil Fuels":59.523,"% of Power from Nuclear":17.956,"% of Power from Renewables":22.521,"% of Agricultural Land":44.3633673539,"% of Forest Land":33.866926412,"Territory":9147420,"Average Rainfall":715,"Corruption":0.1590943187,"Wheat Production (tonnes)":110,"Rye Production (tonnes)":12326464,"Potatoes Production (tonnes)":2525383,"Meat, chicken Production (tonnes)":361499,"Avocados Production (tonnes)":1219.74,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":19687287,"CO2 Emissions (ton per capita)":14.67341061},{"Country":"Germany","Country_clean":"germany","Region":"Western Europe","Happiness":6.719,"Median Salary":3731.5,"Average Salary":4048.63,"Lowest Salary":1014.8,"Highest Salary":17970.4,"Infant Survival Rate":998,"Alcohol Consumption Rate":11.03,"Life Expectancy":81,"Netflix (USD/month)":14.67,"Women Safety Index":0.871,"Average Winter Temperature":1.539955,"Average Summer Temperature":3.0275564,"Population":83369843,"Energy Per Capita":40977.492,"% of Power from Fossil Fuels":50.783,"% of Power from Nuclear":6.27,"% of Power from Renewables":42.947,"% of Agricultural Land":47.485617791,"% of Forest Land":32.6826755202,"Territory":349390,"Average Rainfall":700,"Corruption":0.1622093022,"Wheat Production (tonnes)":156400,"Rye Production (tonnes)":601991,"Potatoes Production (tonnes)":138832220,"Meat, chicken Production (tonnes)":14429,"Avocados Production (tonnes)":2073,"Petrol Price (USD/liter)":2.02,"Daily Oil Consumption (Barrels)":2383393,"CO2 Emissions (ton per capita)":7.911621016},{"Country":"Mexico","Country_clean":"mexico","Region":"Latin America and Caribbean","Happiness":6.678,"Median Salary":1681.97,"Average Salary":1917.34,"Lowest Salary":482.78,"Highest Salary":8495.98,"Infant Survival Rate":970,"Alcohol Consumption Rate":5.26,"Life Expectancy":76.7,"Netflix (USD/month)":10.43,"Women Safety Index":0.551,"Average Winter Temperature":15.8056965,"Average Summer Temperature":17.122166,"Population":127504125,"Energy Per Capita":19009.186,"% of Power from Fossil Fuels":74.097,"% of Power from Nuclear":2.964,"% of Power from Renewables":22.938,"% of Agricultural Land":49.9632192186,"% of Forest Land":33.7273678335,"Territory":1943950,"Average Rainfall":758,"Corruption":0.1599350423,"Wheat Production (tonnes)":1744,"Rye Production (tonnes)":260323.2,"Potatoes Production (tonnes)":10968420,"Meat, chicken Production (tonnes)":53300,"Avocados Production (tonnes)":2376648.5,"Petrol Price (USD/liter)":1.15,"Daily Oil Consumption (Barrels)":2052607,"CO2 Emissions (ton per capita)":3.521600048},{"Country":"Uruguay","Country_clean":"uruguay","Region":"Latin America and Caribbean","Happiness":6.611,"Median Salary":773.64,"Average Salary":862.2,"Lowest Salary":217.24,"Highest Salary":3829.12,"Infant Survival Rate":1000,"Alcohol Consumption Rate":6.03,"Life Expectancy":77,"Netflix (USD/month)":12.99,"Women Safety Index":0.748,"Average Winter Temperature":20.111822,"Average Summer Temperature":23.139511,"Population":3422794,"Energy Per Capita":18316.926,"% of Power from Fossil Fuels":15.557,"% of Power from Nuclear":0,"% of Power from Renewables":84.443,"% of Agricultural Land":80.3885555936,"% of Forest Land":11.7243743572,"Territory":175020,"Average Rainfall":1300,"Corruption":0.1677868664,"Wheat Production (tonnes)":223447.024,"Rye Production (tonnes)":7181.2,"Potatoes Production (tonnes)":12261,"Meat, chicken Production (tonnes)":3200,"Avocados Production (tonnes)":36219.6,"Petrol Price (USD/liter)":2.02,"Daily Oil Consumption (Barrels)":53000,"CO2 Emissions (ton per capita)":1.874784543},{"Country":"France","Country_clean":"france","Region":"Western Europe","Happiness":6.609,"Median Salary":3769.56,"Average Salary":4377.38,"Lowest Salary":1100.42,"Highest Salary":19467.23,"Infant Survival Rate":998,"Alcohol Consumption Rate":11.5,"Life Expectancy":82.4,"Netflix (USD/month)":15.24,"Women Safety Index":0.864,"Average Winter Temperature":7.6805277,"Average Summer Temperature":7.854504,"Population":64626628,"Energy Per Capita":36051.793,"% of Power from Fossil Fuels":12.154,"% of Power from Nuclear":63.304,"% of Power from Renewables":24.542,"% of Agricultural Land":52.1475462829,"% of Forest Land":31.6613612829,"Territory":547557,"Average Rainfall":867,"Corruption":0.1622093022,"Wheat Production (tonnes)":332400,"Rye Production (tonnes)":125870,"Potatoes Production (tonnes)":402966,"Meat, chicken Production (tonnes)":10075471,"Avocados Production (tonnes)":28385.3,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":1705568,"CO2 Emissions (ton per capita)":4.468770089},{"Country":"Saudi Arabia","Country_clean":"saudi arabia","Region":"Middle East and North Africa","Happiness":6.594,"Median Salary":3840,"Average Salary":4480,"Lowest Salary":1128,"Highest Salary":19893.33,"Infant Survival Rate":993,"Alcohol Consumption Rate":0.09,"Life Expectancy":74.5,"Netflix (USD/month)":null,"Women Safety Index":0.737,"Average Winter Temperature":16.798635,"Average Summer Temperature":17.893715,"Population":36408820,"Energy Per Capita":87707.289,"% of Power from Fossil Fuels":99.792,"% of Power from Nuclear":0,"% of Power from Renewables":0.208,"% of Agricultural Land":80.7730416944,"% of Forest Land":0.4544841349,"Territory":2149690,"Average Rainfall":59,"Corruption":0.1871376336,"Wheat Production (tonnes)":229775,"Rye Production (tonnes)":70119.8,"Potatoes Production (tonnes)":738265,"Meat, chicken Production (tonnes)":5332,"Avocados Production (tonnes)":8802.4,"Petrol Price (USD/liter)":0.62,"Daily Oil Consumption (Barrels)":3302000,"CO2 Emissions (ton per capita)":15.28457873},{"Country":"Kosovo","Country_clean":"kosovo","Region":"Central and Eastern Europe","Happiness":6.561,"Median Salary":null,"Average Salary":null,"Lowest Salary":null,"Highest Salary":null,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":null,"Average Winter Temperature":1.4193249,"Average Summer Temperature":1.8427454,"Population":null,"Energy Per Capita":16776.646,"% of Power from Fossil Fuels":93.71,"% of Power from Nuclear":0,"% of Power from Renewables":6.29,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":0.170497179,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":null},{"Country":"Singapore","Country_clean":"singapore","Region":"Southeast Asia","Happiness":6.523,"Median Salary":5647.06,"Average Salary":6235.29,"Lowest Salary":1573.53,"Highest Salary":27720.59,"Infant Survival Rate":1000,"Alcohol Consumption Rate":1.79,"Life Expectancy":83.1,"Netflix (USD/month)":12.81,"Women Safety Index":0.887,"Average Winter Temperature":null,"Average Summer Temperature":null,"Population":5975689,"Energy Per Capita":147084.844,"% of Power from Fossil Fuels":97.591,"% of Power from Nuclear":0,"% of Power from Renewables":2.409,"% of Agricultural Land":0.9192200557,"% of Forest Land":21.43454039,"Territory":718,"Average Rainfall":2497,"Corruption":0.1537519991,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":2.3,"Daily Oil Consumption (Barrels)":1357000,"CO2 Emissions (ton per capita)":8.307079491},{"Country":"Taiwan Province of China","Country_clean":"taiwan province of china","Region":"East Asia","Happiness":6.503,"Median Salary":3684.93,"Average Salary":4027.4,"Lowest Salary":1015.07,"Highest Salary":17945.21,"Infant Survival Rate":994,"Alcohol Consumption Rate":0.01,"Life Expectancy":76,"Netflix (USD/month)":11.9,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":55.4626494294,"% of Forest Land":23.6315282679,"Territory":9388210,"Average Rainfall":645,"Corruption":0.1543876231,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Romania","Country_clean":"romania","Region":"Central and Eastern Europe","Happiness":6.491,"Median Salary":1739.87,"Average Salary":1921.11,"Lowest Salary":484.01,"Highest Salary":8550.11,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":75,"Netflix (USD/month)":11.29,"Women Safety Index":0.8,"Average Winter Temperature":-0.022084355,"Average Summer Temperature":1.9483956,"Population":19659267,"Energy Per Capita":18346.869,"% of Power from Fossil Fuels":37.815,"% of Power from Nuclear":20.036,"% of Power from Renewables":42.149,"% of Agricultural Land":56.8454450626,"% of Forest Land":30.1158292768,"Territory":230080,"Average Rainfall":637,"Corruption":0.1467373222,"Wheat Production (tonnes)":32129760,"Rye Production (tonnes)":137059.6,"Potatoes Production (tonnes)":119834,"Meat, chicken Production (tonnes)":6314210,"Avocados Production (tonnes)":17978,"Petrol Price (USD/liter)":1.82,"Daily Oil Consumption (Barrels)":200000,"CO2 Emissions (ton per capita)":3.817434477},{"Country":"El Salvador","Country_clean":"el salvador","Region":"Latin America and Caribbean","Happiness":6.469,"Median Salary":1470,"Average Salary":1710,"Lowest Salary":430,"Highest Salary":7610,"Infant Survival Rate":998,"Alcohol Consumption Rate":2.52,"Life Expectancy":73.5,"Netflix (USD/month)":null,"Women Safety Index":0.566,"Average Winter Temperature":25.628748,"Average Summer Temperature":27.070652,"Population":6336392,"Energy Per Capita":7076.433,"% of Power from Fossil Fuels":26.772,"% of Power from Nuclear":0,"% of Power from Renewables":73.228,"% of Agricultural Land":57.7075289575,"% of Forest Land":27.9623552124,"Territory":20720,"Average Rainfall":1784,"Corruption":0.1591664106,"Wheat Production (tonnes)":439000,"Rye Production (tonnes)":9716,"Potatoes Production (tonnes)":104795630,"Meat, chicken Production (tonnes)":1130102,"Avocados Production (tonnes)":93872.16,"Petrol Price (USD/liter)":1.14,"Daily Oil Consumption (Barrels)":52000,"CO2 Emissions (ton per capita)":1.208637136},{"Country":"Estonia","Country_clean":"estonia","Region":"Central and Eastern Europe","Happiness":6.448,"Median Salary":2579.28,"Average Salary":2906.98,"Lowest Salary":729.39,"Highest Salary":12896.41,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":77.6,"Netflix (USD/month)":11.29,"Women Safety Index":0.892,"Average Winter Temperature":-6.8556023,"Average Summer Temperature":1.2210779,"Population":1326062,"Energy Per Capita":46504.863,"% of Power from Fossil Fuels":55.995,"% of Power from Nuclear":0,"% of Power from Renewables":44.005,"% of Agricultural Land":23.0877192982,"% of Forest Land":57.0385964912,"Territory":42750,"Average Rainfall":626,"Corruption":0.1467373222,"Wheat Production (tonnes)":583000,"Rye Production (tonnes)":20000,"Potatoes Production (tonnes)":82505816,"Meat, chicken Production (tonnes)":2425173,"Avocados Production (tonnes)":6500,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":28855,"CO2 Emissions (ton per capita)":7.672277909},{"Country":"Poland","Country_clean":"poland","Region":"Central and Eastern Europe","Happiness":6.442,"Median Salary":1496.57,"Average Salary":1736.84,"Lowest Salary":437.07,"Highest Salary":7734.55,"Infant Survival Rate":998,"Alcohol Consumption Rate":10.71,"Life Expectancy":77.5,"Netflix (USD/month)":10.58,"Women Safety Index":0.859,"Average Winter Temperature":-0.49168286,"Average Summer Temperature":2.4689384,"Population":39857145,"Energy Per Capita":30065.42,"% of Power from Fossil Fuels":78.957,"% of Power from Nuclear":0,"% of Power from Renewables":21.043,"% of Agricultural Land":47.3683763476,"% of Forest Land":31.0192747468,"Territory":306100,"Average Rainfall":600,"Corruption":0.1467373222,"Wheat Production (tonnes)":452089,"Rye Production (tonnes)":208680.516,"Potatoes Production (tonnes)":260,"Meat, chicken Production (tonnes)":2000,"Avocados Production (tonnes)":153457.498,"Petrol Price (USD/liter)":1.8,"Daily Oil Consumption (Barrels)":582161,"CO2 Emissions (ton per capita)":7.773641839},{"Country":"Spain","Country_clean":"spain","Region":"Western Europe","Happiness":6.421,"Median Salary":2579.28,"Average Salary":2875.26,"Lowest Salary":877.38,"Highest Salary":12050.74,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":82.8,"Netflix (USD/month)":14.67,"Women Safety Index":0.859,"Average Winter Temperature":7.264159,"Average Summer Temperature":8.429356,"Population":47558630,"Energy Per Capita":33615.332,"% of Power from Fossil Fuels":37.267,"% of Power from Nuclear":20.515,"% of Power from Renewables":42.218,"% of Agricultural Land":52.4848941208,"% of Forest Land":37.1727521093,"Territory":499733.244,"Average Rainfall":636,"Corruption":0.1622093022,"Wheat Production (tonnes)":68301098.8,"Rye Production (tonnes)":179520.532,"Potatoes Production (tonnes)":4600000,"Meat, chicken Production (tonnes)":400,"Avocados Production (tonnes)":119712.856,"Petrol Price (USD/liter)":2.21,"Daily Oil Consumption (Barrels)":1290063,"CO2 Emissions (ton per capita)":5.09135092},{"Country":"Serbia","Country_clean":"serbia","Region":"Central and Eastern Europe","Happiness":6.411,"Median Salary":1120.04,"Average Salary":1273.6,"Lowest Salary":320.66,"Highest Salary":5654.41,"Infant Survival Rate":999,"Alcohol Consumption Rate":9.09,"Life Expectancy":75.6,"Netflix (USD/month)":null,"Women Safety Index":0.835,"Average Winter Temperature":1.7233353,"Average Summer Temperature":2.3860748,"Population":7221365,"Energy Per Capita":27640.852,"% of Power from Fossil Fuels":70.509,"% of Power from Nuclear":0,"% of Power from Renewables":29.491,"% of Agricultural Land":41.4436912831,"% of Forest Land":32.3812581758,"Territory":84090,"Average Rainfall":null,"Corruption":0.1620248556,"Wheat Production (tonnes)":3997110.2,"Rye Production (tonnes)":0,"Potatoes Production (tonnes)":1879008,"Meat, chicken Production (tonnes)":387376.3,"Avocados Production (tonnes)":12.308,"Petrol Price (USD/liter)":1.76,"Daily Oil Consumption (Barrels)":74000,"CO2 Emissions (ton per capita)":6.616046939},{"Country":"Chile","Country_clean":"chile","Region":"Latin America and Caribbean","Happiness":6.36,"Median Salary":1890.4,"Average Salary":2090.56,"Lowest Salary":525.98,"Highest Salary":9274.09,"Infant Survival Rate":998,"Alcohol Consumption Rate":7.16,"Life Expectancy":85,"Netflix (USD/month)":9.91,"Women Safety Index":0.736,"Average Winter Temperature":12.694138,"Average Summer Temperature":14.701271,"Population":19603733,"Energy Per Capita":25342.707,"% of Power from Fossil Fuels":47.044,"% of Power from Nuclear":0,"% of Power from Renewables":52.956,"% of Agricultural Land":14.250277056,"% of Forest Land":24.6574727113,"Territory":743532,"Average Rainfall":1522,"Corruption":0.1599350423,"Wheat Production (tonnes)":102965304,"Rye Production (tonnes)":108500,"Potatoes Production (tonnes)":25363,"Meat, chicken Production (tonnes)":230758.84,"Avocados Production (tonnes)":50,"Petrol Price (USD/liter)":1.39,"Daily Oil Consumption (Barrels)":351989,"CO2 Emissions (ton per capita)":4.821118299},{"Country":"Panama","Country_clean":"panama","Region":"Latin America and Caribbean","Happiness":6.358,"Median Salary":1890,"Average Salary":2130,"Lowest Salary":540,"Highest Salary":9460,"Infant Survival Rate":999,"Alcohol Consumption Rate":6.74,"Life Expectancy":77.8,"Netflix (USD/month)":null,"Women Safety Index":0.757,"Average Winter Temperature":24.940985,"Average Summer Temperature":25.922495,"Population":4408581,"Energy Per Capita":27067.068,"% of Power from Fossil Fuels":25.469,"% of Power from Nuclear":0,"% of Power from Renewables":74.531,"% of Agricultural Land":29.4057158264,"% of Forest Land":56.6517026153,"Territory":74180,"Average Rainfall":2928,"Corruption":0.1670125574,"Wheat Production (tonnes)":12000,"Rye Production (tonnes)":7.6,"Potatoes Production (tonnes)":1280086,"Meat, chicken Production (tonnes)":3500,"Avocados Production (tonnes)":16528.4,"Petrol Price (USD/liter)":1.45,"Daily Oil Consumption (Barrels)":155000,"CO2 Emissions (ton per capita)":3.141454996},{"Country":"Malta","Country_clean":"malta","Region":"Western Europe","Happiness":6.346,"Median Salary":4439.75,"Average Salary":4904.86,"Lowest Salary":1236.79,"Highest Salary":21775.9,"Infant Survival Rate":1000,"Alcohol Consumption Rate":8.49,"Life Expectancy":81.7,"Netflix (USD/month)":null,"Women Safety Index":0.846,"Average Winter Temperature":null,"Average Summer Temperature":null,"Population":533286,"Energy Per Capita":74324.461,"% of Power from Fossil Fuels":99.5,"% of Power from Nuclear":0,"% of Power from Renewables":0.5,"% of Agricultural Land":27.34375,"% of Forest Land":1.4375,"Territory":320,"Average Rainfall":560,"Corruption":0.1696073413,"Wheat Production (tonnes)":5165083,"Rye Production (tonnes)":4862470.8,"Potatoes Production (tonnes)":1641853,"Meat, chicken Production (tonnes)":597949,"Avocados Production (tonnes)":4449.6,"Petrol Price (USD/liter)":1.4,"Daily Oil Consumption (Barrels)":47000,"CO2 Emissions (ton per capita)":3.293245606},{"Country":"Italy","Country_clean":"italy","Region":"Western Europe","Happiness":6.324,"Median Salary":3467.23,"Average Salary":3868.92,"Lowest Salary":972.52,"Highest Salary":17230.44,"Infant Survival Rate":999,"Alcohol Consumption Rate":7.56,"Life Expectancy":82.7,"Netflix (USD/month)":14.67,"Women Safety Index":0.827,"Average Winter Temperature":5.8631363,"Average Summer Temperature":6.1182337,"Population":59037474,"Energy Per Capita":28910.201,"% of Power from Fossil Fuels":63.562,"% of Power from Nuclear":0,"% of Power from Renewables":36.438,"% of Agricultural Land":41.942231593,"% of Forest Land":32.5308994748,"Territory":295717,"Average Rainfall":832,"Corruption":0.1622093022,"Wheat Production (tonnes)":5700,"Rye Production (tonnes)":1012,"Potatoes Production (tonnes)":20475928,"Meat, chicken Production (tonnes)":4700,"Avocados Production (tonnes)":13817.47,"Petrol Price (USD/liter)":2.12,"Daily Oil Consumption (Barrels)":1236628,"CO2 Emissions (ton per capita)":5.311315442},{"Country":"Guatemala","Country_clean":"guatemala","Region":"Latin America and Caribbean","Happiness":6.287,"Median Salary":1222.65,"Average Salary":1335.88,"Lowest Salary":337.15,"Highest Salary":5954.2,"Infant Survival Rate":990,"Alcohol Consumption Rate":1.88,"Life Expectancy":71.9,"Netflix (USD/month)":10.99,"Women Safety Index":0.569,"Average Winter Temperature":21.24547,"Average Summer Temperature":22.411528,"Population":17843908,"Energy Per Capita":5712.118,"% of Power from Fossil Fuels":34.488,"% of Power from Nuclear":0,"% of Power from Renewables":65.512,"% of Agricultural Land":43.0384471818,"% of Forest Land":32.812616648,"Territory":107160,"Average Rainfall":1996,"Corruption":0.1670125574,"Wheat Production (tonnes)":483,"Rye Production (tonnes)":511.23,"Potatoes Production (tonnes)":18843300,"Meat, chicken Production (tonnes)":1760,"Avocados Production (tonnes)":1023.49,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":93000,"CO2 Emissions (ton per capita)":1.162970924},{"Country":"Nicaragua","Country_clean":"nicaragua","Region":"Latin America and Caribbean","Happiness":6.284,"Median Salary":449.1,"Average Salary":517.15,"Lowest Salary":130.38,"Highest Salary":2299.95,"Infant Survival Rate":998,"Alcohol Consumption Rate":3.55,"Life Expectancy":74.8,"Netflix (USD/month)":null,"Women Safety Index":0.717,"Average Winter Temperature":24.97253,"Average Summer Temperature":25.584845,"Population":6948392,"Energy Per Capita":4265.271,"% of Power from Fossil Fuels":45.356,"% of Power from Nuclear":0,"% of Power from Renewables":54.644,"% of Agricultural Land":42.3051354496,"% of Forest Land":27.4848761841,"Territory":120340,"Average Rainfall":2280,"Corruption":0.1591832638,"Wheat Production (tonnes)":19615588,"Rye Production (tonnes)":1503073.6,"Potatoes Production (tonnes)":770127,"Meat, chicken Production (tonnes)":20825,"Avocados Production (tonnes)":46826.8,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":37000,"CO2 Emissions (ton per capita)":0.800549594},{"Country":"Brazil","Country_clean":"brazil","Region":"Latin America and Caribbean","Happiness":6.272,"Median Salary":1490.04,"Average Salary":1711.16,"Lowest Salary":432.27,"Highest Salary":7609.56,"Infant Survival Rate":958,"Alcohol Consumption Rate":7.32,"Life Expectancy":75,"Netflix (USD/month)":7.11,"Women Safety Index":0.63,"Average Winter Temperature":25.908457,"Average Summer Temperature":26.127356,"Population":215313498,"Energy Per Capita":17299.75,"% of Power from Fossil Fuels":10.924,"% of Power from Nuclear":2.135,"% of Power from Renewables":86.94,"% of Agricultural Land":28.6390944636,"% of Forest Land":59.2705274977,"Territory":8358140,"Average Rainfall":1761,"Corruption":0.1599350423,"Wheat Production (tonnes)":19888224,"Rye Production (tonnes)":5533432,"Potatoes Production (tonnes)":166772,"Meat, chicken Production (tonnes)":1593.62,"Avocados Production (tonnes)":43200,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":2984000,"CO2 Emissions (ton per capita)":2.057810839},{"Country":"Slovakia","Country_clean":"slovakia","Region":"Central and Eastern Europe","Happiness":6.257,"Median Salary":2114.16,"Average Salary":2315.01,"Lowest Salary":581.4,"Highest Salary":10295.98,"Infant Survival Rate":1000,"Alcohol Consumption Rate":10.6,"Life Expectancy":76.7,"Netflix (USD/month)":11.29,"Women Safety Index":0.856,"Average Winter Temperature":-0.32777002,"Average Summer Temperature":0.70984817,"Population":5643453,"Energy Per Capita":33887.691,"% of Power from Fossil Fuels":17.845,"% of Power from Nuclear":59.484,"% of Power from Renewables":22.671,"% of Agricultural Land":38.6023294509,"% of Forest Land":40.056156406,"Territory":48080,"Average Rainfall":824,"Corruption":0.1467373222,"Wheat Production (tonnes)":46043401.6,"Rye Production (tonnes)":3904665.32,"Potatoes Production (tonnes)":13240782,"Meat, chicken Production (tonnes)":360,"Avocados Production (tonnes)":102320.138,"Petrol Price (USD/liter)":1.98,"Daily Oil Consumption (Barrels)":81587,"CO2 Emissions (ton per capita)":5.698416255},{"Country":"Latvia","Country_clean":"latvia","Region":"Central and Eastern Europe","Happiness":6.234,"Median Salary":1654.0727,"Average Salary":1952.1038,"Lowest Salary":491.75135,"Highest Salary":8657.804,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":11.29,"Women Safety Index":0.872,"Average Winter Temperature":-5.6515737,"Average Summer Temperature":1.3988863,"Population":1850651,"Energy Per Capita":21435.611,"% of Power from Fossil Fuels":27.866,"% of Power from Nuclear":0,"% of Power from Renewables":72.134,"% of Agricultural Land":31.6567571911,"% of Forest Land":54.871605335,"Territory":62230,"Average Rainfall":667,"Corruption":0.1467373222,"Wheat Production (tonnes)":68948700,"Rye Production (tonnes)":896889.36,"Potatoes Production (tonnes)":8375542,"Meat, chicken Production (tonnes)":122411.04,"Avocados Production (tonnes)":212977,"Petrol Price (USD/liter)":2.19,"Daily Oil Consumption (Barrels)":37694,"CO2 Emissions (ton per capita)":3.955435862},{"Country":"Uzbekistan","Country_clean":"uzbekistan","Region":"Commonwealth of Independent States","Happiness":6.195,"Median Salary":97.25,"Average Salary":106.98,"Lowest Salary":27.07,"Highest Salary":477.35,"Infant Survival Rate":985,"Alcohol Consumption Rate":0.01,"Life Expectancy":69.4,"Netflix (USD/month)":null,"Women Safety Index":0.674,"Average Winter Temperature":-1.1172104,"Average Summer Temperature":0.41523957,"Population":34627652,"Energy Per Capita":16929.814,"% of Power from Fossil Fuels":91.537,"% of Power from Nuclear":0,"% of Power from Renewables":7.744,"% of Agricultural Land":58.3012029874,"% of Forest Land":8.4318046172,"Territory":440653,"Average Rainfall":206,"Corruption":0.1534096003,"Wheat Production (tonnes)":12797144.4,"Rye Production (tonnes)":56359,"Potatoes Production (tonnes)":4772327.2,"Meat, chicken Production (tonnes)":3600,"Avocados Production (tonnes)":11471,"Petrol Price (USD/liter)":0.9,"Daily Oil Consumption (Barrels)":49000,"CO2 Emissions (ton per capita)":3.47554445},{"Country":"Argentina","Country_clean":"argentina","Region":"Latin America and Caribbean","Happiness":6.188,"Median Salary":110.28,"Average Salary":129.42,"Lowest Salary":32.57,"Highest Salary":577.13,"Infant Survival Rate":992,"Alcohol Consumption Rate":7.93,"Life Expectancy":76.3,"Netflix (USD/month)":6.3,"Women Safety Index":0.768,"Average Winter Temperature":20.045332,"Average Summer Temperature":22.75778,"Population":45510318,"Energy Per Capita":21994.422,"% of Power from Fossil Fuels":63.374,"% of Power from Nuclear":5.199,"% of Power from Renewables":31.426,"% of Agricultural Land":43.1023461554,"% of Forest Land":10.4007639521,"Territory":2736690,"Average Rainfall":591,"Corruption":0.1599350423,"Wheat Production (tonnes)":188681200,"Rye Production (tonnes)":283601,"Potatoes Production (tonnes)":52048230,"Meat, chicken Production (tonnes)":2055000,"Avocados Production (tonnes)":2040,"Petrol Price (USD/liter)":1.05,"Daily Oil Consumption (Barrels)":709000,"CO2 Emissions (ton per capita)":3.740650291},{"Country":"Kazakhstan","Country_clean":"kazakhstan","Region":"Commonwealth of Independent States","Happiness":6.188,"Median Salary":701,"Average Salary":813.99,"Lowest Salary":204.86,"Highest Salary":3620.08,"Infant Survival Rate":996,"Alcohol Consumption Rate":6.29,"Life Expectancy":72,"Netflix (USD/month)":null,"Women Safety Index":0.729,"Average Winter Temperature":-9.164996,"Average Summer Temperature":-7.0029874,"Population":19397998,"Energy Per Capita":44701.98,"% of Power from Fossil Fuels":88.659,"% of Power from Nuclear":0,"% of Power from Renewables":11.341,"% of Agricultural Land":79.1924658295,"% of Forest Land":1.2904838315,"Territory":2699700,"Average Rainfall":250,"Corruption":0.1555387676,"Wheat Production (tonnes)":100,"Rye Production (tonnes)":230580.8,"Potatoes Production (tonnes)":275000,"Meat, chicken Production (tonnes)":2736,"Avocados Production (tonnes)":72.65,"Petrol Price (USD/liter)":0.48,"Daily Oil Consumption (Barrels)":325000,"CO2 Emissions (ton per capita)":11.45693783},{"Country":"Cyprus","Country_clean":"cyprus","Region":"Western Europe","Happiness":6.068,"Median Salary":1976.74,"Average Salary":2293.87,"Lowest Salary":581.4,"Highest Salary":10211.42,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":85,"Netflix (USD/month)":null,"Women Safety Index":0.739,"Average Winter Temperature":13.245076,"Average Summer Temperature":13.512097,"Population":1251488,"Energy Per Capita":25359.791,"% of Power from Fossil Fuels":83.08,"% of Power from Nuclear":0,"% of Power from Renewables":16.92,"% of Agricultural Land":13.3262878788,"% of Forest Land":18.6699134199,"Territory":9240,"Average Rainfall":498,"Corruption":0.1622093022,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.86,"Daily Oil Consumption (Barrels)":52000,"CO2 Emissions (ton per capita)":5.998795283},{"Country":"Japan","Country_clean":"japan","Region":"East Asia","Happiness":6.06,"Median Salary":3158.67,"Average Salary":3453.12,"Lowest Salary":869.97,"Highest Salary":15391.82,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":83.7,"Netflix (USD/month)":13.13,"Women Safety Index":0.866,"Average Winter Temperature":2.164464,"Average Summer Temperature":2.298908,"Population":123951692,"Energy Per Capita":39984.914,"% of Power from Fossil Fuels":71.011,"% of Power from Nuclear":5.357,"% of Power from Renewables":23.631,"% of Agricultural Land":12.7818930041,"% of Forest Land":68.4087791495,"Territory":364500,"Average Rainfall":1668,"Corruption":0.1614369303,"Wheat Production (tonnes)":38159276,"Rye Production (tonnes)":460847.088,"Potatoes Production (tonnes)":3573873,"Meat, chicken Production (tonnes)":117500,"Avocados Production (tonnes)":92936,"Petrol Price (USD/liter)":1.24,"Daily Oil Consumption (Barrels)":4012877,"CO2 Emissions (ton per capita)":8.540980205},{"Country":"South Korea","Country_clean":"korea republic of","Region":"East Asia","Happiness":6.058,"Median Salary":2593.42,"Average Salary":2889.81,"Lowest Salary":728.38,"Highest Salary":12893,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":82.3,"Netflix (USD/month)":11.47,"Women Safety Index":0.848,"Average Winter Temperature":0.54568756,"Average Summer Temperature":1.3578094,"Population":51815810,"Energy Per Capita":68126.188,"% of Power from Fossil Fuels":62.993,"% of Power from Nuclear":27.795,"% of Power from Renewables":9.212,"% of Agricultural Land":16.4241803279,"% of Forest Land":64.3135245902,"Territory":97600,"Average Rainfall":1274,"Corruption":0.1531555355,"Wheat Production (tonnes)":2114998.2,"Rye Production (tonnes)":1300000,"Potatoes Production (tonnes)":715276,"Meat, chicken Production (tonnes)":87928,"Avocados Production (tonnes)":8759.354,"Petrol Price (USD/liter)":1.61,"Daily Oil Consumption (Barrels)":2605440,"CO2 Emissions (ton per capita)":11.79932538},{"Country":"Philippines","Country_clean":"philippines","Region":"Southeast Asia","Happiness":6.048,"Median Salary":728.78,"Average Salary":790.54,"Lowest Salary":199.4,"Highest Salary":3511.56,"Infant Survival Rate":948,"Alcohol Consumption Rate":4.52,"Life Expectancy":68.5,"Netflix (USD/month)":9.14,"Women Safety Index":0.612,"Average Winter Temperature":25.283766,"Average Summer Temperature":25.835867,"Population":115559009,"Energy Per Capita":5066.786,"% of Power from Fossil Fuels":77.417,"% of Power from Nuclear":0,"% of Power from Renewables":22.583,"% of Agricultural Land":42.536137103,"% of Forest Land":24.2260455445,"Territory":298170,"Average Rainfall":2348,"Corruption":0.1470372379,"Wheat Production (tonnes)":111872930,"Rye Production (tonnes)":14215792.8,"Potatoes Production (tonnes)":224700,"Meat, chicken Production (tonnes)":5260,"Avocados Production (tonnes)":161127.4,"Petrol Price (USD/liter)":1.55,"Daily Oil Consumption (Barrels)":429000,"CO2 Emissions (ton per capita)":1.345029057},{"Country":"Vietnam","Country_clean":"vietnam","Region":"Southeast Asia","Happiness":6.043,"Median Salary":612.57,"Average Salary":711.24,"Lowest Salary":179.25,"Highest Salary":3161.52,"Infant Survival Rate":972,"Alcohol Consumption Rate":4.09,"Life Expectancy":76,"Netflix (USD/month)":null,"Women Safety Index":0.707,"Average Winter Temperature":20.113937,"Average Summer Temperature":20.465149,"Population":98186856,"Energy Per Capita":12983.017,"% of Power from Fossil Fuels":48.449,"% of Power from Nuclear":0,"% of Power from Renewables":51.551,"% of Agricultural Land":39.4347683207,"% of Forest Land":46.961161858,"Territory":313429,"Average Rainfall":1821,"Corruption":0.1536959112,"Wheat Production (tonnes)":126369.276,"Rye Production (tonnes)":65741.052,"Potatoes Production (tonnes)":1658756.2,"Meat, chicken Production (tonnes)":18293614,"Avocados Production (tonnes)":77631.608,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":478000,"CO2 Emissions (ton per capita)":3.488312636},{"Country":"Portugal","Country_clean":"portugal","Region":"Western Europe","Happiness":6.03,"Median Salary":2537,"Average Salary":2917.55,"Lowest Salary":739.96,"Highest Salary":13002.11,"Infant Survival Rate":1000,"Alcohol Consumption Rate":9.88,"Life Expectancy":81.1,"Netflix (USD/month)":13.54,"Women Safety Index":0.877,"Average Winter Temperature":9.626703,"Average Summer Temperature":10.976666,"Population":10270865,"Energy Per Capita":25094.396,"% of Power from Fossil Fuels":40.183,"% of Power from Nuclear":0,"% of Power from Renewables":59.817,"% of Agricultural Land":43.2538567511,"% of Forest Land":36.1549948911,"Territory":91605.6,"Average Rainfall":854,"Corruption":0.1622093022,"Wheat Production (tonnes)":947400,"Rye Production (tonnes)":3710.18,"Potatoes Production (tonnes)":10200,"Meat, chicken Production (tonnes)":3760,"Avocados Production (tonnes)":125446.8,"Petrol Price (USD/liter)":2.26,"Daily Oil Consumption (Barrels)":236866,"CO2 Emissions (ton per capita)":4.339768426},{"Country":"Hungary","Country_clean":"hungary","Region":"Central and Eastern Europe","Happiness":6.017,"Median Salary":1227.46,"Average Salary":1344.23,"Lowest Salary":339.45,"Highest Salary":5974.36,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":75.8,"Netflix (USD/month)":10.71,"Women Safety Index":0.835,"Average Winter Temperature":1.4500087,"Average Summer Temperature":2.1213894,"Population":9967308,"Energy Per Capita":26660.49,"% of Power from Fossil Fuels":34.178,"% of Power from Nuclear":44.623,"% of Power from Renewables":21.199,"% of Agricultural Land":55.2672430419,"% of Forest Land":22.4803495507,"Territory":91260,"Average Rainfall":589,"Corruption":0.1467373222,"Wheat Production (tonnes)":18287,"Rye Production (tonnes)":240000,"Potatoes Production (tonnes)":13775,"Meat, chicken Production (tonnes)":5795,"Avocados Production (tonnes)":230332,"Petrol Price (USD/liter)":2.01,"Daily Oil Consumption (Barrels)":155544,"CO2 Emissions (ton per capita)":4.74663103},{"Country":"Paraguay","Country_clean":"paraguay","Region":"Latin America and Caribbean","Happiness":5.977,"Median Salary":1019.69,"Average Salary":1126.17,"Lowest Salary":283.93,"Highest Salary":5009.74,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":74,"Netflix (USD/month)":11.49,"Women Safety Index":0.691,"Average Winter Temperature":26.823614,"Average Summer Temperature":29.723492,"Population":6780744,"Energy Per Capita":15782.273,"% of Power from Fossil Fuels":0.175,"% of Power from Nuclear":0,"% of Power from Renewables":99.825,"% of Agricultural Land":42.3084319154,"% of Forest Land":39.8261432167,"Territory":397300,"Average Rainfall":1130,"Corruption":0.1677868664,"Wheat Production (tonnes)":3974000,"Rye Production (tonnes)":597306.826,"Potatoes Production (tonnes)":5600,"Meat, chicken Production (tonnes)":83300,"Avocados Production (tonnes)":3820.012,"Petrol Price (USD/liter)":1.4,"Daily Oil Consumption (Barrels)":51000,"CO2 Emissions (ton per capita)":1.165425232},{"Country":"Thailand","Country_clean":"thailand","Region":"Southeast Asia","Happiness":5.976,"Median Salary":2432.28,"Average Salary":2662.11,"Lowest Salary":670.31,"Highest Salary":11846.79,"Infant Survival Rate":992,"Alcohol Consumption Rate":6.41,"Life Expectancy":74.9,"Netflix (USD/month)":10.43,"Women Safety Index":0.764,"Average Winter Temperature":23.979416,"Average Summer Temperature":24.891027,"Population":71697030,"Energy Per Capita":19616.777,"% of Power from Fossil Fuels":84.744,"% of Power from Nuclear":0,"% of Power from Renewables":15.256,"% of Agricultural Land":45.9981600736,"% of Forest Land":38.8283192077,"Territory":510890,"Average Rainfall":1622,"Corruption":0.1531555355,"Wheat Production (tonnes)":2133386,"Rye Production (tonnes)":416000,"Potatoes Production (tonnes)":190964,"Meat, chicken Production (tonnes)":416,"Avocados Production (tonnes)":266926.338,"Petrol Price (USD/liter)":1.51,"Daily Oil Consumption (Barrels)":1302000,"CO2 Emissions (ton per capita)":3.836090019},{"Country":"Malaysia","Country_clean":"malaysia","Region":"Southeast Asia","Happiness":5.975,"Median Salary":1236.17,"Average Salary":1406.38,"Lowest Salary":355.32,"Highest Salary":6255.32,"Infant Survival Rate":996,"Alcohol Consumption Rate":0.52,"Life Expectancy":75,"Netflix (USD/month)":10.65,"Women Safety Index":0.738,"Average Winter Temperature":25.763824,"Average Summer Temperature":25.89396,"Population":33938221,"Energy Per Capita":39586.996,"% of Power from Fossil Fuels":80.96,"% of Power from Nuclear":0,"% of Power from Renewables":19.04,"% of Agricultural Land":26.0873535231,"% of Forest Land":58.0243189773,"Territory":328550,"Average Rainfall":2875,"Corruption":0.1531555355,"Wheat Production (tonnes)":58253,"Rye Production (tonnes)":127405.114,"Potatoes Production (tonnes)":10200,"Meat, chicken Production (tonnes)":1556741.9,"Avocados Production (tonnes)":84517.6,"Petrol Price (USD/liter)":0.46,"Daily Oil Consumption (Barrels)":708000,"CO2 Emissions (ton per capita)":7.927126037},{"Country":"China","Country_clean":"china","Region":"East Asia","Happiness":5.973,"Median Salary":3684.93,"Average Salary":4027.4,"Lowest Salary":1015.07,"Highest Salary":17945.21,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":55.4626494294,"% of Forest Land":23.6315282679,"Territory":9388210,"Average Rainfall":645,"Corruption":0.1543876231,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Honduras","Country_clean":"honduras","Region":"Latin America and Caribbean","Happiness":5.968,"Median Salary":1022.22,"Average Salary":1139.39,"Lowest Salary":287.27,"Highest Salary":5090.91,"Infant Survival Rate":997,"Alcohol Consumption Rate":2.87,"Life Expectancy":74.6,"Netflix (USD/month)":10.99,"Women Safety Index":0.61,"Average Winter Temperature":22.25614,"Average Summer Temperature":23.138378,"Population":10432860,"Energy Per Capita":5086.934,"% of Power from Fossil Fuels":48.037,"% of Power from Nuclear":0,"% of Power from Renewables":51.963,"% of Agricultural Land":31.9599606757,"% of Forest Land":56.6476896952,"Territory":111890,"Average Rainfall":1976,"Corruption":0.1517658681,"Wheat Production (tonnes)":2455774,"Rye Production (tonnes)":3800,"Potatoes Production (tonnes)":2055233,"Meat, chicken Production (tonnes)":710,"Avocados Production (tonnes)":12.8,"Petrol Price (USD/liter)":1.45,"Daily Oil Consumption (Barrels)":58000,"CO2 Emissions (ton per capita)":1.048622992},{"Country":"Bahrain","Country_clean":"bahrain","Region":"Middle East and North Africa","Happiness":5.959,"Median Salary":3617.02,"Average Salary":3936.17,"Lowest Salary":984.04,"Highest Salary":17553.19,"Infant Survival Rate":1000,"Alcohol Consumption Rate":1.57,"Life Expectancy":76.9,"Netflix (USD/month)":null,"Women Safety Index":0.752,"Average Winter Temperature":18.957916,"Average Summer Temperature":19.866425,"Population":1472233,"Energy Per Capita":161111.203,"% of Power from Fossil Fuels":99.969,"% of Power from Nuclear":0,"% of Power from Renewables":0.031,"% of Agricultural Land":10.253164557,"% of Forest Land":0.9113924051,"Territory":790,"Average Rainfall":83,"Corruption":0.1871376336,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":0.53,"Daily Oil Consumption (Barrels)":62000,"CO2 Emissions (ton per capita)":20.26610279},{"Country":"Croatia","Country_clean":"croatia","Region":"Central and Eastern Europe","Happiness":5.942,"Median Salary":1935.48,"Average Salary":2089.76,"Lowest Salary":527.35,"Highest Salary":9298.74,"Infant Survival Rate":1000,"Alcohol Consumption Rate":12.14,"Life Expectancy":78,"Netflix (USD/month)":11.29,"Women Safety Index":0.862,"Average Winter Temperature":3.5226943,"Average Summer Temperature":3.6475925,"Population":4030358,"Energy Per Capita":23468.168,"% of Power from Fossil Fuels":36.686,"% of Power from Nuclear":0,"% of Power from Renewables":63.314,"% of Agricultural Land":26.3759828449,"% of Forest Land":34.6963902788,"Territory":55960,"Average Rainfall":1113,"Corruption":0.1467373222,"Wheat Production (tonnes)":73391864,"Rye Production (tonnes)":60000,"Potatoes Production (tonnes)":122.62,"Meat, chicken Production (tonnes)":36,"Avocados Production (tonnes)":47000,"Petrol Price (USD/liter)":1.91,"Daily Oil Consumption (Barrels)":69000,"CO2 Emissions (ton per capita)":4.063707833},{"Country":"Greece","Country_clean":"greece","Region":"Western Europe","Happiness":5.934,"Median Salary":2241.01,"Average Salary":2579.28,"Lowest Salary":655.39,"Highest Salary":11522.2,"Infant Survival Rate":1000,"Alcohol Consumption Rate":7.53,"Life Expectancy":81,"Netflix (USD/month)":12.42,"Women Safety Index":0.766,"Average Winter Temperature":7.6042023,"Average Summer Temperature":8.659867,"Population":10384971,"Energy Per Capita":30410.344,"% of Power from Fossil Fuels":56.693,"% of Power from Nuclear":0,"% of Power from Renewables":43.307,"% of Agricultural Land":45.5173622964,"% of Forest Land":30.2699767261,"Territory":128900,"Average Rainfall":652,"Corruption":0.1622093022,"Wheat Production (tonnes)":4317391,"Rye Production (tonnes)":366200,"Potatoes Production (tonnes)":1512428,"Meat, chicken Production (tonnes)":1049150,"Avocados Production (tonnes)":77556,"Petrol Price (USD/liter)":2.51,"Daily Oil Consumption (Barrels)":296101,"CO2 Emissions (ton per capita)":5.59618907},{"Country":"Bosnia and Herzegovina","Country_clean":"bosnia and herzegovina","Region":"Central and Eastern Europe","Happiness":5.877,"Median Salary":1151.35,"Average Salary":1248.65,"Lowest Salary":313.51,"Highest Salary":5567.57,"Infant Survival Rate":1000,"Alcohol Consumption Rate":4.03,"Life Expectancy":77.4,"Netflix (USD/month)":null,"Women Safety Index":0.754,"Average Winter Temperature":2.2383707,"Average Summer Temperature":2.2406917,"Population":3233526,"Energy Per Capita":23013.498,"% of Power from Fossil Fuels":62.131,"% of Power from Nuclear":0,"% of Power from Renewables":37.869,"% of Agricultural Land":44.19921875,"% of Forest Land":42.7326171875,"Territory":51200,"Average Rainfall":1028,"Corruption":0.1741266698,"Wheat Production (tonnes)":9024254,"Rye Production (tonnes)":771700,"Potatoes Production (tonnes)":81498,"Meat, chicken Production (tonnes)":20326,"Avocados Production (tonnes)":8525.45,"Petrol Price (USD/liter)":1.73,"Daily Oil Consumption (Barrels)":35000,"CO2 Emissions (ton per capita)":6.382918043},{"Country":"Libya","Country_clean":"libya","Region":"Middle East and North Africa","Happiness":5.866,"Median Salary":417.18,"Average Salary":470.35,"Lowest Salary":118.61,"Highest Salary":2085.89,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":72.7,"Netflix (USD/month)":null,"Women Safety Index":0.61,"Average Winter Temperature":13.038244,"Average Summer Temperature":13.510715,"Population":6812341,"Energy Per Capita":28270.334,"% of Power from Fossil Fuels":99.969,"% of Power from Nuclear":0,"% of Power from Renewables":0.031,"% of Agricultural Land":8.7238710117,"% of Forest Land":0.1233276879,"Territory":1759540,"Average Rainfall":56,"Corruption":0.2036707252,"Wheat Production (tonnes)":85250690,"Rye Production (tonnes)":960041.848,"Potatoes Production (tonnes)":124532,"Meat, chicken Production (tonnes)":125192,"Avocados Production (tonnes)":1306.12,"Petrol Price (USD/liter)":0.03,"Daily Oil Consumption (Barrels)":223000,"CO2 Emissions (ton per capita)":8.380729344},{"Country":"Jamaica","Country_clean":"jamaica","Region":"Latin America and Caribbean","Happiness":5.842,"Median Salary":565.78,"Average Salary":624.56,"Lowest Salary":157.59,"Highest Salary":2777.24,"Infant Survival Rate":999,"Alcohol Consumption Rate":3.83,"Life Expectancy":76.2,"Netflix (USD/month)":null,"Women Safety Index":0.71,"Average Winter Temperature":25.523024,"Average Summer Temperature":25.65008,"Population":2827377,"Energy Per Capita":12235.784,"% of Power from Fossil Fuels":83.908,"% of Power from Nuclear":0,"% of Power from Renewables":16.092,"% of Agricultural Land":38.5041551247,"% of Forest Land":55.4730655586,"Territory":10830,"Average Rainfall":2051,"Corruption":0.1735760421,"Wheat Production (tonnes)":1012930,"Rye Production (tonnes)":878583,"Potatoes Production (tonnes)":29460,"Meat, chicken Production (tonnes)":26500,"Avocados Production (tonnes)":95729.19,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":54000,"CO2 Emissions (ton per capita)":2.845730012},{"Country":"Peru","Country_clean":"peru","Region":"Latin America and Caribbean","Happiness":5.841,"Median Salary":1825.86,"Average Salary":1997.36,"Lowest Salary":503.96,"Highest Salary":8891.82,"Infant Survival Rate":992,"Alcohol Consumption Rate":0.01,"Life Expectancy":75.5,"Netflix (USD/month)":8.56,"Women Safety Index":0.717,"Average Winter Temperature":20.036163,"Average Summer Temperature":20.772074,"Population":34049588,"Energy Per Capita":9835.475,"% of Power from Fossil Fuels":44.915,"% of Power from Nuclear":0,"% of Power from Renewables":55.085,"% of Agricultural Land":19.9341320313,"% of Forest Land":56.3730728906,"Territory":1280000,"Average Rainfall":1738,"Corruption":0.1599350423,"Wheat Production (tonnes)":29718000,"Rye Production (tonnes)":586828.8,"Potatoes Production (tonnes)":3289722,"Meat, chicken Production (tonnes)":130,"Avocados Production (tonnes)":83822.8,"Petrol Price (USD/liter)":1.65,"Daily Oil Consumption (Barrels)":246000,"CO2 Emissions (ton per capita)":1.745591927},{"Country":"Dominican Republic","Country_clean":"dominican republic","Region":"Latin America and Caribbean","Happiness":5.823,"Median Salary":318.89,"Average Salary":350.6,"Lowest Salary":88.62,"Highest Salary":1562.72,"Infant Survival Rate":994,"Alcohol Consumption Rate":5.92,"Life Expectancy":73.9,"Netflix (USD/month)":null,"Women Safety Index":0.666,"Average Winter Temperature":23.858599,"Average Summer Temperature":23.987373,"Population":11228821,"Energy Per Capita":9987.583,"% of Power from Fossil Fuels":83.059,"% of Power from Nuclear":0,"% of Power from Renewables":16.941,"% of Agricultural Land":51.1034903537,"% of Forest Land":45.2797121878,"Territory":47531,"Average Rainfall":1410,"Corruption":0.1670125574,"Wheat Production (tonnes)":32079,"Rye Production (tonnes)":1143319,"Potatoes Production (tonnes)":422589.44,"Meat, chicken Production (tonnes)":5300,"Avocados Production (tonnes)":70948,"Petrol Price (USD/liter)":1.41,"Daily Oil Consumption (Barrels)":133000,"CO2 Emissions (ton per capita)":2.535627952},{"Country":"Mauritius","Country_clean":"mauritius","Region":"Sub-Saharan Africa","Happiness":5.816,"Median Salary":901.53,"Average Salary":1047.66,"Lowest Salary":263.04,"Highest Salary":4653.78,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":74.6,"Netflix (USD/month)":null,"Women Safety Index":0.678,"Average Winter Temperature":25.453356,"Average Summer Temperature":26.709538,"Population":1299469,"Energy Per Capita":19724.719,"% of Power from Fossil Fuels":79.167,"% of Power from Nuclear":0,"% of Power from Renewables":20.833,"% of Agricultural Land":43.0645968953,"% of Forest Land":19.4341512268,"Territory":1997,"Average Rainfall":2041,"Corruption":0.1810258031,"Wheat Production (tonnes)":201,"Rye Production (tonnes)":590006.12,"Potatoes Production (tonnes)":465598.97,"Meat, chicken Production (tonnes)":1080,"Avocados Production (tonnes)":194246.34,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":28000,"CO2 Emissions (ton per capita)":3.294591006},{"Country":"Moldova","Country_clean":"moldova","Region":"Commonwealth of Independent States","Happiness":5.816,"Median Salary":1318.68,"Average Salary":1467.03,"Lowest Salary":370.33,"Highest Salary":6538.46,"Infant Survival Rate":999,"Alcohol Consumption Rate":9.99,"Life Expectancy":72.1,"Netflix (USD/month)":11.29,"Women Safety Index":0.758,"Average Winter Temperature":-0.58977896,"Average Summer Temperature":2.0659935,"Population":3272996,"Energy Per Capita":16006.373,"% of Power from Fossil Fuels":93.123,"% of Power from Nuclear":0,"% of Power from Renewables":6.877,"% of Agricultural Land":69.0021231423,"% of Forest Land":11.7227782833,"Territory":32970,"Average Rainfall":450,"Corruption":0.1620248556,"Wheat Production (tonnes)":1713061,"Rye Production (tonnes)":277982.8,"Potatoes Production (tonnes)":2263.6,"Meat, chicken Production (tonnes)":474021.6,"Avocados Production (tonnes)":4707.65,"Petrol Price (USD/liter)":1.78,"Daily Oil Consumption (Barrels)":18001,"CO2 Emissions (ton per capita)":3.324610168},{"Country":"Russia","Country_clean":"russian federation","Region":"Commonwealth of Independent States","Happiness":5.785,"Median Salary":975.51,"Average Salary":1065.68,"Lowest Salary":268.47,"Highest Salary":4744.34,"Infant Survival Rate":987,"Alcohol Consumption Rate":10.12,"Life Expectancy":75,"Netflix (USD/month)":10.84,"Women Safety Index":0.752,"Average Winter Temperature":-22.901932,"Average Summer Temperature":-16.512663,"Population":144713314,"Energy Per Capita":55459.422,"% of Power from Fossil Fuels":61.33,"% of Power from Nuclear":20.309,"% of Power from Renewables":18.361,"% of Agricultural Land":13.158436258,"% of Forest Land":49.7843360789,"Territory":16376870,"Average Rainfall":460,"Corruption":0.1620248556,"Wheat Production (tonnes)":38418516,"Rye Production (tonnes)":69628.2,"Potatoes Production (tonnes)":391924.53,"Meat, chicken Production (tonnes)":21388082,"Avocados Production (tonnes)":25469.03,"Petrol Price (USD/liter)":0.9,"Daily Oil Consumption (Barrels)":3631287,"CO2 Emissions (ton per capita)":11.79720293},{"Country":"Bolivia","Country_clean":"bolivia","Region":"Latin America and Caribbean","Happiness":5.784,"Median Salary":1131.5,"Average Salary":1236.99,"Lowest Salary":312.14,"Highest Salary":5505.78,"Infant Survival Rate":992,"Alcohol Consumption Rate":3.62,"Life Expectancy":77,"Netflix (USD/month)":10.99,"Women Safety Index":0.696,"Average Winter Temperature":22.62405,"Average Summer Temperature":23.684843,"Population":12224110,"Energy Per Capita":7062.148,"% of Power from Fossil Fuels":60.692,"% of Power from Nuclear":0,"% of Power from Renewables":39.308,"% of Agricultural Land":35.1881908982,"% of Forest Land":46.7283054556,"Territory":1083300,"Average Rainfall":1146,"Corruption":0.1598362178,"Wheat Production (tonnes)":631.08,"Rye Production (tonnes)":564675,"Potatoes Production (tonnes)":261690,"Meat, chicken Production (tonnes)":1208,"Avocados Production (tonnes)":35000,"Petrol Price (USD/liter)":0.54,"Daily Oil Consumption (Barrels)":90000,"CO2 Emissions (ton per capita)":1.940398005},{"Country":"Ecuador","Country_clean":"ecuador","Region":"Latin America and Caribbean","Happiness":5.725,"Median Salary":1260,"Average Salary":1370,"Lowest Salary":340,"Highest Salary":6080,"Infant Survival Rate":994,"Alcohol Consumption Rate":3.82,"Life Expectancy":76.2,"Netflix (USD/month)":10.99,"Women Safety Index":0.655,"Average Winter Temperature":21.600014,"Average Summer Temperature":22.433525,"Population":18001000,"Energy Per Capita":12150.252,"% of Power from Fossil Fuels":24.275,"% of Power from Nuclear":0,"% of Power from Renewables":75.725,"% of Agricultural Land":22.0244805927,"% of Forest Land":50.0626509905,"Territory":248360,"Average Rainfall":2274,"Corruption":0.1677868664,"Wheat Production (tonnes)":2754740,"Rye Production (tonnes)":4000,"Potatoes Production (tonnes)":376000,"Meat, chicken Production (tonnes)":118350,"Avocados Production (tonnes)":163323,"Petrol Price (USD/liter)":1.17,"Daily Oil Consumption (Barrels)":259000,"CO2 Emissions (ton per capita)":2.261469817},{"Country":"Kyrgyzstan","Country_clean":"kyrgyzstan","Region":"Commonwealth of Independent States","Happiness":5.714,"Median Salary":201.87,"Average Salary":219.92,"Lowest Salary":55.6,"Highest Salary":980.04,"Infant Survival Rate":997,"Alcohol Consumption Rate":0.01,"Life Expectancy":71.1,"Netflix (USD/month)":null,"Women Safety Index":0.673,"Average Winter Temperature":-12.751518,"Average Summer Temperature":-8.788135,"Population":6630623,"Energy Per Capita":9274.61,"% of Power from Fossil Fuels":10.097,"% of Power from Nuclear":0,"% of Power from Renewables":89.903,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":8330,"Rye Production (tonnes)":260323.2,"Potatoes Production (tonnes)":1791600,"Meat, chicken Production (tonnes)":3175853,"Avocados Production (tonnes)":429912,"Petrol Price (USD/liter)":0.83,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":null},{"Country":"Montenegro","Country_clean":"montenegro","Region":"Central and Eastern Europe","Happiness":5.707,"Median Salary":2621.56,"Average Salary":2832.98,"Lowest Salary":718.82,"Highest Salary":12579.28,"Infant Survival Rate":1000,"Alcohol Consumption Rate":0.01,"Life Expectancy":76.1,"Netflix (USD/month)":null,"Women Safety Index":0.808,"Average Winter Temperature":1.7943455,"Average Summer Temperature":2.1861253,"Population":627082,"Energy Per Capita":18940.291,"% of Power from Fossil Fuels":47.678,"% of Power from Nuclear":0,"% of Power from Renewables":52.322,"% of Agricultural Land":19.0007434944,"% of Forest Land":61.4869888476,"Territory":13450,"Average Rainfall":null,"Corruption":0.1997847706,"Wheat Production (tonnes)":1275302,"Rye Production (tonnes)":3805260,"Potatoes Production (tonnes)":248321,"Meat, chicken Production (tonnes)":789921.3,"Avocados Production (tonnes)":330240.25,"Petrol Price (USD/liter)":1.71,"Daily Oil Consumption (Barrels)":7000,"CO2 Emissions (ton per capita)":4.179875994},{"Country":"Mongolia","Country_clean":"mongolia","Region":"East Asia","Happiness":5.696,"Median Salary":515.76,"Average Salary":564.74,"Lowest Salary":142.34,"Highest Salary":2509.62,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":68.8,"Netflix (USD/month)":null,"Women Safety Index":0.794,"Average Winter Temperature":-18.015043,"Average Summer Temperature":-16.466763,"Population":3398366,"Energy Per Capita":22407.674,"% of Power from Fossil Fuels":91.197,"% of Power from Nuclear":0,"% of Power from Renewables":8.803,"% of Agricultural Land":72.3150521956,"% of Forest Land":9.0989446596,"Territory":1557507,"Average Rainfall":241,"Corruption":0.1558940709,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.23,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":7.153120086},{"Country":"Colombia","Country_clean":"colombia","Region":"Latin America and Caribbean","Happiness":5.695,"Median Salary":995.6,"Average Salary":1157.85,"Lowest Salary":292.53,"Highest Salary":5137.79,"Infant Survival Rate":990,"Alcohol Consumption Rate":4.38,"Life Expectancy":74.8,"Netflix (USD/month)":6.86,"Women Safety Index":0.582,"Average Winter Temperature":24.625221,"Average Summer Temperature":25.879896,"Population":51874024,"Energy Per Capita":11746.604,"% of Power from Fossil Fuels":24.503,"% of Power from Nuclear":0,"% of Power from Renewables":75.497,"% of Agricultural Land":38.5020279405,"% of Forest Land":53.125395854,"Territory":1109500,"Average Rainfall":3240,"Corruption":0.1599350423,"Wheat Production (tonnes)":144885,"Rye Production (tonnes)":168,"Potatoes Production (tonnes)":111760,"Meat, chicken Production (tonnes)":13216000,"Avocados Production (tonnes)":9570,"Petrol Price (USD/liter)":0.6,"Daily Oil Consumption (Barrels)":357000,"CO2 Emissions (ton per capita)":1.609870831},{"Country":"Venezuela","Country_clean":"venezuela","Region":"Latin America and Caribbean","Happiness":5.607,"Median Salary":3282.02,"Average Salary":3862.91,"Lowest Salary":972.99,"Highest Salary":17165.26,"Infant Survival Rate":991,"Alcohol Consumption Rate":6.47,"Life Expectancy":74.1,"Netflix (USD/month)":10.99,"Women Safety Index":0.628,"Average Winter Temperature":26.43019,"Average Summer Temperature":27.094582,"Population":28301696,"Energy Per Capita":21683.146,"% of Power from Fossil Fuels":35.508,"% of Power from Nuclear":0,"% of Power from Renewables":80.468,"% of Agricultural Land":24.3750354288,"% of Forest Land":52.3477807381,"Territory":882050,"Average Rainfall":2044,"Corruption":0.1630260944,"Wheat Production (tonnes)":2600996.2,"Rye Production (tonnes)":33067.614,"Potatoes Production (tonnes)":122987476,"Meat, chicken Production (tonnes)":18293614,"Avocados Production (tonnes)":26527.058,"Petrol Price (USD/liter)":0.02,"Daily Oil Consumption (Barrels)":598000,"CO2 Emissions (ton per capita)":3.939566209},{"Country":"Indonesia","Country_clean":"indonesia","Region":"Southeast Asia","Happiness":5.568,"Median Salary":678.91,"Average Salary":788.83,"Lowest Salary":198.5,"Highest Salary":3504.47,"Infant Survival Rate":886,"Alcohol Consumption Rate":0.09,"Life Expectancy":69.1,"Netflix (USD/month)":10.66,"Women Safety Index":0.7,"Average Winter Temperature":25.869717,"Average Summer Temperature":25.94353,"Population":275501339,"Energy Per Capita":9854.455,"% of Power from Fossil Fuels":80.383,"% of Power from Nuclear":0,"% of Power from Renewables":19.617,"% of Agricultural Land":34.1337419294,"% of Forest Land":48.3619448681,"Territory":1892555.47,"Average Rainfall":2702,"Corruption":0.1470372379,"Wheat Production (tonnes)":209830,"Rye Production (tonnes)":38193584,"Potatoes Production (tonnes)":95170,"Meat, chicken Production (tonnes)":158.9,"Avocados Production (tonnes)":382467,"Petrol Price (USD/liter)":1.18,"Daily Oil Consumption (Barrels)":1623000,"CO2 Emissions (ton per capita)":2.290397148},{"Country":"Bulgaria","Country_clean":"bulgaria","Region":"Central and Eastern Europe","Happiness":5.463,"Median Salary":1605.41,"Average Salary":1794.59,"Lowest Salary":454.05,"Highest Salary":7945.95,"Infant Survival Rate":1000,"Alcohol Consumption Rate":12.03,"Life Expectancy":74.5,"Netflix (USD/month)":11.29,"Women Safety Index":0.826,"Average Winter Temperature":1.7989875,"Average Summer Temperature":3.720064,"Population":6781953,"Energy Per Capita":34175.52,"% of Power from Fossil Fuels":48.754,"% of Power from Nuclear":32.543,"% of Power from Renewables":18.703,"% of Agricultural Land":46.4867096536,"% of Forest Land":35.9801031688,"Territory":108560,"Average Rainfall":608,"Corruption":0.1467373222,"Wheat Production (tonnes)":2800,"Rye Production (tonnes)":79.38,"Potatoes Production (tonnes)":4584500,"Meat, chicken Production (tonnes)":13234959,"Avocados Production (tonnes)":193,"Petrol Price (USD/liter)":1.72,"Daily Oil Consumption (Barrels)":97000,"CO2 Emissions (ton per capita)":5.61085728},{"Country":"Armenia","Country_clean":"armenia","Region":"Commonwealth of Independent States","Happiness":5.455,"Median Salary":1700.25,"Average Salary":1974.32,"Lowest Salary":497.39,"Highest Salary":8780.39,"Infant Survival Rate":999,"Alcohol Consumption Rate":3.91,"Life Expectancy":74.8,"Netflix (USD/month)":null,"Women Safety Index":0.772,"Average Winter Temperature":-2.63862,"Average Summer Temperature":-2.4225743,"Population":2780469,"Energy Per Capita":17684.547,"% of Power from Fossil Fuels":43.443,"% of Power from Nuclear":25.273,"% of Power from Renewables":31.284,"% of Agricultural Land":58.827537759,"% of Forest Land":11.5300316122,"Territory":28470,"Average Rainfall":562,"Corruption":0.1820750087,"Wheat Production (tonnes)":328610800,"Rye Production (tonnes)":188384.1,"Potatoes Production (tonnes)":174471740,"Meat, chicken Production (tonnes)":9700,"Avocados Production (tonnes)":7610,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":6000,"CO2 Emissions (ton per capita)":2.086060678},{"Country":"South Africa","Country_clean":"south africa","Region":"Sub-Saharan Africa","Happiness":5.422,"Median Salary":1441.44,"Average Salary":1658.72,"Lowest Salary":417.59,"Highest Salary":7366.19,"Infant Survival Rate":958,"Alcohol Consumption Rate":7.38,"Life Expectancy":62.9,"Netflix (USD/month)":10.05,"Women Safety Index":0.688,"Average Winter Temperature":23.753565,"Average Summer Temperature":24.343164,"Population":59893885,"Energy Per Capita":22350.898,"% of Power from Fossil Fuels":86.194,"% of Power from Nuclear":4.714,"% of Power from Renewables":9.092,"% of Agricultural Land":79.4178502832,"% of Forest Land":14.0250847011,"Territory":1213090,"Average Rainfall":495,"Corruption":0.1603969038,"Wheat Production (tonnes)":230786548,"Rye Production (tonnes)":310517.2,"Potatoes Production (tonnes)":200506,"Meat, chicken Production (tonnes)":1296,"Avocados Production (tonnes)":2868,"Petrol Price (USD/liter)":1.48,"Daily Oil Consumption (Barrels)":640000,"CO2 Emissions (ton per capita)":7.507736092},{"Country":"North Macedonia","Country_clean":"north macedonia","Region":"Central and Eastern Europe","Happiness":5.369,"Median Salary":677,"Average Salary":794.14,"Lowest Salary":199.83,"Highest Salary":3531.44,"Infant Survival Rate":1000,"Alcohol Consumption Rate":1.13,"Life Expectancy":75.7,"Netflix (USD/month)":null,"Women Safety Index":0.798,"Average Winter Temperature":1.727479,"Average Summer Temperature":2.884718,"Population":2093599,"Energy Per Capita":13874.975,"% of Power from Fossil Fuels":72.818,"% of Power from Nuclear":0,"% of Power from Renewables":27.182,"% of Agricultural Land":49.9603489294,"% of Forest Land":39.7101506741,"Territory":25220,"Average Rainfall":619,"Corruption":0.1741266698,"Wheat Production (tonnes)":1044000,"Rye Production (tonnes)":143862.004,"Potatoes Production (tonnes)":10800,"Meat, chicken Production (tonnes)":63139.8,"Avocados Production (tonnes)":40944.6,"Petrol Price (USD/liter)":1.88,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":3.996737213},{"Country":"Algeria","Country_clean":"algeria","Region":"Middle East and North Africa","Happiness":5.364,"Median Salary":1148.84,"Average Salary":1308.81,"Lowest Salary":330.11,"Highest Salary":5824.18,"Infant Survival Rate":979,"Alcohol Consumption Rate":0.01,"Life Expectancy":75.6,"Netflix (USD/month)":null,"Women Safety Index":0.622,"Average Winter Temperature":13.421954,"Average Summer Temperature":14.559108,"Population":44903225,"Energy Per Capita":15252.127,"% of Power from Fossil Fuels":98.826,"% of Power from Nuclear":0,"% of Power from Renewables":0.839,"% of Agricultural Land":17.3470041453,"% of Forest Land":0.8222276478,"Territory":2381741,"Average Rainfall":89,"Corruption":0.178580597,"Wheat Production (tonnes)":2168386,"Rye Production (tonnes)":135945,"Potatoes Production (tonnes)":4360880,"Meat, chicken Production (tonnes)":257644.62,"Avocados Production (tonnes)":1240356.5,"Petrol Price (USD/liter)":0.31,"Daily Oil Consumption (Barrels)":429000,"CO2 Emissions (ton per capita)":3.977650459},{"Country":"Hong Kong S.A.R. of China","Country_clean":"hong kong sar of china","Region":"East Asia","Happiness":5.316,"Median Salary":3684.93,"Average Salary":4027.4,"Lowest Salary":1015.07,"Highest Salary":17945.21,"Infant Survival Rate":994,"Alcohol Consumption Rate":0.01,"Life Expectancy":76,"Netflix (USD/month)":10,"Women Safety Index":0.7,"Average Winter Temperature":-6.3306623,"Average Summer Temperature":-5.6608214,"Population":1425887337,"Energy Per Capita":31051.48,"% of Power from Fossil Fuels":64.602,"% of Power from Nuclear":4.725,"% of Power from Renewables":30.673,"% of Agricultural Land":3.8095238095,"% of Forest Land":null,"Territory":1050,"Average Rainfall":null,"Corruption":0.1621359587,"Wheat Production (tonnes)":13631,"Rye Production (tonnes)":800,"Potatoes Production (tonnes)":0,"Meat, chicken Production (tonnes)":6155.65,"Avocados Production (tonnes)":88.19,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":12791553,"CO2 Emissions (ton per capita)":7.605936961},{"Country":"Albania","Country_clean":"albania","Region":"Central and Eastern Europe","Happiness":5.304,"Median Salary":832.84,"Average Salary":956.92,"Lowest Salary":241.22,"Highest Salary":4258.49,"Infant Survival Rate":1000,"Alcohol Consumption Rate":4.6,"Life Expectancy":77.8,"Netflix (USD/month)":null,"Women Safety Index":0.796,"Average Winter Temperature":4.993411,"Average Summer Temperature":5.48025,"Population":2842321,"Energy Per Capita":14100.432,"% of Power from Fossil Fuels":0,"% of Power from Nuclear":0,"% of Power from Renewables":100,"% of Agricultural Land":41.4718978102,"% of Forest Land":28.7919708029,"Territory":27400,"Average Rainfall":1485,"Corruption":0.1620248556,"Wheat Production (tonnes)":225170.9,"Rye Production (tonnes)":873343.06,"Potatoes Production (tonnes)":258862,"Meat, chicken Production (tonnes)":13250,"Avocados Production (tonnes)":4173.95,"Petrol Price (USD/liter)":2.11,"Daily Oil Consumption (Barrels)":27000,"CO2 Emissions (ton per capita)":1.69224832},{"Country":"Tajikistan","Country_clean":"tajikistan","Region":"Commonwealth of Independent States","Happiness":5.281,"Median Salary":959.78,"Average Salary":1069.47,"Lowest Salary":269.65,"Highest Salary":4753.2,"Infant Survival Rate":990,"Alcohol Consumption Rate":0.01,"Life Expectancy":69.7,"Netflix (USD/month)":null,"Women Safety Index":0.69,"Average Winter Temperature":-13.769967,"Average Summer Temperature":-9.324993,"Population":9952787,"Energy Per Capita":7674.914,"% of Power from Fossil Fuels":8.768,"% of Power from Nuclear":0,"% of Power from Renewables":91.232,"% of Agricultural Land":35.4276244686,"% of Forest Land":3.0607392463,"Territory":138790,"Average Rainfall":691,"Corruption":0.1768408716,"Wheat Production (tonnes)":10363525.6,"Rye Production (tonnes)":3997,"Potatoes Production (tonnes)":140721600,"Meat, chicken Production (tonnes)":425,"Avocados Production (tonnes)":39040.4,"Petrol Price (USD/liter)":1.57,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":1.010618692},{"Country":"Congo (Brazzaville)","Country_clean":"congo brazzaville","Region":"Sub-Saharan Africa","Happiness":5.221,"Median Salary":1058.67,"Average Salary":1205.3,"Lowest Salary":302.94,"Highest Salary":5365.86,"Infant Survival Rate":993,"Alcohol Consumption Rate":0.01,"Life Expectancy":64.7,"Netflix (USD/month)":null,"Women Safety Index":0.384,"Average Winter Temperature":25.505972,"Average Summer Temperature":26.152718,"Population":99010212,"Energy Per Capita":2348.011,"% of Power from Fossil Fuels":76.119,"% of Power from Nuclear":0,"% of Power from Renewables":23.881,"% of Agricultural Land":31.2679355783,"% of Forest Land":64.2196193265,"Territory":341500,"Average Rainfall":1646,"Corruption":0.158911109,"Wheat Production (tonnes)":916614,"Rye Production (tonnes)":15,"Potatoes Production (tonnes)":32500,"Meat, chicken Production (tonnes)":1478922.8,"Avocados Production (tonnes)":21000,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":17000,"CO2 Emissions (ton per capita)":1.349316017},{"Country":"Mozambique","Country_clean":"mozambique","Region":"Sub-Saharan Africa","Happiness":5.216,"Median Salary":549.81,"Average Salary":631.27,"Lowest Salary":159.77,"Highest Salary":2803.88,"Infant Survival Rate":940,"Alcohol Consumption Rate":0.01,"Life Expectancy":57.6,"Netflix (USD/month)":null,"Women Safety Index":0.58,"Average Winter Temperature":26.116705,"Average Summer Temperature":28.754948,"Population":32969517,"Energy Per Capita":2241.226,"% of Power from Fossil Fuels":18.593,"% of Power from Nuclear":0,"% of Power from Renewables":81.407,"% of Agricultural Land":52.6638927745,"% of Forest Land":46.4121731224,"Territory":786380,"Average Rainfall":1032,"Corruption":0.1515905112,"Wheat Production (tonnes)":960,"Rye Production (tonnes)":240600.52,"Potatoes Production (tonnes)":13900,"Meat, chicken Production (tonnes)":2108.7,"Avocados Production (tonnes)":21020,"Petrol Price (USD/liter)":1.3,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":0.246986412},{"Country":"Georgia","Country_clean":"georgia","Region":"Commonwealth of Independent States","Happiness":5.185,"Median Salary":2309.7,"Average Salary":2526.12,"Lowest Salary":638.06,"Highest Salary":11231.34,"Infant Survival Rate":999,"Alcohol Consumption Rate":6.13,"Life Expectancy":74.4,"Netflix (USD/month)":null,"Women Safety Index":0.812,"Average Winter Temperature":-1.3454458,"Average Summer Temperature":-1.0580338,"Population":3744385,"Energy Per Capita":20834.768,"% of Power from Fossil Fuels":23.806,"% of Power from Nuclear":0,"% of Power from Renewables":76.194,"% of Agricultural Land":34.2480932508,"% of Forest Land":40.6159159591,"Territory":69490,"Average Rainfall":1026,"Corruption":0.1741266698,"Wheat Production (tonnes)":33722,"Rye Production (tonnes)":1400,"Potatoes Production (tonnes)":10000,"Meat, chicken Production (tonnes)":7479107,"Avocados Production (tonnes)":83301.25,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":33000,"CO2 Emissions (ton per capita)":2.717624226},{"Country":"Iraq","Country_clean":"iraq","Region":"Middle East and North Africa","Happiness":5.166,"Median Salary":1382.38,"Average Salary":1573.31,"Lowest Salary":395.62,"Highest Salary":6988.25,"Infant Survival Rate":968,"Alcohol Consumption Rate":0.01,"Life Expectancy":68.9,"Netflix (USD/month)":null,"Women Safety Index":0.424,"Average Winter Temperature":10.920471,"Average Summer Temperature":12.792713,"Population":44496122,"Energy Per Capita":14392.053,"% of Power from Fossil Fuels":94.571,"% of Power from Nuclear":0,"% of Power from Renewables":3.169,"% of Agricultural Land":21.7078833892,"% of Forest Land":1.9003611838,"Territory":434128,"Average Rainfall":216,"Corruption":0.2064384371,"Wheat Production (tonnes)":2000,"Rye Production (tonnes)":36788.4,"Potatoes Production (tonnes)":28,"Meat, chicken Production (tonnes)":2250,"Avocados Production (tonnes)":79661,"Petrol Price (USD/liter)":0.51,"Daily Oil Consumption (Barrels)":857000,"CO2 Emissions (ton per capita)":4.440624129},{"Country":"Nepal","Country_clean":"nepal","Region":"South Asia","Happiness":5.158,"Median Salary":551.13,"Average Salary":608.2,"Lowest Salary":153.18,"Highest Salary":2703.11,"Infant Survival Rate":983,"Alcohol Consumption Rate":0.01,"Life Expectancy":69.2,"Netflix (USD/month)":null,"Women Safety Index":0.644,"Average Winter Temperature":3.4482849,"Average Summer Temperature":6.6038175,"Population":30547580,"Energy Per Capita":1607.635,"% of Power from Fossil Fuels":0,"% of Power from Nuclear":0,"% of Power from Renewables":100,"% of Agricultural Land":28.7478200209,"% of Forest Land":41.5907220091,"Territory":143350,"Average Rainfall":1500,"Corruption":0.1649870872,"Wheat Production (tonnes)":18053568,"Rye Production (tonnes)":1585771.6,"Potatoes Production (tonnes)":867000,"Meat, chicken Production (tonnes)":142000,"Avocados Production (tonnes)":69582.234,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":43000,"CO2 Emissions (ton per capita)":0.470136453},{"Country":"Laos","Country_clean":"laos","Region":"Southeast Asia","Happiness":5.139,"Median Salary":206.42,"Average Salary":223.54,"Lowest Salary":56.25,"Highest Salary":992.99,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.704,"Average Winter Temperature":19.469608,"Average Summer Temperature":20.353256,"Population":7529475,"Energy Per Capita":18847.086,"% of Power from Fossil Fuels":27.045,"% of Power from Nuclear":0,"% of Power from Renewables":72.955,"% of Agricultural Land":null,"% of Forest Land":null,"Territory":null,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":96402500,"Rye Production (tonnes)":177940.2,"Potatoes Production (tonnes)":7540892.5,"Meat, chicken Production (tonnes)":96000,"Avocados Production (tonnes)":0,"Petrol Price (USD/liter)":1.91,"Daily Oil Consumption (Barrels)":18000,"CO2 Emissions (ton per capita)":null},{"Country":"Gabon","Country_clean":"gabon","Region":"Sub-Saharan Africa","Happiness":5.106,"Median Salary":800.85,"Average Salary":894.31,"Lowest Salary":225.59,"Highest Salary":3980.08,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":66,"Netflix (USD/month)":null,"Women Safety Index":0.593,"Average Winter Temperature":25.409601,"Average Summer Temperature":26.325548,"Population":2388992,"Energy Per Capita":8009.644,"% of Power from Fossil Fuels":55.459,"% of Power from Nuclear":0,"% of Power from Renewables":44.541,"% of Agricultural Land":8.3565645981,"% of Forest Land":91.2745760081,"Territory":257670,"Average Rainfall":1831,"Corruption":0.1993061751,"Wheat Production (tonnes)":67690,"Rye Production (tonnes)":9447,"Potatoes Production (tonnes)":32656,"Meat, chicken Production (tonnes)":4519606,"Avocados Production (tonnes)":9710,"Petrol Price (USD/liter)":0.97,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":2.416484011},{"Country":"Ivory Coast","Country_clean":"cote divoire","Region":"Sub-Saharan Africa","Happiness":5.08,"Median Salary":497.91,"Average Salary":544.64,"Lowest Salary":137.45,"Highest Salary":2417.05,"Infant Survival Rate":943,"Alcohol Consumption Rate":0.01,"Life Expectancy":53.3,"Netflix (USD/month)":null,"Women Safety Index":0.573,"Average Winter Temperature":26.548874,"Average Summer Temperature":27.247503,"Population":28160542,"Energy Per Capita":2370.596,"% of Power from Fossil Fuels":69.854,"% of Power from Nuclear":0,"% of Power from Renewables":30.146,"% of Agricultural Land":73.8993710692,"% of Forest Land":8.5654927673,"Territory":318000,"Average Rainfall":1348,"Corruption":0.1473762393,"Wheat Production (tonnes)":195046800,"Rye Production (tonnes)":71873.17,"Potatoes Production (tonnes)":420,"Meat, chicken Production (tonnes)":6563.91,"Avocados Production (tonnes)":53000,"Petrol Price (USD/liter)":1.18,"Daily Oil Consumption (Barrels)":51000,"CO2 Emissions (ton per capita)":0.421129515},{"Country":"Guinea","Country_clean":"guinea","Region":"Sub-Saharan Africa","Happiness":5.023,"Median Salary":696.71,"Average Salary":817.87,"Lowest Salary":206.22,"Highest Salary":3634.99,"Infant Survival Rate":974,"Alcohol Consumption Rate":0.01,"Life Expectancy":59,"Netflix (USD/month)":null,"Women Safety Index":0.539,"Average Winter Temperature":25.573353,"Average Summer Temperature":26.244331,"Population":13859341,"Energy Per Capita":1281.525,"% of Power from Fossil Fuels":27.338,"% of Power from Nuclear":0,"% of Power from Renewables":72.662,"% of Agricultural Land":59.5718704216,"% of Forest Land":25.0244180368,"Territory":245720,"Average Rainfall":1651,"Corruption":0.1515905112,"Wheat Production (tonnes)":407,"Rye Production (tonnes)":295681,"Potatoes Production (tonnes)":1109560,"Meat, chicken Production (tonnes)":351,"Avocados Production (tonnes)":5720,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":19001,"CO2 Emissions (ton per capita)":0.309288541},{"Country":"Turkiye","Country_clean":"turkey","Region":"Middle East and North Africa","Happiness":4.975,"Median Salary":254.1,"Average Salary":286.13,"Lowest Salary":72.08,"Highest Salary":1274.12,"Infant Survival Rate":985,"Alcohol Consumption Rate":1.45,"Life Expectancy":75.8,"Netflix (USD/month)":3,"Women Safety Index":0.665,"Average Winter Temperature":3.0063581,"Average Summer Temperature":3.4250228,"Population":85341241,"Energy Per Capita":22824.15,"% of Power from Fossil Fuels":58.027,"% of Power from Nuclear":0,"% of Power from Renewables":41.973,"% of Agricultural Land":49.4900146824,"% of Forest Land":29.0741785014,"Territory":769630,"Average Rainfall":593,"Corruption":0.1640447378,"Wheat Production (tonnes)":635748.4,"Rye Production (tonnes)":13876344.2,"Potatoes Production (tonnes)":3826904,"Meat, chicken Production (tonnes)":55,"Avocados Production (tonnes)":16151.2,"Petrol Price (USD/liter)":1.6,"Daily Oil Consumption (Barrels)":941861,"CO2 Emissions (ton per capita)":4.75658475},{"Country":"Senegal","Country_clean":"senegal","Region":"Sub-Saharan Africa","Happiness":4.969,"Median Salary":493.08,"Average Salary":565.59,"Lowest Salary":142.77,"Highest Salary":2513.74,"Infant Survival Rate":981,"Alcohol Consumption Rate":0.26,"Life Expectancy":66.7,"Netflix (USD/month)":null,"Women Safety Index":0.619,"Average Winter Temperature":25.55183,"Average Summer Temperature":26.647112,"Population":17316449,"Energy Per Capita":2505.209,"% of Power from Fossil Fuels":80.071,"% of Power from Nuclear":0,"% of Power from Renewables":19.929,"% of Agricultural Land":49.4000934919,"% of Forest Land":41.6982288475,"Territory":192530,"Average Rainfall":686,"Corruption":0.1473762393,"Wheat Production (tonnes)":56920,"Rye Production (tonnes)":13524458.4,"Potatoes Production (tonnes)":879000,"Meat, chicken Production (tonnes)":117856.39,"Avocados Production (tonnes)":113807.792,"Petrol Price (USD/liter)":1.42,"Daily Oil Consumption (Barrels)":49000,"CO2 Emissions (ton per capita)":0.651679184},{"Country":"Iran","Country_clean":"iran","Region":"Middle East and North Africa","Happiness":4.923,"Median Salary":932.63,"Average Salary":1070.97,"Lowest Salary":269.53,"Highest Salary":4770.47,"Infant Survival Rate":982,"Alcohol Consumption Rate":0.01,"Life Expectancy":75.5,"Netflix (USD/month)":null,"Women Safety Index":0.557,"Average Winter Temperature":6.699771,"Average Summer Temperature":9.465016,"Population":88550570,"Energy Per Capita":38133.086,"% of Power from Fossil Fuels":94.081,"% of Power from Nuclear":0.955,"% of Power from Renewables":4.965,"% of Agricultural Land":29.0089368259,"% of Forest Land":6.635211094,"Territory":1622500,"Average Rainfall":228,"Corruption":0.1734505892,"Wheat Production (tonnes)":1562160,"Rye Production (tonnes)":71601,"Potatoes Production (tonnes)":195000,"Meat, chicken Production (tonnes)":2530,"Avocados Production (tonnes)":382467,"Petrol Price (USD/liter)":0.05,"Daily Oil Consumption (Barrels)":1803999,"CO2 Emissions (ton per capita)":7.598364845},{"Country":"Azerbaijan","Country_clean":"azerbaijan","Region":"Commonwealth of Independent States","Happiness":4.893,"Median Salary":1558.82,"Average Salary":1741.18,"Lowest Salary":441.18,"Highest Salary":7764.71,"Infant Survival Rate":995,"Alcohol Consumption Rate":0.01,"Life Expectancy":72.7,"Netflix (USD/month)":null,"Women Safety Index":0.667,"Average Winter Temperature":1.85439,"Average Summer Temperature":3.2257857,"Population":10358074,"Energy Per Capita":18747.918,"% of Power from Fossil Fuels":94.599,"% of Power from Nuclear":0,"% of Power from Renewables":6.343,"% of Agricultural Land":57.8415003025,"% of Forest Land":13.8329909256,"Territory":82650,"Average Rainfall":447,"Corruption":0.1841555238,"Wheat Production (tonnes)":1348186,"Rye Production (tonnes)":7577,"Potatoes Production (tonnes)":31,"Meat, chicken Production (tonnes)":95517,"Avocados Production (tonnes)":4200,"Petrol Price (USD/liter)":0.59,"Daily Oil Consumption (Barrels)":96000,"CO2 Emissions (ton per capita)":3.542397828},{"Country":"Nigeria","Country_clean":"nigeria","Region":"Sub-Saharan Africa","Happiness":4.881,"Median Salary":389.85,"Average Salary":438.91,"Lowest Salary":110.63,"Highest Salary":1949.27,"Infant Survival Rate":517,"Alcohol Consumption Rate":0.01,"Life Expectancy":54.5,"Netflix (USD/month)":null,"Women Safety Index":0.465,"Average Winter Temperature":25.011763,"Average Summer Temperature":25.588018,"Population":218541212,"Energy Per Capita":2547.954,"% of Power from Fossil Fuels":72.492,"% of Power from Nuclear":0,"% of Power from Renewables":27.508,"% of Agricultural Land":75.3691931003,"% of Forest Land":23.5664876972,"Territory":910770,"Average Rainfall":1150,"Corruption":0.1521603316,"Wheat Production (tonnes)":199000,"Rye Production (tonnes)":10328099,"Potatoes Production (tonnes)":1850,"Meat, chicken Production (tonnes)":1441905,"Avocados Production (tonnes)":80609.488,"Petrol Price (USD/liter)":0.42,"Daily Oil Consumption (Barrels)":428000,"CO2 Emissions (ton per capita)":0.573636206},{"Country":"State of Palestine","Country_clean":"state of palestine","Region":"Middle East and North Africa","Happiness":4.879,"Median Salary":1510,"Average Salary":1710,"Lowest Salary":430,"Highest Salary":7620,"Infant Survival Rate":764,"Alcohol Consumption Rate":0.01,"Life Expectancy":59.8,"Netflix (USD/month)":null,"Women Safety Index":0.483,"Average Winter Temperature":13.515371,"Average Summer Temperature":14.106538,"Population":5250072,"Energy Per Capita":3999.195,"% of Power from Fossil Fuels":76.744,"% of Power from Nuclear":0,"% of Power from Renewables":23.256,"% of Agricultural Land":68.7719298246,"% of Forest Land":6.0701754386,"Territory":570,"Average Rainfall":null,"Corruption":null,"Wheat Production (tonnes)":23762000,"Rye Production (tonnes)":391.1,"Potatoes Production (tonnes)":7529025,"Meat, chicken Production (tonnes)":52000,"Avocados Production (tonnes)":145795,"Petrol Price (USD/liter)":1.75,"Daily Oil Consumption (Barrels)":24001,"CO2 Emissions (ton per capita)":null},{"Country":"Cameroon","Country_clean":"cameroon","Region":"Sub-Saharan Africa","Happiness":4.874,"Median Salary":633.27,"Average Salary":744.45,"Lowest Salary":186.92,"Highest Salary":3303.31,"Infant Survival Rate":955,"Alcohol Consumption Rate":0.01,"Life Expectancy":57.3,"Netflix (USD/month)":null,"Women Safety Index":0.466,"Average Winter Temperature":24.881084,"Average Summer Temperature":24.946562,"Population":27914536,"Energy Per Capita":1593.62,"% of Power from Fossil Fuels":37.64,"% of Power from Nuclear":0,"% of Power from Renewables":62.36,"% of Agricultural Land":20.6257536333,"% of Forest Land":42.9110448266,"Territory":472710,"Average Rainfall":1604,"Corruption":0.1473762393,"Wheat Production (tonnes)":31793,"Rye Production (tonnes)":10210326,"Potatoes Production (tonnes)":2133322.8,"Meat, chicken Production (tonnes)":6922.65,"Avocados Production (tonnes)":28994,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":40000,"CO2 Emissions (ton per capita)":0.364424922},{"Country":"Ukraine","Country_clean":"ukraine","Region":"Commonwealth of Independent States","Happiness":4.873,"Median Salary":530.73,"Average Salary":622.8,"Lowest Salary":157.32,"Highest Salary":2761.98,"Infant Survival Rate":996,"Alcohol Consumption Rate":8.06,"Life Expectancy":71.3,"Netflix (USD/month)":8.46,"Women Safety Index":0.626,"Average Winter Temperature":-1.7763926,"Average Summer Temperature":0.87508214,"Population":39701739,"Energy Per Capita":16309.124,"% of Power from Fossil Fuels":25.424,"% of Power from Nuclear":58.058,"% of Power from Renewables":16.518,"% of Agricultural Land":71.2996202969,"% of Forest Land":16.7345529858,"Territory":579400,"Average Rainfall":565,"Corruption":0.1620248556,"Wheat Production (tonnes)":2727560,"Rye Production (tonnes)":10948.6,"Potatoes Production (tonnes)":330779000,"Meat, chicken Production (tonnes)":80000,"Avocados Production (tonnes)":97652.8,"Petrol Price (USD/liter)":1.7,"Daily Oil Consumption (Barrels)":244000,"CO2 Emissions (ton per capita)":3.936583531},{"Country":"Namibia","Country_clean":"namibia","Region":"Sub-Saharan Africa","Happiness":4.832,"Median Salary":821.41,"Average Salary":927.4,"Lowest Salary":233.7,"Highest Salary":4128.25,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":65.8,"Netflix (USD/month)":null,"Women Safety Index":0.61,"Average Winter Temperature":25.959553,"Average Summer Temperature":26.584833,"Population":2567012,"Energy Per Capita":8748.273,"% of Power from Fossil Fuels":4.459,"% of Power from Nuclear":0,"% of Power from Renewables":95.541,"% of Agricultural Land":47.1425621591,"% of Forest Land":7.9776142064,"Territory":823290,"Average Rainfall":285,"Corruption":0.1675386727,"Wheat Production (tonnes)":18053568,"Rye Production (tonnes)":2762388.832,"Potatoes Production (tonnes)":24754506,"Meat, chicken Production (tonnes)":9280,"Avocados Production (tonnes)":567.4,"Petrol Price (USD/liter)":1.27,"Daily Oil Consumption (Barrels)":26000,"CO2 Emissions (ton per capita)":1.691705428},{"Country":"Morocco","Country_clean":"morocco","Region":"Middle East and North Africa","Happiness":4.795,"Median Salary":1634.24,"Average Salary":1896.89,"Lowest Salary":477.63,"Highest Salary":8433.85,"Infant Survival Rate":983,"Alcohol Consumption Rate":0.43,"Life Expectancy":74.3,"Netflix (USD/month)":null,"Women Safety Index":0.637,"Average Winter Temperature":11.878008,"Average Summer Temperature":13.544462,"Population":37457971,"Energy Per Capita":6855.11,"% of Power from Fossil Fuels":80.194,"% of Power from Nuclear":0,"% of Power from Renewables":17.382,"% of Agricultural Land":67.8713869594,"% of Forest Land":12.8903354246,"Territory":446300,"Average Rainfall":346,"Corruption":0.1603332013,"Wheat Production (tonnes)":580,"Rye Production (tonnes)":240600.52,"Potatoes Production (tonnes)":1642,"Meat, chicken Production (tonnes)":8401090,"Avocados Production (tonnes)":21020,"Petrol Price (USD/liter)":1.68,"Daily Oil Consumption (Barrels)":275000,"CO2 Emissions (ton per capita)":1.959872285},{"Country":"Pakistan","Country_clean":"pakistan","Region":"South Asia","Happiness":4.657,"Median Salary":245.34,"Average Salary":284.9,"Lowest Salary":71.83,"Highest Salary":1266.61,"Infant Survival Rate":648,"Alcohol Consumption Rate":0.01,"Life Expectancy":66.4,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":9.189832,"Average Summer Temperature":9.4178095,"Population":235824862,"Energy Per Capita":4242.753,"% of Power from Fossil Fuels":56.575,"% of Power from Nuclear":14.74,"% of Power from Renewables":28.685,"% of Agricultural Land":47.0929327522,"% of Forest Land":4.7796803653,"Territory":770880,"Average Rainfall":494,"Corruption":0.1551976055,"Wheat Production (tonnes)":2326000,"Rye Production (tonnes)":2036086.2,"Potatoes Production (tonnes)":1000,"Meat, chicken Production (tonnes)":1.6,"Avocados Production (tonnes)":548570.264,"Petrol Price (USD/liter)":1.03,"Daily Oil Consumption (Barrels)":556000,"CO2 Emissions (ton per capita)":0.879965499},{"Country":"Niger","Country_clean":"niger","Region":"Sub-Saharan Africa","Happiness":4.556,"Median Salary":480.19,"Average Salary":547.87,"Lowest Salary":137.93,"Highest Salary":2433.17,"Infant Survival Rate":951,"Alcohol Consumption Rate":0.01,"Life Expectancy":61.8,"Netflix (USD/month)":null,"Women Safety Index":0.442,"Average Winter Temperature":18.64278,"Average Summer Temperature":19.539503,"Population":26207977,"Energy Per Capita":409.757,"% of Power from Fossil Fuels":88.889,"% of Power from Nuclear":0,"% of Power from Renewables":11.111,"% of Agricultural Land":36.7845583011,"% of Forest Land":0.8425673009,"Territory":1266700,"Average Rainfall":151,"Corruption":0.1515905112,"Wheat Production (tonnes)":6040500,"Rye Production (tonnes)":3735380.8,"Potatoes Production (tonnes)":770127,"Meat, chicken Production (tonnes)":15557,"Avocados Production (tonnes)":87005.8,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.092232251},{"Country":"Burkina Faso","Country_clean":"burkina faso","Region":"Sub-Saharan Africa","Happiness":4.548,"Median Salary":485.02,"Average Salary":534.97,"Lowest Salary":135.03,"Highest Salary":2384.83,"Infant Survival Rate":962,"Alcohol Consumption Rate":0.01,"Life Expectancy":59.9,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":25.427477,"Average Summer Temperature":26.73383,"Population":22673762,"Energy Per Capita":904.726,"% of Power from Fossil Fuels":86.857,"% of Power from Nuclear":0,"% of Power from Renewables":13.143,"% of Agricultural Land":46.5643274854,"% of Forest Land":22.5380116959,"Territory":273600,"Average Rainfall":748,"Corruption":0.1515905112,"Wheat Production (tonnes)":1780160,"Rye Production (tonnes)":21900,"Potatoes Production (tonnes)":3760,"Meat, chicken Production (tonnes)":24732.78,"Avocados Production (tonnes)":138000,"Petrol Price (USD/liter)":1.14,"Daily Oil Consumption (Barrels)":23000,"CO2 Emissions (ton per capita)":0.246046246},{"Country":"Mauritania","Country_clean":"mauritania","Region":"Sub-Saharan Africa","Happiness":4.505,"Median Salary":44.623043,"Average Salary":52.497697,"Lowest Salary":13.203171,"Highest Salary":232.82729,"Infant Survival Rate":992,"Alcohol Consumption Rate":0.01,"Life Expectancy":63.1,"Netflix (USD/month)":null,"Women Safety Index":0.506,"Average Winter Temperature":20.794834,"Average Summer Temperature":21.64168,"Population":4736139,"Energy Per Capita":3988.532,"% of Power from Fossil Fuels":73.404,"% of Power from Nuclear":0,"% of Power from Renewables":26.596,"% of Agricultural Land":38.5272145144,"% of Forest Land":0.2982116038,"Territory":1030700,"Average Rainfall":92,"Corruption":0.163652122,"Wheat Production (tonnes)":329411,"Rye Production (tonnes)":845441.6,"Potatoes Production (tonnes)":326562,"Meat, chicken Production (tonnes)":58000,"Avocados Production (tonnes)":91812.448,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.872793555},{"Country":"Gambia","Country_clean":"gambia","Region":"Sub-Saharan Africa","Happiness":4.485,"Median Salary":223.7,"Average Salary":246.84,"Lowest Salary":62.02,"Highest Salary":1095.34,"Infant Survival Rate":997,"Alcohol Consumption Rate":0.01,"Life Expectancy":61.1,"Netflix (USD/month)":null,"Women Safety Index":0.575,"Average Winter Temperature":25.587826,"Average Summer Temperature":26.182985,"Population":2705992,"Energy Per Capita":931.273,"% of Power from Fossil Fuels":100,"% of Power from Nuclear":0,"% of Power from Renewables":0,"% of Agricultural Land":62.6482213439,"% of Forest Land":23.4123814229,"Territory":10120,"Average Rainfall":836,"Corruption":0.1527849287,"Wheat Production (tonnes)":50000,"Rye Production (tonnes)":4000,"Potatoes Production (tonnes)":40392,"Meat, chicken Production (tonnes)":4631097,"Avocados Production (tonnes)":9710,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":3800,"CO2 Emissions (ton per capita)":0.247050718},{"Country":"Chad","Country_clean":"chad","Region":"Sub-Saharan Africa","Happiness":4.471,"Median Salary":707.39,"Average Salary":787.96,"Lowest Salary":198.2,"Highest Salary":3512.79,"Infant Survival Rate":954,"Alcohol Consumption Rate":0.01,"Life Expectancy":53.1,"Netflix (USD/month)":null,"Women Safety Index":0.462,"Average Winter Temperature":21.083433,"Average Summer Temperature":21.204617,"Population":17723315,"Energy Per Capita":361.161,"% of Power from Fossil Fuels":96.774,"% of Power from Nuclear":0,"% of Power from Renewables":3.226,"% of Agricultural Land":39.9761753494,"% of Forest Land":3.3365099269,"Territory":1259200,"Average Rainfall":322,"Corruption":0.1769557148,"Wheat Production (tonnes)":94838540,"Rye Production (tonnes)":10666877,"Potatoes Production (tonnes)":1300,"Meat, chicken Production (tonnes)":703003,"Avocados Production (tonnes)":83403.5,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.141093412},{"Country":"Kenya","Country_clean":"kenya","Region":"Sub-Saharan Africa","Happiness":4.47,"Median Salary":863.29,"Average Salary":991.43,"Lowest Salary":250.22,"Highest Salary":4424.36,"Infant Survival Rate":946,"Alcohol Consumption Rate":0.01,"Life Expectancy":63.4,"Netflix (USD/month)":null,"Women Safety Index":0.511,"Average Winter Temperature":25.798006,"Average Summer Temperature":26.603018,"Population":54027487,"Energy Per Capita":1952.694,"% of Power from Fossil Fuels":10.219,"% of Power from Nuclear":0,"% of Power from Renewables":89.781,"% of Agricultural Land":48.6874934111,"% of Forest Land":6.3448184981,"Territory":569140,"Average Rainfall":630,"Corruption":0.1473762393,"Wheat Production (tonnes)":250320,"Rye Production (tonnes)":76025.194,"Potatoes Production (tonnes)":112000,"Meat, chicken Production (tonnes)":698000,"Avocados Production (tonnes)":370,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":114000,"CO2 Emissions (ton per capita)":0.423783898},{"Country":"Tunisia","Country_clean":"tunisia","Region":"Middle East and North Africa","Happiness":4.422,"Median Salary":1088.33,"Average Salary":1239.75,"Lowest Salary":312.3,"Highest Salary":5520.5,"Infant Survival Rate":997,"Alcohol Consumption Rate":1.39,"Life Expectancy":75.3,"Netflix (USD/month)":null,"Women Safety Index":0.669,"Average Winter Temperature":12.263956,"Average Summer Temperature":12.730293,"Population":12356117,"Energy Per Capita":9524.104,"% of Power from Fossil Fuels":95.611,"% of Power from Nuclear":0,"% of Power from Renewables":4.389,"% of Agricultural Land":62.4388516993,"% of Forest Land":4.533084449,"Territory":155360,"Average Rainfall":207,"Corruption":0.1589545012,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":0.76,"Daily Oil Consumption (Barrels)":97000,"CO2 Emissions (ton per capita)":2.557564208},{"Country":"Benin","Country_clean":"benin","Region":"Sub-Saharan Africa","Happiness":4.377,"Median Salary":488.25,"Average Salary":549.48,"Lowest Salary":138.58,"Highest Salary":2449.28,"Infant Survival Rate":975,"Alcohol Consumption Rate":0.01,"Life Expectancy":60,"Netflix (USD/month)":null,"Women Safety Index":0.566,"Average Winter Temperature":26.43899,"Average Summer Temperature":27.806599,"Population":13352864,"Energy Per Capita":2484.818,"% of Power from Fossil Fuels":95.833,"% of Power from Nuclear":0,"% of Power from Renewables":4.167,"% of Agricultural Land":35.0301525364,"% of Forest Land":27.3603228095,"Territory":112760,"Average Rainfall":1039,"Corruption":0.1563068628,"Wheat Production (tonnes)":4326575,"Rye Production (tonnes)":2949,"Potatoes Production (tonnes)":12335,"Meat, chicken Production (tonnes)":18924,"Avocados Production (tonnes)":12800,"Petrol Price (USD/liter)":0.96,"Daily Oil Consumption (Barrels)":36000,"CO2 Emissions (ton per capita)":0.618583746},{"Country":"Uganda","Country_clean":"uganda","Region":"Sub-Saharan Africa","Happiness":4.372,"Median Salary":645.21,"Average Salary":698.31,"Lowest Salary":176.04,"Highest Salary":3106.55,"Infant Survival Rate":934,"Alcohol Consumption Rate":0.01,"Life Expectancy":62.3,"Netflix (USD/month)":null,"Women Safety Index":0.544,"Average Winter Temperature":23.9091,"Average Summer Temperature":24.655352,"Population":47249585,"Energy Per Capita":766.846,"% of Power from Fossil Fuels":2.955,"% of Power from Nuclear":0,"% of Power from Renewables":97.045,"% of Agricultural Land":71.8880909635,"% of Forest Land":11.4534375623,"Territory":200520,"Average Rainfall":1180,"Corruption":0.1515905112,"Wheat Production (tonnes)":2727560,"Rye Production (tonnes)":10948.6,"Potatoes Production (tonnes)":297921600,"Meat, chicken Production (tonnes)":25400,"Avocados Production (tonnes)":97652.8,"Petrol Price (USD/liter)":1.51,"Daily Oil Consumption (Barrels)":32001,"CO2 Emissions (ton per capita)":0.132370788},{"Country":"Myanmar","Country_clean":"myanmar","Region":"Southeast Asia","Happiness":4.354,"Median Salary":228.46,"Average Salary":260.35,"Lowest Salary":65.68,"Highest Salary":1156.59,"Infant Survival Rate":961,"Alcohol Consumption Rate":0.01,"Life Expectancy":66.6,"Netflix (USD/month)":null,"Women Safety Index":0.451,"Average Winter Temperature":18.82836,"Average Summer Temperature":20.528673,"Population":54179306,"Energy Per Capita":3064.848,"% of Power from Fossil Fuels":58.184,"% of Power from Nuclear":0,"% of Power from Renewables":41.816,"% of Agricultural Land":19.8875388788,"% of Forest Land":43.2901466285,"Territory":652670,"Average Rainfall":2091,"Corruption":0.1673619598,"Wheat Production (tonnes)":2105000,"Rye Production (tonnes)":160787.4,"Potatoes Production (tonnes)":73000,"Meat, chicken Production (tonnes)":15600,"Avocados Production (tonnes)":133.254,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":123000,"CO2 Emissions (ton per capita)":0.679428523},{"Country":"Cambodia","Country_clean":"cambodia","Region":"Southeast Asia","Happiness":4.341,"Median Salary":745.19,"Average Salary":808.3,"Lowest Salary":203.41,"Highest Salary":3592.44,"Infant Survival Rate":990,"Alcohol Consumption Rate":0.01,"Life Expectancy":68.7,"Netflix (USD/month)":null,"Women Safety Index":0.645,"Average Winter Temperature":25.820742,"Average Summer Temperature":26.725933,"Population":16767842,"Energy Per Capita":4035.081,"% of Power from Fossil Fuels":47.066,"% of Power from Nuclear":0,"% of Power from Renewables":52.934,"% of Agricultural Land":34.5521170406,"% of Forest Land":44.8259687288,"Territory":176520,"Average Rainfall":1904,"Corruption":0.1557928324,"Wheat Production (tonnes)":93873230,"Rye Production (tonnes)":14953906,"Potatoes Production (tonnes)":1175.02,"Meat, chicken Production (tonnes)":183000,"Avocados Production (tonnes)":231517.88,"Petrol Price (USD/liter)":1.53,"Daily Oil Consumption (Barrels)":48000,"CO2 Emissions (ton per capita)":0.98140655},{"Country":"Ghana","Country_clean":"ghana","Region":"Sub-Saharan Africa","Happiness":4.289,"Median Salary":373.82,"Average Salary":438.42,"Lowest Salary":110.25,"Highest Salary":1946.6,"Infant Survival Rate":963,"Alcohol Consumption Rate":0.01,"Life Expectancy":62.4,"Netflix (USD/month)":null,"Women Safety Index":0.651,"Average Winter Temperature":27.695566,"Average Summer Temperature":28.66266,"Population":33475870,"Energy Per Capita":3483.363,"% of Power from Fossil Fuels":65.122,"% of Power from Nuclear":0,"% of Power from Renewables":34.878,"% of Agricultural Land":55.3930199136,"% of Forest Land":35.1286771589,"Territory":227533,"Average Rainfall":1187,"Corruption":0.1473762393,"Wheat Production (tonnes)":16184871,"Rye Production (tonnes)":263400,"Potatoes Production (tonnes)":6323,"Meat, chicken Production (tonnes)":100860,"Avocados Production (tonnes)":16800,"Petrol Price (USD/liter)":1.29,"Daily Oil Consumption (Barrels)":88000,"CO2 Emissions (ton per capita)":0.658823541},{"Country":"Liberia","Country_clean":"liberia","Region":"Sub-Saharan Africa","Happiness":4.269,"Median Salary":334.39,"Average Salary":380.35,"Lowest Salary":96.14,"Highest Salary":1690.44,"Infant Survival Rate":992,"Alcohol Consumption Rate":0.01,"Life Expectancy":61.4,"Netflix (USD/month)":null,"Women Safety Index":0.5,"Average Winter Temperature":26.30846,"Average Summer Temperature":26.822199,"Population":5302681,"Energy Per Capita":1064.616,"% of Power from Fossil Fuels":42.391,"% of Power from Nuclear":0,"% of Power from Renewables":57.609,"% of Agricultural Land":19.9651162791,"% of Forest Land":78.7705564784,"Territory":96320,"Average Rainfall":2391,"Corruption":0.1515905112,"Wheat Production (tonnes)":null,"Rye Production (tonnes)":null,"Potatoes Production (tonnes)":null,"Meat, chicken Production (tonnes)":null,"Avocados Production (tonnes)":null,"Petrol Price (USD/liter)":1.3,"Daily Oil Consumption (Barrels)":8000,"CO2 Emissions (ton per capita)":0.23899343},{"Country":"Mali","Country_clean":"mali","Region":"Sub-Saharan Africa","Happiness":4.232,"Median Salary":478.58,"Average Salary":533.36,"Lowest Salary":134.55,"Highest Salary":2368.71,"Infant Survival Rate":948,"Alcohol Consumption Rate":0.01,"Life Expectancy":58.2,"Netflix (USD/month)":null,"Women Safety Index":0.481,"Average Winter Temperature":22.10115,"Average Summer Temperature":23.133558,"Population":22593590,"Energy Per Capita":1168.567,"% of Power from Fossil Fuels":64.012,"% of Power from Nuclear":0,"% of Power from Renewables":35.988,"% of Agricultural Land":35.3477737074,"% of Forest Land":10.8966636344,"Territory":1220190,"Average Rainfall":282,"Corruption":0.1473762393,"Wheat Production (tonnes)":4187394,"Rye Production (tonnes)":2372272,"Potatoes Production (tonnes)":1924871,"Meat, chicken Production (tonnes)":494128,"Avocados Production (tonnes)":11187.4,"Petrol Price (USD/liter)":1.22,"Daily Oil Consumption (Barrels)":21999,"CO2 Emissions (ton per capita)":0.29657102},{"Country":"Madagascar","Country_clean":"madagascar","Region":"Sub-Saharan Africa","Happiness":4.228,"Median Salary":250.87,"Average Salary":290.48,"Lowest Salary":73.28,"Highest Salary":1291.74,"Infant Survival Rate":972,"Alcohol Consumption Rate":0.01,"Life Expectancy":65.5,"Netflix (USD/month)":null,"Women Safety Index":0.505,"Average Winter Temperature":24.953327,"Average Summer Temperature":25.925783,"Population":29611714,"Energy Per Capita":507.644,"% of Power from Fossil Fuels":65.55,"% of Power from Nuclear":0,"% of Power from Renewables":34.45,"% of Agricultural Land":70.2904778274,"% of Forest Land":21.341692506,"Territory":581800,"Average Rainfall":1513,"Corruption":0.1534845382,"Wheat Production (tonnes)":2286,"Rye Production (tonnes)":3011811.06,"Potatoes Production (tonnes)":1483500,"Meat, chicken Production (tonnes)":7284,"Avocados Production (tonnes)":14839.178,"Petrol Price (USD/liter)":1.02,"Daily Oil Consumption (Barrels)":18000,"CO2 Emissions (ton per capita)":0.152766255},{"Country":"Togo","Country_clean":"togo","Region":"Sub-Saharan Africa","Happiness":4.214,"Median Salary":787.96,"Average Salary":852.41,"Lowest Salary":214.31,"Highest Salary":3786.72,"Infant Survival Rate":987,"Alcohol Consumption Rate":0.01,"Life Expectancy":59.9,"Netflix (USD/month)":null,"Women Safety Index":0.595,"Average Winter Temperature":27.114004,"Average Summer Temperature":28.22776,"Population":8848699,"Energy Per Capita":1115.704,"% of Power from Fossil Fuels":73.016,"% of Power from Nuclear":0,"% of Power from Renewables":26.984,"% of Agricultural Land":70.2334988049,"% of Forest Land":22.1788931789,"Territory":54390,"Average Rainfall":1168,"Corruption":0.1515905112,"Wheat Production (tonnes)":1169283.4,"Rye Production (tonnes)":9853.4,"Potatoes Production (tonnes)":682800,"Meat, chicken Production (tonnes)":328000,"Avocados Production (tonnes)":179232.066,"Petrol Price (USD/liter)":0.84,"Daily Oil Consumption (Barrels)":15000,"CO2 Emissions (ton per capita)":0.293231207},{"Country":"Jordan","Country_clean":"jordan","Region":"Middle East and North Africa","Happiness":4.186,"Median Salary":1946.4,"Average Salary":2284.91,"Lowest Salary":578.28,"Highest Salary":10141.04,"Infant Survival Rate":996,"Alcohol Consumption Rate":0.41,"Life Expectancy":74.1,"Netflix (USD/month)":null,"Women Safety Index":0.679,"Average Winter Temperature":10.618665,"Average Summer Temperature":11.0657425,"Population":11285869,"Energy Per Capita":9183.148,"% of Power from Fossil Fuels":76.463,"% of Power from Nuclear":0,"% of Power from Renewables":23.537,"% of Agricultural Land":11.5210487195,"% of Forest Land":1.0980471653,"Territory":88794,"Average Rainfall":111,"Corruption":0.1633208543,"Wheat Production (tonnes)":1268900,"Rye Production (tonnes)":391236.668,"Potatoes Production (tonnes)":140000,"Meat, chicken Production (tonnes)":250,"Avocados Production (tonnes)":190,"Petrol Price (USD/liter)":1.66,"Daily Oil Consumption (Barrels)":114000,"CO2 Emissions (ton per capita)":2.438204112},{"Country":"India","Country_clean":"india","Region":"South Asia","Happiness":4.054,"Median Salary":327.97,"Average Salary":384.43,"Lowest Salary":97.07,"Highest Salary":1717.92,"Infant Survival Rate":90,"Alcohol Consumption Rate":3.07,"Life Expectancy":68.3,"Netflix (USD/month)":6.61,"Women Safety Index":0.595,"Average Winter Temperature":16.979853,"Average Summer Temperature":18.022833,"Population":1417173173,"Energy Per Capita":7143.406,"% of Power from Fossil Fuels":77.006,"% of Power from Nuclear":2.519,"% of Power from Renewables":20.476,"% of Agricultural Land":60.0459264292,"% of Forest Land":24.3598290052,"Territory":2973190,"Average Rainfall":1083,"Corruption":0.1470372379,"Wheat Production (tonnes)":1286332,"Rye Production (tonnes)":4688054,"Potatoes Production (tonnes)":3087000,"Meat, chicken Production (tonnes)":990,"Avocados Production (tonnes)":22132,"Petrol Price (USD/liter)":1.33,"Daily Oil Consumption (Barrels)":4443000,"CO2 Emissions (ton per capita)":1.797620119},{"Country":"Egypt","Country_clean":"egypt","Region":"Middle East and North Africa","Happiness":3.977,"Median Salary":254.53,"Average Salary":298.51,"Lowest Salary":75.36,"Highest Salary":1329.24,"Infant Survival Rate":949,"Alcohol Consumption Rate":0.21,"Life Expectancy":79,"Netflix (USD/month)":null,"Women Safety Index":0.645,"Average Winter Temperature":14.330447,"Average Summer Temperature":14.60245,"Population":110990103,"Energy Per Capita":9960.062,"% of Power from Fossil Fuels":88.779,"% of Power from Nuclear":0,"% of Power from Renewables":11.221,"% of Agricultural Land":4.0494248832,"% of Forest Land":0.0451855945,"Territory":995450,"Average Rainfall":18.1,"Corruption":0.1632932276,"Wheat Production (tonnes)":1085494,"Rye Production (tonnes)":9716,"Potatoes Production (tonnes)":104900960,"Meat, chicken Production (tonnes)":842853,"Avocados Production (tonnes)":0,"Petrol Price (USD/liter)":0.52,"Daily Oil Consumption (Barrels)":877000,"CO2 Emissions (ton per capita)":2.484059911},{"Country":"Sri Lanka","Country_clean":"sri lanka","Region":"South Asia","Happiness":3.898,"Median Salary":249.68,"Average Salary":278.41,"Lowest Salary":70.14,"Highest Salary":1239.11,"Infant Survival Rate":997,"Alcohol Consumption Rate":2.37,"Life Expectancy":74.9,"Netflix (USD/month)":null,"Women Safety Index":0.743,"Average Winter Temperature":25.60819,"Average Summer Temperature":25.9974,"Population":21832143,"Energy Per Capita":4347.636,"% of Power from Fossil Fuels":62.752,"% of Power from Nuclear":0,"% of Power from Renewables":51.574,"% of Agricultural Land":45.4574846427,"% of Forest Land":34.1070158422,"Territory":61860,"Average Rainfall":1712,"Corruption":0.1708792597,"Wheat Production (tonnes)":953620,"Rye Production (tonnes)":334353.706,"Potatoes Production (tonnes)":84310000,"Meat, chicken Production (tonnes)":3670,"Avocados Production (tonnes)":16564.6,"Petrol Price (USD/liter)":1.26,"Daily Oil Consumption (Barrels)":127000,"CO2 Emissions (ton per capita)":1.090675627},{"Country":"Bangladesh","Country_clean":"bangladesh","Region":"South Asia","Happiness":3.886,"Median Salary":218.57,"Average Salary":236.71,"Lowest Salary":59.68,"Highest Salary":1052.06,"Infant Survival Rate":908,"Alcohol Consumption Rate":0.01,"Life Expectancy":71.8,"Netflix (USD/month)":null,"Women Safety Index":0.593,"Average Winter Temperature":16.99154,"Average Summer Temperature":19.676044,"Population":171186372,"Energy Per Capita":2912.048,"% of Power from Fossil Fuels":98.052,"% of Power from Nuclear":0,"% of Power from Renewables":1.948,"% of Agricultural Land":77.3450103711,"% of Forest Land":14.4687716064,"Territory":130170,"Average Rainfall":2666,"Corruption":0.1545842141,"Wheat Production (tonnes)":11000,"Rye Production (tonnes)":341300,"Potatoes Production (tonnes)":3296077,"Meat, chicken Production (tonnes)":8222.25,"Avocados Production (tonnes)":55000,"Petrol Price (USD/liter)":0.95,"Daily Oil Consumption (Barrels)":113000,"CO2 Emissions (ton per capita)":0.556529455},{"Country":"Ethiopia","Country_clean":"ethiopia","Region":"Sub-Saharan Africa","Happiness":3.861,"Median Salary":143.88,"Average Salary":160.41,"Lowest Salary":40.42,"Highest Salary":713.13,"Infant Survival Rate":null,"Alcohol Consumption Rate":null,"Life Expectancy":null,"Netflix (USD/month)":null,"Women Safety Index":0.521,"Average Winter Temperature":22.94068,"Average Summer Temperature":23.82733,"Population":123379924,"Energy Per Capita":871.584,"% of Power from Fossil Fuels":0.068,"% of Power from Nuclear":0,"% of Power from Renewables":99.932,"% of Agricultural Land":34.1981062224,"% of Forest Land":15.0593059801,"Territory":1128571.265,"Average Rainfall":848,"Corruption":0.1515905112,"Wheat Production (tonnes)":8126800,"Rye Production (tonnes)":7124000,"Potatoes Production (tonnes)":51085360,"Meat, chicken Production (tonnes)":48000,"Avocados Production (tonnes)":762336,"Petrol Price (USD/liter)":0.71,"Daily Oil Consumption (Barrels)":74000,"CO2 Emissions (ton per capita)":0.163813429},{"Country":"Tanzania","Country_clean":"tanzania","Region":"Sub-Saharan Africa","Happiness":3.781,"Median Salary":457.77,"Average Salary":505.54,"Lowest Salary":126.98,"Highest Salary":2245.08,"Infant Survival Rate":915,"Alcohol Consumption Rate":0.01,"Life Expectancy":61.8,"Netflix (USD/month)":null,"Women Safety Index":0.652,"Average Winter Temperature":22.93629,"Average Summer Temperature":23.6847,"Population":65497748,"Energy Per Capita":907.404,"% of Power from Fossil Fuels":55.868,"% of Power from Nuclear":0,"% of Power from Renewables":44.132,"% of Agricultural Land":44.6163919621,"% of Forest Land":51.1131180853,"Territory":885800,"Average Rainfall":1071,"Corruption":0.1473762393,"Wheat Production (tonnes)":23410593.11,"Rye Production (tonnes)":6242369.62,"Potatoes Production (tonnes)":102287,"Meat, chicken Production (tonnes)":368,"Avocados Production (tonnes)":111386.946,"Petrol Price (USD/liter)":1.28,"Daily Oil Consumption (Barrels)":71999,"CO2 Emissions (ton per capita)":0.21463496},{"Country":"Comoros","Country_clean":"comoros","Region":"Sub-Saharan Africa","Happiness":3.566,"Median Salary":567.21,"Average Salary":651,"Lowest Salary":163.93,"Highest Salary":2900.48,"Infant Survival Rate":999,"Alcohol Consumption Rate":0.01,"Life Expectancy":63.5,"Netflix (USD/month)":null,"Women Safety Index":0.519,"Average Winter Temperature":26.264544,"Average Summer Temperature":26.784773,"Population":836774,"Energy Per Capita":1633.784,"% of Power from Fossil Fuels":100,"% of Power from Nuclear":0,"% of Power from Renewables":0,"% of Agricultural Land":71.4669532509,"% of Forest Land":17.4529822676,"Territory":1861,"Average Rainfall":900,"Corruption":0.2269586474,"Wheat Production (tonnes)":700,"Rye Production (tonnes)":28383.1,"Potatoes Production (tonnes)":820515,"Meat, chicken Production (tonnes)":13808618,"Avocados Production (tonnes)":1552.63,"Petrol Price (USD/liter)":1.36,"Daily Oil Consumption (Barrels)":1300,"CO2 Emissions (ton per capita)":0.376076363},{"Country":"Yemen","Country_clean":"yemen","Region":"Middle East and North Africa","Happiness":3.561,"Median Salary":120.98,"Average Salary":133.36,"Lowest Salary":33.62,"Highest Salary":594.93,"Infant Survival Rate":963,"Alcohol Consumption Rate":0.01,"Life Expectancy":65.7,"Netflix (USD/month)":null,"Women Safety Index":0.287,"Average Winter Temperature":19.670574,"Average Summer Temperature":21.359116,"Population":33696614,"Energy Per Capita":1080.039,"% of Power from Fossil Fuels":83.003,"% of Power from Nuclear":0,"% of Power from Renewables":16.997,"% of Agricultural Land":44.4191904843,"% of Forest Land":1.0398318086,"Territory":527970,"Average Rainfall":167,"Corruption":0.1827792972,"Wheat Production (tonnes)":202362,"Rye Production (tonnes)":16472.4,"Potatoes Production (tonnes)":58010040.4,"Meat, chicken Production (tonnes)":2458136,"Avocados Production (tonnes)":11979.6,"Petrol Price (USD/liter)":0.52,"Daily Oil Consumption (Barrels)":60000,"CO2 Emissions (ton per capita)":0.380633361},{"Country":"Zambia","Country_clean":"zambia","Region":"Sub-Saharan Africa","Happiness":3.502,"Median Salary":0.26133504,"Average Salary":0.28552394,"Lowest Salary":0.072092424,"Highest Salary":1.2711033,"Infant Survival Rate":973,"Alcohol Consumption Rate":0.01,"Life Expectancy":61.8,"Netflix (USD/month)":null,"Women Safety Index":0.556,"Average Winter Temperature":23.009497,"Average Summer Temperature":25.123566,"Population":20017675,"Energy Per Capita":3418.863,"% of Power from Fossil Fuels":7.792,"% of Power from Nuclear":0,"% of Power from Renewables":92.208,"% of Agricultural Land":32.0679589448,"% of Forest Land":60.0301501231,"Territory":743390,"Average Rainfall":1020,"Corruption":0.1535387486,"Wheat Production (tonnes)":12373724.2,"Rye Production (tonnes)":3980041.4,"Potatoes Production (tonnes)":1539264.8,"Meat, chicken Production (tonnes)":16400,"Avocados Production (tonnes)":17474.034,"Petrol Price (USD/liter)":1.48,"Daily Oil Consumption (Barrels)":22000,"CO2 Emissions (ton per capita)":0.380717051},{"Country":"Eswatini","Country_clean":"eswatini","Region":"Sub-Saharan Africa","Happiness":3.502,"Median Salary":204.56,"Average Salary":239.53,"Lowest Salary":60.41,"Highest Salary":1065.18,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":58.9,"Netflix (USD/month)":null,"Women Safety Index":0.415,"Average Winter Temperature":23.062267,"Average Summer Temperature":24.690916,"Population":1201670,"Energy Per Capita":5981.112,"% of Power from Fossil Fuels":5.405,"% of Power from Nuclear":0,"% of Power from Renewables":94.595,"% of Agricultural Land":69.476744186,"% of Forest Land":28.998255814,"Territory":17200,"Average Rainfall":788,"Corruption":0.2084804773,"Wheat Production (tonnes)":242000,"Rye Production (tonnes)":685,"Potatoes Production (tonnes)":84367810,"Meat, chicken Production (tonnes)":148000,"Avocados Production (tonnes)":192307,"Petrol Price (USD/liter)":null,"Daily Oil Consumption (Barrels)":null,"CO2 Emissions (ton per capita)":0.836140045},{"Country":"Malawi","Country_clean":"malawi","Region":"Sub-Saharan Africa","Happiness":3.421,"Median Salary":132.38,"Average Salary":151.69,"Lowest Salary":38.24,"Highest Salary":674.79,"Infant Survival Rate":974,"Alcohol Consumption Rate":0.01,"Life Expectancy":58.3,"Netflix (USD/month)":null,"Women Safety Index":0.521,"Average Winter Temperature":23.77365,"Average Summer Temperature":25.912868,"Population":20405317,"Energy Per Capita":464.983,"% of Power from Fossil Fuels":15.493,"% of Power from Nuclear":0,"% of Power from Renewables":84.507,"% of Agricultural Land":64.1705557913,"% of Forest Land":23.3315655494,"Territory":94280,"Average Rainfall":1181,"Corruption":0.1473762393,"Wheat Production (tonnes)":23310800,"Rye Production (tonnes)":2242357.8,"Potatoes Production (tonnes)":447532.88,"Meat, chicken Production (tonnes)":6200,"Avocados Production (tonnes)":68493.6,"Petrol Price (USD/liter)":1.35,"Daily Oil Consumption (Barrels)":6001,"CO2 Emissions (ton per capita)":0.077836684},{"Country":"Botswana","Country_clean":"botswana","Region":"Sub-Saharan Africa","Happiness":3.383,"Median Salary":729.39,"Average Salary":860.69,"Lowest Salary":216.63,"Highest Salary":3822.03,"Infant Survival Rate":998,"Alcohol Consumption Rate":0.01,"Life Expectancy":65.7,"Netflix (USD/month)":null,"Women Safety Index":0.659,"Average Winter Temperature":26.46735,"Average Summer Temperature":28.064913,"Population":2630296,"Energy Per Capita":9385.398,"% of Power from Fossil Fuels":99.543,"% of Power from Nuclear":0,"% of Power from Renewables":0.457,"% of Agricultural Land":45.6337232898,"% of Forest Land":26.7083090713,"Territory":566730,"Average Rainfall":416,"Corruption":0.1603969038,"Wheat Production (tonnes)":2713157,"Rye Production (tonnes)":557002.44,"Potatoes Production (tonnes)":30482,"Meat, chicken Production (tonnes)":57420,"Avocados Production (tonnes)":830,"Petrol Price (USD/liter)":1.13,"Daily Oil Consumption (Barrels)":21000,"CO2 Emissions (ton per capita)":3.147107071},{"Country":"Zimbabwe","Country_clean":"zimbabwe","Region":"Sub-Saharan Africa","Happiness":3.341,"Median Salary":555.40204,"Average Salary":602.37635,"Lowest Salary":151.42305,"Highest Salary":2674.772,"Infant Survival Rate":978,"Alcohol Consumption Rate":6.5,"Life Expectancy":67,"Netflix (USD/month)":null,"Women Safety Index":0.604,"Average Winter Temperature":23.768185,"Average Summer Temperature":27.019161,"Population":16320537,"Energy Per Capita":2635.154,"% of Power from Fossil Fuels":44.956,"% of Power from Nuclear":0,"% of Power from Renewables":55.044,"% of Agricultural Land":41.876696394,"% of Forest Land":44.9748222825,"Territory":386850,"Average Rainfall":657,"Corruption":0.1515905112,"Wheat Production (tonnes)":1316724.8,"Rye Production (tonnes)":140284.8,"Potatoes Production (tonnes)":271012.612,"Meat, chicken Production (tonnes)":8000,"Avocados Production (tonnes)":29313.66,"Petrol Price (USD/liter)":1.62,"Daily Oil Consumption (Barrels)":24000,"CO2 Emissions (ton per capita)":0.80297852},{"Country":"Congo (Kinshasa)","Country_clean":"congo kinshasa","Region":"Sub-Saharan Africa","Happiness":3.295,"Median Salary":1058.67,"Average Salary":1205.3,"Lowest Salary":302.94,"Highest Salary":5365.86,"Infant Survival Rate":993,"Alcohol Consumption Rate":0.01,"Life Expectancy":64.7,"Netflix (USD/month)":null,"Women Safety Index":0.384,"Average Winter Temperature":25.505972,"Average Summer Temperature":26.152718,"Population":99010212,"Energy Per Capita":2348.011,"% of Power from Fossil Fuels":76.119,"% of Power from Nuclear":0,"% of Power from Renewables":23.881,"% of Agricultural Land":31.2679355783,"% of Forest Land":64.2196193265,"Territory":341500,"Average Rainfall":1646,"Corruption":0.158911109,"Wheat Production (tonnes)":916614,"Rye Production (tonnes)":15,"Potatoes Production (tonnes)":32500,"Meat, chicken Production (tonnes)":1478922.8,"Avocados Production (tonnes)":21000,"Petrol Price (USD/liter)":1.04,"Daily Oil Consumption (Barrels)":17000,"CO2 Emissions (ton per capita)":1.349316017},{"Country":"Sierra Leone","Country_clean":"sierra leone","Region":"Sub-Saharan Africa","Happiness":3.245,"Median Salary":249.1,"Average Salary":277.75,"Lowest Salary":69.92,"Highest Salary":1238.23,"Infant Survival Rate":978,"Alcohol Consumption Rate":0.01,"Life Expectancy":51,"Netflix (USD/month)":null,"Women Safety Index":0.543,"Average Winter Temperature":26.811758,"Average Summer Temperature":27.633963,"Population":8605718,"Energy Per Capita":492.598,"% of Power from Fossil Fuels":9.524,"% of Power from Nuclear":0,"% of Power from Renewables":90.476,"% of Agricultural Land":54.710446107,"% of Forest Land":34.8455250762,"Territory":72180,"Average Rainfall":2526,"Corruption":0.1473762393,"Wheat Production (tonnes)":127106.8,"Rye Production (tonnes)":49816.2,"Potatoes Production (tonnes)":65460290,"Meat, chicken Production (tonnes)":688538.1,"Avocados Production (tonnes)":17496,"Petrol Price (USD/liter)":1.37,"Daily Oil Consumption (Barrels)":6500,"CO2 Emissions (ton per capita)":0.115189573},{"Country":"Lesotho","Country_clean":"lesotho","Region":"Sub-Saharan Africa","Happiness":3.186,"Median Salary":540.54,"Average Salary":625.33,"Lowest Salary":157.39,"Highest Salary":2776.89,"Infant Survival Rate":996,"Alcohol Consumption Rate":0.01,"Life Expectancy":53.7,"Netflix (USD/month)":null,"Women Safety Index":0.605,"Average Winter Temperature":16.68572,"Average Summer Temperature":18.73354,"Population":2305825,"Energy Per Capita":2132.814,"% of Power from Fossil Fuels":0,"% of Power from Nuclear":0,"% of Power from Renewables":100,"% of Agricultural Land":80.1383399209,"% of Forest Land":1.1370223979,"Territory":30360,"Average Rainfall":788,"Corruption":0.1740706116,"Wheat Production (tonnes)":18781986,"Rye Production (tonnes)":10563.96,"Potatoes Production (tonnes)":285000,"Meat, chicken Production (tonnes)":1068500,"Avocados Production (tonnes)":1664340,"Petrol Price (USD/liter)":1.5,"Daily Oil Consumption (Barrels)":5001,"CO2 Emissions (ton per capita)":0.362307409},{"Country":"Lebanon","Country_clean":"lebanon","Region":"Middle East and North Africa","Happiness":2.707,"Median Salary":753.33,"Average Salary":873.33,"Lowest Salary":219.33,"Highest Salary":3873.33,"Infant Survival Rate":999,"Alcohol Consumption Rate":1.32,"Life Expectancy":74.9,"Netflix (USD/month)":null,"Women Safety Index":0.595,"Average Winter Temperature":9.020683,"Average Summer Temperature":9.587217,"Population":5489739,"Energy Per Capita":18831.662,"% of Power from Fossil Fuels":94.509,"% of Power from Nuclear":0,"% of Power from Renewables":5.491,"% of Agricultural Land":66.4027370479,"% of Forest Land":14.0694037146,"Territory":10230,"Average Rainfall":661,"Corruption":0.1708792597,"Wheat Production (tonnes)":239916,"Rye Production (tonnes)":714111.8,"Potatoes Production (tonnes)":200810,"Meat, chicken Production (tonnes)":541292,"Avocados Production (tonnes)":195067.11,"Petrol Price (USD/liter)":1.43,"Daily Oil Consumption (Barrels)":153000,"CO2 Emissions (ton per capita)":4.076894274},{"Country":"Afghanistan","Country_clean":"afghanistan","Region":"South Asia","Happiness":1.721,"Median Salary":853.74,"Average Salary":1001.15,"Lowest Salary":252.53,"Highest Salary":4460.97,"Infant Survival Rate":938,"Alcohol Consumption Rate":0.01,"Life Expectancy":65,"Netflix (USD/month)":null,"Women Safety Index":0.286,"Average Winter Temperature":0.047207996,"Average Summer Temperature":3.3000636,"Population":41128771,"Energy Per Capita":676.696,"% of Power from Fossil Fuels":15.663,"% of Power from Nuclear":0,"% of Power from Renewables":84.337,"% of Agricultural Land":58.7415482269,"% of Forest Land":1.8527819941,"Territory":652230,"Average Rainfall":327,"Corruption":0.1827608198,"Wheat Production (tonnes)":3900000,"Rye Production (tonnes)":96473.03,"Potatoes Production (tonnes)":864772,"Meat, chicken Production (tonnes)":28029.23,"Avocados Production (tonnes)":1069854.4,"Petrol Price (USD/liter)":0.96,"Daily Oil Consumption (Barrels)":35000,"CO2 Emissions (ton per capita)":0.159824372}]'),e0=[{metric:"Median Salary",weight_signed:.6558076975,weight_magnitude:.6558076975},{metric:"Average Salary",weight_signed:.6523718342,weight_magnitude:.6523718342},{metric:"Lowest Salary",weight_signed:.6485308062,weight_magnitude:.6485308062},{metric:"Highest Salary",weight_signed:.652181275,weight_magnitude:.652181275},{metric:"Infant Survival Rate",weight_signed:.2322032702,weight_magnitude:.2322032702},{metric:"Alcohol Consumption Rate",weight_signed:.5697201294,weight_magnitude:.5697201294},{metric:"Life Expectancy",weight_signed:.7416090513,weight_magnitude:.7416090513},{metric:"Netflix (USD/month)",weight_signed:.68233766,weight_magnitude:.68233766},{metric:"Women Safety Index",weight_signed:.7713289613,weight_magnitude:.7713289613},{metric:"Average Winter Temperature",weight_signed:-.4293739779,weight_magnitude:.4293739779},{metric:"Average Summer Temperature",weight_signed:-.4283984286,weight_magnitude:.4283984286},{metric:"Population",weight_signed:-.0219677181,weight_magnitude:.0219677181},{metric:"Energy Per Capita",weight_signed:.5801967755,weight_magnitude:.5801967755},{metric:"% of Power from Fossil Fuels",weight_signed:-.1362477334,weight_magnitude:.1362477334},{metric:"% of Power from Nuclear",weight_signed:.2760217511,weight_magnitude:.2760217511},{metric:"% of Power from Renewables",weight_signed:.0225333231,weight_magnitude:.0225333231},{metric:"% of Agricultural Land",weight_signed:-.2509434126,weight_magnitude:.2509434126},{metric:"% of Forest Land",weight_signed:.1552674975,weight_magnitude:.1552674975},{metric:"Territory",weight_signed:.1241759612,weight_magnitude:.1241759612},{metric:"Average Rainfall",weight_signed:.0560770183,weight_magnitude:.0560770183},{metric:"Corruption",weight_signed:.0494015891,weight_magnitude:.0494015891},{metric:"Wheat Production (tonnes)",weight_signed:.0991311381,weight_magnitude:.0991311381},{metric:"Rye Production (tonnes)",weight_signed:-.0566746652,weight_magnitude:.0566746652},{metric:"Potatoes Production (tonnes)",weight_signed:-.1034607974,weight_magnitude:.1034607974},{metric:"Meat, chicken Production (tonnes)",weight_signed:.0025616182,weight_magnitude:.0025616182},{metric:"Avocados Production (tonnes)",weight_signed:-.0224689248,weight_magnitude:.0224689248},{metric:"Petrol Price (USD/liter)",weight_signed:.4486226673,weight_magnitude:.4486226673},{metric:"Daily Oil Consumption (Barrels)",weight_signed:.1522584044,weight_magnitude:.1522584044},{metric:"CO2 Emissions (ton per capita)",weight_signed:.5727786876,weight_magnitude:.5727786876}];function Ug(b,R){if(typeof b=="function")return b(R);b!=null&&(b.current=R)}function vy(...b){return R=>{let L=!1;const D=b.map(j=>{const G=Ug(j,R);return!L&&typeof G=="function"&&(L=!0),G});if(L)return()=>{for(let j=0;j<D.length;j++){const G=D[j];typeof G=="function"?G():Ug(b[j],null)}}}}function el(...b){return Ee.useCallback(vy(...b),b)}function Xf(b){const R=n0(b),L=Ee.forwardRef((D,j)=>{const{children:G,...A}=D,c=Ee.Children.toArray(G),H=c.find(i0);if(H){const Y=H.props.children,he=c.map(we=>we===H?Ee.Children.count(Y)>1?Ee.Children.only(null):Ee.isValidElement(Y)?Y.props.children:null:we);return _e.jsx(R,{...A,ref:j,children:Ee.isValidElement(Y)?Ee.cloneElement(Y,void 0,he):null})}return _e.jsx(R,{...A,ref:j,children:G})});return L.displayName=`${b}.Slot`,L}var t0=Xf("Slot");function n0(b){const R=Ee.forwardRef((L,D)=>{const{children:j,...G}=L;if(Ee.isValidElement(j)){const A=o0(j),c=a0(G,j.props);return j.type!==Ee.Fragment&&(c.ref=D?vy(D,A):A),Ee.cloneElement(j,c)}return Ee.Children.count(j)>1?Ee.Children.only(null):null});return R.displayName=`${b}.SlotClone`,R}var r0=Symbol("radix.slottable");function i0(b){return Ee.isValidElement(b)&&typeof b.type=="function"&&"__radixId"in b.type&&b.type.__radixId===r0}function a0(b,R){const L={...R};for(const D in R){const j=b[D],G=R[D];/^on[A-Z]/.test(D)?j&&G?L[D]=(...c)=>{const H=G(...c);return j(...c),H}:j&&(L[D]=j):D==="style"?L[D]={...j,...G}:D==="className"&&(L[D]=[j,G].filter(Boolean).join(" "))}return{...b,...L}}function o0(b){let R=Object.getOwnPropertyDescriptor(b.props,"ref")?.get,L=R&&"isReactWarning"in R&&R.isReactWarning;return L?b.ref:(R=Object.getOwnPropertyDescriptor(b,"ref")?.get,L=R&&"isReactWarning"in R&&R.isReactWarning,L?b.props.ref:b.props.ref||b.ref)}function xy(b){var R,L,D="";if(typeof b=="string"||typeof b=="number")D+=b;else if(typeof b=="object")if(Array.isArray(b)){var j=b.length;for(R=0;R<j;R++)b[R]&&(L=xy(b[R]))&&(D&&(D+=" "),D+=L)}else for(L in b)b[L]&&(D&&(D+=" "),D+=L);return D}function by(){for(var b,R,L=0,D="",j=arguments.length;L<j;L++)(b=arguments[L])&&(R=xy(b))&&(D&&(D+=" "),D+=R);return D}const jg=b=>typeof b=="boolean"?`${b}`:b===0?"0":b,Vg=by,s0=(b,R)=>L=>{var D;if(R?.variants==null)return Vg(b,L?.class,L?.className);const{variants:j,defaultVariants:G}=R,A=Object.keys(j).map(Y=>{const he=L?.[Y],we=G?.[Y];if(he===null)return null;const ge=jg(he)||jg(we);return j[Y][ge]}),c=L&&Object.entries(L).reduce((Y,he)=>{let[we,ge]=he;return ge===void 0||(Y[we]=ge),Y},{}),H=R==null||(D=R.compoundVariants)===null||D===void 0?void 0:D.reduce((Y,he)=>{let{class:we,className:ge,...ne}=he;return Object.entries(ne).every(Re=>{let[ye,ze]=Re;return Array.isArray(ze)?ze.includes({...G,...c}[ye]):{...G,...c}[ye]===ze})?[...Y,we,ge]:Y},[]);return Vg(b,A,H,L?.class,L?.className)},dg="-",l0=b=>{const R=u0(b),{conflictingClassGroups:L,conflictingClassGroupModifiers:D}=b;return{getClassGroupId:A=>{const c=A.split(dg);return c[0]===""&&c.length!==1&&c.shift(),wy(c,R)||c0(A)},getConflictingClassGroupIds:(A,c)=>{const H=L[A]||[];return c&&D[A]?[...H,...D[A]]:H}}},wy=(b,R)=>{if(b.length===0)return R.classGroupId;const L=b[0],D=R.nextPart.get(L),j=D?wy(b.slice(1),D):void 0;if(j)return j;if(R.validators.length===0)return;const G=b.join(dg);return R.validators.find(({validator:A})=>A(G))?.classGroupId},Hg=/^\[(.+)\]$/,c0=b=>{if(Hg.test(b)){const R=Hg.exec(b)[1],L=R?.substring(0,R.indexOf(":"));if(L)return"arbitrary.."+L}},u0=b=>{const{theme:R,classGroups:L}=b,D={nextPart:new Map,validators:[]};for(const j in L)ng(L[j],D,j,R);return D},ng=(b,R,L,D)=>{b.forEach(j=>{if(typeof j=="string"){const G=j===""?R:Gg(R,j);G.classGroupId=L;return}if(typeof j=="function"){if(h0(j)){ng(j(D),R,L,D);return}R.validators.push({validator:j,classGroupId:L});return}Object.entries(j).forEach(([G,A])=>{ng(A,Gg(R,G),L,D)})})},Gg=(b,R)=>{let L=b;return R.split(dg).forEach(D=>{L.nextPart.has(D)||L.nextPart.set(D,{nextPart:new Map,validators:[]}),L=L.nextPart.get(D)}),L},h0=b=>b.isThemeGetter,d0=b=>{if(b<1)return{get:()=>{},set:()=>{}};let R=0,L=new Map,D=new Map;const j=(G,A)=>{L.set(G,A),R++,R>b&&(R=0,D=L,L=new Map)};return{get(G){let A=L.get(G);if(A!==void 0)return A;if((A=D.get(G))!==void 0)return j(G,A),A},set(G,A){L.has(G)?L.set(G,A):j(G,A)}}},rg="!",ig=":",f0=ig.length,p0=b=>{const{prefix:R,experimentalParseClassName:L}=b;let D=j=>{const G=[];let A=0,c=0,H=0,Y;for(let Re=0;Re<j.length;Re++){let ye=j[Re];if(A===0&&c===0){if(ye===ig){G.push(j.slice(H,Re)),H=Re+f0;continue}if(ye==="/"){Y=Re;continue}}ye==="["?A++:ye==="]"?A--:ye==="("?c++:ye===")"&&c--}const he=G.length===0?j:j.substring(H),we=m0(he),ge=we!==he,ne=Y&&Y>H?Y-H:void 0;return{modifiers:G,hasImportantModifier:ge,baseClassName:we,maybePostfixModifierPosition:ne}};if(R){const j=R+ig,G=D;D=A=>A.startsWith(j)?G(A.substring(j.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:A,maybePostfixModifierPosition:void 0}}if(L){const j=D;D=G=>L({className:G,parseClassName:j})}return D},m0=b=>b.endsWith(rg)?b.substring(0,b.length-1):b.startsWith(rg)?b.substring(1):b,g0=b=>{const R=Object.fromEntries(b.orderSensitiveModifiers.map(D=>[D,!0]));return D=>{if(D.length<=1)return D;const j=[];let G=[];return D.forEach(A=>{A[0]==="["||R[A]?(j.push(...G.sort(),A),G=[]):G.push(A)}),j.push(...G.sort()),j}},y0=b=>({cache:d0(b.cacheSize),parseClassName:p0(b),sortModifiers:g0(b),...l0(b)}),_0=/\s+/,v0=(b,R)=>{const{parseClassName:L,getClassGroupId:D,getConflictingClassGroupIds:j,sortModifiers:G}=R,A=[],c=b.trim().split(_0);let H="";for(let Y=c.length-1;Y>=0;Y-=1){const he=c[Y],{isExternal:we,modifiers:ge,hasImportantModifier:ne,baseClassName:Re,maybePostfixModifierPosition:ye}=L(he);if(we){H=he+(H.length>0?" "+H:H);continue}let ze=!!ye,De=D(ze?Re.substring(0,ye):Re);if(!De){if(!ze){H=he+(H.length>0?" "+H:H);continue}if(De=D(Re),!De){H=he+(H.length>0?" "+H:H);continue}ze=!1}const ke=G(ge).join(":"),He=ne?ke+rg:ke,it=He+De;if(A.includes(it))continue;A.push(it);const at=j(De,ze);for(let wt=0;wt<at.length;++wt){const ft=at[wt];A.push(He+ft)}H=he+(H.length>0?" "+H:H)}return H};function x0(){let b=0,R,L,D="";for(;b<arguments.length;)(R=arguments[b++])&&(L=Sy(R))&&(D&&(D+=" "),D+=L);return D}const Sy=b=>{if(typeof b=="string")return b;let R,L="";for(let D=0;D<b.length;D++)b[D]&&(R=Sy(b[D]))&&(L&&(L+=" "),L+=R);return L};function b0(b,...R){let L,D,j,G=A;function A(H){const Y=R.reduce((he,we)=>we(he),b());return L=y0(Y),D=L.cache.get,j=L.cache.set,G=c,c(H)}function c(H){const Y=D(H);if(Y)return Y;const he=v0(H,L);return j(H,he),he}return function(){return G(x0.apply(null,arguments))}}const qi=b=>{const R=L=>L[b]||[];return R.isThemeGetter=!0,R},Py=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Cy=/^\((?:(\w[\w-]*):)?(.+)\)$/i,w0=/^\d+\/\d+$/,S0=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,P0=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,C0=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,T0=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,A0=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Cd=b=>w0.test(b),Tn=b=>!!b&&!Number.isNaN(Number(b)),Ru=b=>!!b&&Number.isInteger(Number(b)),Zm=b=>b.endsWith("%")&&Tn(b.slice(0,-1)),Fc=b=>S0.test(b),E0=()=>!0,M0=b=>P0.test(b)&&!C0.test(b),Ty=()=>!1,R0=b=>T0.test(b),D0=b=>A0.test(b),I0=b=>!kt(b)&&!Ot(b),z0=b=>zd(b,My,Ty),kt=b=>Py.test(b),Oh=b=>zd(b,Ry,M0),qm=b=>zd(b,F0,Tn),Zg=b=>zd(b,Ay,Ty),L0=b=>zd(b,Ey,D0),Jp=b=>zd(b,Dy,R0),Ot=b=>Cy.test(b),Zf=b=>Ld(b,Ry),k0=b=>Ld(b,N0),qg=b=>Ld(b,Ay),O0=b=>Ld(b,My),B0=b=>Ld(b,Ey),em=b=>Ld(b,Dy,!0),zd=(b,R,L)=>{const D=Py.exec(b);return D?D[1]?R(D[1]):L(D[2]):!1},Ld=(b,R,L=!1)=>{const D=Cy.exec(b);return D?D[1]?R(D[1]):L:!1},Ay=b=>b==="position"||b==="percentage",Ey=b=>b==="image"||b==="url",My=b=>b==="length"||b==="size"||b==="bg-size",Ry=b=>b==="length",F0=b=>b==="number",N0=b=>b==="family-name",Dy=b=>b==="shadow",U0=()=>{const b=qi("color"),R=qi("font"),L=qi("text"),D=qi("font-weight"),j=qi("tracking"),G=qi("leading"),A=qi("breakpoint"),c=qi("container"),H=qi("spacing"),Y=qi("radius"),he=qi("shadow"),we=qi("inset-shadow"),ge=qi("text-shadow"),ne=qi("drop-shadow"),Re=qi("blur"),ye=qi("perspective"),ze=qi("aspect"),De=qi("ease"),ke=qi("animate"),He=()=>["auto","avoid","all","avoid-page","page","left","right","column"],it=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],at=()=>[...it(),Ot,kt],wt=()=>["auto","hidden","clip","visible","scroll"],ft=()=>["auto","contain","none"],ot=()=>[Ot,kt,H],Bt=()=>[Cd,"full","auto",...ot()],cn=()=>[Ru,"none","subgrid",Ot,kt],nn=()=>["auto",{span:["full",Ru,Ot,kt]},Ru,Ot,kt],on=()=>[Ru,"auto",Ot,kt],jn=()=>["auto","min","max","fr",Ot,kt],er=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],mn=()=>["start","end","center","stretch","center-safe","end-safe"],We=()=>["auto",...ot()],mt=()=>[Cd,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...ot()],rt=()=>[b,Ot,kt],Et=()=>[...it(),qg,Zg,{position:[Ot,kt]}],ve=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Xe=()=>["auto","cover","contain",O0,z0,{size:[Ot,kt]}],vt=()=>[Zm,Zf,Oh],st=()=>["","none","full",Y,Ot,kt],xt=()=>["",Tn,Zf,Oh],Kt=()=>["solid","dashed","dotted","double"],It=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Zt=()=>[Tn,Zm,qg,Zg],Ht=()=>["","none",Re,Ot,kt],En=()=>["none",Tn,Ot,kt],tr=()=>["none",Tn,Ot,kt],xn=()=>[Tn,Ot,kt],St=()=>[Cd,"full",...ot()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Fc],breakpoint:[Fc],color:[E0],container:[Fc],"drop-shadow":[Fc],ease:["in","out","in-out"],font:[I0],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Fc],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Fc],shadow:[Fc],spacing:["px",Tn],text:[Fc],"text-shadow":[Fc],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Cd,kt,Ot,ze]}],container:["container"],columns:[{columns:[Tn,kt,Ot,c]}],"break-after":[{"break-after":He()}],"break-before":[{"break-before":He()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:at()}],overflow:[{overflow:wt()}],"overflow-x":[{"overflow-x":wt()}],"overflow-y":[{"overflow-y":wt()}],overscroll:[{overscroll:ft()}],"overscroll-x":[{"overscroll-x":ft()}],"overscroll-y":[{"overscroll-y":ft()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Bt()}],"inset-x":[{"inset-x":Bt()}],"inset-y":[{"inset-y":Bt()}],start:[{start:Bt()}],end:[{end:Bt()}],top:[{top:Bt()}],right:[{right:Bt()}],bottom:[{bottom:Bt()}],left:[{left:Bt()}],visibility:["visible","invisible","collapse"],z:[{z:[Ru,"auto",Ot,kt]}],basis:[{basis:[Cd,"full","auto",c,...ot()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Tn,Cd,"auto","initial","none",kt]}],grow:[{grow:["",Tn,Ot,kt]}],shrink:[{shrink:["",Tn,Ot,kt]}],order:[{order:[Ru,"first","last","none",Ot,kt]}],"grid-cols":[{"grid-cols":cn()}],"col-start-end":[{col:nn()}],"col-start":[{"col-start":on()}],"col-end":[{"col-end":on()}],"grid-rows":[{"grid-rows":cn()}],"row-start-end":[{row:nn()}],"row-start":[{"row-start":on()}],"row-end":[{"row-end":on()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":jn()}],"auto-rows":[{"auto-rows":jn()}],gap:[{gap:ot()}],"gap-x":[{"gap-x":ot()}],"gap-y":[{"gap-y":ot()}],"justify-content":[{justify:[...er(),"normal"]}],"justify-items":[{"justify-items":[...mn(),"normal"]}],"justify-self":[{"justify-self":["auto",...mn()]}],"align-content":[{content:["normal",...er()]}],"align-items":[{items:[...mn(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...mn(),{baseline:["","last"]}]}],"place-content":[{"place-content":er()}],"place-items":[{"place-items":[...mn(),"baseline"]}],"place-self":[{"place-self":["auto",...mn()]}],p:[{p:ot()}],px:[{px:ot()}],py:[{py:ot()}],ps:[{ps:ot()}],pe:[{pe:ot()}],pt:[{pt:ot()}],pr:[{pr:ot()}],pb:[{pb:ot()}],pl:[{pl:ot()}],m:[{m:We()}],mx:[{mx:We()}],my:[{my:We()}],ms:[{ms:We()}],me:[{me:We()}],mt:[{mt:We()}],mr:[{mr:We()}],mb:[{mb:We()}],ml:[{ml:We()}],"space-x":[{"space-x":ot()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":ot()}],"space-y-reverse":["space-y-reverse"],size:[{size:mt()}],w:[{w:[c,"screen",...mt()]}],"min-w":[{"min-w":[c,"screen","none",...mt()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[A]},...mt()]}],h:[{h:["screen","lh",...mt()]}],"min-h":[{"min-h":["screen","lh","none",...mt()]}],"max-h":[{"max-h":["screen","lh",...mt()]}],"font-size":[{text:["base",L,Zf,Oh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[D,Ot,qm]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Zm,kt]}],"font-family":[{font:[k0,kt,R]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[j,Ot,kt]}],"line-clamp":[{"line-clamp":[Tn,"none",Ot,qm]}],leading:[{leading:[G,...ot()]}],"list-image":[{"list-image":["none",Ot,kt]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ot,kt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:rt()}],"text-color":[{text:rt()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Kt(),"wavy"]}],"text-decoration-thickness":[{decoration:[Tn,"from-font","auto",Ot,Oh]}],"text-decoration-color":[{decoration:rt()}],"underline-offset":[{"underline-offset":[Tn,"auto",Ot,kt]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ot()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ot,kt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ot,kt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Et()}],"bg-repeat":[{bg:ve()}],"bg-size":[{bg:Xe()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Ru,Ot,kt],radial:["",Ot,kt],conic:[Ru,Ot,kt]},B0,L0]}],"bg-color":[{bg:rt()}],"gradient-from-pos":[{from:vt()}],"gradient-via-pos":[{via:vt()}],"gradient-to-pos":[{to:vt()}],"gradient-from":[{from:rt()}],"gradient-via":[{via:rt()}],"gradient-to":[{to:rt()}],rounded:[{rounded:st()}],"rounded-s":[{"rounded-s":st()}],"rounded-e":[{"rounded-e":st()}],"rounded-t":[{"rounded-t":st()}],"rounded-r":[{"rounded-r":st()}],"rounded-b":[{"rounded-b":st()}],"rounded-l":[{"rounded-l":st()}],"rounded-ss":[{"rounded-ss":st()}],"rounded-se":[{"rounded-se":st()}],"rounded-ee":[{"rounded-ee":st()}],"rounded-es":[{"rounded-es":st()}],"rounded-tl":[{"rounded-tl":st()}],"rounded-tr":[{"rounded-tr":st()}],"rounded-br":[{"rounded-br":st()}],"rounded-bl":[{"rounded-bl":st()}],"border-w":[{border:xt()}],"border-w-x":[{"border-x":xt()}],"border-w-y":[{"border-y":xt()}],"border-w-s":[{"border-s":xt()}],"border-w-e":[{"border-e":xt()}],"border-w-t":[{"border-t":xt()}],"border-w-r":[{"border-r":xt()}],"border-w-b":[{"border-b":xt()}],"border-w-l":[{"border-l":xt()}],"divide-x":[{"divide-x":xt()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":xt()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Kt(),"hidden","none"]}],"divide-style":[{divide:[...Kt(),"hidden","none"]}],"border-color":[{border:rt()}],"border-color-x":[{"border-x":rt()}],"border-color-y":[{"border-y":rt()}],"border-color-s":[{"border-s":rt()}],"border-color-e":[{"border-e":rt()}],"border-color-t":[{"border-t":rt()}],"border-color-r":[{"border-r":rt()}],"border-color-b":[{"border-b":rt()}],"border-color-l":[{"border-l":rt()}],"divide-color":[{divide:rt()}],"outline-style":[{outline:[...Kt(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Tn,Ot,kt]}],"outline-w":[{outline:["",Tn,Zf,Oh]}],"outline-color":[{outline:rt()}],shadow:[{shadow:["","none",he,em,Jp]}],"shadow-color":[{shadow:rt()}],"inset-shadow":[{"inset-shadow":["none",we,em,Jp]}],"inset-shadow-color":[{"inset-shadow":rt()}],"ring-w":[{ring:xt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:rt()}],"ring-offset-w":[{"ring-offset":[Tn,Oh]}],"ring-offset-color":[{"ring-offset":rt()}],"inset-ring-w":[{"inset-ring":xt()}],"inset-ring-color":[{"inset-ring":rt()}],"text-shadow":[{"text-shadow":["none",ge,em,Jp]}],"text-shadow-color":[{"text-shadow":rt()}],opacity:[{opacity:[Tn,Ot,kt]}],"mix-blend":[{"mix-blend":[...It(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":It()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Tn]}],"mask-image-linear-from-pos":[{"mask-linear-from":Zt()}],"mask-image-linear-to-pos":[{"mask-linear-to":Zt()}],"mask-image-linear-from-color":[{"mask-linear-from":rt()}],"mask-image-linear-to-color":[{"mask-linear-to":rt()}],"mask-image-t-from-pos":[{"mask-t-from":Zt()}],"mask-image-t-to-pos":[{"mask-t-to":Zt()}],"mask-image-t-from-color":[{"mask-t-from":rt()}],"mask-image-t-to-color":[{"mask-t-to":rt()}],"mask-image-r-from-pos":[{"mask-r-from":Zt()}],"mask-image-r-to-pos":[{"mask-r-to":Zt()}],"mask-image-r-from-color":[{"mask-r-from":rt()}],"mask-image-r-to-color":[{"mask-r-to":rt()}],"mask-image-b-from-pos":[{"mask-b-from":Zt()}],"mask-image-b-to-pos":[{"mask-b-to":Zt()}],"mask-image-b-from-color":[{"mask-b-from":rt()}],"mask-image-b-to-color":[{"mask-b-to":rt()}],"mask-image-l-from-pos":[{"mask-l-from":Zt()}],"mask-image-l-to-pos":[{"mask-l-to":Zt()}],"mask-image-l-from-color":[{"mask-l-from":rt()}],"mask-image-l-to-color":[{"mask-l-to":rt()}],"mask-image-x-from-pos":[{"mask-x-from":Zt()}],"mask-image-x-to-pos":[{"mask-x-to":Zt()}],"mask-image-x-from-color":[{"mask-x-from":rt()}],"mask-image-x-to-color":[{"mask-x-to":rt()}],"mask-image-y-from-pos":[{"mask-y-from":Zt()}],"mask-image-y-to-pos":[{"mask-y-to":Zt()}],"mask-image-y-from-color":[{"mask-y-from":rt()}],"mask-image-y-to-color":[{"mask-y-to":rt()}],"mask-image-radial":[{"mask-radial":[Ot,kt]}],"mask-image-radial-from-pos":[{"mask-radial-from":Zt()}],"mask-image-radial-to-pos":[{"mask-radial-to":Zt()}],"mask-image-radial-from-color":[{"mask-radial-from":rt()}],"mask-image-radial-to-color":[{"mask-radial-to":rt()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":it()}],"mask-image-conic-pos":[{"mask-conic":[Tn]}],"mask-image-conic-from-pos":[{"mask-conic-from":Zt()}],"mask-image-conic-to-pos":[{"mask-conic-to":Zt()}],"mask-image-conic-from-color":[{"mask-conic-from":rt()}],"mask-image-conic-to-color":[{"mask-conic-to":rt()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Et()}],"mask-repeat":[{mask:ve()}],"mask-size":[{mask:Xe()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ot,kt]}],filter:[{filter:["","none",Ot,kt]}],blur:[{blur:Ht()}],brightness:[{brightness:[Tn,Ot,kt]}],contrast:[{contrast:[Tn,Ot,kt]}],"drop-shadow":[{"drop-shadow":["","none",ne,em,Jp]}],"drop-shadow-color":[{"drop-shadow":rt()}],grayscale:[{grayscale:["",Tn,Ot,kt]}],"hue-rotate":[{"hue-rotate":[Tn,Ot,kt]}],invert:[{invert:["",Tn,Ot,kt]}],saturate:[{saturate:[Tn,Ot,kt]}],sepia:[{sepia:["",Tn,Ot,kt]}],"backdrop-filter":[{"backdrop-filter":["","none",Ot,kt]}],"backdrop-blur":[{"backdrop-blur":Ht()}],"backdrop-brightness":[{"backdrop-brightness":[Tn,Ot,kt]}],"backdrop-contrast":[{"backdrop-contrast":[Tn,Ot,kt]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Tn,Ot,kt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Tn,Ot,kt]}],"backdrop-invert":[{"backdrop-invert":["",Tn,Ot,kt]}],"backdrop-opacity":[{"backdrop-opacity":[Tn,Ot,kt]}],"backdrop-saturate":[{"backdrop-saturate":[Tn,Ot,kt]}],"backdrop-sepia":[{"backdrop-sepia":["",Tn,Ot,kt]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":ot()}],"border-spacing-x":[{"border-spacing-x":ot()}],"border-spacing-y":[{"border-spacing-y":ot()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ot,kt]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Tn,"initial",Ot,kt]}],ease:[{ease:["linear","initial",De,Ot,kt]}],delay:[{delay:[Tn,Ot,kt]}],animate:[{animate:["none",ke,Ot,kt]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[ye,Ot,kt]}],"perspective-origin":[{"perspective-origin":at()}],rotate:[{rotate:En()}],"rotate-x":[{"rotate-x":En()}],"rotate-y":[{"rotate-y":En()}],"rotate-z":[{"rotate-z":En()}],scale:[{scale:tr()}],"scale-x":[{"scale-x":tr()}],"scale-y":[{"scale-y":tr()}],"scale-z":[{"scale-z":tr()}],"scale-3d":["scale-3d"],skew:[{skew:xn()}],"skew-x":[{"skew-x":xn()}],"skew-y":[{"skew-y":xn()}],transform:[{transform:[Ot,kt,"","none","gpu","cpu"]}],"transform-origin":[{origin:at()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:St()}],"translate-x":[{"translate-x":St()}],"translate-y":[{"translate-y":St()}],"translate-z":[{"translate-z":St()}],"translate-none":["translate-none"],accent:[{accent:rt()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:rt()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ot,kt]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ot()}],"scroll-mx":[{"scroll-mx":ot()}],"scroll-my":[{"scroll-my":ot()}],"scroll-ms":[{"scroll-ms":ot()}],"scroll-me":[{"scroll-me":ot()}],"scroll-mt":[{"scroll-mt":ot()}],"scroll-mr":[{"scroll-mr":ot()}],"scroll-mb":[{"scroll-mb":ot()}],"scroll-ml":[{"scroll-ml":ot()}],"scroll-p":[{"scroll-p":ot()}],"scroll-px":[{"scroll-px":ot()}],"scroll-py":[{"scroll-py":ot()}],"scroll-ps":[{"scroll-ps":ot()}],"scroll-pe":[{"scroll-pe":ot()}],"scroll-pt":[{"scroll-pt":ot()}],"scroll-pr":[{"scroll-pr":ot()}],"scroll-pb":[{"scroll-pb":ot()}],"scroll-pl":[{"scroll-pl":ot()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ot,kt]}],fill:[{fill:["none",...rt()]}],"stroke-w":[{stroke:[Tn,Zf,Oh,qm]}],stroke:[{stroke:["none",...rt()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},j0=b0(U0);function yi(...b){return j0(by(b))}const V0=s0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Yf({className:b,variant:R,size:L,asChild:D=!1,...j}){const G=D?t0:"button";return _e.jsx(G,{"data-slot":"button",className:yi(V0({variant:R,size:L,className:b})),...j})}function H0({className:b,type:R,...L}){return _e.jsx("input",{type:R,"data-slot":"input",className:yi("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",b),...L})}var cm={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.7.3/LICENSE.txt
 */var G0=cm.exports,Wg;function Z0(){return Wg||(Wg=1,(function(b,R){(function(L,D){b.exports=D()})(G0,(function(){var L={},D={};function j(A,c,H){if(D[A]=H,A==="index"){var Y="var sharedModule = {}; ("+D.shared+")(sharedModule); ("+D.worker+")(sharedModule);",he={};return D.shared(he),D.index(L,he),typeof window<"u"&&L.setWorkerUrl(window.URL.createObjectURL(new Blob([Y],{type:"text/javascript"}))),L}}j("shared",["exports"],(function(A){function c(i,t,r,s){return new(r||(r=Promise))((function(h,m){function y(C){try{w(s.next(C))}catch(M){m(M)}}function v(C){try{w(s.throw(C))}catch(M){m(M)}}function w(C){var M;C.done?h(C.value):(M=C.value,M instanceof r?M:new r((function(z){z(M)}))).then(y,v)}w((s=s.apply(i,t||[])).next())}))}function H(i,t){this.x=i,this.y=t}function Y(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var he,we;typeof SuppressedError=="function"&&SuppressedError,H.prototype={clone(){return new H(this.x,this.y)},add(i){return this.clone()._add(i)},sub(i){return this.clone()._sub(i)},multByPoint(i){return this.clone()._multByPoint(i)},divByPoint(i){return this.clone()._divByPoint(i)},mult(i){return this.clone()._mult(i)},div(i){return this.clone()._div(i)},rotate(i){return this.clone()._rotate(i)},rotateAround(i,t){return this.clone()._rotateAround(i,t)},matMult(i){return this.clone()._matMult(i)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(i){return this.x===i.x&&this.y===i.y},dist(i){return Math.sqrt(this.distSqr(i))},distSqr(i){const t=i.x-this.x,r=i.y-this.y;return t*t+r*r},angle(){return Math.atan2(this.y,this.x)},angleTo(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith(i){return this.angleWithSep(i.x,i.y)},angleWithSep(i,t){return Math.atan2(this.x*t-this.y*i,this.x*i+this.y*t)},_matMult(i){const t=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=t,this},_add(i){return this.x+=i.x,this.y+=i.y,this},_sub(i){return this.x-=i.x,this.y-=i.y,this},_mult(i){return this.x*=i,this.y*=i,this},_div(i){return this.x/=i,this.y/=i,this},_multByPoint(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint(i){return this.x/=i.x,this.y/=i.y,this},_unit(){return this._div(this.mag()),this},_perp(){const i=this.y;return this.y=this.x,this.x=-i,this},_rotate(i){const t=Math.cos(i),r=Math.sin(i),s=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=s,this},_rotateAround(i,t){const r=Math.cos(i),s=Math.sin(i),h=t.y+s*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-s*(this.y-t.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:H},H.convert=function(i){if(i instanceof H)return i;if(Array.isArray(i))return new H(+i[0],+i[1]);if(i.x!==void 0&&i.y!==void 0)return new H(+i.x,+i.y);throw new Error("Expected [x, y] or {x, y} point format")};var ge=(function(){if(we)return he;function i(t,r,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=s,this.p2y=h}return we=1,he=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var v=0,w=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<r));h++)t>m?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},he})(),ne=Y(ge);let Re,ye;function ze(){return Re==null&&(Re=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Re}function De(){if(ye==null&&(ye=!1,ze())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let s=0;s<25;s++){const h=4*s;t.fillStyle=`rgb(${h},${h+1},${h+2})`,t.fillRect(s%5,Math.floor(s/5),1,1)}const r=t.getImageData(0,0,5,5).data;for(let s=0;s<100;s++)if(s%4!=3&&r[s]!==s){ye=!0;break}}}return ye||!1}var ke=1e-6,He=typeof Float32Array<"u"?Float32Array:Array;function it(){var i=new He(9);return He!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function at(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function wt(){var i=new He(3);return He!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function ft(i){var t=i[0],r=i[1],s=i[2];return Math.sqrt(t*t+r*r+s*s)}function ot(i,t,r){var s=new He(3);return s[0]=i,s[1]=t,s[2]=r,s}function Bt(i,t,r){return i[0]=t[0]+r[0],i[1]=t[1]+r[1],i[2]=t[2]+r[2],i}function cn(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i}function nn(i,t,r){var s=t[0],h=t[1],m=t[2],y=r[0],v=r[1],w=r[2];return i[0]=h*w-m*v,i[1]=m*y-s*w,i[2]=s*v-h*y,i}var on,jn=ft;function er(i,t,r){var s=t[0],h=t[1],m=t[2],y=t[3];return i[0]=r[0]*s+r[4]*h+r[8]*m+r[12]*y,i[1]=r[1]*s+r[5]*h+r[9]*m+r[13]*y,i[2]=r[2]*s+r[6]*h+r[10]*m+r[14]*y,i[3]=r[3]*s+r[7]*h+r[11]*m+r[15]*y,i}function mn(){var i=new He(4);return He!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function We(i,t,r,s){var h=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"zyx",m=Math.PI/360;t*=m,s*=m,r*=m;var y=Math.sin(t),v=Math.cos(t),w=Math.sin(r),C=Math.cos(r),M=Math.sin(s),z=Math.cos(s);switch(h){case"xyz":i[0]=y*C*z+v*w*M,i[1]=v*w*z-y*C*M,i[2]=v*C*M+y*w*z,i[3]=v*C*z-y*w*M;break;case"xzy":i[0]=y*C*z-v*w*M,i[1]=v*w*z-y*C*M,i[2]=v*C*M+y*w*z,i[3]=v*C*z+y*w*M;break;case"yxz":i[0]=y*C*z+v*w*M,i[1]=v*w*z-y*C*M,i[2]=v*C*M-y*w*z,i[3]=v*C*z+y*w*M;break;case"yzx":i[0]=y*C*z+v*w*M,i[1]=v*w*z+y*C*M,i[2]=v*C*M-y*w*z,i[3]=v*C*z-y*w*M;break;case"zxy":i[0]=y*C*z-v*w*M,i[1]=v*w*z+y*C*M,i[2]=v*C*M+y*w*z,i[3]=v*C*z-y*w*M;break;case"zyx":i[0]=y*C*z-v*w*M,i[1]=v*w*z+y*C*M,i[2]=v*C*M-y*w*z,i[3]=v*C*z+y*w*M;break;default:throw new Error("Unknown angle order "+h)}return i}function mt(){var i=new He(2);return He!=Float32Array&&(i[0]=0,i[1]=0),i}function rt(i,t){var r=new He(2);return r[0]=i,r[1]=t,r}wt(),on=new He(4),He!=Float32Array&&(on[0]=0,on[1]=0,on[2]=0,on[3]=0),wt(),ot(1,0,0),ot(0,1,0),mn(),mn(),it(),mt();const Et=8192;function ve(i,t,r){return t*(Et/(i.tileSize*Math.pow(2,r-i.tileID.overscaledZ)))}function Xe(i,t){return(i%t+t)%t}function vt(i,t,r){return i*(1-r)+t*r}function st(i){if(i<=0)return 0;if(i>=1)return 1;const t=i*i,r=t*i;return 4*(i<.5?r:3*(i-t)+r-.75)}function xt(i,t,r,s){const h=new ne(i,t,r,s);return m=>h.solve(m)}const Kt=xt(.25,.1,.25,1);function It(i,t,r){return Math.min(r,Math.max(t,i))}function Zt(i,t,r){const s=r-t,h=((i-t)%s+s)%s+t;return h===t?r:h}function Ht(i,...t){for(const r of t)for(const s in r)i[s]=r[s];return i}let En=1;function tr(i,t,r){const s={};for(const h in i)s[h]=t.call(this,i[h],h,i);return s}function xn(i,t,r){const s={};for(const h in i)t.call(this,i[h],h,i)&&(s[h]=i[h]);return s}function St(i){return Array.isArray(i)?i.map(St):typeof i=="object"&&i?tr(i,St):i}const qt={};function un(i){qt[i]||(typeof console<"u"&&console.warn(i),qt[i]=!0)}function qn(i,t,r){return(r.y-i.y)*(t.x-i.x)>(t.y-i.y)*(r.x-i.x)}function Ar(i){return typeof WorkerGlobalScope<"u"&&i!==void 0&&i instanceof WorkerGlobalScope}let nr=null;function Kr(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const Br="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Mi(i,t,r,s,h){return c(this,void 0,void 0,(function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(i,{timestamp:0});try{const y=m?.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),w=new Uint8ClampedArray(s*h*4);if(yield m.copyTo(w,(function(C,M,z,B,U){const V=4*Math.max(-M,0),$=(Math.max(0,z)-z)*B*4+V,Q=4*B,re=Math.max(0,M),Te=Math.max(0,z);return{rect:{x:re,y:Te,width:Math.min(C.width,M+B)-re,height:Math.min(C.height,z+U)-Te},layout:[{offset:$,stride:Q}]}})(i,t,r,s,h)),v)for(let C=0;C<w.length;C+=4){const M=w[C];w[C]=w[C+2],w[C+2]=M}return w}finally{m.close()}}))}let oi,ya;function ra(i,t,r,s){return i.addEventListener(t,r,s),{unsubscribe:()=>{i.removeEventListener(t,r,s)}}}function qa(i){return i*Math.PI/180}function Aa(i){return i/Math.PI*180}const Wi={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},gr={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ri="AbortError";function xe(){return new Error(Ri)}const Z={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function q(i){return Z.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}const K="global-dispatcher";class se extends Error{constructor(t,r,s,h){super(`AJAXError: ${r} (${t}): ${s}`),this.status=t,this.statusText=r,this.url=s,this.body=h}}const de=()=>Ar(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,be=function(i,t){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){const s=q(i.url);if(s)return s(i,t);if(Ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:K},t)}if(!(/^file:/.test(r=i.url)||/^file:/.test(de())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return(function(s,h){return c(this,void 0,void 0,(function*(){const m=new Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,cache:s.cache,referrer:de(),signal:h.signal});let y,v;s.type!=="json"||m.headers.has("Accept")||m.headers.set("Accept","application/json");try{y=yield fetch(m)}catch(C){throw new se(0,C.message,s.url,new Blob)}if(!y.ok){const C=yield y.blob();throw new se(y.status,y.statusText,s.url,C)}v=s.type==="arrayBuffer"||s.type==="image"?y.arrayBuffer():s.type==="json"?y.json():y.text();const w=yield v;if(h.signal.aborted)throw xe();return{data:w,cacheControl:y.headers.get("Cache-Control"),expires:y.headers.get("Expires")}}))})(i,t);if(Ar(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:K},t)}var r;return(function(s,h){return new Promise(((m,y)=>{var v;const w=new XMLHttpRequest;w.open(s.method||"GET",s.url,!0),s.type!=="arrayBuffer"&&s.type!=="image"||(w.responseType="arraybuffer");for(const C in s.headers)w.setRequestHeader(C,s.headers[C]);s.type==="json"&&(w.responseType="text",!((v=s.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=s.credentials==="include",w.onerror=()=>{y(new Error(w.statusText))},w.onload=()=>{if(!h.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let C=w.response;if(s.type==="json")try{C=JSON.parse(w.response)}catch(M){return void y(M)}m({data:C,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{const C=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});y(new se(w.status,w.statusText,s.url,C))}},h.signal.addEventListener("abort",(()=>{w.abort(),y(xe())})),w.send(s.body)}))})(i,t)};function Be(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const t=new URL(i),r=window.location;return t.protocol===r.protocol&&t.host===r.host}function Pe(i,t,r){r[i]&&r[i].indexOf(t)!==-1||(r[i]=r[i]||[],r[i].push(t))}function qe(i,t,r){if(r&&r[i]){const s=r[i].indexOf(t);s!==-1&&r[i].splice(s,1)}}class nt{constructor(t,r={}){Ht(this,r),this.type=t}}class Ye extends nt{constructor(t,r={}){super("error",Ht({error:t},r))}}class Pt{on(t,r){return this._listeners=this._listeners||{},Pe(t,r,this._listeners),{unsubscribe:()=>{this.off(t,r)}}}off(t,r){return qe(t,r,this._listeners),qe(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Pe(t,r,this._oneTimeListeners),this):new Promise((s=>this.once(t,s)))}fire(t,r){typeof t=="string"&&(t=new nt(t,r||{}));const s=t.type;if(this.listens(s)){t.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const v of h)v.call(this,t);const m=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const v of m)qe(s,v,this._oneTimeListeners),v.call(this,t);const y=this._eventedParent;y&&(Ht(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(t))}else t instanceof Ye&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var Ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},"font-faces":{type:"array",value:"fontFaces"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Gt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function dn(i,t){const r={};for(const s in i)s!=="ref"&&(r[s]=i[s]);return Gt.forEach((s=>{s in t&&(r[s]=t[s])})),r}function Rt(i,t){if(Array.isArray(i)){if(!Array.isArray(t)||i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(!Rt(i[r],t[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&t!==null){if(typeof t!="object"||Object.keys(i).length!==Object.keys(t).length)return!1;for(const r in i)if(!Rt(i[r],t[r]))return!1;return!0}return i===t}function Wt(i,t){i.push(t)}function In(i,t,r){Wt(r,{command:"addSource",args:[i,t[i]]})}function Fr(i,t,r){Wt(t,{command:"removeSource",args:[i]}),r[i]=!0}function Vr(i,t,r,s){Fr(i,r,s),In(i,t,r)}function Vn(i,t,r){let s;for(s in i[r])if(Object.prototype.hasOwnProperty.call(i[r],s)&&s!=="data"&&!Rt(i[r][s],t[r][s]))return!1;for(s in t[r])if(Object.prototype.hasOwnProperty.call(t[r],s)&&s!=="data"&&!Rt(i[r][s],t[r][s]))return!1;return!0}function Ut(i,t,r,s,h,m){i=i||{},t=t||{};for(const y in i)Object.prototype.hasOwnProperty.call(i,y)&&(Rt(i[y],t[y])||r.push({command:m,args:[s,y,t[y],h]}));for(const y in t)Object.prototype.hasOwnProperty.call(t,y)&&!Object.prototype.hasOwnProperty.call(i,y)&&(Rt(i[y],t[y])||r.push({command:m,args:[s,y,t[y],h]}))}function $t(i){return i.id}function lr(i,t){return i[t.id]=t,i}class lt{constructor(t,r,s,h){this.message=(t?`${t}: `:"")+s,h&&(this.identifier=h),r!=null&&r.__line__&&(this.line=r.__line__)}}function _i(i,...t){for(const r of t)for(const s in r)i[s]=r[s];return i}class yr extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}class po{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[s,h]of r)this.bindings[s]=h}concat(t){return new po(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Wa={kind:"null"},_t={kind:"number"},rn={kind:"string"},Qt={kind:"boolean"},Er={kind:"color"},_a={kind:"projectionDefinition"},cr={kind:"object"},an={kind:"value"},Wl={kind:"collator"},$i={kind:"formatted"},mo={kind:"padding"},$a={kind:"colorArray"},cs={kind:"numberArray"},_r={kind:"resolvedImage"},Nc={kind:"variableAnchorOffsetCollection"};function si(i,t){return{kind:"array",itemType:i,N:t}}function zn(i){if(i.kind==="array"){const t=zn(i.itemType);return typeof i.N=="number"?`array<${t}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${t}>`}return i.kind}const Xa=[Wa,_t,rn,Qt,Er,_a,$i,cr,si(an),mo,cs,$a,_r,Nc];function us(i,t){if(t.kind==="error")return null;if(i.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!us(i.itemType,t.itemType))&&(typeof i.N!="number"||i.N===t.N))return null}else{if(i.kind===t.kind)return null;if(i.kind==="value"){for(const r of Xa)if(!us(r,t))return null}}return`Expected ${zn(i)} but found ${zn(t)} instead.`}function Uc(i,t){return t.some((r=>r.kind===i.kind))}function ia(i,t){return t.some((r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i))}function Ya(i,t){return i.kind==="array"&&t.kind==="array"?i.itemType.kind===t.itemType.kind&&typeof i.N=="number":i.kind===t.kind}const $l=.96422,Nh=.82521,Iu=4/29,li=6/29,zu=3*li*li,kd=li*li*li,jc=Math.PI/180,Uh=180/Math.PI;function rl(i){return(i%=360)<0&&(i+=360),i}function il([i,t,r,s]){let h,m;const y=Xl((.2225045*(i=Xi(i))+.7168786*(t=Xi(t))+.0606169*(r=Xi(r)))/1);i===t&&t===r?h=m=y:(h=Xl((.4360747*i+.3850649*t+.1430804*r)/$l),m=Xl((.0139322*i+.0971045*t+.7141733*r)/Nh));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-m),s]}function Xi(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Xl(i){return i>kd?Math.pow(i,1/3):i/zu+Iu}function hs([i,t,r,s]){let h=(i+16)/116,m=isNaN(t)?h:h+t/500,y=isNaN(r)?h:h-r/200;return h=1*Uo(h),m=$l*Uo(m),y=Nh*Uo(y),[Yl(3.1338561*m-1.6168667*h-.4906146*y),Yl(-.9787684*m+1.9161415*h+.033454*y),Yl(.0719453*m-.2289914*h+1.4052427*y),s]}function Yl(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function Uo(i){return i>li?i*i*i:zu*(i-Iu)}const jh=Object.hasOwn||function(i,t){return Object.prototype.hasOwnProperty.call(i,t)};function ds(i,t){return jh(i,t)?i[t]:void 0}function Ka(i){return parseInt(i.padEnd(2,i),16)/255}function Ea(i,t){return fn(t?i/100:i,0,1)}function fn(i,t,r){return Math.min(Math.max(t,i),r)}function jo(i){return!i.some(Number.isNaN)}const Qa={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function go(i,t,r){return i+r*(t-i)}function fs(i,t,r){return i.map(((s,h)=>go(s,t[h],r)))}class hn{constructor(t,r,s,h=1,m=!0){this.r=t,this.g=r,this.b=s,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[t,r,s,h]))}static parse(t){if(t instanceof hn)return t;if(typeof t!="string")return;const r=(function(s){if((s=s.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=ds(Qa,s);if(h){const[y,v,w]=h;return[y/255,v/255,w/255,1]}if(s.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(s)){const y=s.length<6?1:2;let v=1;return[Ka(s.slice(v,v+=y)),Ka(s.slice(v,v+=y)),Ka(s.slice(v,v+=y)),Ka(s.slice(v,v+y)||"ff")]}if(s.startsWith("rgb")){const y=s.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,w,C,M,z,B,U,V,$,Q,re,Te]=y,ce=[M||" ",U||" ",Q].join("");if(ce==="  "||ce==="  /"||ce===",,"||ce===",,,"){const pe=[C,B,$].join(""),Fe=pe==="%%%"?100:pe===""?255:0;if(Fe){const Ge=[fn(+w/Fe,0,1),fn(+z/Fe,0,1),fn(+V/Fe,0,1),re?Ea(+re,Te):1];if(jo(Ge))return Ge}}return}}const m=s.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,v,w,C,M,z,B,U,V]=m,$=[w||" ",M||" ",B].join("");if($==="  "||$==="  /"||$===",,"||$===",,,"){const Q=[+v,fn(+C,0,100),fn(+z,0,100),U?Ea(+U,V):1];if(jo(Q))return(function([re,Te,ce,pe]){function Fe(Ge){const Je=(Ge+re/30)%12,gt=Te*Math.min(ce,1-ce);return ce-gt*Math.max(-1,Math.min(Je-3,9-Je,1))}return re=rl(re),Te/=100,ce/=100,[Fe(0),Fe(8),Fe(4),pe]})(Q)}}})(t);return r?new hn(...r,!1):void 0}get rgb(){const{r:t,g:r,b:s,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[t/m,r/m,s/m,h])}get hcl(){return this.overwriteGetter("hcl",(function(t){const[r,s,h,m]=il(t),y=Math.sqrt(s*s+h*h);return[Math.round(1e4*y)?rl(Math.atan2(h,s)*Uh):NaN,y,r,m]})(this.rgb))}get lab(){return this.overwriteGetter("lab",il(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){const[t,r,s,h]=this.rgb;return`rgba(${[t,r,s].map((m=>Math.round(255*m))).join(",")},${h})`}static interpolate(t,r,s,h="rgb"){switch(h){case"rgb":{const[m,y,v,w]=fs(t.rgb,r.rgb,s);return new hn(m,y,v,w,!1)}case"hcl":{const[m,y,v,w]=t.hcl,[C,M,z,B]=r.hcl;let U,V;if(isNaN(m)||isNaN(C))isNaN(m)?isNaN(C)?U=NaN:(U=C,v!==1&&v!==0||(V=M)):(U=m,z!==1&&z!==0||(V=y));else{let ce=C-m;C>m&&ce>180?ce-=360:C<m&&m-C>180&&(ce+=360),U=m+s*ce}const[$,Q,re,Te]=(function([ce,pe,Fe,Ge]){return ce=isNaN(ce)?0:ce*jc,hs([Fe,Math.cos(ce)*pe,Math.sin(ce)*pe,Ge])})([U,V??go(y,M,s),go(v,z,s),go(w,B,s)]);return new hn($,Q,re,Te,!1)}case"lab":{const[m,y,v,w]=hs(fs(t.lab,r.lab,s));return new hn(m,y,v,w,!1)}}}}hn.black=new hn(0,0,0,1),hn.white=new hn(1,1,1,1),hn.transparent=new hn(0,0,0,0),hn.red=new hn(1,0,0,1);class yo{constructor(t,r,s){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const al=["bottom","center","top"];class _o{constructor(t,r,s,h,m,y){this.text=t,this.image=r,this.scale=s,this.fontStack=h,this.textColor=m,this.verticalAlign=y}}class Nr{constructor(t){this.sections=t}static fromString(t){return new Nr([new _o(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((t=>t.text.length!==0||t.image&&t.image.name.length!==0))}static factory(t){return t instanceof Nr?t:Nr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map((t=>t.text)).join("")}}class Hr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Hr)return t;if(typeof t=="number")return new Hr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new Hr(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){return new Hr(fs(t.values,r.values,s))}}class ci{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ci)return t;if(typeof t=="number")return new ci([t]);if(Array.isArray(t)){for(const r of t)if(typeof r!="number")return;return new ci(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){return new ci(fs(t.values,r.values,s))}}class Mr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Mr)return t;if(typeof t=="string"){const s=hn.parse(t);return s?new Mr([s]):void 0}if(!Array.isArray(t))return;const r=[];for(const s of t){if(typeof s!="string")return;const h=hn.parse(s);if(!h)return;r.push(h)}return new Mr(r)}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s,h="rgb"){const m=[];if(t.values.length!=r.values.length)throw new Error(`colorArray: Arrays have mismatched length (${t.values.length} vs. ${r.values.length}), cannot interpolate.`);for(let y=0;y<t.values.length;y++)m.push(hn.interpolate(t.values[y],r.values[y],s,h));return new Mr(m)}}class Rn extends Error{constructor(t){super(t),this.name="RuntimeError"}toJSON(){return this.message}}const Ja=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ui{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof ui)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let r=0;r<t.length;r+=2){const s=t[r],h=t[r+1];if(typeof s!="string"||!Ja.has(s)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new ui(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,r,s){const h=t.values,m=r.values;if(h.length!==m.length)throw new Rn(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${r.toString()}`);const y=[];for(let v=0;v<h.length;v+=2){if(h[v]!==m[v])throw new Rn(`Cannot interpolate values containing mismatched anchors. from[${v}]: ${h[v]}, to[${v}]: ${m[v]}`);y.push(h[v]);const[w,C]=h[v+1],[M,z]=m[v+1];y.push([go(w,M,s),go(C,z,s)])}return new ui(y)}}class hi{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new hi({name:t,available:!1}):null}}class vr{constructor(t,r,s){this.from=t,this.to=r,this.transition=s}static interpolate(t,r,s){return new vr(t,r,s)}static parse(t){return t instanceof vr?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new vr(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new vr(t.from,t.to,t.transition):typeof t=="string"?new vr(t,t,1):void 0}}function Hn(i,t,r,s){return typeof i=="number"&&i>=0&&i<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:`Invalid rgba value [${[i,t,r,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof s=="number"?[i,t,r,s]:[i,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function eo(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof vr||i instanceof hn||i instanceof yo||i instanceof Nr||i instanceof Hr||i instanceof ci||i instanceof Mr||i instanceof ui||i instanceof hi)return!0;if(Array.isArray(i)){for(const t of i)if(!eo(t))return!1;return!0}if(typeof i=="object"){for(const t in i)if(!eo(i[t]))return!1;return!0}return!1}function Nt(i){if(i===null)return Wa;if(typeof i=="string")return rn;if(typeof i=="boolean")return Qt;if(typeof i=="number")return _t;if(i instanceof hn)return Er;if(i instanceof vr)return _a;if(i instanceof yo)return Wl;if(i instanceof Nr)return $i;if(i instanceof Hr)return mo;if(i instanceof ci)return cs;if(i instanceof Mr)return $a;if(i instanceof ui)return Nc;if(i instanceof hi)return _r;if(Array.isArray(i)){const t=i.length;let r;for(const s of i){const h=Nt(s);if(r){if(r===h)continue;r=an;break}r=h}return si(r||an,t)}return cr}function Xt(i){const t=typeof i;return i===null?"":t==="string"||t==="number"||t==="boolean"?String(i):i instanceof hn||i instanceof vr||i instanceof Nr||i instanceof Hr||i instanceof ci||i instanceof Mr||i instanceof ui||i instanceof hi?i.toString():JSON.stringify(i)}class va{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!eo(t[1]))return r.error("invalid value");const s=t[1];let h=Nt(s);const m=r.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new va(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const _n={string:rn,number:_t,boolean:Qt,object:cr};class rr{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s,h=1;const m=t[0];if(m==="array"){let v,w;if(t.length>2){const C=t[1];if(typeof C!="string"||!(C in _n)||C==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=_n[C],h++}else v=an;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);w=t[2],h++}s=si(v,w)}else{if(!_n[m])throw new Error(`Types doesn't contain name = ${m}`);s=_n[m]}const y=[];for(;h<t.length;h++){const v=r.parse(t[h],h,an);if(!v)return null;y.push(v)}return new rr(s,y)}evaluate(t){for(let r=0;r<this.args.length;r++){const s=this.args[r].evaluate(t);if(!us(this.type,Nt(s)))return s;if(r===this.args.length-1)throw new Rn(`Expected value to be of type ${zn(this.type)}, but found ${zn(Nt(s))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const vi={"to-boolean":Qt,"to-color":Er,"to-number":_t,"to-string":rn};class aa{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[0];if(!vi[s])throw new Error(`Can't parse ${s} as it is not part of the known types`);if((s==="to-boolean"||s==="to-string")&&t.length!==2)return r.error("Expected one argument.");const h=vi[s],m=[];for(let y=1;y<t.length;y++){const v=r.parse(t[y],y,an);if(!v)return null;m.push(v)}return new aa(h,m)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,s;for(const h of this.args){if(r=h.evaluate(t),s=null,r instanceof hn)return r;if(typeof r=="string"){const m=t.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(s=r.length<3||r.length>4?`Invalid rgba value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Hn(r[0],r[1],r[2],r[3]),!s))return new hn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Rn(s||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"padding":{let r;for(const s of this.args){r=s.evaluate(t);const h=Hr.parse(r);if(h)return h}throw new Rn(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"numberArray":{let r;for(const s of this.args){r=s.evaluate(t);const h=ci.parse(r);if(h)return h}throw new Rn(`Could not parse numberArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"colorArray":{let r;for(const s of this.args){r=s.evaluate(t);const h=Mr.parse(r);if(h)return h}throw new Rn(`Could not parse colorArray from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"variableAnchorOffsetCollection":{let r;for(const s of this.args){r=s.evaluate(t);const h=ui.parse(r);if(h)return h}throw new Rn(`Could not parse variableAnchorOffsetCollection from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}case"number":{let r=null;for(const s of this.args){if(r=s.evaluate(t),r===null)return 0;const h=Number(r);if(!isNaN(h))return h}throw new Rn(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Nr.fromString(Xt(this.args[0].evaluate(t)));case"resolvedImage":return hi.fromString(Xt(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return Xt(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}const Vo=["Unknown","Point","LineString","Polygon"];class Lu{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Vo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache.get(t);return r||(r=hn.parse(t),this._parseColorCache.set(t,r)),r}}class Ho{constructor(t,r,s=[],h,m=new po,y=[]){this.registry=t,this.path=s,this.key=s.map((v=>`[${v}]`)).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=r}parse(t,r,s,h,m={}){return r?this.concat(r,s,h)._parse(t,m):this._parse(t,m)}_parse(t,r){function s(h,m,y){return y==="assert"?new rr(m,[h]):y==="coerce"?new aa(m,[h]):h}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=t[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(t,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,w=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value"){if(v.kind==="projectionDefinition"&&["string","array"].includes(w.kind)||["color","formatted","resolvedImage"].includes(v.kind)&&["value","string"].includes(w.kind)||["padding","numberArray"].includes(v.kind)&&["value","number","array"].includes(w.kind)||v.kind==="colorArray"&&["value","string","array"].includes(w.kind)||v.kind==="variableAnchorOffsetCollection"&&["value","array"].includes(w.kind))y=s(y,v,r.typeAnnotation||"coerce");else if(this.checkSubtype(v,w))return null}else y=s(y,v,r.typeAnnotation||"assert")}if(!(y instanceof va)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new Lu;try{y=new va(y.type,y.evaluate(v))}catch(w){return this.error(w.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,s){const h=typeof t=="number"?this.path.concat(t):this.path,m=s?this.scope.concat(s):this.scope;return new Ho(this.registry,this._isConstant,h,r||null,m,this.errors)}error(t,...r){const s=`${this.key}${r.map((h=>`[${h}]`)).join("")}`;this.errors.push(new yr(s,t))}checkSubtype(t,r){const s=us(t,r);return s&&this.error(s),s}}class ps{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const s=[];for(let m=1;m<t.length-1;m+=2){const y=t[m];if(typeof y!="string")return r.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=r.parse(t[m+1],m+1);if(!v)return null;s.push([y,v])}const h=r.parse(t[t.length-1],t.length-1,r.expectedType,s);return h?new ps(s,h):null}outputDefined(){return this.result.outputDefined()}}class Go{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const s=t[1];return r.scope.has(s)?new Go(s,r.scope.get(s)):r.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class ms{constructor(t,r,s){this.type=t,this.index=r,this.input=s}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,_t),h=r.parse(t[2],2,si(r.expectedType||an));return s&&h?new ms(h.type.itemType,s,h):null}evaluate(t){const r=this.index.evaluate(t),s=this.input.evaluate(t);if(r<0)throw new Rn(`Array index out of bounds: ${r} < 0.`);if(r>=s.length)throw new Rn(`Array index out of bounds: ${r} > ${s.length-1}.`);if(r!==Math.floor(r))throw new Rn(`Array index must be an integer, but found ${r} instead.`);return s[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Kl{constructor(t,r){this.type=Qt,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,an);return s&&h?Uc(s.type,[Qt,rn,_t,Wa,an])?new Kl(s,h):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${zn(s.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!s)return!1;if(!ia(r,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${zn(Nt(r))} instead.`);if(!ia(s,["string","array"]))throw new Rn(`Expected second argument to be of type array or string, but found ${zn(Nt(s))} instead.`);return s.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ma{constructor(t,r,s){this.type=_t,this.needle=t,this.haystack=r,this.fromIndex=s}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,an);if(!s||!h)return null;if(!Uc(s.type,[Qt,rn,_t,Wa,an]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${zn(s.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,_t);return m?new Ma(s,h,m):null}return new Ma(s,h)}evaluate(t){const r=this.needle.evaluate(t),s=this.haystack.evaluate(t);if(!ia(r,["boolean","string","number","null"]))throw new Rn(`Expected first argument to be of type boolean, string, number or null, but found ${zn(Nt(r))} instead.`);let h;if(this.fromIndex&&(h=this.fromIndex.evaluate(t)),ia(s,["string"])){const m=s.indexOf(r,h);return m===-1?-1:[...s.slice(0,m)].length}if(ia(s,["array"]))return s.indexOf(r,h);throw new Rn(`Expected second argument to be of type array or string, but found ${zn(Nt(s))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Qr{constructor(t,r,s,h,m,y){this.inputType=t,this.type=r,this.input=s,this.cases=h,this.outputs=m,this.otherwise=y}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let s,h;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);const m={},y=[];for(let C=2;C<t.length-1;C+=2){let M=t[C];const z=t[C+1];Array.isArray(M)||(M=[M]);const B=r.concat(C);if(M.length===0)return B.error("Expected at least one branch label.");for(const V of M){if(typeof V!="number"&&typeof V!="string")return B.error("Branch labels must be numbers or strings.");if(typeof V=="number"&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return B.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof V=="number"&&Math.floor(V)!==V)return B.error("Numeric branch labels must be integer values.");if(s){if(B.checkSubtype(s,Nt(V)))return null}else s=Nt(V);if(m[String(V)]!==void 0)return B.error("Branch labels must be unique.");m[String(V)]=y.length}const U=r.parse(z,C,h);if(!U)return null;h=h||U.type,y.push(U)}const v=r.parse(t[1],1,an);if(!v)return null;const w=r.parse(t[t.length-1],t.length-1,h);return w?v.type.kind!=="value"&&r.concat(1).checkSubtype(s,v.type)?null:new Qr(s,h,v,m,y,w):null}evaluate(t){const r=this.input.evaluate(t);return(Nt(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))&&this.otherwise.outputDefined()}}class ol{constructor(t,r,s){this.type=t,this.branches=r,this.otherwise=s}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let s;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);const h=[];for(let y=1;y<t.length-1;y+=2){const v=r.parse(t[y],y,Qt);if(!v)return null;const w=r.parse(t[y+1],y+1,s);if(!w)return null;h.push([v,w]),s=s||w.type}const m=r.parse(t[t.length-1],t.length-1,s);if(!m)return null;if(!s)throw new Error("Can't infer output type");return new ol(s,h,m)}evaluate(t){for(const[r,s]of this.branches)if(r.evaluate(t))return s.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,s]of this.branches)t(r),t(s);t(this.otherwise)}outputDefined(){return this.branches.every((([t,r])=>r.outputDefined()))&&this.otherwise.outputDefined()}}class gs{constructor(t,r,s,h){this.type=t,this.input=r,this.beginIndex=s,this.endIndex=h}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 2 or 3 arguments, but found ${t.length-1} instead.`);const s=r.parse(t[1],1,an),h=r.parse(t[2],2,_t);if(!s||!h)return null;if(!Uc(s.type,[si(an),rn,an]))return r.error(`Expected first argument to be of type array or string, but found ${zn(s.type)} instead`);if(t.length===4){const m=r.parse(t[3],3,_t);return m?new gs(s.type,s,h,m):null}return new gs(s.type,s,h)}evaluate(t){const r=this.input.evaluate(t),s=this.beginIndex.evaluate(t);let h;if(this.endIndex&&(h=this.endIndex.evaluate(t)),ia(r,["string"]))return[...r].slice(s,h).join("");if(ia(r,["array"]))return r.slice(s,h);throw new Rn(`Expected first argument to be of type array or string, but found ${zn(Nt(r))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function ys(i,t){const r=i.length-1;let s,h,m=0,y=r,v=0;for(;m<=y;)if(v=Math.floor((m+y)/2),s=i[v],h=i[v+1],s<=t){if(v===r||t<h)return v;m=v+1}else{if(!(s>t))throw new Rn("Input is not a number.");y=v-1}return 0}class wr{constructor(t,r,s){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[h,m]of s)this.labels.push(h),this.outputs.push(m)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const s=r.parse(t[1],1,_t);if(!s)return null;const h=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let y=1;y<t.length;y+=2){const v=y===1?-1/0:t[y],w=t[y+1],C=y,M=y+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(h.length&&h[h.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const z=r.parse(w,M,m);if(!z)return null;m=m||z.type,h.push([v,z])}return new wr(m,s,h)}evaluate(t){const r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return s[0].evaluate(t);const m=r.length;return h>=r[m-1]?s[m-1].evaluate(t):s[ys(r,h)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Vh(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Ql,ku,Hh=(function(){if(ku)return Ql;function i(t,r,s,h){this.cx=3*t,this.bx=3*(s-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(h-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=r,this.p2x=s,this.p2y=h}return ku=1,Ql=i,i.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,r){if(r===void 0&&(r=1e-6),t<0)return 0;if(t>1)return 1;for(var s=t,h=0;h<8;h++){var m=this.sampleCurveX(s)-t;if(Math.abs(m)<r)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=m/y}var v=0,w=1;for(s=t,h=0;h<20&&(m=this.sampleCurveX(s),!(Math.abs(m-t)<r));h++)t>m?v=s:w=s,s=.5*(w-v)+v;return s},solve:function(t,r){return this.sampleCurveY(this.solveCurveX(t,r))}},Ql})(),sl=Vh(Hh);class di{constructor(t,r,s,h,m){this.type=t,this.operator=r,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of m)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(t,r,s,h){let m=0;if(t.name==="exponential")m=Jl(r,t.base,s,h);else if(t.name==="linear")m=Jl(r,1,s,h);else if(t.name==="cubic-bezier"){const y=t.controlPoints;m=new sl(y[0],y[1],y[2],y[3]).solve(Jl(r,1,s,h))}return m}static parse(t,r){let[s,h,m,...y]=t;if(!Array.isArray(h)||h.length===0)return r.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const C=h[1];if(typeof C!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:C}}else{if(h[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const C=h.slice(1);if(C.length!==4||C.some((M=>typeof M!="number"||M<0||M>1)))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:C}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,_t),!m)return null;const v=[];let w=null;s!=="interpolate-hcl"&&s!=="interpolate-lab"||r.expectedType==$a?r.expectedType&&r.expectedType.kind!=="value"&&(w=r.expectedType):w=Er;for(let C=0;C<y.length;C+=2){const M=y[C],z=y[C+1],B=C+3,U=C+4;if(typeof M!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(v.length&&v[v.length-1][0]>=M)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',B);const V=r.parse(z,U,w);if(!V)return null;w=w||V.type,v.push([M,V])}return Ya(w,_t)||Ya(w,_a)||Ya(w,Er)||Ya(w,mo)||Ya(w,cs)||Ya(w,$a)||Ya(w,Nc)||Ya(w,si(_t))?new di(w,s,h,m,v):r.error(`Type ${zn(w)} is not interpolatable.`)}evaluate(t){const r=this.labels,s=this.outputs;if(r.length===1)return s[0].evaluate(t);const h=this.input.evaluate(t);if(h<=r[0])return s[0].evaluate(t);const m=r.length;if(h>=r[m-1])return s[m-1].evaluate(t);const y=ys(r,h),v=di.interpolationFactor(this.interpolation,h,r[y],r[y+1]),w=s[y].evaluate(t),C=s[y+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return go(w,C,v);case"color":return hn.interpolate(w,C,v);case"padding":return Hr.interpolate(w,C,v);case"colorArray":return Mr.interpolate(w,C,v);case"numberArray":return ci.interpolate(w,C,v);case"variableAnchorOffsetCollection":return ui.interpolate(w,C,v);case"array":return fs(w,C,v);case"projectionDefinition":return vr.interpolate(w,C,v)}case"interpolate-hcl":switch(this.type.kind){case"color":return hn.interpolate(w,C,v,"hcl");case"colorArray":return Mr.interpolate(w,C,v,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return hn.interpolate(w,C,v,"lab");case"colorArray":return Mr.interpolate(w,C,v,"lab")}}}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every((t=>t.outputDefined()))}}function Jl(i,t,r,s){const h=s-r,m=i-r;return h===0?0:t===1?m/h:(Math.pow(t,m)-1)/(Math.pow(t,h)-1)}const to={color:hn.interpolate,number:go,padding:Hr.interpolate,numberArray:ci.interpolate,colorArray:Mr.interpolate,variableAnchorOffsetCollection:ui.interpolate,array:fs};class _s{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let s=null;const h=r.expectedType;h&&h.kind!=="value"&&(s=h);const m=[];for(const v of t.slice(1)){const w=r.parse(v,1+m.length,s,void 0,{typeAnnotation:"omit"});if(!w)return null;s=s||w.type,m.push(w)}if(!s)throw new Error("No output type");const y=h&&m.some((v=>us(h,v.type)));return new _s(y?an:s,m)}evaluate(t){let r,s=null,h=0;for(const m of this.args)if(h++,s=m.evaluate(t),s&&s instanceof hi&&!s.available&&(r||(r=s.name),s=null,h===this.args.length&&(s=r)),s!==null)break;return s}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every((t=>t.outputDefined()))}}function ec(i,t){return i==="=="||i==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function tc(i,t,r,s){return s.compare(t,r)===0}function xi(i,t,r){const s=i!=="=="&&i!=="!=";return class Iy{constructor(m,y,v){this.type=Qt,this.lhs=m,this.rhs=y,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const v=m[0];let w=y.parse(m[1],1,an);if(!w)return null;if(!ec(v,w.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${zn(w.type)}'.`);let C=y.parse(m[2],2,an);if(!C)return null;if(!ec(v,C.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${zn(C.type)}'.`);if(w.type.kind!==C.type.kind&&w.type.kind!=="value"&&C.type.kind!=="value")return y.error(`Cannot compare types '${zn(w.type)}' and '${zn(C.type)}'.`);s&&(w.type.kind==="value"&&C.type.kind!=="value"?w=new rr(C.type,[w]):w.type.kind!=="value"&&C.type.kind==="value"&&(C=new rr(w.type,[C])));let M=null;if(m.length===4){if(w.type.kind!=="string"&&C.type.kind!=="string"&&w.type.kind!=="value"&&C.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(M=y.parse(m[3],3,Wl),!M)return null}return new Iy(w,C,M)}evaluate(m){const y=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(s&&this.hasUntypedArgument){const w=Nt(y),C=Nt(v);if(w.kind!==C.kind||w.kind!=="string"&&w.kind!=="number")throw new Rn(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${w.kind}, ${C.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const w=Nt(y),C=Nt(v);if(w.kind!=="string"||C.kind!=="string")return t(m,y,v)}return this.collator?r(m,y,v,this.collator.evaluate(m)):t(m,y,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Ou=xi("==",(function(i,t,r){return t===r}),tc),Vc=xi("!=",(function(i,t,r){return t!==r}),(function(i,t,r,s){return!tc(0,t,r,s)})),Od=xi("<",(function(i,t,r){return t<r}),(function(i,t,r,s){return s.compare(t,r)<0})),Bu=xi(">",(function(i,t,r){return t>r}),(function(i,t,r,s){return s.compare(t,r)>0})),Bd=xi("<=",(function(i,t,r){return t<=r}),(function(i,t,r,s){return s.compare(t,r)<=0})),Fd=xi(">=",(function(i,t,r){return t>=r}),(function(i,t,r,s){return s.compare(t,r)>=0}));class Hc{constructor(t,r,s){this.type=Wl,this.locale=s,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const s=t[1];if(typeof s!="object"||Array.isArray(s))return r.error("Collator options argument must be an object.");const h=r.parse(s["case-sensitive"]!==void 0&&s["case-sensitive"],1,Qt);if(!h)return null;const m=r.parse(s["diacritic-sensitive"]!==void 0&&s["diacritic-sensitive"],1,Qt);if(!m)return null;let y=null;return s.locale&&(y=r.parse(s.locale,1,rn),!y)?null:new Hc(h,m,y)}evaluate(t){return new yo(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Fu{constructor(t,r,s,h,m){this.type=rn,this.number=t,this.locale=r,this.currency=s,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const s=r.parse(t[1],1,_t);if(!s)return null;const h=t[2];if(typeof h!="object"||Array.isArray(h))return r.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=r.parse(h.locale,1,rn),!m))return null;let y=null;if(h.currency&&(y=r.parse(h.currency,1,rn),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=r.parse(h["min-fraction-digits"],1,_t),!v))return null;let w=null;return h["max-fraction-digits"]&&(w=r.parse(h["max-fraction-digits"],1,_t),!w)?null:new Fu(s,m,y,v,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class vs{constructor(t){this.type=$i,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const s=t[1];if(!Array.isArray(s)&&typeof s=="object")return r.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=t.length-1;++y){const v=t[y];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let w=null;if(v["font-scale"]&&(w=r.parse(v["font-scale"],1,_t),!w))return null;let C=null;if(v["text-font"]&&(C=r.parse(v["text-font"],1,si(rn)),!C))return null;let M=null;if(v["text-color"]&&(M=r.parse(v["text-color"],1,Er),!M))return null;let z=null;if(v["vertical-align"]){if(typeof v["vertical-align"]=="string"&&!al.includes(v["vertical-align"]))return r.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${v["vertical-align"]}' instead.`);if(z=r.parse(v["vertical-align"],1,rn),!z)return null}const B=h[h.length-1];B.scale=w,B.font=C,B.textColor=M,B.verticalAlign=z}else{const w=r.parse(t[y],1,an);if(!w)return null;const C=w.type.kind;if(C!=="string"&&C!=="value"&&C!=="null"&&C!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:w,scale:null,font:null,textColor:null,verticalAlign:null})}}return new vs(h)}evaluate(t){return new Nr(this.sections.map((r=>{const s=r.content.evaluate(t);return Nt(s)===_r?new _o("",s,null,null,null,r.verticalAlign?r.verticalAlign.evaluate(t):null):new _o(Xt(s),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null,r.verticalAlign?r.verticalAlign.evaluate(t):null)})))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor),r.verticalAlign&&t(r.verticalAlign)}outputDefined(){return!1}}class Nu{constructor(t){this.type=_r,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");const s=r.parse(t[1],1,rn);return s?new Nu(s):r.error("No image name provided.")}evaluate(t){const r=this.input.evaluate(t),s=hi.fromString(r);return s&&t.availableImages&&(s.available=t.availableImages.indexOf(r)>-1),s}eachChild(t){t(this.input)}outputDefined(){return!1}}class ll{constructor(t){this.type=_t,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=r.parse(t[1],1);return s?s.type.kind!=="array"&&s.type.kind!=="string"&&s.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${zn(s.type)} instead.`):new ll(s):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string")return[...r].length;if(Array.isArray(r))return r.length;throw new Rn(`Expected value to be of type string or array, but found ${zn(Nt(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Di=8192;function Nd(i,t){const r=(180+i[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,h=Math.pow(2,t.z);return[Math.round(r*h*Di),Math.round(s*h*Di)]}function nc(i,t){const r=Math.pow(2,t.z);return[(h=(i[0]/Di+t.x)/r,360*h-180),(s=(i[1]/Di+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90)];var s,h}function cl(i,t){i[0]=Math.min(i[0],t[0]),i[1]=Math.min(i[1],t[1]),i[2]=Math.max(i[2],t[0]),i[3]=Math.max(i[3],t[1])}function ul(i,t){return!(i[0]<=t[0]||i[2]>=t[2]||i[1]<=t[1]||i[3]>=t[3])}function Gh(i,t,r){const s=i[0]-t[0],h=i[1]-t[1],m=i[0]-r[0],y=i[1]-r[1];return s*y-m*h==0&&s*m<=0&&h*y<=0}function rc(i,t,r,s){return(h=[s[0]-r[0],s[1]-r[1]])[0]*(m=[t[0]-i[0],t[1]-i[1]])[1]-h[1]*m[0]!=0&&!(!ju(i,t,r,s)||!ju(r,s,i,t));var h,m}function hl(i,t,r){for(const s of r)for(let h=0;h<s.length-1;++h)if(rc(i,t,s[h],s[h+1]))return!0;return!1}function xs(i,t,r=!1){let s=!1;for(const v of t)for(let w=0;w<v.length-1;w++){if(Gh(i,v[w],v[w+1]))return r;(m=v[w])[1]>(h=i)[1]!=(y=v[w+1])[1]>h[1]&&h[0]<(y[0]-m[0])*(h[1]-m[1])/(y[1]-m[1])+m[0]&&(s=!s)}var h,m,y;return s}function Zh(i,t){for(const r of t)if(xs(i,r))return!0;return!1}function Uu(i,t){for(const r of i)if(!xs(r,t))return!1;for(let r=0;r<i.length-1;++r)if(hl(i[r],i[r+1],t))return!1;return!0}function qh(i,t){for(const r of t)if(Uu(i,r))return!0;return!1}function ju(i,t,r,s){const h=s[0]-r[0],m=s[1]-r[1],y=(i[0]-r[0])*m-h*(i[1]-r[1]),v=(t[0]-r[0])*m-h*(t[1]-r[1]);return y>0&&v<0||y<0&&v>0}function bs(i,t,r){const s=[];for(let h=0;h<i.length;h++){const m=[];for(let y=0;y<i[h].length;y++){const v=Nd(i[h][y],r);cl(t,v),m.push(v)}s.push(m)}return s}function dl(i,t,r){const s=[];for(let h=0;h<i.length;h++){const m=bs(i[h],t,r);s.push(m)}return s}function Gc(i,t,r,s){if(i[0]<r[0]||i[0]>r[2]){const h=.5*s;let m=i[0]-r[0]>h?-s:r[0]-i[0]>h?s:0;m===0&&(m=i[0]-r[2]>h?-s:r[2]-i[0]>h?s:0),i[0]+=m}cl(t,i)}function ic(i,t,r,s){const h=Math.pow(2,s.z)*Di,m=[s.x*Di,s.y*Di],y=[];for(const v of i)for(const w of v){const C=[w.x+m[0],w.y+m[1]];Gc(C,t,r,h),y.push(C)}return y}function Vu(i,t,r,s){const h=Math.pow(2,s.z)*Di,m=[s.x*Di,s.y*Di],y=[];for(const w of i){const C=[];for(const M of w){const z=[M.x+m[0],M.y+m[1]];cl(t,z),C.push(z)}y.push(C)}if(t[2]-t[0]<=h/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const w of y)for(const C of w)Gc(C,t,r,h)}var v;return y}class Zo{constructor(t,r){this.type=Qt,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(eo(t[1])){const s=t[1];if(s.type==="FeatureCollection"){const h=[];for(const m of s.features){const{type:y,coordinates:v}=m.geometry;y==="Polygon"&&h.push(v),y==="MultiPolygon"&&h.push(...v)}if(h.length)return new Zo(s,{type:"MultiPolygon",coordinates:h})}else if(s.type==="Feature"){const h=s.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Zo(s,s.geometry)}else if(s.type==="Polygon"||s.type==="MultiPolygon")return new Zo(s,s)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(s.type==="Polygon"){const v=bs(s.coordinates,m,y),w=ic(r.geometry(),h,m,y);if(!ul(h,m))return!1;for(const C of w)if(!xs(C,v))return!1}if(s.type==="MultiPolygon"){const v=dl(s.coordinates,m,y),w=ic(r.geometry(),h,m,y);if(!ul(h,m))return!1;for(const C of w)if(!Zh(C,v))return!1}return!0})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=r.canonicalID();if(s.type==="Polygon"){const v=bs(s.coordinates,m,y),w=Vu(r.geometry(),h,m,y);if(!ul(h,m))return!1;for(const C of w)if(!Uu(C,v))return!1}if(s.type==="MultiPolygon"){const v=dl(s.coordinates,m,y),w=Vu(r.geometry(),h,m,y);if(!ul(h,m))return!1;for(const C of w)if(!qh(C,v))return!1}return!0})(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let ac=class{constructor(i=[],t=(r,s)=>r<s?-1:r>s?1:0){if(this.data=i,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:t,compare:r}=this,s=t[i];for(;i>0;){const h=i-1>>1,m=t[h];if(r(s,m)>=0)break;t[i]=m,i=h}t[i]=s}_down(i){const{data:t,compare:r}=this,s=this.length>>1,h=t[i];for(;i<s;){let m=1+(i<<1);const y=m+1;if(y<this.length&&r(t[y],t[m])<0&&(m=y),r(t[m],h)>=0)break;t[i]=t[m],i=m}t[i]=h}};function oc(i,t,r=0,s=i.length-1,h=Wh){for(;s>r;){if(s-r>600){const w=s-r+1,C=t-r+1,M=Math.log(w),z=.5*Math.exp(2*M/3),B=.5*Math.sqrt(M*z*(w-z)/w)*(C-w/2<0?-1:1);oc(i,t,Math.max(r,Math.floor(t-C*z/w+B)),Math.min(s,Math.floor(t+(w-C)*z/w+B)),h)}const m=i[t];let y=r,v=s;for(fl(i,r,t),h(i[s],m)>0&&fl(i,r,s);y<v;){for(fl(i,y,v),y++,v--;h(i[y],m)<0;)y++;for(;h(i[v],m)>0;)v--}h(i[r],m)===0?fl(i,r,v):(v++,fl(i,v,s)),v<=t&&(r=v+1),t<=v&&(s=v-1)}}function fl(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}function Wh(i,t){return i<t?-1:i>t?1:0}function pl(i,t){if(i.length<=1)return[i];const r=[];let s,h;for(const m of i){const y=Ud(m);y!==0&&(m.area=Math.abs(y),h===void 0&&(h=y<0),h===y<0?(s&&r.push(s),s=[m]):s.push(m))}if(s&&r.push(s),t>1)for(let m=0;m<r.length;m++)r[m].length<=t||(oc(r[m],t,1,r[m].length-1,$h),r[m]=r[m].slice(0,t));return r}function $h(i,t){return t.area-i.area}function Ud(i){let t=0;for(let r,s,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],s=i[y],t+=(s.x-r.x)*(r.y+s.y);return t}const Xh=1/298.257223563,Yh=Xh*(2-Xh),Hu=Math.PI/180;class Ii{constructor(t){const r=6378.137*Hu*1e3,s=Math.cos(t*Hu),h=1/(1-Yh*(1-s*s)),m=Math.sqrt(h);this.kx=r*m*s,this.ky=r*m*h*(1-Yh)}distance(t,r){const s=this.wrap(t[0]-r[0])*this.kx,h=(t[1]-r[1])*this.ky;return Math.sqrt(s*s+h*h)}pointOnLine(t,r){let s,h,m,y,v=1/0;for(let w=0;w<t.length-1;w++){let C=t[w][0],M=t[w][1],z=this.wrap(t[w+1][0]-C)*this.kx,B=(t[w+1][1]-M)*this.ky,U=0;z===0&&B===0||(U=(this.wrap(r[0]-C)*this.kx*z+(r[1]-M)*this.ky*B)/(z*z+B*B),U>1?(C=t[w+1][0],M=t[w+1][1]):U>0&&(C+=z/this.kx*U,M+=B/this.ky*U)),z=this.wrap(r[0]-C)*this.kx,B=(r[1]-M)*this.ky;const V=z*z+B*B;V<v&&(v=V,s=C,h=M,m=w,y=U)}return{point:[s,h],index:m,t:Math.max(0,Math.min(1,y))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function ml(i,t){return t[0]-i[0]}function sc(i){return i[1]-i[0]+1}function no(i,t){return i[1]>=i[0]&&i[1]<t}function Sn(i,t){if(i[0]>i[1])return[null,null];const r=sc(i);if(t){if(r===2)return[i,null];const h=Math.floor(r/2);return[[i[0],i[0]+h],[i[0]+h,i[1]]]}if(r===1)return[i,null];const s=Math.floor(r/2)-1;return[[i[0],i[0]+s],[i[0]+s+1,i[1]]]}function Zc(i,t){if(!no(t,i.length))return[1/0,1/0,-1/0,-1/0];const r=[1/0,1/0,-1/0,-1/0];for(let s=t[0];s<=t[1];++s)cl(r,i[s]);return r}function lc(i){const t=[1/0,1/0,-1/0,-1/0];for(const r of i)for(const s of r)cl(t,s);return t}function Kh(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}function qo(i,t,r){if(!Kh(i)||!Kh(t))return NaN;let s=0,h=0;return i[2]<t[0]&&(s=t[0]-i[2]),i[0]>t[2]&&(s=i[0]-t[2]),i[1]>t[3]&&(h=i[1]-t[3]),i[3]<t[1]&&(h=t[1]-i[3]),r.distance([0,0],[s,h])}function vo(i,t,r){const s=r.pointOnLine(t,i);return r.distance(i,s.point)}function ws(i,t,r,s,h){const m=Math.min(vo(i,[r,s],h),vo(t,[r,s],h)),y=Math.min(vo(r,[i,t],h),vo(s,[i,t],h));return Math.min(m,y)}function Gu(i,t,r,s,h){if(!no(t,i.length)||!no(s,r.length))return 1/0;let m=1/0;for(let y=t[0];y<t[1];++y){const v=i[y],w=i[y+1];for(let C=s[0];C<s[1];++C){const M=r[C],z=r[C+1];if(rc(v,w,M,z))return 0;m=Math.min(m,ws(v,w,M,z,h))}}return m}function Qh(i,t,r,s,h){if(!no(t,i.length)||!no(s,r.length))return NaN;let m=1/0;for(let y=t[0];y<=t[1];++y)for(let v=s[0];v<=s[1];++v)if(m=Math.min(m,h.distance(i[y],r[v])),m===0)return m;return m}function Ss(i,t,r){if(xs(i,t,!0))return 0;let s=1/0;for(const h of t){const m=h[0],y=h[h.length-1];if(m!==y&&(s=Math.min(s,vo(i,[y,m],r)),s===0))return s;const v=r.pointOnLine(h,i);if(s=Math.min(s,r.distance(i,v.point)),s===0)return s}return s}function gl(i,t,r,s){if(!no(t,i.length))return NaN;for(let m=t[0];m<=t[1];++m)if(xs(i[m],r,!0))return 0;let h=1/0;for(let m=t[0];m<t[1];++m){const y=i[m],v=i[m+1];for(const w of r)for(let C=0,M=w.length,z=M-1;C<M;z=C++){const B=w[z],U=w[C];if(rc(y,v,B,U))return 0;h=Math.min(h,ws(y,v,B,U,s))}}return h}function qc(i,t){for(const r of i)for(const s of r)if(xs(s,t,!0))return!0;return!1}function Jh(i,t,r,s=1/0){const h=lc(i),m=lc(t);if(s!==1/0&&qo(h,m,r)>=s)return s;if(ul(h,m)){if(qc(i,t))return 0}else if(qc(t,i))return 0;let y=1/0;for(const v of i)for(let w=0,C=v.length,M=C-1;w<C;M=w++){const z=v[M],B=v[w];for(const U of t)for(let V=0,$=U.length,Q=$-1;V<$;Q=V++){const re=U[Q],Te=U[V];if(rc(z,B,re,Te))return 0;y=Math.min(y,ws(z,B,re,Te,r))}}return y}function Wo(i,t,r,s,h,m){if(!m)return;const y=qo(Zc(s,m),h,r);y<t&&i.push([y,m,[0,0]])}function cc(i,t,r,s,h,m,y){if(!m||!y)return;const v=qo(Zc(s,m),Zc(h,y),r);v<t&&i.push([v,m,y])}function uc(i,t,r,s,h=1/0){let m=Math.min(s.distance(i[0],r[0][0]),h);if(m===0)return m;const y=new ac([[0,[0,i.length-1],[0,0]]],ml),v=lc(r);for(;y.length>0;){const w=y.pop();if(w[0]>=m)continue;const C=w[1],M=t?50:100;if(sc(C)<=M){if(!no(C,i.length))return NaN;if(t){const z=gl(i,C,r,s);if(isNaN(z)||z===0)return z;m=Math.min(m,z)}else for(let z=C[0];z<=C[1];++z){const B=Ss(i[z],r,s);if(m=Math.min(m,B),m===0)return 0}}else{const z=Sn(C,t);Wo(y,m,s,i,v,z[0]),Wo(y,m,s,i,v,z[1])}}return m}function hc(i,t,r,s,h,m=1/0){let y=Math.min(m,h.distance(i[0],r[0]));if(y===0)return y;const v=new ac([[0,[0,i.length-1],[0,r.length-1]]],ml);for(;v.length>0;){const w=v.pop();if(w[0]>=y)continue;const C=w[1],M=w[2],z=t?50:100,B=s?50:100;if(sc(C)<=z&&sc(M)<=B){if(!no(C,i.length)&&no(M,r.length))return NaN;let U;if(t&&s)U=Gu(i,C,r,M,h),y=Math.min(y,U);else if(t&&!s){const V=i.slice(C[0],C[1]+1);for(let $=M[0];$<=M[1];++$)if(U=vo(r[$],V,h),y=Math.min(y,U),y===0)return y}else if(!t&&s){const V=r.slice(M[0],M[1]+1);for(let $=C[0];$<=C[1];++$)if(U=vo(i[$],V,h),y=Math.min(y,U),y===0)return y}else U=Qh(i,C,r,M,h),y=Math.min(y,U)}else{const U=Sn(C,t),V=Sn(M,s);cc(v,y,h,i,r,U[0],V[0]),cc(v,y,h,i,r,U[0],V[1]),cc(v,y,h,i,r,U[1],V[0]),cc(v,y,h,i,r,U[1],V[1])}}return y}function Zu(i){return i.type==="MultiPolygon"?i.coordinates.map((t=>({type:"Polygon",coordinates:t}))):i.type==="MultiLineString"?i.coordinates.map((t=>({type:"LineString",coordinates:t}))):i.type==="MultiPoint"?i.coordinates.map((t=>({type:"Point",coordinates:t}))):[i]}class Ps{constructor(t,r){this.type=_t,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(eo(t[1])){const s=t[1];if(s.type==="FeatureCollection")return new Ps(s,s.features.map((h=>Zu(h.geometry))).flat());if(s.type==="Feature")return new Ps(s,Zu(s.geometry));if("type"in s&&"coordinates"in s)return new Ps(s,Zu(s))}return r.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return(function(r,s){const h=r.geometry(),m=h.flat().map((w=>nc([w.x,w.y],r.canonical)));if(h.length===0)return NaN;const y=new Ii(m[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,hc(m,!1,[w.coordinates],!1,y,v));break;case"LineString":v=Math.min(v,hc(m,!1,w.coordinates,!0,y,v));break;case"Polygon":v=Math.min(v,uc(m,!1,w.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="LineString")return(function(r,s){const h=r.geometry(),m=h.flat().map((w=>nc([w.x,w.y],r.canonical)));if(h.length===0)return NaN;const y=new Ii(m[0][1]);let v=1/0;for(const w of s){switch(w.type){case"Point":v=Math.min(v,hc(m,!0,[w.coordinates],!1,y,v));break;case"LineString":v=Math.min(v,hc(m,!0,w.coordinates,!0,y,v));break;case"Polygon":v=Math.min(v,uc(m,!0,w.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries);if(t.geometryType()==="Polygon")return(function(r,s){const h=r.geometry();if(h.length===0||h[0].length===0)return NaN;const m=pl(h,0).map((w=>w.map((C=>C.map((M=>nc([M.x,M.y],r.canonical))))))),y=new Ii(m[0][0][0][1]);let v=1/0;for(const w of s)for(const C of m){switch(w.type){case"Point":v=Math.min(v,uc([w.coordinates],!1,C,y,v));break;case"LineString":v=Math.min(v,uc(w.coordinates,!0,C,y,v));break;case"Polygon":v=Math.min(v,Jh(C,w.coordinates,y,v))}if(v===0)return v}return v})(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class dc{constructor(t){this.type=an,this.key=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const s=t[1];return s==null?r.error("Global state property must be defined."):typeof s!="string"?r.error(`Global state property must be string, but found ${typeof t[1]} instead.`):new dc(s)}evaluate(t){var r;const s=(r=t.globals)===null||r===void 0?void 0:r.globalState;return s&&Object.keys(s).length!==0?ds(s,this.key):null}eachChild(){}outputDefined(){return!1}}const Cs={"==":Ou,"!=":Vc,">":Bu,"<":Od,">=":Fd,"<=":Bd,array:rr,at:ms,boolean:rr,case:ol,coalesce:_s,collator:Hc,format:vs,image:Nu,in:Kl,"index-of":Ma,interpolate:di,"interpolate-hcl":di,"interpolate-lab":di,length:ll,let:ps,literal:va,match:Qr,number:rr,"number-format":Fu,object:rr,slice:gs,step:wr,string:rr,"to-boolean":aa,"to-color":aa,"to-number":aa,"to-string":aa,var:Go,within:Zo,distance:Ps,"global-state":dc};class oa{constructor(t,r,s,h){this.name=t,this.type=r,this._evaluate=s,this.args=h}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){const s=t[0],h=oa.definitions[s];if(!h)return r.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter((([C])=>!Array.isArray(C)||C.length===t.length-1));let w=null;for(const[C,M]of v){w=new Ho(r.registry,zi,r.path,null,r.scope);const z=[];let B=!1;for(let U=1;U<t.length;U++){const V=t[U],$=Array.isArray(C)?C[U-1]:C.type,Q=w.parse(V,1+z.length,$);if(!Q){B=!0;break}z.push(Q)}if(!B)if(Array.isArray(C)&&C.length!==z.length)w.error(`Expected ${C.length} arguments, but found ${z.length} instead.`);else{for(let U=0;U<z.length;U++){const V=Array.isArray(C)?C[U]:C.type,$=z[U];w.concat(U+1).checkSubtype(V,$.type)}if(w.errors.length===0)return new oa(s,m,M,z)}}if(v.length===1)r.errors.push(...w.errors);else{const C=(v.length?v:y).map((([z])=>{return B=z,Array.isArray(B)?`(${B.map(zn).join(", ")})`:`(${zn(B.type)}...)`;var B})).join(" | "),M=[];for(let z=1;z<t.length;z++){const B=r.parse(t[z],1+M.length);if(!B)return null;M.push(zn(B.type))}r.error(`Expected arguments of type ${C}, but found (${M.join(", ")}) instead.`)}return null}static register(t,r){oa.definitions=r;for(const s in r)t[s]=oa}}function Wc(i,[t,r,s,h]){t=t.evaluate(i),r=r.evaluate(i),s=s.evaluate(i);const m=h?h.evaluate(i):1,y=Hn(t,r,s,m);if(y)throw new Rn(y);return new hn(t/255,r/255,s/255,m,!1)}function xa(i,t){return i in t}function $c(i,t){const r=t[i];return r===void 0?null:r}function Jr(i){return{type:i}}function zi(i){if(i instanceof Go)return zi(i.boundExpression);if(i instanceof oa&&i.name==="error"||i instanceof Hc||i instanceof Zo||i instanceof Ps||i instanceof dc)return!1;const t=i instanceof aa||i instanceof rr;let r=!0;return i.eachChild((s=>{r=t?r&&zi(s):r&&s instanceof va})),!!r&&xo(i)&&As(i,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function xo(i){if(i instanceof oa&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof Zo||i instanceof Ps)return!1;let t=!0;return i.eachChild((r=>{t&&!xo(r)&&(t=!1)})),t}function Ts(i){if(i instanceof oa&&i.name==="feature-state")return!1;let t=!0;return i.eachChild((r=>{t&&!Ts(r)&&(t=!1)})),t}function As(i,t){if(i instanceof oa&&t.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild((s=>{r&&!As(s,t)&&(r=!1)})),r}function fc(i){return{result:"success",value:i}}function $o(i){return{result:"error",value:i}}function sa(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function qu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function yl(i){return!!i.expression&&i.expression.interpolated}function sn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function pc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)&&Nt(i)===cr}function la(i){return i}function Xc(i,t){const r=i.stops&&typeof i.stops[0][0]=="object",s=r||!(r||i.property!==void 0),h=i.type||(yl(t)?"exponential":"interval"),m=(function(M){switch(M.type){case"color":return hn.parse;case"padding":return Hr.parse;case"numberArray":return ci.parse;case"colorArray":return Mr.parse;default:return null}})(t);if(m&&((i=_i({},i)).stops&&(i.stops=i.stops.map((M=>[M[0],m(M[1])]))),i.default=m(i.default?i.default:t.default)),i.colorSpace&&(y=i.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var y;const v=(function(M){switch(M){case"exponential":return Xo;case"interval":return Yc;case"categorical":return Wu;case"identity":return $u;default:throw new Error(`Unknown function type "${M}"`)}})(h);let w,C;if(h==="categorical"){w=Object.create(null);for(const M of i.stops)w[M[0]]=M[1];C=typeof i.stops[0][0]}if(r){const M={},z=[];for(let V=0;V<i.stops.length;V++){const $=i.stops[V],Q=$[0].zoom;M[Q]===void 0&&(M[Q]={zoom:Q,type:i.type,property:i.property,default:i.default,stops:[]},z.push(Q)),M[Q].stops.push([$[0].value,$[1]])}const B=[];for(const V of z)B.push([M[V].zoom,Xc(M[V],t)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:di.interpolationFactor.bind(void 0,U),zoomStops:B.map((V=>V[0])),evaluate:({zoom:V},$)=>Xo({stops:B,base:i.base},t,V).evaluate(V,$)}}if(s){const M=h==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:di.interpolationFactor.bind(void 0,M),zoomStops:i.stops.map((z=>z[0])),evaluate:({zoom:z})=>v(i,t,z,w,C)}}return{kind:"source",evaluate(M,z){const B=z&&z.properties?z.properties[i.property]:void 0;return B===void 0?bi(i.default,t.default):v(i,t,B,w,C)}}}function bi(i,t,r){return i!==void 0?i:t!==void 0?t:r!==void 0?r:void 0}function Wu(i,t,r,s,h){return bi(typeof r===h?s[r]:void 0,i.default,t.default)}function Yc(i,t,r){if(sn(r)!=="number")return bi(i.default,t.default);const s=i.stops.length;if(s===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[s-1][0])return i.stops[s-1][1];const h=ys(i.stops.map((m=>m[0])),r);return i.stops[h][1]}function Xo(i,t,r){const s=i.base!==void 0?i.base:1;if(sn(r)!=="number")return bi(i.default,t.default);const h=i.stops.length;if(h===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[h-1][0])return i.stops[h-1][1];const m=ys(i.stops.map((M=>M[0])),r),y=(function(M,z,B,U){const V=U-B,$=M-B;return V===0?0:z===1?$/V:(Math.pow(z,$)-1)/(Math.pow(z,V)-1)})(r,s,i.stops[m][0],i.stops[m+1][0]),v=i.stops[m][1],w=i.stops[m+1][1],C=to[t.type]||la;return typeof v.evaluate=="function"?{evaluate(...M){const z=v.evaluate.apply(void 0,M),B=w.evaluate.apply(void 0,M);if(z!==void 0&&B!==void 0)return C(z,B,y,i.colorSpace)}}:C(v,w,y,i.colorSpace)}function $u(i,t,r){switch(t.type){case"color":r=hn.parse(r);break;case"formatted":r=Nr.fromString(r.toString());break;case"resolvedImage":r=hi.fromString(r.toString());break;case"padding":r=Hr.parse(r);break;case"colorArray":r=Mr.parse(r);break;case"numberArray":r=ci.parse(r);break;default:sn(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0)}return bi(r,i.default,t.default)}oa.register(Cs,{error:[{kind:"error"},[rn],(i,[t])=>{throw new Rn(t.evaluate(i))}],typeof:[rn,[an],(i,[t])=>zn(Nt(t.evaluate(i)))],"to-rgba":[si(_t,4),[Er],(i,[t])=>{const[r,s,h,m]=t.evaluate(i).rgb;return[255*r,255*s,255*h,m]}],rgb:[Er,[_t,_t,_t],Wc],rgba:[Er,[_t,_t,_t,_t],Wc],has:{type:Qt,overloads:[[[rn],(i,[t])=>xa(t.evaluate(i),i.properties())],[[rn,cr],(i,[t,r])=>xa(t.evaluate(i),r.evaluate(i))]]},get:{type:an,overloads:[[[rn],(i,[t])=>$c(t.evaluate(i),i.properties())],[[rn,cr],(i,[t,r])=>$c(t.evaluate(i),r.evaluate(i))]]},"feature-state":[an,[rn],(i,[t])=>$c(t.evaluate(i),i.featureState||{})],properties:[cr,[],i=>i.properties()],"geometry-type":[rn,[],i=>i.geometryType()],id:[an,[],i=>i.id()],zoom:[_t,[],i=>i.globals.zoom],"heatmap-density":[_t,[],i=>i.globals.heatmapDensity||0],elevation:[_t,[],i=>i.globals.elevation||0],"line-progress":[_t,[],i=>i.globals.lineProgress||0],accumulated:[an,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[_t,Jr(_t),(i,t)=>{let r=0;for(const s of t)r+=s.evaluate(i);return r}],"*":[_t,Jr(_t),(i,t)=>{let r=1;for(const s of t)r*=s.evaluate(i);return r}],"-":{type:_t,overloads:[[[_t,_t],(i,[t,r])=>t.evaluate(i)-r.evaluate(i)],[[_t],(i,[t])=>-t.evaluate(i)]]},"/":[_t,[_t,_t],(i,[t,r])=>t.evaluate(i)/r.evaluate(i)],"%":[_t,[_t,_t],(i,[t,r])=>t.evaluate(i)%r.evaluate(i)],ln2:[_t,[],()=>Math.LN2],pi:[_t,[],()=>Math.PI],e:[_t,[],()=>Math.E],"^":[_t,[_t,_t],(i,[t,r])=>Math.pow(t.evaluate(i),r.evaluate(i))],sqrt:[_t,[_t],(i,[t])=>Math.sqrt(t.evaluate(i))],log10:[_t,[_t],(i,[t])=>Math.log(t.evaluate(i))/Math.LN10],ln:[_t,[_t],(i,[t])=>Math.log(t.evaluate(i))],log2:[_t,[_t],(i,[t])=>Math.log(t.evaluate(i))/Math.LN2],sin:[_t,[_t],(i,[t])=>Math.sin(t.evaluate(i))],cos:[_t,[_t],(i,[t])=>Math.cos(t.evaluate(i))],tan:[_t,[_t],(i,[t])=>Math.tan(t.evaluate(i))],asin:[_t,[_t],(i,[t])=>Math.asin(t.evaluate(i))],acos:[_t,[_t],(i,[t])=>Math.acos(t.evaluate(i))],atan:[_t,[_t],(i,[t])=>Math.atan(t.evaluate(i))],min:[_t,Jr(_t),(i,t)=>Math.min(...t.map((r=>r.evaluate(i))))],max:[_t,Jr(_t),(i,t)=>Math.max(...t.map((r=>r.evaluate(i))))],abs:[_t,[_t],(i,[t])=>Math.abs(t.evaluate(i))],round:[_t,[_t],(i,[t])=>{const r=t.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[_t,[_t],(i,[t])=>Math.floor(t.evaluate(i))],ceil:[_t,[_t],(i,[t])=>Math.ceil(t.evaluate(i))],"filter-==":[Qt,[rn,an],(i,[t,r])=>i.properties()[t.value]===r.value],"filter-id-==":[Qt,[an],(i,[t])=>i.id()===t.value],"filter-type-==":[Qt,[rn],(i,[t])=>i.geometryType()===t.value],"filter-<":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s<h}],"filter-id-<":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r<s}],"filter->":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s>h}],"filter-id->":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r>s}],"filter-<=":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r<=s}],"filter->=":[Qt,[rn,an],(i,[t,r])=>{const s=i.properties()[t.value],h=r.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[Qt,[an],(i,[t])=>{const r=i.id(),s=t.value;return typeof r==typeof s&&r>=s}],"filter-has":[Qt,[an],(i,[t])=>t.value in i.properties()],"filter-has-id":[Qt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Qt,[si(rn)],(i,[t])=>t.value.indexOf(i.geometryType())>=0],"filter-id-in":[Qt,[si(an)],(i,[t])=>t.value.indexOf(i.id())>=0],"filter-in-small":[Qt,[rn,si(an)],(i,[t,r])=>r.value.indexOf(i.properties()[t.value])>=0],"filter-in-large":[Qt,[rn,si(an)],(i,[t,r])=>(function(s,h,m,y){for(;m<=y;){const v=m+y>>1;if(h[v]===s)return!0;h[v]>s?y=v-1:m=v+1}return!1})(i.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Qt,overloads:[[[Qt,Qt],(i,[t,r])=>t.evaluate(i)&&r.evaluate(i)],[Jr(Qt),(i,t)=>{for(const r of t)if(!r.evaluate(i))return!1;return!0}]]},any:{type:Qt,overloads:[[[Qt,Qt],(i,[t,r])=>t.evaluate(i)||r.evaluate(i)],[Jr(Qt),(i,t)=>{for(const r of t)if(r.evaluate(i))return!0;return!1}]]},"!":[Qt,[Qt],(i,[t])=>!t.evaluate(i)],"is-supported-script":[Qt,[rn],(i,[t])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(t.evaluate(i))}],upcase:[rn,[rn],(i,[t])=>t.evaluate(i).toUpperCase()],downcase:[rn,[rn],(i,[t])=>t.evaluate(i).toLowerCase()],concat:[rn,Jr(an),(i,t)=>t.map((r=>Xt(r.evaluate(i)))).join("")],"resolved-locale":[rn,[Wl],(i,[t])=>t.evaluate(i).resolvedLocale()]});class mc{constructor(t,r,s){this.expression=t,this._warningHistory={},this._evaluator=new Lu,this._defaultValue=r?(function(h){if(h.type==="color"&&pc(h.default))return new hn(0,0,0,0);switch(h.type){case"color":return hn.parse(h.default)||null;case"padding":return Hr.parse(h.default)||null;case"numberArray":return ci.parse(h.default)||null;case"colorArray":return Mr.parse(h.default)||null;case"variableAnchorOffsetCollection":return ui.parse(h.default)||null;case"projectionDefinition":return vr.parse(h.default)||null;default:return h.default===void 0?null:h.default}})(r):null,this._enumValues=r&&r.type==="enum"?r.values:null,this._globalState=s}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Li(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=s,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(t,r,s,h,m,y){this._globalState&&(t=Li(t,this._globalState)),this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new Rn(`Expected value to be one of ${Object.keys(this._enumValues).map((w=>JSON.stringify(w))).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function bo(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in Cs}function ro(i,t,r){const s=new Ho(Cs,zi,[],t?(function(m){const y={color:Er,string:rn,number:_t,enum:rn,boolean:Qt,formatted:$i,padding:mo,numberArray:cs,colorArray:$a,projectionDefinition:_a,resolvedImage:_r,variableAnchorOffsetCollection:Nc};return m.type==="array"?si(y[m.value]||an,m.length):y[m.type]})(t):void 0),h=s.parse(i,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?fc(new mc(h,t,r)):$o(s.errors)}class Yo{constructor(t,r,s){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!Ts(r.expression),this.globalStateRefs=ua(r.expression),this._globalState=s}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Li(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,r,s,h,m,y)}evaluate(t,r,s,h,m,y){return this._globalState&&(t=Li(t,this._globalState)),this._styleExpression.evaluate(t,r,s,h,m,y)}}class _l{constructor(t,r,s,h,m){this.kind=t,this.zoomStops=s,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Ts(r.expression),this.globalStateRefs=ua(r.expression),this.interpolationType=h,this._globalState=m}evaluateWithoutErrorHandling(t,r,s,h,m,y){return this._globalState&&(t=Li(t,this._globalState)),this._styleExpression.evaluateWithoutErrorHandling(t,r,s,h,m,y)}evaluate(t,r,s,h,m,y){return this._globalState&&(t=Li(t,this._globalState)),this._styleExpression.evaluate(t,r,s,h,m,y)}interpolationFactor(t,r,s){return this.interpolationType?di.interpolationFactor(this.interpolationType,t,r,s):0}}function ca(i,t,r){const s=ro(i,t,r);if(s.result==="error")return s;const h=s.value.expression,m=xo(h);if(!m&&!sa(t))return $o([new yr("","data expressions not supported")]);const y=As(h,["zoom"]);if(!y&&!qu(t))return $o([new yr("","zoom expressions not supported")]);const v=Ra(h);return v||y?v instanceof yr?$o([v]):v instanceof di&&!yl(t)?$o([new yr("",'"interpolate" expressions cannot be used with this property')]):fc(v?new _l(m?"camera":"composite",s.value,v.labels,v instanceof di?v.interpolation:void 0,r):new Yo(m?"constant":"source",s.value,r)):$o([new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class wi{constructor(t,r){this._parameters=t,this._specification=r,_i(this,Xc(this._parameters,this._specification))}static deserialize(t){return new wi(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ra(i){let t=null;if(i instanceof ps)t=Ra(i.result);else if(i instanceof _s){for(const r of i.args)if(t=Ra(r),t)break}else(i instanceof wr||i instanceof di)&&i.input instanceof oa&&i.input.name==="zoom"&&(t=i);return t instanceof yr||i.eachChild((r=>{const s=Ra(r);s instanceof yr?t=s:!t&&s?t=new yr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&s&&t!==s&&(t=new yr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}function ua(i,t=new Set){return i instanceof dc&&t.add(i.key),i.eachChild((r=>{ua(r,t)})),t}function Li(i,t){const{zoom:r,heatmapDensity:s,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:v}=i??{};return{zoom:r,heatmapDensity:s,elevation:h,lineProgress:m,isSupportedScript:y,accumulated:v,globalState:t}}function Da(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const t of i.slice(1))if(!Da(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Kc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function wo(i,t){if(i==null)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Da(i)||(i=ur(i));const r=ro(i,Kc,t);if(r.result==="error")throw new Error(r.value.map((s=>`${s.key}: ${s.message}`)).join(", "));return{filter:(s,h,m)=>r.value.evaluate(s,h,{},m),needGeometry:Gr(i),getGlobalStateRefs:()=>ua(r.value.expression)}}function gc(i,t){return i<t?-1:i>t?1:0}function Gr(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let t=1;t<i.length;t++)if(Gr(i[t]))return!0;return!1}function ur(i){if(!i)return!0;const t=i[0];return i.length<=1?t!=="any":t==="=="?Mn(i[1],i[2],"=="):t==="!="?vl(Mn(i[1],i[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Mn(i[1],i[2],t):t==="any"?(r=i.slice(1),["any"].concat(r.map(ur))):t==="all"?["all"].concat(i.slice(1).map(ur)):t==="none"?["all"].concat(i.slice(1).map(ur).map(vl)):t==="in"?Ko(i[1],i.slice(2)):t==="!in"?vl(Ko(i[1],i.slice(2))):t==="has"?Ia(i[1]):t!=="!has"||vl(Ia(i[1]));var r}function Mn(i,t,r){switch(i){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,i,t]}}function Ko(i,t){if(t.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((r=>typeof r!=typeof t[0]))?["filter-in-large",i,["literal",t.sort(gc)]]:["filter-in-small",i,["literal",t]]}}function Ia(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function vl(i){return["!",i]}function So(i){const t=typeof i;if(t==="number"||t==="boolean"||t==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let h="[";for(const m of i)h+=`${So(m)},`;return`${h}]`}const r=Object.keys(i).sort();let s="{";for(let h=0;h<r.length;h++)s+=`${JSON.stringify(r[h])}:${So(i[r[h]])},`;return`${s}}`}function Xu(i){let t="";for(const r of Gt)t+=`/${So(i[r])}`;return t}function Qc(i){const t=i.value;return t?[new lt(i.key,t,"constants have been deprecated as of v8")]:[]}function Bn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function za(i){if(Array.isArray(i))return i.map(za);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const t={};for(const r in i)t[r]=za(i[r]);return t}return Bn(i)}function Yi(i){const t=i.key,r=i.value,s=i.valueSpec||{},h=i.objectElementValidators||{},m=i.style,y=i.styleSpec,v=i.validateSpec;let w=[];const C=sn(r);if(C!=="object")return[new lt(t,r,`object expected, ${C} found`)];for(const M in r){const z=M.split(".")[0],B=ds(s,z)||s["*"];let U;if(ds(h,z))U=h[z];else if(ds(s,z))U=v;else if(h["*"])U=h["*"];else{if(!s["*"]){w.push(new lt(t,r[M],`unknown property "${M}"`));continue}U=v}w=w.concat(U({key:(t&&`${t}.`)+M,value:r[M],valueSpec:B,style:m,styleSpec:y,object:r,objectKey:M,validateSpec:v},r))}for(const M in s)h[M]||s[M].required&&s[M].default===void 0&&r[M]===void 0&&w.push(new lt(t,r,`missing required property "${M}"`));return w}function Qo(i){const t=i.value,r=i.valueSpec,s=i.style,h=i.styleSpec,m=i.key,y=i.arrayElementValidator||i.validateSpec;if(sn(t)!=="array")return[new lt(m,t,`array expected, ${sn(t)} found`)];if(r.length&&t.length!==r.length)return[new lt(m,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new lt(m,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let v={type:r.value,values:r.values};h.$version<7&&(v.function=r.function),sn(r.value)==="object"&&(v=r.value);let w=[];for(let C=0;C<t.length;C++)w=w.concat(y({array:t,arrayIndex:C,value:t[C],valueSpec:v,validateSpec:i.validateSpec,style:s,styleSpec:h,key:`${m}[${C}]`}));return w}function xl(i){const t=i.key,r=i.value,s=i.valueSpec;let h=sn(r);return h==="number"&&r!=r&&(h="NaN"),h!=="number"?[new lt(t,r,`number expected, ${h} found`)]:"minimum"in s&&r<s.minimum?[new lt(t,r,`${r} is less than the minimum value ${s.minimum}`)]:"maximum"in s&&r>s.maximum?[new lt(t,r,`${r} is greater than the maximum value ${s.maximum}`)]:[]}function Po(i){const t=i.valueSpec,r=Bn(i.value.type);let s,h,m,y={};const v=r!=="categorical"&&i.value.property===void 0,w=!v,C=sn(i.value.stops)==="array"&&sn(i.value.stops[0])==="array"&&sn(i.value.stops[0][0])==="object",M=Yi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(U){if(r==="identity")return[new lt(U.key,U.value,'identity function may not have a "stops" property')];let V=[];const $=U.value;return V=V.concat(Qo({key:U.key,value:$,valueSpec:U.valueSpec,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:z})),sn($)==="array"&&$.length===0&&V.push(new lt(U.key,$,"array must have at least one stop")),V},default:function(U){return U.validateSpec({key:U.key,value:U.value,valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec})}}});return r==="identity"&&v&&M.push(new lt(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||M.push(new lt(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!yl(i.valueSpec)&&M.push(new lt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(w&&!sa(i.valueSpec)?M.push(new lt(i.key,i.value,"property functions not supported")):v&&!qu(i.valueSpec)&&M.push(new lt(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!C||i.value.property!==void 0||M.push(new lt(i.key,i.value,'"property" property is required')),M;function z(U){let V=[];const $=U.value,Q=U.key;if(sn($)!=="array")return[new lt(Q,$,`array expected, ${sn($)} found`)];if($.length!==2)return[new lt(Q,$,`array length 2 expected, length ${$.length} found`)];if(C){if(sn($[0])!=="object")return[new lt(Q,$,`object expected, ${sn($[0])} found`)];if($[0].zoom===void 0)return[new lt(Q,$,"object stop key must have zoom")];if($[0].value===void 0)return[new lt(Q,$,"object stop key must have value")];if(m&&m>Bn($[0].zoom))return[new lt(Q,$[0].zoom,"stop zoom values must appear in ascending order")];Bn($[0].zoom)!==m&&(m=Bn($[0].zoom),h=void 0,y={}),V=V.concat(Yi({key:`${Q}[0]`,value:$[0],valueSpec:{zoom:{}},validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:xl,value:B}}))}else V=V.concat(B({key:`${Q}[0]`,value:$[0],validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec},$));return bo(za($[1]))?V.concat([new lt(`${Q}[1]`,$[1],"expressions are not allowed in function stops.")]):V.concat(U.validateSpec({key:`${Q}[1]`,value:$[1],valueSpec:t,validateSpec:U.validateSpec,style:U.style,styleSpec:U.styleSpec}))}function B(U,V){const $=sn(U.value),Q=Bn(U.value),re=U.value!==null?U.value:V;if(s){if($!==s)return[new lt(U.key,re,`${$} stop domain type must match previous stop domain type ${s}`)]}else s=$;if($!=="number"&&$!=="string"&&$!=="boolean")return[new lt(U.key,re,"stop domain value must be a number, string, or boolean")];if($!=="number"&&r!=="categorical"){let Te=`number expected, ${$} found`;return sa(t)&&r===void 0&&(Te+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new lt(U.key,re,Te)]}return r!=="categorical"||$!=="number"||isFinite(Q)&&Math.floor(Q)===Q?r!=="categorical"&&$==="number"&&h!==void 0&&Q<h?[new lt(U.key,re,"stop domain values must appear in ascending order")]:(h=Q,r==="categorical"&&Q in y?[new lt(U.key,re,"stop domain values must be unique")]:(y[Q]=!0,[])):[new lt(U.key,re,`integer expected, found ${Q}`)]}}function ki(i){const t=(i.expressionContext==="property"?ca:ro)(za(i.value),i.valueSpec);if(t.result==="error")return t.value.map((s=>new lt(`${i.key}${s.key}`,i.value,s.message)));const r=t.value.expression||t.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new lt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!Ts(r))return[new lt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!Ts(r))return[new lt(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!As(r,["zoom","feature-state"]))return[new lt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!xo(r))return[new lt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ki(i){const t=i.key,r=i.value,s=sn(r);return s!=="string"?[new lt(t,r,`color expected, ${s} found`)]:hn.parse(String(r))?[]:[new lt(t,r,`color expected, "${r}" found`)]}function ha(i){const t=i.key,r=i.value,s=i.valueSpec,h=[];return Array.isArray(s.values)?s.values.indexOf(Bn(r))===-1&&h.push(new lt(t,r,`expected one of [${s.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(s.values).indexOf(Bn(r))===-1&&h.push(new lt(t,r,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(r)} found`)),h}function yc(i){return Da(za(i.value))?ki(_i({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Jc(i)}function Jc(i){const t=i.value,r=i.key;if(sn(t)!=="array")return[new lt(r,t,`array expected, ${sn(t)} found`)];const s=i.styleSpec;let h,m=[];if(t.length<1)return[new lt(r,t,"filter array must have at least 1 element")];switch(m=m.concat(ha({key:`${r}[0]`,value:t[0],valueSpec:s.filter_operator,style:i.style,styleSpec:i.styleSpec})),Bn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Bn(t[1])==="$type"&&m.push(new lt(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&m.push(new lt(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(h=sn(t[1]),h!=="string"&&m.push(new lt(`${r}[1]`,t[1],`string expected, ${h} found`)));for(let y=2;y<t.length;y++)h=sn(t[y]),Bn(t[1])==="$type"?m=m.concat(ha({key:`${r}[${y}]`,value:t[y],valueSpec:s.geometry_type,style:i.style,styleSpec:i.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new lt(`${r}[${y}]`,t[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<t.length;y++)m=m.concat(Jc({key:`${r}[${y}]`,value:t[y],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":h=sn(t[1]),t.length!==2?m.push(new lt(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new lt(`${r}[1]`,t[1],`string expected, ${h} found`))}return m}function bl(i,t){const r=i.key,s=i.validateSpec,h=i.style,m=i.styleSpec,y=i.value,v=i.objectKey,w=m[`${t}_${i.layerType}`];if(!w)return[];const C=v.match(/^(.*)-transition$/);if(t==="paint"&&C&&w[C[1]]&&w[C[1]].transition)return s({key:r,value:y,valueSpec:m.transition,style:h,styleSpec:m});const M=i.valueSpec||w[v];if(!M)return[new lt(r,y,`unknown property "${v}"`)];let z;if(sn(y)==="string"&&sa(M)&&!M.tokens&&(z=/^{([^}]+)}$/.exec(y)))return[new lt(r,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const B=[];return i.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&B.push(new lt(r,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&pc(za(y))&&Bn(y.type)==="identity"&&B.push(new lt(r,y,'"text-font" does not support identity functions'))),B.concat(s({key:i.key,value:y,valueSpec:M,style:h,styleSpec:m,expressionContext:"property",propertyType:t,propertyKey:v}))}function _c(i){return bl(i,"paint")}function Jo(i){return bl(i,"layout")}function Rr(i){let t=[];const r=i.value,s=i.key,h=i.style,m=i.styleSpec;if(sn(r)!=="object")return[new lt(s,r,`object expected, ${sn(r)} found`)];r.type||r.ref||t.push(new lt(s,r,'either "type" or "ref" is required'));let y=Bn(r.type);const v=Bn(r.ref);if(r.id){const w=Bn(r.id);for(let C=0;C<i.arrayIndex;C++){const M=h.layers[C];Bn(M.id)===w&&t.push(new lt(s,r.id,`duplicate layer id "${r.id}", previously used at line ${M.id.__line__}`))}}if("ref"in r){let w;["type","source","source-layer","filter","layout"].forEach((C=>{C in r&&t.push(new lt(s,r[C],`"${C}" is prohibited for ref layers`))})),h.layers.forEach((C=>{Bn(C.id)===v&&(w=C)})),w?w.ref?t.push(new lt(s,r.ref,"ref cannot reference another ref layer")):y=Bn(w.type):t.push(new lt(s,r.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(r.source){const w=h.sources&&h.sources[r.source],C=w&&Bn(w.type);w?C==="vector"&&y==="raster"?t.push(new lt(s,r.source,`layer "${r.id}" requires a raster source`)):C!=="raster-dem"&&y==="hillshade"||C!=="raster-dem"&&y==="color-relief"?t.push(new lt(s,r.source,`layer "${r.id}" requires a raster-dem source`)):C==="raster"&&y!=="raster"?t.push(new lt(s,r.source,`layer "${r.id}" requires a vector source`)):C!=="vector"||r["source-layer"]?C==="raster-dem"&&y!=="hillshade"&&y!=="color-relief"?t.push(new lt(s,r.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):y!=="line"||!r.paint||!r.paint["line-gradient"]||C==="geojson"&&w.lineMetrics||t.push(new lt(s,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new lt(s,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new lt(s,r.source,`source "${r.source}" not found`))}else t.push(new lt(s,r,'missing required property "source"'));return t=t.concat(Yi({key:s,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${s}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:r,objectKey:"type"}),filter:yc,layout:w=>Yi({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":C=>Jo(_i({layerType:y},C))}}),paint:w=>Yi({layer:r,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":C=>_c(_i({layerType:y},C))}})}})),t}function Qi(i){const t=i.value,r=i.key,s=sn(t);return s!=="string"?[new lt(r,t,`string expected, ${s} found`)]:[]}const Oi={promoteId:function({key:i,value:t}){if(sn(t)==="string")return Qi({key:i,value:t});{const r=[];for(const s in t)r.push(...Qi({key:`${i}.${s}`,value:t[s]}));return r}}};function wl(i){const t=i.value,r=i.key,s=i.styleSpec,h=i.style,m=i.validateSpec;if(!t.type)return[new lt(r,t,'"type" is required')];const y=Bn(t.type);let v;switch(y){case"vector":case"raster":return v=Yi({key:r,value:t,valueSpec:s[`source_${y.replace("-","_")}`],style:i.style,styleSpec:s,objectElementValidators:Oi,validateSpec:m}),v;case"raster-dem":return v=(function(w){var C;const M=(C=w.sourceName)!==null&&C!==void 0?C:"",z=w.value,B=w.styleSpec,U=B.source_raster_dem,V=w.style;let $=[];const Q=sn(z);if(z===void 0)return $;if(Q!=="object")return $.push(new lt("source_raster_dem",z,`object expected, ${Q} found`)),$;const re=Bn(z.encoding)==="custom",Te=["redFactor","greenFactor","blueFactor","baseShift"],ce=w.value.encoding?`"${w.value.encoding}"`:"Default";for(const pe in z)!re&&Te.includes(pe)?$.push(new lt(pe,z[pe],`In "${M}": "${pe}" is only valid when "encoding" is set to "custom". ${ce} encoding found`)):U[pe]?$=$.concat(w.validateSpec({key:pe,value:z[pe],valueSpec:U[pe],validateSpec:w.validateSpec,style:V,styleSpec:B})):$.push(new lt(pe,z[pe],`unknown property "${pe}"`));return $})({sourceName:r,value:t,style:i.style,styleSpec:s,validateSpec:m}),v;case"geojson":if(v=Yi({key:r,value:t,valueSpec:s.source_geojson,style:h,styleSpec:s,validateSpec:m,objectElementValidators:Oi}),t.cluster)for(const w in t.clusterProperties){const[C,M]=t.clusterProperties[w],z=typeof C=="string"?[C,["accumulated"],["get",w]]:C;v.push(...ki({key:`${r}.${w}.map`,value:M,expressionContext:"cluster-map"})),v.push(...ki({key:`${r}.${w}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return v;case"video":return Yi({key:r,value:t,valueSpec:s.source_video,style:h,validateSpec:m,styleSpec:s});case"image":return Yi({key:r,value:t,valueSpec:s.source_image,style:h,validateSpec:m,styleSpec:s});case"canvas":return[new lt(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ha({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Yu(i){const t=i.value,r=i.styleSpec,s=r.light,h=i.style;let m=[];const y=sn(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new lt("light",t,`object expected, ${y} found`)]),m;for(const v in t){const w=v.match(/^(.*)-transition$/);m=m.concat(w&&s[w[1]]&&s[w[1]].transition?i.validateSpec({key:v,value:t[v],valueSpec:r.transition,validateSpec:i.validateSpec,style:h,styleSpec:r}):s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:i.validateSpec,style:h,styleSpec:r}):[new lt(v,t[v],`unknown property "${v}"`)])}return m}function ed(i){const t=i.value,r=i.styleSpec,s=r.sky,h=i.style,m=sn(t);if(t===void 0)return[];if(m!=="object")return[new lt("sky",t,`object expected, ${m} found`)];let y=[];for(const v in t)y=y.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],style:h,styleSpec:r}):[new lt(v,t[v],`unknown property "${v}"`)]);return y}function Ur(i){const t=i.value,r=i.styleSpec,s=r.terrain,h=i.style;let m=[];const y=sn(t);if(t===void 0)return m;if(y!=="object")return m=m.concat([new lt("terrain",t,`object expected, ${y} found`)]),m;for(const v in t)m=m.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],validateSpec:i.validateSpec,style:h,styleSpec:r}):[new lt(v,t[v],`unknown property "${v}"`)]);return m}function es(i){let t=[];const r=i.value,s=i.key;if(Array.isArray(r)){const h=[],m=[];for(const y in r)r[y].id&&h.includes(r[y].id)&&t.push(new lt(s,r,`all the sprites' ids must be unique, but ${r[y].id} is duplicated`)),h.push(r[y].id),r[y].url&&m.includes(r[y].url)&&t.push(new lt(s,r,`all the sprites' URLs must be unique, but ${r[y].url} is duplicated`)),m.push(r[y].url),t=t.concat(Yi({key:`${s}[${y}]`,value:r[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return t}return Qi({key:s,value:r})}function Es(i){return t=i.value,t&&t.constructor===Object?[]:[new lt(i.key,i.value,`object expected, ${sn(i.value)} found`)];var t}const ts={"*":()=>[],array:Qo,boolean:function(i){const t=i.value,r=i.key,s=sn(t);return s!=="boolean"?[new lt(r,t,`boolean expected, ${s} found`)]:[]},number:xl,color:Ki,constants:Qc,enum:ha,filter:yc,function:Po,layer:Rr,object:Yi,source:wl,light:Yu,sky:ed,terrain:Ur,projection:function(i){const t=i.value,r=i.styleSpec,s=r.projection,h=i.style,m=sn(t);if(t===void 0)return[];if(m!=="object")return[new lt("projection",t,`object expected, ${m} found`)];let y=[];for(const v in t)y=y.concat(s[v]?i.validateSpec({key:v,value:t[v],valueSpec:s[v],style:h,styleSpec:r}):[new lt(v,t[v],`unknown property "${v}"`)]);return y},projectionDefinition:function(i){const t=i.key;let r=i.value;r=r instanceof String?r.valueOf():r;const s=sn(r);return s!=="array"||(function(h){return Array.isArray(h)&&h.length===3&&typeof h[0]=="string"&&typeof h[1]=="string"&&typeof h[2]=="number"})(r)||(function(h){return!!["interpolate","step","literal"].includes(h[0])})(r)?["array","string"].includes(s)?[]:[new lt(t,r,`projection expected, invalid type "${s}" found`)]:[new lt(t,r,`projection expected, invalid array ${JSON.stringify(r)} found`)]},string:Qi,formatted:function(i){return Qi(i).length===0?[]:ki(i)},resolvedImage:function(i){return Qi(i).length===0?[]:ki(i)},padding:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){if(r.length<1||r.length>4)return[new lt(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];const s={type:"number"};let h=[];for(let m=0;m<r.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return xl({key:t,value:r,valueSpec:{}})},numberArray:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){const s={type:"number"};if(r.length<1)return[new lt(t,r,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<r.length;m++)h=h.concat(i.validateSpec({key:`${t}[${m}]`,value:r[m],validateSpec:i.validateSpec,valueSpec:s}));return h}return xl({key:t,value:r,valueSpec:{}})},colorArray:function(i){const t=i.key,r=i.value;if(sn(r)==="array"){if(r.length<1)return[new lt(t,r,"array length at least 1 expected, length 0 found")];let s=[];for(let h=0;h<r.length;h++)s=s.concat(Ki({key:`${t}[${h}]`,value:r[h]}));return s}return Ki({key:t,value:r})},variableAnchorOffsetCollection:function(i){const t=i.key,r=i.value,s=sn(r),h=i.styleSpec;if(s!=="array"||r.length<1||r.length%2!=0)return[new lt(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<r.length;y+=2)m=m.concat(ha({key:`${t}[${y}]`,value:r[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(Qo({key:`${t}[${y+1}]`,value:r[y+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:h}));return m},sprite:es,state:Es};function Sl(i){const t=i.value,r=i.valueSpec,s=i.styleSpec;return i.validateSpec=Sl,r.expression&&pc(Bn(t))?Po(i):r.expression&&bo(za(t))?ki(i):r.type&&ts[r.type]?ts[r.type](i):Yi(_i({},i,{valueSpec:r.type?s[r.type]:r}))}function Co(i){const t=i.value,r=i.key,s=Qi(i);return s.length||(t.indexOf("{fontstack}")===-1&&s.push(new lt(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&s.push(new lt(r,t,'"glyphs" url must include a "{range}" token'))),s}function fi(i,t=Ce){let r=[];return r=r.concat(Sl({key:"",value:i,valueSpec:t.$root,styleSpec:t,style:i,validateSpec:Sl,objectElementValidators:{glyphs:Co,"*":()=>[]}})),i.constants&&(r=r.concat(Qc({key:"constants",value:i.constants}))),Ku(r)}function Bi(i){return function(t){return i({...t,validateSpec:Sl})}}function Ku(i){return[].concat(i).sort(((t,r)=>t.line-r.line))}function La(i){return function(...t){return Ku(i.apply(this,t))}}fi.source=La(Bi(wl)),fi.sprite=La(Bi(es)),fi.glyphs=La(Bi(Co)),fi.light=La(Bi(Yu)),fi.sky=La(Bi(ed)),fi.terrain=La(Bi(Ur)),fi.state=La(Bi(Es)),fi.layer=La(Bi(Rr)),fi.filter=La(Bi(yc)),fi.paintProperty=La(Bi(_c)),fi.layoutProperty=La(Bi(Jo));const Ms=fi,ka=Ms.light,Qu=Ms.sky,eu=Ms.paintProperty,vc=Ms.layoutProperty;function Pl(i,t){let r=!1;if(t&&t.length)for(const s of t)i.fire(new Ye(new Error(s.message))),r=!0;return r}class ns{constructor(t,r,s){const h=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const y=new Int32Array(this.arrayBuffer);t=y[0],this.d=(r=y[1])+2*(s=y[2]);for(let w=0;w<this.d*this.d;w++){const C=y[3+w],M=y[3+w+1];h.push(C===M?null:y.subarray(C,M))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*s;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=s,this.scale=r/t,this.uid=0;const m=s/r*t;this.min=-m,this.max=t+m}insert(t,r,s,h,m){this._forEachCell(r,s,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,s,h,m,y){this.cells[m].push(y)}query(t,r,s,h,m){const y=this.min,v=this.max;if(t<=y&&r<=y&&v<=s&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const w=[];return this._forEachCell(t,r,s,h,this._queryCell,w,{},m),w}}_queryCell(t,r,s,h,m,y,v,w){const C=this.cells[m];if(C!==null){const M=this.keys,z=this.bboxes;for(let B=0;B<C.length;B++){const U=C[B];if(v[U]===void 0){const V=4*U;(w?w(z[V+0],z[V+1],z[V+2],z[V+3]):t<=z[V+2]&&r<=z[V+3]&&s>=z[V+0]&&h>=z[V+1])?(v[U]=!0,y.push(M[U])):v[U]=!1}}}}_forEachCell(t,r,s,h,m,y,v,w){const C=this._convertToCellCoord(t),M=this._convertToCellCoord(r),z=this._convertToCellCoord(s),B=this._convertToCellCoord(h);for(let U=C;U<=z;U++)for(let V=M;V<=B;V++){const $=this.d*V+U;if((!w||w(this._convertFromCellCoord(U),this._convertFromCellCoord(V),this._convertFromCellCoord(U+1),this._convertFromCellCoord(V+1)))&&m.call(this,t,r,s,h,$,y,v,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,r=3+this.cells.length+1+1;let s=0;for(let y=0;y<this.cells.length;y++)s+=this.cells[y].length;const h=new Int32Array(r+s+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=r;for(let y=0;y<t.length;y++){const v=t[y];h[3+y]=m,h.set(v,m),m+=v.length}return h[3+t.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+t.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(t,r){const s=t.toArrayBuffer();return r&&r.push(s),{buffer:s}}static deserialize(t){return new ns(t.buffer)}}const Fi={};function bt(i,t,r={}){if(Fi[i])throw new Error(`${i} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:i,writeable:!1}),Fi[i]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}bt("Object",Object),bt("Set",Set),bt("TransferableGridIndex",ns),bt("Color",hn),bt("Error",Error),bt("AJAXError",se),bt("ResolvedImage",hi),bt("StylePropertyFunction",wi),bt("StyleExpression",mc,{omit:["_evaluator"]}),bt("ZoomDependentExpression",_l),bt("ZoomConstantExpression",Yo),bt("CompoundExpression",oa,{omit:["_evaluate"]});for(const i in Cs)Cs[i]._classRegistryKey||bt(`Expression_${i}`,Cs[i]);function tu(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Rs(i){return i.$name||i.constructor._classRegistryKey}function nu(i){return!(function(t){if(t===null||typeof t!="object")return!1;const r=Rs(t);return!(!r||r==="Object")})(i)&&(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||tu(i)||Kr(i)||ArrayBuffer.isView(i)||i instanceof ImageData)}function Oa(i,t){if(nu(i))return(tu(i)||Kr(i))&&t&&t.push(i),ArrayBuffer.isView(i)&&t&&t.push(i.buffer),i instanceof ImageData&&t&&t.push(i.data.buffer),i;if(Array.isArray(i)){const m=[];for(const y of i)m.push(Oa(y,t));return m}if(typeof i!="object")throw new Error("can't serialize object of type "+typeof i);const r=Rs(i);if(!r)throw new Error(`can't serialize object of unregistered class ${i.constructor.name}`);if(!Fi[r])throw new Error(`${r} is not registered.`);const{klass:s}=Fi[r],h=s.serialize?s.serialize(i,t):{};if(s.serialize){if(t&&h===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||Fi[r].omit.indexOf(m)>=0)continue;const y=i[m];h[m]=Fi[r].shallow.indexOf(m)>=0?y:Oa(y,t)}i instanceof Error&&(h.message=i.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(h.$name=r),h}function Ds(i){if(nu(i))return i;if(Array.isArray(i))return i.map(Ds);if(typeof i!="object")throw new Error("can't deserialize object of type "+typeof i);const t=Rs(i)||"Object";if(!Fi[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:r}=Fi[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(i);const s=Object.create(r.prototype);for(const h of Object.keys(i)){if(h==="$name")continue;const m=i[h];s[h]=Fi[t].shallow.indexOf(h)>=0?m:Ds(m)}return s}class ru{constructor(){this.first=!0}update(t,r){const s=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=r),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=s,!0))}}const en={"Latin-1 Supplement":i=>i>=128&&i<=255,"Hangul Jamo":i=>i>=4352&&i<=4607,Khmer:i=>i>=6016&&i<=6143,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Kanbun:i=>i>=12688&&i<=12703,"CJK Strokes":i=>i>=12736&&i<=12783,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Hangul Syllables":i=>i>=44032&&i<=55215,"Private Use Area":i=>i>=57344&&i<=63743,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function xc(i){for(const t of i)if(bc(t.charCodeAt(0)))return!0;return!1}function iu(i){for(const t of i)if(!Cl(t.charCodeAt(0)))return!1;return!0}function io(i){const t=i.map((r=>{try{return new RegExp(`\\p{sc=${r}}`,"u").source}catch{return null}})).filter((r=>r));return new RegExp(t.join("|"),"u")}const To=io(["Arab","Dupl","Mong","Ougr","Syrc"]);function Cl(i){return!To.test(String.fromCodePoint(i))}const au=io(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function bc(i){return!(i!==746&&i!==747&&(i<4352||!(en["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||en["CJK Compatibility"](i)||en["CJK Strokes"](i)||!(!en["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||en["Enclosed CJK Letters and Months"](i)||en["Ideographic Description Characters"](i)||en.Kanbun(i)||en.Katakana(i)&&i!==12540||!(!en["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!en["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||en["Vertical Forms"](i)||en["Yijing Hexagram Symbols"](i)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(i))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(i))||au.test(String.fromCodePoint(i)))))}function Is(i){return!(bc(i)||(function(t){return!!(en["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||en["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||en["Letterlike Symbols"](t)||en["Number Forms"](t)||en["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||en["Control Pictures"](t)&&t!==9251||en["Optical Character Recognition"](t)||en["Enclosed Alphanumerics"](t)||en["Geometric Shapes"](t)||en["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||en["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||en["CJK Symbols and Punctuation"](t)||en.Katakana(t)||en["Private Use Area"](t)||en["CJK Compatibility Forms"](t)||en["Small Form Variants"](t)||en["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)})(i))}const Tl=io(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function ou(i){return Tl.test(String.fromCodePoint(i))}function Ju(i,t){return!(!t&&ou(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||en.Khmer(i))}function Ao(i){for(const t of i)if(ou(t.charCodeAt(0)))return!0;return!1}const Ba=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(i){this.pluginStatus=i.pluginStatus,this.pluginURL=i.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(i){if(Ba.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=i.applyArabicShaping,this.processBidirectionalText=i.processBidirectionalText,this.processStyledBidirectionalText=i.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(i,t){return c(this,void 0,void 0,(function*(){if(this.isParsed())return this.getState();if(i.pluginStatus!=="loading")return this.setState(i),i;const r=i.pluginURL,s=new Promise((m=>{this.loadScriptResolve=m}));t(r);const h=new Promise((m=>setTimeout((()=>m()),this.TIMEOUT)));if(yield Promise.race([s,h]),this.isParsed()){const m={pluginStatus:"loaded",pluginURL:r};return this.setState(m),m}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${r}`)}))}};class Ln{constructor(t,r){this.isSupportedScript=eh,this.zoom=t,r?(this.now=r.now||0,this.fadeDuration=r.fadeDuration||0,this.zoomHistory=r.zoomHistory||new ru,this.transition=r.transition||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new ru,this.transition={})}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,r=t-Math.floor(t),s=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*r}}}function eh(i){return(function(t,r){for(const s of t)if(!Ju(s.charCodeAt(0),r))return!1;return!0})(i,Ba.getRTLTextPluginStatus()==="loaded")}class Al{constructor(t,r,s){this.property=t,this.value=r,this.expression=(function(h,m,y){if(pc(h))return new wi(h,m);if(bo(h)){const v=ca(h,m,y);if(v.result==="error")throw new Error(v.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return v.value}{let v=h;return m.type==="color"&&typeof h=="string"?v=hn.parse(h):m.type!=="padding"||typeof h!="number"&&!Array.isArray(h)?m.type!=="numberArray"||typeof h!="number"&&!Array.isArray(h)?m.type!=="colorArray"||typeof h!="string"&&!Array.isArray(h)?m.type==="variableAnchorOffsetCollection"&&Array.isArray(h)?v=ui.parse(h):m.type==="projectionDefinition"&&typeof h=="string"&&(v=vr.parse(h)):v=Mr.parse(h):v=ci.parse(h):v=Hr.parse(h),{globalStateRefs:new Set,_globalState:null,kind:"constant",evaluate:()=>v}}})(r===void 0?t.specification.default:r,t.specification,s)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(t,r,s){return this.property.possiblyEvaluate(this,t,r,s)}}class Fa{constructor(t,r){this.property=t,this.value=new Al(t,void 0,r)}transitioned(t,r){return new kn(this.property,this.value,r,Ht({},t.transition,this.transition),t.now)}untransitioned(){return new kn(this.property,this.value,null,{},0)}}class pn{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._globalState=r}getValue(t){return St(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fa(this._values[t].property,this._globalState)),this._values[t].value=new Al(this._values[t].property,r===null?void 0:St(r),this._globalState)}getTransition(t){return St(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fa(this._values[t].property,this._globalState)),this._values[t].transition=St(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);s!==void 0&&(t[r]=s);const h=this.getTransition(r);h!==void 0&&(t[`${r}-transition`]=h)}return t}transitioned(t,r){const s=new Dr(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(t,r._values[h]);return s}untransitioned(){const t=new Dr(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class kn{constructor(t,r,s,h,m){this.property=t,this.value=r,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,t.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(t,r,s){const h=t.now||0,m=this.value.possiblyEvaluate(t,r,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(t,r,s);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(t,r,s),m,st(v))}}return m}}class Dr{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,s){const h=new ao(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,s);return h}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class su{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._globalState=r}hasValue(t){return this._values[t].value!==void 0}getValue(t){return St(this._values[t].value)}setValue(t,r){this._values[t]=new Al(this._values[t].property,r===null?void 0:St(r),this._globalState)}serialize(){const t={};for(const r of Object.keys(this._values)){const s=this.getValue(r);s!==void 0&&(t[r]=s)}return t}possiblyEvaluate(t,r,s){const h=new ao(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(t,r,s);return h}}class Ni{constructor(t,r,s){this.property=t,this.value=r,this.parameters=s}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,s,h){return this.property.evaluate(this.value,this.parameters,t,r,s,h)}}class ao{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Ct{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,s){const h=to[this.specification.type];return h?h(t,r,s):t}}class zt{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,s,h){return new Ni(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},s,h)}:t.expression,r)}interpolate(t,r,s){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Ni(this,{kind:"constant",value:void 0},t.parameters);const h=to[this.specification.type];if(h){const m=h(t.value.value,r.value.value,s);return new Ni(this,{kind:"constant",value:m},t.parameters)}return t}evaluate(t,r,s,h,m,y){return t.kind==="constant"?t.value:t.evaluate(r,s,h,m,y)}}class Eo extends zt{possiblyEvaluate(t,r,s,h){if(t.value===void 0)return new Ni(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},s,h),y=t.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(y,y,y,r);return new Ni(this,{kind:"constant",value:v},r)}if(t.expression.kind==="camera"){const m=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Ni(this,{kind:"constant",value:m},r)}return new Ni(this,t.expression,r)}evaluate(t,r,s,h,m,y){if(t.kind==="source"){const v=t.evaluate(r,s,h,m,y);return this._calculate(v,v,v,r)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},s,h),t.evaluate({zoom:Math.floor(r.zoom)},s,h),t.evaluate({zoom:Math.floor(r.zoom)+1},s,h),r):t.value}_calculate(t,r,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:s,to:r}}interpolate(t){return t}}class th{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,h){if(t.value!==void 0){if(t.expression.kind==="constant"){const m=t.expression.evaluate(r,null,{},s,h);return this._calculate(m,m,m,r)}return this._calculate(t.expression.evaluate(new Ln(Math.floor(r.zoom-1),r)),t.expression.evaluate(new Ln(Math.floor(r.zoom),r)),t.expression.evaluate(new Ln(Math.floor(r.zoom+1),r)),r)}}_calculate(t,r,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:s,to:r}}interpolate(t){return t}}class fr{constructor(t){this.specification=t}possiblyEvaluate(t,r,s,h){return!!t.expression.evaluate(r,null,{},s,h)}interpolate(){return!1}}class ei{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in t){const s=t[r];s.specification.overridable&&this.overridableProperties.push(r);const h=this.defaultPropertyValues[r]=new Al(s,void 0,void 0),m=this.defaultTransitionablePropertyValues[r]=new Fa(s,void 0);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=h.possiblyEvaluate({})}}}bt("DataDrivenProperty",zt),bt("DataConstantProperty",Ct),bt("CrossFadedDataDrivenProperty",Eo),bt("CrossFadedProperty",th),bt("ColorRampProperty",fr);const lu="-transition";class ba extends Pt{constructor(t,r,s){if(super(),this.id=t.id,this.type=t.type,this._globalState=s,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter,this._featureFilter=wo(t.filter,s)),r.layout&&(this._unevaluatedLayout=new su(r.layout,s)),r.paint)){this._transitionablePaint=new pn(r.paint,s);for(const h in t.paint)this.setPaintProperty(h,t.paint[h],{validate:!1});for(const h in t.layout)this.setLayoutProperty(h,t.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ao(r.paint)}}setFilter(t){this.filter=t,this._featureFilter=wo(t,this._globalState)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}getLayoutAffectingGlobalStateRefs(){const t=new Set;if(this._unevaluatedLayout)for(const r in this._unevaluatedLayout._values){const s=this._unevaluatedLayout._values[r];for(const h of s.getGlobalStateRefs())t.add(h)}for(const r of this._featureFilter.getGlobalStateRefs())t.add(r);return t}getPaintAffectingGlobalStateRefs(){var t;const r=new globalThis.Map;if(this._transitionablePaint)for(const s in this._transitionablePaint._values){const h=this._transitionablePaint._values[s].value;for(const m of h.getGlobalStateRefs()){const y=(t=r.get(m))!==null&&t!==void 0?t:[];y.push({name:s,value:h.value}),r.set(m,y)}}return r}setLayoutProperty(t,r,s={}){r!=null&&this._validate(vc,`layers.${this.id}.layout.${t}`,t,r,s)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,r):this.visibility=r)}getPaintProperty(t){return t.endsWith(lu)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,s={}){if(r!=null&&this._validate(eu,`layers.${this.id}.paint.${t}`,t,r,s))return!1;if(t.endsWith(lu))return this._transitionablePaint.setTransition(t.slice(0,-11),r||void 0),!1;{const h=this._transitionablePaint._values[t],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);const w=this._transitionablePaint._values[t].value;return w.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(t,v,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,s){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),xn(t,((r,s)=>!(r===void 0||s==="layout"&&!Object.keys(r).length||s==="paint"&&!Object.keys(r).length)))}_validate(t,r,s,h,m={}){return(!m||m.validate!==!1)&&Pl(this,t.call(Ms,{key:r,layerType:this.type,objectKey:s,value:h,styleSpec:Ce,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof Ni&&sa(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const rs={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class El{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function pr(i,t=1){let r=0,s=0;return{members:i.map((h=>{const m=rs[h.type].BYTES_PER_ELEMENT,y=r=Ml(r,Math.max(t,m)),v=h.components||1;return s=Math.max(s,m),r+=m*v,{name:h.name,type:h.type,components:v,offset:y}})),size:Ml(r,Math.max(s,t)),alignment:t}}function Ml(i,t){return Math.ceil(i/t)*t}class ti extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.int16[h+0]=r,this.int16[h+1]=s,t}}ti.prototype.bytesPerElement=4,bt("StructArrayLayout2i4",ti);class ir extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.int16[m+0]=r,this.int16[m+1]=s,this.int16[m+2]=h,t}}ir.prototype.bytesPerElement=6,bt("StructArrayLayout3i6",ir);class Mo extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,s,h)}emplace(t,r,s,h,m){const y=4*t;return this.int16[y+0]=r,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=m,t}}Mo.prototype.bytesPerElement=8,bt("StructArrayLayout4i8",Mo);class zs extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=s,this.int16[w+2]=h,this.int16[w+3]=m,this.int16[w+4]=y,this.int16[w+5]=v,t}}zs.prototype.bytesPerElement=12,bt("StructArrayLayout2i4i12",zs);class Ls extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const w=4*t,C=8*t;return this.int16[w+0]=r,this.int16[w+1]=s,this.uint8[C+4]=h,this.uint8[C+5]=m,this.uint8[C+6]=y,this.uint8[C+7]=v,t}}Ls.prototype.bytesPerElement=8,bt("StructArrayLayout2i4ub8",Ls);class Na extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.float32[h+0]=r,this.float32[h+1]=s,t}}Na.prototype.bytesPerElement=8,bt("StructArrayLayout2f8",Na);class Ua extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,w,C,M){const z=this.length;return this.resize(z+1),this.emplace(z,t,r,s,h,m,y,v,w,C,M)}emplace(t,r,s,h,m,y,v,w,C,M,z){const B=10*t;return this.uint16[B+0]=r,this.uint16[B+1]=s,this.uint16[B+2]=h,this.uint16[B+3]=m,this.uint16[B+4]=y,this.uint16[B+5]=v,this.uint16[B+6]=w,this.uint16[B+7]=C,this.uint16[B+8]=M,this.uint16[B+9]=z,t}}Ua.prototype.bytesPerElement=20,bt("StructArrayLayout10ui20",Ua);class Rl extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,w,C,M,z,B){const U=this.length;return this.resize(U+1),this.emplace(U,t,r,s,h,m,y,v,w,C,M,z,B)}emplace(t,r,s,h,m,y,v,w,C,M,z,B,U){const V=12*t;return this.int16[V+0]=r,this.int16[V+1]=s,this.int16[V+2]=h,this.int16[V+3]=m,this.uint16[V+4]=y,this.uint16[V+5]=v,this.uint16[V+6]=w,this.uint16[V+7]=C,this.int16[V+8]=M,this.int16[V+9]=z,this.int16[V+10]=B,this.int16[V+11]=U,t}}Rl.prototype.bytesPerElement=24,bt("StructArrayLayout4i4ui4i24",Rl);class Dl extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.float32[m+0]=r,this.float32[m+1]=s,this.float32[m+2]=h,t}}Dl.prototype.bytesPerElement=12,bt("StructArrayLayout3f12",Dl);class wc extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}wc.prototype.bytesPerElement=4,bt("StructArrayLayout1ul4",wc);class f extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,w,C){const M=this.length;return this.resize(M+1),this.emplace(M,t,r,s,h,m,y,v,w,C)}emplace(t,r,s,h,m,y,v,w,C,M){const z=10*t,B=5*t;return this.int16[z+0]=r,this.int16[z+1]=s,this.int16[z+2]=h,this.int16[z+3]=m,this.int16[z+4]=y,this.int16[z+5]=v,this.uint32[B+3]=w,this.uint16[z+8]=C,this.uint16[z+9]=M,t}}f.prototype.bytesPerElement=20,bt("StructArrayLayout6i1ul2ui20",f);class e extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const w=6*t;return this.int16[w+0]=r,this.int16[w+1]=s,this.int16[w+2]=h,this.int16[w+3]=m,this.int16[w+4]=y,this.int16[w+5]=v,t}}e.prototype.bytesPerElement=12,bt("StructArrayLayout2i2i2i12",e);class a extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,t,r,s,h,m)}emplace(t,r,s,h,m,y){const v=4*t,w=8*t;return this.float32[v+0]=r,this.float32[v+1]=s,this.float32[v+2]=h,this.int16[w+6]=m,this.int16[w+7]=y,t}}a.prototype.bytesPerElement=16,bt("StructArrayLayout2f1f2i16",a);class l extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,s,h,m,y)}emplace(t,r,s,h,m,y,v){const w=16*t,C=4*t,M=8*t;return this.uint8[w+0]=r,this.uint8[w+1]=s,this.float32[C+1]=h,this.float32[C+2]=m,this.int16[M+6]=y,this.int16[M+7]=v,t}}l.prototype.bytesPerElement=16,bt("StructArrayLayout2ub2f2i16",l);class d extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.uint16[m+0]=r,this.uint16[m+1]=s,this.uint16[m+2]=h,t}}d.prototype.bytesPerElement=6,bt("StructArrayLayout3ui6",d);class g extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re){const Te=this.length;return this.resize(Te+1),this.emplace(Te,t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re)}emplace(t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re,Te){const ce=24*t,pe=12*t,Fe=48*t;return this.int16[ce+0]=r,this.int16[ce+1]=s,this.uint16[ce+2]=h,this.uint16[ce+3]=m,this.uint32[pe+2]=y,this.uint32[pe+3]=v,this.uint32[pe+4]=w,this.uint16[ce+10]=C,this.uint16[ce+11]=M,this.uint16[ce+12]=z,this.float32[pe+7]=B,this.float32[pe+8]=U,this.uint8[Fe+36]=V,this.uint8[Fe+37]=$,this.uint8[Fe+38]=Q,this.uint32[pe+10]=re,this.int16[ce+22]=Te,t}}g.prototype.bytesPerElement=48,bt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",g);class _ extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re,Te,ce,pe,Fe,Ge,Je,gt,ct,yt,Dt,ut){const dt=this.length;return this.resize(dt+1),this.emplace(dt,t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re,Te,ce,pe,Fe,Ge,Je,gt,ct,yt,Dt,ut)}emplace(t,r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re,Te,ce,pe,Fe,Ge,Je,gt,ct,yt,Dt,ut,dt){const $e=32*t,Ft=16*t;return this.int16[$e+0]=r,this.int16[$e+1]=s,this.int16[$e+2]=h,this.int16[$e+3]=m,this.int16[$e+4]=y,this.int16[$e+5]=v,this.int16[$e+6]=w,this.int16[$e+7]=C,this.uint16[$e+8]=M,this.uint16[$e+9]=z,this.uint16[$e+10]=B,this.uint16[$e+11]=U,this.uint16[$e+12]=V,this.uint16[$e+13]=$,this.uint16[$e+14]=Q,this.uint16[$e+15]=re,this.uint16[$e+16]=Te,this.uint16[$e+17]=ce,this.uint16[$e+18]=pe,this.uint16[$e+19]=Fe,this.uint16[$e+20]=Ge,this.uint16[$e+21]=Je,this.uint16[$e+22]=gt,this.uint32[Ft+12]=ct,this.float32[Ft+13]=yt,this.float32[Ft+14]=Dt,this.uint16[$e+30]=ut,this.uint16[$e+31]=dt,t}}_.prototype.bytesPerElement=64,bt("StructArrayLayout8i15ui1ul2f2ui64",_);class S extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}S.prototype.bytesPerElement=4,bt("StructArrayLayout1f4",S);class P extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=3*t;return this.uint16[6*t+0]=r,this.float32[m+1]=s,this.float32[m+2]=h,t}}P.prototype.bytesPerElement=12,bt("StructArrayLayout1ui2f12",P);class E extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,s){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,s)}emplace(t,r,s,h){const m=4*t;return this.uint32[2*t+0]=r,this.uint16[m+2]=s,this.uint16[m+3]=h,t}}E.prototype.bytesPerElement=8,bt("StructArrayLayout1ul2ui8",E);class I extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const s=this.length;return this.resize(s+1),this.emplace(s,t,r)}emplace(t,r,s){const h=2*t;return this.uint16[h+0]=r,this.uint16[h+1]=s,t}}I.prototype.bytesPerElement=4,bt("StructArrayLayout2ui4",I);class O extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}O.prototype.bytesPerElement=2,bt("StructArrayLayout1ui2",O);class k extends Wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,s,h)}emplace(t,r,s,h,m){const y=4*t;return this.float32[y+0]=r,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=m,t}}k.prototype.bytesPerElement=16,bt("StructArrayLayout4f16",k);class N extends El{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new H(this.anchorPointX,this.anchorPointY)}}N.prototype.size=20;class W extends f{get(t){return new N(this,t)}}bt("CollisionBoxArray",W);class J extends El{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}J.prototype.size=48;class ee extends g{get(t){return new J(this,t)}}bt("PlacedSymbolArray",ee);class te extends El{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}te.prototype.size=64;class ie extends _{get(t){return new te(this,t)}}bt("SymbolInstanceArray",ie);class le extends S{getoffsetX(t){return this.float32[1*t+0]}}bt("GlyphOffsetArray",le);class ae extends ir{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}bt("SymbolLineVertexArray",ae);class ue extends El{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ue.prototype.size=12;class me extends P{get(t){return new ue(this,t)}}bt("TextAnchorOffsetArray",me);class oe extends El{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}oe.prototype.size=8;class Se extends E{get(t){return new oe(this,t)}}bt("FeatureIndexArray",Se);class Ue extends ti{}class Ie extends ti{}class Oe extends ti{}class je extends zs{}class pt extends Ls{}class ht extends Na{}class Ke extends Ua{}class Tt extends Rl{}class ln extends Dl{}class Pn extends wc{}class ar extends e{}class Fn extends l{}class Nn extends d{}class $n extends I{}const Gn=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Un}=Gn;class vn{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,r,s,h){const m=this.segments[this.segments.length-1];return t>vn.MAX_VERTEX_ARRAY_LENGTH&&un(`Max vertices per segment is ${vn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${vn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!m||m.vertexLength+t>vn.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h?this.createNewSegment(r,s,h):m}createNewSegment(t,r,s){const h={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0,vaos:{}};return s!==void 0&&(h.sortKey=s),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(h),h}getOrCreateLatestSegment(t,r,s){return this.prepareSegment(0,t,r,s)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,s,h){return new vn([{vertexOffset:t,primitiveOffset:r,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}function jr(i,t){return 256*(i=It(Math.floor(i),0,255))+It(Math.floor(t),0,255)}vn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,bt("SegmentVector",vn);const Ir=pr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ui,is,Ro,ji={exports:{}},Do={exports:{}},as={exports:{}},Sc=(function(){if(Ro)return ji.exports;Ro=1;var i=(Ui||(Ui=1,Do.exports=function(r,s){var h,m,y,v,w,C,M,z;for(m=r.length-(h=3&r.length),y=s,w=3432918353,C=461845907,z=0;z<m;)M=255&r.charCodeAt(z)|(255&r.charCodeAt(++z))<<8|(255&r.charCodeAt(++z))<<16|(255&r.charCodeAt(++z))<<24,++z,y=27492+(65535&(v=5*(65535&(y=(y^=M=(65535&(M=(M=(65535&M)*w+(((M>>>16)*w&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(M=0,h){case 3:M^=(255&r.charCodeAt(z+2))<<16;case 2:M^=(255&r.charCodeAt(z+1))<<8;case 1:y^=M=(65535&(M=(M=(65535&(M^=255&r.charCodeAt(z)))*w+(((M>>>16)*w&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295}return y^=r.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),Do.exports),t=(is||(is=1,as.exports=function(r,s){for(var h,m=r.length,y=s^m,v=0;m>=4;)h=1540483477*(65535&(h=255&r.charCodeAt(v)|(255&r.charCodeAt(++v))<<8|(255&r.charCodeAt(++v))<<16|(255&r.charCodeAt(++v))<<24))+((1540483477*(h>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),m-=4,++v;switch(m){case 3:y^=(255&r.charCodeAt(v+2))<<16;case 2:y^=(255&r.charCodeAt(v+1))<<8;case 1:y=1540483477*(65535&(y^=255&r.charCodeAt(v)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),as.exports);return ji.exports=i,ji.exports.murmur3=i,ji.exports.murmur2=t,ji.exports})(),Io=Y(Sc);class ni{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,s,h){this.ids.push(oo(t)),this.positions.push(r,s,h)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=oo(t);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=r?h=y:s=y+1}const m=[];for(;this.ids[s]===r;)m.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return m}static serialize(t,r){const s=new Float64Array(t.ids),h=new Uint32Array(t.positions);return so(s,h,0,s.length-1),r&&r.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(t){const r=new ni;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}}function oo(i){const t=+i;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Io(String(i))}function so(i,t,r,s){for(;r<s;){const h=i[r+s>>1];let m=r-1,y=s+1;for(;;){do m++;while(i[m]<h);do y--;while(i[y]>h);if(m>=y)break;os(i,m,y),os(t,3*m,3*y),os(t,3*m+1,3*y+1),os(t,3*m+2,3*y+2)}y-r<s-y?(so(i,t,r,y),r=y+1):(so(i,t,y+1,s),s=y)}}function os(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}bt("FeaturePositionMap",ni);class Dn{constructor(t,r){this.gl=t.gl,this.location=r}}class hr extends Dn{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Si extends Dn{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class xr extends Dn{constructor(t,r){super(t,r),this.current=hn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const cu=new Float32Array(16);function uu(i){return[jr(255*i.r,255*i.g),jr(255*i.b,255*i.a)]}class Il{constructor(t,r,s){this.value=t,this.uniformNames=r.map((h=>`u_${h}`)),this.type=s}setUniform(t,r,s){t.set(s.constantOr(this.value))}getBinding(t,r,s){return this.type==="color"?new xr(t,r):new hr(t,r)}}class ja{constructor(t,r){this.uniformNames=r.map((s=>`u_${s}`)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,s,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&t.set(m)}getBinding(t,r,s){return s.substr(0,9)==="u_pattern"?new Si(t,r):new hr(t,r)}}class lo{constructor(t,r,s,h){this.expression=t,this.type=s,this.maxValue=0,this.paintVertexAttributes=r.map((m=>({name:`a_${m}`,type:"Float32",components:s==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(t,r,s){const h=this.paintVertexArray.length,m=this.expression.evaluate(new Ln(0,s),r,{},s.canonical,[],s.formattedSection);this.paintVertexArray.resize(t),this._setPaintValue(h,t,m)}updatePaintArray(t,r,s,h,m){const y=this.expression.evaluate(new Ln(0,m),s,h);this._setPaintValue(t,r,y)}_setPaintValue(t,r,s){if(this.type==="color"){const h=uu(s);for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Sr{constructor(t,r,s,h,m,y){this.expression=t,this.uniformNames=r.map((v=>`u_${v}_t`)),this.type=s,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map((v=>({name:`a_${v}`,type:"Float32",components:s==="color"?4:2,offset:0}))),this.paintVertexArray=new y}populatePaintArray(t,r,s){const h=this.expression.evaluate(new Ln(this.zoom,s),r,{},s.canonical,[],s.formattedSection),m=this.expression.evaluate(new Ln(this.zoom+1,s),r,{},s.canonical,[],s.formattedSection),y=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(y,t,h,m)}updatePaintArray(t,r,s,h,m){const y=this.expression.evaluate(new Ln(this.zoom,m),s,h),v=this.expression.evaluate(new Ln(this.zoom+1,m),s,h);this._setPaintValue(t,r,y,v)}_setPaintValue(t,r,s,h){if(this.type==="color"){const m=uu(s),y=uu(h);for(let v=t;v<r;v++)this.paintVertexArray.emplace(v,m[0],m[1],y[0],y[1])}else{for(let m=t;m<r;m++)this.paintVertexArray.emplace(m,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){const s=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,h=It(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);t.set(h)}getBinding(t,r,s){return new hr(t,r)}}class br{constructor(t,r,s,h,m,y){this.expression=t,this.type=r,this.useIntegerZoom=s,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(t,r,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(h,t,r.patterns&&r.patterns[this.layerId],s.imagePositions)}updatePaintArray(t,r,s,h,m){this._setPaintValues(t,r,s.patterns&&s.patterns[this.layerId],m.imagePositions)}_setPaintValues(t,r,s,h){if(!h||!s)return;const{min:m,mid:y,max:v}=s,w=h[m],C=h[y],M=h[v];if(w&&C&&M)for(let z=t;z<r;z++)this.zoomInPaintVertexArray.emplace(z,C.tl[0],C.tl[1],C.br[0],C.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],C.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,C.tl[0],C.tl[1],C.br[0],C.br[1],M.tl[0],M.tl[1],M.br[0],M.br[1],C.pixelRatio,M.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Ir.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Ir.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class co{constructor(t,r,s){this.binders={},this._buffers=[];const h=[];for(const m in t.paint._values){if(!s(m))continue;const y=t.paint.get(m);if(!(y instanceof Ni&&sa(y.property.specification)))continue;const v=Lo(m,t.type),w=y.value,C=y.property.specification.type,M=y.property.useIntegerZoom,z=y.property.specification["property-type"],B=z==="cross-faded"||z==="cross-faded-data-driven";if(w.kind==="constant")this.binders[m]=B?new ja(w.value,v):new Il(w.value,v,C),h.push(`/u_${m}`);else if(w.kind==="source"||B){const U=wa(m,C,"source");this.binders[m]=B?new br(w,C,M,r,U,t.id):new lo(w,v,C,U),h.push(`/a_${m}`)}else{const U=wa(m,C,"composite");this.binders[m]=new Sr(w,v,C,M,r,U),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof lo||r instanceof Sr?r.maxValue:0}populatePaintArrays(t,r,s){for(const h in this.binders){const m=this.binders[h];(m instanceof lo||m instanceof Sr||m instanceof br)&&m.populatePaintArray(t,r,s)}}setConstantPatternPositions(t,r){for(const s in this.binders){const h=this.binders[s];h instanceof ja&&h.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,s,h,m){let y=!1;for(const v in t){const w=r.getPositions(v);for(const C of w){const M=s.feature(C.index);for(const z in this.binders){const B=this.binders[z];if((B instanceof lo||B instanceof Sr||B instanceof br)&&B.expression.isStateDependent===!0){const U=h.paint.get(z);B.expression=U.value,B.updatePaintArray(C.start,C.end,M,t[v],m),y=!0}}}}return y}defines(){const t=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Il||s instanceof ja)&&t.push(...s.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof lo||s instanceof Sr)for(let h=0;h<s.paintVertexAttributes.length;h++)t.push(s.paintVertexAttributes[h].name);else if(s instanceof br)for(let h=0;h<Ir.members.length;h++)t.push(Ir.members[h].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const s=this.binders[r];if(s instanceof Il||s instanceof ja||s instanceof Sr)for(const h of s.uniformNames)t.push(h)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){const s=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Il||m instanceof ja||m instanceof Sr){for(const y of m.uniformNames)if(r[y]){const v=m.getBinding(t,r[y],y);s.push({name:y,property:h,binding:v})}}}return s}setUniforms(t,r,s,h){for(const{name:m,property:y,binding:v}of r)this.binders[y].setUniform(v,h,s.get(y),m)}updatePaintBuffers(t){this._buffers=[];for(const r in this.binders){const s=this.binders[r];if(t&&s instanceof br){const h=t.fromScale===2?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof lo||s instanceof Sr)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(t){for(const r in this.binders){const s=this.binders[r];(s instanceof lo||s instanceof Sr||s instanceof br)&&s.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof lo||r instanceof Sr||r instanceof br)&&r.destroy()}}}class zo{constructor(t,r,s=()=>!0){this.programConfigurations={};for(const h of t)this.programConfigurations[h.id]=new co(h,r,s);this.needsUpload=!1,this._featureMap=new ni,this._bufferOffset=0}populatePaintArrays(t,r,s,h){for(const m in this.programConfigurations)this.programConfigurations[m].populatePaintArrays(t,r,h);r.id!==void 0&&this._featureMap.add(r.id,s,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,s,h){for(const m of s)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(t,this._featureMap,r,m,h)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Lo(i,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${t}-`,"").replace(/-/g,"_")]}function wa(i,t,r){const s={color:{source:Na,composite:k},number:{source:S,composite:Na}},h=(function(m){return{"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke}}[m]})(i);return h&&h[r]||s[t][r]}bt("ConstantBinder",Il),bt("CrossFadedConstantBinder",ja),bt("SourceExpressionBinder",lo),bt("CrossFadedCompositeBinder",br),bt("CompositeExpressionBinder",Sr),bt("ProgramConfiguration",co,{omit:["_buffers"]}),bt("ProgramConfigurationSet",zo);const Pr=Math.pow(2,14)-1,ks=-Pr-1;function Os(i){const t=Et/i.extent,r=i.loadGeometry();for(let s=0;s<r.length;s++){const h=r[s];for(let m=0;m<h.length;m++){const y=h[m],v=Math.round(y.x*t),w=Math.round(y.y*t);y.x=It(v,ks,Pr),y.y=It(w,ks,Pr),(v<y.x||v>y.x+1||w<y.y||w>y.y+1)&&un("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Bs(i,t){return{type:i.type,id:i.id,properties:i.properties,geometry:t?Os(i):[]}}const jd=-32768;function ip(i,t,r,s,h){i.emplaceBack(jd+8*t+s,jd+8*r+h)}class Fs{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Ie,this.indexArray=new Nn,this.segments=new vn,this.programConfigurations=new zo(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){const h=this.layers[0],m=[];let y=null,v=!1,w=h.type==="heatmap";if(h.type==="circle"){const M=h;y=M.layout.get("circle-sort-key"),v=!y.isConstant(),w=w||M.paint.get("circle-pitch-alignment")==="map"}const C=w?r.subdivisionGranularity.circle:1;for(const{feature:M,id:z,index:B,sourceLayerIndex:U}of t){const V=this.layers[0]._featureFilter.needGeometry,$=Bs(M,V);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),$,s))continue;const Q=v?y.evaluate($,{},s):void 0,re={id:z,properties:M.properties,type:M.type,sourceLayerIndex:U,index:B,geometry:V?$.geometry:Os(M),patterns:{},sortKey:Q};m.push(re)}v&&m.sort(((M,z)=>M.sortKey-z.sortKey));for(const M of m){const{geometry:z,index:B,sourceLayerIndex:U}=M,V=t[B].feature;this.addFeature(M,z,B,s,C),r.featureIndex.insert(V,z,B,U,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Un),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,s,h,m=1){let y;switch(m){case 1:y=[0,7];break;case 3:y=[0,2,5,7];break;case 5:y=[0,1,3,4,6,7];break;case 7:y=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${m}; valid values are 1, 3, 5, 7.`)}const v=y.length;for(const w of r)for(const C of w){const M=C.x,z=C.y;if(M<0||M>=Et||z<0||z>=Et)continue;const B=this.segments.prepareSegment(v*v,this.layoutVertexArray,this.indexArray,t.sortKey),U=B.vertexLength;for(let V=0;V<v;V++)for(let $=0;$<v;$++)ip(this.layoutVertexArray,M,z,y[$],y[V]);for(let V=0;V<v-1;V++)for(let $=0;$<v-1;$++){const Q=U+V*v+$,re=U+(V+1)*v+$;this.indexArray.emplaceBack(Q,re+1,Q+1),this.indexArray.emplaceBack(Q,re,re+1)}B.vertexLength+=v*v,B.primitiveLength+=(v-1)*(v-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:{},canonical:h})}}function nh(i,t){for(let r=0;r<i.length;r++)if(du(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(du(i,t[r]))return!0;return!!hu(i,t)}function rh(i,t,r){return!!du(i,t)||!!ih(t,i,r)}function Vd(i,t){if(i.length===1)return Gd(t,i[0]);for(let r=0;r<t.length;r++){const s=t[r];for(let h=0;h<s.length;h++)if(du(i,s[h]))return!0}for(let r=0;r<i.length;r++)if(Gd(t,i[r]))return!0;for(let r=0;r<t.length;r++)if(hu(i,t[r]))return!0;return!1}function ap(i,t,r){if(i.length>1){if(hu(i,t))return!0;for(let s=0;s<t.length;s++)if(ih(t[s],i,r))return!0}for(let s=0;s<i.length;s++)if(ih(i[s],t,r))return!0;return!1}function hu(i,t){if(i.length===0||t.length===0)return!1;for(let r=0;r<i.length-1;r++){const s=i[r],h=i[r+1];for(let m=0;m<t.length-1;m++)if(op(s,h,t[m],t[m+1]))return!0}return!1}function op(i,t,r,s){return qn(i,r,s)!==qn(t,r,s)&&qn(i,t,r)!==qn(i,t,s)}function ih(i,t,r){const s=r*r;if(t.length===1)return i.distSqr(t[0])<s;for(let h=1;h<t.length;h++)if(Hd(i,t[h-1],t[h])<s)return!0;return!1}function Hd(i,t,r){const s=t.distSqr(r);if(s===0)return i.distSqr(t);const h=((i.x-t.x)*(r.x-t.x)+(i.y-t.y)*(r.y-t.y))/s;return i.distSqr(h<0?t:h>1?r:r.sub(t)._mult(h)._add(t))}function Gd(i,t){let r,s,h,m=!1;for(let y=0;y<i.length;y++){r=i[y];for(let v=0,w=r.length-1;v<r.length;w=v++)s=r[v],h=r[w],s.y>t.y!=h.y>t.y&&t.x<(h.x-s.x)*(t.y-s.y)/(h.y-s.y)+s.x&&(m=!m)}return m}function du(i,t){let r=!1;for(let s=0,h=i.length-1;s<i.length;h=s++){const m=i[s],y=i[h];m.y>t.y!=y.y>t.y&&t.x<(y.x-m.x)*(t.y-m.y)/(y.y-m.y)+m.x&&(r=!r)}return r}function sp(i,t,r){const s=r[0],h=r[2];if(i.x<s.x&&t.x<s.x||i.x>h.x&&t.x>h.x||i.y<s.y&&t.y<s.y||i.y>h.y&&t.y>h.y)return!1;const m=qn(i,t,r[0]);return m!==qn(i,t,r[1])||m!==qn(i,t,r[2])||m!==qn(i,t,r[3])}function zr(i,t,r){const s=t.paint.get(i).value;return s.kind==="constant"?s.value:r.programConfigurations.get(t.id).getMaxValue(i)}function ri(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function ah(i,t,r,s,h){if(!t[0]&&!t[1])return i;const m=H.convert(t)._mult(h);r==="viewport"&&m._rotate(-s);const y=[];for(let v=0;v<i.length;v++)y.push(i[v].sub(m));return y}function lp({queryGeometry:i,size:t},r){return rh(i,r,t)}function cp({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){return rh(i,m,t*(r.projectTileCoordinates(m.x,m.y,s,h).signedDistanceFromCamera/r.cameraToCenterDistance))}function up({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){const y=r.projectTileCoordinates(m.x,m.y,s,h).signedDistanceFromCamera,v=t*(r.cameraToCenterDistance/y);return rh(i,sh(m,r,s,h),v)}function hp({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h},m){return rh(i,sh(m,r,s,h),t)}function oh({queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h,pitchAlignment:m="map",pitchScale:y="map"},v){const w=m==="map"?y==="map"?lp:cp:y==="map"?up:hp,C={queryGeometry:i,size:t,transform:r,unwrappedTileID:s,getElevation:h};for(const M of v)for(const z of M)if(w(C,z))return!0;return!1}function sh(i,t,r,s){const h=t.projectTileCoordinates(i.x,i.y,r,s).point;return new H((.5*h.x+.5)*t.width,(.5*-h.y+.5)*t.height)}let Zd,qd;bt("CircleBucket",Fs,{omit:["layers"]});var dp={get paint(){return qd=qd||new ei({"circle-radius":new zt(Ce.paint_circle["circle-radius"]),"circle-color":new zt(Ce.paint_circle["circle-color"]),"circle-blur":new zt(Ce.paint_circle["circle-blur"]),"circle-opacity":new zt(Ce.paint_circle["circle-opacity"]),"circle-translate":new Ct(Ce.paint_circle["circle-translate"]),"circle-translate-anchor":new Ct(Ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ct(Ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ct(Ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new zt(Ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new zt(Ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new zt(Ce.paint_circle["circle-stroke-opacity"])})},get layout(){return Zd=Zd||new ei({"circle-sort-key":new zt(Ce.layout_circle["circle-sort-key"])})}};class Wd extends ba{constructor(t,r){super(t,dp,r)}createBucket(t){return new Fs(t)}queryRadius(t){const r=t;return zr("circle-radius",this,r)+zr("circle-stroke-width",this,r)+ri(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:v,getElevation:w}){const C=ah(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-m.bearingInRadians,y),M=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s),z=this.paint.get("circle-pitch-scale"),B=this.paint.get("circle-pitch-alignment");let U,V;return B==="map"?(U=C,V=M*y):(U=(function($,Q,re,Te){return $.map((ce=>sh(ce,Q,re,Te)))})(C,m,v,w),V=M),oh({queryGeometry:U,size:V,transform:m,unwrappedTileID:v,getElevation:w,pitchAlignment:B,pitchScale:z},h)}}class td extends Fs{}let nd;bt("HeatmapBucket",td,{omit:["layers"]});var fp={get paint(){return nd=nd||new ei({"heatmap-radius":new zt(Ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new zt(Ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ct(Ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new fr(Ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ct(Ce.paint_heatmap["heatmap-opacity"])})}};function lh(i,{width:t,height:r},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==t*r*s)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${t*r*s}`)}else h=new Uint8Array(t*r*s);return i.width=t,i.height=r,i.data=h,i}function ch(i,{width:t,height:r},s){if(t===i.width&&r===i.height)return;const h=lh({},{width:t,height:r},s);uh(i,h,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,t),height:Math.min(i.height,r)},s),i.width=t,i.height=r,i.data=h.data}function uh(i,t,r,s,h,m){if(h.width===0||h.height===0)return t;if(h.width>i.width||h.height>i.height||r.x>i.width-h.width||r.y>i.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>t.width||h.height>t.height||s.x>t.width-h.width||s.y>t.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=i.data,v=t.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<h.height;w++){const C=((r.y+w)*i.width+r.x)*m,M=((s.y+w)*t.width+s.x)*m;for(let z=0;z<h.width*m;z++)v[M+z]=y[C+z]}return t}class fu{constructor(t,r){lh(this,t,1,r)}resize(t){ch(this,t,1)}clone(){return new fu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,h,m){uh(t,r,s,h,m,1)}}class Vi{constructor(t,r){lh(this,t,4,r)}resize(t){ch(this,t,4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Vi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,s,h,m){uh(t,r,s,h,m,4)}setPixel(t,r,s){const h=4*(t*this.width+r);this.data[h+0]=Math.round(255*s.r/s.a),this.data[h+1]=Math.round(255*s.g/s.a),this.data[h+2]=Math.round(255*s.b/s.a),this.data[h+3]=Math.round(255*s.a)}}function $d(i){const t={},r=i.resolution||256,s=i.clips?i.clips.length:1,h=i.image||new Vi({width:r,height:s});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(y,v,w)=>{t[i.evaluationKey]=w;const C=i.expression.evaluate(t);h.setPixel(y/4/r,v/4,C)};if(i.clips)for(let y=0,v=0;y<s;++y,v+=4*r)for(let w=0,C=0;w<r;w++,C+=4){const M=w/(r-1),{start:z,end:B}=i.clips[y];m(v,C,z*(1-M)+B*M)}else for(let y=0,v=0;y<r;y++,v+=4)m(0,v,y/(r-1));return h}bt("AlphaImage",fu),bt("RGBAImage",Vi);const ko="big-fb";class Xd extends ba{createBucket(t){return new td(t)}constructor(t,r){super(t,fp,r),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$d({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(ko)&&this.heatmapFbos.delete(ko)}queryRadius(t){return zr("heatmap-radius",this,t)}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,unwrappedTileID:v,getElevation:w}){return oh({queryGeometry:t,size:this.paint.get("heatmap-radius").evaluate(r,s)*y,transform:m,unwrappedTileID:v,getElevation:w},h)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let pp;var mp={get paint(){return pp=pp||new ei({"hillshade-illumination-direction":new Ct(Ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new Ct(Ce.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new Ct(Ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ct(Ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ct(Ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ct(Ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ct(Ce.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new Ct(Ce.paint_hillshade["hillshade-method"])})}};class Ns extends ba{constructor(t,r){super(t,mp,r),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let t=this.paint.get("hillshade-illumination-direction").values,r=this.paint.get("hillshade-illumination-altitude").values,s=this.paint.get("hillshade-highlight-color").values,h=this.paint.get("hillshade-shadow-color").values;const m=Math.max(t.length,r.length,s.length,h.length);t=t.concat(Array(m-t.length).fill(t.at(-1))),r=r.concat(Array(m-r.length).fill(r.at(-1))),s=s.concat(Array(m-s.length).fill(s.at(-1))),h=h.concat(Array(m-h.length).fill(h.at(-1)));const y=r.map(qa);return{directionRadians:t.map(qa),altitudeRadians:y,shadowColor:h,highlightColor:s}}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Yd;var rd={get paint(){return Yd=Yd||new ei({"color-relief-opacity":new Ct(Ce["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new fr(Ce["paint_color-relief"]["color-relief-color"])})}};class Pc{constructor(t,r,s,h){this.context=t,this.format=s,this.texture=t.gl.createTexture(),this.update(r,h)}update(t,r,s){const{width:h,height:m}=t,y=!(this.size&&this.size[0]===h&&this.size[1]===m||s),{context:v}=this,{gl:w}=v;if(this.useMipmap=!!(r&&r.useMipmap),w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!r||r.premultiply!==!1)),y)this.size=[h,m],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Kr(t)?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,t):w.texImage2D(w.TEXTURE_2D,0,this.format,h,m,0,this.format,w.UNSIGNED_BYTE,t.data);else{const{x:C,y:M}=s||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||Kr(t)?w.texSubImage2D(w.TEXTURE_2D,0,C,M,w.RGBA,w.UNSIGNED_BYTE,t):w.texSubImage2D(w.TEXTURE_2D,0,C,M,h,m,w.RGBA,w.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&w.generateMipmap(w.TEXTURE_2D),v.pixelStoreUnpackFlipY.setDefault(),v.pixelStoreUnpack.setDefault(),v.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(t,r,s){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),s!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(s=m.LINEAR),t!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,s||t),this.filter=t),r!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,r),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,r),this.wrap=r)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Cr{constructor(t,r,s,h=1,m=1,y=1,v=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(s&&!["mapbox","terrarium","custom"].includes(s))return void un(`"${s}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=r.height;const w=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),s){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let C=0;C<w;C++)this.data[this._idx(-1,C)]=this.data[this._idx(0,C)],this.data[this._idx(w,C)]=this.data[this._idx(w-1,C)],this.data[this._idx(C,-1)]=this.data[this._idx(C,0)],this.data[this._idx(C,w)]=this.data[this._idx(C,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let C=0;C<w;C++)for(let M=0;M<w;M++){const z=this.get(C,M);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(t,r){const s=new Uint8Array(this.data.buffer),h=4*this._idx(t,r);return this.unpack(s[h],s[h+1],s[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,s){return t*this.redFactor+r*this.greenFactor+s*this.blueFactor-this.baseShift}pack(t){return gp(t,this.getUnpackVector())}getPixels(){return new Vi({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,s){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let h=r*this.dim,m=r*this.dim+this.dim,y=s*this.dim,v=s*this.dim+this.dim;switch(r){case-1:h=m-1;break;case 1:m=h+1}switch(s){case-1:y=v-1;break;case 1:v=y+1}const w=-r*this.dim,C=-s*this.dim;for(let M=y;M<v;M++)for(let z=h;z<m;z++)this.data[this._idx(z,M)]=t.data[this._idx(z+w,M+C)]}}function gp(i,t){const r=t[0],s=t[1],h=t[2],m=t[3],y=Math.min(r,s,h),v=Math.round((i+m)/y);return{r:Math.floor(v*y/r)%256,g:Math.floor(v*y/s)%256,b:Math.floor(v*y/h)%256}}bt("DEMData",Cr);class Mm extends ba{constructor(t,r){super(t,rd,r)}_createColorRamp(t){const r={elevationStops:[],colorStops:[]},s=this._transitionablePaint._values["color-relief-color"].value.expression;if(s instanceof Yo&&s._styleExpression.expression instanceof di){this.colorRampExpression=s;const y=s._styleExpression.expression;r.elevationStops=y.labels,r.colorStops=[];for(const v of r.elevationStops)r.colorStops.push(y.evaluate({globals:{elevation:v}}))}if(r.elevationStops.length<1&&(r.elevationStops=[0],r.colorStops=[hn.transparent]),r.elevationStops.length<2&&(r.elevationStops.push(r.elevationStops[0]+1),r.colorStops.push(r.colorStops[0])),r.elevationStops.length<=t)return r;const h={elevationStops:[],colorStops:[]},m=(r.elevationStops.length-1)/(t-1);for(let y=0;y<r.elevationStops.length-.5;y+=m)h.elevationStops.push(r.elevationStops[Math.round(y)]),h.colorStops.push(r.colorStops[Math.round(y)]);return un(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),h}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(t,r,s){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const h=this._createColorRamp(r),m=new Vi({width:h.colorStops.length,height:1}),y=new Vi({width:h.colorStops.length,height:1});for(let v=0;v<h.elevationStops.length;v++){const w=gp(h.elevationStops[v],s);y.setPixel(0,v,new hn(w.r/255,w.g/255,w.b/255,1)),m.setPixel(0,v,h.colorStops[v])}return this.colorRampTextures={elevationTexture:new Pc(t,y,t.gl.RGBA),colorTexture:new Pc(t,m,t.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return this.visibility!=="none"&&!!this.colorRampTextures}}const yp=pr([{name:"a_pos",components:2,type:"Int16"}],4),{members:hh}=yp;function ss(i,t,r){const s=r.patternDependencies;let h=!1;for(const m of t){const y=m.paint.get(`${i}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,s[v.to]=!0,s[v.from]=!0)}return h}function id(i,t,r,s,h){const{zoom:m}=s,y=h.patternDependencies;for(const v of t){const w=v.paint.get(`${i}-pattern`).value;if(w.kind!=="constant"){let C=w.evaluate({zoom:m-1},r,{},h.availableImages),M=w.evaluate({zoom:m},r,{},h.availableImages),z=w.evaluate({zoom:m+1},r,{},h.availableImages);C=C&&C.name?C.name:C,M=M&&M.name?M.name:M,z=z&&z.name?z.name:z,y[C]=!0,y[M]=!0,y[z]=!0,r.patterns[v.id]={min:C,mid:M,max:z}}}return r}function Kd(i,t,r,s,h){let m;if(h===(function(y,v,w,C){let M=0;for(let z=v,B=w-C;z<w;z+=C)M+=(y[B]-y[z])*(y[z+1]+y[B+1]),B=z;return M})(i,t,r,s)>0)for(let y=t;y<r;y+=s)m=rf(y/s|0,i[y],i[y+1],m);else for(let y=r-s;y>=t;y-=s)m=rf(y/s|0,i[y],i[y+1],m);return m&&Cc(m,m.next)&&(dh(m),m=m.next),m}function Oo(i,t){if(!i)return i;t||(t=i);let r,s=i;do if(r=!1,s.steiner||!Cc(s,s.next)&&Lr(s.prev,s,s.next)!==0)s=s.next;else{if(dh(s),s=t=s.prev,s===s.next)break;r=!0}while(r||s!==t);return t}function Sa(i,t,r,s,h,m,y){if(!i)return;!y&&m&&(function(w,C,M,z){let B=w;do B.z===0&&(B.z=Bo(B.x,B.y,C,M,z)),B.prevZ=B.prev,B.nextZ=B.next,B=B.next;while(B!==w);B.prevZ.nextZ=null,B.prevZ=null,(function(U){let V,$=1;do{let Q,re=U;U=null;let Te=null;for(V=0;re;){V++;let ce=re,pe=0;for(let Ge=0;Ge<$&&(pe++,ce=ce.nextZ,ce);Ge++);let Fe=$;for(;pe>0||Fe>0&&ce;)pe!==0&&(Fe===0||!ce||re.z<=ce.z)?(Q=re,re=re.nextZ,pe--):(Q=ce,ce=ce.nextZ,Fe--),Te?Te.nextZ=Q:U=Q,Q.prevZ=Te,Te=Q;re=ce}Te.nextZ=null,$*=2}while(V>1)})(B)})(i,s,h,m);let v=i;for(;i.prev!==i.next;){const w=i.prev,C=i.next;if(m?Qd(i,s,h,m):_p(i))t.push(w.i,i.i,C.i),dh(i),i=C.next,v=C.next;else if((i=C)===v){y?y===1?Sa(i=vp(Oo(i),t),t,r,s,h,m,2):y===2&&Jd(i,t,r,s,h,m):Sa(Oo(i),t,r,s,h,m,1);break}}}function _p(i){const t=i.prev,r=i,s=i.next;if(Lr(t,r,s)>=0)return!1;const h=t.x,m=r.x,y=s.x,v=t.y,w=r.y,C=s.y,M=Math.min(h,m,y),z=Math.min(v,w,C),B=Math.max(h,m,y),U=Math.max(v,w,C);let V=s.next;for(;V!==t;){if(V.x>=M&&V.x<=B&&V.y>=z&&V.y<=U&&pu(h,v,m,w,y,C,V.x,V.y)&&Lr(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function Qd(i,t,r,s){const h=i.prev,m=i,y=i.next;if(Lr(h,m,y)>=0)return!1;const v=h.x,w=m.x,C=y.x,M=h.y,z=m.y,B=y.y,U=Math.min(v,w,C),V=Math.min(M,z,B),$=Math.max(v,w,C),Q=Math.max(M,z,B),re=Bo(U,V,t,r,s),Te=Bo($,Q,t,r,s);let ce=i.prevZ,pe=i.nextZ;for(;ce&&ce.z>=re&&pe&&pe.z<=Te;){if(ce.x>=U&&ce.x<=$&&ce.y>=V&&ce.y<=Q&&ce!==h&&ce!==y&&pu(v,M,w,z,C,B,ce.x,ce.y)&&Lr(ce.prev,ce,ce.next)>=0||(ce=ce.prevZ,pe.x>=U&&pe.x<=$&&pe.y>=V&&pe.y<=Q&&pe!==h&&pe!==y&&pu(v,M,w,z,C,B,pe.x,pe.y)&&Lr(pe.prev,pe,pe.next)>=0))return!1;pe=pe.nextZ}for(;ce&&ce.z>=re;){if(ce.x>=U&&ce.x<=$&&ce.y>=V&&ce.y<=Q&&ce!==h&&ce!==y&&pu(v,M,w,z,C,B,ce.x,ce.y)&&Lr(ce.prev,ce,ce.next)>=0)return!1;ce=ce.prevZ}for(;pe&&pe.z<=Te;){if(pe.x>=U&&pe.x<=$&&pe.y>=V&&pe.y<=Q&&pe!==h&&pe!==y&&pu(v,M,w,z,C,B,pe.x,pe.y)&&Lr(pe.prev,pe,pe.next)>=0)return!1;pe=pe.nextZ}return!0}function vp(i,t){let r=i;do{const s=r.prev,h=r.next.next;!Cc(s,h)&&tf(s,r,r.next,h)&&Va(s,h)&&Va(h,s)&&(t.push(s.i,r.i,h.i),dh(r),dh(r.next),r=i=h),r=r.next}while(r!==i);return Oo(r)}function Jd(i,t,r,s,h,m){let y=i;do{let v=y.next.next;for(;v!==y.prev;){if(y.i!==v.i&&Pi(y,v)){let w=nf(y,v);return y=Oo(y,y.next),w=Oo(w,w.next),Sa(y,t,r,s,h,m,0),void Sa(w,t,r,s,h,m,0)}v=v.next}y=y.next}while(y!==i)}function ef(i,t){let r=i.x-t.x;return r===0&&(r=i.y-t.y,r===0)&&(r=(i.next.y-i.y)/(i.next.x-i.x)-(t.next.y-t.y)/(t.next.x-t.x)),r}function ad(i,t){const r=(function(h,m){let y=m;const v=h.x,w=h.y;let C,M=-1/0;if(Cc(h,y))return y;do{if(Cc(h,y.next))return y.next;if(w<=y.y&&w>=y.next.y&&y.next.y!==y.y){const $=y.x+(w-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if($<=v&&$>M&&(M=$,C=y.x<y.next.x?y:y.next,$===v))return C}y=y.next}while(y!==m);if(!C)return null;const z=C,B=C.x,U=C.y;let V=1/0;y=C;do{if(v>=y.x&&y.x>=B&&v!==y.x&&od(w<U?v:M,w,B,U,w<U?M:v,w,y.x,y.y)){const $=Math.abs(w-y.y)/(v-y.x);Va(y,h)&&($<V||$===V&&(y.x>C.x||y.x===C.x&&xp(C,y)))&&(C=y,V=$)}y=y.next}while(y!==z);return C})(i,t);if(!r)return t;const s=nf(r,i);return Oo(s,s.next),Oo(r,r.next)}function xp(i,t){return Lr(i.prev,i,t.prev)<0&&Lr(t.next,i,i.next)<0}function Bo(i,t,r,s,h){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*h|0)|i<<8))|i<<4))|i<<2))|i<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Zr(i){let t=i,r=i;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==i);return r}function od(i,t,r,s,h,m,y,v){return(h-y)*(t-v)>=(i-y)*(m-v)&&(i-y)*(s-v)>=(r-y)*(t-v)&&(r-y)*(m-v)>=(h-y)*(s-v)}function pu(i,t,r,s,h,m,y,v){return!(i===y&&t===v)&&od(i,t,r,s,h,m,y,v)}function Pi(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!(function(r,s){let h=r;do{if(h.i!==r.i&&h.next.i!==r.i&&h.i!==s.i&&h.next.i!==s.i&&tf(h,h.next,r,s))return!0;h=h.next}while(h!==r);return!1})(i,t)&&(Va(i,t)&&Va(t,i)&&(function(r,s){let h=r,m=!1;const y=(r.x+s.x)/2,v=(r.y+s.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==r);return m})(i,t)&&(Lr(i.prev,i,t.prev)||Lr(i,t.prev,t))||Cc(i,t)&&Lr(i.prev,i,i.next)>0&&Lr(t.prev,t,t.next)>0)}function Lr(i,t,r){return(t.y-i.y)*(r.x-t.x)-(t.x-i.x)*(r.y-t.y)}function Cc(i,t){return i.x===t.x&&i.y===t.y}function tf(i,t,r,s){const h=Hi(Lr(i,t,r)),m=Hi(Lr(i,t,s)),y=Hi(Lr(r,s,i)),v=Hi(Lr(r,s,t));return h!==m&&y!==v||!(h!==0||!dr(i,r,t))||!(m!==0||!dr(i,s,t))||!(y!==0||!dr(r,i,s))||!(v!==0||!dr(r,t,s))}function dr(i,t,r){return t.x<=Math.max(i.x,r.x)&&t.x>=Math.min(i.x,r.x)&&t.y<=Math.max(i.y,r.y)&&t.y>=Math.min(i.y,r.y)}function Hi(i){return i>0?1:i<0?-1:0}function Va(i,t){return Lr(i.prev,i,i.next)<0?Lr(i,t,i.next)>=0&&Lr(i,i.prev,t)>=0:Lr(i,t,i.prev)<0||Lr(i,i.next,t)<0}function nf(i,t){const r=fh(i.i,i.x,i.y),s=fh(t.i,t.x,t.y),h=i.next,m=t.prev;return i.next=t,t.prev=i,r.next=h,h.prev=r,s.next=r,r.prev=s,m.next=s,s.prev=m,s}function rf(i,t,r,s){const h=fh(i,t,r);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function dh(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function fh(i,t,r){return{i,x:t,y:r,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Ci{constructor(t,r){if(r>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=r}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Pa{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Pa.noSubdivision=new Pa({fill:new Ci(0,0),line:new Ci(0,0),tile:new Ci(0,0),stencil:new Ci(0,0),circle:1}),bt("SubdivisionGranularityExpression",Ci),bt("SubdivisionGranularitySetting",Pa);const Tc=-32768,Gi=32767;class bp{constructor(t,r){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Et/t,this._canonical=r}_getKey(t,r){return(t+=32768)<<16|r+32768}_vertexToIndex(t,r){if(t<-32768||r<-32768||t>32767||r>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const s=0|Math.round(t),h=0|Math.round(r),m=this._getKey(s,h);if(this._vertexDictionary.has(m))return this._vertexDictionary.get(m);const y=this._vertexBuffer.length/2;return this._vertexDictionary.set(m,y),this._vertexBuffer.push(s,h),y}_subdivideTrianglesScanline(t){if(this._granularity<2)return(function(h,m){const y=[];for(let v=0;v<m.length;v+=3){const w=m[v],C=m[v+1],M=m[v+2],z=h[2*w],B=h[2*w+1];(h[2*C]-z)*(h[2*M+1]-B)-(h[2*C+1]-B)*(h[2*M]-z)>0?(y.push(w),y.push(M),y.push(C)):(y.push(w),y.push(C),y.push(M))}return y})(this._vertexBuffer,t);const r=[],s=t.length;for(let h=0;h<s;h+=3){const m=[t[h+0],t[h+1],t[h+2]],y=[this._vertexBuffer[2*t[h+0]+0],this._vertexBuffer[2*t[h+0]+1],this._vertexBuffer[2*t[h+1]+0],this._vertexBuffer[2*t[h+1]+1],this._vertexBuffer[2*t[h+2]+0],this._vertexBuffer[2*t[h+2]+1]];let v=1/0,w=1/0,C=-1/0,M=-1/0;for(let $=0;$<3;$++){const Q=y[2*$],re=y[2*$+1];v=Math.min(v,Q),C=Math.max(C,Q),w=Math.min(w,re),M=Math.max(M,re)}if(v===C||w===M)continue;const z=Math.floor(v/this._granularityCellSize),B=Math.ceil(C/this._granularityCellSize),U=Math.floor(w/this._granularityCellSize),V=Math.ceil(M/this._granularityCellSize);if(z!==B||U!==V)for(let $=U;$<V;$++){const Q=this._scanlineGenerateVertexRingForCellRow($,y,m);zl(this._vertexBuffer,Q,r)}else r.push(...m)}return r}_scanlineGenerateVertexRingForCellRow(t,r,s){const h=t*this._granularityCellSize,m=h+this._granularityCellSize,y=[];for(let v=0;v<3;v++){const w=r[2*v],C=r[2*v+1],M=r[2*(v+1)%6],z=r[(2*(v+1)+1)%6],B=r[2*(v+2)%6],U=r[(2*(v+2)+1)%6],V=M-w,$=z-C,Q=V===0,re=$===0,Te=(h-C)/$,ce=(m-C)/$,pe=Math.min(Te,ce),Fe=Math.max(Te,ce);if(!re&&(pe>=1||Fe<=0)||re&&(C<h||C>m)){z>=h&&z<=m&&y.push(s[(v+1)%3]);continue}!re&&pe>0&&y.push(this._vertexToIndex(w+V*pe,C+$*pe));const Ge=w+V*Math.max(pe,0),Je=w+V*Math.min(Fe,1);Q||this._generateIntraEdgeVertices(y,w,C,M,z,Ge,Je),!re&&Fe<1&&y.push(this._vertexToIndex(w+V*Fe,C+$*Fe)),(re||z>=h&&z<=m)&&y.push(s[(v+1)%3]),!re&&(z<=h||z>=m)&&this._generateInterEdgeVertices(y,w,C,M,z,B,U,Je,h,m)}return y}_generateIntraEdgeVertices(t,r,s,h,m,y,v){const w=h-r,C=m-s,M=C===0,z=M?Math.min(r,h):Math.min(y,v),B=M?Math.max(r,h):Math.max(y,v),U=Math.floor(z/this._granularityCellSize)+1,V=Math.ceil(B/this._granularityCellSize)-1;if(M?r<h:y<v)for(let $=U;$<=V;$++){const Q=$*this._granularityCellSize;t.push(this._vertexToIndex(Q,s+C*(Q-r)/w))}else for(let $=V;$>=U;$--){const Q=$*this._granularityCellSize;t.push(this._vertexToIndex(Q,s+C*(Q-r)/w))}}_generateInterEdgeVertices(t,r,s,h,m,y,v,w,C,M){const z=m-s,B=y-h,U=v-m,V=(C-m)/U,$=(M-m)/U,Q=Math.min(V,$),re=Math.max(V,$),Te=h+B*Q;let ce=Math.floor(Math.min(Te,w)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(Te,w)/this._granularityCellSize)-1,Fe=w<Te;const Ge=U===0;if(Ge&&(v===C||v===M))return;if(Ge||Q>=1||re<=0){const gt=s-v,ct=y+(r-y)*Math.min((C-v)/gt,(M-v)/gt);ce=Math.floor(Math.min(ct,w)/this._granularityCellSize)+1,pe=Math.ceil(Math.max(ct,w)/this._granularityCellSize)-1,Fe=w<ct}const Je=z>0?M:C;if(Fe)for(let gt=ce;gt<=pe;gt++)t.push(this._vertexToIndex(gt*this._granularityCellSize,Je));else for(let gt=pe;gt>=ce;gt--)t.push(this._vertexToIndex(gt*this._granularityCellSize,Je))}_generateOutline(t){const r=[];for(const s of t){const h=Ha(s,this._granularity,!0),m=this._pointArrayToIndices(h),y=[];for(let v=1;v<m.length;v++)y.push(m[v-1]),y.push(m[v]);r.push(y)}return r}_handlePoles(t){let r=!1,s=!1;this._canonical&&(this._canonical.y===0&&(r=!0),this._canonical.y===(1<<this._canonical.z)-1&&(s=!0)),(r||s)&&this._fillPoles(t,r,s)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let r=0;r<t.length;r+=2){const s=t[r+1];s===Tc&&(t[r+1]=-32767),s===Gi&&(t[r+1]=32766)}}_generatePoleQuad(t,r,s,h,m,y){h>m!=(y===Tc)?(t.push(r),t.push(s),t.push(this._vertexToIndex(h,y)),t.push(s),t.push(this._vertexToIndex(m,y)),t.push(this._vertexToIndex(h,y))):(t.push(s),t.push(r),t.push(this._vertexToIndex(h,y)),t.push(this._vertexToIndex(m,y)),t.push(s),t.push(this._vertexToIndex(h,y)))}_fillPoles(t,r,s){const h=this._vertexBuffer,m=Et,y=t.length;for(let v=2;v<y;v+=3){const w=t[v-2],C=t[v-1],M=t[v],z=h[2*w],B=h[2*w+1],U=h[2*C],V=h[2*C+1],$=h[2*M],Q=h[2*M+1];r&&(B===0&&V===0&&this._generatePoleQuad(t,w,C,z,U,Tc),V===0&&Q===0&&this._generatePoleQuad(t,C,M,U,$,Tc),Q===0&&B===0&&this._generatePoleQuad(t,M,w,$,z,Tc)),s&&(B===m&&V===m&&this._generatePoleQuad(t,w,C,z,U,Gi),V===m&&Q===m&&this._generatePoleQuad(t,C,M,U,$,Gi),Q===m&&B===m&&this._generatePoleQuad(t,M,w,$,z,Gi))}}_initializeVertices(t){for(let r=0;r<t.length;r+=2)this._vertexToIndex(t[r],t[r+1])}subdividePolygonInternal(t,r){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:s,holeIndices:h}=(function(v){const w=[],C=[];for(const M of v)if(M.length!==0){M!==v[0]&&w.push(C.length/2);for(let z=0;z<M.length;z++)C.push(M[z].x),C.push(M[z].y)}return{flattened:C,holeIndices:w}})(t);let m;this._initializeVertices(s);try{const v=(function(C,M,z=2){const B=M&&M.length,U=B?M[0]*z:C.length;let V=Kd(C,0,U,z,!0);const $=[];if(!V||V.next===V.prev)return $;let Q,re,Te;if(B&&(V=(function(ce,pe,Fe,Ge){const Je=[];for(let gt=0,ct=pe.length;gt<ct;gt++){const yt=Kd(ce,pe[gt]*Ge,gt<ct-1?pe[gt+1]*Ge:ce.length,Ge,!1);yt===yt.next&&(yt.steiner=!0),Je.push(Zr(yt))}Je.sort(ef);for(let gt=0;gt<Je.length;gt++)Fe=ad(Je[gt],Fe);return Fe})(C,M,V,z)),C.length>80*z){Q=C[0],re=C[1];let ce=Q,pe=re;for(let Fe=z;Fe<U;Fe+=z){const Ge=C[Fe],Je=C[Fe+1];Ge<Q&&(Q=Ge),Je<re&&(re=Je),Ge>ce&&(ce=Ge),Je>pe&&(pe=Je)}Te=Math.max(ce-Q,pe-re),Te=Te!==0?32767/Te:0}return Sa(V,$,z,Q,re,Te,0),$})(s,h),w=this._convertIndices(s,v);m=this._subdivideTrianglesScanline(w)}catch(v){console.error(v)}let y=[];return r&&(y=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(m),{verticesFlattened:this._vertexBuffer,indicesTriangles:m,indicesLineList:y}}_convertIndices(t,r){const s=[];for(let h=0;h<r.length;h++)s.push(this._vertexToIndex(t[2*r[h]],t[2*r[h]+1]));return s}_pointArrayToIndices(t){const r=[];for(let s=0;s<t.length;s++){const h=t[s];r.push(this._vertexToIndex(h.x,h.y))}return r}}function Us(i,t,r,s=!0){return new bp(r,t).subdividePolygonInternal(i,s)}function Ha(i,t,r=!1){if(!i||i.length<1)return[];if(i.length<2)return[];const s=i[0],h=i[i.length-1],m=r&&(s.x!==h.x||s.y!==h.y);if(t<2)return m?[...i,i[0]]:[...i];const y=Math.floor(Et/t),v=[];v.push(new H(i[0].x,i[0].y));const w=i.length,C=m?w:w-1;for(let M=0;M<C;M++){const z=i[M],B=M<w-1?i[M+1]:i[0],U=z.x,V=z.y,$=B.x,Q=B.y,re=U!==$,Te=V!==Q;if(!re&&!Te)continue;const ce=$-U,pe=Q-V,Fe=Math.abs(ce),Ge=Math.abs(pe);let Je=U,gt=V;for(;;){const yt=ce>0?(Math.floor(Je/y)+1)*y:(Math.ceil(Je/y)-1)*y,Dt=pe>0?(Math.floor(gt/y)+1)*y:(Math.ceil(gt/y)-1)*y,ut=Math.abs(Je-yt),dt=Math.abs(gt-Dt),$e=Math.abs(Je-$),Ft=Math.abs(gt-Q),jt=re?ut/Fe:Number.POSITIVE_INFINITY,Mt=Te?dt/Ge:Number.POSITIVE_INFINITY;if(($e<=ut||!re)&&(Ft<=dt||!Te))break;if(jt<Mt&&re||!Te){Je=yt,gt+=pe*jt;const At=new H(Je,Math.round(gt));v[v.length-1].x===At.x&&v[v.length-1].y===At.y||v.push(At)}else{Je+=ce*Mt,gt=Dt;const At=new H(Math.round(Je),gt);v[v.length-1].x===At.x&&v[v.length-1].y===At.y||v.push(At)}}const ct=new H($,Q);v[v.length-1].x===ct.x&&v[v.length-1].y===ct.y||v.push(ct)}return v}function zl(i,t,r){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let s=0,h=i[2*t[0]];for(let w=1;w<t.length;w++){const C=i[2*t[w]];C<h&&(h=C,s=w)}const m=t.length;let y=s,v=(y+1)%m;for(;;){const w=y-1>=0?y-1:m-1,C=(v+1)%m,M=i[2*t[w]],z=i[2*t[C]],B=i[2*t[y]],U=i[2*t[y]+1],V=i[2*t[v]+1];let $=!1;if(M<z)$=!0;else if(M>z)$=!1;else{const Q=V-U,re=-(i[2*t[v]]-B),Te=U<V?1:-1;((M-B)*Q+(i[2*t[w]+1]-U)*re)*Te>((z-B)*Q+(i[2*t[C]+1]-U)*re)*Te&&($=!0)}if($){const Q=t[w],re=t[y],Te=t[v];Q!==re&&Q!==Te&&re!==Te&&r.push(Te,re,Q),y--,y<0&&(y=m-1)}else{const Q=t[C],re=t[y],Te=t[v];Q!==re&&Q!==Te&&re!==Te&&r.push(Te,re,Q),v++,v>=m&&(v=0)}if(w===C)break}}function sd(i,t,r,s,h,m,y,v,w){const C=h.length/2,M=y&&v&&w;if(C<vn.MAX_VERTEX_ARRAY_LENGTH){const z=t.prepareSegment(C,r,s),B=z.vertexLength;for(let $=0;$<m.length;$+=3)s.emplaceBack(B+m[$],B+m[$+1],B+m[$+2]);let U,V;z.vertexLength+=C,z.primitiveLength+=m.length/3,M&&(V=y.prepareSegment(C,r,v),U=V.vertexLength,V.vertexLength+=C);for(let $=0;$<h.length;$+=2)i(h[$],h[$+1]);if(M)for(let $=0;$<w.length;$++){const Q=w[$];for(let re=1;re<Q.length;re+=2)v.emplaceBack(U+Q[re-1],U+Q[re]);V.primitiveLength+=Q.length/2}}else(function(z,B,U,V,$,Q){const re=[];for(let Ge=0;Ge<V.length/2;Ge++)re.push(-1);const Te={count:0};let ce=0,pe=z.getOrCreateLatestSegment(B,U),Fe=pe.vertexLength;for(let Ge=2;Ge<$.length;Ge+=3){const Je=$[Ge-2],gt=$[Ge-1],ct=$[Ge];let yt=re[Je]<ce,Dt=re[gt]<ce,ut=re[ct]<ce;pe.vertexLength+((yt?1:0)+(Dt?1:0)+(ut?1:0))>vn.MAX_VERTEX_ARRAY_LENGTH&&(pe=z.createNewSegment(B,U),ce=Te.count,yt=!0,Dt=!0,ut=!0,Fe=0);const dt=Ac(re,V,Q,Te,Je,yt,pe),$e=Ac(re,V,Q,Te,gt,Dt,pe),Ft=Ac(re,V,Q,Te,ct,ut,pe);U.emplaceBack(Fe+dt-ce,Fe+$e-ce,Fe+Ft-ce),pe.primitiveLength++}})(t,r,s,h,m,i),M&&(function(z,B,U,V,$,Q){const re=[];for(let Ge=0;Ge<V.length/2;Ge++)re.push(-1);const Te={count:0};let ce=0,pe=z.getOrCreateLatestSegment(B,U),Fe=pe.vertexLength;for(let Ge=0;Ge<$.length;Ge++){const Je=$[Ge];for(let gt=1;gt<$[Ge].length;gt+=2){const ct=Je[gt-1],yt=Je[gt];let Dt=re[ct]<ce,ut=re[yt]<ce;pe.vertexLength+((Dt?1:0)+(ut?1:0))>vn.MAX_VERTEX_ARRAY_LENGTH&&(pe=z.createNewSegment(B,U),ce=Te.count,Dt=!0,ut=!0,Fe=0);const dt=Ac(re,V,Q,Te,ct,Dt,pe),$e=Ac(re,V,Q,Te,yt,ut,pe);U.emplaceBack(Fe+dt-ce,Fe+$e-ce),pe.primitiveLength++}}})(y,r,v,h,w,i),t.forceNewSegmentOnNextPrepare(),y?.forceNewSegmentOnNextPrepare()}function Ac(i,t,r,s,h,m,y){if(m){const v=s.count;return r(t[2*h],t[2*h+1]),i[h]=s.count,s.count++,y.vertexLength++,v}return i[h]}class uo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Oe,this.indexArray=new Nn,this.indexArray2=new $n,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.segments2=new vn,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.hasPattern=ss("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:w,index:C,sourceLayerIndex:M}of t){const z=this.layers[0]._featureFilter.needGeometry,B=Bs(v,z);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),B,s))continue;const U=m?h.evaluate(B,{},s,r.availableImages):void 0,V={id:w,properties:v.properties,type:v.type,sourceLayerIndex:M,index:C,geometry:z?B.geometry:Os(v),patterns:{},sortKey:U};y.push(V)}m&&y.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of y){const{geometry:w,index:C,sourceLayerIndex:M}=v;if(this.hasPattern){const z=id("fill",this.layers,v,{zoom:this.zoom},r);this.patternFeatures.push(z)}else this.addFeature(v,w,C,s,{},r.subdivisionGranularity);r.featureIndex.insert(t[C].feature,w,C,M,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}addFeatures(t,r,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hh),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,s,h,m,y){for(const v of pl(r,500)){const w=Us(v,h,y.fill.getGranularityForZoomLevel(h.z)),C=this.layoutVertexArray;sd(((M,z)=>{C.emplaceBack(M,z)}),this.segments,this.layoutVertexArray,this.indexArray,w.verticesFlattened,w.indicesTriangles,this.segments2,this.indexArray2,w.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}}let af,Ec;bt("FillBucket",uo,{omit:["layers","patternFeatures"]});var ph={get paint(){return Ec=Ec||new ei({"fill-antialias":new Ct(Ce.paint_fill["fill-antialias"]),"fill-opacity":new zt(Ce.paint_fill["fill-opacity"]),"fill-color":new zt(Ce.paint_fill["fill-color"]),"fill-outline-color":new zt(Ce.paint_fill["fill-outline-color"]),"fill-translate":new Ct(Ce.paint_fill["fill-translate"]),"fill-translate-anchor":new Ct(Ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new Eo(Ce.paint_fill["fill-pattern"])})},get layout(){return af=af||new ei({"fill-sort-key":new zt(Ce.layout_fill["fill-sort-key"])})}};class mh extends ba{constructor(t,r){super(t,ph,r)}recalculate(t,r){super.recalculate(t,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new uo(t)}queryRadius(){return ri(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:r,transform:s,pixelsToTileUnits:h}){return Vd(ah(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-s.bearingInRadians,h),r)}isTileClipped(){return!0}}const mu=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),wp=pr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Sp}=mu;class ls{constructor(t,r,s,h,m){this.properties={},this.extent=s,this.type=0,this.id=void 0,this._pbf=t,this._geometry=-1,this._keys=h,this._values=m,t.readFields(Pp,this,r)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const r=t.readVarint()+t.pos,s=[];let h,m=1,y=0,v=0,w=0;for(;t.pos<r;){if(y<=0){const C=t.readVarint();m=7&C,y=C>>3}if(y--,m===1||m===2)v+=t.readSVarint(),w+=t.readSVarint(),m===1&&(h&&s.push(h),h=[]),h&&h.push(new H(v,w));else{if(m!==7)throw new Error(`unknown command ${m}`);h&&h.push(h[0].clone())}}return h&&s.push(h),s}bbox(){const t=this._pbf;t.pos=this._geometry;const r=t.readVarint()+t.pos;let s=1,h=0,m=0,y=0,v=1/0,w=-1/0,C=1/0,M=-1/0;for(;t.pos<r;){if(h<=0){const z=t.readVarint();s=7&z,h=z>>3}if(h--,s===1||s===2)m+=t.readSVarint(),y+=t.readSVarint(),m<v&&(v=m),m>w&&(w=m),y<C&&(C=y),y>M&&(M=y);else if(s!==7)throw new Error(`unknown command ${s}`)}return[v,C,w,M]}toGeoJSON(t,r,s){const h=this.extent*Math.pow(2,s),m=this.extent*t,y=this.extent*r,v=this.loadGeometry();function w(B){return[360*(B.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(B.y+y)/h)*Math.PI))-90]}function C(B){return B.map(w)}let M;if(this.type===1){const B=[];for(const V of v)B.push(V[0]);const U=C(B);M=B.length===1?{type:"Point",coordinates:U[0]}:{type:"MultiPoint",coordinates:U}}else if(this.type===2){const B=v.map(C);M=B.length===1?{type:"LineString",coordinates:B[0]}:{type:"MultiLineString",coordinates:B}}else{if(this.type!==3)throw new Error("unknown feature type");{const B=(function(V){const $=V.length;if($<=1)return[V];const Q=[];let re,Te;for(let ce=0;ce<$;ce++){const pe=ld(V[ce]);pe!==0&&(Te===void 0&&(Te=pe<0),Te===pe<0?(re&&Q.push(re),re=[V[ce]]):re&&re.push(V[ce]))}return re&&Q.push(re),Q})(v),U=[];for(const V of B)U.push(V.map(C));M=U.length===1?{type:"Polygon",coordinates:U[0]}:{type:"MultiPolygon",coordinates:U}}}const z={type:"Feature",geometry:M,properties:this.properties};return this.id!=null&&(z.id=this.id),z}}function Pp(i,t,r){i===1?t.id=r.readVarint():i===2?(function(s,h){const m=s.readVarint()+s.pos;for(;s.pos<m;){const y=h._keys[s.readVarint()],v=h._values[s.readVarint()];h.properties[y]=v}})(r,t):i===3?t.type=r.readVarint():i===4&&(t._geometry=r.pos)}function ld(i){let t=0;for(let r,s,h=0,m=i.length,y=m-1;h<m;y=h++)r=i[h],s=i[y],t+=(s.x-r.x)*(r.y+s.y);return t}ls.types=["Unknown","Point","LineString","Polygon"];class of{constructor(t,r){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Rm,this,r),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const r=this._pbf.readVarint()+this._pbf.pos;return new ls(this._pbf,r,this.extent,this._keys,this._values)}}function Rm(i,t,r){i===15?t.version=r.readVarint():i===1?t.name=r.readString():i===5?t.extent=r.readVarint():i===2?t._features.push(r.pos):i===3?t._keys.push(r.readString()):i===4&&t._values.push((function(s){let h=null;const m=s.readVarint()+s.pos;for(;s.pos<m;){const y=s.readVarint()>>3;h=y===1?s.readString():y===2?s.readFloat():y===3?s.readDouble():y===4?s.readVarint64():y===5?s.readVarint():y===6?s.readSVarint():y===7?s.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(r))}class Cp{constructor(t,r){this.layers=t.readFields(Xn,{},r)}}function Xn(i,t,r){if(i===3){const s=new of(r,r.readVarint()+r.pos);s.length&&(t[s.name]=s)}}const or=Math.pow(2,13);function yn(i,t,r,s,h,m,y,v){i.emplaceBack(t,r,2*Math.floor(s*or)+y,h*or*2,m*or*2,Math.round(v))}class An{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new je,this.centroidVertexArray=new Ue,this.indexArray=new Nn,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.features=[],this.hasPattern=ss("fill-extrusion",this.layers,r);for(const{feature:h,id:m,index:y,sourceLayerIndex:v}of t){const w=this.layers[0]._featureFilter.needGeometry,C=Bs(h,w);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),C,s))continue;const M={id:m,sourceLayerIndex:v,index:y,geometry:w?C.geometry:Os(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(id("fill-extrusion",this.layers,M,{zoom:this.zoom},r)):this.addFeature(M,M.geometry,y,s,{},r.subdivisionGranularity),r.featureIndex.insert(h,M.geometry,y,v,this.index,!0)}}addFeatures(t,r,s){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,r,s,t.subdivisionGranularity)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Sp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,wp.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,s,h,m,y){for(const v of pl(r,500)){const w={x:0,y:0,sampleCount:0},C=this.layoutVertexArray.length;this.processPolygon(w,h,t,v,y);const M=this.layoutVertexArray.length-C,z=Math.floor(w.x/w.sampleCount),B=Math.floor(w.y/w.sampleCount);for(let U=0;U<M;U++)this.centroidVertexArray.emplaceBack(z,B)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}processPolygon(t,r,s,h,m){if(h.length<1||js(h[0]))return;for(const z of h)z.length!==0&&Yn(t,z);const y={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},v=m.fill.getGranularityForZoomLevel(r.z),w=ls.types[s.type]==="Polygon";for(const z of h){if(z.length===0||js(z))continue;const B=Ha(z,v,w);this._generateSideFaces(B,y)}if(!w)return;const C=Us(h,r,v,!1),M=this.layoutVertexArray;sd(((z,B)=>{yn(M,z,B,0,0,1,1,0)}),this.segments,this.layoutVertexArray,this.indexArray,C.verticesFlattened,C.indicesTriangles)}_generateSideFaces(t,r){let s=0;for(let h=1;h<t.length;h++){const m=t[h],y=t[h-1];if(Ga(m,y))continue;r.segment.vertexLength+4>vn.MAX_VERTEX_ARRAY_LENGTH&&(r.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const v=m.sub(y)._perp()._unit(),w=y.dist(m);s+w>32768&&(s=0),yn(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,0,s),yn(this.layoutVertexArray,m.x,m.y,v.x,v.y,0,1,s),s+=w,yn(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,0,s),yn(this.layoutVertexArray,y.x,y.y,v.x,v.y,0,1,s);const C=r.segment.vertexLength;this.indexArray.emplaceBack(C,C+2,C+1),this.indexArray.emplaceBack(C+1,C+2,C+3),r.segment.vertexLength+=4,r.segment.primitiveLength+=2}}}function Yn(i,t){for(let r=0;r<t.length;r++){const s=t[r];r===t.length-1&&t[0].x===s.x&&t[0].y===s.y||(i.x+=s.x,i.y+=s.y,i.sampleCount++)}}function Ga(i,t){return i.x===t.x&&(i.x<0||i.x>Et)||i.y===t.y&&(i.y<0||i.y>Et)}function js(i){return i.every((t=>t.x<0))||i.every((t=>t.x>Et))||i.every((t=>t.y<0))||i.every((t=>t.y>Et))}let Mc;bt("FillExtrusionBucket",An,{omit:["layers","features"]});var sf={get paint(){return Mc=Mc||new ei({"fill-extrusion-opacity":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new zt(Ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Eo(Ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new zt(Ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new zt(Ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ct(Ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Vs extends ba{constructor(t,r){super(t,sf,r)}createBucket(t){return new An(t)}queryRadius(){return ri(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y,pixelPosMatrix:v}){const w=ah(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-m.bearingInRadians,y),C=this.paint.get("fill-extrusion-height").evaluate(r,s),M=this.paint.get("fill-extrusion-base").evaluate(r,s),z=(function(U,V){const $=[];for(const Q of U){const re=[Q.x,Q.y,0,1];er(re,re,V),$.push(new H(re[0]/re[3],re[1]/re[3]))}return $})(w,v),B=(function(U,V,$,Q){const re=[],Te=[],ce=Q[8]*V,pe=Q[9]*V,Fe=Q[10]*V,Ge=Q[11]*V,Je=Q[8]*$,gt=Q[9]*$,ct=Q[10]*$,yt=Q[11]*$;for(const Dt of U){const ut=[],dt=[];for(const $e of Dt){const Ft=$e.x,jt=$e.y,Mt=Q[0]*Ft+Q[4]*jt+Q[12],At=Q[1]*Ft+Q[5]*jt+Q[13],gn=Q[2]*Ft+Q[6]*jt+Q[14],Kn=Q[3]*Ft+Q[7]*jt+Q[15],$r=gn+Fe,pi=Kn+Ge,ea=Mt+Je,ta=At+gt,mi=gn+ct,Qn=Kn+yt,kr=new H((Mt+ce)/pi,(At+pe)/pi);kr.z=$r/pi,ut.push(kr);const ai=new H(ea/Qn,ta/Qn);ai.z=mi/Qn,dt.push(ai)}re.push(ut),Te.push(dt)}return[re,Te]})(h,M,C,v);return(function(U,V,$){let Q=1/0;Vd($,V)&&(Q=Hs($,V[0]));for(let re=0;re<V.length;re++){const Te=V[re],ce=U[re];for(let pe=0;pe<Te.length-1;pe++){const Fe=Te[pe],Ge=[Fe,Te[pe+1],ce[pe+1],ce[pe],Fe];nh($,Ge)&&(Q=Math.min(Q,Hs($,Ge)))}}return Q!==1/0&&Q})(B[0],B[1],z)}}function mr(i,t){return i.x*t.x+i.y*t.y}function Hs(i,t){if(i.length===1){let r=0;const s=t[r++];let h;for(;!h||s.equals(h);)if(h=t[r++],!h)return 1/0;for(;r<t.length;r++){const m=t[r],y=i[0],v=h.sub(s),w=m.sub(s),C=y.sub(s),M=mr(v,v),z=mr(v,w),B=mr(w,w),U=mr(C,v),V=mr(C,w),$=M*B-z*z,Q=(B*U-z*V)/$,re=(M*V-z*U)/$,Te=s.z*(1-Q-re)+h.z*Q+m.z*re;if(isFinite(Te))return Te}return 1/0}{let r=1/0;for(const s of t)r=Math.min(r,s.z);return r}}const Rc=pr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:lf}=Rc,ho=pr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:gu}=ho,gh=Math.cos(Math.PI/180*37.5),da=Math.pow(2,14)/.5;class yh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((r=>r.id)),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((r=>{this.gradients[r.id]={}})),this.layoutVertexArray=new pt,this.layoutVertexArray2=new ht,this.indexArray=new Nn,this.programConfigurations=new zo(t.layers,t.zoom),this.segments=new vn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((r=>r.isStateDependent())).map((r=>r.id))}populate(t,r,s){this.hasPattern=ss("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:w,index:C,sourceLayerIndex:M}of t){const z=this.layers[0]._featureFilter.needGeometry,B=Bs(v,z);if(!this.layers[0]._featureFilter.filter(new Ln(this.zoom),B,s))continue;const U=m?h.evaluate(B,{},s):void 0,V={id:w,properties:v.properties,type:v.type,sourceLayerIndex:M,index:C,geometry:z?B.geometry:Os(v),patterns:{},sortKey:U};y.push(V)}m&&y.sort(((v,w)=>v.sortKey-w.sortKey));for(const v of y){const{geometry:w,index:C,sourceLayerIndex:M}=v;if(this.hasPattern){const z=id("line",this.layers,v,{zoom:this.zoom},r);this.patternFeatures.push(z)}else this.addFeature(v,w,C,s,{},r.subdivisionGranularity);r.featureIndex.insert(t[C].feature,w,C,M,this.index)}}update(t,r,s){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,{imagePositions:s})}addFeatures(t,r,s){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,r,s,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,gu)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,s,h,m,y){const v=this.layers[0].layout,w=v.get("line-join").evaluate(t,{}),C=v.get("line-cap"),M=v.get("line-miter-limit"),z=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const B of r)this.addLine(B,t,w,C,M,z,h,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,s,{imagePositions:m,canonical:h})}addLine(t,r,s,h,m,y,v,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Ha(t,v?w.line.getGranularityForZoomLevel(v.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ce=0;ce<t.length-1;ce++)this.totalDistance+=t[ce].dist(t[ce+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const C=ls.types[r.type]==="Polygon";let M=t.length;for(;M>=2&&t[M-1].equals(t[M-2]);)M--;let z=0;for(;z<M-1&&t[z].equals(t[z+1]);)z++;if(M<(C?3:2))return;s==="bevel"&&(m=1.05);const B=this.overscaling<=16?122880/(512*this.overscaling):0,U=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let V,$,Q,re,Te;this.e1=this.e2=-1,C&&(V=t[M-2],Te=t[z].sub(V)._unit()._perp());for(let ce=z;ce<M;ce++){if(Q=ce===M-1?C?t[z+1]:void 0:t[ce+1],Q&&t[ce].equals(Q))continue;Te&&(re=Te),V&&($=V),V=t[ce],Te=Q?Q.sub(V)._unit()._perp():re,re=re||Te;let pe=re.add(Te);pe.x===0&&pe.y===0||pe._unit();const Fe=re.x*Te.x+re.y*Te.y,Ge=pe.x*Te.x+pe.y*Te.y,Je=Ge!==0?1/Ge:1/0,gt=2*Math.sqrt(2-2*Ge),ct=Ge<gh&&$&&Q,yt=re.x*Te.y-re.y*Te.x>0;if(ct&&ce>z){const dt=V.dist($);if(dt>2*B){const $e=V.sub(V.sub($)._mult(B/dt)._round());this.updateDistance($,$e),this.addCurrentVertex($e,re,0,0,U),$=$e}}const Dt=$&&Q;let ut=Dt?s:C?"butt":h;if(Dt&&ut==="round"&&(Je<y?ut="miter":Je<=2&&(ut="fakeround")),ut==="miter"&&Je>m&&(ut="bevel"),ut==="bevel"&&(Je>2&&(ut="flipbevel"),Je<m&&(ut="miter")),$&&this.updateDistance($,V),ut==="miter")pe._mult(Je),this.addCurrentVertex(V,pe,0,0,U);else if(ut==="flipbevel"){if(Je>100)pe=Te.mult(-1);else{const dt=Je*re.add(Te).mag()/re.sub(Te).mag();pe._perp()._mult(dt*(yt?-1:1))}this.addCurrentVertex(V,pe,0,0,U),this.addCurrentVertex(V,pe.mult(-1),0,0,U)}else if(ut==="bevel"||ut==="fakeround"){const dt=-Math.sqrt(Je*Je-1),$e=yt?dt:0,Ft=yt?0:dt;if($&&this.addCurrentVertex(V,re,$e,Ft,U),ut==="fakeround"){const jt=Math.round(180*gt/Math.PI/20);for(let Mt=1;Mt<jt;Mt++){let At=Mt/jt;if(At!==.5){const Kn=At-.5;At+=At*Kn*(At-1)*((1.0904+Fe*(Fe*(3.55645-1.43519*Fe)-3.2452))*Kn*Kn+(.848013+Fe*(.215638*Fe-1.06021)))}const gn=Te.sub(re)._mult(At)._add(re)._unit()._mult(yt?-1:1);this.addHalfVertex(V,gn.x,gn.y,!1,yt,0,U)}}Q&&this.addCurrentVertex(V,Te,-$e,-Ft,U)}else if(ut==="butt")this.addCurrentVertex(V,pe,0,0,U);else if(ut==="square"){const dt=$?1:-1;this.addCurrentVertex(V,pe,dt,dt,U)}else ut==="round"&&($&&(this.addCurrentVertex(V,re,0,0,U),this.addCurrentVertex(V,re,1,1,U,!0)),Q&&(this.addCurrentVertex(V,Te,-1,-1,U,!0),this.addCurrentVertex(V,Te,0,0,U)));if(ct&&ce<M-1){const dt=V.dist(Q);if(dt>2*B){const $e=V.add(Q.sub(V)._mult(B/dt)._round());this.updateDistance(V,$e),this.addCurrentVertex($e,Te,0,0,U),V=$e}}}}addCurrentVertex(t,r,s,h,m,y=!1){const v=r.y*h-r.x,w=-r.y-r.x*h;this.addHalfVertex(t,r.x+r.y*s,r.y-r.x*s,y,!1,s,m),this.addHalfVertex(t,v,w,y,!0,-h,m),this.distance>da/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,s,h,m,y))}addHalfVertex({x:t,y:r},s,h,m,y,v,w){const C=.5*(this.lineClips?this.scaledDistance*(da-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(m?1:0),(r<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&C)<<2,C>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const M=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,M,this.e2),w.primitiveLength++),y?this.e2=M:this.e1=M}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}let cd,_h;bt("LineBucket",yh,{omit:["layers","patternFeatures"]});var vh={get paint(){return _h=_h||new ei({"line-opacity":new zt(Ce.paint_line["line-opacity"]),"line-color":new zt(Ce.paint_line["line-color"]),"line-translate":new Ct(Ce.paint_line["line-translate"]),"line-translate-anchor":new Ct(Ce.paint_line["line-translate-anchor"]),"line-width":new zt(Ce.paint_line["line-width"]),"line-gap-width":new zt(Ce.paint_line["line-gap-width"]),"line-offset":new zt(Ce.paint_line["line-offset"]),"line-blur":new zt(Ce.paint_line["line-blur"]),"line-dasharray":new th(Ce.paint_line["line-dasharray"]),"line-pattern":new Eo(Ce.paint_line["line-pattern"]),"line-gradient":new fr(Ce.paint_line["line-gradient"])})},get layout(){return cd=cd||new ei({"line-cap":new Ct(Ce.layout_line["line-cap"]),"line-join":new zt(Ce.layout_line["line-join"]),"line-miter-limit":new Ct(Ce.layout_line["line-miter-limit"]),"line-round-limit":new Ct(Ce.layout_line["line-round-limit"]),"line-sort-key":new zt(Ce.layout_line["line-sort-key"])})}};class Ll extends zt{possiblyEvaluate(t,r){return r=new Ln(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,s,h){return r=Ht({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,s,h)}}let ii;class kl extends ba{constructor(t,r){super(t,vh,r),this.gradientVersion=0,ii||(ii=new Ll(vh.paint.properties["line-width"].specification),ii.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const r=this.gradientExpression();this.stepInterpolant=!!(function(s){return s._styleExpression!==void 0})(r)&&r._styleExpression.expression instanceof wr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=ii.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new yh(t)}queryRadius(t){const r=t,s=Dc(zr("line-width",this,r),zr("line-gap-width",this,r)),h=zr("line-offset",this,r);return s/2+Math.abs(h)+ri(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:r,featureState:s,geometry:h,transform:m,pixelsToTileUnits:y}){const v=ah(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-m.bearingInRadians,y),w=y/2*Dc(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),C=this.paint.get("line-offset").evaluate(r,s);return C&&(h=(function(M,z){const B=[];for(let U=0;U<M.length;U++){const V=M[U],$=[];for(let Q=0;Q<V.length;Q++){const re=V[Q-1],Te=V[Q],ce=V[Q+1],pe=Q===0?new H(0,0):Te.sub(re)._unit()._perp(),Fe=Q===V.length-1?new H(0,0):ce.sub(Te)._unit()._perp(),Ge=pe._add(Fe)._unit(),Je=Ge.x*Fe.x+Ge.y*Fe.y;Je!==0&&Ge._mult(1/Je),$.push(Ge._mult(z)._add(Te))}B.push($)}return B})(h,C*y)),(function(M,z,B){for(let U=0;U<z.length;U++){const V=z[U];if(M.length>=3){for(let $=0;$<V.length;$++)if(du(M,V[$]))return!0}if(ap(M,V,B))return!0}return!1})(v,h,w)}isTileClipped(){return!0}}function Dc(i,t){return t>0?t+2*i:i}const yu=pr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),cf=pr([{name:"a_projected_pos",components:3,type:"Float32"}],4);pr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uf=pr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);pr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hf=pr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),xh=pr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function df(i,t,r){return i.sections.forEach((s=>{s.text=(function(h,m,y){const v=m.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Ba.applyArabicShaping&&(h=Ba.applyArabicShaping(h)),h})(s.text,t,r)})),i}pr([{name:"triangle",components:3,type:"Uint16"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),pr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),pr([{type:"Float32",name:"offsetX"}]),pr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),pr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Zi={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var qr=24;const fa=4294967296,ff=1/fa,pf=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class mf{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,r,s=this.length){for(;this.pos<s;){const h=this.readVarint(),m=h>>3,y=this.pos;this.type=7&h,t(m,r,this),this.pos===y&&this.skip(h)}return r}readMessage(t,r){return this.readFields(t,r,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*fa;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*fa;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const r=this.buf;let s,h;return h=r[this.pos++],s=127&h,h<128?s:(h=r[this.pos++],s|=(127&h)<<7,h<128?s:(h=r[this.pos++],s|=(127&h)<<14,h<128?s:(h=r[this.pos++],s|=(127&h)<<21,h<128?s:(h=r[this.pos],s|=(15&h)<<28,(function(m,y,v){const w=v.buf;let C,M;if(M=w[v.pos++],C=(112&M)>>4,M<128||(M=w[v.pos++],C|=(127&M)<<3,M<128)||(M=w[v.pos++],C|=(127&M)<<10,M<128)||(M=w[v.pos++],C|=(127&M)<<17,M<128)||(M=w[v.pos++],C|=(127&M)<<24,M<128)||(M=w[v.pos++],C|=(1&M)<<31,M<128))return Za(m,C,y);throw new Error("Expected varint not more than 10 bytes")})(s,t,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2==1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=12&&pf?pf.decode(this.buf.subarray(r,t)):(function(s,h,m){let y="",v=h;for(;v<m;){const w=s[v];let C,M,z,B=null,U=w>239?4:w>223?3:w>191?2:1;if(v+U>m)break;U===1?w<128&&(B=w):U===2?(C=s[v+1],(192&C)==128&&(B=(31&w)<<6|63&C,B<=127&&(B=null))):U===3?(C=s[v+1],M=s[v+2],(192&C)==128&&(192&M)==128&&(B=(15&w)<<12|(63&C)<<6|63&M,(B<=2047||B>=55296&&B<=57343)&&(B=null))):U===4&&(C=s[v+1],M=s[v+2],z=s[v+3],(192&C)==128&&(192&M)==128&&(192&z)==128&&(B=(15&w)<<18|(63&C)<<12|(63&M)<<6|63&z,(B<=65535||B>=1114112)&&(B=null))),B===null?(B=65533,U=1):B>65535&&(B-=65536,y+=String.fromCharCode(B>>>10&1023|55296),B=56320|1023&B),y+=String.fromCharCode(B),v+=U}return y})(this.buf,r,t)}readBytes(){const t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r}readPackedVarint(t=[],r){const s=this.readPackedEnd();for(;this.pos<s;)t.push(this.readVarint(r));return t}readPackedSVarint(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const r=this.readPackedEnd();for(;this.pos<r;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(t){const r=7&t;if(r===0)for(;this.buf[this.pos++]>127;);else if(r===2)this.pos=this.readVarint()+this.pos;else if(r===5)this.pos+=4;else{if(r!==1)throw new Error(`Unimplemented type: ${r}`);this.pos+=8}}writeTag(t,r){this.writeVarint(t<<3|r)}realloc(t){let r=this.length||16;for(;r<this.pos+t;)r*=2;if(r!==this.length){const s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.dataView=new DataView(s.buffer),this.length=r}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*ff),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,-1&t,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*ff),!0),this.pos+=8}writeVarint(t){(t=+t||0)>268435455||t<0?(function(r,s){let h,m;if(r>=0?(h=r%4294967296|0,m=r/4294967296|0):(h=~(-r%4294967296),m=~(-r/4294967296),4294967295^h?h=h+1|0:(h=0,m=m+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,v,w){w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,y>>>=7,w.buf[w.pos++]=127&y|128,w.buf[w.pos]=127&(y>>>=7)})(h,0,s),(function(y,v){const w=(7&y)<<4;v.buf[v.pos++]|=w|((y>>>=3)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y|((y>>>=7)?128:0),y&&(v.buf[v.pos++]=127&y)))))})(m,s)})(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))}writeSVarint(t){this.writeVarint(t<0?2*-t-1:2*t)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(4*t.length),this.pos++;const r=this.pos;this.pos=(function(h,m,y){for(let v,w,C=0;C<m.length;C++){if(v=m.charCodeAt(C),v>55295&&v<57344){if(!w){v>56319||C+1===m.length?(h[y++]=239,h[y++]=191,h[y++]=189):w=v;continue}if(v<56320){h[y++]=239,h[y++]=191,h[y++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(h[y++]=239,h[y++]=191,h[y++]=189,w=null);v<128?h[y++]=v:(v<2048?h[y++]=v>>6|192:(v<65536?h[y++]=v>>12|224:(h[y++]=v>>18|240,h[y++]=v>>12&63|128),h[y++]=v>>6&63|128),h[y++]=63&v|128)}return y})(this.buf,t,this.pos);const s=this.pos-r;s>=128&&bh(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const r=t.length;this.writeVarint(r),this.realloc(r);for(let s=0;s<r;s++)this.buf[this.pos++]=t[s]}writeRawMessage(t,r){this.pos++;const s=this.pos;t(r,this);const h=this.pos-s;h>=128&&bh(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h}writeMessage(t,r,s){this.writeTag(t,2),this.writeRawMessage(r,s)}writePackedVarint(t,r){r.length&&this.writeMessage(t,gf,r)}writePackedSVarint(t,r){r.length&&this.writeMessage(t,_u,r)}writePackedBoolean(t,r){r.length&&this.writeMessage(t,Ep,r)}writePackedFloat(t,r){r.length&&this.writeMessage(t,Tp,r)}writePackedDouble(t,r){r.length&&this.writeMessage(t,Ap,r)}writePackedFixed32(t,r){r.length&&this.writeMessage(t,yf,r)}writePackedSFixed32(t,r){r.length&&this.writeMessage(t,_f,r)}writePackedFixed64(t,r){r.length&&this.writeMessage(t,Dm,r)}writePackedSFixed64(t,r){r.length&&this.writeMessage(t,Im,r)}writeBytesField(t,r){this.writeTag(t,2),this.writeBytes(r)}writeFixed32Field(t,r){this.writeTag(t,5),this.writeFixed32(r)}writeSFixed32Field(t,r){this.writeTag(t,5),this.writeSFixed32(r)}writeFixed64Field(t,r){this.writeTag(t,1),this.writeFixed64(r)}writeSFixed64Field(t,r){this.writeTag(t,1),this.writeSFixed64(r)}writeVarintField(t,r){this.writeTag(t,0),this.writeVarint(r)}writeSVarintField(t,r){this.writeTag(t,0),this.writeSVarint(r)}writeStringField(t,r){this.writeTag(t,2),this.writeString(r)}writeFloatField(t,r){this.writeTag(t,5),this.writeFloat(r)}writeDoubleField(t,r){this.writeTag(t,1),this.writeDouble(r)}writeBooleanField(t,r){this.writeVarintField(t,+r)}}function Za(i,t,r){return r?4294967296*t+(i>>>0):4294967296*(t>>>0)+(i>>>0)}function bh(i,t,r){const s=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(s);for(let h=r.pos-1;h>=i;h--)r.buf[h+s]=r.buf[h]}function gf(i,t){for(let r=0;r<i.length;r++)t.writeVarint(i[r])}function _u(i,t){for(let r=0;r<i.length;r++)t.writeSVarint(i[r])}function Tp(i,t){for(let r=0;r<i.length;r++)t.writeFloat(i[r])}function Ap(i,t){for(let r=0;r<i.length;r++)t.writeDouble(i[r])}function Ep(i,t){for(let r=0;r<i.length;r++)t.writeBoolean(i[r])}function yf(i,t){for(let r=0;r<i.length;r++)t.writeFixed32(i[r])}function _f(i,t){for(let r=0;r<i.length;r++)t.writeSFixed32(i[r])}function Dm(i,t){for(let r=0;r<i.length;r++)t.writeFixed64(i[r])}function Im(i,t){for(let r=0;r<i.length;r++)t.writeSFixed64(i[r])}function zm(i,t,r){i===1&&r.readMessage(Mp,t)}function Mp(i,t,r){if(i===3){const{id:s,bitmap:h,width:m,height:y,left:v,top:w,advance:C}=r.readMessage(Rp,{});t.push({id:s,bitmap:new fu({width:m+6,height:y+6},h),metrics:{width:m,height:y,left:v,top:w,advance:C}})}}function Rp(i,t,r){i===1?t.id=r.readVarint():i===2?t.bitmap=r.readBytes():i===3?t.width=r.readVarint():i===4?t.height=r.readVarint():i===5?t.left=r.readSVarint():i===6?t.top=r.readSVarint():i===7&&(t.advance=r.readVarint())}function Ic(i){let t=0,r=0;for(const y of i)t+=y.w*y.h,r=Math.max(r,y.w);i.sort(((y,v)=>v.h-y.h));const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let h=0,m=0;for(const y of i)for(let v=s.length-1;v>=0;v--){const w=s[v];if(!(y.w>w.w||y.h>w.h)){if(y.x=w.x,y.y=w.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===w.w&&y.h===w.h){const C=s.pop();C&&v<s.length&&(s[v]=C)}else y.h===w.h?(w.x+=y.w,w.w-=y.w):y.w===w.w?(w.y+=y.h,w.h-=y.h):(s.push({x:w.x+y.w,y:w.y,w:w.w-y.w,h:y.h}),w.y+=y.h,w.h-=y.h);break}}return{w:h,h:m,fill:t/(h*m)||0}}class vu{constructor(t,{pixelRatio:r,version:s,stretchX:h,stretchY:m,content:y,textFitWidth:v,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=h,this.stretchY=m,this.content=y,this.version=s,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class vf{constructor(t,r){const s={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(t,s,m),this.addImages(r,h,m);const{w:y,h:v}=Ic(m),w=new Vi({width:y||1,height:v||1});for(const C in t){const M=t[C],z=s[C].paddedRect;Vi.copy(M.data,w,{x:0,y:0},{x:z.x+1,y:z.y+1},M.data)}for(const C in r){const M=r[C],z=h[C].paddedRect,B=z.x+1,U=z.y+1,V=M.data.width,$=M.data.height;Vi.copy(M.data,w,{x:0,y:0},{x:B,y:U},M.data),Vi.copy(M.data,w,{x:0,y:$-1},{x:B,y:U-1},{width:V,height:1}),Vi.copy(M.data,w,{x:0,y:0},{x:B,y:U+$},{width:V,height:1}),Vi.copy(M.data,w,{x:V-1,y:0},{x:B-1,y:U},{width:1,height:$}),Vi.copy(M.data,w,{x:0,y:0},{x:B+V,y:U},{width:1,height:$})}this.image=w,this.iconPositions=s,this.patternPositions=h}addImages(t,r,s){for(const h in t){const m=t[h],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};s.push(y),r[h]=new vu(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in t.updatedImages)this.patchUpdatedImage(this.iconPositions[s],t.getImage(s),r),this.patchUpdatedImage(this.patternPositions[s],t.getImage(s),r)}patchUpdatedImage(t,r,s){if(!t||!r||t.version===r.version)return;t.version=r.version;const[h,m]=t.tl;s.update(r.data,void 0,{x:h,y:m})}}var Gs;bt("ImagePosition",vu),bt("ImageAtlas",vf),A.ao=void 0,(Gs=A.ao||(A.ao={}))[Gs.none=0]="none",Gs[Gs.horizontal=1]="horizontal",Gs[Gs.vertical=2]="vertical",Gs[Gs.horizontalOnly=3]="horizontalOnly";class xu{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,r,s){const h=new xu;return h.scale=t||1,h.fontStack=r,h.verticalAlign=s||"bottom",h}static forImage(t,r){const s=new xu;return s.imageName=t,s.verticalAlign=r||"bottom",s}}class zc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const s=new zc;for(let h=0;h<t.sections.length;h++){const m=t.sections[h];m.image?s.addImageSection(m):s.addTextSection(m,r)}return s}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=(function(t){let r="";for(let s=0;s<t.length;s++){const h=t.charCodeAt(s+1)||null,m=t.charCodeAt(s-1)||null;r+=h&&Is(h)&&!Zi[t[s+1]]||m&&Is(m)&&!Zi[t[s-1]]||!Zi[t[s]]?t[s]:Zi[t[s]]}return r})(this.text)}trim(){let t=0;for(let s=0;s<this.text.length&&Sh[this.text.charCodeAt(s)];s++)t++;let r=this.text.length;for(let s=this.text.length-1;s>=0&&s>=t&&Sh[this.text.charCodeAt(s)];s--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const s=new zc;return s.text=this.text.substring(t,r),s.sectionIndex=this.sectionIndex.slice(t,r),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((t,r)=>Math.max(t,this.sections[r].scale)),0)}getMaxImageSize(t){let r=0,s=0;for(let h=0;h<this.length();h++){const m=this.getSection(h);if(m.imageName){const y=t[m.imageName];if(!y)continue;const v=y.displaySize;r=Math.max(r,v[0]),s=Math.max(s,v[1])}}return{maxImageWidth:r,maxImageHeight:s}}addTextSection(t,r){this.text+=t.text,this.sections.push(xu.forText(t.scale,t.fontStack||r,t.verticalAlign));const s=this.sections.length-1;for(let h=0;h<t.text.length;++h)this.sectionIndex.push(s)}addImageSection(t){const r=t.image?t.image.name:"";if(r.length===0)return void un("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push(xu.forImage(r,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):un("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function wh(i,t,r,s,h,m,y,v,w,C,M,z,B,U,V){const $=zc.fromFeature(i,h);let Q;z===A.ao.vertical&&$.verticalizePunctuation();const{processBidirectionalText:re,processStyledBidirectionalText:Te}=Ba;if(re&&$.sections.length===1){Q=[];const Fe=re($.toString(),Sf($,C,m,t,s,U));for(const Ge of Fe){const Je=new zc;Je.text=Ge,Je.sections=$.sections;for(let gt=0;gt<Ge.length;gt++)Je.sectionIndex.push(0);Q.push(Je)}}else if(Te){Q=[];const Fe=Te($.text,$.sectionIndex,Sf($,C,m,t,s,U));for(const Ge of Fe){const Je=new zc;Je.text=Ge[0],Je.sectionIndex=Ge[1],Je.sections=$.sections,Q.push(Je)}}else Q=(function(Fe,Ge){const Je=[],gt=Fe.text;let ct=0;for(const yt of Ge)Je.push(Fe.substring(ct,yt)),ct=yt;return ct<gt.length&&Je.push(Fe.substring(ct,gt.length)),Je})($,Sf($,C,m,t,s,U));const ce=[],pe={positionedLines:ce,text:$.toString(),top:M[1],bottom:M[1],left:M[0],right:M[0],writingMode:z,iconsInText:!1,verticalizable:!1};return(function(Fe,Ge,Je,gt,ct,yt,Dt,ut,dt,$e,Ft,jt){let Mt=0,At=0,gn=0,Kn=0;const $r=ut==="right"?1:ut==="left"?0:.5,pi=qr/jt;let ea=0;for(const Qn of ct){Qn.trim();const kr=Qn.getMaxScale(),ai={positionedGlyphs:[],lineOffset:0};Fe.positionedLines[ea]=ai;const Or=ai.positionedGlyphs;let Ai=0;if(!Qn.length()){At+=yt,++ea;continue}const na=Lm(gt,Qn,pi);for(let ma=0;ma<Qn.length();ma++){const Tr=Qn.getSection(ma),n=Qn.getSectionIndex(ma),o=Qn.getCharCode(ma),u=bu(dt,Ft,o);let p;if(Tr.imageName){if(Fe.iconsInText=!0,Tr.scale=Tr.scale*pi,p=hd(Tr,u,kr,na,gt),!p)continue;Ai=Math.max(Ai,p.imageOffset)}else if(p=Cf(Tr,o,u,na,Ge,Je),!p)continue;const{rect:x,metrics:T,baselineOffset:F}=p;Or.push({glyph:o,imageName:Tr.imageName,x:Mt,y:At+F+-17,vertical:u,scale:Tr.scale,fontStack:Tr.fontStack,sectionIndex:n,metrics:T,rect:x}),u?(Fe.verticalizable=!0,Mt+=(Tr.imageName?T.advance:qr)*Tr.scale+$e):Mt+=T.advance*Tr.scale+$e}Or.length!==0&&(gn=Math.max(Mt-$e,gn),Tf(Or,0,Or.length-1,$r)),Mt=0,ai.lineOffset=Math.max(Ai,(kr-1)*qr);const Xr=yt*kr+Ai;At+=Xr,Kn=Math.max(Xr,Kn),++ea}const{horizontalAlign:ta,verticalAlign:mi}=Pf(Dt);(function(Qn,kr,ai,Or,Ai,na,Xr,ma,Tr){const n=(kr-ai)*Ai;let o=0;o=na!==Xr?-ma*Or- -17:-Or*Tr*Xr+.5*Xr;for(const u of Qn)for(const p of u.positionedGlyphs)p.x+=n,p.y+=o})(Fe.positionedLines,$r,ta,mi,gn,Kn,yt,At,ct.length),Fe.top+=-mi*At,Fe.bottom=Fe.top+At,Fe.left+=-ta*gn,Fe.right=Fe.left+gn})(pe,t,r,s,Q,y,v,w,z,C,B,V),!(function(Fe){for(const Ge of Fe)if(Ge.positionedGlyphs.length!==0)return!1;return!0})(ce)&&pe}const Sh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},ud={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Dp={40:!0};function xf(i,t,r,s,h,m){if(t.imageName){const y=s[t.imageName];return y?y.displaySize[0]*t.scale*qr/m+h:0}{const y=r[t.fontStack],v=y&&y[i];return v?v.metrics.advance*t.scale+h:0}}function sr(i,t,r,s){const h=Math.pow(i-t,2);return s?i<t?h/2:2*h:h+Math.abs(r)*r}function bf(i,t,r){let s=0;return i===10&&(s-=1e4),r&&(s+=150),i!==40&&i!==65288||(s+=50),t!==41&&t!==65289||(s+=50),s}function Ip(i,t,r,s,h,m){let y=null,v=sr(t,r,h,m);for(const w of s){const C=sr(t-w.x,r,h,m)+w.badness;C<=v&&(y=w,v=C)}return{index:i,x:t,priorBreak:y,badness:v}}function wf(i){return i?wf(i.priorBreak).concat(i.index):[]}function Sf(i,t,r,s,h,m){if(!i)return[];const y=[],v=(function(z,B,U,V,$,Q){let re=0;for(let Te=0;Te<z.length();Te++){const ce=z.getSection(Te);re+=xf(z.getCharCode(Te),ce,V,$,B,Q)}return re/Math.max(1,Math.ceil(re/U))})(i,t,r,s,h,m),w=i.text.indexOf("​")>=0;let C=0;for(let z=0;z<i.length();z++){const B=i.getSection(z),U=i.getCharCode(z);if(Sh[U]||(C+=xf(U,B,s,h,t,m)),z<i.length()-1){const V=!((M=U)<11904)&&(!!en["CJK Compatibility Forms"](M)||!!en["CJK Compatibility"](M)||!!en["CJK Strokes"](M)||!!en["CJK Symbols and Punctuation"](M)||!!en["Enclosed CJK Letters and Months"](M)||!!en["Halfwidth and Fullwidth Forms"](M)||!!en["Ideographic Description Characters"](M)||!!en["Vertical Forms"](M)||au.test(String.fromCodePoint(M)));(ud[U]||V||B.imageName||z!==i.length()-2&&Dp[i.getCharCode(z+1)])&&y.push(Ip(z+1,C,v,y,bf(U,i.getCharCode(z+1),V&&w),!1))}}var M;return wf(Ip(i.length(),C,v,y,0,!0))}function Pf(i){let t=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Lm(i,t,r){const s=t.getMaxScale()*qr,{maxImageWidth:h,maxImageHeight:m}=t.getMaxImageSize(i),y=Math.max(s,m*r);return{verticalLineContentWidth:Math.max(s,h*r),horizontalLineContentHeight:y}}function Ph(i){switch(i){case"top":return 0;case"center":return .5;default:return 1}}function bu(i,t,r){return!(i===A.ao.horizontal||!t&&!bc(r)||t&&(Sh[r]||(s=r,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(s)))));var s}function Cf(i,t,r,s,h,m){const y=m[i.fontStack],v=(function(C,M,z,B){if(C&&C.rect)return C;const U=M[z.fontStack],V=U&&U[B];return V?{rect:null,metrics:V.metrics}:null})(y&&y[t],h,i,t);if(v===null)return null;let w;if(r)w=s.verticalLineContentWidth-i.scale*qr;else{const C=Ph(i.verticalAlign);w=(s.horizontalLineContentHeight-i.scale*qr)*C}return{rect:v.rect,metrics:v.metrics,baselineOffset:w}}function hd(i,t,r,s,h){const m=h[i.imageName];if(!m)return null;const y=m.paddedRect,v=m.displaySize,w={width:v[0],height:v[1],left:1,top:-3,advance:t?v[1]:v[0]};let C;if(t)C=s.verticalLineContentWidth-v[1]*i.scale;else{const M=Ph(i.verticalAlign);C=(s.horizontalLineContentHeight-v[1]*i.scale)*M}return{rect:y,metrics:w,baselineOffset:C,imageOffset:(t?v[0]:v[1])*i.scale-qr*r}}function Tf(i,t,r,s){if(s===0)return;const h=i[r],m=(i[r].x+h.metrics.advance*h.scale)*s;for(let y=t;y<=r;y++)i[y].x-=m}function Lc(i,t,r){const{horizontalAlign:s,verticalAlign:h}=Pf(r),m=t[0]-i.displaySize[0]*s,y=t[1]-i.displaySize[1]*h;return{image:i,top:y,bottom:y+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function Fo(i){var t,r;let s=i.left,h=i.top,m=i.right-s,y=i.bottom-h;const v=(t=i.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(r=i.image.textFitHeight)!==null&&r!==void 0?r:"stretchOrShrink",C=(i.image.content[2]-i.image.content[0])/(i.image.content[3]-i.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&m/y<C||v==="proportional"){const M=Math.ceil(y*C);s*=M/m,m=M}}else if(v==="proportional"&&w==="stretchOnly"&&C!==0&&m/y>C){const M=Math.ceil(m/C);h*=M/y,y=M}return{x1:s,y1:h,x2:s+m,y2:h+y}}function wu(i,t,r,s,h,m){const y=i.image;let v;if(y.content){const Q=y.content,re=y.pixelRatio||1;v=[Q[0]/re,Q[1]/re,y.displaySize[0]-Q[2]/re,y.displaySize[1]-Q[3]/re]}const w=t.left*m,C=t.right*m;let M,z,B,U;r==="width"||r==="both"?(U=h[0]+w-s[3],z=h[0]+C+s[1]):(U=h[0]+(w+C-y.displaySize[0])/2,z=U+y.displaySize[0]);const V=t.top*m,$=t.bottom*m;return r==="height"||r==="both"?(M=h[1]+V-s[0],B=h[1]+$+s[2]):(M=h[1]+(V+$-y.displaySize[1])/2,B=M+y.displaySize[1]),{image:y,top:M,right:z,bottom:B,left:U,collisionPadding:v}}const Zs=128,qs=32640;function Af(i,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new Ln(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:s,interpolationType:h}=r;let m=0;for(;m<s.length&&s[m]<=i;)m++;m=Math.max(0,m-1);let y=m;for(;y<s.length&&s[y]<i+1;)y++;y=Math.min(s.length-1,y);const v=s[m],w=s[y];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:w,minSize:r.evaluate(new Ln(v)),maxSize:r.evaluate(new Ln(w)),interpolationType:h}}}function dd(i,t,r){let s="never";const h=i.get(t);return h?s=h:i.get(r)&&(s="always"),s}const zp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fd(i,t,r,s,h,m,y,v,w,C,M,z,B){const U=v?Math.min(qs,Math.round(v[0])):0,V=v?Math.min(qs,Math.round(v[1])):0;i.emplaceBack(t,r,Math.round(32*s),Math.round(32*h),m,y,(U<<1)+(w?1:0),V,16*C,16*M,256*z,256*B)}function Ch(i,t,r){i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r),i.emplaceBack(t.x,t.y,r)}function Lp(i){for(const t of i.sections)if(Ao(t.text))return!0;return!1}class pd{constructor(t){this.layoutVertexArray=new Tt,this.indexArray=new Nn,this.programConfigurations=t,this.segments=new vn,this.dynamicLayoutVertexArray=new ln,this.opacityVertexArray=new Pn,this.hasVisibleVertices=!1,this.placedSymbolArray=new ee}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,yu.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,cf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,zp,!0),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}bt("SymbolBuffers",pd);class Ef{constructor(t,r,s){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new s,this.segments=new vn,this.collisionVertexArray=new Fn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,uf.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}bt("CollisionBuffers",Ef);class Ol{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map((y=>y.id)),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Af(this.zoom,r["text-size"]),this.iconSizeData=Af(this.zoom,r["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),m=s.get("symbol-z-order");this.canOverlap=dd(s,"text-overlap","text-allow-overlap")!=="never"||dd(s,"icon-overlap","icon-allow-overlap")!=="never"||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,s.get("symbol-placement")==="point"&&(this.writingModes=s.get("text-writing-mode").map((y=>A.ao[y]))),this.stateDependentLayerIds=this.layers.filter((y=>y.isStateDependent())).map((y=>y.id)),this.sourceID=t.sourceID}createArrays(){this.text=new pd(new zo(this.layers,this.zoom,(t=>/^text/.test(t)))),this.icon=new pd(new zo(this.layers,this.zoom,(t=>/^icon/.test(t)))),this.glyphOffsetArray=new le,this.lineVertexArray=new ae,this.symbolInstances=new ie,this.textAnchorOffsets=new me}calculateGlyphDependencies(t,r,s,h,m){for(let y=0;y<t.length;y++)if(r[t.charCodeAt(y)]=!0,(s||h)&&m){const v=Zi[t.charAt(y)];v&&(r[v.charCodeAt(0)]=!0)}}populate(t,r,s){const h=this.layers[0],m=h.layout,y=m.get("text-font"),v=m.get("text-field"),w=m.get("icon-image"),C=(v.value.kind!=="constant"||v.value.value instanceof Nr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),M=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,z=m.get("symbol-sort-key");if(this.features=[],!C&&!M)return;const B=r.iconDependencies,U=r.glyphDependencies,V=r.availableImages,$=new Ln(this.zoom);for(const{feature:Q,id:re,index:Te,sourceLayerIndex:ce}of t){const pe=h._featureFilter.needGeometry,Fe=Bs(Q,pe);if(!h._featureFilter.filter($,Fe,s))continue;let Ge,Je;if(pe||(Fe.geometry=Os(Q)),C){const ct=h.getValueAndResolveTokens("text-field",Fe,s,V),yt=Nr.factory(ct),Dt=this.hasRTLText=this.hasRTLText||Lp(yt);(!Dt||Ba.getRTLTextPluginStatus()==="unavailable"||Dt&&Ba.isParsed())&&(Ge=df(yt,h,Fe))}if(M){const ct=h.getValueAndResolveTokens("icon-image",Fe,s,V);Je=ct instanceof hi?ct:hi.fromString(ct)}if(!Ge&&!Je)continue;const gt=this.sortFeaturesByKey?z.evaluate(Fe,{},s):void 0;if(this.features.push({id:re,text:Ge,icon:Je,index:Te,sourceLayerIndex:ce,geometry:Fe.geometry,properties:Q.properties,type:ls.types[Q.type],sortKey:gt}),Je&&(B[Je.name]=!0),Ge){const ct=y.evaluate(Fe,{},s).join(","),yt=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(A.ao.vertical)>=0;for(const Dt of Ge.sections)if(Dt.image)B[Dt.image.name]=!0;else{const ut=xc(Ge.toString()),dt=Dt.fontStack||ct,$e=U[dt]=U[dt]||{};this.calculateGlyphDependencies(Dt.text,$e,yt,this.allowVerticalPlacement,ut)}}}m.get("symbol-placement")==="line"&&(this.features=(function(Q){const re={},Te={},ce=[];let pe=0;function Fe(ct){ce.push(Q[ct]),pe++}function Ge(ct,yt,Dt){const ut=Te[ct];return delete Te[ct],Te[yt]=ut,ce[ut].geometry[0].pop(),ce[ut].geometry[0]=ce[ut].geometry[0].concat(Dt[0]),ut}function Je(ct,yt,Dt){const ut=re[yt];return delete re[yt],re[ct]=ut,ce[ut].geometry[0].shift(),ce[ut].geometry[0]=Dt[0].concat(ce[ut].geometry[0]),ut}function gt(ct,yt,Dt){const ut=Dt?yt[0][yt[0].length-1]:yt[0][0];return`${ct}:${ut.x}:${ut.y}`}for(let ct=0;ct<Q.length;ct++){const yt=Q[ct],Dt=yt.geometry,ut=yt.text?yt.text.toString():null;if(!ut){Fe(ct);continue}const dt=gt(ut,Dt),$e=gt(ut,Dt,!0);if(dt in Te&&$e in re&&Te[dt]!==re[$e]){const Ft=Je(dt,$e,Dt),jt=Ge(dt,$e,ce[Ft].geometry);delete re[dt],delete Te[$e],Te[gt(ut,ce[jt].geometry,!0)]=jt,ce[Ft].geometry=null}else dt in Te?Ge(dt,$e,Dt):$e in re?Je(dt,$e,Dt):(Fe(ct),re[dt]=pe-1,Te[$e]=pe-1)}return ce.filter((ct=>ct.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Q,re)=>Q.sortKey-re.sortKey))}update(t,r,s){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,{imagePositions:s}),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,{imagePositions:s}))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const s=this.lineVertexArray.length;if(t.segment!==void 0){let h=t.dist(r[t.segment+1]),m=t.dist(r[t.segment]);const y={};for(let v=t.segment+1;v<r.length;v++)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:h},v<r.length-1&&(h+=r[v+1].dist(r[v]));for(let v=t.segment||0;v>=0;v--)y[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const w=y[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(t,r,s,h,m,y,v,w,C,M,z,B){const U=t.indexArray,V=t.layoutVertexArray,$=t.segments.prepareSegment(4*r.length,V,U,this.canOverlap?y.sortKey:void 0),Q=this.glyphOffsetArray.length,re=$.vertexLength,Te=this.allowVerticalPlacement&&v===A.ao.vertical?Math.PI/2:0,ce=y.text&&y.text.sections;for(let pe=0;pe<r.length;pe++){const{tl:Fe,tr:Ge,bl:Je,br:gt,tex:ct,pixelOffsetTL:yt,pixelOffsetBR:Dt,minFontScaleX:ut,minFontScaleY:dt,glyphOffset:$e,isSDF:Ft,sectionIndex:jt}=r[pe],Mt=$.vertexLength,At=$e[1];fd(V,w.x,w.y,Fe.x,At+Fe.y,ct.x,ct.y,s,Ft,yt.x,yt.y,ut,dt),fd(V,w.x,w.y,Ge.x,At+Ge.y,ct.x+ct.w,ct.y,s,Ft,Dt.x,yt.y,ut,dt),fd(V,w.x,w.y,Je.x,At+Je.y,ct.x,ct.y+ct.h,s,Ft,yt.x,Dt.y,ut,dt),fd(V,w.x,w.y,gt.x,At+gt.y,ct.x+ct.w,ct.y+ct.h,s,Ft,Dt.x,Dt.y,ut,dt),Ch(t.dynamicLayoutVertexArray,w,Te),U.emplaceBack(Mt,Mt+2,Mt+1),U.emplaceBack(Mt+1,Mt+2,Mt+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack($e[0]),pe!==r.length-1&&jt===r[pe+1].sectionIndex||t.programConfigurations.populatePaintArrays(V.length,y,y.index,{imagePositions:{},canonical:B,formattedSection:ce&&ce[jt]})}t.placedSymbolArray.emplaceBack(w.x,w.y,Q,this.glyphOffsetArray.length-Q,re,C,M,w.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],v,0,!1,0,z)}_addCollisionDebugVertex(t,r,s,h,m,y){return r.emplaceBack(0,0),t.emplaceBack(s.x,s.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(t,r,s,h,m,y,v){const w=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),C=w.vertexLength,M=m.layoutVertexArray,z=m.collisionVertexArray,B=v.anchorX,U=v.anchorY;this._addCollisionDebugVertex(M,z,y,B,U,new H(t,r)),this._addCollisionDebugVertex(M,z,y,B,U,new H(s,r)),this._addCollisionDebugVertex(M,z,y,B,U,new H(s,h)),this._addCollisionDebugVertex(M,z,y,B,U,new H(t,h)),w.vertexLength+=4;const V=m.indexArray;V.emplaceBack(C,C+1),V.emplaceBack(C+1,C+2),V.emplaceBack(C+2,C+3),V.emplaceBack(C+3,C),w.primitiveLength+=4}addDebugCollisionBoxes(t,r,s,h){for(let m=t;m<r;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,s)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ef(ar,hf.members,$n),this.iconCollisionBox=new Ef(ar,hf.members,$n);for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,s,h,m,y,v,w,C){const M={};for(let z=r;z<s;z++){const B=t.get(z);M.textBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.textFeatureIndex=B.featureIndex;break}for(let z=h;z<m;z++){const B=t.get(z);M.verticalTextBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalTextFeatureIndex=B.featureIndex;break}for(let z=y;z<v;z++){const B=t.get(z);M.iconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.iconFeatureIndex=B.featureIndex;break}for(let z=w;z<C;z++){const B=t.get(z);M.verticalIconBox={x1:B.x1,y1:B.y1,x2:B.x2,y2:B.y2,anchorPointX:B.anchorPointX,anchorPointY:B.anchorPointY},M.verticalIconFeatureIndex=B.featureIndex;break}return M}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const s=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){const s=t.placedSymbolArray.get(r),h=s.vertexStartIndex+4*s.numGlyphs;for(let m=s.vertexStartIndex;m<h;m+=4)t.indexArray.emplaceBack(m,m+2,m+1),t.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),s=Math.cos(t),h=[],m=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const w=this.symbolInstances.get(v);h.push(0|Math.round(r*w.anchorX+s*w.anchorY)),m.push(w.featureIndex)}return y.sort(((v,w)=>h[v]-h[w]||m[w]-m[v])),y}addToSortKeyRanges(t,r){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===r?s.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const s=this.symbolInstances.get(r);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach(((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)})),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let md,kp;bt("SymbolBucket",Ol,{omit:["layers","collisionBoxArray","features","compareText"]}),Ol.MAX_GLYPHS=65535,Ol.addDynamicAttributes=Ch;var Mf={get paint(){return kp=kp||new ei({"icon-opacity":new zt(Ce.paint_symbol["icon-opacity"]),"icon-color":new zt(Ce.paint_symbol["icon-color"]),"icon-halo-color":new zt(Ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new zt(Ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new zt(Ce.paint_symbol["icon-halo-blur"]),"icon-translate":new Ct(Ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ct(Ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new zt(Ce.paint_symbol["text-opacity"]),"text-color":new zt(Ce.paint_symbol["text-color"],{runtimeType:Er,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new zt(Ce.paint_symbol["text-halo-color"]),"text-halo-width":new zt(Ce.paint_symbol["text-halo-width"]),"text-halo-blur":new zt(Ce.paint_symbol["text-halo-blur"]),"text-translate":new Ct(Ce.paint_symbol["text-translate"]),"text-translate-anchor":new Ct(Ce.paint_symbol["text-translate-anchor"])})},get layout(){return md=md||new ei({"symbol-placement":new Ct(Ce.layout_symbol["symbol-placement"]),"symbol-spacing":new Ct(Ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ct(Ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new zt(Ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ct(Ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ct(Ce.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ct(Ce.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ct(Ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ct(Ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ct(Ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new zt(Ce.layout_symbol["icon-size"]),"icon-text-fit":new Ct(Ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ct(Ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new zt(Ce.layout_symbol["icon-image"]),"icon-rotate":new zt(Ce.layout_symbol["icon-rotate"]),"icon-padding":new zt(Ce.layout_symbol["icon-padding"]),"icon-keep-upright":new Ct(Ce.layout_symbol["icon-keep-upright"]),"icon-offset":new zt(Ce.layout_symbol["icon-offset"]),"icon-anchor":new zt(Ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ct(Ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ct(Ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ct(Ce.layout_symbol["text-rotation-alignment"]),"text-field":new zt(Ce.layout_symbol["text-field"]),"text-font":new zt(Ce.layout_symbol["text-font"]),"text-size":new zt(Ce.layout_symbol["text-size"]),"text-max-width":new zt(Ce.layout_symbol["text-max-width"]),"text-line-height":new Ct(Ce.layout_symbol["text-line-height"]),"text-letter-spacing":new zt(Ce.layout_symbol["text-letter-spacing"]),"text-justify":new zt(Ce.layout_symbol["text-justify"]),"text-radial-offset":new zt(Ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ct(Ce.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new zt(Ce.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new zt(Ce.layout_symbol["text-anchor"]),"text-max-angle":new Ct(Ce.layout_symbol["text-max-angle"]),"text-writing-mode":new Ct(Ce.layout_symbol["text-writing-mode"]),"text-rotate":new zt(Ce.layout_symbol["text-rotate"]),"text-padding":new Ct(Ce.layout_symbol["text-padding"]),"text-keep-upright":new Ct(Ce.layout_symbol["text-keep-upright"]),"text-transform":new zt(Ce.layout_symbol["text-transform"]),"text-offset":new zt(Ce.layout_symbol["text-offset"]),"text-allow-overlap":new Ct(Ce.layout_symbol["text-allow-overlap"]),"text-overlap":new Ct(Ce.layout_symbol["text-overlap"]),"text-ignore-placement":new Ct(Ce.layout_symbol["text-ignore-placement"]),"text-optional":new Ct(Ce.layout_symbol["text-optional"])})}};class Su{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:Wa,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}bt("FormatSectionOverride",Su,{omit:["defaultValue"]});class gd extends ba{constructor(t,r){super(t,Mf,r)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const m of s)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,s,h){const m=this.layout.get(t).evaluate(r,{},s,h),y=this._unevaluatedLayout._values[t];return y.isDataDriven()||bo(y.value)||!m?m:(function(v,w){return w.replace(/{([^{}]+)}/g,((C,M)=>v&&M in v?String(v[M]):""))})(r.properties,m)}createBucket(t){return new Ol(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Mf.paint.overridableProperties){if(!gd.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),s=new Su(r),h=new mc(s,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new Yo("source",h):new _l("composite",h,r.value.zoomStops),this.paint._values[t]=new Ni(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,s){return!(!this.layout||r.isDataDriven()||s.isDataDriven())&&gd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const s=t.get("text-field"),h=Mf.paint.properties[r];let m=!1;const y=v=>{for(const w of v)if(h.overrides&&h.overrides.hasOverride(w))return void(m=!0)};if(s.value.kind==="constant"&&s.value.value instanceof Nr)y(s.value.value.sections);else if(s.value.kind==="source"||s.value.kind==="composite"){const v=C=>{m||(C instanceof va&&Nt(C.value)===$i?y(C.value.sections):C instanceof vs?y(C.sections):C.eachChild(v))},w=s.value;w._styleExpression&&v(w._styleExpression.expression)}return m}}let Rf;var Cn={get paint(){return Rf=Rf||new ei({"background-color":new Ct(Ce.paint_background["background-color"]),"background-pattern":new th(Ce.paint_background["background-pattern"]),"background-opacity":new Ct(Ce.paint_background["background-opacity"])})}};class Df extends ba{constructor(t,r){super(t,Cn,r)}}let Th;var If={get paint(){return Th=Th||new ei({"raster-opacity":new Ct(Ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ct(Ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ct(Ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ct(Ce.paint_raster["raster-brightness-max"]),"raster-saturation":new Ct(Ce.paint_raster["raster-saturation"]),"raster-contrast":new Ct(Ce.paint_raster["raster-contrast"]),"raster-resampling":new Ct(Ce.paint_raster["raster-resampling"]),"raster-fade-duration":new Ct(Ce.paint_raster["raster-fade-duration"])})}};class Op extends ba{constructor(t,r){super(t,If,r)}}class zf extends ba{constructor(t,r){super(t,{},r),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Ah{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._methodToThrottle()}),0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const yd={once:!0},Bl=63710088e-1;class Ws{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Ws(Zt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,s=this.lat*r,h=t.lat*r,m=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((t.lng-this.lng)*r);return Bl*Math.acos(Math.min(m,1))}static convert(t){if(t instanceof Ws)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Ws(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Ws(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Bp=2*Math.PI*Bl;function Fp(i){return Bp*Math.cos(i*Math.PI/180)}function Lf(i){return(180+i)/360}function kf(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Eh(i,t){return i/Fp(t)}function Zn(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function _d(i,t){return i*Fp(Zn(t))}class Wr{constructor(t,r,s=0){this.x=+t,this.y=+r,this.z=+s}static fromLngLat(t,r=0){const s=Ws.convert(t);return new Wr(Lf(s.lng),kf(s.lat),Eh(r,s.lat))}toLngLat(){return new Ws(360*this.x-180,Zn(this.y))}toAltitude(){return _d(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bp*(t=Zn(this.y),1/Math.cos(t*Math.PI/180));var t}}function Np(i,t,r){var s=2*Math.PI*6378137/256/Math.pow(2,r);return[i*s-2*Math.PI*6378137/2,t*s-2*Math.PI*6378137/2]}class Mh{constructor(t,r,s){if(!(function(h,m,y){return!(h<0||h>25||y<0||y>=Math.pow(2,h)||m<0||m>=Math.pow(2,h))})(t,r,s))throw new Error(`x=${r}, y=${s}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=s,this.key=kc(0,t,t,r,s)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,s){const h=(y=this.y,v=this.z,w=Np(256*(m=this.x),256*(y=Math.pow(2,v)-y-1),v),C=Np(256*(m+1),256*(y+1),v),w[0]+","+w[1]+","+C[0]+","+C[1]);var m,y,v,w,C;const M=(function(z,B,U){let V,$="";for(let Q=z;Q>0;Q--)V=1<<Q-1,$+=(B&V?1:0)+(U&V?2:0);return $})(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,M).replace(/{bbox-epsg-3857}/g,h)}isChildOf(t){const r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){const r=Math.pow(2,this.z);return new H((t.x*r-this.x)*Et,(t.y*r-this.y)*Et)}toString(){return`${this.z}/${this.x}/${this.y}`}}class vd{constructor(t,r){this.wrap=t,this.canonical=r,this.key=kc(t,r.z,r.z,r.x,r.y)}}class Ji{constructor(t,r,s,h,m){if(this.terrainRttPosMatrix32f=null,t<s)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${s}`);this.overscaledZ=t,this.wrap=r,this.canonical=new Mh(s,+h,+m),this.key=kc(r,t,s,h,m)}clone(){return new Ji(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-t;return t>this.canonical.z?new Ji(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ji(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?kc(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):kc(this.wrap*+r,t,t,this.canonical.x>>s,this.canonical.y>>s)}isChildOf(t){if(t.wrap!==this.wrap||this.overscaledZ-t.overscaledZ<=0)return!1;if(t.overscaledZ===0)return this.overscaledZ>0;const r=this.canonical.z-t.canonical.z;return!(r<0)&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Ji(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new Ji(r,this.wrap,r,s,h),new Ji(r,this.wrap,r,s+1,h),new Ji(r,this.wrap,r,s,h+1),new Ji(r,this.wrap,r,s+1,h+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ji(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ji(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new vd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Wr(t.x-this.wrap,t.y))}}function kc(i,t,r,s,h){(i*=2)<0&&(i=-1*i-1);const m=1<<r;return(m*m*i+m*h+s).toString(36)+r.toString(36)+t.toString(36)}function Pu(i,t){return t?i.properties[t]:i.id}bt("CanonicalTileID",Mh),bt("OverscaledTileID",Ji,{omit:["terrainRttPosMatrix32f"]});class $s{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(t){return this.minX=Math.min(this.minX,t.x),this.minY=Math.min(this.minY,t.y),this.maxX=Math.max(this.maxX,t.x),this.maxY=Math.max(this.maxY,t.y),this}expandBy(t){return this.minX-=t,this.minY-=t,this.maxX+=t,this.maxY+=t,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(t){return this.expandBy(-t)}map(t){const r=new $s;return r.extend(t(new H(this.minX,this.minY))),r.extend(t(new H(this.maxX,this.minY))),r.extend(t(new H(this.minX,this.maxY))),r.extend(t(new H(this.maxX,this.maxY))),r}static fromPoints(t){const r=new $s;for(const s of t)r.extend(s);return r}contains(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(t){return!this.empty()&&!t.empty()&&t.minX>=this.minX&&t.maxX<=this.maxX&&t.minY>=this.minY&&t.maxY<=this.maxY}intersects(t){return!this.empty()&&!t.empty()&&t.minX<=this.maxX&&t.maxX>=this.minX&&t.minY<=this.maxY&&t.maxY>=this.minY}}class xd{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const s=t[r];this._stringToNumber[s]=r,this._numberToString[r]=s}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Up{constructor(t,r,s,h,m){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=s,t._y=h,this.properties=t.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(t[r]=this[r]);return t}}class Of{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ns(Et,16,0),this.grid3D=new ns(Et,16,0),this.featureIndexArray=new Se,this.promoteId=r}insert(t,r,s,h,m,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,m);const w=y?this.grid3D:this.grid;for(let C=0;C<r.length;C++){const M=r[C],z=[1/0,1/0,-1/0,-1/0];for(let B=0;B<M.length;B++){const U=M[B];z[0]=Math.min(z[0],U.x),z[1]=Math.min(z[1],U.y),z[2]=Math.max(z[2],U.x),z[3]=Math.max(z[3],U.y)}z[0]<Et&&z[1]<Et&&z[2]>=0&&z[3]>=0&&w.insert(v,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Cp(new mf(this.rawTileData)).layers,this.sourceLayerCoder=new xd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,s,h){this.loadVTLayers();const m=t.params,y=Et/t.tileSize/t.scale,v=wo(m.filter,m.globalState),w=t.queryGeometry,C=t.queryPadding*y,M=$s.fromPoints(w),z=this.grid.query(M.minX-C,M.minY-C,M.maxX+C,M.maxY+C),B=$s.fromPoints(t.cameraQueryGeometry).expandBy(C),U=this.grid3D.query(B.minX,B.minY,B.maxX,B.maxY,((Q,re,Te,ce)=>(function(pe,Fe,Ge,Je,gt){for(const yt of pe)if(Fe<=yt.x&&Ge<=yt.y&&Je>=yt.x&&gt>=yt.y)return!0;const ct=[new H(Fe,Ge),new H(Fe,gt),new H(Je,gt),new H(Je,Ge)];if(pe.length>2){for(const yt of ct)if(du(pe,yt))return!0}for(let yt=0;yt<pe.length-1;yt++)if(sp(pe[yt],pe[yt+1],ct))return!0;return!1})(t.cameraQueryGeometry,Q-C,re-C,Te+C,ce+C)));for(const Q of U)z.push(Q);z.sort(Vp);const V={};let $;for(let Q=0;Q<z.length;Q++){const re=z[Q];if(re===$)continue;$=re;const Te=this.featureIndexArray.get(re);let ce=null;this.loadMatchingFeature(V,Te.bucketIndex,Te.sourceLayerIndex,Te.featureIndex,v,m.layers,m.availableImages,r,s,h,((pe,Fe,Ge)=>(ce||(ce=Os(pe)),Fe.queryIntersectsFeature({queryGeometry:w,feature:pe,featureState:Ge,geometry:ce,zoom:this.z,transform:t.transform,pixelsToTileUnits:y,pixelPosMatrix:t.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:t.getElevation}))))}return V}loadMatchingFeature(t,r,s,h,m,y,v,w,C,M,z){const B=this.bucketLayerIDs[r];if(y&&!B.some((Q=>y.has(Q))))return;const U=this.sourceLayerCoder.decode(s),V=this.vtLayers[U].feature(h);if(m.needGeometry){const Q=Bs(V,!0);if(!m.filter(new Ln(this.tileID.overscaledZ),Q,this.tileID.canonical))return}else if(!m.filter(new Ln(this.tileID.overscaledZ),V))return;const $=this.getId(V,U);for(let Q=0;Q<B.length;Q++){const re=B[Q];if(y&&!y.has(re))continue;const Te=w[re];if(!Te)continue;let ce={};$&&M&&(ce=M.getState(Te.sourceLayer||"_geojsonTileLayer",$));const pe=Ht({},C[re]);pe.paint=jp(pe.paint,Te.paint,V,ce,v),pe.layout=jp(pe.layout,Te.layout,V,ce,v);const Fe=!z||z(V,Te,ce);if(!Fe)continue;const Ge=new Up(V,this.z,this.x,this.y,$);Ge.layer=pe;let Je=t[re];Je===void 0&&(Je=t[re]=[]),Je.push({featureIndex:h,feature:Ge,intersectionZ:Fe})}}lookupSymbolFeatures(t,r,s,h,m,y,v,w){const C={};this.loadVTLayers();const M=wo(m.filterSpec,m.globalState);for(const z of t)this.loadMatchingFeature(C,s,h,z,M,y,v,w,r);return C}hasLayer(t){for(const r of this.bucketLayerIDs)for(const s of r)if(t===s)return!0;return!1}getId(t,r){var s;let h=t.id;return this.promoteId&&(h=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof h=="boolean"&&(h=Number(h)),h===void 0&&(!((s=t.properties)===null||s===void 0)&&s.cluster)&&this.promoteId&&(h=Number(t.properties.cluster_id))),h}}function jp(i,t,r,s,h){return tr(i,((m,y)=>{const v=t instanceof ao?t.get(y):null;return v&&v.evaluate?v.evaluate(r,s,h):v}))}function Vp(i,t){return t-i}function Hp(i,t,r,s,h){const m=[];for(let y=0;y<i.length;y++){const v=i[y];let w;for(let C=0;C<v.length-1;C++){let M=v[C],z=v[C+1];M.x<t&&z.x<t||(M.x<t?M=new H(t,M.y+(t-M.x)/(z.x-M.x)*(z.y-M.y))._round():z.x<t&&(z=new H(t,M.y+(t-M.x)/(z.x-M.x)*(z.y-M.y))._round()),M.y<r&&z.y<r||(M.y<r?M=new H(M.x+(r-M.y)/(z.y-M.y)*(z.x-M.x),r)._round():z.y<r&&(z=new H(M.x+(r-M.y)/(z.y-M.y)*(z.x-M.x),r)._round()),M.x>=s&&z.x>=s||(M.x>=s?M=new H(s,M.y+(s-M.x)/(z.x-M.x)*(z.y-M.y))._round():z.x>=s&&(z=new H(s,M.y+(s-M.x)/(z.x-M.x)*(z.y-M.y))._round()),M.y>=h&&z.y>=h||(M.y>=h?M=new H(M.x+(h-M.y)/(z.y-M.y)*(z.x-M.x),h)._round():z.y>=h&&(z=new H(M.x+(h-M.y)/(z.y-M.y)*(z.x-M.x),h)._round()),w&&M.equals(w[w.length-1])||(w=[M],m.push(w)),w.push(z)))))}}return m}bt("FeatureIndex",Of,{omit:["rawTileData","sourceLayerCoder"]});class Fl extends H{constructor(t,r,s,h){super(t,r),this.angle=s,h!==void 0&&(this.segment=h)}clone(){return new Fl(this.x,this.y,this.angle,this.segment)}}function Xs(i,t,r,s,h){if(t.segment===void 0||r===0)return!0;let m=t,y=t.segment+1,v=0;for(;v>-r/2;){if(y--,y<0)return!1;v-=i[y].dist(m),m=i[y]}v+=i[y].dist(i[y+1]),y++;const w=[];let C=0;for(;v<r/2;){const M=i[y],z=i[y+1];if(!z)return!1;let B=i[y-1].angleTo(M)-M.angleTo(z);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:B}),C+=B;v-w[0].distance>s;)C-=w.shift().angleDelta;if(C>h)return!1;y++,v+=M.dist(z)}return!0}function Bf(i){let t=0;for(let r=0;r<i.length-1;r++)t+=i[r].dist(i[r+1]);return t}function bd(i,t,r){return i?.6*t*r:0}function Gp(i,t){return Math.max(i?i.right-i.left:0,t?t.right-t.left:0)}function km(i,t,r,s,h,m){const y=bd(r,h,m),v=Gp(r,s)*m;let w=0;const C=Bf(i)/2;for(let M=0;M<i.length-1;M++){const z=i[M],B=i[M+1],U=z.dist(B);if(w+U>C){const V=(C-w)/U,$=to.number(z.x,B.x,V),Q=to.number(z.y,B.y,V),re=new Fl($,Q,B.angleTo(z),M);return re._round(),!y||Xs(i,re,v,y,t)?re:void 0}w+=U}}function Ff(i,t,r,s,h,m,y,v,w){const C=bd(s,m,y),M=Gp(s,h),z=M*y,B=i[0].x===0||i[0].x===w||i[0].y===0||i[0].y===w;return t-z<t/4&&(t=z+t/4),Zp(i,B?t/2*v%t:(M/2+2*m)*y*v%t,t,C,r,z,B,!1,w)}function Zp(i,t,r,s,h,m,y,v,w){const C=m/2,M=Bf(i);let z=0,B=t-r,U=[];for(let V=0;V<i.length-1;V++){const $=i[V],Q=i[V+1],re=$.dist(Q),Te=Q.angleTo($);for(;B+r<z+re;){B+=r;const ce=(B-z)/re,pe=to.number($.x,Q.x,ce),Fe=to.number($.y,Q.y,ce);if(pe>=0&&pe<w&&Fe>=0&&Fe<w&&B-C>=0&&B+C<=M){const Ge=new Fl(pe,Fe,Te,V);Ge._round(),s&&!Xs(i,Ge,m,s,h)||U.push(Ge)}}z+=re}return v||U.length||y||(U=Zp(i,z/2,r,s,h,m,y,!0,w)),U}function fo(i,t,r,s){const h=[],m=i.image,y=m.pixelRatio,v=m.paddedRect.w-2,w=m.paddedRect.h-2;let C={x1:i.left,y1:i.top,x2:i.right,y2:i.bottom};const M=m.stretchX||[[0,v]],z=m.stretchY||[[0,w]],B=($e,Ft)=>$e+Ft[1]-Ft[0],U=M.reduce(B,0),V=z.reduce(B,0),$=v-U,Q=w-V;let re=0,Te=U,ce=0,pe=V,Fe=0,Ge=$,Je=0,gt=Q;if(m.content&&s){const $e=m.content,Ft=$e[2]-$e[0],jt=$e[3]-$e[1];(m.textFitWidth||m.textFitHeight)&&(C=Fo(i)),re=Cu(M,0,$e[0]),ce=Cu(z,0,$e[1]),Te=Cu(M,$e[0],$e[2]),pe=Cu(z,$e[1],$e[3]),Fe=$e[0]-re,Je=$e[1]-ce,Ge=Ft-Te,gt=jt-pe}const ct=C.x1,yt=C.y1,Dt=C.x2-ct,ut=C.y2-yt,dt=($e,Ft,jt,Mt)=>{const At=Rh($e.stretch-re,Te,Dt,ct),gn=Nl($e.fixed-Fe,Ge,$e.stretch,U),Kn=Rh(Ft.stretch-ce,pe,ut,yt),$r=Nl(Ft.fixed-Je,gt,Ft.stretch,V),pi=Rh(jt.stretch-re,Te,Dt,ct),ea=Nl(jt.fixed-Fe,Ge,jt.stretch,U),ta=Rh(Mt.stretch-ce,pe,ut,yt),mi=Nl(Mt.fixed-Je,gt,Mt.stretch,V),Qn=new H(At,Kn),kr=new H(pi,Kn),ai=new H(pi,ta),Or=new H(At,ta),Ai=new H(gn/y,$r/y),na=new H(ea/y,mi/y),Xr=t*Math.PI/180;if(Xr){const n=Math.sin(Xr),o=Math.cos(Xr),u=[o,-n,n,o];Qn._matMult(u),kr._matMult(u),Or._matMult(u),ai._matMult(u)}const ma=$e.stretch+$e.fixed,Tr=Ft.stretch+Ft.fixed;return{tl:Qn,tr:kr,bl:Or,br:ai,tex:{x:m.paddedRect.x+1+ma,y:m.paddedRect.y+1+Tr,w:jt.stretch+jt.fixed-ma,h:Mt.stretch+Mt.fixed-Tr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ai,pixelOffsetBR:na,minFontScaleX:Ge/y/Dt,minFontScaleY:gt/y/ut,isSDF:r}};if(s&&(m.stretchX||m.stretchY)){const $e=Nf(M,$,U),Ft=Nf(z,Q,V);for(let jt=0;jt<$e.length-1;jt++){const Mt=$e[jt],At=$e[jt+1];for(let gn=0;gn<Ft.length-1;gn++)h.push(dt(Mt,Ft[gn],At,Ft[gn+1]))}}else h.push(dt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return h}function Cu(i,t,r){let s=0;for(const h of i)s+=Math.max(t,Math.min(r,h[1]))-Math.max(t,Math.min(r,h[0]));return s}function Nf(i,t,r){const s=[{fixed:-1,stretch:0}];for(const[h,m]of i){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return s.push({fixed:t+1,stretch:r}),s}function Rh(i,t,r,s){return i/t*r+s}function Nl(i,t,r,s){return i-t*r/s}bt("Anchor",Fl);class pa{constructor(t,r,s,h,m,y,v,w,C,M){var z;if(this.boxStartIndex=t.length,C){let B=y.top,U=y.bottom;const V=y.collisionPadding;V&&(B-=V[1],U+=V[3]);let $=U-B;$>0&&($=Math.max(10,$),this.circleDiameter=$)}else{const B=!((z=y.image)===null||z===void 0)&&z.content&&(y.image.textFitWidth||y.image.textFitHeight)?Fo(y):{x1:y.left,y1:y.top,x2:y.right,y2:y.bottom};B.y1=B.y1*v-w[0],B.y2=B.y2*v+w[2],B.x1=B.x1*v-w[3],B.x2=B.x2*v+w[1];const U=y.collisionPadding;if(U&&(B.x1-=U[0]*v,B.y1-=U[1]*v,B.x2+=U[2]*v,B.y2+=U[3]*v),M){const V=new H(B.x1,B.y1),$=new H(B.x2,B.y1),Q=new H(B.x1,B.y2),re=new H(B.x2,B.y2),Te=M*Math.PI/180;V._rotate(Te),$._rotate(Te),Q._rotate(Te),re._rotate(Te),B.x1=Math.min(V.x,$.x,Q.x,re.x),B.x2=Math.max(V.x,$.x,Q.x,re.x),B.y1=Math.min(V.y,$.y,Q.y,re.y),B.y2=Math.max(V.y,$.y,Q.y,re.y)}t.emplaceBack(r.x,r.y,B.x1,B.y1,B.x2,B.y2,s,h,m)}this.boxEndIndex=t.length}}class qp{constructor(t=[],r=(s,h)=>s<h?-1:s>h?1:0){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],r=this.data.pop();return--this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:r,compare:s}=this,h=r[t];for(;t>0;){const m=t-1>>1,y=r[m];if(s(h,y)>=0)break;r[t]=y,t=m}r[t]=h}_down(t){const{data:r,compare:s}=this,h=this.length>>1,m=r[t];for(;t<h;){let y=1+(t<<1);const v=y+1;if(v<this.length&&s(r[v],r[y])<0&&(y=v),s(r[y],m)>=0)break;r[t]=r[y],t=y}r[t]=m}}function wd(i,t=1,r=!1){const s=$s.fromPoints(i[0]),h=Math.min(s.width(),s.height());let m=h/2;const y=new qp([],Ys),{minX:v,minY:w,maxX:C,maxY:M}=s;if(h===0)return new H(v,w);for(let U=v;U<C;U+=h)for(let V=w;V<M;V+=h)y.push(new Tu(U+m,V+m,m,i));let z=(function(U){let V=0,$=0,Q=0;const re=U[0];for(let Te=0,ce=re.length,pe=ce-1;Te<ce;pe=Te++){const Fe=re[Te],Ge=re[pe],Je=Fe.x*Ge.y-Ge.x*Fe.y;$+=(Fe.x+Ge.x)*Je,Q+=(Fe.y+Ge.y)*Je,V+=3*Je}return new Tu($/V,Q/V,0,U)})(i),B=y.length;for(;y.length;){const U=y.pop();(U.d>z.d||!z.d)&&(z=U,r&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,B)),U.max-z.d<=t||(m=U.h/2,y.push(new Tu(U.p.x-m,U.p.y-m,m,i)),y.push(new Tu(U.p.x+m,U.p.y-m,m,i)),y.push(new Tu(U.p.x-m,U.p.y+m,m,i)),y.push(new Tu(U.p.x+m,U.p.y+m,m,i)),B+=4)}return r&&(console.log(`num probes: ${B}`),console.log(`best distance: ${z.d}`)),z.p}function Ys(i,t){return t.max-i.max}function Tu(i,t,r,s){this.p=new H(i,t),this.h=r,this.d=(function(h,m){let y=!1,v=1/0;for(let w=0;w<m.length;w++){const C=m[w];for(let M=0,z=C.length,B=z-1;M<z;B=M++){const U=C[M],V=C[B];U.y>h.y!=V.y>h.y&&h.x<(V.x-U.x)*(h.y-U.y)/(V.y-U.y)+U.x&&(y=!y),v=Math.min(v,Hd(h,U,V))}}return(y?1:-1)*Math.sqrt(v)})(this.p,s),this.max=this.d+this.h*Math.SQRT2}var Ti;A.aE=void 0,(Ti=A.aE||(A.aE={}))[Ti.center=1]="center",Ti[Ti.left=2]="left",Ti[Ti.right=3]="right",Ti[Ti.top=4]="top",Ti[Ti.bottom=5]="bottom",Ti[Ti["top-left"]=6]="top-left",Ti[Ti["top-right"]=7]="top-right",Ti[Ti["bottom-left"]=8]="bottom-left",Ti[Ti["bottom-right"]=9]="bottom-right";const Ul=Number.POSITIVE_INFINITY;function Uf(i,t){return t[1]!==Ul?(function(r,s,h){let m=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),r){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(r){case"top-right":case"bottom-right":case"right":m=-s;break;case"top-left":case"bottom-left":case"left":m=s}return[m,y]})(i,t[0],t[1]):(function(r,s){let h=0,m=0;s<0&&(s=0);const y=s/Math.SQRT2;switch(r){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-s;break;case"top":m=s-7}switch(r){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,m]})(i,t[0])}function Wp(i,t,r){var s;const h=i.layout,m=(s=h.get("text-variable-anchor-offset"))===null||s===void 0?void 0:s.evaluate(t,{},r);if(m){const v=m.values,w=[];for(let C=0;C<v.length;C+=2){const M=w[C]=v[C],z=v[C+1].map((B=>B*qr));M.startsWith("top")?z[1]-=7:M.startsWith("bottom")&&(z[1]+=7),w[C+1]=z}return new ui(w)}const y=h.get("text-variable-anchor");if(y){let v;v=i._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(t,{},r)*qr,Ul]:h.get("text-offset").evaluate(t,{},r).map((C=>C*qr));const w=[];for(const C of y)w.push(C,Uf(C,v));return new ui(w)}return null}function jf(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Om(i,t,r,s,h,m,y,v,w,C,M,z){let B=m.textMaxSize.evaluate(t,{});B===void 0&&(B=y);const U=i.layers[0].layout,V=U.get("icon-offset").evaluate(t,{},M),$=Xp(r.horizontal),Q=y/24,re=i.tilePixelRatio*Q,Te=i.tilePixelRatio*B/24,ce=i.tilePixelRatio*v,pe=i.tilePixelRatio*U.get("symbol-spacing"),Fe=U.get("text-padding")*i.tilePixelRatio,Ge=(function(jt,Mt,At,gn=1){const Kn=jt.get("icon-padding").evaluate(Mt,{},At),$r=Kn&&Kn.values;return[$r[0]*gn,$r[1]*gn,$r[2]*gn,$r[3]*gn]})(U,t,M,i.tilePixelRatio),Je=U.get("text-max-angle")/180*Math.PI,gt=U.get("text-rotation-alignment")!=="viewport"&&U.get("symbol-placement")!=="point",ct=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",yt=U.get("symbol-placement"),Dt=pe/2,ut=U.get("icon-text-fit");let dt;s&&ut!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(dt=wu(s,r.vertical,ut,U.get("icon-text-fit-padding"),V,Q)),$&&(s=wu(s,$,ut,U.get("icon-text-fit-padding"),V,Q)));const $e=M?z.line.getGranularityForZoomLevel(M.z):1,Ft=(jt,Mt)=>{Mt.x<0||Mt.x>=Et||Mt.y<0||Mt.y>=Et||(function(At,gn,Kn,$r,pi,ea,ta,mi,Qn,kr,ai,Or,Ai,na,Xr,ma,Tr,n,o,u,p,x,T,F,X){const fe=At.addToLineVertexArray(gn,Kn);let Ne,Qe,tt,Ve,Ze=0,tn=0,Yt=0,Jn=0,Me=-1,Ae=-1;const Le={};let et=Io("");if(At.allowVerticalPlacement&&$r.vertical){const ga=mi.layout.get("text-rotate").evaluate(p,{},F)+90;tt=new pa(Qn,gn,kr,ai,Or,$r.vertical,Ai,na,Xr,ga),ta&&(Ve=new pa(Qn,gn,kr,ai,Or,ta,Tr,n,Xr,ga))}if(pi){const ga=mi.layout.get("icon-rotate").evaluate(p,{}),No=mi.layout.get("icon-text-fit")!=="none",Lh=fo(pi,ga,T,No),Qs=ta?fo(ta,ga,T,No):void 0;Qe=new pa(Qn,gn,kr,ai,Or,pi,Tr,n,!1,ga),Ze=4*Lh.length;const kh=At.iconSizeData;let Gl=null;kh.kind==="source"?(Gl=[Zs*mi.layout.get("icon-size").evaluate(p,{})],Gl[0]>qs&&un(`${At.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):kh.kind==="composite"&&(Gl=[Zs*x.compositeIconSizes[0].evaluate(p,{},F),Zs*x.compositeIconSizes[1].evaluate(p,{},F)],(Gl[0]>qs||Gl[1]>qs)&&un(`${At.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),At.addSymbols(At.icon,Lh,Gl,u,o,p,A.ao.none,gn,fe.lineStartIndex,fe.lineLength,-1,F),Me=At.icon.placedSymbolArray.length-1,Qs&&(tn=4*Qs.length,At.addSymbols(At.icon,Qs,Gl,u,o,p,A.ao.vertical,gn,fe.lineStartIndex,fe.lineLength,-1,F),Ae=At.icon.placedSymbolArray.length-1)}const Lt=Object.keys($r.horizontal);for(const ga of Lt){const No=$r.horizontal[ga];if(!Ne){et=Io(No.text);const Qs=mi.layout.get("text-rotate").evaluate(p,{},F);Ne=new pa(Qn,gn,kr,ai,Or,No,Ai,na,Xr,Qs)}const Lh=No.positionedLines.length===1;if(Yt+=$p(At,gn,No,ea,mi,Xr,p,ma,fe,$r.vertical?A.ao.horizontal:A.ao.horizontalOnly,Lh?Lt:[ga],Le,Me,x,F),Lh)break}$r.vertical&&(Jn+=$p(At,gn,$r.vertical,ea,mi,Xr,p,ma,fe,A.ao.vertical,["vertical"],Le,Ae,x,F));const wn=Ne?Ne.boxStartIndex:At.collisionBoxArray.length,Vt=Ne?Ne.boxEndIndex:At.collisionBoxArray.length,Jt=tt?tt.boxStartIndex:At.collisionBoxArray.length,Ei=tt?tt.boxEndIndex:At.collisionBoxArray.length,On=Qe?Qe.boxStartIndex:At.collisionBoxArray.length,Hl=Qe?Qe.boxEndIndex:At.collisionBoxArray.length,Fm=Ve?Ve.boxStartIndex:At.collisionBoxArray.length,N_=Ve?Ve.boxEndIndex:At.collisionBoxArray.length;let Ks=-1;const Qp=(ga,No)=>ga&&ga.circleDiameter?Math.max(ga.circleDiameter,No):No;Ks=Qp(Ne,Ks),Ks=Qp(tt,Ks),Ks=Qp(Qe,Ks),Ks=Qp(Ve,Ks);const Mg=Ks>-1?1:0;Mg&&(Ks*=X/qr),At.glyphOffsetArray.length>=Ol.MAX_GLYPHS&&un("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),p.sortKey!==void 0&&At.addToSortKeyRanges(At.symbolInstances.length,p.sortKey);const U_=Wp(mi,p,F),[j_,V_]=(function(ga,No){const Lh=ga.length,Qs=No?.values;if(Qs?.length>0)for(let kh=0;kh<Qs.length;kh+=2){const Gl=Qs[kh+1];ga.emplaceBack(A.aE[Qs[kh]],Gl[0],Gl[1])}return[Lh,ga.length]})(At.textAnchorOffsets,U_);At.symbolInstances.emplaceBack(gn.x,gn.y,Le.right>=0?Le.right:-1,Le.center>=0?Le.center:-1,Le.left>=0?Le.left:-1,Le.vertical||-1,Me,Ae,et,wn,Vt,Jt,Ei,On,Hl,Fm,N_,kr,Yt,Jn,Ze,tn,Mg,0,Ai,Ks,j_,V_)})(i,Mt,jt,r,s,h,dt,i.layers[0],i.collisionBoxArray,t.index,t.sourceLayerIndex,i.index,re,[Fe,Fe,Fe,Fe],gt,w,ce,Ge,ct,V,t,m,C,M,y)};if(yt==="line")for(const jt of Hp(t.geometry,0,0,Et,Et)){const Mt=Ha(jt,$e),At=Ff(Mt,pe,Je,r.vertical||$,s,24,Te,i.overscaling,Et);for(const gn of At)$&&Bm(i,$.text,Dt,gn)||Ft(Mt,gn)}else if(yt==="line-center"){for(const jt of t.geometry)if(jt.length>1){const Mt=Ha(jt,$e),At=km(Mt,Je,r.vertical||$,s,24,Te);At&&Ft(Mt,At)}}else if(t.type==="Polygon")for(const jt of pl(t.geometry,0)){const Mt=wd(jt,16);Ft(Ha(jt[0],$e,!0),new Fl(Mt.x,Mt.y,0))}else if(t.type==="LineString")for(const jt of t.geometry){const Mt=Ha(jt,$e);Ft(Mt,new Fl(Mt[0].x,Mt[0].y,0))}else if(t.type==="Point")for(const jt of t.geometry)for(const Mt of jt)Ft([Mt],new Fl(Mt.x,Mt.y,0))}function $p(i,t,r,s,h,m,y,v,w,C,M,z,B,U,V){const $=(function(Te,ce,pe,Fe,Ge,Je,gt,ct){const yt=Fe.layout.get("text-rotate").evaluate(Je,{})*Math.PI/180,Dt=[];for(const ut of ce.positionedLines)for(const dt of ut.positionedGlyphs){if(!dt.rect)continue;const $e=dt.rect||{};let Ft=4,jt=!0,Mt=1,At=0;const gn=(Ge||ct)&&dt.vertical,Kn=dt.metrics.advance*dt.scale/2;if(ct&&ce.verticalizable&&(At=ut.lineOffset/2-(dt.imageName?-(qr-dt.metrics.width*dt.scale)/2:(dt.scale-1)*qr)),dt.imageName){const n=gt[dt.imageName];jt=n.sdf,Mt=n.pixelRatio,Ft=1/Mt}const $r=Ge?[dt.x+Kn,dt.y]:[0,0];let pi=Ge?[0,0]:[dt.x+Kn+pe[0],dt.y+pe[1]-At],ea=[0,0];gn&&(ea=pi,pi=[0,0]);const ta=dt.metrics.isDoubleResolution?2:1,mi=(dt.metrics.left-Ft)*dt.scale-Kn+pi[0],Qn=(-dt.metrics.top-Ft)*dt.scale+pi[1],kr=mi+$e.w/ta*dt.scale/Mt,ai=Qn+$e.h/ta*dt.scale/Mt,Or=new H(mi,Qn),Ai=new H(kr,Qn),na=new H(mi,ai),Xr=new H(kr,ai);if(gn){const n=new H(-Kn,Kn- -17),o=-Math.PI/2,u=12-Kn,p=new H(22-u,-(dt.imageName?u:0)),x=new H(...ea);Or._rotateAround(o,n)._add(p)._add(x),Ai._rotateAround(o,n)._add(p)._add(x),na._rotateAround(o,n)._add(p)._add(x),Xr._rotateAround(o,n)._add(p)._add(x)}if(yt){const n=Math.sin(yt),o=Math.cos(yt),u=[o,-n,n,o];Or._matMult(u),Ai._matMult(u),na._matMult(u),Xr._matMult(u)}const ma=new H(0,0),Tr=new H(0,0);Dt.push({tl:Or,tr:Ai,bl:na,br:Xr,tex:$e,writingMode:ce.writingMode,glyphOffset:$r,sectionIndex:dt.sectionIndex,isSDF:jt,pixelOffsetTL:ma,pixelOffsetBR:Tr,minFontScaleX:0,minFontScaleY:0})}return Dt})(0,r,v,h,m,y,s,i.allowVerticalPlacement),Q=i.textSizeData;let re=null;Q.kind==="source"?(re=[Zs*h.layout.get("text-size").evaluate(y,{})],re[0]>qs&&un(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):Q.kind==="composite"&&(re=[Zs*U.compositeTextSizes[0].evaluate(y,{},V),Zs*U.compositeTextSizes[1].evaluate(y,{},V)],(re[0]>qs||re[1]>qs)&&un(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,$,re,v,m,y,C,t,w.lineStartIndex,w.lineLength,B,V);for(const Te of M)z[Te]=i.text.placedSymbolArray.length-1;return 4*$.length}function Xp(i){for(const t in i)return i[t];return null}function Bm(i,t,r,s){const h=i.compareText;if(t in h){const m=h[t];for(let y=m.length-1;y>=0;y--)if(s.dist(m[y])<r)return!0}else h[t]=[];return h[t].push(s),!1}const Yp=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Sd{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,s]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=s>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=Yp[15&s];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new Sd(v,y,m,t)}constructor(t,r=64,s=Float64Array,h){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=s,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const m=Yp.indexOf(this.ArrayType),y=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${s}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=t,this.coords[this._pos++]=r,s}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return jl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,s,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,w=[0,m.length-1,0],C=[];for(;w.length;){const M=w.pop()||0,z=w.pop()||0,B=w.pop()||0;if(z-B<=v){for(let Q=B;Q<=z;Q++){const re=y[2*Q],Te=y[2*Q+1];re>=t&&re<=s&&Te>=r&&Te<=h&&C.push(m[Q])}continue}const U=B+z>>1,V=y[2*U],$=y[2*U+1];V>=t&&V<=s&&$>=r&&$<=h&&C.push(m[U]),(M===0?t<=V:r<=$)&&(w.push(B),w.push(U-1),w.push(1-M)),(M===0?s>=V:h>=$)&&(w.push(U+1),w.push(z),w.push(1-M))}return C}within(t,r,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,v=[0,h.length-1,0],w=[],C=s*s;for(;v.length;){const M=v.pop()||0,z=v.pop()||0,B=v.pop()||0;if(z-B<=y){for(let Q=B;Q<=z;Q++)Oc(m[2*Q],m[2*Q+1],t,r)<=C&&w.push(h[Q]);continue}const U=B+z>>1,V=m[2*U],$=m[2*U+1];Oc(V,$,t,r)<=C&&w.push(h[U]),(M===0?t-s<=V:r-s<=$)&&(v.push(B),v.push(U-1),v.push(1-M)),(M===0?t+s>=V:r+s>=$)&&(v.push(U+1),v.push(z),v.push(1-M))}return w}}function jl(i,t,r,s,h,m){if(h-s<=r)return;const y=s+h>>1;Au(i,t,y,s,h,m),jl(i,t,r,s,y-1,1-m),jl(i,t,r,y+1,h,1-m)}function Au(i,t,r,s,h,m){for(;h>s;){if(h-s>600){const C=h-s+1,M=r-s+1,z=Math.log(C),B=.5*Math.exp(2*z/3),U=.5*Math.sqrt(z*B*(C-B)/C)*(M-C/2<0?-1:1);Au(i,t,r,Math.max(s,Math.floor(r-M*B/C+U)),Math.min(h,Math.floor(r+(C-M)*B/C+U)),m)}const y=t[2*r+m];let v=s,w=h;for(Eu(i,t,s,r),t[2*h+m]>y&&Eu(i,t,s,h);v<w;){for(Eu(i,t,v,w),v++,w--;t[2*v+m]<y;)v++;for(;t[2*w+m]>y;)w--}t[2*s+m]===y?Eu(i,t,s,w):(w++,Eu(i,t,w,h)),w<=r&&(s=w+1),r<=w&&(h=w-1)}}function Eu(i,t,r,s){Vf(i,r,s),Vf(t,2*r,2*s),Vf(t,2*r+1,2*s+1)}function Vf(i,t,r){const s=i[t];i[t]=i[r],i[r]=s}function Oc(i,t,r,s){const h=i-r,m=t-s;return h*h+m*m}var Bc;A.cx=void 0,(Bc=A.cx||(A.cx={})).create="create",Bc.load="load",Bc.fullLoad="fullLoad";let Dh=null,Vl=[];const Ih=1e3/60,zh="loadTime",Mu="fullLoadTime",Kp={mark(i){performance.mark(i)},frame(i){const t=i;Dh!=null&&Vl.push(t-Dh),Dh=t},clearMetrics(){Dh=null,Vl=[],performance.clearMeasures(zh),performance.clearMeasures(Mu);for(const i in A.cx)performance.clearMarks(A.cx[i])},getPerformanceMetrics(){performance.measure(zh,A.cx.create,A.cx.load),performance.measure(Mu,A.cx.create,A.cx.fullLoad);const i=performance.getEntriesByName(zh)[0].duration,t=performance.getEntriesByName(Mu)[0].duration,r=Vl.length,s=1/(Vl.reduce(((m,y)=>m+y),0)/r/1e3),h=Vl.filter((m=>m>Ih)).reduce(((m,y)=>m+(y-Ih)/Ih),0);return{loadTime:i,fullLoadTime:t,fps:s,percentDroppedFrames:h/(r+h)*100,totalFrames:r}}};A.$=Et,A.A=He,A.B=function([i,t,r]){return t+=90,t*=Math.PI/180,r*=Math.PI/180,{x:i*Math.cos(t)*Math.sin(r),y:i*Math.sin(t)*Math.sin(r),z:i*Math.cos(r)}},A.C=to,A.D=Ct,A.E=Pt,A.F=Ln,A.G=Qu,A.H=function(i){if(nr==null){const t=i.navigator?i.navigator.userAgent:null;nr=!!i.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return nr},A.I=vu,A.J=class{constructor(i,t){this.target=i,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Ah((()=>this.process())),this.subscription=ra(this.target,"message",(r=>this.receive(r)),!1),this.globalScope=Ar(self)?i:window}registerMessageHandler(i,t){this.messageHandlers[i]=t}sendAsync(i,t){return new Promise(((r,s)=>{const h=Math.round(1e18*Math.random()).toString(36).substring(0,10),m=t?ra(t.signal,"abort",(()=>{m?.unsubscribe(),delete this.resolveRejects[h];const w={id:h,type:"<cancel>",origin:location.origin,targetMapId:i.targetMapId,sourceMapId:this.mapId};this.target.postMessage(w)}),yd):null;this.resolveRejects[h]={resolve:w=>{m?.unsubscribe(),r(w)},reject:w=>{m?.unsubscribe(),s(w)}};const y=[],v=Object.assign(Object.assign({},i),{id:h,sourceMapId:this.mapId,origin:location.origin,data:Oa(i.data,y)});this.target.postMessage(v,{transfer:y})}))}receive(i){const t=i.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];const s=this.abortControllers[r];return delete this.abortControllers[r],void(s&&s.abort())}if(Ar(self)||t.mustQueue)return this.tasks[r]=t,this.taskQueue.push(r),void this.invoker.trigger();this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;const i=this.taskQueue.shift(),t=this.tasks[i];delete this.tasks[i],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(i,t)}processTask(i,t){return c(this,void 0,void 0,(function*(){if(t.type==="<response>"){const h=this.resolveRejects[i];return delete this.resolveRejects[i],h?void(t.error?h.reject(Ds(t.error)):h.resolve(Ds(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(i,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const r=Ds(t.data),s=new AbortController;this.abortControllers[i]=s;try{const h=yield this.messageHandlers[t.type](t.sourceMapId,r,s);this.completeTask(i,null,h)}catch(h){this.completeTask(i,h)}}))}completeTask(i,t,r){const s=[];delete this.abortControllers[i];const h={id:i,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Oa(t):null,data:Oa(r,s)};this.target.postMessage(h,{transfer:s})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},A.K=K,A.L=function(){var i=new He(16);return He!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},A.M=function(i,t,r){var s,h,m,y,v,w,C,M,z,B,U,V,$=r[0],Q=r[1],re=r[2];return t===i?(i[12]=t[0]*$+t[4]*Q+t[8]*re+t[12],i[13]=t[1]*$+t[5]*Q+t[9]*re+t[13],i[14]=t[2]*$+t[6]*Q+t[10]*re+t[14],i[15]=t[3]*$+t[7]*Q+t[11]*re+t[15]):(h=t[1],m=t[2],y=t[3],v=t[4],w=t[5],C=t[6],M=t[7],z=t[8],B=t[9],U=t[10],V=t[11],i[0]=s=t[0],i[1]=h,i[2]=m,i[3]=y,i[4]=v,i[5]=w,i[6]=C,i[7]=M,i[8]=z,i[9]=B,i[10]=U,i[11]=V,i[12]=s*$+v*Q+z*re+t[12],i[13]=h*$+w*Q+B*re+t[13],i[14]=m*$+C*Q+U*re+t[14],i[15]=y*$+M*Q+V*re+t[15]),i},A.N=function(i,t,r){var s=r[0],h=r[1],m=r[2];return i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[3]=t[3]*s,i[4]=t[4]*h,i[5]=t[5]*h,i[6]=t[6]*h,i[7]=t[7]*h,i[8]=t[8]*m,i[9]=t[9]*m,i[10]=t[10]*m,i[11]=t[11]*m,i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},A.O=function(i,t,r){var s=t[0],h=t[1],m=t[2],y=t[3],v=t[4],w=t[5],C=t[6],M=t[7],z=t[8],B=t[9],U=t[10],V=t[11],$=t[12],Q=t[13],re=t[14],Te=t[15],ce=r[0],pe=r[1],Fe=r[2],Ge=r[3];return i[0]=ce*s+pe*v+Fe*z+Ge*$,i[1]=ce*h+pe*w+Fe*B+Ge*Q,i[2]=ce*m+pe*C+Fe*U+Ge*re,i[3]=ce*y+pe*M+Fe*V+Ge*Te,i[4]=(ce=r[4])*s+(pe=r[5])*v+(Fe=r[6])*z+(Ge=r[7])*$,i[5]=ce*h+pe*w+Fe*B+Ge*Q,i[6]=ce*m+pe*C+Fe*U+Ge*re,i[7]=ce*y+pe*M+Fe*V+Ge*Te,i[8]=(ce=r[8])*s+(pe=r[9])*v+(Fe=r[10])*z+(Ge=r[11])*$,i[9]=ce*h+pe*w+Fe*B+Ge*Q,i[10]=ce*m+pe*C+Fe*U+Ge*re,i[11]=ce*y+pe*M+Fe*V+Ge*Te,i[12]=(ce=r[12])*s+(pe=r[13])*v+(Fe=r[14])*z+(Ge=r[15])*$,i[13]=ce*h+pe*w+Fe*B+Ge*Q,i[14]=ce*m+pe*C+Fe*U+Ge*re,i[15]=ce*y+pe*M+Fe*V+Ge*Te,i},A.P=H,A.Q=function(i,t){const r={};for(let s=0;s<t.length;s++){const h=t[s];h in i&&(r[h]=i[h])}return r},A.R=Vi,A.S=Ws,A.T=Pc,A.U=kf,A.V=Lf,A.W=ze,A.X=De,A.Y=Mi,A.Z=Ji,A._=c,A.a=Z,A.a$=jn,A.a0=function(i,t){var r,s,h,m,y;if(!i)return t??{};if(!t)return i;let v=Object.assign({},i);if(t.removeAll&&(v={removeAll:!0}),t.remove){const w=new Set(t.remove);v.add&&(v.add=v.add.filter((M=>!w.has(M.id)))),v.update&&(v.update=v.update.filter((M=>!w.has(M.id))));const C=new Set(((r=i.add)!==null&&r!==void 0?r:[]).map((M=>M.id)));t.remove=t.remove.filter((M=>!C.has(M)))}if(t.remove){const w=new Set(v.remove?v.remove.concat(t.remove):t.remove);v.remove=Array.from(w.values())}if(t.add){const w=v.add?v.add.concat(t.add):t.add,C=new Map(w.map((M=>[M.id,M])));v.add=Array.from(C.values())}if(t.update){const w=new Map((s=v.update)===null||s===void 0?void 0:s.map((C=>[C.id,C])));for(const C of t.update){const M=(h=w.get(C.id))!==null&&h!==void 0?h:{id:C.id};C.newGeometry&&(M.newGeometry=C.newGeometry),C.addOrUpdateProperties&&(M.addOrUpdateProperties=((m=M.addOrUpdateProperties)!==null&&m!==void 0?m:[]).concat(C.addOrUpdateProperties)),C.removeProperties&&(M.removeProperties=((y=M.removeProperties)!==null&&y!==void 0?y:[]).concat(C.removeProperties)),C.removeAllProperties&&(M.removeAllProperties=!0),w.set(C.id,M)}v.update=Array.from(w.values())}return v.remove&&v.add&&(v.remove=v.remove.filter((w=>v.add.findIndex((C=>C.id===w))===-1))),v},A.a1=Wr,A.a2=$s,A.a3=25,A.a4=Mh,A.a5=i=>{const t=window.document.createElement("video");return t.muted=!0,new Promise((r=>{t.onloadstart=()=>{r(t)};for(const s of i){const h=window.document.createElement("source");Be(s)||(t.crossOrigin="Anonymous"),h.src=s,t.appendChild(h)}}))},A.a6=lt,A.a7=function(){return En++},A.a8=W,A.a9=Ol,A.aA=function(i){let t=1/0,r=1/0,s=-1/0,h=-1/0;for(const m of i)t=Math.min(t,m.x),r=Math.min(r,m.y),s=Math.max(s,m.x),h=Math.max(h,m.y);return[t,r,s,h]},A.aB=qr,A.aC=ve,A.aD=function(i,t,r,s,h=!1){if(!r[0]&&!r[1])return[0,0];const m=h?s==="map"?-i.bearingInRadians:0:s==="viewport"?i.bearingInRadians:0;if(m){const y=Math.sin(m),v=Math.cos(m);r=[r[0]*v-r[1]*y,r[0]*y+r[1]*v]}return[h?r[0]:ve(t,r[0],i.zoom),h?r[1]:ve(t,r[1],i.zoom)]},A.aF=dd,A.aG=jf,A.aH=Pf,A.aI=Sd,A.aJ=pr,A.aK=Pa,A.aL=Ue,A.aM=vn,A.aN=Nn,A.aO=Zt,A.aP=Aa,A.aQ=_d,A.aR=cn,A.aS=Bt,A.aT=function(i){var t=new He(3);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t},A.aU=function(i,t,r){return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],i},A.aV=function(i,t){var r=t[0],s=t[1],h=t[2],m=r*r+s*s+h*h;return m>0&&(m=1/Math.sqrt(m)),i[0]=t[0]*m,i[1]=t[1]*m,i[2]=t[2]*m,i},A.aW=nn,A.aX=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]},A.aY=function(i,t,r){return i[0]=t[0]*r[0],i[1]=t[1]*r[1],i[2]=t[2]*r[2],i[3]=t[3]*r[3],i},A.aZ=ft,A.a_=function(i,t,r){const s=t[0]*r[0]+t[1]*r[1]+t[2]*r[2];return s===0?null:(-(i[0]*r[0]+i[1]*r[1]+i[2]*r[2])-r[3])/s},A.aa=wo,A.ab=Bs,A.ac=Up,A.ad=function(i){const t={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((r,s,h,m)=>{const y=h||m;return t[s]=!y||y.toLowerCase(),""})),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},A.ae=qa,A.af=function(i){return Math.pow(2,i)},A.ag=at,A.ah=It,A.ai=85.051129,A.aj=Eh,A.ak=function(i){return Math.log(i)/Math.LN2},A.al=function(i){var t=i[0],r=i[1];return t*t+r*r},A.am=function(i,t){const r=[];for(const s in i)s in t||r.push(s);return r},A.an=function(i,t){let r=0,s=0;if(i.kind==="constant")s=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=i,v=h?It(di.interpolationFactor(h,t,m,y),0,1):0;i.kind==="camera"?s=to.number(i.minSize,i.maxSize,v):r=v}return{uSizeT:r,uSize:s}},A.ap=function(i,{uSize:t,uSizeT:r},{lowerSize:s,upperSize:h}){return i.kind==="source"?s/Zs:i.kind==="composite"?to.number(s/Zs,h/Zs,r):t},A.aq=function(i,t){var r=t[0],s=t[1],h=t[2],m=t[3],y=t[4],v=t[5],w=t[6],C=t[7],M=t[8],z=t[9],B=t[10],U=t[11],V=t[12],$=t[13],Q=t[14],re=t[15],Te=r*v-s*y,ce=r*w-h*y,pe=r*C-m*y,Fe=s*w-h*v,Ge=s*C-m*v,Je=h*C-m*w,gt=M*$-z*V,ct=M*Q-B*V,yt=M*re-U*V,Dt=z*Q-B*$,ut=z*re-U*$,dt=B*re-U*Q,$e=Te*dt-ce*ut+pe*Dt+Fe*yt-Ge*ct+Je*gt;return $e?(i[0]=(v*dt-w*ut+C*Dt)*($e=1/$e),i[1]=(h*ut-s*dt-m*Dt)*$e,i[2]=($*Je-Q*Ge+re*Fe)*$e,i[3]=(B*Ge-z*Je-U*Fe)*$e,i[4]=(w*yt-y*dt-C*ct)*$e,i[5]=(r*dt-h*yt+m*ct)*$e,i[6]=(Q*pe-V*Je-re*ce)*$e,i[7]=(M*Je-B*pe+U*ce)*$e,i[8]=(y*ut-v*yt+C*gt)*$e,i[9]=(s*yt-r*ut-m*gt)*$e,i[10]=(V*Ge-$*pe+re*Te)*$e,i[11]=(z*pe-M*Ge-U*Te)*$e,i[12]=(v*ct-y*Dt-w*gt)*$e,i[13]=(r*Dt-s*ct+h*gt)*$e,i[14]=($*ce-V*Fe-Q*Te)*$e,i[15]=(M*Fe-z*ce+B*Te)*$e,i):null},A.ar=mt,A.as=function(i){var t=i[0],r=i[1];return Math.sqrt(t*t+r*r)},A.at=function(i){return i[0]=0,i[1]=0,i},A.au=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i},A.av=Ch,A.aw=er,A.ax=function(i,t,r,s){const h=t.y-i.y,m=t.x-i.x,y=s.y-r.y,v=s.x-r.x,w=y*m-v*h;if(w===0)return null;const C=(v*(i.y-r.y)-y*(i.x-r.x))/w;return new H(i.x+C*m,i.y+C*h)},A.ay=Hp,A.az=nh,A.b=Kr,A.b$=class extends a{},A.b0=function(i,t,r){return i[0]=t[0]*r,i[1]=t[1]*r,i[2]=t[2]*r,i[3]=t[3]*r,i},A.b1=function(i,t){return i[0]*t[0]+i[1]*t[1]+i[2]*t[2]+i[3]},A.b2=vd,A.b3=kc,A.b4=function(i,t,r,s,h){var m=1/Math.tan(t/2);if(i[0]=m/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=m,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,h!=null&&h!==1/0){var y=1/(s-h);i[10]=(h+s)*y,i[14]=2*h*s*y}else i[10]=-1,i[14]=-2*s;return i},A.b5=function(i){var t=new He(16);return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},A.b6=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[0],y=t[1],v=t[2],w=t[3],C=t[4],M=t[5],z=t[6],B=t[7];return t!==i&&(i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h+C*s,i[1]=y*h+M*s,i[2]=v*h+z*s,i[3]=w*h+B*s,i[4]=C*h-m*s,i[5]=M*h-y*s,i[6]=z*h-v*s,i[7]=B*h-w*s,i},A.b7=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[4],y=t[5],v=t[6],w=t[7],C=t[8],M=t[9],z=t[10],B=t[11];return t!==i&&(i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[4]=m*h+C*s,i[5]=y*h+M*s,i[6]=v*h+z*s,i[7]=w*h+B*s,i[8]=C*h-m*s,i[9]=M*h-y*s,i[10]=z*h-v*s,i[11]=B*h-w*s,i},A.b8=function(){const i=new Float32Array(16);return at(i),i},A.b9=function(){const i=new Float64Array(16);return at(i),i},A.bA=function(i,t){const r=Xe(i,360),s=Xe(t,360),h=s-r,m=s>r?h-360:h+360;return Math.abs(h)<Math.abs(m)?h:m},A.bB=function(i){return i[0]=0,i[1]=0,i[2]=0,i},A.bC=function(i,t,r,s){const h=Math.sqrt(i*i+t*t),m=Math.sqrt(r*r+s*s);i/=h,t/=h,r/=m,s/=m;const y=Math.acos(i*r+t*s);return-t*r+i*s>0?y:-y},A.bD=function(i,t){const r=Xe(i,2*Math.PI),s=Xe(t,2*Math.PI);return Math.min(Math.abs(r-s),Math.abs(r-s+2*Math.PI),Math.abs(r-s-2*Math.PI))},A.bE=function(){const i={},t=Ce.$version;for(const r in Ce.$root){const s=Ce.$root[r];if(s.required){let h=null;h=r==="version"?t:s.type==="array"?[]:{},h!=null&&(i[r]=h)}}return i},A.bF=ru,A.bG=de,A.bH=function i(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(!i(t[s],r[s]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(!i(t[s],r[s]))return!1;return!0}return t===r},A.bI=function(i){i=i.slice();const t=Object.create(null);for(let r=0;r<i.length;r++)t[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=dn(i[r],t[i[r].ref]));return i},A.bJ=function(i,t){if(i.type==="custom")return new zf(i,t);switch(i.type){case"background":return new Df(i,t);case"circle":return new Wd(i,t);case"color-relief":return new Mm(i,t);case"fill":return new mh(i,t);case"fill-extrusion":return new Vs(i,t);case"heatmap":return new Xd(i,t);case"hillshade":return new Ns(i,t);case"line":return new kl(i,t);case"raster":return new Op(i,t);case"symbol":return new gd(i,t)}},A.bK=St,A.bL=function(i,t){if(!i)return[{command:"setStyle",args:[t]}];let r=[];try{if(!Rt(i.version,t.version))return[{command:"setStyle",args:[t]}];Rt(i.center,t.center)||r.push({command:"setCenter",args:[t.center]}),Rt(i.state,t.state)||r.push({command:"setGlobalState",args:[t.state]}),Rt(i.centerAltitude,t.centerAltitude)||r.push({command:"setCenterAltitude",args:[t.centerAltitude]}),Rt(i.zoom,t.zoom)||r.push({command:"setZoom",args:[t.zoom]}),Rt(i.bearing,t.bearing)||r.push({command:"setBearing",args:[t.bearing]}),Rt(i.pitch,t.pitch)||r.push({command:"setPitch",args:[t.pitch]}),Rt(i.roll,t.roll)||r.push({command:"setRoll",args:[t.roll]}),Rt(i.sprite,t.sprite)||r.push({command:"setSprite",args:[t.sprite]}),Rt(i.glyphs,t.glyphs)||r.push({command:"setGlyphs",args:[t.glyphs]}),Rt(i.transition,t.transition)||r.push({command:"setTransition",args:[t.transition]}),Rt(i.light,t.light)||r.push({command:"setLight",args:[t.light]}),Rt(i.terrain,t.terrain)||r.push({command:"setTerrain",args:[t.terrain]}),Rt(i.sky,t.sky)||r.push({command:"setSky",args:[t.sky]}),Rt(i.projection,t.projection)||r.push({command:"setProjection",args:[t.projection]});const s={},h=[];(function(y,v,w,C){let M;for(M in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,M)&&(Object.prototype.hasOwnProperty.call(v,M)||Fr(M,w,C));for(M in v)Object.prototype.hasOwnProperty.call(v,M)&&(Object.prototype.hasOwnProperty.call(y,M)?Rt(y[M],v[M])||(y[M].type==="geojson"&&v[M].type==="geojson"&&Vn(y,v,M)?Wt(w,{command:"setGeoJSONSourceData",args:[M,v[M].data]}):Vr(M,v,w,C)):In(M,v,w))})(i.sources,t.sources,h,s);const m=[];i.layers&&i.layers.forEach((y=>{"source"in y&&s[y.source]?r.push({command:"removeLayer",args:[y.id]}):m.push(y)})),r=r.concat(h),(function(y,v,w){v=v||[];const C=(y=y||[]).map($t),M=v.map($t),z=y.reduce(lr,{}),B=v.reduce(lr,{}),U=C.slice(),V=Object.create(null);let $,Q,re,Te,ce;for(let pe=0,Fe=0;pe<C.length;pe++)$=C[pe],Object.prototype.hasOwnProperty.call(B,$)?Fe++:(Wt(w,{command:"removeLayer",args:[$]}),U.splice(U.indexOf($,Fe),1));for(let pe=0,Fe=0;pe<M.length;pe++)$=M[M.length-1-pe],U[U.length-1-pe]!==$&&(Object.prototype.hasOwnProperty.call(z,$)?(Wt(w,{command:"removeLayer",args:[$]}),U.splice(U.lastIndexOf($,U.length-Fe),1)):Fe++,Te=U[U.length-pe],Wt(w,{command:"addLayer",args:[B[$],Te]}),U.splice(U.length-pe,0,$),V[$]=!0);for(let pe=0;pe<M.length;pe++)if($=M[pe],Q=z[$],re=B[$],!V[$]&&!Rt(Q,re))if(Rt(Q.source,re.source)&&Rt(Q["source-layer"],re["source-layer"])&&Rt(Q.type,re.type)){for(ce in Ut(Q.layout,re.layout,w,$,null,"setLayoutProperty"),Ut(Q.paint,re.paint,w,$,null,"setPaintProperty"),Rt(Q.filter,re.filter)||Wt(w,{command:"setFilter",args:[$,re.filter]}),Rt(Q.minzoom,re.minzoom)&&Rt(Q.maxzoom,re.maxzoom)||Wt(w,{command:"setLayerZoomRange",args:[$,re.minzoom,re.maxzoom]}),Q)Object.prototype.hasOwnProperty.call(Q,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?Ut(Q[ce],re[ce],w,$,ce.slice(6),"setPaintProperty"):Rt(Q[ce],re[ce])||Wt(w,{command:"setLayerProperty",args:[$,ce,re[ce]]}));for(ce in re)Object.prototype.hasOwnProperty.call(re,ce)&&!Object.prototype.hasOwnProperty.call(Q,ce)&&ce!=="layout"&&ce!=="paint"&&ce!=="filter"&&ce!=="metadata"&&ce!=="minzoom"&&ce!=="maxzoom"&&(ce.indexOf("paint.")===0?Ut(Q[ce],re[ce],w,$,ce.slice(6),"setPaintProperty"):Rt(Q[ce],re[ce])||Wt(w,{command:"setLayerProperty",args:[$,ce,re[ce]]}))}else Wt(w,{command:"removeLayer",args:[$]}),Te=U[U.lastIndexOf($)+1],Wt(w,{command:"addLayer",args:[re,Te]})})(m,t.layers,r)}catch(s){console.warn("Unable to compute style diff:",s),r=[{command:"setStyle",args:[t]}]}return r},A.bM=function(i){const t=[],r=i.id;return r===void 0&&t.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&t.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},A.bN=tr,A.bO=xn,A.bP=class extends Dn{constructor(i,t){super(i,t),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},A.bQ=xr,A.bR=class extends Dn{constructor(i,t){super(i,t),this.current=cu}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let t=1;t<16;t++)if(i[t]!==this.current[t]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},A.bS=Si,A.bT=class extends Dn{constructor(i,t){super(i,t),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},A.bU=class extends Dn{constructor(i,t){super(i,t),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},A.bV=it,A.bW=function(i,t){var r=Math.sin(t),s=Math.cos(t);return i[0]=s,i[1]=r,i[2]=0,i[3]=-r,i[4]=s,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},A.bX=function(i,t,r){var s=t[0],h=t[1],m=t[2];return i[0]=s*r[0]+h*r[3]+m*r[6],i[1]=s*r[1]+h*r[4]+m*r[7],i[2]=s*r[2]+h*r[5]+m*r[8],i},A.bY=function(i,t,r,s,h,m,y){var v=1/(t-r),w=1/(s-h),C=1/(m-y);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*C,i[11]=0,i[12]=(t+r)*v,i[13]=(h+s)*w,i[14]=(y+m)*C,i[15]=1,i},A.bZ=class extends Dn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(4*i.length);for(let r=0;r<i.length;r++)t[4*r]=i[r].r,t[4*r+1]=i[r].g,t[4*r+2]=i[r].b,t[4*r+3]=i[r].a;this.gl.uniform4fv(this.location,t)}}},A.b_=class extends Dn{constructor(i,t){super(i,t),this.current=new Array}set(i){if(i!=this.current){this.current=i;const t=new Float32Array(i);this.gl.uniform1fv(this.location,t)}}},A.ba=function(){return new Float64Array(16)},A.bb=function(i,t,r){const s=new Float64Array(4);return We(s,i,t-90,r),s},A.bc=function(i,t,r,s){var h,m,y,v,w,C=t[0],M=t[1],z=t[2],B=t[3],U=r[0],V=r[1],$=r[2],Q=r[3];return(m=C*U+M*V+z*$+B*Q)<0&&(m=-m,U=-U,V=-V,$=-$,Q=-Q),1-m>ke?(h=Math.acos(m),y=Math.sin(h),v=Math.sin((1-s)*h)/y,w=Math.sin(s*h)/y):(v=1-s,w=s),i[0]=v*C+w*U,i[1]=v*M+w*V,i[2]=v*z+w*$,i[3]=v*B+w*Q,i},A.bd=function(i){const t=new Float64Array(9);var r,s,h,m,y,v,w,C,M,z,B,U,V,$,Q,re,Te,ce;z=(h=(s=i)[0])*(w=h+h),B=(m=s[1])*w,V=(y=s[2])*w,$=y*(C=m+m),re=(v=s[3])*w,Te=v*C,ce=v*(M=y+y),(r=t)[0]=1-(U=m*C)-(Q=y*M),r[3]=B-ce,r[6]=V+Te,r[1]=B+ce,r[4]=1-z-Q,r[7]=$-re,r[2]=V-Te,r[5]=$+re,r[8]=1-z-U;const pe=Aa(-Math.asin(It(t[2],-1,1)));let Fe,Ge;return Math.hypot(t[5],t[8])<.001?(Fe=0,Ge=-Aa(Math.atan2(t[3],t[4]))):(Fe=Aa(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Ge=Aa(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:Fe,pitch:pe+90,bearing:Ge}},A.be=function(i,t){return i.roll==t.roll&&i.pitch==t.pitch&&i.bearing==t.bearing},A.bf=hn,A.bg=hr,A.bh=Tc,A.bi=Gi,A.bj=Ci,A.bk=vt,A.bl=st,A.bm=vr,A.bn=function(i,t,r,s,h){return vt(s,h,It((i-t)/(r-t),0,1))},A.bo=Xe,A.bp=function(){return new Float64Array(3)},A.bq=function(i,t,r,s){return i[0]=t[0]+r[0]*s,i[1]=t[1]+r[1]*s,i[2]=t[2]+r[2]*s,i},A.br=We,A.bs=function(i,t,r){var s=r[0],h=r[1],m=r[2],y=r[3],v=t[0],w=t[1],C=t[2],M=h*C-m*w,z=m*v-s*C,B=s*w-h*v;return i[0]=v+y*(M+=M)+h*(B+=B)-m*(z+=z),i[1]=w+y*z+m*M-s*B,i[2]=C+y*B+s*z-h*M,i},A.bt=function(i,t,r){const s=(h=[i[0],i[1],i[2],t[0],t[1],t[2],r[0],r[1],r[2]])[0]*((M=h[8])*(y=h[4])-(v=h[5])*(C=h[7]))+h[1]*(-M*(m=h[3])+v*(w=h[6]))+h[2]*(C*m-y*w);var h,m,y,v,w,C,M;if(s===0)return null;const z=nn([],[t[0],t[1],t[2]],[r[0],r[1],r[2]]),B=nn([],[r[0],r[1],r[2]],[i[0],i[1],i[2]]),U=nn([],[i[0],i[1],i[2]],[t[0],t[1],t[2]]),V=cn([],z,-i[3]);return Bt(V,V,cn([],B,-t[3])),Bt(V,V,cn([],U,-r[3])),cn(V,V,1/s),V},A.bu=Bl,A.bv=function(){return new Float64Array(4)},A.bw=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[0]*Math.cos(s)-h[1]*Math.sin(s),m[1]=h[0]*Math.sin(s)+h[1]*Math.cos(s),m[2]=h[2],i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},A.bx=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[0],m[1]=h[1]*Math.cos(s)-h[2]*Math.sin(s),m[2]=h[1]*Math.sin(s)+h[2]*Math.cos(s),i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},A.by=function(i,t,r,s){var h=[],m=[];return h[0]=t[0]-r[0],h[1]=t[1]-r[1],h[2]=t[2]-r[2],m[0]=h[2]*Math.sin(s)+h[0]*Math.cos(s),m[1]=h[1],m[2]=h[2]*Math.cos(s)-h[0]*Math.sin(s),i[0]=m[0]+r[0],i[1]=m[1]+r[1],i[2]=m[2]+r[2],i},A.bz=function(i,t,r){var s=Math.sin(r),h=Math.cos(r),m=t[0],y=t[1],v=t[2],w=t[3],C=t[8],M=t[9],z=t[10],B=t[11];return t!==i&&(i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15]),i[0]=m*h-C*s,i[1]=y*h-M*s,i[2]=v*h-z*s,i[3]=w*h-B*s,i[8]=m*s+C*h,i[9]=y*s+M*h,i[10]=v*s+z*h,i[11]=w*s+B*h,i},A.c=xe,A.c0=xh,A.c1=class extends d{},A.c2=ko,A.c3=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},A.c4=$d,A.c5=function(i,t,r){var s=t[0],h=t[1],m=t[2],y=r[3]*s+r[7]*h+r[11]*m+r[15];return i[0]=(r[0]*s+r[4]*h+r[8]*m+r[12])/(y=y||1),i[1]=(r[1]*s+r[5]*h+r[9]*m+r[13])/y,i[2]=(r[2]*s+r[6]*h+r[10]*m+r[14])/y,i},A.c6=class extends Mo{},A.c7=class extends O{},A.c8=function(i,t){return i[0]===t[0]&&i[1]===t[1]&&i[2]===t[2]&&i[3]===t[3]&&i[4]===t[4]&&i[5]===t[5]&&i[6]===t[6]&&i[7]===t[7]&&i[8]===t[8]&&i[9]===t[9]&&i[10]===t[10]&&i[11]===t[11]&&i[12]===t[12]&&i[13]===t[13]&&i[14]===t[14]&&i[15]===t[15]},A.c9=function(i,t){var r=i[0],s=i[1],h=i[2],m=i[3],y=i[4],v=i[5],w=i[6],C=i[7],M=i[8],z=i[9],B=i[10],U=i[11],V=i[12],$=i[13],Q=i[14],re=i[15],Te=t[0],ce=t[1],pe=t[2],Fe=t[3],Ge=t[4],Je=t[5],gt=t[6],ct=t[7],yt=t[8],Dt=t[9],ut=t[10],dt=t[11],$e=t[12],Ft=t[13],jt=t[14],Mt=t[15];return Math.abs(r-Te)<=ke*Math.max(1,Math.abs(r),Math.abs(Te))&&Math.abs(s-ce)<=ke*Math.max(1,Math.abs(s),Math.abs(ce))&&Math.abs(h-pe)<=ke*Math.max(1,Math.abs(h),Math.abs(pe))&&Math.abs(m-Fe)<=ke*Math.max(1,Math.abs(m),Math.abs(Fe))&&Math.abs(y-Ge)<=ke*Math.max(1,Math.abs(y),Math.abs(Ge))&&Math.abs(v-Je)<=ke*Math.max(1,Math.abs(v),Math.abs(Je))&&Math.abs(w-gt)<=ke*Math.max(1,Math.abs(w),Math.abs(gt))&&Math.abs(C-ct)<=ke*Math.max(1,Math.abs(C),Math.abs(ct))&&Math.abs(M-yt)<=ke*Math.max(1,Math.abs(M),Math.abs(yt))&&Math.abs(z-Dt)<=ke*Math.max(1,Math.abs(z),Math.abs(Dt))&&Math.abs(B-ut)<=ke*Math.max(1,Math.abs(B),Math.abs(ut))&&Math.abs(U-dt)<=ke*Math.max(1,Math.abs(U),Math.abs(dt))&&Math.abs(V-$e)<=ke*Math.max(1,Math.abs(V),Math.abs($e))&&Math.abs($-Ft)<=ke*Math.max(1,Math.abs($),Math.abs(Ft))&&Math.abs(Q-jt)<=ke*Math.max(1,Math.abs(Q),Math.abs(jt))&&Math.abs(re-Mt)<=ke*Math.max(1,Math.abs(re),Math.abs(Mt))},A.cA=function(i,t){Z.REGISTERED_PROTOCOLS[i]=t},A.cB=function(i){delete Z.REGISTERED_PROTOCOLS[i]},A.cC=function(i,t){const r={};for(let h=0;h<i.length;h++){const m=t&&t[i[h].id]||Xu(i[h]);t&&(t[i[h].id]=m);let y=r[m];y||(y=r[m]=[]),y.push(i[h])}const s=[];for(const h in r)s.push(r[h]);return s},A.cD=bt,A.cE=xd,A.cF=Of,A.cG=vf,A.cH=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=Et/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const t=i.bucket.layers[0],r=t.layout,s=t._unevaluatedLayout._values,h={layoutIconSize:s["icon-size"].possiblyEvaluate(new Ln(i.bucket.zoom+1),i.canonical),layoutTextSize:s["text-size"].possiblyEvaluate(new Ln(i.bucket.zoom+1),i.canonical),textMaxSize:s["text-size"].possiblyEvaluate(new Ln(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:C,maxZoom:M}=i.bucket.textSizeData;h.compositeTextSizes=[s["text-size"].possiblyEvaluate(new Ln(C),i.canonical),s["text-size"].possiblyEvaluate(new Ln(M),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:C,maxZoom:M}=i.bucket.iconSizeData;h.compositeIconSizes=[s["icon-size"].possiblyEvaluate(new Ln(C),i.canonical),s["icon-size"].possiblyEvaluate(new Ln(M),i.canonical)]}const m=r.get("text-line-height")*qr,y=r.get("text-rotation-alignment")!=="viewport"&&r.get("symbol-placement")!=="point",v=r.get("text-keep-upright"),w=r.get("text-size");for(const C of i.bucket.features){const M=r.get("text-font").evaluate(C,{},i.canonical).join(","),z=w.evaluate(C,{},i.canonical),B=h.layoutTextSize.evaluate(C,{},i.canonical),U=h.layoutIconSize.evaluate(C,{},i.canonical),V={horizontal:{},vertical:void 0},$=C.text;let Q,re=[0,0];if($){const pe=$.toString(),Fe=r.get("text-letter-spacing").evaluate(C,{},i.canonical)*qr,Ge=iu(pe)?Fe:0,Je=r.get("text-anchor").evaluate(C,{},i.canonical),gt=Wp(t,C,i.canonical);if(!gt){const ut=r.get("text-radial-offset").evaluate(C,{},i.canonical);re=ut?Uf(Je,[ut*qr,Ul]):r.get("text-offset").evaluate(C,{},i.canonical).map((dt=>dt*qr))}let ct=y?"center":r.get("text-justify").evaluate(C,{},i.canonical);const yt=r.get("symbol-placement")==="point"?r.get("text-max-width").evaluate(C,{},i.canonical)*qr:1/0,Dt=()=>{i.bucket.allowVerticalPlacement&&xc(pe)&&(V.vertical=wh($,i.glyphMap,i.glyphPositions,i.imagePositions,M,yt,m,Je,"left",Ge,re,A.ao.vertical,!0,B,z))};if(!y&&gt){const ut=new Set;if(ct==="auto")for(let $e=0;$e<gt.values.length;$e+=2)ut.add(jf(gt.values[$e]));else ut.add(ct);let dt=!1;for(const $e of ut)if(!V.horizontal[$e])if(dt)V.horizontal[$e]=V.horizontal[0];else{const Ft=wh($,i.glyphMap,i.glyphPositions,i.imagePositions,M,yt,m,"center",$e,Ge,re,A.ao.horizontal,!1,B,z);Ft&&(V.horizontal[$e]=Ft,dt=Ft.positionedLines.length===1)}Dt()}else{ct==="auto"&&(ct=jf(Je));const ut=wh($,i.glyphMap,i.glyphPositions,i.imagePositions,M,yt,m,Je,ct,Ge,re,A.ao.horizontal,!1,B,z);ut&&(V.horizontal[ct]=ut),Dt(),xc(pe)&&y&&v&&(V.vertical=wh($,i.glyphMap,i.glyphPositions,i.imagePositions,M,yt,m,Je,ct,Ge,re,A.ao.vertical,!1,B,z))}}let Te=!1;if(C.icon&&C.icon.name){const pe=i.imageMap[C.icon.name];pe&&(Q=Lc(i.imagePositions[C.icon.name],r.get("icon-offset").evaluate(C,{},i.canonical),r.get("icon-anchor").evaluate(C,{},i.canonical)),Te=!!pe.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=Te:i.bucket.sdfIcons!==Te&&un("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pe.pixelRatio!==i.bucket.pixelRatio||r.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ce=Xp(V.horizontal)||V.vertical;i.bucket.iconsInText=!!ce&&ce.iconsInText,(ce||Q)&&Om(i.bucket,C,V,Q,i.imageMap,h,B,U,re,Te,i.canonical,i.subdivisionGranularity)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},A.cI=yh,A.cJ=uo,A.cK=An,A.cL=Cp,A.cM=mf,A.cN=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},A.cO=function(i,t,r,s,h){return c(this,void 0,void 0,(function*(){if(De())try{return yield Mi(i,t,r,s,h)}catch{}return(function(m,y,v,w,C){const M=m.width,z=m.height;oi&&ya||(oi=new OffscreenCanvas(M,z),ya=oi.getContext("2d",{willReadFrequently:!0})),oi.width=M,oi.height=z,ya.drawImage(m,0,0,M,z);const B=ya.getImageData(y,v,w,C);return ya.clearRect(0,0,M,z),B.data})(i,t,r,s,h)}))},A.cP=Cr,A.cQ=Y,A.cR=of,A.cS=ls,A.cT=ro,A.cU=function(i,t){const r=new Map;if(i!=null)if(i.type==="Feature")r.set(Pu(i,t),i);else for(const s of i.features)r.set(Pu(s,t),s);return r},A.cV=function(i,t){if(i==null)return!0;if(i.type==="Feature")return Pu(i,t)!=null;if(i.type==="FeatureCollection"){const r=new Set;for(const s of i.features){const h=Pu(s,t);if(h==null||r.has(h))return!1;r.add(h)}return!0}return!1},A.cW=function(i,t,r){var s,h,m,y;if(t.removeAll&&i.clear(),t.remove)for(const v of t.remove)i.delete(v);if(t.add)for(const v of t.add){const w=Pu(v,r);w!=null&&i.set(w,v)}if(t.update)for(const v of t.update){let w=i.get(v.id);if(w==null)continue;const C=!v.removeAllProperties&&(((s=v.removeProperties)===null||s===void 0?void 0:s.length)>0||((h=v.addOrUpdateProperties)===null||h===void 0?void 0:h.length)>0);if((v.newGeometry||v.removeAllProperties||C)&&(w=Object.assign({},w),i.set(v.id,w),C&&(w.properties=Object.assign({},w.properties))),v.newGeometry&&(w.geometry=v.newGeometry),v.removeAllProperties)w.properties={};else if(((m=v.removeProperties)===null||m===void 0?void 0:m.length)>0)for(const M of v.removeProperties)Object.prototype.hasOwnProperty.call(w.properties,M)&&delete w.properties[M];if(((y=v.addOrUpdateProperties)===null||y===void 0?void 0:y.length)>0)for(const{key:M,value:z}of v.addOrUpdateProperties)w.properties[M]=z}},A.cX=Ba,A.ca=function(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i},A.cb=i=>i.type==="symbol",A.cc=i=>i.type==="circle",A.cd=i=>i.type==="heatmap",A.ce=i=>i.type==="line",A.cf=i=>i.type==="fill",A.cg=i=>i.type==="fill-extrusion",A.ch=i=>i.type==="hillshade",A.ci=i=>i.type==="color-relief",A.cj=i=>i.type==="raster",A.ck=i=>i.type==="background",A.cl=i=>i.type==="custom",A.cm=xt,A.cn=function(i,t,r){const s=rt(t.x-r.x,t.y-r.y),h=rt(i.x-r.x,i.y-r.y);var m,y;return Aa(Math.atan2(s[0]*h[1]-s[1]*h[0],(m=s)[0]*(y=h)[0]+m[1]*y[1]))},A.co=Kt,A.cp=function(i,t){return gr[t]&&(i instanceof MouseEvent||i instanceof WheelEvent)},A.cq=function(i,t){return Wi[t]&&"touches"in i},A.cr=function(i){return Wi[i]||gr[i]},A.cs=function(i,t,r){var s=t[0],h=t[1];return i[0]=r[0]*s+r[4]*h+r[12],i[1]=r[1]*s+r[5]*h+r[13],i},A.ct=function(i,t){const{x:r,y:s}=Wr.fromLngLat(t);return!(i<0||i>25||s<0||s>=1||r<0||r>=1)},A.cu=function(i,t){return i[0]=t[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=t[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},A.cv=class extends ir{},A.cw=Kp,A.cy=function(i){return i.message===Ri},A.cz=se,A.d=Be,A.e=Ht,A.f=i=>c(void 0,void 0,void 0,(function*(){if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(t)}catch(r){throw new Error(`Could not load image because of ${r.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}})),A.g=q,A.h=i=>new Promise(((t,r)=>{const s=new Image;s.onload=()=>{t(s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame((()=>{s.src=Br}))},s.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const h=new Blob([new Uint8Array(i)],{type:"image/png"});s.src=i.byteLength?URL.createObjectURL(h):Br})),A.i=Ar,A.j=(i,t)=>be(Ht(i,{type:"json"}),t),A.k=Ye,A.l=nt,A.m=be,A.n=(i,t)=>be(Ht(i,{type:"arrayBuffer"}),t),A.o=function(i){return new mf(i).readFields(zm,[])},A.p=Ic,A.q=fu,A.r=ei,A.s=ra,A.t=pn,A.u=en,A.v=Ce,A.w=un,A.x=ka,A.y=Pl,A.z=Ms})),j("worker",["./shared"],(function(A){class c{constructor(Z,q){this.keyCache={},Z&&this.replace(Z,q)}replace(Z,q){this._layerConfigs={},this._layers={},this.update(Z,[],q)}update(Z,q,K){for(const de of Z){this._layerConfigs[de.id]=de;const be=this._layers[de.id]=A.bJ(de,K);be._featureFilter=A.aa(be.filter,K),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of q)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const se=A.cC(Object.values(this._layerConfigs),this.keyCache);for(const de of se){const be=de.map((Pt=>this._layers[Pt.id])),Be=be[0];if(Be.visibility==="none")continue;const Pe=Be.source||"";let qe=this.familiesBySource[Pe];qe||(qe=this.familiesBySource[Pe]={});const nt=Be.sourceLayer||"_geojsonTileLayer";let Ye=qe[nt];Ye||(Ye=qe[nt]=[]),Ye.push(be)}}}class H{constructor(Z){const q={},K=[];for(const Be in Z){const Pe=Z[Be],qe=q[Be]={};for(const nt in Pe){const Ye=Pe[+nt];if(!Ye||Ye.bitmap.width===0||Ye.bitmap.height===0)continue;const Pt={x:0,y:0,w:Ye.bitmap.width+2,h:Ye.bitmap.height+2};K.push(Pt),qe[nt]={rect:Pt,metrics:Ye.metrics}}}const{w:se,h:de}=A.p(K),be=new A.q({width:se||1,height:de||1});for(const Be in Z){const Pe=Z[Be];for(const qe in Pe){const nt=Pe[+qe];if(!nt||nt.bitmap.width===0||nt.bitmap.height===0)continue;const Ye=q[Be][qe].rect;A.q.copy(nt.bitmap,be,{x:0,y:0},{x:Ye.x+1,y:Ye.y+1},nt.bitmap)}}this.image=be,this.positions=q}}A.cD("GlyphAtlas",H);class Y{constructor(Z){this.tileID=new A.Z(Z.tileID.overscaledZ,Z.tileID.wrap,Z.tileID.canonical.z,Z.tileID.canonical.x,Z.tileID.canonical.y),this.uid=Z.uid,this.zoom=Z.zoom,this.pixelRatio=Z.pixelRatio,this.tileSize=Z.tileSize,this.source=Z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Z.showCollisionBoxes,this.collectResourceTiming=!!Z.collectResourceTiming,this.returnDependencies=!!Z.returnDependencies,this.promoteId=Z.promoteId,this.inFlightDependencies=[]}parse(Z,q,K,se,de){return A._(this,void 0,void 0,(function*(){this.status="parsing",this.data=Z,this.collisionBoxArray=new A.a8;const be=new A.cE(Object.keys(Z.layers).sort()),Be=new A.cF(this.tileID,this.promoteId);Be.bucketLayerIDs=[];const Pe={},qe={featureIndex:Be,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:K,subdivisionGranularity:de},nt=q.familiesBySource[this.source];for(const Ut in nt){const $t=Z.layers[Ut];if(!$t)continue;$t.version===1&&A.w(`Vector tile source "${this.source}" layer "${Ut}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const lr=be.encode(Ut),lt=[];for(let _i=0;_i<$t.length;_i++){const yr=$t.feature(_i),po=Be.getId(yr,Ut);lt.push({feature:yr,id:po,index:_i,sourceLayerIndex:lr})}for(const _i of nt[Ut]){const yr=_i[0];yr.source!==this.source&&A.w(`layer.source = ${yr.source} does not equal this.source = ${this.source}`),yr.minzoom&&this.zoom<Math.floor(yr.minzoom)||yr.maxzoom&&this.zoom>=yr.maxzoom||yr.visibility!=="none"&&(he(_i,this.zoom,K),(Pe[yr.id]=yr.createBucket({index:Be.bucketLayerIDs.length,layers:_i,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:lr,sourceID:this.source})).populate(lt,qe,this.tileID.canonical),Be.bucketLayerIDs.push(_i.map((po=>po.id))))}}const Ye=A.bN(qe.glyphDependencies,(Ut=>Object.keys(Ut).map(Number)));this.inFlightDependencies.forEach((Ut=>Ut?.abort())),this.inFlightDependencies=[];let Pt=Promise.resolve({});if(Object.keys(Ye).length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Pt=se.sendAsync({type:"GG",data:{stacks:Ye,source:this.source,tileID:this.tileID,type:"glyphs"}},Ut)}const Ce=Object.keys(qe.iconDependencies);let Gt=Promise.resolve({});if(Ce.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Gt=se.sendAsync({type:"GI",data:{icons:Ce,source:this.source,tileID:this.tileID,type:"icons"}},Ut)}const dn=Object.keys(qe.patternDependencies);let Rt=Promise.resolve({});if(dn.length){const Ut=new AbortController;this.inFlightDependencies.push(Ut),Rt=se.sendAsync({type:"GI",data:{icons:dn,source:this.source,tileID:this.tileID,type:"patterns"}},Ut)}const[Wt,In,Fr]=yield Promise.all([Pt,Gt,Rt]),Vr=new H(Wt),Vn=new A.cG(In,Fr);for(const Ut in Pe){const $t=Pe[Ut];$t instanceof A.a9?(he($t.layers,this.zoom,K),A.cH({bucket:$t,glyphMap:Wt,glyphPositions:Vr.positions,imageMap:In,imagePositions:Vn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:qe.subdivisionGranularity})):$t.hasPattern&&($t instanceof A.cI||$t instanceof A.cJ||$t instanceof A.cK)&&(he($t.layers,this.zoom,K),$t.addFeatures(qe,this.tileID.canonical,Vn.patternPositions))}return this.status="done",{buckets:Object.values(Pe).filter((Ut=>!Ut.isEmpty())),featureIndex:Be,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vr.image,imageAtlas:Vn,glyphMap:this.returnDependencies?Wt:null,iconMap:this.returnDependencies?In:null,glyphPositions:this.returnDependencies?Vr.positions:null}}))}}function he(xe,Z,q){const K=new A.F(Z);for(const se of xe)se.recalculate(K,q)}class we{constructor(Z,q,K){this.actor=Z,this.layerIndex=q,this.availableImages=K,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(Z,q){return A._(this,void 0,void 0,(function*(){const K=yield A.n(Z.request,q);try{return{vectorTile:new A.cL(new A.cM(K.data)),rawData:K.data,cacheControl:K.cacheControl,expires:K.expires}}catch(se){const de=new Uint8Array(K.data);let be=`Unable to parse the tile at ${Z.request.url}, `;throw be+=de[0]===31&&de[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${se.message}`,new Error(be)}}))}loadTile(Z){return A._(this,void 0,void 0,(function*(){const q=Z.uid,K=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new A.cN(Z.request),se=new Y(Z);this.loading[q]=se;const de=new AbortController;se.abort=de;try{const be=yield this.loadVectorTile(Z,de);if(delete this.loading[q],!be)return null;const Be=be.rawData,Pe={};be.expires&&(Pe.expires=be.expires),be.cacheControl&&(Pe.cacheControl=be.cacheControl);const qe={};if(K){const Ye=K.finish();Ye&&(qe.resourceTiming=JSON.parse(JSON.stringify(Ye)))}se.vectorTile=be.vectorTile;const nt=se.parse(be.vectorTile,this.layerIndex,this.availableImages,this.actor,Z.subdivisionGranularity);this.loaded[q]=se,this.fetching[q]={rawTileData:Be,cacheControl:Pe,resourceTiming:qe};try{const Ye=yield nt;return A.e({rawTileData:Be.slice(0)},Ye,Pe,qe)}finally{delete this.fetching[q]}}catch(be){throw delete this.loading[q],se.status="done",this.loaded[q]=se,be}}))}reloadTile(Z){return A._(this,void 0,void 0,(function*(){const q=Z.uid;if(!this.loaded||!this.loaded[q])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const K=this.loaded[q];if(K.showCollisionBoxes=Z.showCollisionBoxes,K.status==="parsing"){const se=yield K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Z.subdivisionGranularity);let de;if(this.fetching[q]){const{rawTileData:be,cacheControl:Be,resourceTiming:Pe}=this.fetching[q];delete this.fetching[q],de=A.e({rawTileData:be.slice(0)},se,Be,Pe)}else de=se;return de}if(K.status==="done"&&K.vectorTile)return K.parse(K.vectorTile,this.layerIndex,this.availableImages,this.actor,Z.subdivisionGranularity)}))}abortTile(Z){return A._(this,void 0,void 0,(function*(){const q=this.loading,K=Z.uid;q&&q[K]&&q[K].abort&&(q[K].abort.abort(),delete q[K])}))}removeTile(Z){return A._(this,void 0,void 0,(function*(){this.loaded&&this.loaded[Z.uid]&&delete this.loaded[Z.uid]}))}}class ge{constructor(){this.loaded={}}loadTile(Z){return A._(this,void 0,void 0,(function*(){const{uid:q,encoding:K,rawImageData:se,redFactor:de,greenFactor:be,blueFactor:Be,baseShift:Pe}=Z,qe=se.width+2,nt=se.height+2,Ye=A.b(se)?new A.R({width:qe,height:nt},yield A.cO(se,-1,-1,qe,nt)):se,Pt=new A.cP(q,Ye,K,de,be,Be,Pe);return this.loaded=this.loaded||{},this.loaded[q]=Pt,Pt}))}removeTile(Z){const q=this.loaded,K=Z.uid;q&&q[K]&&delete q[K]}}var ne,Re,ye=(function(){if(Re)return ne;function xe(q,K){if(q.length!==0){Z(q[0],K);for(var se=1;se<q.length;se++)Z(q[se],!K)}}function Z(q,K){for(var se=0,de=0,be=0,Be=q.length,Pe=Be-1;be<Be;Pe=be++){var qe=(q[be][0]-q[Pe][0])*(q[Pe][1]+q[be][1]),nt=se+qe;de+=Math.abs(se)>=Math.abs(qe)?se-nt+qe:qe-nt+se,se=nt}se+de>=0!=!!K&&q.reverse()}return Re=1,ne=function q(K,se){var de,be=K&&K.type;if(be==="FeatureCollection")for(de=0;de<K.features.length;de++)q(K.features[de],se);else if(be==="GeometryCollection")for(de=0;de<K.geometries.length;de++)q(K.geometries[de],se);else if(be==="Feature")q(K.geometry,se);else if(be==="Polygon")xe(K.coordinates,se);else if(be==="MultiPolygon")for(de=0;de<K.coordinates.length;de++)xe(K.coordinates[de],se);return K}})(),ze=A.cQ(ye);class De extends A.cS{constructor(Z,q){super(new A.cM,0,q,[],[]),this.feature=Z,this.type=Z.type,this.properties=Z.tags?Z.tags:{},"id"in Z&&(typeof Z.id=="string"?this.id=parseInt(Z.id,10):typeof Z.id!="number"||isNaN(Z.id)||(this.id=Z.id))}loadGeometry(){const Z=[],q=this.feature.type===1?[this.feature.geometry]:this.feature.geometry;for(const K of q){const se=[];for(const de of K)se.push(new A.P(de[0],de[1]));Z.push(se)}return Z}}class ke extends A.cR{constructor(Z,q){super(new A.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=q?q.version:1,this.extent=q?q.extent:4096,this.length=Z.length,this.features=Z}feature(Z){return new De(this.features[Z],this.extent)}}function He(xe,Z){Z.writeVarintField(15,xe.version||1),Z.writeStringField(1,xe.name||""),Z.writeVarintField(5,xe.extent||4096);const q={keys:[],values:[],keycache:{},valuecache:{}};for(let de=0;de<xe.length;de++)q.feature=xe.feature(de),Z.writeMessage(2,it,q);const K=q.keys;for(const de of K)Z.writeStringField(3,de);const se=q.values;for(const de of se)Z.writeMessage(4,Bt,de)}function it(xe,Z){if(!xe.feature)return;const q=xe.feature;q.id!==void 0&&Z.writeVarintField(1,q.id),Z.writeMessage(2,at,xe),Z.writeVarintField(3,q.type),Z.writeMessage(4,ot,q)}function at(xe,Z){for(const q in xe.feature?.properties){let K=xe.feature.properties[q],se=xe.keycache[q];if(K===null)continue;se===void 0&&(xe.keys.push(q),se=xe.keys.length-1,xe.keycache[q]=se),Z.writeVarint(se),typeof K!="string"&&typeof K!="boolean"&&typeof K!="number"&&(K=JSON.stringify(K));const de=typeof K+":"+K;let be=xe.valuecache[de];be===void 0&&(xe.values.push(K),be=xe.values.length-1,xe.valuecache[de]=be),Z.writeVarint(be)}}function wt(xe,Z){return(Z<<3)+(7&xe)}function ft(xe){return xe<<1^xe>>31}function ot(xe,Z){const q=xe.loadGeometry(),K=xe.type;let se=0,de=0;for(const be of q){let Be=1;K===1&&(Be=be.length),Z.writeVarint(wt(1,Be));const Pe=K===3?be.length-1:be.length;for(let qe=0;qe<Pe;qe++){qe===1&&K!==1&&Z.writeVarint(wt(2,Pe-1));const nt=be[qe].x-se,Ye=be[qe].y-de;Z.writeVarint(ft(nt)),Z.writeVarint(ft(Ye)),se+=nt,de+=Ye}xe.type===3&&Z.writeVarint(wt(7,1))}}function Bt(xe,Z){const q=typeof xe;q==="string"?Z.writeStringField(1,xe):q==="boolean"?Z.writeBooleanField(7,xe):q==="number"&&(xe%1!=0?Z.writeDoubleField(3,xe):xe<0?Z.writeSVarintField(6,xe):Z.writeVarintField(5,xe))}const cn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},nn=Math.fround||(on=new Float32Array(1),xe=>(on[0]=+xe,on[0]));var on;class jn{constructor(Z){this.options=Object.assign(Object.create(cn),Z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Z){const{log:q,minZoom:K,maxZoom:se}=this.options;q&&console.time("total time");const de=`prepare ${Z.length} points`;q&&console.time(de),this.points=Z;const be=[];for(let Pe=0;Pe<Z.length;Pe++){const qe=Z[Pe];if(!qe.geometry)continue;const[nt,Ye]=qe.geometry.coordinates,Pt=nn(We(nt)),Ce=nn(mt(Ye));be.push(Pt,Ce,1/0,Pe,-1,1),this.options.reduce&&be.push(0)}let Be=this.trees[se+1]=this._createTree(be);q&&console.timeEnd(de);for(let Pe=se;Pe>=K;Pe--){const qe=+Date.now();Be=this.trees[Pe]=this._createTree(this._cluster(Be,Pe)),q&&console.log("z%d: %d clusters in %dms",Pe,Be.numItems,+Date.now()-qe)}return q&&console.timeEnd("total time"),this}getClusters(Z,q){let K=((Z[0]+180)%360+360)%360-180;const se=Math.max(-90,Math.min(90,Z[1]));let de=Z[2]===180?180:((Z[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,Z[3]));if(Z[2]-Z[0]>=360)K=-180,de=180;else if(K>de){const Ye=this.getClusters([K,se,180,be],q),Pt=this.getClusters([-180,se,de,be],q);return Ye.concat(Pt)}const Be=this.trees[this._limitZoom(q)],Pe=Be.range(We(K),mt(be),We(de),mt(se)),qe=Be.data,nt=[];for(const Ye of Pe){const Pt=this.stride*Ye;nt.push(qe[Pt+5]>1?er(qe,Pt,this.clusterProps):this.points[qe[Pt+3]])}return nt}getChildren(Z){const q=this._getOriginId(Z),K=this._getOriginZoom(Z),se="No cluster with the specified id.",de=this.trees[K];if(!de)throw new Error(se);const be=de.data;if(q*this.stride>=be.length)throw new Error(se);const Be=this.options.radius/(this.options.extent*Math.pow(2,K-1)),Pe=de.within(be[q*this.stride],be[q*this.stride+1],Be),qe=[];for(const nt of Pe){const Ye=nt*this.stride;be[Ye+4]===Z&&qe.push(be[Ye+5]>1?er(be,Ye,this.clusterProps):this.points[be[Ye+3]])}if(qe.length===0)throw new Error(se);return qe}getLeaves(Z,q,K){const se=[];return this._appendLeaves(se,Z,q=q||10,K=K||0,0),se}getTile(Z,q,K){const se=this.trees[this._limitZoom(Z)],de=Math.pow(2,Z),{extent:be,radius:Be}=this.options,Pe=Be/be,qe=(K-Pe)/de,nt=(K+1+Pe)/de,Ye={features:[]};return this._addTileFeatures(se.range((q-Pe)/de,qe,(q+1+Pe)/de,nt),se.data,q,K,de,Ye),q===0&&this._addTileFeatures(se.range(1-Pe/de,qe,1,nt),se.data,de,K,de,Ye),q===de-1&&this._addTileFeatures(se.range(0,qe,Pe/de,nt),se.data,-1,K,de,Ye),Ye.features.length?Ye:null}getClusterExpansionZoom(Z){let q=this._getOriginZoom(Z)-1;for(;q<=this.options.maxZoom;){const K=this.getChildren(Z);if(q++,K.length!==1)break;Z=K[0].properties.cluster_id}return q}_appendLeaves(Z,q,K,se,de){const be=this.getChildren(q);for(const Be of be){const Pe=Be.properties;if(Pe&&Pe.cluster?de+Pe.point_count<=se?de+=Pe.point_count:de=this._appendLeaves(Z,Pe.cluster_id,K,se,de):de<se?de++:Z.push(Be),Z.length===K)break}return de}_createTree(Z){const q=new A.aI(Z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<Z.length;K+=this.stride)q.add(Z[K],Z[K+1]);return q.finish(),q.data=Z,q}_addTileFeatures(Z,q,K,se,de,be){for(const Be of Z){const Pe=Be*this.stride,qe=q[Pe+5]>1;let nt,Ye,Pt;if(qe)nt=mn(q,Pe,this.clusterProps),Ye=q[Pe],Pt=q[Pe+1];else{const dn=this.points[q[Pe+3]];nt=dn.properties;const[Rt,Wt]=dn.geometry.coordinates;Ye=We(Rt),Pt=mt(Wt)}const Ce={type:1,geometry:[[Math.round(this.options.extent*(Ye*de-K)),Math.round(this.options.extent*(Pt*de-se))]],tags:nt};let Gt;Gt=qe||this.options.generateId?q[Pe+3]:this.points[q[Pe+3]].id,Gt!==void 0&&(Ce.id=Gt),be.features.push(Ce)}}_limitZoom(Z){return Math.max(this.options.minZoom,Math.min(Math.floor(+Z),this.options.maxZoom+1))}_cluster(Z,q){const{radius:K,extent:se,reduce:de,minPoints:be}=this.options,Be=K/(se*Math.pow(2,q)),Pe=Z.data,qe=[],nt=this.stride;for(let Ye=0;Ye<Pe.length;Ye+=nt){if(Pe[Ye+2]<=q)continue;Pe[Ye+2]=q;const Pt=Pe[Ye],Ce=Pe[Ye+1],Gt=Z.within(Pe[Ye],Pe[Ye+1],Be),dn=Pe[Ye+5];let Rt=dn;for(const Wt of Gt){const In=Wt*nt;Pe[In+2]>q&&(Rt+=Pe[In+5])}if(Rt>dn&&Rt>=be){let Wt,In=Pt*dn,Fr=Ce*dn,Vr=-1;const Vn=(Ye/nt<<5)+(q+1)+this.points.length;for(const Ut of Gt){const $t=Ut*nt;if(Pe[$t+2]<=q)continue;Pe[$t+2]=q;const lr=Pe[$t+5];In+=Pe[$t]*lr,Fr+=Pe[$t+1]*lr,Pe[$t+4]=Vn,de&&(Wt||(Wt=this._map(Pe,Ye,!0),Vr=this.clusterProps.length,this.clusterProps.push(Wt)),de(Wt,this._map(Pe,$t)))}Pe[Ye+4]=Vn,qe.push(In/Rt,Fr/Rt,1/0,Vn,-1,Rt),de&&qe.push(Vr)}else{for(let Wt=0;Wt<nt;Wt++)qe.push(Pe[Ye+Wt]);if(Rt>1)for(const Wt of Gt){const In=Wt*nt;if(!(Pe[In+2]<=q)){Pe[In+2]=q;for(let Fr=0;Fr<nt;Fr++)qe.push(Pe[In+Fr])}}}}return qe}_getOriginId(Z){return Z-this.points.length>>5}_getOriginZoom(Z){return(Z-this.points.length)%32}_map(Z,q,K){if(Z[q+5]>1){const be=this.clusterProps[Z[q+6]];return K?Object.assign({},be):be}const se=this.points[Z[q+3]].properties,de=this.options.map(se);return K&&de===se?Object.assign({},de):de}}function er(xe,Z,q){return{type:"Feature",id:xe[Z+3],properties:mn(xe,Z,q),geometry:{type:"Point",coordinates:[(K=xe[Z],360*(K-.5)),rt(xe[Z+1])]}};var K}function mn(xe,Z,q){const K=xe[Z+5],se=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,de=xe[Z+6],be=de===-1?{}:Object.assign({},q[de]);return Object.assign(be,{cluster:!0,cluster_id:xe[Z+3],point_count:K,point_count_abbreviated:se})}function We(xe){return xe/360+.5}function mt(xe){const Z=Math.sin(xe*Math.PI/180),q=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return q<0?0:q>1?1:q}function rt(xe){const Z=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(Z))/Math.PI-90}function Et(xe,Z,q,K){let se=K;const de=Z+(q-Z>>1);let be,Be=q-Z;const Pe=xe[Z],qe=xe[Z+1],nt=xe[q],Ye=xe[q+1];for(let Pt=Z+3;Pt<q;Pt+=3){const Ce=ve(xe[Pt],xe[Pt+1],Pe,qe,nt,Ye);if(Ce>se)be=Pt,se=Ce;else if(Ce===se){const Gt=Math.abs(Pt-de);Gt<Be&&(be=Pt,Be=Gt)}}se>K&&(be-Z>3&&Et(xe,Z,be,K),xe[be+2]=se,q-be>3&&Et(xe,be,q,K))}function ve(xe,Z,q,K,se,de){let be=se-q,Be=de-K;if(be!==0||Be!==0){const Pe=((xe-q)*be+(Z-K)*Be)/(be*be+Be*Be);Pe>1?(q=se,K=de):Pe>0&&(q+=be*Pe,K+=Be*Pe)}return be=xe-q,Be=Z-K,be*be+Be*Be}function Xe(xe,Z,q,K){const se={id:xe??null,type:Z,geometry:q,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Z==="Point"||Z==="MultiPoint"||Z==="LineString")vt(se,q);else if(Z==="Polygon")vt(se,q[0]);else if(Z==="MultiLineString")for(const de of q)vt(se,de);else if(Z==="MultiPolygon")for(const de of q)vt(se,de[0]);return se}function vt(xe,Z){for(let q=0;q<Z.length;q+=3)xe.minX=Math.min(xe.minX,Z[q]),xe.minY=Math.min(xe.minY,Z[q+1]),xe.maxX=Math.max(xe.maxX,Z[q]),xe.maxY=Math.max(xe.maxY,Z[q+1])}function st(xe,Z,q,K){if(!Z.geometry)return;const se=Z.geometry.coordinates;if(se&&se.length===0)return;const de=Z.geometry.type,be=Math.pow(q.tolerance/((1<<q.maxZoom)*q.extent),2);let Be=[],Pe=Z.id;if(q.promoteId?Pe=Z.properties[q.promoteId]:q.generateId&&(Pe=K||0),de==="Point")xt(se,Be);else if(de==="MultiPoint")for(const qe of se)xt(qe,Be);else if(de==="LineString")Kt(se,Be,be,!1);else if(de==="MultiLineString"){if(q.lineMetrics){for(const qe of se)Be=[],Kt(qe,Be,be,!1),xe.push(Xe(Pe,"LineString",Be,Z.properties));return}It(se,Be,be,!1)}else if(de==="Polygon")It(se,Be,be,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(const qe of Z.geometry.geometries)st(xe,{id:Pe,geometry:qe,properties:Z.properties},q,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const qe of se){const nt=[];It(qe,nt,be,!0),Be.push(nt)}}xe.push(Xe(Pe,de,Be,Z.properties))}function xt(xe,Z){Z.push(Zt(xe[0]),Ht(xe[1]),0)}function Kt(xe,Z,q,K){let se,de,be=0;for(let Pe=0;Pe<xe.length;Pe++){const qe=Zt(xe[Pe][0]),nt=Ht(xe[Pe][1]);Z.push(qe,nt,0),Pe>0&&(be+=K?(se*nt-qe*de)/2:Math.sqrt(Math.pow(qe-se,2)+Math.pow(nt-de,2))),se=qe,de=nt}const Be=Z.length-3;Z[2]=1,Et(Z,0,Be,q),Z[Be+2]=1,Z.size=Math.abs(be),Z.start=0,Z.end=Z.size}function It(xe,Z,q,K){for(let se=0;se<xe.length;se++){const de=[];Kt(xe[se],de,q,K),Z.push(de)}}function Zt(xe){return xe/360+.5}function Ht(xe){const Z=Math.sin(xe*Math.PI/180),q=.5-.25*Math.log((1+Z)/(1-Z))/Math.PI;return q<0?0:q>1?1:q}function En(xe,Z,q,K,se,de,be,Be){if(K/=Z,de>=(q/=Z)&&be<K)return xe;if(be<q||de>=K)return null;const Pe=[];for(const qe of xe){const nt=qe.geometry;let Ye=qe.type;const Pt=se===0?qe.minX:qe.minY,Ce=se===0?qe.maxX:qe.maxY;if(Pt>=q&&Ce<K){Pe.push(qe);continue}if(Ce<q||Pt>=K)continue;let Gt=[];if(Ye==="Point"||Ye==="MultiPoint")tr(nt,Gt,q,K,se);else if(Ye==="LineString")xn(nt,Gt,q,K,se,!1,Be.lineMetrics);else if(Ye==="MultiLineString")qt(nt,Gt,q,K,se,!1);else if(Ye==="Polygon")qt(nt,Gt,q,K,se,!0);else if(Ye==="MultiPolygon")for(const dn of nt){const Rt=[];qt(dn,Rt,q,K,se,!0),Rt.length&&Gt.push(Rt)}if(Gt.length){if(Be.lineMetrics&&Ye==="LineString"){for(const dn of Gt)Pe.push(Xe(qe.id,Ye,dn,qe.tags));continue}Ye!=="LineString"&&Ye!=="MultiLineString"||(Gt.length===1?(Ye="LineString",Gt=Gt[0]):Ye="MultiLineString"),Ye!=="Point"&&Ye!=="MultiPoint"||(Ye=Gt.length===3?"Point":"MultiPoint"),Pe.push(Xe(qe.id,Ye,Gt,qe.tags))}}return Pe.length?Pe:null}function tr(xe,Z,q,K,se){for(let de=0;de<xe.length;de+=3){const be=xe[de+se];be>=q&&be<=K&&un(Z,xe[de],xe[de+1],xe[de+2])}}function xn(xe,Z,q,K,se,de,be){let Be=St(xe);const Pe=se===0?qn:Ar;let qe,nt,Ye=xe.start;for(let Rt=0;Rt<xe.length-3;Rt+=3){const Wt=xe[Rt],In=xe[Rt+1],Fr=xe[Rt+2],Vr=xe[Rt+3],Vn=xe[Rt+4],Ut=se===0?Wt:In,$t=se===0?Vr:Vn;let lr=!1;be&&(qe=Math.sqrt(Math.pow(Wt-Vr,2)+Math.pow(In-Vn,2))),Ut<q?$t>q&&(nt=Pe(Be,Wt,In,Vr,Vn,q),be&&(Be.start=Ye+qe*nt)):Ut>K?$t<K&&(nt=Pe(Be,Wt,In,Vr,Vn,K),be&&(Be.start=Ye+qe*nt)):un(Be,Wt,In,Fr),$t<q&&Ut>=q&&(nt=Pe(Be,Wt,In,Vr,Vn,q),lr=!0),$t>K&&Ut<=K&&(nt=Pe(Be,Wt,In,Vr,Vn,K),lr=!0),!de&&lr&&(be&&(Be.end=Ye+qe*nt),Z.push(Be),Be=St(xe)),be&&(Ye+=qe)}let Pt=xe.length-3;const Ce=xe[Pt],Gt=xe[Pt+1],dn=se===0?Ce:Gt;dn>=q&&dn<=K&&un(Be,Ce,Gt,xe[Pt+2]),Pt=Be.length-3,de&&Pt>=3&&(Be[Pt]!==Be[0]||Be[Pt+1]!==Be[1])&&un(Be,Be[0],Be[1],Be[2]),Be.length&&Z.push(Be)}function St(xe){const Z=[];return Z.size=xe.size,Z.start=xe.start,Z.end=xe.end,Z}function qt(xe,Z,q,K,se,de){for(const be of xe)xn(be,Z,q,K,se,de,!1)}function un(xe,Z,q,K){xe.push(Z,q,K)}function qn(xe,Z,q,K,se,de){const be=(de-Z)/(K-Z);return un(xe,de,q+(se-q)*be,1),be}function Ar(xe,Z,q,K,se,de){const be=(de-q)/(se-q);return un(xe,Z+(K-Z)*be,de,1),be}function nr(xe,Z){const q=[];for(let K=0;K<xe.length;K++){const se=xe[K],de=se.type;let be;if(de==="Point"||de==="MultiPoint"||de==="LineString")be=Kr(se.geometry,Z);else if(de==="MultiLineString"||de==="Polygon"){be=[];for(const Be of se.geometry)be.push(Kr(Be,Z))}else if(de==="MultiPolygon"){be=[];for(const Be of se.geometry){const Pe=[];for(const qe of Be)Pe.push(Kr(qe,Z));be.push(Pe)}}q.push(Xe(se.id,de,be,se.tags))}return q}function Kr(xe,Z){const q=[];q.size=xe.size,xe.start!==void 0&&(q.start=xe.start,q.end=xe.end);for(let K=0;K<xe.length;K+=3)q.push(xe[K]+Z,xe[K+1],xe[K+2]);return q}function Br(xe,Z){if(xe.transformed)return xe;const q=1<<xe.z,K=xe.x,se=xe.y;for(const de of xe.features){const be=de.geometry,Be=de.type;if(de.geometry=[],Be===1)for(let Pe=0;Pe<be.length;Pe+=2)de.geometry.push(Mi(be[Pe],be[Pe+1],Z,q,K,se));else for(let Pe=0;Pe<be.length;Pe++){const qe=[];for(let nt=0;nt<be[Pe].length;nt+=2)qe.push(Mi(be[Pe][nt],be[Pe][nt+1],Z,q,K,se));de.geometry.push(qe)}}return xe.transformed=!0,xe}function Mi(xe,Z,q,K,se,de){return[Math.round(q*(xe*K-se)),Math.round(q*(Z*K-de))]}function oi(xe,Z,q,K,se){const de=Z===se.maxZoom?0:se.tolerance/((1<<Z)*se.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:q,y:K,z:Z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Be of xe)ya(be,Be,de,se);return be}function ya(xe,Z,q,K){const se=Z.geometry,de=Z.type,be=[];if(xe.minX=Math.min(xe.minX,Z.minX),xe.minY=Math.min(xe.minY,Z.minY),xe.maxX=Math.max(xe.maxX,Z.maxX),xe.maxY=Math.max(xe.maxY,Z.maxY),de==="Point"||de==="MultiPoint")for(let Be=0;Be<se.length;Be+=3)be.push(se[Be],se[Be+1]),xe.numPoints++,xe.numSimplified++;else if(de==="LineString")ra(be,se,xe,q,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let Be=0;Be<se.length;Be++)ra(be,se[Be],xe,q,de==="Polygon",Be===0);else if(de==="MultiPolygon")for(let Be=0;Be<se.length;Be++){const Pe=se[Be];for(let qe=0;qe<Pe.length;qe++)ra(be,Pe[qe],xe,q,!0,qe===0)}if(be.length){let Be=Z.tags||null;if(de==="LineString"&&K.lineMetrics){Be={};for(const qe in Z.tags)Be[qe]=Z.tags[qe];Be.mapbox_clip_start=se.start/se.size,Be.mapbox_clip_end=se.end/se.size}const Pe={geometry:be,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:Be};Z.id!==null&&(Pe.id=Z.id),xe.features.push(Pe)}}function ra(xe,Z,q,K,se,de){const be=K*K;if(K>0&&Z.size<(se?be:K))return void(q.numPoints+=Z.length/3);const Be=[];for(let Pe=0;Pe<Z.length;Pe+=3)(K===0||Z[Pe+2]>be)&&(q.numSimplified++,Be.push(Z[Pe],Z[Pe+1])),q.numPoints++;se&&(function(Pe,qe){let nt=0;for(let Ye=0,Pt=Pe.length,Ce=Pt-2;Ye<Pt;Ce=Ye,Ye+=2)nt+=(Pe[Ye]-Pe[Ce])*(Pe[Ye+1]+Pe[Ce+1]);if(nt>0===qe)for(let Ye=0,Pt=Pe.length;Ye<Pt/2;Ye+=2){const Ce=Pe[Ye],Gt=Pe[Ye+1];Pe[Ye]=Pe[Pt-2-Ye],Pe[Ye+1]=Pe[Pt-1-Ye],Pe[Pt-2-Ye]=Ce,Pe[Pt-1-Ye]=Gt}})(Be,de),xe.push(Be)}const qa={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Aa{constructor(Z,q){const K=(q=this.options=(function(de,be){for(const Be in be)de[Be]=be[Be];return de})(Object.create(qa),q)).debug;if(K&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");let se=(function(de,be){const Be=[];if(de.type==="FeatureCollection")for(let Pe=0;Pe<de.features.length;Pe++)st(Be,de.features[Pe],be,Pe);else st(Be,de.type==="Feature"?de:{geometry:de},be);return Be})(Z,q);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),se=(function(de,be){const Be=be.buffer/be.extent;let Pe=de;const qe=En(de,1,-1-Be,Be,0,-1,2,be),nt=En(de,1,1-Be,2+Be,0,-1,2,be);return(qe||nt)&&(Pe=En(de,1,-Be,1+Be,0,-1,2,be)||[],qe&&(Pe=nr(qe,1).concat(Pe)),nt&&(Pe=Pe.concat(nr(nt,-1)))),Pe})(se,q),se.length&&this.splitTile(se,0,0,0),K&&(se.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Z,q,K,se,de,be,Be){const Pe=[Z,q,K,se],qe=this.options,nt=qe.debug;for(;Pe.length;){se=Pe.pop(),K=Pe.pop(),q=Pe.pop(),Z=Pe.pop();const Ye=1<<q,Pt=Wi(q,K,se);let Ce=this.tiles[Pt];if(!Ce&&(nt>1&&console.time("creation"),Ce=this.tiles[Pt]=oi(Z,q,K,se,qe),this.tileCoords.push({z:q,x:K,y:se}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,K,se,Ce.numFeatures,Ce.numPoints,Ce.numSimplified),console.timeEnd("creation"));const lr=`z${q}`;this.stats[lr]=(this.stats[lr]||0)+1,this.total++}if(Ce.source=Z,de==null){if(q===qe.indexMaxZoom||Ce.numPoints<=qe.indexMaxPoints)continue}else{if(q===qe.maxZoom||q===de)continue;if(de!=null){const lr=de-q;if(K!==be>>lr||se!==Be>>lr)continue}}if(Ce.source=null,Z.length===0)continue;nt>1&&console.time("clipping");const Gt=.5*qe.buffer/qe.extent,dn=.5-Gt,Rt=.5+Gt,Wt=1+Gt;let In=null,Fr=null,Vr=null,Vn=null,Ut=En(Z,Ye,K-Gt,K+Rt,0,Ce.minX,Ce.maxX,qe),$t=En(Z,Ye,K+dn,K+Wt,0,Ce.minX,Ce.maxX,qe);Z=null,Ut&&(In=En(Ut,Ye,se-Gt,se+Rt,1,Ce.minY,Ce.maxY,qe),Fr=En(Ut,Ye,se+dn,se+Wt,1,Ce.minY,Ce.maxY,qe),Ut=null),$t&&(Vr=En($t,Ye,se-Gt,se+Rt,1,Ce.minY,Ce.maxY,qe),Vn=En($t,Ye,se+dn,se+Wt,1,Ce.minY,Ce.maxY,qe),$t=null),nt>1&&console.timeEnd("clipping"),Pe.push(In||[],q+1,2*K,2*se),Pe.push(Fr||[],q+1,2*K,2*se+1),Pe.push(Vr||[],q+1,2*K+1,2*se),Pe.push(Vn||[],q+1,2*K+1,2*se+1)}}getTile(Z,q,K){Z=+Z,q=+q,K=+K;const se=this.options,{extent:de,debug:be}=se;if(Z<0||Z>24)return null;const Be=1<<Z,Pe=Wi(Z,q=q+Be&Be-1,K);if(this.tiles[Pe])return Br(this.tiles[Pe],de);be>1&&console.log("drilling down to z%d-%d-%d",Z,q,K);let qe,nt=Z,Ye=q,Pt=K;for(;!qe&&nt>0;)nt--,Ye>>=1,Pt>>=1,qe=this.tiles[Wi(nt,Ye,Pt)];return qe&&qe.source?(be>1&&(console.log("found parent tile z%d-%d-%d",nt,Ye,Pt),console.time("drilling down")),this.splitTile(qe.source,nt,Ye,Pt,Z,q,K),be>1&&console.timeEnd("drilling down"),this.tiles[Pe]?Br(this.tiles[Pe],de):null):null}}function Wi(xe,Z,q){return 32*((1<<xe)*q+Z)+xe}class gr extends we{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(Z,q){return A._(this,void 0,void 0,(function*(){const K=Z.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const se=this._geoJSONIndex.getTile(K.z,K.x,K.y);if(!se)return null;const de=new ke(se.features,{version:2,extent:A.$});let be=(function(Be){const Pe=new A.cM;return(function(qe,nt){for(const Ye in qe.layers)nt.writeMessage(3,He,qe.layers[Ye])})(Be,Pe),Pe.finish()})(de);return be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),{vectorTile:de,rawData:be.buffer}}))}loadData(Z){return A._(this,void 0,void 0,(function*(){var q;(q=this._pendingRequest)===null||q===void 0||q.abort();const K=!!(Z&&Z.request&&Z.request.collectResourceTiming)&&new A.cN(Z.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(Z,this._pendingRequest);const se=yield this._pendingData;this._geoJSONIndex=Z.cluster?new jn((function({superclusterOptions:be,clusterProperties:Be}){if(!Be||!be)return be;const Pe={},qe={},nt={accumulated:null,zoom:0},Ye={properties:null},Pt=Object.keys(Be);for(const Ce of Pt){const[Gt,dn]=Be[Ce],Rt=A.cT(dn),Wt=A.cT(typeof Gt=="string"?[Gt,["accumulated"],["get",Ce]]:Gt);Pe[Ce]=Rt.value,qe[Ce]=Wt.value}return be.map=Ce=>{Ye.properties=Ce;const Gt={};for(const dn of Pt)Gt[dn]=Pe[dn].evaluate(nt,Ye);return Gt},be.reduce=(Ce,Gt)=>{Ye.properties=Gt;for(const dn of Pt)nt.accumulated=Ce[dn],Ce[dn]=qe[dn].evaluate(nt,Ye)},be})(Z)).load(se.features):(function(be,Be){return new Aa(be,Be)})(se,Z.geojsonVtOptions),this.loaded={};const de={data:se};if(K){const be=K.finish();be&&(de.resourceTiming={},de.resourceTiming[Z.source]=JSON.parse(JSON.stringify(be)))}return de}catch(se){if(delete this._pendingRequest,A.cy(se))return{abandoned:!0};throw se}}))}getData(){return A._(this,void 0,void 0,(function*(){return this._pendingData}))}reloadTile(Z){const q=this.loaded;return q&&q[Z.uid]?super.reloadTile(Z):this.loadTile(Z)}loadAndProcessGeoJSON(Z,q){return A._(this,void 0,void 0,(function*(){let K=yield this.loadGeoJSON(Z,q);if(delete this._pendingRequest,typeof K!="object")throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(ze(K,!0),Z.filter){const se=A.cT(Z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(se.result==="error")throw new Error(se.value.map((be=>`${be.key}: ${be.message}`)).join(", "));K={type:"FeatureCollection",features:K.features.filter((be=>se.value.evaluate({zoom:0},be)))}}return K}))}loadGeoJSON(Z,q){return A._(this,void 0,void 0,(function*(){const{promoteId:K}=Z;if(Z.request){const se=yield A.j(Z.request,q);return this._dataUpdateable=A.cV(se.data,K)?A.cU(se.data,K):void 0,se.data}if(typeof Z.data=="string")try{const se=JSON.parse(Z.data);return this._dataUpdateable=A.cV(se,K)?A.cU(se,K):void 0,se}catch{throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`)}if(!Z.dataDiff)throw new Error(`Input data given to '${Z.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${Z.source}`);return A.cW(this._dataUpdateable,Z.dataDiff,K),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}))}removeSource(Z){return A._(this,void 0,void 0,(function*(){this._pendingRequest&&this._pendingRequest.abort()}))}getClusterExpansionZoom(Z){return this._geoJSONIndex.getClusterExpansionZoom(Z.clusterId)}getClusterChildren(Z){return this._geoJSONIndex.getChildren(Z.clusterId)}getClusterLeaves(Z){return this._geoJSONIndex.getLeaves(Z.clusterId,Z.limit,Z.offset)}}class Ri{constructor(Z){this.self=Z,this.actor=new A.J(Z),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.globalStates=new Map,this.self.registerWorkerSource=(q,K)=>{if(this.externalWorkerSourceTypes[q])throw new Error(`Worker source with name "${q}" already registered.`);this.externalWorkerSourceTypes[q]=K},this.self.addProtocol=A.cA,this.self.removeProtocol=A.cB,this.self.registerRTLTextPlugin=q=>{A.cX.setMethods(q)},this.actor.registerMessageHandler("LDT",((q,K)=>this._getDEMWorkerSource(q,K.source).loadTile(K))),this.actor.registerMessageHandler("RDT",((q,K)=>A._(this,void 0,void 0,(function*(){this._getDEMWorkerSource(q,K.source).removeTile(K)})))),this.actor.registerMessageHandler("GCEZ",((q,K)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(q,K.type,K.source).getClusterExpansionZoom(K)})))),this.actor.registerMessageHandler("GCC",((q,K)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(q,K.type,K.source).getClusterChildren(K)})))),this.actor.registerMessageHandler("GCL",((q,K)=>A._(this,void 0,void 0,(function*(){return this._getWorkerSource(q,K.type,K.source).getClusterLeaves(K)})))),this.actor.registerMessageHandler("LD",((q,K)=>this._getWorkerSource(q,K.type,K.source).loadData(K))),this.actor.registerMessageHandler("GD",((q,K)=>this._getWorkerSource(q,K.type,K.source).getData())),this.actor.registerMessageHandler("LT",((q,K)=>this._getWorkerSource(q,K.type,K.source).loadTile(K))),this.actor.registerMessageHandler("RT",((q,K)=>this._getWorkerSource(q,K.type,K.source).reloadTile(K))),this.actor.registerMessageHandler("AT",((q,K)=>this._getWorkerSource(q,K.type,K.source).abortTile(K))),this.actor.registerMessageHandler("RMT",((q,K)=>this._getWorkerSource(q,K.type,K.source).removeTile(K))),this.actor.registerMessageHandler("RS",((q,K)=>A._(this,void 0,void 0,(function*(){if(!this.workerSources[q]||!this.workerSources[q][K.type]||!this.workerSources[q][K.type][K.source])return;const se=this.workerSources[q][K.type][K.source];delete this.workerSources[q][K.type][K.source],se.removeSource!==void 0&&se.removeSource(K)})))),this.actor.registerMessageHandler("RM",(q=>A._(this,void 0,void 0,(function*(){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q],this.globalStates.delete(q)})))),this.actor.registerMessageHandler("SR",((q,K)=>A._(this,void 0,void 0,(function*(){this.referrer=K})))),this.actor.registerMessageHandler("SRPS",((q,K)=>this._syncRTLPluginState(q,K))),this.actor.registerMessageHandler("IS",((q,K)=>A._(this,void 0,void 0,(function*(){this.self.importScripts(K)})))),this.actor.registerMessageHandler("SI",((q,K)=>this._setImages(q,K))),this.actor.registerMessageHandler("UL",((q,K)=>A._(this,void 0,void 0,(function*(){this._getLayerIndex(q).update(K.layers,K.removedIds,this._getGlobalState(q))})))),this.actor.registerMessageHandler("UGS",((q,K)=>A._(this,void 0,void 0,(function*(){const se=this._getGlobalState(q);for(const de in K)se[de]=K[de]})))),this.actor.registerMessageHandler("SL",((q,K)=>A._(this,void 0,void 0,(function*(){this._getLayerIndex(q).replace(K,this._getGlobalState(q))}))))}_getGlobalState(Z){let q=this.globalStates.get(Z);return q||(q={},this.globalStates.set(Z,q)),q}_setImages(Z,q){return A._(this,void 0,void 0,(function*(){this.availableImages[Z]=q;for(const K in this.workerSources[Z]){const se=this.workerSources[Z][K];for(const de in se)se[de].availableImages=q}}))}_syncRTLPluginState(Z,q){return A._(this,void 0,void 0,(function*(){return yield A.cX.syncState(q,this.self.importScripts)}))}_getAvailableImages(Z){let q=this.availableImages[Z];return q||(q=[]),q}_getLayerIndex(Z){let q=this.layerIndexes[Z];return q||(q=this.layerIndexes[Z]=new c),q}_getWorkerSource(Z,q,K){if(this.workerSources[Z]||(this.workerSources[Z]={}),this.workerSources[Z][q]||(this.workerSources[Z][q]={}),!this.workerSources[Z][q][K]){const se={sendAsync:(de,be)=>(de.targetMapId=Z,this.actor.sendAsync(de,be))};switch(q){case"vector":this.workerSources[Z][q][K]=new we(se,this._getLayerIndex(Z),this._getAvailableImages(Z));break;case"geojson":this.workerSources[Z][q][K]=new gr(se,this._getLayerIndex(Z),this._getAvailableImages(Z));break;default:this.workerSources[Z][q][K]=new this.externalWorkerSourceTypes[q](se,this._getLayerIndex(Z),this._getAvailableImages(Z))}}return this.workerSources[Z][q][K]}_getDEMWorkerSource(Z,q){return this.demWorkerSources[Z]||(this.demWorkerSources[Z]={}),this.demWorkerSources[Z][q]||(this.demWorkerSources[Z][q]=new ge),this.demWorkerSources[Z][q]}}return A.i(self)&&(self.worker=new Ri(self)),Ri})),j("index",["exports","./shared"],(function(A,c){var H="5.7.3";function Y(){var f=new c.A(4);return c.A!=Float32Array&&(f[1]=0,f[2]=0),f[0]=1,f[3]=1,f}let he,we;const ge={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(f,e,a){const l=requestAnimationFrame((g=>{d(),e(g)})),{unsubscribe:d}=c.s(f.signal,"abort",(()=>{d(),cancelAnimationFrame(l),a(c.c())}),!1)},frameAsync(f){return new Promise(((e,a)=>{this.frame(f,e,a)}))},getImageData(f,e=0){return this.getImageCanvasContext(f).getImageData(-e,-e,f.width+2*e,f.height+2*e)},getImageCanvasContext(f){const e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=f.width,e.height=f.height,a.drawImage(f,0,0,f.width,f.height),a},resolveURL:f=>(he||(he=document.createElement("a")),he.href=f,he.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(we==null&&(we=matchMedia("(prefers-reduced-motion: reduce)")),we.matches)}};class ne{static testProp(e){if(!ne.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in ne.docStyle)return e[a];return e[0]}static create(e,a,l){const d=window.document.createElement(e);return a!==void 0&&(d.className=a),l&&l.appendChild(d),d}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){ne.docStyle&&ne.selectProp&&(ne.userSelect=ne.docStyle[ne.selectProp],ne.docStyle[ne.selectProp]="none")}static enableDrag(){ne.docStyle&&ne.selectProp&&(ne.docStyle[ne.selectProp]=ne.userSelect)}static setTransform(e,a){e.style[ne.transformProp]=a}static addEventListener(e,a,l,d={}){e.addEventListener(a,l,"passive"in d?d:d.capture)}static removeEventListener(e,a,l,d={}){e.removeEventListener(a,l,"passive"in d?d:d.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",ne.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ne.suppressClickInternal,!0),window.setTimeout((()=>{window.removeEventListener("click",ne.suppressClickInternal,!0)}),0)}static getScale(e){const a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,l){const d=a.boundingClientRect;return new c.P((l.clientX-d.left)/a.x-e.clientLeft,(l.clientY-d.top)/a.y-e.clientTop)}static mousePos(e,a){const l=ne.getScale(e);return ne.getPoint(e,l,a)}static touchPos(e,a){const l=[],d=ne.getScale(e);for(let g=0;g<a.length;g++)l.push(ne.getPoint(e,d,a[g]));return l}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const a=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),l=a.querySelectorAll("script");for(const d of l)d.remove();return ne.clean(a),a.innerHTML}static isPossiblyDangerous(e,a){const l=a.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!l.includes("javascript:")&&!l.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const a=e.children;for(const l of a)ne.removeAttributes(l),ne.clean(l)}static removeAttributes(e){for(const{name:a,value:l}of e.attributes)ne.isPossiblyDangerous(a,l)&&e.removeAttribute(a)}}ne.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ne.selectProp=ne.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ne.transformProp=ne.testProp(["transform","WebkitTransform"]);const Re={supported:!1,testSupport:function(f){!De&&ze&&(ke?He(f):ye=f)}};let ye,ze,De=!1,ke=!1;function He(f){const e=f.createTexture();f.bindTexture(f.TEXTURE_2D,e);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,ze),f.isContextLost())return;Re.supported=!0}catch{}f.deleteTexture(e),De=!0}var it;typeof document<"u"&&(ze=document.createElement("img"),ze.onload=()=>{ye&&He(ye),ye=null,ke=!0},ze.onerror=()=>{De=!0,ye=null},ze.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),(function(f){let e,a,l,d;f.resetRequestQueue=()=>{e=[],a=0,l=0,d={}},f.addThrottleControl=P=>{const E=l++;return d[E]=P,E},f.removeThrottleControl=P=>{delete d[P],_()},f.getImage=(P,E,I=!0)=>new Promise(((O,k)=>{Re.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),c.e(P,{type:"image"}),e.push({abortController:E,requestParameters:P,supportImageRefresh:I,state:"queued",onError:N=>{k(N)},onSuccess:N=>{O(N)}}),_()}));const g=P=>c._(this,void 0,void 0,(function*(){P.state="running";const{requestParameters:E,supportImageRefresh:I,onError:O,onSuccess:k,abortController:N}=P,W=I===!1&&!c.i(self)&&!c.g(E.url)&&(!E.headers||Object.keys(E.headers).reduce(((te,ie)=>te&&ie==="accept"),!0));a++;const J=W?S(E,N):c.m(E,N);try{const te=yield J;delete P.abortController,P.state="completed",te.data instanceof HTMLImageElement||c.b(te.data)?k(te):te.data&&k({data:yield(ee=te.data,typeof createImageBitmap=="function"?c.f(ee):c.h(ee)),cacheControl:te.cacheControl,expires:te.expires})}catch(te){delete P.abortController,O(te)}finally{a--,_()}var ee})),_=()=>{const P=(()=>{for(const E of Object.keys(d))if(d[E]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let E=a;E<P&&e.length>0;E++){const I=e.shift();I.abortController.signal.aborted?E--:g(I)}},S=(P,E)=>new Promise(((I,O)=>{const k=new Image,N=P.url,W=P.credentials;W&&W==="include"?k.crossOrigin="use-credentials":(W&&W==="same-origin"||!c.d(N))&&(k.crossOrigin="anonymous"),E.signal.addEventListener("abort",(()=>{k.src="",O(c.c())})),k.fetchPriority="high",k.onload=()=>{k.onerror=k.onload=null,I({data:k})},k.onerror=()=>{k.onerror=k.onload=null,E.signal.aborted||O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},k.src=N}))})(it||(it={})),it.resetRequestQueue();class at{constructor(e){this._transformRequestFn=e??null}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function wt(f){const e=[];if(typeof f=="string")e.push({id:"default",url:f});else if(f&&f.length>0){const a=[];for(const{id:l,url:d}of f){const g=`${l}${d}`;a.indexOf(g)===-1&&(a.push(g),e.push({id:l,url:d}))}}return e}function ft(f,e,a){try{const l=new URL(f);return l.pathname+=`${e}${a}`,l.toString()}catch{throw new Error(`Invalid sprite URL "${f}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function ot(f){const{userImage:e}=f;return!!(e&&e.render&&e.render())&&(f.data.replace(new Uint8Array(e.data.buffer)),!0)}class Bt extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:a,promiseResolve:l}of this.requestors)l(this._getImagesForIds(a));this.requestors=[]}}getImage(e){const a=this.images[e];if(a&&!a.data&&a.spriteData){const l=a.spriteData;a.data=new c.R({width:l.width,height:l.height},l.context.getImageData(l.x,l.y,l.width,l.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let l=!0;const d=a.data||a.spriteData;return this._validateStretch(a.stretchX,d&&d.width)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchX" value`))),l=!1),this._validateStretch(a.stretchY,d&&d.height)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "stretchY" value`))),l=!1),this._validateContent(a.content,a)||(this.fire(new c.k(new Error(`Image "${e}" has invalid "content" value`))),l=!1),l}_validateStretch(e,a){if(!e)return!0;let l=0;for(const d of e){if(d[0]<l||d[1]<d[0]||a<d[1])return!1;l=d[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;const l=a.spriteData,d=l&&l.width||a.data.width,g=l&&l.height||a.data.height;return!(e[0]<0||d<e[0]||e[1]<0||g<e[1]||e[2]<0||d<e[2]||e[3]<0||g<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,l=!0){const d=this.getImage(e);if(l&&(d.data.width!==a.data.width||d.data.height!==a.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=d.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){const a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise(((a,l)=>{let d=!0;if(!this.isLoaded())for(const g of e)this.images[g]||(d=!1);this.isLoaded()||d?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})}))}_getImagesForIds(e){const a={};for(const l of e){let d=this.getImage(l);d||(this.fire(new c.l("styleimagemissing",{id:l})),d=this.getImage(l)),d?a[l]={data:d.data.clone(),pixelRatio:d.pixelRatio,sdf:d.sdf,version:d.version,stretchX:d.stretchX,stretchY:d.stretchY,content:d.content,textFitWidth:d.textFitWidth,textFitHeight:d.textFitHeight,hasRenderCallback:!!(d.userImage&&d.userImage.render)}:c.w(`Image "${l}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){const{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){const a=this.patterns[e],l=this.getImage(e);if(!l)return null;if(a&&a.position.version===l.version)return a.position;if(a)a.position.version=l.version;else{const d={w:l.data.width+2,h:l.data.height+2,x:0,y:0},g=new c.I(d,l);this.patterns[e]={bin:d,position:g}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.T(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const g in this.patterns)e.push(this.patterns[g].bin);const{w:a,h:l}=c.p(e),d=this.atlasImage;d.resize({width:a||1,height:l||1});for(const g in this.patterns){const{bin:_}=this.patterns[g],S=_.x+1,P=_.y+1,E=this.getImage(g).data,I=E.width,O=E.height;c.R.copy(E,d,{x:0,y:0},{x:S,y:P},{width:I,height:O}),c.R.copy(E,d,{x:0,y:O-1},{x:S,y:P-1},{width:I,height:1}),c.R.copy(E,d,{x:0,y:0},{x:S,y:P+O},{width:I,height:1}),c.R.copy(E,d,{x:I-1,y:0},{x:S-1,y:P},{width:1,height:O}),c.R.copy(E,d,{x:0,y:0},{x:S+I,y:P},{width:1,height:O})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const l=this.getImage(a);l||c.w(`Image with ID: "${a}" was not found`),ot(l)&&this.updateImage(a,l)}}}const cn=1e20;function nn(f,e,a,l,d,g,_,S,P){for(let E=e;E<e+l;E++)on(f,a*g+E,g,d,_,S,P);for(let E=a;E<a+d;E++)on(f,E*g+e,1,l,_,S,P)}function on(f,e,a,l,d,g,_){g[0]=0,_[0]=-cn,_[1]=cn,d[0]=f[e];for(let S=1,P=0,E=0;S<l;S++){d[S]=f[e+S*a];const I=S*S;do{const O=g[P];E=(d[S]-d[O]+I-O*O)/(S-O)/2}while(E<=_[P]&&--P>-1);P++,g[P]=S,_[P]=E,_[P+1]=cn}for(let S=0,P=0;S<l;S++){for(;_[P+1]<S;)P++;const E=g[P],I=S-E;f[e+S*a]=d[E]+I*I}}class jn{constructor(e,a,l){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={},this.lang=l}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,(function*(){const a=[];for(const g in e)for(const _ of e[g])a.push(this._getAndCacheGlyphsPromise(g,_));const l=yield Promise.all(a),d={};for(const{stack:g,id:_,glyph:S}of l)d[g]||(d[g]={}),d[g][_]=S&&{id:S.id,bitmap:S.bitmap.clone(),metrics:S.metrics};return d}))}_getAndCacheGlyphsPromise(e,a){return c._(this,void 0,void 0,(function*(){let l=this.entries[e];l||(l=this.entries[e]={glyphs:{},requests:{},ranges:{}});let d=l.glyphs[a];if(d!==void 0)return{stack:e,id:a,glyph:d};if(d=this._tinySDF(l,e,a),d)return l.glyphs[a]=d,{stack:e,id:a,glyph:d};const g=Math.floor(a/256);if(256*g>65535)throw new Error("glyphs > 65535 not supported");if(l.ranges[g])return{stack:e,id:a,glyph:d};if(!this.url)throw new Error("glyphsUrl is not set");if(!l.requests[g]){const S=jn.loadGlyphRange(e,g,this.url,this.requestManager);l.requests[g]=S}const _=yield l.requests[g];for(const S in _)this._doesCharSupportLocalGlyph(+S)||(l.glyphs[+S]=_[+S]);return l.ranges[g]=!0,{stack:e,id:a,glyph:_[a]||null}}))}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))||c.u["CJK Unified Ideographs"](e)||c.u["Hangul Syllables"](e)||c.u.Hiragana(e)||c.u.Katakana(e)||c.u["CJK Symbols and Punctuation"](e)||c.u["Halfwidth and Fullwidth Forms"](e))}_tinySDF(e,a,l){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(l))return;let g=e.tinySDF;if(!g){let S="400";/bold/i.test(a)?S="900":/medium/i.test(a)?S="500":/light/i.test(a)&&(S="200"),g=e.tinySDF=new jn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,lang:this.lang,fontFamily:d,fontWeight:S})}const _=g.draw(String.fromCharCode(l));return{id:l,bitmap:new c.q({width:_.width||60,height:_.height||60},_.data),metrics:{width:_.glyphWidth/2||24,height:_.glyphHeight/2||24,left:_.glyphLeft/2+.5||0,top:_.glyphTop/2-27.5||-8,advance:_.glyphAdvance/2||24,isDoubleResolution:!0}}}}jn.loadGlyphRange=function(f,e,a,l){return c._(this,void 0,void 0,(function*(){const d=256*e,g=d+255,_=l.transformRequest(a.replace("{fontstack}",f).replace("{range}",`${d}-${g}`),"Glyphs"),S=yield c.n(_,new AbortController);if(!S||!S.data)throw new Error(`Could not load glyph range. range: ${e}, ${d}-${g}`);const P={};for(const E of c.o(S.data))P[E.id]=E;return P}))},jn.TinySDF=class{constructor({fontSize:f=24,buffer:e=3,radius:a=8,cutoff:l=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:_="normal",lang:S=null}={}){this.buffer=e,this.cutoff=l,this.radius=a,this.lang=S;const P=this.size=f+4*e,E=this._createCanvas(P),I=this.ctx=E.getContext("2d",{willReadFrequently:!0});I.font=`${_} ${g} ${f}px ${d}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(P*P),this.gridInner=new Float64Array(P*P),this.f=new Float64Array(P),this.z=new Float64Array(P+1),this.v=new Uint16Array(P)}_createCanvas(f){const e=document.createElement("canvas");return e.width=e.height=f,e}draw(f){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:l,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(f),_=Math.ceil(a),S=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),P=Math.min(this.size-this.buffer,_+Math.ceil(l)),E=S+2*this.buffer,I=P+2*this.buffer,O=Math.max(E*I,0),k=new Uint8ClampedArray(O),N={data:k,width:E,height:I,glyphWidth:S,glyphHeight:P,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(S===0||P===0)return N;const{ctx:W,buffer:J,gridInner:ee,gridOuter:te}=this;this.lang&&(W.lang=this.lang),W.clearRect(J,J,S,P),W.fillText(f,J,J+_);const ie=W.getImageData(J,J,S,P);te.fill(cn,0,O),ee.fill(0,0,O);for(let le=0;le<P;le++)for(let ae=0;ae<S;ae++){const ue=ie.data[4*(le*S+ae)+3]/255;if(ue===0)continue;const me=(le+J)*E+ae+J;if(ue===1)te[me]=0,ee[me]=cn;else{const oe=.5-ue;te[me]=oe>0?oe*oe:0,ee[me]=oe<0?oe*oe:0}}nn(te,0,0,E,I,E,this.f,this.v,this.z),nn(ee,J,J,S,P,E,this.f,this.v,this.z);for(let le=0;le<O;le++){const ae=Math.sqrt(te[le])-Math.sqrt(ee[le]);k[le]=Math.round(255-255*(ae/this.radius+this.cutoff))}return N}};class er{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,a){return c.B(e.expression.evaluate(a))}interpolate(e,a,l){return{x:c.C.number(e.x,a.x,l),y:c.C.number(e.y,a.y,l),z:c.C.number(e.z,a.z,l)}}}let mn;class We extends c.E{constructor(e){super(),mn=mn||new c.r({anchor:new c.D(c.v.light.anchor),position:new er,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.t(mn,void 0),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(c.x,e,a))for(const l in e){const d=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),d):this._transitionable.setValue(l,d)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l){return(!l||l.validate!==!1)&&c.y(this,e.call(c.z,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const mt=new c.r({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class rt extends c.E{constructor(e){super(),this._transitionable=new c.t(mt,void 0),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0))}setSky(e,a={}){if(!this._validate(c.G,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const l in e){const d=e[l];l.endsWith("-transition")?this._transitionable.setTransition(l.slice(0,-11),d):this._transitionable.setValue(l,d)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,l={}){return l?.validate!==!1&&c.y(this,e.call(c.z,c.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Et{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){const l=e.join(",")+String(a);return this.dashEntry[l]||(this.dashEntry[l]=this.addDash(e,a)),this.dashEntry[l]}getDashRanges(e,a,l){const d=[];let g=e.length%2==1?-e[e.length-1]*l:0,_=e[0]*l,S=!0;d.push({left:g,right:_,isDash:S,zeroLength:e[0]===0});let P=e[0];for(let E=1;E<e.length;E++){S=!S;const I=e[E];g=P*l,P+=I,_=P*l,d.push({left:g,right:_,isDash:S,zeroLength:I===0})}return d}addRoundDash(e,a,l){const d=a/2;for(let g=-l;g<=l;g++){const _=this.width*(this.nextRow+l+g);let S=0,P=e[S];for(let E=0;E<this.width;E++){E/P.right>1&&(P=e[++S]);const I=Math.abs(E-P.left),O=Math.abs(E-P.right),k=Math.min(I,O);let N;const W=g/l*(d+1);if(P.isDash){const J=d-Math.abs(W);N=Math.sqrt(k*k+J*J)}else N=d-Math.sqrt(k*k+W*W);this.data[_+E]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(e){for(let S=e.length-1;S>=0;--S){const P=e[S],E=e[S+1];P.zeroLength?e.splice(S,1):E&&E.isDash===P.isDash&&(E.left=P.left,e.splice(S,1))}const a=e[0],l=e[e.length-1];a.isDash===l.isDash&&(a.left=l.left-this.width,l.right=a.right+this.width);const d=this.width*this.nextRow;let g=0,_=e[g];for(let S=0;S<this.width;S++){S/_.right>1&&(_=e[++g]);const P=Math.abs(S-_.left),E=Math.abs(S-_.right),I=Math.min(P,E);this.data[d+S]=Math.max(0,Math.min(255,(_.isDash?I:-I)+128))}}addDash(e,a){const l=a?7:0,d=2*l+1;if(this.nextRow+d>this.height)return c.w("LineAtlas out of space"),null;let g=0;for(let S=0;S<e.length;S++)g+=e[S];if(g!==0){const S=this.width/g,P=this.getDashRanges(e,this.width,S);a?this.addRoundDash(P,S,l):this.addRegularDash(P)}const _={y:(this.nextRow+l+.5)/this.height,height:2*l/this.height,width:g};return this.nextRow+=d,this.dirty=!0,_}bind(e){const a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}const ve="maplibre_preloaded_worker_pool";class Xe{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Xe.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach((a=>{a.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[ve]}numActive(){return Object.keys(this.active).length}}const vt=Math.floor(ge.hardwareConcurrency/2);let st,xt;function Kt(){return st||(st=new Xe),st}Xe.workerCount=c.H(globalThis)?Math.max(Math.min(vt,3),1):1;class It{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;const l=this.workerPool.acquire(a);for(let d=0;d<l.length;d++){const g=new c.J(l[d],a);g.name=`Worker ${d}`,this.actors.push(g)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){const l=[];for(const d of this.actors)l.push(d.sendAsync({type:e,data:a}));return Promise.all(l)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach((a=>{a.remove()})),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(const l of this.actors)l.registerMessageHandler(e,a)}}function Zt(){return xt||(xt=new It(Kt(),c.K),xt.registerMessageHandler("GR",((f,e,a)=>c.m(e,a)))),xt}function Ht(f,e){const a=c.L();return c.M(a,a,[1,1,0]),c.N(a,a,[.5*f.width,.5*f.height,1]),f.calculatePosMatrix?c.O(a,a,f.calculatePosMatrix(e.toUnwrapped())):a}function En(f,e,a,l,d,g,_){var S;const P=(function(k,N,W){if(k)for(const J of k){const ee=N[J];if(ee&&ee.source===W&&ee.type==="fill-extrusion")return!0}else for(const J in N){const ee=N[J];if(ee.source===W&&ee.type==="fill-extrusion")return!0}return!1})((S=d?.layers)!==null&&S!==void 0?S:null,e,f.id),E=g.maxPitchScaleFactor(),I=f.tilesIn(l,E,P);I.sort(tr);const O=[];for(const k of I)O.push({wrappedTileID:k.tileID.wrapped().key,queryResults:k.tile.queryRenderedFeatures(e,a,f._state,k.queryGeometry,k.cameraQueryGeometry,k.scale,d,g,E,Ht(f.transform,k.tileID),_?(N,W)=>_(k.tileID,N,W):void 0)});return(function(k,N){for(const W in k)for(const J of k[W])xn(J,N);return k})((function(k){const N={},W={};for(const J of k){const ee=J.queryResults,te=J.wrappedTileID,ie=W[te]=W[te]||{};for(const le in ee){const ae=ee[le],ue=ie[le]=ie[le]||{},me=N[le]=N[le]||[];for(const oe of ae)ue[oe.featureIndex]||(ue[oe.featureIndex]=!0,me.push(oe))}}return N})(O),f)}function tr(f,e){const a=f.tileID,l=e.tileID;return a.overscaledZ-l.overscaledZ||a.canonical.y-l.canonical.y||a.wrap-l.wrap||a.canonical.x-l.canonical.x}function xn(f,e){const a=f.feature,l=e.getFeatureState(a.layer["source-layer"],a.id);a.source=a.layer.source,a.layer["source-layer"]&&(a.sourceLayer=a.layer["source-layer"]),a.state=l}function St(f,e,a){return c._(this,void 0,void 0,(function*(){let l=f;if(f.url?l=(yield c.j(e.transformRequest(f.url,"Source"),a)).data:yield ge.frameAsync(a),!l)return null;const d=c.Q(c.e(l,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in l&&l.vector_layers&&(d.vectorLayerIds=l.vector_layers.map((g=>g.id))),d}))}class qt{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.S?new c.S(e.lng,e.lat):c.S.convert(e),this}extend(e){const a=this._sw,l=this._ne;let d,g;if(e instanceof c.S)d=e,g=e;else{if(!(e instanceof qt))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(qt.convert(e)):this.extend(c.S.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.S.convert(e)):this;if(d=e._sw,g=e._ne,!d||!g)return this}return a||l?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),l.lng=Math.max(g.lng,l.lng),l.lat=Math.max(g.lat,l.lat)):(this._sw=new c.S(d.lng,d.lat),this._ne=new c.S(g.lng,g.lat)),this}getCenter(){return new c.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.S(this.getWest(),this.getNorth())}getSouthEast(){return new c.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:l}=c.S.convert(e);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=l&&l<=this._ne.lat&&d}static convert(e){return e instanceof qt?e:e&&new qt(e)}static fromLngLat(e,a=0){const l=360*a/40075017,d=l/Math.cos(Math.PI/180*e.lat);return new qt(new c.S(e.lng-d,e.lat-l),new c.S(e.lng+d,e.lat+l))}adjustAntiMeridian(){const e=new c.S(this._sw.lng,this._sw.lat),a=new c.S(this._ne.lng,this._ne.lat);return new qt(e,e.lng>a.lng?new c.S(a.lng+360,a.lat):a)}}class un{constructor(e,a,l){this.bounds=qt.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=l||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const a=Math.pow(2,e.z),l=Math.floor(c.V(this.bounds.getWest())*a),d=Math.floor(c.U(this.bounds.getNorth())*a),g=Math.ceil(c.V(this.bounds.getEast())*a),_=Math.ceil(c.U(this.bounds.getSouth())*a);return e.x>=l&&e.x<g&&e.y>=d&&e.y<_}}class qn extends c.E{constructor(e,a,l,d){if(super(),this.id=e,this.dispatcher=l,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.Q(a,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield St(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new un(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(e))}}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};l.request.collectResourceTiming=this._collectResourceTiming;let d="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise(((g,_)=>{e.reloadPromise={resolve:g,reject:_}}))}else e.actor=this.dispatcher.getActor(),d="LT";e.abortController=new AbortController;try{const g=yield e.actor.sendAsync({type:d,data:l},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,g)}catch(g){if(delete e.abortController,e.aborted)return;if(g&&g.status!==404)throw g;this._afterTileLoadWorkerResponse(e,null)}}))}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){const l=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(l.resolve).catch(l.reject)}}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))}))}hasTransition(){return!1}}class Ar extends c.E{constructor(e,a,l,d){super(),this.id=e,this.dispatcher=l,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},a),c.e(this,c.Q(a,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,(function*(e=!1){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const a=yield St(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,a&&(c.e(this,a),a.bounds&&(this.tileBounds=new un(a.bounds,this.minzoom,this.maxzoom)),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(a){this._tileJSONRequest=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty((()=>{this._options.tiles=e})),this}setUrl(e){return this.setSourceProperty((()=>{this.url=e,this._options.url=e})),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const l=yield it.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(l&&l.data){this.map._refreshExpiredTiles&&(l.cacheControl||l.expires)&&e.setExpiryData({cacheControl:l.cacheControl,expires:l.expires});const d=this.map.painter.context,g=d.gl,_=l.data;e.texture=this.map.painter.getTileTexture(_.width),e.texture?e.texture.update(_,{useMipmap:!0}):(e.texture=new c.T(d,_,g.RGBA,{useMipmap:!0}),e.texture.bind(g.LINEAR,g.CLAMP_TO_EDGE,g.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(l){if(delete e.abortController,e.aborted)e.state="unloaded";else if(l)throw e.state="errored",l}}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)}))}hasTransition(){return!1}}class nr extends Ar{constructor(e,a,l,d){super(e,a,l,d),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),l=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const d=yield it.getImage(l,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(d&&d.data){const g=d.data;this.map._refreshExpiredTiles&&(d.cacheControl||d.expires)&&e.setExpiryData({cacheControl:d.cacheControl,expires:d.expires});const _=c.b(g)&&c.W()?g:yield this.readImageNow(g),S={type:this.type,uid:e.uid,source:this.id,rawImageData:_,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const P=yield e.actor.sendAsync({type:"LDT",data:S});e.dem=P,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(d){if(delete e.abortController,e.aborted)e.state="unloaded";else if(d)throw e.state="errored",d}}))}readImageNow(e){return c._(this,void 0,void 0,(function*(){if(typeof VideoFrame<"u"&&c.X()){const a=e.width+2,l=e.height+2;try{return new c.R({width:a,height:l},yield c.Y(e,-1,-1,a,l))}catch{}}return ge.getImageData(e,1)}))}_getNeighboringTiles(e){const a=e.canonical,l=Math.pow(2,a.z),d=(a.x-1+l)%l,g=a.x===0?e.wrap-1:e.wrap,_=(a.x+1+l)%l,S=a.x+1===l?e.wrap+1:e.wrap,P={};return P[new c.Z(e.overscaledZ,g,a.z,d,a.y).key]={backfilled:!1},P[new c.Z(e.overscaledZ,S,a.z,_,a.y).key]={backfilled:!1},a.y>0&&(P[new c.Z(e.overscaledZ,g,a.z,d,a.y-1).key]={backfilled:!1},P[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},P[new c.Z(e.overscaledZ,S,a.z,_,a.y-1).key]={backfilled:!1}),a.y+1<l&&(P[new c.Z(e.overscaledZ,g,a.z,d,a.y+1).key]={backfilled:!1},P[new c.Z(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},P[new c.Z(e.overscaledZ,S,a.z,_,a.y+1).key]={backfilled:!1}),P}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))}))}}class Kr extends c.E{constructor(e,a,l,d){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:a.data},this.actor=l.getActor(),this.setEventedParent(d),this._data=a.data,this._options=c.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId,a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(a.buffer!==void 0?a.buffer:128),tolerance:this._pixelsToTileUnits(a.tolerance!==void 0?a.tolerance:.375),extent:c.$,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(a.clusterMaxZoom),minPoints:Math.max(2,a.clusterMinPoints||2),extent:c.$,radius:this._pixelsToTileUnits(a.clusterRadius||50),log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.$/this.tileSize)}_getClusterMaxZoom(e){const a=e?Math.round(e):this.maxzoom-1;return Number.isInteger(e)||e===void 0||c.w(`Integer expected for option 'clusterMaxZoom': provided value "${e}" rounded to "${a}"`),a}load(){return c._(this,void 0,void 0,(function*(){yield this._updateWorkerData()}))}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._pendingWorkerUpdate={data:e},this._updateWorkerData(),this}updateData(e){return this._pendingWorkerUpdate.diff=c.a0(this._pendingWorkerUpdate.diff,e),this._updateWorkerData(),this}getData(){return c._(this,void 0,void 0,(function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})}))}getCoordinatesFromGeometry(e){return e.type==="GeometryCollection"?e.geometries.map((a=>a.coordinates)).flat(1/0):e.coordinates.flat(1/0)}getBounds(){return c._(this,void 0,void 0,(function*(){const e=new qt,a=yield this.getData();let l;switch(a.type){case"FeatureCollection":l=a.features.map((d=>this.getCoordinatesFromGeometry(d.geometry))).flat(1/0);break;case"Feature":l=this.getCoordinatesFromGeometry(a.geometry);break;default:l=this.getCoordinatesFromGeometry(a)}if(l.length==0)return e;for(let d=0;d<l.length-1;d+=2)e.extend([l[d],l[d+1]]);return e}))}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(e.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,l){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:l}})}_updateWorkerData(){return c._(this,void 0,void 0,(function*(){if(this._isUpdatingWorker)return;const{data:e,diff:a}=this._pendingWorkerUpdate;if(!e&&!a)return void c.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const l=c.e({type:this.type},this.workerOptions);e?(typeof e=="string"?(l.request=this.map._requestManager.transformRequest(ge.resolveURL(e),"Source"),l.request.collectResourceTiming=this._collectResourceTiming):l.data=JSON.stringify(e),this._pendingWorkerUpdate.data=void 0):a&&(l.dataDiff=a,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new c.l("dataloading",{dataType:"source"}));try{const d=yield this.actor.sendAsync({type:"LD",data:l});if(this._isUpdatingWorker=!1,this._removed||d.abandoned)return void this.fire(new c.l("dataabort",{dataType:"source"}));this._data=d.data;let g=null;d.resourceTiming&&d.resourceTiming[this.id]&&(g=d.resourceTiming[this.id].slice(0));const _={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&c.e(_,{resourceTiming:g}),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"metadata"}))),this.fire(new c.l("data",Object.assign(Object.assign({},_),{sourceDataType:"content"})))}catch(d){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new c.l("dataabort",{dataType:"source"}));this.fire(new c.k(d))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}}))}loaded(){return!this._isUpdatingWorker&&this._pendingWorkerUpdate.data===void 0&&this._pendingWorkerUpdate.diff===void 0}loadTile(e){return c._(this,void 0,void 0,(function*(){const a=e.actor?"RT":"LT";e.actor=this.actor;const l={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const d=yield this.actor.sendAsync({type:a,data:l},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(d,this.map.painter,a==="RT")}))}abortTile(e){return c._(this,void 0,void 0,(function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}))}unloadTile(e){return c._(this,void 0,void 0,(function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}))}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Br extends c.E{constructor(e,a,l,d){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=l,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=a}load(e){return c._(this,void 0,void 0,(function*(){this._loaded=!1,this.fire(new c.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const a=yield it.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new c.k(a))}}))}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally((()=>{this.texture=null})),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const a=e.map(c.a1.fromLngLat);var l;return this.tileID=(function(d){const g=c.a2.fromPoints(d),_=g.width(),S=g.height(),P=Math.max(_,S),E=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),I=Math.pow(2,E);return new c.a4(E,Math.floor((g.minX+g.maxX)/2*I),Math.floor((g.minY+g.maxY)/2*I))})(a),this.terrainTileRanges=this._getOverlappingTileRanges(a),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=a.map((d=>this.tileID.getTilePoint(d)._round())),this.flippedWindingOrder=((l=this.tileCoords)[1].x-l[0].x)*(l[2].y-l[0].y)-(l[1].y-l[0].y)*(l[2].x-l[0].x)<0,this.fire(new c.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,a=e.gl;this.texture||(this.texture=new c.T(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,(function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(e){const{minX:a,minY:l,maxX:d,maxY:g}=c.a2.fromPoints(e),_={};for(let S=0;S<=c.a3;S++){const P=Math.pow(2,S),E=Math.floor(a*P),I=Math.floor(l*P),O=Math.floor(d*P),k=Math.floor(g*P);_[S]={minTileX:E,minTileY:I,maxTileX:O,maxTileY:k}}return _}}class Mi extends Br{constructor(e,a,l,d){super(e,a,l,d),this.roundZoom=!0,this.type="video",this.options=a}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{const a=yield c.a5(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new c.k(a))}}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new c.k(new c.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,a=e.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new c.T(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let l=!1;for(const d in this.tiles){const g=this.tiles[d];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture,l=!0)}l&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class oi extends Br{constructor(e,a,l,d){super(e,a,l,d),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some((g=>!Array.isArray(g)||g.length!==2||g.some((_=>typeof _!="number"))))||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new c.k(new c.a6(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new c.k(new c.a6(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.k(new c.a6(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return c._(this,void 0,void 0,(function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}))}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const a=this.map.painter.context,l=a.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.T(a,this.canvas,l.RGBA,{premultiply:!0});let d=!1;for(const g in this.tiles){const _=this.tiles[g];_.state!=="loaded"&&(_.state="loaded",_.texture=this.texture,d=!0)}d&&this.fire(new c.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ya={},ra=f=>{switch(f){case"geojson":return Kr;case"image":return Br;case"raster":return Ar;case"raster-dem":return nr;case"vector":return qn;case"video":return Mi;case"canvas":return oi}return ya[f]},qa="RTLPluginLoaded";class Aa extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=Zt()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch((a=>{throw this.status="error",a}))}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,(function*(a,l=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=ge.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!l)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()}))}_requestImport(){return c._(this,void 0,void 0,(function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.l(qa))}))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Wi=null;function gr(){return Wi||(Wi=new Aa),Wi}class Ri{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a7(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,l){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(d,g){const _={};if(!g)return _;for(const S of d){const P=S.layerIds.map((E=>g.getLayer(E))).filter(Boolean);if(P.length!==0){S.layers=P,S.stateDependentLayerIds&&(S.stateDependentLayers=S.stateDependentLayerIds.map((E=>P.filter((I=>I.id===E))[0])));for(const E of P)_[E.id]=S}}return _})(e.buckets,a?.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a9){if(this.hasSymbolBuckets=!0,!l)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof c.a9&&g.hasRTLText){this.hasRTLText=!0,gr().lazyLoad();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(g))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a8}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const l in this.buckets){const d=this.buckets[l];d.uploadPending()&&d.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new c.T(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new c.T(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,l,d,g,_,S,P,E,I,O){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:g,scale:_,tileSize:this.tileSize,pixelPosMatrix:I,transform:P,params:S,queryPadding:this.queryPadding*E,getElevation:O},e,a,l):{}}querySourceFeatures(e,a){const l=this.latestFeatureIndex;if(!l||!l.rawTileData)return;const d=l.loadVTLayers(),g=a&&a.sourceLayer?a.sourceLayer:"",_=d._geojsonTileLayer||d[g];if(!_)return;const S=c.aa(a?.filter,a?.globalState),{z:P,x:E,y:I}=this.tileID.canonical,O={z:P,x:E,y:I};for(let k=0;k<_.length;k++){const N=_.feature(k);if(S.needGeometry){const ee=c.ab(N,!0);if(!S.filter(new c.F(this.tileID.overscaledZ),ee,this.tileID.canonical))continue}else if(!S.filter(new c.F(this.tileID.overscaledZ),N))continue;const W=l.getId(N,g),J=new c.ac(N,P,E,I,W);J.tile=O,e.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const l=c.ad(e.cacheControl);l["max-age"]&&(this.expirationTime=Date.now()+1e3*l["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const l=Date.now();let d=!1;if(this.expirationTime>l)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const g=this.expirationTime-a;g?this.expirationTime=l+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const l=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!a.style.hasLayer(d))continue;const g=this.buckets[d],_=g.layers[0].sourceLayer||"_geojsonTileLayer",S=l[_],P=e[_];if(!S||!P||Object.keys(P).length===0)continue;g.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=a&&a.style&&a.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ge.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ge.now()+e}setDependencies(e,a){const l={};for(const d of a)l[d]=!0;this.dependencies[e]=l}hasDependency(e,a){for(const l of e){const d=this.dependencies[l];if(d){for(const g of a)if(d[g])return!0}}return!1}}class xe{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,l){const d=e.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:a,timeout:void 0};if(l!==void 0&&(g.timeout=setTimeout((()=>{this.remove(e,g)}),l)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const l=e.wrapped().key,d=a===void 0?0:this.data[l].indexOf(a),g=this.data[l][d];return this.data[l].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[l].length===0&&delete this.data[l],this.onRemove(g.value),this.order.splice(this.order.indexOf(l),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const l in this.data)for(const d of this.data[l])e(d.value)||a.push(d);for(const l of a)this.remove(l.value.tileID,l)}}class Z{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,l){const d=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][d]=this.stateChanges[e][d]||{},c.e(this.stateChanges[e][d],l),this.deletedStates[e]===null){this.deletedStates[e]={};for(const g in this.state[e])g!==d&&(this.deletedStates[e][g]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][d]===null){this.deletedStates[e][d]={};for(const g in this.state[e][d])l[g]||(this.deletedStates[e][d][g]=null)}else for(const g in l)this.deletedStates[e]&&this.deletedStates[e][d]&&this.deletedStates[e][d][g]===null&&delete this.deletedStates[e][d][g]}removeFeatureState(e,a,l){if(this.deletedStates[e]===null)return;const d=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},l&&a!==void 0)this.deletedStates[e][d]!==null&&(this.deletedStates[e][d]=this.deletedStates[e][d]||{},this.deletedStates[e][d][l]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][d])for(l in this.deletedStates[e][d]={},this.stateChanges[e][d])this.deletedStates[e][d][l]=null;else this.deletedStates[e][d]=null;else this.deletedStates[e]=null}getState(e,a){const l=String(a),d=c.e({},(this.state[e]||{})[l],(this.stateChanges[e]||{})[l]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const g=this.deletedStates[e][a];if(g===null)return{};for(const _ in g)delete d[_]}return d}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const l={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const _ in this.stateChanges[d])this.state[d][_]||(this.state[d][_]={}),c.e(this.state[d][_],this.stateChanges[d][_]),g[_]=this.state[d][_];l[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(this.deletedStates[d]===null)for(const _ in this.state[d])g[_]={},this.state[d][_]={};else for(const _ in this.deletedStates[d]){if(this.deletedStates[d][_]===null)this.state[d][_]={};else for(const S of Object.keys(this.deletedStates[d][_]))delete this.state[d][_][S];g[_]=this.state[d][_]}l[d]=l[d]||{},c.e(l[d],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(l).length!==0)for(const d in e)e[d].setFeatureState(l,a)}}const q=89.25;function K(f,e){const a=c.ah(e.lat,-c.ai,c.ai);return new c.P(c.V(e.lng)*f,c.U(a)*f)}function se(f,e){return new c.a1(e.x/f,e.y/f).toLngLat()}function de(f){return f.cameraToCenterDistance*Math.min(.85*Math.tan(c.ae(90-f.pitch)),Math.tan(c.ae(q-f.pitch)))}function be(f,e){const a=f.canonical,l=e/c.af(a.z),d=a.x+Math.pow(2,a.z)*f.wrap,g=c.ag(new Float64Array(16));return c.M(g,g,[d*l,a.y*l,0]),c.N(g,g,[l/c.$,l/c.$,1]),g}function Be(f,e,a,l,d){const g=c.a1.fromLngLat(f,e),_=d*c.aj(1,f.lat),S=_*Math.cos(c.ae(a)),P=Math.sqrt(_*_-S*S),E=P*Math.sin(c.ae(-l)),I=P*Math.cos(c.ae(-l));return new c.a1(g.x+E,g.y+I,g.z+S)}function Pe(f,e,a){const l=e.intersectsFrustum(f);if(!a||l===0)return l;const d=e.intersectsPlane(a);return d===0?0:l===2&&d===2?2:1}function qe(f,e,a){let l=0;const d=(a-e)/10;for(let g=0;g<10;g++)l+=d*Math.pow(Math.cos(e+(g+.5)/10*(a-e)),f);return l}function nt(f,e){return function(a,l,d,g,_){const S=2*((f-1)/c.ak(Math.cos(c.ae(q-_))/Math.cos(c.ae(q)))-1),P=Math.acos(d/g),E=2*qe(S-1,0,c.ae(_/2)),I=Math.min(c.ae(q),P+c.ae(_/2)),O=qe(S-1,Math.min(I,P-c.ae(_/2)),I),k=Math.atan(l/d),N=Math.hypot(l,d);let W=a;return W+=c.ak(g/N/Math.max(.5,Math.cos(c.ae(_/2)))),W+=S*c.ak(Math.cos(k))/2,W-=c.ak(Math.max(1,O/E/e))/2,W}}const Ye=nt(9.314,3);function Pt(f,e){const a=(e.roundZoom?Math.round:Math.floor)(f.zoom+c.ak(f.tileSize/e.tileSize));return Math.max(0,a)}function Ce(f,e){const a=f.getCameraFrustum(),l=f.getClippingPlane(),d=f.screenPointToMercatorCoordinate(f.getCameraPoint()),g=c.a1.fromLngLat(f.center,f.elevation);d.z=g.z+Math.cos(f.pitchInRadians)*f.cameraToCenterDistance/f.worldSize;const _=f.getCoveringTilesDetailsProvider(),S=_.allowVariableZoom(f,e),P=Pt(f,e),E=e.minzoom||0,I=e.maxzoom!==void 0?e.maxzoom:f.maxZoom,O=Math.min(Math.max(0,P),I),k=Math.pow(2,O),N=[k*d.x,k*d.y,0],W=[k*g.x,k*g.y,0],J=Math.hypot(g.x-d.x,g.y-d.y),ee=Math.abs(g.z-d.z),te=Math.hypot(J,ee),ie=ue=>({zoom:0,x:0,y:0,wrap:ue,fullyVisible:!1}),le=[],ae=[];if(f.renderWorldCopies&&_.allowWorldCopies())for(let ue=1;ue<=3;ue++)le.push(ie(-ue)),le.push(ie(ue));for(le.push(ie(0));le.length>0;){const ue=le.pop(),me=ue.x,oe=ue.y;let Se=ue.fullyVisible;const Ue={x:me,y:oe,z:ue.zoom},Ie=_.getTileBoundingVolume(Ue,ue.wrap,f.elevation,e);if(!Se){const ht=Pe(a,Ie,l);if(ht===0)continue;Se=ht===2}const Oe=_.distanceToTile2d(d.x,d.y,Ue,Ie);let je=P;S&&(je=(e.calculateTileZoom||Ye)(f.zoom+c.ak(f.tileSize/e.tileSize),Oe,ee,te,f.fov)),je=(e.roundZoom?Math.round:Math.floor)(je),je=Math.max(0,je);const pt=Math.min(je,I);if(ue.wrap=_.getWrap(g,Ue,ue.wrap),ue.zoom>=pt){if(ue.zoom<E)continue;const ht=O-ue.zoom,Ke=N[0]-.5-(me<<ht),Tt=N[1]-.5-(oe<<ht),ln=e.reparseOverscaled?Math.max(ue.zoom,je):ue.zoom;ae.push({tileID:new c.Z(ue.zoom===I?ln:ue.zoom,ue.wrap,ue.zoom,me,oe),distanceSq:c.al([W[0]-.5-me,W[1]-.5-oe]),tileDistanceToCamera:Math.sqrt(Ke*Ke+Tt*Tt)})}else for(let ht=0;ht<4;ht++)le.push({zoom:ue.zoom+1,x:(me<<1)+ht%2,y:(oe<<1)+(ht>>1),wrap:ue.wrap,fullyVisible:Se})}return ae.sort(((ue,me)=>ue.distanceSq-me.distanceSq)).map((ue=>ue.tileID))}const Gt=c.a2.fromPoints([new c.P(0,0),new c.P(c.$,c.$)]);class dn extends c.E{constructor(e,a,l){super(),this.id=e,this.dispatcher=l,this.on("data",(d=>this._dataHandler(d))),this.on("dataloading",(()=>{this._sourceErrored=!1})),this.on("error",(()=>{this._sourceErrored=this._source.loaded()})),this._source=((d,g,_,S)=>{const P=new(ra(g.type))(d,g,_,S);if(P.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${P.id}`);return P})(e,a,l,this),this._tiles={},this._cache=new xe(0,(d=>this._unloadTile(d))),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Z,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,l){return c._(this,void 0,void 0,(function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,l)}catch(d){e.state="errored",d.status!==404?this._source.fire(new c.k(d,{tile:e})):this.update(this.transform,this.terrain)}}))}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.l("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const l=this._tiles[a];l.upload(e),l.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map((e=>e.tileID)).sort(Rt).map((e=>e.key))}getRenderableIds(e){const a=[];for(const l in this._tiles)this._isIdRenderable(l,e)&&a.push(this._tiles[l]);return e?a.sort(((l,d)=>{const g=l.tileID,_=d.tileID,S=new c.P(g.canonical.x,g.canonical.y)._rotate(-this.transform.bearingInRadians),P=new c.P(_.canonical.x,_.canonical.y)._rotate(-this.transform.bearingInRadians);return g.overscaledZ-_.overscaledZ||P.y-S.y||P.x-S.x})).map((l=>l.tileID.key)):a.map((l=>l.tileID)).sort(Rt).map((l=>l.key))}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const a in this._tiles)e?this._reloadTile(a,"expired"):this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")}}_reloadTile(e,a){return c._(this,void 0,void 0,(function*(){const l=this._tiles[e];l&&(l.state!=="loading"&&(l.state=a),yield this._loadTile(l,e,a))}))}_tileLoaded(e,a,l){e.timeAdded=ge.now(),l==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.l("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const g=a[d];if(e.neighboringTiles&&e.neighboringTiles[g]){const _=this.getTileByID(g);l(e,_),l(_,e)}}function l(d,g){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let _=g.tileID.canonical.x-d.tileID.canonical.x;const S=g.tileID.canonical.y-d.tileID.canonical.y,P=Math.pow(2,d.tileID.canonical.z),E=g.tileID.key;_===0&&S===0||Math.abs(S)>1||(Math.abs(_)>1&&(Math.abs(_+P)===1?_+=P:Math.abs(_-P)===1&&(_-=P)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,_,S),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a){const l=Object.values(e),d=this._getLoadedDescendents(l);for(const g of l){const _=d[g.key];if(!_)continue;const S=g.overscaledZ+dn.maxUnderzooming;let P=1/0;for(const E of _){const I=E.tileID.overscaledZ;I<=S&&I<P&&(P=I)}if(P!==1/0)for(const E of _)E.tileID.overscaledZ===P&&(a[E.tileID.key]=E.tileID)}}_getLoadedDescendents(e){var a;const l={};for(const d in this._tiles){const g=this._tiles[d];if(g.hasData())for(const _ of e)g.tileID.isChildOf(_)&&(l[a=_.key]||(l[a]=[])).push(g)}return l}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const l=this._loadedParentTiles[e.key];return l&&l.tileID.overscaledZ>=a?l:null}for(let l=e.overscaledZ-1;l>=a;l--){const d=e.scaledTo(l),g=this._getLoadedTile(d);if(g)return g}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const a=Math.ceil(e.width/this._source.tileSize)+1,l=Math.ceil(e.height/this._source.tileSize)+1,d=Math.floor(a*l*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(g)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const l={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),l[g.tileID.key]=g}this._tiles=l;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}_updateCoveredAndRetainedTiles(e,a,l,d){const g={},_={},S=Object.keys(e),P=ge.now();for(const E of S){const I=e[E],O=this._tiles[E];if(!O||O.fadeEndTime!==0&&O.fadeEndTime<=P)continue;const k=this.findLoadedParent(I,a),N=this.findLoadedSibling(I),W=k||N||null;W&&(this._addTile(W.tileID),g[W.tileID.key]=W.tileID),_[E]=I}this._retainLoadedChildren(_,e);for(const E in g)e[E]||(this._coveredTiles[E]=!0,e[E]=g[E]);if(d){const E={},I={};for(const O of l)this._tiles[O.key].hasData()?E[O.key]=O:I[O.key]=O;for(const O in I){const k=I[O].children(this._source.maxzoom);this._tiles[k[0].key]&&this._tiles[k[1].key]&&this._tiles[k[2].key]&&this._tiles[k[3].key]&&(E[k[0].key]=e[k[0].key]=k[0],E[k[1].key]=e[k[1].key]=k[1],E[k[2].key]=e[k[2].key]=k[2],E[k[3].key]=e[k[3].key]=k[3],delete I[O])}for(const O in I){const k=I[O],N=this.findLoadedParent(k,this._source.minzoom),W=this.findLoadedSibling(k),J=N||W||null;if(J){E[J.tileID.key]=e[J.tileID.key]=J.tileID;for(const ee in E)E[ee].isChildOf(J.tileID)&&delete E[ee]}}for(const O in this._tiles)E[O]||(this._coveredTiles[O]=!0)}}update(e,a){if(!this._sourceLoaded||this._paused)return;let l;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?l=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((E=>new c.Z(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y))):(l=Ce(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(l=l.filter((E=>this._source.hasTile(E))))):l=[];const d=Pt(e,this._source),g=Math.max(d-dn.maxOverzooming,this._source.minzoom);if(this.usedForTerrain){const E={};for(const I of l)if(I.canonical.z>this._source.minzoom){const O=I.scaledTo(I.canonical.z-1);E[O.key]=O;const k=I.scaledTo(Math.max(this._source.minzoom,Math.min(I.canonical.z,5)));E[k.key]=k}l=l.concat(Object.values(E))}const _=l.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,_&&this.fire(new c.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(l,d);Wt(this._source.type)&&this._updateCoveredAndRetainedTiles(S,g,l,a);for(const E in S)this._tiles[E].clearFadeHold();const P=c.am(this._tiles,S);for(const E of P){const I=this._tiles[E];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(E)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var l;const d={},g={},_=Math.max(a-dn.maxOverzooming,this._source.minzoom),S={};for(const P of e){const E=this._addTile(P);d[P.key]=P,E.hasData()||a<this._source.maxzoom&&(S[P.key]=P)}this._retainLoadedChildren(S,d);for(const P of e){let E=this._tiles[P.key];if(E.hasData())continue;if(a+1>this._source.maxzoom){const O=P.children(this._source.maxzoom)[0],k=this.getTile(O);if(k&&k.hasData()){d[O.key]=O;continue}}else{const O=P.children(this._source.maxzoom);if(O.length===4&&d[O[0].key]&&d[O[1].key]&&d[O[2].key]&&d[O[3].key]||O.length===1&&d[O[0].key])continue}let I=E.wasRequested();for(let O=P.overscaledZ-1;O>=_;--O){const k=P.scaledTo(O);if(g[k.key])break;if(g[k.key]=!0,E=this.getTile(k),!E&&I&&(E=this._addTile(k)),E){const N=E.hasData();if((N||!(!((l=this.map)===null||l===void 0)&&l.cancelPendingTileRequestsWhileZooming)||I)&&(d[k.key]=k),I=E.wasRequested(),N)break}}}return d}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let l,d=this._tiles[e].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){l=this._loadedParentTiles[d.key];break}a.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(l=this._getLoadedTile(g),l)break;d=g}for(const g of a)this._loadedParentTiles[g]=l}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const a=this._tiles[e].tileID,l=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=l}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const l=a;return a||(a=new Ri(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,l||this._source.fire(new c.l("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const l=a.getExpiryTimeout();l&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),l))}refreshTiles(e){for(const a in this._tiles)(this._isIdRenderable(a)||this._tiles[a].state=="errored")&&e.some((l=>l.equals(this._tiles[a].tileID.canonical)))&&this._reloadTile(a,"expired")}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){const a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,l){const d=[],g=this.transform;if(!g)return d;const _=g.getCoveringTilesDetailsProvider().allowWorldCopies(),S=l?g.getCameraQueryGeometry(e):e,P=N=>g.screenPointToMercatorCoordinate(N,this.terrain),E=this.transformBbox(e,P,!_),I=this.transformBbox(S,P,!_),O=this.getIds(),k=c.a2.fromPoints(I);for(let N=0;N<O.length;N++){const W=this._tiles[O[N]];if(W.holdingForFade())continue;const J=_?[W.tileID]:[W.tileID.unwrapTo(-1),W.tileID.unwrapTo(0)],ee=Math.pow(2,g.zoom-W.tileID.overscaledZ),te=a*W.queryPadding*c.$/W.tileSize/ee;for(const ie of J){const le=k.map((ae=>ie.getTilePoint(new c.a1(ae.x,ae.y))));if(le.expandBy(te),le.intersects(Gt)){const ae=E.map((me=>ie.getTilePoint(me))),ue=I.map((me=>ie.getTilePoint(me)));d.push({tile:W,tileID:_?ie:ie.unwrapTo(0),queryGeometry:ae,cameraQueryGeometry:ue,scale:ee})}}}return d}transformBbox(e,a,l){let d=e.map(a);if(l){const g=c.a2.fromPoints(e);g.shrinkBy(.001*Math.min(g.width(),g.height()));const _=g.map(a);c.a2.fromPoints(d).covers(_)||(d=d.map((S=>S.x>.5?new c.a1(S.x-1,S.y,S.z):S)))}return d}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((l=>this._tiles[l].tileID));return this.transform&&this.transform.populateCache(a),a}hasTransition(){if(this._source.hasTransition())return!0;if(Wt(this._source.type)){const e=ge.now();for(const a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,l){this._state.updateState(e=e||"_geojsonTileLayer",a,l)}removeFeatureState(e,a,l){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,l)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,l){const d=this._tiles[e];d&&d.setDependencies(a,l)}reloadTilesForDependencies(e,a){for(const l in this._tiles)this._tiles[l].hasDependency(e,a)&&this._reloadTile(l,"reloading");this._cache.filter((l=>!l.hasDependency(e,a)))}}function Rt(f,e){const a=Math.abs(2*f.wrap)-+(f.wrap<0),l=Math.abs(2*e.wrap)-+(e.wrap<0);return f.overscaledZ-e.overscaledZ||l-a||e.canonical.y-f.canonical.y||e.canonical.x-f.canonical.x}function Wt(f){return f==="raster"||f==="image"||f==="video"}dn.maxOverzooming=10,dn.maxUnderzooming=3;class In{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let l=1;l<this.points.length;l++)this._distances[l]=this._distances[l-1]+this.points[l].dist(this.points[l-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ah(e,0,1);let a=1,l=this._distances[a];const d=e*this.paddedLength+this.padding;for(;l<d&&a<this._distances.length;)l=this._distances[++a];const g=a-1,_=this._distances[g],S=l-_,P=S>0?(d-_)/S:0;return this.points[g].mult(1-P).add(this.points[a].mult(P))}}function Fr(f,e){let a=!0;return f==="always"||f!=="never"&&e!=="never"||(a=!1),a}class Vr{constructor(e,a,l){const d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(e/l),this.yCellCount=Math.ceil(a/l);for(let _=0;_<this.xCellCount*this.yCellCount;_++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,l,d,g){this._forEachCell(a,l,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(g)}insertCircle(e,a,l,d){this._forEachCell(a-d,l-d,a+d,l+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(l),this.circles.push(d)}_insertBoxCell(e,a,l,d,g,_){this.boxCells[g].push(_)}_insertCircleCell(e,a,l,d,g,_){this.circleCells[g].push(_)}_query(e,a,l,d,g,_,S){if(l<0||e>this.width||d<0||a>this.height)return[];const P=[];if(e<=0&&a<=0&&this.width<=l&&this.height<=d){if(g)return[{key:null,x1:e,y1:a,x2:l,y2:d}];for(let E=0;E<this.boxKeys.length;E++)P.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const I=this.circles[3*E],O=this.circles[3*E+1],k=this.circles[3*E+2];P.push({key:this.circleKeys[E],x1:I-k,y1:O-k,x2:I+k,y2:O+k})}}else this._forEachCell(e,a,l,d,this._queryCell,P,{hitTest:g,overlapMode:_,seenUids:{box:{},circle:{}}},S);return P}query(e,a,l,d){return this._query(e,a,l,d,!1,null)}hitTest(e,a,l,d,g,_){return this._query(e,a,l,d,!0,g,_).length>0}hitTestCircle(e,a,l,d,g){const _=e-l,S=e+l,P=a-l,E=a+l;if(S<0||_>this.width||E<0||P>this.height)return!1;const I=[];return this._forEachCell(_,P,S,E,this._queryCellCircle,I,{hitTest:!0,overlapMode:d,circle:{x:e,y:a,radius:l},seenUids:{box:{},circle:{}}},g),I.length>0}_queryCell(e,a,l,d,g,_,S,P){const{seenUids:E,hitTest:I,overlapMode:O}=S,k=this.boxCells[g];if(k!==null){const W=this.bboxes;for(const J of k)if(!E.box[J]){E.box[J]=!0;const ee=4*J,te=this.boxKeys[J];if(e<=W[ee+2]&&a<=W[ee+3]&&l>=W[ee+0]&&d>=W[ee+1]&&(!P||P(te))&&(!I||!Fr(O,te.overlapMode))&&(_.push({key:te,x1:W[ee],y1:W[ee+1],x2:W[ee+2],y2:W[ee+3]}),I))return!0}}const N=this.circleCells[g];if(N!==null){const W=this.circles;for(const J of N)if(!E.circle[J]){E.circle[J]=!0;const ee=3*J,te=this.circleKeys[J];if(this._circleAndRectCollide(W[ee],W[ee+1],W[ee+2],e,a,l,d)&&(!P||P(te))&&(!I||!Fr(O,te.overlapMode))){const ie=W[ee],le=W[ee+1],ae=W[ee+2];if(_.push({key:te,x1:ie-ae,y1:le-ae,x2:ie+ae,y2:le+ae}),I)return!0}}}return!1}_queryCellCircle(e,a,l,d,g,_,S,P){const{circle:E,seenUids:I,overlapMode:O}=S,k=this.boxCells[g];if(k!==null){const W=this.bboxes;for(const J of k)if(!I.box[J]){I.box[J]=!0;const ee=4*J,te=this.boxKeys[J];if(this._circleAndRectCollide(E.x,E.y,E.radius,W[ee+0],W[ee+1],W[ee+2],W[ee+3])&&(!P||P(te))&&!Fr(O,te.overlapMode))return _.push(!0),!0}}const N=this.circleCells[g];if(N!==null){const W=this.circles;for(const J of N)if(!I.circle[J]){I.circle[J]=!0;const ee=3*J,te=this.circleKeys[J];if(this._circlesCollide(W[ee],W[ee+1],W[ee+2],E.x,E.y,E.radius)&&(!P||P(te))&&!Fr(O,te.overlapMode))return _.push(!0),!0}}}_forEachCell(e,a,l,d,g,_,S,P){const E=this._convertToXCellCoord(e),I=this._convertToYCellCoord(a),O=this._convertToXCellCoord(l),k=this._convertToYCellCoord(d);for(let N=E;N<=O;N++)for(let W=I;W<=k;W++)if(g.call(this,e,a,l,d,this.xCellCount*W+N,_,S,P))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,l,d,g,_){const S=d-e,P=g-a,E=l+_;return E*E>S*S+P*P}_circleAndRectCollide(e,a,l,d,g,_,S){const P=(_-d)/2,E=Math.abs(e-(d+P));if(E>P+l)return!1;const I=(S-g)/2,O=Math.abs(a-(g+I));if(O>I+l)return!1;if(E<=P||O<=I)return!0;const k=E-P,N=O-I;return k*k+N*N<=l*l}}function Vn(f,e,a){const l=c.L();if(!f){const{vecSouth:O,vecEast:k}=$t(e),N=Y();N[0]=k[0],N[1]=k[1],N[2]=O[0],N[3]=O[1],d=N,(I=(_=(g=N)[0])*(E=g[3])-(P=g[2])*(S=g[1]))&&(d[0]=E*(I=1/I),d[1]=-S*I,d[2]=-P*I,d[3]=_*I),l[0]=N[0],l[1]=N[1],l[4]=N[2],l[5]=N[3]}var d,g,_,S,P,E,I;return c.N(l,l,[1/a,1/a,1]),l}function Ut(f,e,a,l){if(f){const d=c.L();if(!e){const{vecSouth:g,vecEast:_}=$t(a);d[0]=_[0],d[1]=_[1],d[4]=g[0],d[5]=g[1]}return c.N(d,d,[l,l,1]),d}return a.pixelsToClipSpaceMatrix}function $t(f){const e=Math.cos(f.rollInRadians),a=Math.sin(f.rollInRadians),l=Math.cos(f.pitchInRadians),d=Math.cos(f.bearingInRadians),g=Math.sin(f.bearingInRadians),_=c.ar();_[0]=-d*l*a-g*e,_[1]=-g*l*a+d*e;const S=c.as(_);S<1e-9?c.at(_):c.au(_,_,1/S);const P=c.ar();P[0]=d*l*e-g*a,P[1]=g*l*e+d*a;const E=c.as(P);return E<1e-9?c.at(P):c.au(P,P,1/E),{vecEast:P,vecSouth:_}}function lr(f,e,a,l){let d;l?(d=[f,e,l(f,e),1],c.aw(d,d,a)):(d=[f,e,0,1],cs(d,d,a));const g=d[3];return{point:new c.P(d[0]/g,d[1]/g),signedDistanceFromCamera:g,isOccluded:!1}}function lt(f,e){return .5+f/e*.5}function _i(f,e){return f.x>=-e[0]&&f.x<=e[0]&&f.y>=-e[1]&&f.y<=e[1]}function yr(f,e,a,l,d,g,_,S,P,E,I,O,k){const N=a?f.textSizeData:f.iconSizeData,W=c.an(N,e.transform.zoom),J=[256/e.width*2+1,256/e.height*2+1],ee=a?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;ee.clear();const te=f.lineVertexArray,ie=a?f.text.placedSymbolArray:f.icon.placedSymbolArray,le=e.transform.width/e.transform.height;let ae=!1;for(let ue=0;ue<ie.length;ue++){const me=ie.get(ue);if(me.hidden||me.writingMode===c.ao.vertical&&!ae){$a(me.numGlyphs,ee);continue}ae=!1;const oe=new c.P(me.anchorX,me.anchorY),Se={getElevation:k,pitchedLabelPlaneMatrix:l,lineVertexArray:te,pitchWithMap:g,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:oe,unwrappedTileID:P,width:E,height:I,translation:O},Ue=cr(me.anchorX,me.anchorY,Se);if(!_i(Ue.point,J)){$a(me.numGlyphs,ee);continue}const Ie=lt(e.transform.cameraToCenterDistance,Ue.signedDistanceFromCamera),Oe=c.ap(N,W,me),je=g?Oe*e.transform.getPitchedTextCorrection(me.anchorX,me.anchorY,P)/Ie:Oe*Ie,pt=_t({projectionContext:Se,pitchedLabelPlaneMatrixInverse:d,symbol:me,fontSize:je,flip:!1,keepUpright:_,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:le,rotateToLine:S});ae=pt.useVertical,(pt.notEnoughRoom||ae||pt.needsFlipping&&_t({projectionContext:Se,pitchedLabelPlaneMatrixInverse:d,symbol:me,fontSize:je,flip:!0,keepUpright:_,glyphOffsetArray:f.glyphOffsetArray,dynamicLayoutVertexArray:ee,aspectRatio:le,rotateToLine:S}).notEnoughRoom)&&$a(me.numGlyphs,ee)}a?f.text.dynamicLayoutVertexBuffer.updateData(ee):f.icon.dynamicLayoutVertexBuffer.updateData(ee)}function po(f,e,a,l,d,g,_,S){const P=g.glyphStartIndex+g.numGlyphs,E=g.lineStartIndex,I=g.lineStartIndex+g.lineLength,O=e.getoffsetX(g.glyphStartIndex),k=e.getoffsetX(P-1),N=$i(f*O,a,l,d,g.segment,E,I,S,_);if(!N)return null;const W=$i(f*k,a,l,d,g.segment,E,I,S,_);return W?S.projectionCache.anyProjectionOccluded?null:{first:N,last:W}:null}function Wa(f,e,a,l){return f===c.ao.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*l?{useVertical:!0}:(f===c.ao.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function _t(f){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:a,symbol:l,fontSize:d,flip:g,keepUpright:_,glyphOffsetArray:S,dynamicLayoutVertexArray:P,aspectRatio:E,rotateToLine:I}=f,O=d/24,k=l.lineOffsetX*O,N=l.lineOffsetY*O;let W;if(l.numGlyphs>1){const J=l.glyphStartIndex+l.numGlyphs,ee=l.lineStartIndex,te=l.lineStartIndex+l.lineLength,ie=po(O,S,k,N,g,l,I,e);if(!ie)return{notEnoughRoom:!0};const le=_a(ie.first.point.x,ie.first.point.y,e,a),ae=_a(ie.last.point.x,ie.last.point.y,e,a);if(_&&!g){const ue=Wa(l.writingMode,le,ae,E);if(ue)return ue}W=[ie.first];for(let ue=l.glyphStartIndex+1;ue<J-1;ue++){const me=$i(O*S.getoffsetX(ue),k,N,g,l.segment,ee,te,e,I);if(!me)return{notEnoughRoom:!0};W.push(me)}W.push(ie.last)}else{if(_&&!g){const ee=Er(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,te=l.lineStartIndex+l.segment+1,ie=new c.P(e.lineVertexArray.getx(te),e.lineVertexArray.gety(te)),le=Er(ie.x,ie.y,e),ae=le.signedDistanceFromCamera>0?le.point:rn(e.tileAnchorPoint,ie,ee,1,e),ue=_a(ee.x,ee.y,e,a),me=_a(ae.x,ae.y,e,a),oe=Wa(l.writingMode,ue,me,E);if(oe)return oe}const J=$i(O*S.getoffsetX(l.glyphStartIndex),k,N,g,l.segment,l.lineStartIndex,l.lineStartIndex+l.lineLength,e,I);if(!J||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};W=[J]}for(const J of W)c.av(P,J.point,J.angle);return{}}function rn(f,e,a,l,d){const g=f.add(f.sub(e)._unit()),_=Er(g.x,g.y,d).point,S=a.sub(_);return a.add(S._mult(l/S.mag()))}function Qt(f,e,a){const l=e.projectionCache;if(l.projections[f])return l.projections[f];const d=new c.P(e.lineVertexArray.getx(f),e.lineVertexArray.gety(f)),g=Er(d.x,d.y,e);if(g.signedDistanceFromCamera>0)return l.projections[f]=g.point,l.anyProjectionOccluded=l.anyProjectionOccluded||g.isOccluded,g.point;const _=f-a.direction;return rn(a.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(_),e.lineVertexArray.gety(_)),d,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function Er(f,e,a){const l=f+a.translation[0],d=e+a.translation[1];let g;return a.pitchWithMap?(g=lr(l,d,a.pitchedLabelPlaneMatrix,a.getElevation),g.isOccluded=!1):(g=a.transform.projectTileCoordinates(l,d,a.unwrappedTileID,a.getElevation),g.point.x=(.5*g.point.x+.5)*a.width,g.point.y=(.5*-g.point.y+.5)*a.height),g}function _a(f,e,a,l){if(a.pitchWithMap){const d=[f,e,0,1];return c.aw(d,d,l),a.transform.projectTileCoordinates(d[0]/d[3],d[1]/d[3],a.unwrappedTileID,a.getElevation).point}return{x:f/a.width*2-1,y:1-e/a.height*2}}function cr(f,e,a){return a.transform.projectTileCoordinates(f,e,a.unwrappedTileID,a.getElevation)}function an(f,e,a){return f._unit()._perp()._mult(e*a)}function Wl(f,e,a,l,d,g,_,S,P){if(S.projectionCache.offsets[f])return S.projectionCache.offsets[f];const E=a.add(e);if(f+P.direction<l||f+P.direction>=d)return S.projectionCache.offsets[f]=E,E;const I=Qt(f+P.direction,S,P),O=an(I.sub(a),_,P.direction),k=a.add(O),N=I.add(O);return S.projectionCache.offsets[f]=c.ax(g,E,k,N)||E,S.projectionCache.offsets[f]}function $i(f,e,a,l,d,g,_,S,P){const E=l?f-e:f+e;let I=E>0?1:-1,O=0;l&&(I*=-1,O=Math.PI),I<0&&(O+=Math.PI);let k,N=I>0?g+d:g+d+1;S.projectionCache.cachedAnchorPoint?k=S.projectionCache.cachedAnchorPoint:(k=Er(S.tileAnchorPoint.x,S.tileAnchorPoint.y,S).point,S.projectionCache.cachedAnchorPoint=k);let W,J,ee=k,te=k,ie=0,le=0;const ae=Math.abs(E),ue=[];let me;for(;ie+le<=ae;){if(N+=I,N<g||N>=_)return null;ie+=le,te=ee,J=W;const Ue={absOffsetX:ae,direction:I,distanceFromAnchor:ie,previousVertex:te};if(ee=Qt(N,S,Ue),a===0)ue.push(te),me=ee.sub(te);else{let Ie;const Oe=ee.sub(te);Ie=Oe.mag()===0?an(Qt(N+I,S,Ue).sub(ee),a,I):an(Oe,a,I),J||(J=te.add(Ie)),W=Wl(N,Ie,ee,g,_,J,a,S,Ue),ue.push(J),me=W.sub(J)}le=me.mag()}const oe=me._mult((ae-ie)/le)._add(J||te),Se=O+Math.atan2(ee.y-te.y,ee.x-te.x);return ue.push(oe),{point:oe,angle:P?Se:0,path:ue}}const mo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function $a(f,e){for(let a=0;a<f;a++){const l=e.length;e.resize(l+4),e.float32.set(mo,3*l)}}function cs(f,e,a){const l=e[0],d=e[1];return f[0]=a[0]*l+a[4]*d+a[12],f[1]=a[1]*l+a[5]*d+a[13],f[3]=a[3]*l+a[7]*d+a[15],f}const _r=100;class Nc{constructor(e,a=new Vr(e.width+200,e.height+200,25),l=new Vr(e.width+200,e.height+200,25)){this.transform=e,this.grid=a,this.ignoredGrid=l,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+_r,this.screenBottomBoundary=e.height+_r,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,l,d,g,_,S,P,E,I,O,k){const N=this.projectAndGetPerspectiveRatio(e.anchorPointX+P[0],e.anchorPointY+P[1],g,I,k),W=l*N.perspectiveRatio;let J;if(_||S)J=this._projectCollisionBox(e,W,d,g,_,S,P,N,I,O,k);else{const me=N.x+(O?O.x*W:0),oe=N.y+(O?O.y*W:0);J={allPointsOccluded:!1,box:[me+e.x1*W,oe+e.y1*W,me+e.x2*W,oe+e.y2*W]}}const[ee,te,ie,le]=J.box,ae=_?J.allPointsOccluded:N.isOccluded;let ue=ae;return ue||(ue=N.perspectiveRatio<this.perspectiveRatioCutoff),ue||(ue=!this.isInsideGrid(ee,te,ie,le)),ue||a!=="always"&&this.grid.hitTest(ee,te,ie,le,a,E)?{box:[ee,te,ie,le],placeable:!1,offscreen:!1,occluded:ae}:{box:[ee,te,ie,le],placeable:!0,offscreen:this.isOffscreen(ee,te,ie,le),occluded:ae}}placeCollisionCircles(e,a,l,d,g,_,S,P,E,I,O,k,N,W){const J=[],ee=new c.P(a.anchorX,a.anchorY),te=this.getPerspectiveRatio(ee.x,ee.y,_,W),ie=(E?g*this.transform.getPitchedTextCorrection(a.anchorX,a.anchorY,_)/te:g*te)/c.aB,le={getElevation:W,pitchedLabelPlaneMatrix:S,lineVertexArray:l,pitchWithMap:E,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:ee,unwrappedTileID:_,width:this.transform.width,height:this.transform.height,translation:N},ae=po(ie,d,a.lineOffsetX*ie,a.lineOffsetY*ie,!1,a,!1,le);let ue=!1,me=!1,oe=!0;if(ae){const Se=.5*O*te+k,Ue=new c.P(-100,-100),Ie=new c.P(this.screenRightBoundary,this.screenBottomBoundary),Oe=new In,je=ae.first,pt=ae.last;let ht=[];for(let ln=je.path.length-1;ln>=1;ln--)ht.push(je.path[ln]);for(let ln=1;ln<pt.path.length;ln++)ht.push(pt.path[ln]);const Ke=2.5*Se;if(E){const ln=this.projectPathToScreenSpace(ht,le);ht=ln.some((Pn=>Pn.signedDistanceFromCamera<=0))?[]:ln.map((Pn=>Pn.point))}let Tt=[];if(ht.length>0){const ln=ht[0].clone(),Pn=ht[0].clone();for(let ar=1;ar<ht.length;ar++)ln.x=Math.min(ln.x,ht[ar].x),ln.y=Math.min(ln.y,ht[ar].y),Pn.x=Math.max(Pn.x,ht[ar].x),Pn.y=Math.max(Pn.y,ht[ar].y);Tt=ln.x>=Ue.x&&Pn.x<=Ie.x&&ln.y>=Ue.y&&Pn.y<=Ie.y?[ht]:Pn.x<Ue.x||ln.x>Ie.x||Pn.y<Ue.y||ln.y>Ie.y?[]:c.ay([ht],Ue.x,Ue.y,Ie.x,Ie.y)}for(const ln of Tt){Oe.reset(ln,.25*Se);let Pn=0;Pn=Oe.length<=.5*Se?1:Math.ceil(Oe.paddedLength/Ke)+1;for(let ar=0;ar<Pn;ar++){const Fn=ar/Math.max(Pn-1,1),Nn=Oe.lerp(Fn),$n=Nn.x+_r,Gn=Nn.y+_r;J.push($n,Gn,Se,0);const Un=$n-Se,vn=Gn-Se,jr=$n+Se,Ir=Gn+Se;if(oe=oe&&this.isOffscreen(Un,vn,jr,Ir),me=me||this.isInsideGrid(Un,vn,jr,Ir),e!=="always"&&this.grid.hitTestCircle($n,Gn,Se,e,I)&&(ue=!0,!P))return{circles:[],offscreen:!1,collisionDetected:ue}}}}return{circles:!P&&ue||!me||te<this.perspectiveRatioCutoff?[]:J,offscreen:oe,collisionDetected:ue}}projectPathToScreenSpace(e,a){const l=(function(d,g){const _=c.L();return c.aq(_,g.pitchedLabelPlaneMatrix),d.map((S=>{const P=lr(S.x,S.y,_,g.getElevation),E=g.transform.projectTileCoordinates(P.point.x,P.point.y,g.unwrappedTileID,g.getElevation);return E.point.x=(.5*E.point.x+.5)*g.width,E.point.y=(.5*-E.point.y+.5)*g.height,E}))})(e,a);return(function(d){let g=0,_=0,S=0,P=0;for(let E=0;E<d.length;E++)d[E].isOccluded?(S=E+1,P=0):(P++,P>_&&(_=P,g=S));return d.slice(g,g+_)})(l)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const a=[],l=new c.a2;for(const O of e){const k=new c.P(O.x+_r,O.y+_r);l.extend(k),a.push(k)}const{minX:d,minY:g,maxX:_,maxY:S}=l,P=this.grid.query(d,g,_,S).concat(this.ignoredGrid.query(d,g,_,S)),E={},I={};for(const O of P){const k=O.key;if(E[k.bucketInstanceId]===void 0&&(E[k.bucketInstanceId]={}),E[k.bucketInstanceId][k.featureIndex])continue;const N=[new c.P(O.x1,O.y1),new c.P(O.x2,O.y1),new c.P(O.x2,O.y2),new c.P(O.x1,O.y2)];c.az(a,N)&&(E[k.bucketInstanceId][k.featureIndex]=!0,I[k.bucketInstanceId]===void 0&&(I[k.bucketInstanceId]=[]),I[k.bucketInstanceId].push(k.featureIndex))}return I}insertCollisionBox(e,a,l,d,g,_){(l?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:g,collisionGroupID:_,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,l,d,g,_){const S=l?this.ignoredGrid:this.grid,P={bucketInstanceId:d,featureIndex:g,collisionGroupID:_,overlapMode:a};for(let E=0;E<e.length;E+=4)S.insertCircle(P,e[E],e[E+1],e[E+2])}projectAndGetPerspectiveRatio(e,a,l,d,g){if(g){let _;d?(_=[e,a,d(e,a),1],c.aw(_,_,g)):(_=[e,a,0,1],cs(_,_,g));const S=_[3];return{x:(_[0]/S+1)/2*this.transform.width+_r,y:(-_[1]/S+1)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S*.5,isOccluded:!1,signedDistanceFromCamera:S}}{const _=this.transform.projectTileCoordinates(e,a,l,d);return{x:(_.point.x+1)/2*this.transform.width+_r,y:(1-_.point.y)/2*this.transform.height+_r,perspectiveRatio:.5+this.transform.cameraToCenterDistance/_.signedDistanceFromCamera*.5,isOccluded:_.isOccluded,signedDistanceFromCamera:_.signedDistanceFromCamera}}}getPerspectiveRatio(e,a,l,d){const g=this.transform.projectTileCoordinates(e,a,l,d);return .5+this.transform.cameraToCenterDistance/g.signedDistanceFromCamera*.5}isOffscreen(e,a,l,d){return l<_r||e>=this.screenRightBoundary||d<_r||a>this.screenBottomBoundary}isInsideGrid(e,a,l,d){return l>=0&&e<this.gridRightBoundary&&d>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const e=c.ag([]);return c.M(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,l,d,g,_,S,P,E,I,O){let k=1,N=0,W=0,J=1;const ee=e.anchorPointX+S[0],te=e.anchorPointY+S[1];if(_&&!g){const ht=this.projectAndGetPerspectiveRatio(ee+1,te,d,E,O),Ke=ht.x-P.x,Tt=Math.atan((ht.y-P.y)/Ke)+(Ke<0?Math.PI:0),ln=Math.sin(Tt),Pn=Math.cos(Tt);k=Pn,N=ln,W=-ln,J=Pn}else if(!_&&g){const ht=$t(this.transform);k=ht.vecEast[0],N=ht.vecEast[1],W=ht.vecSouth[0],J=ht.vecSouth[1]}let ie=P.x,le=P.y,ae=a;g&&(ie=ee,le=te,ae=Math.pow(2,-(this.transform.zoom-l.overscaledZ)),ae*=this.transform.getPitchedTextCorrection(ee,te,d),I||(ae*=c.ah(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),I&&(ie+=k*I.x*ae+W*I.y*ae,le+=N*I.x*ae+J*I.y*ae);const ue=e.x1*ae,me=e.x2*ae,oe=(ue+me)/2,Se=e.y1*ae,Ue=e.y2*ae,Ie=(Se+Ue)/2,Oe=[{offsetX:ue,offsetY:Se},{offsetX:oe,offsetY:Se},{offsetX:me,offsetY:Se},{offsetX:me,offsetY:Ie},{offsetX:me,offsetY:Ue},{offsetX:oe,offsetY:Ue},{offsetX:ue,offsetY:Ue},{offsetX:ue,offsetY:Ie}];let je=[];for(const{offsetX:ht,offsetY:Ke}of Oe)je.push(new c.P(ie+k*ht+W*Ke,le+N*ht+J*Ke));let pt=!1;if(g){const ht=je.map((Ke=>this.projectAndGetPerspectiveRatio(Ke.x,Ke.y,d,E,O)));pt=ht.some((Ke=>!Ke.isOccluded)),je=ht.map((Ke=>new c.P(Ke.x,Ke.y)))}else pt=!0;return{box:c.aA(je),allPointsOccluded:!pt}}}class si{constructor(e,a,l,d){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):d&&l?1:0,this.placed=l}isHidden(){return this.opacity===0&&!this.placed}}class zn{constructor(e,a,l,d,g){this.text=new si(e?e.text:null,a,l,g),this.icon=new si(e?e.icon:null,a,d,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Xa{constructor(e,a,l){this.text=e,this.icon=a,this.skipFade=l}}class us{constructor(e,a,l,d,g){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=l,this.bucketIndex=d,this.tileID=g}}class Uc{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:l=>l.collisionGroupID===a}}return this.collisionGroups[e]}}function ia(f,e,a,l,d){const{horizontalAlign:g,verticalAlign:_}=c.aH(f);return new c.P(-(g-.5)*e+l[0]*d,-(_-.5)*a+l[1]*d)}class Ya{constructor(e,a,l,d,g){this.transform=e.clone(),this.terrain=a,this.collisionIndex=new Nc(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=l,this.retainedQueryData={},this.collisionGroups=new Uc(d),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const a=this.terrain;return a?(l,d)=>a.getElevation(e,l,d):null}getBucketParts(e,a,l,d){const g=l.getBucket(a),_=l.latestFeatureIndex;if(!g||!_||a.id!==g.layerIds[0])return;const S=l.collisionBoxArray,P=g.layers[0].layout,E=g.layers[0].paint,I=Math.pow(2,this.transform.zoom-l.tileID.overscaledZ),O=l.tileSize/c.$,k=l.tileID.toUnwrapped(),N=P.get("text-rotation-alignment")==="map",W=c.aC(l,1,this.transform.zoom),J=c.aD(this.collisionIndex.transform,l,E.get("text-translate"),E.get("text-translate-anchor")),ee=c.aD(this.collisionIndex.transform,l,E.get("icon-translate"),E.get("icon-translate-anchor")),te=Vn(N,this.transform,W);this.retainedQueryData[g.bucketInstanceId]=new us(g.bucketInstanceId,_,g.sourceLayerIndex,g.index,l.tileID);const ie={bucket:g,layout:P,translationText:J,translationIcon:ee,unwrappedTileID:k,pitchedLabelPlaneMatrix:te,scale:I,textPixelRatio:O,holdingForFade:l.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:c.an(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(d)for(const le of g.sortKeyRanges){const{sortKey:ae,symbolInstanceStart:ue,symbolInstanceEnd:me}=le;e.push({sortKey:ae,symbolInstanceStart:ue,symbolInstanceEnd:me,parameters:ie})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:ie})}attemptAnchorPlacement(e,a,l,d,g,_,S,P,E,I,O,k,N,W,J,ee,te,ie,le,ae){const ue=c.aE[e.textAnchor],me=[e.textOffset0,e.textOffset1],oe=ia(ue,l,d,me,g),Se=this.collisionIndex.placeCollisionBox(a,k,P,E,I,S,_,ee,O.predicate,le,oe,ae);if((!ie||this.collisionIndex.placeCollisionBox(ie,k,P,E,I,S,_,te,O.predicate,le,oe,ae).placeable)&&Se.placeable){let Ue;if(this.prevPlacement&&this.prevPlacement.variableOffsets[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID]&&this.prevPlacement.placements[N.crossTileID].text&&(Ue=this.prevPlacement.variableOffsets[N.crossTileID].anchor),N.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[N.crossTileID]={textOffset:me,width:l,height:d,anchor:ue,textBoxScale:g,prevAnchor:Ue},this.markUsedJustification(W,ue,N,J),W.allowVerticalPlacement&&(this.markUsedOrientation(W,J,N),this.placedOrientations[N.crossTileID]=J),{shift:oe,placedGlyphBoxes:Se}}}placeLayerBucketPart(e,a,l){const{bucket:d,layout:g,translationText:_,translationIcon:S,unwrappedTileID:P,pitchedLabelPlaneMatrix:E,textPixelRatio:I,holdingForFade:O,collisionBoxArray:k,partiallyEvaluatedTextSize:N,collisionGroup:W}=e.parameters,J=g.get("text-optional"),ee=g.get("icon-optional"),te=c.aF(g,"text-overlap","text-allow-overlap"),ie=te==="always",le=c.aF(g,"icon-overlap","icon-allow-overlap"),ae=le==="always",ue=g.get("text-rotation-alignment")==="map",me=g.get("text-pitch-alignment")==="map",oe=g.get("icon-text-fit")!=="none",Se=g.get("symbol-z-order")==="viewport-y",Ue=ie&&(ae||!d.hasIconData()||ee),Ie=ae&&(ie||!d.hasTextData()||J);!d.collisionArrays&&k&&d.deserializeCollisionBoxes(k);const Oe=this.retainedQueryData[d.bucketInstanceId].tileID,je=this._getTerrainElevationFunc(Oe),pt=this.transform.getFastPathSimpleProjectionMatrix(Oe),ht=(Ke,Tt,ln)=>{var Pn,ar;if(a[Ke.crossTileID])return;if(O)return void(this.placements[Ke.crossTileID]=new Xa(!1,!1,!1));let Fn=!1,Nn=!1,$n=!0,Gn=null,Un={box:null,placeable:!1,offscreen:null,occluded:!1},vn={placeable:!1},jr=null,Ir=null,Ui=null,is=0,Ro=0,ji=0;Tt.textFeatureIndex?is=Tt.textFeatureIndex:Ke.useRuntimeCollisionCircles&&(is=Ke.featureIndex),Tt.verticalTextFeatureIndex&&(Ro=Tt.verticalTextFeatureIndex);const Do=Tt.textBox;if(Do){const ni=Dn=>{let hr=c.ao.horizontal;if(d.allowVerticalPlacement&&!Dn&&this.prevPlacement){const Si=this.prevPlacement.placedOrientations[Ke.crossTileID];Si&&(this.placedOrientations[Ke.crossTileID]=Si,hr=Si,this.markUsedOrientation(d,hr,Ke))}return hr},oo=(Dn,hr)=>{if(d.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&Tt.verticalTextBox){for(const Si of d.writingModes)if(Si===c.ao.vertical?(Un=hr(),vn=Un):Un=Dn(),Un&&Un.placeable)break}else Un=Dn()},so=Ke.textAnchorOffsetStartIndex,os=Ke.textAnchorOffsetEndIndex;if(os===so){const Dn=(hr,Si)=>{const xr=this.collisionIndex.placeCollisionBox(hr,te,I,Oe,P,me,ue,_,W.predicate,je,void 0,pt);return xr&&xr.placeable&&(this.markUsedOrientation(d,Si,Ke),this.placedOrientations[Ke.crossTileID]=Si),xr};oo((()=>Dn(Do,c.ao.horizontal)),(()=>{const hr=Tt.verticalTextBox;return d.allowVerticalPlacement&&Ke.numVerticalGlyphVertices>0&&hr?Dn(hr,c.ao.vertical):{box:null,offscreen:null}})),ni(Un&&Un.placeable)}else{let Dn=c.aE[(ar=(Pn=this.prevPlacement)===null||Pn===void 0?void 0:Pn.variableOffsets[Ke.crossTileID])===null||ar===void 0?void 0:ar.anchor];const hr=(xr,cu,uu)=>{const Il=xr.x2-xr.x1,ja=xr.y2-xr.y1,lo=Ke.textBoxScale,Sr=oe&&le==="never"?cu:null;let br=null,co=te==="never"?1:2,zo="never";Dn&&co++;for(let Lo=0;Lo<co;Lo++){for(let wa=so;wa<os;wa++){const Pr=d.textAnchorOffsets.get(wa);if(Dn&&Pr.textAnchor!==Dn)continue;const ks=this.attemptAnchorPlacement(Pr,xr,Il,ja,lo,ue,me,I,Oe,P,W,zo,Ke,d,uu,_,S,Sr,je);if(ks&&(br=ks.placedGlyphBoxes,br&&br.placeable))return Fn=!0,Gn=ks.shift,br}Dn?Dn=null:zo=te}return l&&!br&&(br={box:this.collisionIndex.placeCollisionBox(Do,"always",I,Oe,P,me,ue,_,W.predicate,je,void 0,pt).box,offscreen:!1,placeable:!1,occluded:!1}),br};oo((()=>hr(Do,Tt.iconBox,c.ao.horizontal)),(()=>{const xr=Tt.verticalTextBox;return d.allowVerticalPlacement&&(!Un||!Un.placeable)&&Ke.numVerticalGlyphVertices>0&&xr?hr(xr,Tt.verticalIconBox,c.ao.vertical):{box:null,occluded:!0,offscreen:null}})),Un&&(Fn=Un.placeable,$n=Un.offscreen);const Si=ni(Un&&Un.placeable);if(!Fn&&this.prevPlacement){const xr=this.prevPlacement.variableOffsets[Ke.crossTileID];xr&&(this.variableOffsets[Ke.crossTileID]=xr,this.markUsedJustification(d,xr.anchor,Ke,Si))}}}if(jr=Un,Fn=jr&&jr.placeable,$n=jr&&jr.offscreen,Ke.useRuntimeCollisionCircles){const ni=d.text.placedSymbolArray.get(Ke.centerJustifiedTextSymbolIndex),oo=c.ap(d.textSizeData,N,ni),so=g.get("text-padding");Ir=this.collisionIndex.placeCollisionCircles(te,ni,d.lineVertexArray,d.glyphOffsetArray,oo,P,E,l,me,W.predicate,Ke.collisionCircleDiameter,so,_,je),Ir.circles.length&&Ir.collisionDetected&&!l&&c.w("Collisions detected, but collision boxes are not shown"),Fn=ie||Ir.circles.length>0&&!Ir.collisionDetected,$n=$n&&Ir.offscreen}if(Tt.iconFeatureIndex&&(ji=Tt.iconFeatureIndex),Tt.iconBox){const ni=oo=>this.collisionIndex.placeCollisionBox(oo,le,I,Oe,P,me,ue,S,W.predicate,je,oe&&Gn?Gn:void 0,pt);vn&&vn.placeable&&Tt.verticalIconBox?(Ui=ni(Tt.verticalIconBox),Nn=Ui.placeable):(Ui=ni(Tt.iconBox),Nn=Ui.placeable),$n=$n&&Ui.offscreen}const as=J||Ke.numHorizontalGlyphVertices===0&&Ke.numVerticalGlyphVertices===0,Sc=ee||Ke.numIconVertices===0;as||Sc?Sc?as||(Nn=Nn&&Fn):Fn=Nn&&Fn:Nn=Fn=Nn&&Fn;const Io=Nn&&Ui.placeable;if(Fn&&jr.placeable&&this.collisionIndex.insertCollisionBox(jr.box,te,g.get("text-ignore-placement"),d.bucketInstanceId,vn&&vn.placeable&&Ro?Ro:is,W.ID),Io&&this.collisionIndex.insertCollisionBox(Ui.box,le,g.get("icon-ignore-placement"),d.bucketInstanceId,ji,W.ID),Ir&&Fn&&this.collisionIndex.insertCollisionCircles(Ir.circles,te,g.get("text-ignore-placement"),d.bucketInstanceId,is,W.ID),l&&this.storeCollisionData(d.bucketInstanceId,ln,Tt,jr,Ui,Ir),Ke.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ke.crossTileID]=new Xa((Fn||Ue)&&!jr?.occluded,(Nn||Ie)&&!Ui?.occluded,$n||d.justReloaded),a[Ke.crossTileID]=!0};if(Se){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ke=d.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Tt=Ke.length-1;Tt>=0;--Tt){const ln=Ke[Tt];ht(d.symbolInstances.get(ln),d.collisionArrays[ln],ln)}}else for(let Ke=e.symbolInstanceStart;Ke<e.symbolInstanceEnd;Ke++)ht(d.symbolInstances.get(Ke),d.collisionArrays[Ke],Ke);d.justReloaded=!1}storeCollisionData(e,a,l,d,g,_){if(l.textBox||l.iconBox){let S,P;this.collisionBoxArrays.has(e)?S=this.collisionBoxArrays.get(e):(S=new Map,this.collisionBoxArrays.set(e,S)),S.has(a)?P=S.get(a):(P={text:null,icon:null},S.set(a,P)),l.textBox&&(P.text=d.box),l.iconBox&&(P.icon=g.box)}if(_){let S=this.collisionCircleArrays[e];S===void 0&&(S=this.collisionCircleArrays[e]=[]);for(let P=0;P<_.circles.length;P+=4)S.push(_.circles[P+0]-_r),S.push(_.circles[P+1]-_r),S.push(_.circles[P+2]),S.push(_.collisionDetected?1:0)}}markUsedJustification(e,a,l,d){let g;g=d===c.ao.vertical?l.verticalPlacedTextSymbolIndex:{left:l.leftJustifiedTextSymbolIndex,center:l.centerJustifiedTextSymbolIndex,right:l.rightJustifiedTextSymbolIndex}[c.aG(a)];const _=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex,l.verticalPlacedTextSymbolIndex];for(const S of _)S>=0&&(e.text.placedSymbolArray.get(S).crossTileID=g>=0&&S!==g?0:l.crossTileID)}markUsedOrientation(e,a,l){const d=a===c.ao.horizontal||a===c.ao.horizontalOnly?a:0,g=a===c.ao.vertical?a:0,_=[l.leftJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.rightJustifiedTextSymbolIndex];for(const S of _)e.text.placedSymbolArray.get(S).placedOrientation=d;l.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(l.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let l=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const d=a?a.symbolFadeChange(e):1,g=a?a.opacities:{},_=a?a.variableOffsets:{},S=a?a.placedOrientations:{};for(const P in this.placements){const E=this.placements[P],I=g[P];I?(this.opacities[P]=new zn(I,d,E.text,E.icon),l=l||E.text!==I.text.placed||E.icon!==I.icon.placed):(this.opacities[P]=new zn(null,d,E.text,E.icon,E.skipFade),l=l||E.text||E.icon)}for(const P in g){const E=g[P];if(!this.opacities[P]){const I=new zn(E,d,!1,!1);I.isHidden()||(this.opacities[P]=I,l=l||E.text.placed||E.icon.placed)}}for(const P in _)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=_[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");l?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){const l={};for(const d of a){const g=d.getBucket(e);g&&d.latestFeatureIndex&&e.id===g.layerIds[0]&&this.updateBucketOpacities(g,d.tileID,l,d.collisionBoxArray)}}updateBucketOpacities(e,a,l,d){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const g=e.layers[0],_=g.layout,S=new zn(null,0,!1,!1,!0),P=_.get("text-allow-overlap"),E=_.get("icon-allow-overlap"),I=g._unevaluatedLayout.hasValue("text-variable-anchor")||g._unevaluatedLayout.hasValue("text-variable-anchor-offset"),O=_.get("text-rotation-alignment")==="map",k=_.get("text-pitch-alignment")==="map",N=_.get("icon-text-fit")!=="none",W=new zn(null,0,P&&(E||!e.hasIconData()||_.get("icon-optional")),E&&(P||!e.hasTextData()||_.get("text-optional")),!0);!e.collisionArrays&&d&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(d);const J=(te,ie,le)=>{for(let ae=0;ae<ie/4;ae++)te.opacityVertexArray.emplaceBack(le);te.hasVisibleVertices=te.hasVisibleVertices||le!==il},ee=this.collisionBoxArrays.get(e.bucketInstanceId);for(let te=0;te<e.symbolInstances.length;te++){const ie=e.symbolInstances.get(te),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:ae,crossTileID:ue}=ie;let me=this.opacities[ue];l[ue]?me=S:me||(me=W,this.opacities[ue]=me),l[ue]=!0;const oe=ie.numIconVertices>0,Se=this.placedOrientations[ie.crossTileID],Ue=Se===c.ao.vertical,Ie=Se===c.ao.horizontal||Se===c.ao.horizontalOnly;if(le>0||ae>0){const je=rl(me.text);J(e.text,le,Ue?il:je),J(e.text,ae,Ie?il:je);const pt=me.text.isHidden();[ie.rightJustifiedTextSymbolIndex,ie.centerJustifiedTextSymbolIndex,ie.leftJustifiedTextSymbolIndex].forEach((Tt=>{Tt>=0&&(e.text.placedSymbolArray.get(Tt).hidden=pt||Ue?1:0)})),ie.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(ie.verticalPlacedTextSymbolIndex).hidden=pt||Ie?1:0);const ht=this.variableOffsets[ie.crossTileID];ht&&this.markUsedJustification(e,ht.anchor,ie,Se);const Ke=this.placedOrientations[ie.crossTileID];Ke&&(this.markUsedJustification(e,"left",ie,Ke),this.markUsedOrientation(e,Ke,ie))}if(oe){const je=rl(me.icon),pt=!(N&&ie.verticalPlacedIconSymbolIndex&&Ue);ie.placedIconSymbolIndex>=0&&(J(e.icon,ie.numIconVertices,pt?je:il),e.icon.placedSymbolArray.get(ie.placedIconSymbolIndex).hidden=me.icon.isHidden()),ie.verticalPlacedIconSymbolIndex>=0&&(J(e.icon,ie.numVerticalIconVertices,pt?il:je),e.icon.placedSymbolArray.get(ie.verticalPlacedIconSymbolIndex).hidden=me.icon.isHidden())}const Oe=ee&&ee.has(te)?ee.get(te):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const je=e.collisionArrays[te];if(je){let pt=new c.P(0,0);if(je.textBox||je.verticalTextBox){let ht=!0;if(I){const Ke=this.variableOffsets[ue];Ke?(pt=ia(Ke.anchor,Ke.width,Ke.height,Ke.textOffset,Ke.textBoxScale),O&&pt._rotate(k?-this.transform.bearingInRadians:this.transform.bearingInRadians)):ht=!1}if(je.textBox||je.verticalTextBox){let Ke;je.textBox&&(Ke=Ue),je.verticalTextBox&&(Ke=Ie),$l(e.textCollisionBox.collisionVertexArray,me.text.placed,!ht||Ke,Oe.text,pt.x,pt.y)}}if(je.iconBox||je.verticalIconBox){const ht=!!(!Ie&&je.verticalIconBox);let Ke;je.iconBox&&(Ke=ht),je.verticalIconBox&&(Ke=!ht),$l(e.iconCollisionBox.collisionVertexArray,me.icon.placed,Ke,Oe.icon,N?pt.x:0,N?pt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){const l=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*l>e}setStale(){this.stale=!0}}function $l(f,e,a,l,d,g){l&&l.length!==0||(l=[0,0,0,0]);const _=l[0]-_r,S=l[1]-_r,P=l[2]-_r,E=l[3]-_r;f.emplaceBack(e?1:0,a?1:0,d||0,g||0,_,S),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,P,S),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,P,E),f.emplaceBack(e?1:0,a?1:0,d||0,g||0,_,E)}const Nh=Math.pow(2,25),Iu=Math.pow(2,24),li=Math.pow(2,17),zu=Math.pow(2,16),kd=Math.pow(2,9),jc=Math.pow(2,8),Uh=Math.pow(2,1);function rl(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const e=f.placed?1:0,a=Math.floor(127*f.opacity);return a*Nh+e*Iu+a*li+e*zu+a*kd+e*jc+a*Uh+e}const il=0;class Xi{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,l,d,g){const _=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(_,d,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,_.sort(((S,P)=>S.sortKey-P.sortKey)));this._currentPartIndex<_.length;)if(a.placeLayerBucketPart(_[this._currentPartIndex],this._seenCrossTileIDs,l),this._currentPartIndex++,g())return!0;return!1}}class Xl{constructor(e,a,l,d,g,_,S,P){this.placement=new Ya(e,a,_,S,P),this._currentPlacementIndex=l.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(e,a,l){const d=ge.now(),g=()=>!this._forceFullPlacement&&ge.now()-d>2;for(;this._currentPlacementIndex>=0;){const _=a[e[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if(_.type==="symbol"&&(!_.minzoom||_.minzoom<=S)&&(!_.maxzoom||_.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new Xi(_)),this._inProgressLayer.continuePlacement(l[_.source],this.placement,this._showCollisionBoxes,_,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const hs=512/c.$/2;class Yl{constructor(e,a,l){this.tileID=e,this.bucketInstanceId=l,this._symbolsByKey={};const d=new Map;for(let g=0;g<a.length;g++){const _=a.get(g),S=_.key,P=d.get(S);P?P.push(_):d.set(S,[_])}for(const[g,_]of d){const S={positions:_.map((P=>({x:Math.floor(P.anchorX*hs),y:Math.floor(P.anchorY*hs)}))),crossTileIDs:_.map((P=>P.crossTileID))};if(S.positions.length>128){const P=new c.aI(S.positions.length,16,Uint16Array);for(const{x:E,y:I}of S.positions)P.add(E,I);P.finish(),delete S.positions,S.index=P}this._symbolsByKey[g]=S}}getScaledCoordinates(e,a){const{x:l,y:d,z:g}=this.tileID.canonical,{x:_,y:S,z:P}=a.canonical,E=hs/Math.pow(2,P-g),I=(S*c.$+e.anchorY)*E,O=d*c.$*hs;return{x:Math.floor((_*c.$+e.anchorX)*E-l*c.$*hs),y:Math.floor(I-O)}}findMatches(e,a,l){const d=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let g=0;g<e.length;g++){const _=e.get(g);if(_.crossTileID)continue;const S=this._symbolsByKey[_.key];if(!S)continue;const P=this.getScaledCoordinates(_,a);if(S.index){const E=S.index.range(P.x-d,P.y-d,P.x+d,P.y+d).sort();for(const I of E){const O=S.crossTileIDs[I];if(!l[O]){l[O]=!0,_.crossTileID=O;break}}}else if(S.positions)for(let E=0;E<S.positions.length;E++){const I=S.positions[E],O=S.crossTileIDs[E];if(Math.abs(I.x-P.x)<=d&&Math.abs(I.y-P.y)<=d&&!l[O]){l[O]=!0,_.crossTileID=O;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map((({crossTileIDs:e})=>e))}}class Uo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class jh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const a=Math.round((e-this.lng)/360);if(a!==0)for(const l in this.indexes){const d=this.indexes[l],g={};for(const _ in d){const S=d[_];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+a),g[S.tileID.key]=S}this.indexes[l]=g}this.lng=e}addBucket(e,a,l){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let g=0;g<a.symbolInstances.length;g++)a.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const d=this.usedCrossTileIDs[e.overscaledZ];for(const g in this.indexes){const _=this.indexes[g];if(Number(g)>e.overscaledZ)for(const S in _){const P=_[S];P.tileID.isChildOf(e)&&P.findMatches(a.symbolInstances,e,d)}else{const S=_[e.scaledTo(Number(g)).key];S&&S.findMatches(a.symbolInstances,e,d)}}for(let g=0;g<a.symbolInstances.length;g++){const _=a.symbolInstances.get(g);_.crossTileID||(_.crossTileID=l.generate(),d[_.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Yl(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(const l of a.getCrossTileIDsLists())for(const d of l)delete this.usedCrossTileIDs[e][d]}removeStaleBuckets(e){let a=!1;for(const l in this.indexes){const d=this.indexes[l];for(const g in d)e[d[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(l,d[g]),delete d[g],a=!0)}return a}}class ds{constructor(){this.layerIndexes={},this.crossTileIDs=new Uo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,l){let d=this.layerIndexes[e.id];d===void 0&&(d=this.layerIndexes[e.id]=new jh);let g=!1;const _={};d.handleWrapJump(l);for(const S of a){const P=S.getBucket(e);P&&e.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(S.tileID,P,this.crossTileIDs)&&(g=!0),_[P.bucketInstanceId]=!0)}return d.removeStaleBuckets(_)&&(g=!0),g}pruneUnusedLayers(e){const a={};e.forEach((l=>{a[l]=!0}));for(const l in this.layerIndexes)a[l]||delete this.layerIndexes[l]}}var Ka="void main() {fragColor=vec4(1.0);}";const Ea={prelude:fn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:fn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:fn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:fn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:fn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:fn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:fn(Ka,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:fn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:fn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:fn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:fn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:fn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else
{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:fn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:fn(Ka,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:fn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:fn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:fn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:fn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:fn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:fn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:fn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:fn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];
#define PI 3.141592653589793
#define STANDARD 0
#define COMBINED 1
#define IGOR 2
#define MULTIDIRECTIONAL 3
#define BASIC 4
float get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else
{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else
{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:fn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:fn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:fn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:fn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:fn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:fn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:fn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:fn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:fn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:fn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:fn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:fn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:fn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:fn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function fn(f,e){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=e.match(/in ([\w]+) ([\w]+)/g),d=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),_=g?g.concat(d):d,S={};return{fragmentSource:f=f.replace(a,((P,E,I,O,k)=>(S[k]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${k}
in ${I} ${O} ${k};
#else
uniform ${I} ${O} u_${k};
#endif
`:`
#ifdef HAS_UNIFORM_u_${k}
    ${I} ${O} ${k} = u_${k};
#endif
`))),vertexSource:e=e.replace(a,((P,E,I,O,k)=>{const N=O==="float"?"vec2":"vec4",W=k.match(/color/)?"color":N;return S[k]?E==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${I} ${N} a_${k};
out ${I} ${O} ${k};
#else
uniform ${I} ${O} u_${k};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = a_${k};
#else
    ${I} ${O} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${k} = unpack_mix_${W}(a_${k}, u_${k}_t);
#else
    ${I} ${O} ${k} = u_${k};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${k}
uniform lowp float u_${k}_t;
in ${I} ${N} a_${k};
#else
uniform ${I} ${O} u_${k};
#endif
`:W==="vec4"?`
#ifndef HAS_UNIFORM_u_${k}
    ${I} ${O} ${k} = a_${k};
#else
    ${I} ${O} ${k} = u_${k};
#endif
`:`
#ifndef HAS_UNIFORM_u_${k}
    ${I} ${O} ${k} = unpack_mix_${W}(a_${k}, u_${k}_t);
#else
    ${I} ${O} ${k} = u_${k};
#endif
`})),staticAttributes:l,staticUniforms:_}}class jo{constructor(e,a,l){this.vertexBuffer=e,this.indexBuffer=a,this.segments=l}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Qa=c.aJ([{name:"a_pos",type:"Int16",components:2}]);const go="#define PROJECTION_MERCATOR",fs="mercator";class hn{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return fs}get shaderDefine(){return go}get shaderPreludeCode(){return Ea.projectionMercator}get vertexShaderPreludeCode(){return Ea.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,a,l,d,g){if(this._cachedMesh)return this._cachedMesh;const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(c.$,0),_.emplaceBack(0,c.$),_.emplaceBack(c.$,c.$);const S=e.createVertexBuffer(_,Qa.members),P=c.aM.simpleSegment(0,0,4,2),E=new c.aN;E.emplaceBack(1,0,2),E.emplaceBack(1,2,3);const I=e.createIndexBuffer(E);return this._cachedMesh=new jo(S,I,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}class yo{constructor(e=0,a=0,l=0,d=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(l)||l<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=l,this.right=d}interpolate(e,a,l){return a.top!=null&&e.top!=null&&(this.top=c.C.number(e.top,a.top,l)),a.bottom!=null&&e.bottom!=null&&(this.bottom=c.C.number(e.bottom,a.bottom,l)),a.left!=null&&e.left!=null&&(this.left=c.C.number(e.left,a.left,l)),a.right!=null&&e.right!=null&&(this.right=c.C.number(e.right,a.right,l)),this}getCenter(e,a){const l=c.ah((this.left+e-this.right)/2,0,e),d=c.ah((this.top+a-this.bottom)/2,0,a);return new c.P(l,d)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new yo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function al(f,e){if(!f.renderWorldCopies||f.lngRange)return;const a=e.lng-f.center.lng;e.lng+=a>180?-360:a<-180?360:0}function _o(f){return Math.max(0,Math.floor(f))}class Nr{constructor(e,a,l,d,g,_){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=_===void 0||!!_,this._minZoom=a||0,this._maxZoom=l||22,this._minPitch=d??0,this._maxPitch=g??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=_o(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new yo,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,a,l){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=_o(this._zoom),this._scale=c.af(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new yo(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!l&&e.autoCalculateNearFarZ,a&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const a=c.aO(e,-180,180)*Math.PI/180;var l,d,g,_,S,P,E,I,O;this._bearingInRadians!==a&&(this._unmodified=!1,this._bearingInRadians=a,this._calcMatrices(),this._rotationMatrix=Y(),l=this._rotationMatrix,g=-this._bearingInRadians,_=(d=this._rotationMatrix)[0],S=d[1],P=d[2],E=d[3],I=Math.sin(g),O=Math.cos(g),l[0]=_*O+P*I,l[1]=S*O+E*I,l[2]=_*-I+P*O,l[3]=S*-I+E*O)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const a=c.ah(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==a&&(this._unmodified=!1,this._pitchInRadians=a,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const a=e/180*Math.PI;this._rollInRadians!==a&&(this._unmodified=!1,this._rollInRadians=a,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aP(this._fovInRadians)}setFov(e){e=c.ah(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.ae(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const a=this.getConstrained(this._center,e).zoom;this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this._tileZoom=Math.max(0,Math.floor(a)),this._scale=c.af(a),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,a){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=a,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,l){this._unmodified=!1,this._edgeInsets.interpolate(e,a,l),this._constrain(),this._calcMatrices()}resize(e,a,l=!0){this._width=e,this._height=a,l&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new qt([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-c.ai,c.ai])}getConstrained(e,a){return this._callbacks.getConstrained(e,a)}getCameraQueryGeometry(e,a){if(a.length===1)return[a[0],e];{const{minX:l,minY:d,maxX:g,maxY:_}=c.a2.fromPoints(a).extend(e);return[new c.P(l,d),new c.P(g,d),new c.P(g,_),new c.P(l,_),new c.P(l,d)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:a,zoom:l}=this.getConstrained(this.center,this.zoom);this.setCenter(a),this.setZoom(l),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.ag(new Float64Array(16));c.N(e,e,[this._width/2,-this._height/2,1]),c.M(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.ag(new Float64Array(16)),c.N(e,e,[1,-1,1]),c.M(e,e,[-1,-1,0]),c.N(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,a,l,d){const g=l!==void 0?l:this.bearing,_=d=d!==void 0?d:this.pitch,S=c.a1.fromLngLat(e,a),P=-Math.cos(c.ae(_)),E=Math.sin(c.ae(_)),I=E*Math.sin(c.ae(g)),O=-E*Math.cos(c.ae(g));let k=this.elevation;const N=a-k;let W;P*N>=0||Math.abs(P)<.1?(W=1e4,k=a+W*P):W=-N/P;let J,ee,te=c.aQ(1,S.y),ie=0;do{if(ie+=1,ie>10)break;ee=W/te,J=new c.a1(S.x+I*ee,S.y+O*ee),te=1/J.meterInMercatorCoordinateUnits()}while(Math.abs(W-ee*te)>1e-12);return{center:J.toLngLat(),elevation:k,zoom:c.ak(this.height/2/Math.tan(this.fovInRadians/2)/ee/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const a=c.aj(1,this.center.lat)*this.worldSize,l=this.cameraToCenterDistance/a,d=c.a1.fromLngLat(this.center,this.elevation),g=Be(this.center,this.elevation,this.pitch,this.bearing,l);this._elevation=e;const _=this.calculateCenterFromCameraLngLatAlt(g.toLngLat(),c.aQ(g.z,d.y),this.bearing,this.pitch);this._elevation=_.elevation,this._center=_.center,this.setZoom(_.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Be(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const a=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/a,e.canonical.y/a,1/a/c.$,1/a/c.$]}}class Hr{constructor(e,a){this.min=e,this.max=a,this.center=c.aR([],c.aS([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],l=c.aT(this.min),d=c.aT(this.max);for(let g=0;g<a.length;g++)l[g]=a[g]?this.min[g]:this.center[g],d[g]=a[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new Hr(l,d)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let a=!0;for(let l=0;l<e.planes.length;l++){const d=this.intersectsPlane(e.planes[l]);if(d===0)return 0;d===1&&(a=!1)}return a?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let a=e[3],l=e[3];for(let d=0;d<3;d++)e[d]>0?(a+=e[d]*this.min[d],l+=e[d]*this.max[d]):(l+=e[d]*this.min[d],a+=e[d]*this.max[d]);return a>=0?2:l<0?0:1}}class ci{distanceToTile2d(e,a,l,d){const g=d.distanceX([e,a]),_=d.distanceY([e,a]);return Math.hypot(g,_)}getWrap(e,a,l){return l}getTileBoundingVolume(e,a,l,d){var g,_;let S=0,P=0;if(d?.terrain){const I=new c.Z(e.z,a,e.z,e.x,e.y),O=d.terrain.getMinMaxElevation(I);S=(g=O.minElevation)!==null&&g!==void 0?g:Math.min(0,l),P=(_=O.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}const E=1<<e.z;return new Hr([a+e.x/E,e.y/E,S],[a+(e.x+1)/E,(e.y+1)/E,P])}allowVariableZoom(e,a){const l=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,d=c.ah(78.5-l/2,0,60);return!!a.terrain||e.pitch>d}allowWorldCopies(){return!0}prepareNextFrame(){}}class Mr{constructor(e,a,l){this.points=e,this.planes=a,this.aabb=l}static fromInvProjectionMatrix(e,a=1,l=0,d,g){const _=g?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],S=Math.pow(2,l),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((k=>(function(N,W,J,ee){const te=c.aw([],N,W),ie=1/te[3]/J*ee;return c.aY(te,te,[ie,ie,1/te[3],ie])})(k,e,a,S)));d&&(function(k,N,W,J){const ee=J?4:0,te=J?0:4;let ie=0;const le=[],ae=[];for(let oe=0;oe<4;oe++){const Se=c.aU([],k[oe+te],k[oe+ee]),Ue=c.aZ(Se);c.aR(Se,Se,1/Ue),le.push(Ue),ae.push(Se)}for(let oe=0;oe<4;oe++){const Se=c.a_(k[oe+ee],ae[oe],W);ie=Se!==null&&Se>=0?Math.max(ie,Se):Math.max(ie,le[oe])}const ue=(function(oe,Se){const Ue=c.aU([],oe[Se[0]],oe[Se[1]]),Ie=c.aU([],oe[Se[2]],oe[Se[1]]),Oe=[0,0,0,0];return c.aV(Oe,c.aW([],Ue,Ie)),Oe[3]=-c.aX(Oe,oe[Se[0]]),Oe})(k,N),me=(function(oe,Se){const Ue=c.a$(oe),Ie=c.b0([],oe,1/Ue),Oe=c.aU([],Se,c.aR([],Ie,c.aX(Se,Ie))),je=c.a$(Oe);if(je>0){const pt=Math.sqrt(1-Ie[3]*Ie[3]),ht=c.aR([],Ie,-Ie[3]),Ke=c.aS([],ht,c.aR([],Oe,pt/je));return c.b1(Se,Ke)}return null})(W,ue);if(me!==null){const oe=me/c.aX(ae[0],ue);ie=Math.min(ie,oe)}for(let oe=0;oe<4;oe++){const Se=Math.min(ie,le[oe]);k[oe+te]=[k[oe+ee][0]+ae[oe][0]*Se,k[oe+ee][1]+ae[oe][1]*Se,k[oe+ee][2]+ae[oe][2]*Se,1]}})(P,_[0],d,g);const E=_.map((k=>{const N=c.aU([],P[k[0]],P[k[1]]),W=c.aU([],P[k[2]],P[k[1]]),J=c.aV([],c.aW([],N,W)),ee=-c.aX(J,P[k[1]]);return J.concat(ee)})),I=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],O=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const k of P)for(let N=0;N<3;N++)I[N]=Math.min(I[N],k[N]),O[N]=Math.max(O[N],k[N]);return new Mr(P,E,new Hr(I,O))}}class Rn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,a){}constructor(e,a,l,d,g){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(_,S)=>this.getConstrained(_,S)},e,a,l,d,g),this._coveringTilesDetailsProvider=new ci}clone(){const e=new Rn;return e.apply(this),e}apply(e,a,l){this._helper.apply(e,a,l)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const a=[new c.b2(0,e)];if(this._helper._renderWorldCopies){const l=this.screenPointToMercatorCoordinate(new c.P(0,0)),d=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),g=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),_=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),S=Math.floor(Math.min(l.x,d.x,g.x,_.x)),P=Math.floor(Math.max(l.x,d.x,g.x,_.x)),E=1;for(let I=S-E;I<=P+E;I++)I!==0&&a.push(new c.b2(I,e))}return a}getCameraFrustum(){return Mr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const a=this.screenPointToLocation(this.centerPoint,e),l=e?e.getElevationForLngLatZoom(a,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(l)}setLocationAtPoint(e,a){const l=c.aj(this.elevation,this.center.lat),d=this.screenPointToMercatorCoordinateAtZ(a,l),g=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,l),_=c.a1.fromLngLat(e),S=new c.a1(_.x-(d.x-g.x),_.y-(d.y-g.y));this.setCenter(S?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,a){return a?this.coordinatePoint(c.a1.fromLngLat(e),a.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.a1.fromLngLat(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l!=null)return l}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,a){const l=a||0,d=[e.x,e.y,0,1],g=[e.x,e.y,1,1];c.aw(d,d,this._pixelMatrixInverse),c.aw(g,g,this._pixelMatrixInverse);const _=d[3],S=g[3],P=d[1]/_,E=g[1]/S,I=d[2]/_,O=g[2]/S,k=I===O?0:(l-I)/(O-I);return new c.a1(c.C.number(d[0]/_,g[0]/S,k)/this.worldSize,c.C.number(P,E,k)/this.worldSize,l)}coordinatePoint(e,a=0,l=this._pixelMatrix){const d=[e.x*this.worldSize,e.y*this.worldSize,a,1];return c.aw(d,d,l),new c.P(d[0]/d[3],d[1]/d[3])}getBounds(){const e=Math.max(0,this._helper._height/2-de(this));return new qt().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,a){return a?a.pointCoordinate(e)!=null:e.y>this.height/2-de(this)}calculatePosMatrix(e,a=!1,l){var d;const g=(d=e.key)!==null&&d!==void 0?d:c.b3(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),_=a?this._alignedPosMatrixCache:this._posMatrixCache;if(_.has(g)){const E=_.get(g);return l?E.f32:E.f64}const S=be(e,this.worldSize);c.O(S,a?this._alignedProjMatrix:this._viewProjMatrix,S);const P={f64:S,f32:new Float32Array(S)};return _.set(g,P),l?P.f32:P.f64}calculateFogMatrix(e){const a=e.key,l=this._fogMatrixCacheF32;if(l.has(a))return l.get(a);const d=be(e,this.worldSize);return c.O(d,this._fogMatrix,d),l.set(a,new Float32Array(d)),l.get(a)}getConstrained(e,a){a=c.ah(+a,this.minZoom,this.maxZoom);const l={center:new c.S(e.lng,e.lat),zoom:a};let d=this._helper._lngRange;if(!this._helper._renderWorldCopies&&d===null){const le=179.9999999999;d=[-le,le]}const g=this.tileSize*c.af(l.zoom);let _=0,S=g,P=0,E=g,I=0,O=0;const{x:k,y:N}=this.size;if(this._helper._latRange){const le=this._helper._latRange;_=c.U(le[1])*g,S=c.U(le[0])*g,S-_<N&&(I=N/(S-_))}d&&(P=c.aO(c.V(d[0])*g,0,g),E=c.aO(c.V(d[1])*g,0,g),E<P&&(E+=g),E-P<k&&(O=k/(E-P)));const{x:W,y:J}=K(g,e);let ee,te;const ie=Math.max(O||0,I||0);if(ie){const le=new c.P(O?(E+P)/2:W,I?(S+_)/2:J);return l.center=se(g,le).wrap(),l.zoom+=c.ak(ie),l}if(this._helper._latRange){const le=N/2;J-le<_&&(te=_+le),J+le>S&&(te=S-le)}if(d){const le=(P+E)/2;let ae=W;this._helper._renderWorldCopies&&(ae=c.aO(W,le-g/2,le+g/2));const ue=k/2;ae-ue<P&&(ee=P+ue),ae+ue>E&&(ee=E-ue)}if(ee!==void 0||te!==void 0){const le=new c.P(ee??W,te??J);l.center=se(g,le).wrap()}return l}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}_calculateNearFarZIfNeeded(e,a,l){if(!this._helper.autoCalculateNearFarZ)return;const d=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),g=e-d*this._helper._pixelPerMeter/Math.cos(a),_=d<0?g:e,S=Math.PI/2+this.pitchInRadians,P=c.ae(this.fov)*(Math.abs(Math.cos(c.ae(this.roll)))*this.height+Math.abs(Math.sin(c.ae(this.roll)))*this.width)/this.height*(.5+l.y/this.height),E=Math.sin(P)*_/Math.sin(c.ah(Math.PI-S-P,.01,Math.PI-.01)),I=de(this),O=Math.atan(I/this._helper.cameraToCenterDistance),k=c.ae(.75),N=O>k?2*O*(.5+l.y/(2*I)):k,W=Math.sin(N)*_/Math.sin(c.ah(Math.PI-S-N,.01,Math.PI-.01)),J=Math.min(E,W);this._helper._farZ=1.01*(Math.cos(Math.PI/2-a)*J+_),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,a=K(this.worldSize,this.center),l=a.x,d=a.y;this._helper._pixelPerMeter=c.aj(1,this.center.lat)*this.worldSize;const g=c.ae(Math.min(this.pitch,q)),_=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(g));let S;this._calculateNearFarZIfNeeded(_,g,e),S=new Float64Array(16),c.b4(S,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.aq(this._invProjMatrix,S),S[8]=2*-e.x/this._helper._width,S[9]=2*e.y/this._helper._height,this._projectionMatrix=c.b5(S),c.N(S,S,[1,-1,1]),c.M(S,S,[0,0,-this._helper.cameraToCenterDistance]),c.b6(S,S,-this.rollInRadians),c.b7(S,S,this.pitchInRadians),c.b6(S,S,-this.bearingInRadians),c.M(S,S,[-l,-d,0]),this._mercatorMatrix=c.N([],S,[this.worldSize,this.worldSize,this.worldSize]),c.N(S,S,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,S),c.M(S,S,[0,0,-this.elevation]),this._viewProjMatrix=S,this._invViewProjMatrix=c.aq([],S);const P=[0,0,-1,1];c.aw(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),c.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,_,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.M(this._fogMatrix,this._fogMatrix,[-l,-d,0]),c.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,S);const E=this._helper._width%2/2,I=this._helper._height%2/2,O=Math.cos(this.bearingInRadians),k=Math.sin(-this.bearingInRadians),N=l-Math.round(l)+O*E+k*I,W=d-Math.round(d)+O*I+k*E,J=new Float64Array(S);if(c.M(J,J,[N>.5?N-1:N,W>.5?W-1:W,0]),this._alignedProjMatrix=J,S=c.aq(new Float64Array(16),this._pixelMatrix),!S)throw new Error("failed to invert matrix");this._pixelMatrixInverse=S,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.aw(a,a,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aj(1,this.center.lat)*this.worldSize;return Be(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,a){const l=c.a1.fromLngLat(e),d=[l.x*this.worldSize,l.y*this.worldSize,a,1];return c.aw(d,d,this._viewProjMatrix),d[2]/d[3]}getProjectionData(e){const{overscaledTileID:a,aligned:l,applyTerrainMatrix:d}=e,g=this._helper.getMercatorTileCoordinates(a),_=a?this.calculatePosMatrix(a,l,!0):null;let S;return S=a&&a.terrainRttPosMatrix32f&&d?a.terrainRttPosMatrix32f:_||c.b8(),{mainMatrix:S,tileMercatorCoords:g,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:S}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,a,l){return 1}transformLightDirection(e){return c.aT(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,a,l,d){const g=this.calculatePosMatrix(l);let _;d?(_=[e,a,d(e,a),1],c.aw(_,_,g)):(_=[e,a,0,1],cs(_,_,g));const S=_[3];return{point:new c.P(_[0]/S,_[1]/S),signedDistanceFromCamera:S,isOccluded:!1}}populateCache(e){for(const a of e)this.calculatePosMatrix(a)}getMatrixForModel(e,a){const l=c.a1.fromLngLat(e,a),d=l.meterInMercatorCoordinateUnits(),g=c.b9();return c.M(g,g,[l.x,l.y,l.z]),c.b6(g,g,Math.PI),c.b7(g,g,Math.PI/2),c.N(g,g,[-d,d,d]),g}getProjectionDataForCustomLayer(e=!0){const a=new c.Z(0,0,0,0,0),l=this.getProjectionData({overscaledTileID:a,applyGlobeMatrix:e}),d=be(a,this.worldSize);c.O(d,this._viewProjMatrix,d),l.tileMercatorCoords=[0,0,1,1];const g=[c.$,c.$,this.worldSize/this._helper.pixelsPerMeter],_=c.ba();return c.N(_,d,g),l.fallbackMatrix=_,l.mainMatrix=_,l}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function Ja(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function ui(f){if(f.useSlerp)if(f.k<1){const e=c.bb(f.startEulerAngles.roll,f.startEulerAngles.pitch,f.startEulerAngles.bearing),a=c.bb(f.endEulerAngles.roll,f.endEulerAngles.pitch,f.endEulerAngles.bearing),l=new Float64Array(4);c.bc(l,e,a,f.k);const d=c.bd(l);f.tr.setRoll(d.roll),f.tr.setPitch(d.pitch),f.tr.setBearing(d.bearing)}else f.tr.setRoll(f.endEulerAngles.roll),f.tr.setPitch(f.endEulerAngles.pitch),f.tr.setBearing(f.endEulerAngles.bearing);else f.tr.setRoll(c.C.number(f.startEulerAngles.roll,f.endEulerAngles.roll,f.k)),f.tr.setPitch(c.C.number(f.startEulerAngles.pitch,f.endEulerAngles.pitch,f.k)),f.tr.setBearing(c.C.number(f.startEulerAngles.bearing,f.endEulerAngles.bearing,f.k))}function hi(f,e,a,l,d){const g=d.padding,_=K(d.worldSize,a.getNorthWest()),S=K(d.worldSize,a.getNorthEast()),P=K(d.worldSize,a.getSouthEast()),E=K(d.worldSize,a.getSouthWest()),I=c.ae(-l),O=_.rotate(I),k=S.rotate(I),N=P.rotate(I),W=E.rotate(I),J=new c.P(Math.max(O.x,k.x,W.x,N.x),Math.max(O.y,k.y,W.y,N.y)),ee=new c.P(Math.min(O.x,k.x,W.x,N.x),Math.min(O.y,k.y,W.y,N.y)),te=J.sub(ee),ie=(d.width-(g.left+g.right+e.left+e.right))/te.x,le=(d.height-(g.top+g.bottom+e.top+e.bottom))/te.y;if(le<0||ie<0)return void Ja();const ae=Math.min(c.ak(d.scale*Math.min(ie,le)),f.maxZoom),ue=c.P.convert(f.offset),me=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.ae(l)),oe=ue.add(me).mult(d.scale/c.af(ae));return{center:se(d.worldSize,_.add(P).div(2).sub(oe)),zoom:ae,bearing:l}}class vr{get useGlobeControls(){return!1}handlePanInertia(e,a){const l=e.mag(),d=Math.abs(de(a));return{easingOffset:e.mult(Math.min(.75*d/l,1)),easingCenter:a.center}}handleMapControlsRollPitchBearingZoom(e,a){e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta),e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta)}handleMapControlsPan(e,a,l){e.around.distSqr(a.centerPoint)<.01||a.setLocationAtPoint(l,e.around)}cameraForBoxAndBearing(e,a,l,d,g){return hi(e,a,l,d,g)}handleJumpToCenterZoom(e,a){e.zoom!==(a.zoom!==void 0?+a.zoom:e.zoom)&&e.setZoom(+a.zoom),a.center!==void 0&&e.setCenter(c.S.convert(a.center))}handleEaseTo(e,a){const l=e.zoom,d=e.padding,g={roll:e.roll,pitch:e.pitch,bearing:e.bearing},_={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},S=a.zoom!==void 0,P=!e.isPaddingEqual(a.padding);let E=!1;const I=S?+a.zoom:e.zoom;let O=e.centerPoint.add(a.offsetAsPoint);const k=e.screenPointToLocation(O),{center:N,zoom:W}=e.getConstrained(c.S.convert(a.center||k),I??l);al(e,N);const J=K(e.worldSize,k),ee=K(e.worldSize,N).sub(J),te=c.af(W-l);return E=W!==l,{easeFunc:ie=>{if(E&&e.setZoom(c.C.number(l,W,ie)),c.be(g,_)||ui({startEulerAngles:g,endEulerAngles:_,tr:e,k:ie,useSlerp:g.roll!=_.roll}),P&&(e.interpolatePadding(d,a.padding,ie),O=e.centerPoint.add(a.offsetAsPoint)),a.around)e.setLocationAtPoint(a.around,a.aroundPoint);else{const le=c.af(e.zoom-l),ae=W>l?Math.min(2,te):Math.max(.5,te),ue=Math.pow(ae,1-ie),me=se(e.worldSize,J.add(ee.mult(ie*ue)).mult(le));e.setLocationAtPoint(e.renderWorldCopies?me.wrap():me,O)}},isZooming:E,elevationCenter:N}}handleFlyTo(e,a){const l=a.zoom!==void 0,d=e.zoom,g=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),l?+a.zoom:d),_=g.center,S=g.zoom;al(e,_);const P=K(e.worldSize,a.locationAtOffset),E=K(e.worldSize,_).sub(P),I=E.mag(),O=c.af(S-d);let k;if(a.minZoom!==void 0){const N=Math.min(+a.minZoom,d,S),W=e.getConstrained(_,N).zoom;k=c.af(W-d)}return{easeFunc:(N,W,J,ee)=>{e.setZoom(N===1?S:d+c.ak(W));const te=N===1?_:se(e.worldSize,P.add(E.mult(J)).mult(W));e.setLocationAtPoint(e.renderWorldCopies?te.wrap():te,ee)},scaleOfZoom:O,targetCenter:_,scaleOfMinZoom:k,pixelPathLength:I}}}class Hn{constructor(e,a,l){this.blendFunction=e,this.blendColor=a,this.mask=l}}Hn.Replace=[1,0],Hn.disabled=new Hn(Hn.Replace,c.bf.transparent,[!1,!1,!1,!1]),Hn.unblended=new Hn(Hn.Replace,c.bf.transparent,[!0,!0,!0,!0]),Hn.alphaBlended=new Hn([1,771],c.bf.transparent,[!0,!0,!0,!0]);const eo=2305;class Nt{constructor(e,a,l){this.enable=e,this.mode=a,this.frontFace=l}}Nt.disabled=new Nt(!1,1029,eo),Nt.backCCW=new Nt(!0,1029,eo),Nt.frontCCW=new Nt(!0,1028,eo);class Xt{constructor(e,a,l){this.func=e,this.mask=a,this.range=l}}Xt.ReadOnly=!1,Xt.ReadWrite=!0,Xt.disabled=new Xt(519,Xt.ReadOnly,[0,1]);const va=7680;class _n{constructor(e,a,l,d,g,_){this.test=e,this.ref=a,this.mask=l,this.fail=d,this.depthFail=g,this.pass=_}}_n.disabled=new _n({func:519,mask:0},0,0,va,va,va);const rr=new WeakMap;function vi(f){var e;if(rr.has(f))return rr.get(f);{const a=(e=f.getParameter(f.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return rr.set(f,a),a}}class aa{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const a=e.context,l=a.gl;this._texFormat=l.RGBA,this._texType=l.UNSIGNED_BYTE;const d=new c.aL;d.emplaceBack(-1,-1),d.emplaceBack(2,-1),d.emplaceBack(-1,2);const g=new c.aN;g.emplaceBack(0,1,2),this._fullscreenTriangle=new jo(a.createVertexBuffer(d,Qa.members),a.createIndexBuffer(g),c.aM.simpleSegment(0,0,d.length,g.length)),this._resultBuffer=new Uint8Array(4),a.activeTexture.set(l.TEXTURE1);const _=l.createTexture();l.bindTexture(l.TEXTURE_2D,_),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texImage2D(l.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=a.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(_),vi(l)&&(this._pbo=l.createBuffer(),l.bindBuffer(l.PIXEL_PACK_BUFFER,this._pbo),l.bufferData(l.PIXEL_PACK_BUFFER,4,l.STREAM_READ),l.bindBuffer(l.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,a){const l=this._updateCount;return this._readbackQueue?l>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():l>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,a),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,a=e.gl;e.activeTexture.set(a.TEXTURE1),a.bindTexture(a.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,a){const l=this._cachedRenderContext.context,d=l.gl;if(this._bindFramebuffer(),l.viewport.set([0,0,this._texWidth,this._texHeight]),l.clear({color:c.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(l,d.TRIANGLES,Xt.disabled,_n.disabled,Hn.unblended,Nt.disabled,((g,_)=>({u_input:g,u_output_expected:_}))(e,a),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&vi(d)){d.bindBuffer(d.PIXEL_PACK_BUFFER,this._pbo),d.readBuffer(d.COLOR_ATTACHMENT0),d.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),d.bindBuffer(d.PIXEL_PACK_BUFFER,null);const g=d.fenceSync(d.SYNC_GPU_COMMANDS_COMPLETE,0);d.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:g}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&vi(e)){const a=e.clientWaitSync(this._readbackQueue.sync,0,0);if(a===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(a===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=aa._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let a=0;return a+=e[0]/256,a+=e[1]/65536,a+=e[2]/16777216,e[3]<127&&(a=-a),a/128}}const Vo=c.$/128;function Lu(f,e){const a=f.granularity!==void 0?Math.max(f.granularity,1):1,l=a+(f.generateBorders?2:0),d=a+(f.extendToNorthPole||f.generateBorders?1:0)+(f.extendToSouthPole||f.generateBorders?1:0),g=l+1,_=d+1,S=f.generateBorders?-1:0,P=f.generateBorders||f.extendToNorthPole?-1:0,E=a+(f.generateBorders?1:0),I=a+(f.generateBorders||f.extendToSouthPole?1:0),O=g*_,k=l*d*6,N=g*_>65536;if(N&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const W=N||e==="32bit",J=new Int16Array(2*O);let ee=0;for(let le=P;le<=I;le++)for(let ae=S;ae<=E;ae++){let ue=ae/a*c.$;ae===-1&&(ue=-Vo),ae===a+1&&(ue=c.$+Vo);let me=le/a*c.$;le===-1&&(me=f.extendToNorthPole?c.bh:-Vo),le===a+1&&(me=f.extendToSouthPole?c.bi:c.$+Vo),J[ee++]=ue,J[ee++]=me}const te=W?new Uint32Array(k):new Uint16Array(k);let ie=0;for(let le=0;le<d;le++)for(let ae=0;ae<l;ae++){const ue=ae+1+le*g,me=ae+(le+1)*g,oe=ae+1+(le+1)*g;te[ie++]=ae+le*g,te[ie++]=me,te[ie++]=ue,te[ie++]=ue,te[ie++]=me,te[ie++]=oe}return{vertices:J.buffer.slice(0),indices:te.buffer.slice(0),uses32bitIndices:W}}const Ho=new c.aK({fill:new c.bj(128,2),line:new c.bj(512,0),tile:new c.bj(128,32),stencil:new c.bj(128,1),circle:3});class ps{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ea.projectionGlobe}get vertexShaderPreludeCode(){return Ea.projectionMercator.vertexSource}get subdivisionGranularity(){return Ho}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new aa(e));const a=c.U(this._errorQueryLatitudeDegrees),l=2*Math.atan(Math.exp(Math.PI-a*Math.PI*2))-.5*Math.PI,d=this._errorMeasurement.updateErrorLoop(a,l),g=ge.now();d!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=d,this._errorMeasurementLastChangeTime=g);const _=Math.min(Math.max((g-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.bl(_))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,a,l,d,g){const _=(g==="stencil"?Ho.stencil:Ho.tile).getGranularityForZoomLevel(a.z);return this._getMesh(e,{granularity:_,generateBorders:l,extendToNorthPole:a.y===0&&d,extendToSouthPole:a.y===(1<<a.z)-1&&d})}_getMesh(e,a){const l=this._getMeshKey(a);if(l in this._tileMeshCache)return this._tileMeshCache[l];const d=(function(g,_){const S=Lu(_,"16bit"),P=c.aL.deserialize({arrayBuffer:S.vertices,length:S.vertices.byteLength/2/2}),E=c.aN.deserialize({arrayBuffer:S.indices,length:S.indices.byteLength/2/3});return new jo(g.createVertexBuffer(P,Qa.members),g.createIndexBuffer(E),c.aM.simpleSegment(0,0,P.length,E.length))})(e,a);return this._tileMeshCache[l]=d,d}recalculate(e){}hasTransition(){const e=ge.now();let a=!1;return a=a||(e-this._errorMeasurementLastChangeTime)/1e3<.7,a=a||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,a}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const Go=new c.r({type:new c.D(c.v.projection.type)});class ms extends c.E{constructor(e){super(),this._transitionable=new c.t(Go,void 0),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.F(0)),this._mercatorProjection=new hn,this._verticalPerspectiveProjection=new ps}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bm){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,a,l,d,g){return this.currentProjection.getMeshFromTileID(e,a,l,d,g)}setProjection(e){this._transitionable.setValue("type",e?.type||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function Kl(f){const e=ol(f.worldSize,f.center.lat);return 2*Math.PI*e}function Ma(f,e,a,l,d){const g=1/(1<<d),_=e/c.$*g+l*g,S=c.bo((f/c.$*g+a*g)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI,E=Math.cos(P),I=new Float64Array(3);return I[0]=Math.sin(S)*E,I[1]=Math.sin(P),I[2]=Math.cos(S)*E,I}function Qr(f){return(function(e,a){const l=Math.cos(a),d=new Float64Array(3);return d[0]=Math.sin(e)*l,d[1]=Math.sin(a),d[2]=Math.cos(e)*l,d})(f.lng*Math.PI/180,f.lat*Math.PI/180)}function ol(f,e){return f/(2*Math.PI)/Math.cos(e*Math.PI/180)}function gs(f){const e=Math.asin(f[1])/Math.PI*180,a=Math.sqrt(f[0]*f[0]+f[2]*f[2]);if(a>1e-6){const l=f[0]/a,d=Math.acos(f[2]/a),g=(l>0?d:-d)/Math.PI*180;return new c.S(c.aO(g,-180,180),e)}return new c.S(0,e)}function ys(f){return Math.cos(f*Math.PI/180)}function wr(f,e){const a=ys(f),l=ys(e);return c.ak(l/a)}function Vh(f,e){const a=f.rotate(e.bearingInRadians),l=e.zoom+wr(e.center.lat,0),d=c.bk(1/ys(e.center.lat),1/ys(Math.min(Math.abs(e.center.lat),60)),c.bn(l,7,3,0,1)),g=360/Kl({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.S(e.center.lng-a.x*g*d,c.ah(e.center.lat+a.y*g,-c.ai,c.ai))}function Ql(f){const e=.5*f,a=Math.sin(e),l=Math.cos(e);return Math.log(a+l)-Math.log(l-a)}function ku(f,e,a,l){const d=f.lat+a*l;if(Math.abs(a)>1){const g=(Math.sign(f.lat+a)!==Math.sign(f.lat)?-Math.abs(f.lat):Math.abs(f.lat))*Math.PI/180,_=Math.abs(f.lat+a)*Math.PI/180,S=Ql(g+l*(_-g)),P=Ql(g),E=Ql(_);return new c.S(f.lng+e*((S-P)/(E-P)),d)}return new c.S(f.lng+e*l,d)}class Hh{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=e}swapBuffers(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(e,a,l,d){const g=`${e.z}_${e.x}_${e.y}_${d?.terrain?"t":""}`,_=this._cache.get(g);if(_)return _;const S=this._cachePrevious.get(g);if(S)return this._cache.set(g,S),S;const P=this._boundingVolumeFactory(e,a,l,d);return this._cache.set(g,P),this._hadAnyChanges=!0,P}}class sl{constructor(e,a,l,d){this.min=l,this.max=d,this.points=e,this.planes=a}static fromAabb(e,a){const l=[];for(let d=0;d<8;d++)l.push([1&~d?e[0]:a[0],(d>>1&1)==1?a[1]:e[1],(d>>2&1)==1?a[2]:e[2]]);return new sl(l,[[-1,0,0,a[0]],[1,0,0,-e[0]],[0,-1,0,a[1]],[0,1,0,-e[1]],[0,0,-1,a[2]],[0,0,1,-e[2]]],e,a)}static fromCenterSizeAngles(e,a,l){const d=c.br([],l[0],l[1],l[2]),g=c.bs([],[a[0],0,0],d),_=c.bs([],[0,a[1],0],d),S=c.bs([],[0,0,a[2]],d),P=[...e],E=[...e];for(let O=0;O<8;O++)for(let k=0;k<3;k++){const N=e[k]+g[k]*(1&~O?-1:1)+_[k]*((O>>1&1)==1?1:-1)+S[k]*((O>>2&1)==1?1:-1);P[k]=Math.min(P[k],N),E[k]=Math.max(E[k],N)}const I=[];for(let O=0;O<8;O++){const k=[...e];c.aS(k,k,c.aR([],g,1&~O?-1:1)),c.aS(k,k,c.aR([],_,(O>>1&1)==1?1:-1)),c.aS(k,k,c.aR([],S,(O>>2&1)==1?1:-1)),I.push(k)}return new sl(I,[[...g,-c.aX(g,I[0])],[..._,-c.aX(_,I[0])],[...S,-c.aX(S,I[0])],[-g[0],-g[1],-g[2],-c.aX(g,I[7])],[-_[0],-_[1],-_[2],-c.aX(_,I[7])],[-S[0],-S[1],-S[2],-c.aX(S,I[7])]],P,E)}intersectsFrustum(e){let a=!0;const l=this.points.length,d=this.planes.length,g=e.planes.length,_=e.points.length;for(let S=0;S<g;S++){const P=e.planes[S];let E=0;for(let I=0;I<l;I++){const O=this.points[I];P[0]*O[0]+P[1]*O[1]+P[2]*O[2]+P[3]>=0&&E++}if(E===0)return 0;E<l&&(a=!1)}if(a)return 2;for(let S=0;S<d;S++){const P=this.planes[S];let E=0;for(let I=0;I<_;I++){const O=e.points[I];P[0]*O[0]+P[1]*O[1]+P[2]*O[2]+P[3]>=0&&E++}if(E===0)return 0}return 1}intersectsPlane(e){const a=this.points.length;let l=0;for(let d=0;d<a;d++){const g=this.points[d];e[0]*g[0]+e[1]*g[1]+e[2]*g[2]+e[3]>=0&&l++}return l===a?2:l===0?0:1}}function di(f,e,a){const l=f-e;return l<0?-l:Math.max(0,l-a)}function Jl(f,e,a,l,d){const g=f-a;let _;return _=g<0?Math.min(-g,1+g-d):g>1?Math.min(Math.max(g-d,0),1-g):0,Math.max(_,di(e,l,d))}class to{constructor(){this._boundingVolumeCache=new Hh(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(e,a,l,d){const g=1<<l.z,_=1/g,S=l.x/g,P=l.y/g;let E=2;return E=Math.min(E,Jl(e,a,S,P,_)),E=Math.min(E,Jl(e,a,S+.5,-P-_,_)),E=Math.min(E,Jl(e,a,S+.5,2-P-_,_)),E}getWrap(e,a,l){const d=1<<a.z,g=1/d,_=a.x/d,S=di(e.x,_,g),P=di(e.x,_-1,g),E=di(e.x,_+1,g),I=Math.min(S,P,E);return I===E?1:I===P?-1:0}allowVariableZoom(e,a){return Pt(e,a)>4}allowWorldCopies(){return!1}getTileBoundingVolume(e,a,l,d){return this._boundingVolumeCache.getTileBoundingVolume(e,a,l,d)}_computeTileBoundingVolume(e,a,l,d){var g,_;let S=0,P=0;if(d?.terrain){const E=new c.Z(e.z,a,e.z,e.x,e.y),I=d.terrain.getMinMaxElevation(E);S=(g=I.minElevation)!==null&&g!==void 0?g:Math.min(0,l),P=(_=I.maxElevation)!==null&&_!==void 0?_:Math.max(0,l)}if(S/=c.bu,P/=c.bu,S+=1,P+=1,e.z<=0)return sl.fromAabb([-P,-P,-P],[P,P,P]);if(e.z===1)return sl.fromAabb([e.x===0?-P:0,e.y===0?0:-P,-P],[e.x===0?0:P,e.y===0?P:0,P]);{const E=[Ma(0,0,e.x,e.y,e.z),Ma(c.$,0,e.x,e.y,e.z),Ma(c.$,c.$,e.x,e.y,e.z),Ma(0,c.$,e.x,e.y,e.z)],I=[];for(const Oe of E)I.push(c.aR([],Oe,P));if(P!==S)for(const Oe of E)I.push(c.aR([],Oe,S));e.y===0&&I.push([0,1,0]),e.y===(1<<e.z)-1&&I.push([0,-1,0]);const O=[1,1,1],k=[-1,-1,-1];for(const Oe of I)for(let je=0;je<3;je++)O[je]=Math.min(O[je],Oe[je]),k[je]=Math.max(k[je],Oe[je]);const N=Ma(c.$/2,c.$/2,e.x,e.y,e.z),W=c.aW([],[0,1,0],N);c.aV(W,W);const J=c.aW([],N,W);c.aV(J,J);const ee=c.aW([],E[2],E[1]);c.aV(ee,ee);const te=c.aW([],E[0],E[3]);c.aV(te,te),I.push(c.aR([],N,P)),e.y>=(1<<e.z)/2&&I.push(c.aR([],Ma(c.$/2,0,e.x,e.y,e.z),P)),e.y<(1<<e.z)/2&&I.push(c.aR([],Ma(c.$/2,c.$,e.x,e.y,e.z),P));const ie=_s(N,I),le=_s(J,I),ae=[-N[0],-N[1],-N[2],ie.max],ue=[N[0],N[1],N[2],-ie.min],me=[-J[0],-J[1],-J[2],le.max],oe=[J[0],J[1],J[2],-le.min],Se=[...ee,0],Ue=[...te,0],Ie=[];return e.y===0?Ie.push(c.bt(Ue,Se,ae),c.bt(Ue,Se,ue)):Ie.push(c.bt(me,Se,ae),c.bt(me,Se,ue),c.bt(me,Ue,ae),c.bt(me,Ue,ue)),e.y===(1<<e.z)-1?Ie.push(c.bt(Ue,Se,ae),c.bt(Ue,Se,ue)):Ie.push(c.bt(oe,Se,ae),c.bt(oe,Se,ue),c.bt(oe,Ue,ae),c.bt(oe,Ue,ue)),new sl(Ie,[ae,ue,me,oe,Se,Ue],O,k)}}}function _s(f,e){let a=1/0,l=-1/0;for(const d of e){const g=c.aX(f,d);a=Math.min(a,g),l=Math.max(l,g)}return{min:a,max:l}}class ec{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a){this._helper.resize(e,a)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.bv(),this._projectionMatrix=c.b9(),this._globeViewProjMatrix32f=c.b8(),this._globeViewProjMatrixNoCorrection=c.b9(),this._globeViewProjMatrixNoCorrectionInverted=c.b9(),this._globeProjMatrixInverted=c.b9(),this._cameraPosition=c.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._coveringTilesDetailsProvider=new to}clone(){const e=new ec;return e.apply(this),e}apply(e,a){this._globeLatitudeErrorCorrectionRadians=a||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bp();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:a,applyGlobeMatrix:l}=e,d=this._helper.getMercatorTileCoordinates(a);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:d,clippingPlane:this._cachedClippingPlane,projectionTransition:l?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const a=this.pitchInRadians,l=this.cameraToCenterDistance/e,d=Math.sin(a)*l,g=Math.cos(a)*l+1,_=1/Math.sqrt(d*d+g*g)*1;let S=-d,P=g;const E=Math.sqrt(S*S+P*P);S/=E,P/=E;const I=[0,S,P];c.bw(I,I,[0,0,0],-this.bearingInRadians),c.bx(I,I,[0,0,0],-1*this.center.lat*Math.PI/180),c.by(I,I,[0,0,0],this.center.lng*Math.PI/180);const O=1/c.aZ(I);return c.aR(I,I,O),[...I,-_*O]}isLocationOccluded(e){return!this.isSurfacePointVisible(Qr(e))}transformLightDirection(e){const a=this._helper._center.lng*Math.PI/180,l=this._helper._center.lat*Math.PI/180,d=Math.cos(l),g=[Math.sin(a)*d,Math.sin(l),Math.cos(a)*d],_=[g[2],0,-g[0]],S=[0,0,0];c.aW(S,_,g),c.aV(_,_),c.aV(S,S);const P=[0,0,0];return c.aV(P,[_[0]*e[0]+S[0]*e[1]+g[0]*e[2],_[1]*e[0]+S[1]*e[1]+g[1]*e[2],_[2]*e[0]+S[2]*e[1]+g[2]*e[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,a,l){const d=(function(S,P,E){const I=1/(1<<E.z);return new c.a1(S/c.$*I+E.x*I,P/c.$*I+E.y*I)})(e,a,l.canonical),g=(_=d.y,[c.bo(d.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-_*Math.PI*2))-.5*Math.PI]);var _;return this.getCircleRadiusCorrection()/Math.cos(g[1])}projectTileCoordinates(e,a,l,d){const g=l.canonical,_=Ma(e,a,g.x,g.y,g.z),S=1+(d?d(e,a):0)/c.bu,P=[_[0]*S,_[1]*S,_[2]*S,1];c.aw(P,P,this._globeViewProjMatrixNoCorrection);const E=this._cachedClippingPlane,I=E[0]*_[0]+E[1]*_[1]+E[2]*_[2]+E[3]<0;return{point:new c.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:I}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=ol(this.worldSize,this.center.lat),a=c.ba(),l=c.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.b4(a,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const d=this.centerOffset;a[8]=2*-d.x/this._helper._width,a[9]=2*d.y/this._helper._height,this._projectionMatrix=c.b5(a),this._globeProjMatrixInverted=c.ba(),c.aq(this._globeProjMatrixInverted,a),c.M(a,a,[0,0,-this.cameraToCenterDistance]),c.b6(a,a,this.rollInRadians),c.b7(a,a,-this.pitchInRadians),c.b6(a,a,this.bearingInRadians),c.M(a,a,[0,0,-e]);const g=c.bp();g[0]=e,g[1]=e,g[2]=e,c.b7(l,a,this.center.lat*Math.PI/180),c.bz(l,l,-this.center.lng*Math.PI/180),c.N(l,l,g),this._globeViewProjMatrixNoCorrection=l,c.b7(a,a,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bz(a,a,-this.center.lng*Math.PI/180),c.N(a,a,g),this._globeViewProjMatrix32f=new Float32Array(a),this._globeViewProjMatrixNoCorrectionInverted=c.ba(),c.aq(this._globeViewProjMatrixNoCorrectionInverted,l);const _=c.bp();this._cameraPosition=c.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bw(this._cameraPosition,this._cameraPosition,_,-this.rollInRadians),c.bx(this._cameraPosition,this._cameraPosition,_,this.pitchInRadians),c.bw(this._cameraPosition,this._cameraPosition,_,-this.bearingInRadians),c.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bx(this._cameraPosition,this._cameraPosition,_,-this.center.lat*Math.PI/180),c.by(this._cameraPosition,this._cameraPosition,_,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const S=c.b5(this._globeViewProjMatrixNoCorrectionInverted);c.N(S,S,[1,1,-1]),this._cachedFrustum=Mr.fromInvProjectionMatrix(S,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const a=c.ba();return c.ag(a),a}getVisibleUnwrappedCoordinates(e){return[new c.b2(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){if(!this._globeViewProjMatrixNoCorrection)return 1;const l=Qr(e);c.aR(l,l,1+a/c.bu);const d=c.bv();return c.aw(d,[l[0],l[1],l[2],1],this._globeViewProjMatrixNoCorrection),d[2]/d[3]}populateCache(e){}getBounds(){const e=.5*this.width,a=.5*this.height,l=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,a),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,a)],d=[];for(const O of l)d.push(this.unprojectScreenPoint(O));let g=0,_=0,S=0,P=0;const E=this.center;for(const O of d){const k=c.bA(E.lng,O.lng),N=c.bA(E.lat,O.lat);k<_&&(_=k),k>g&&(g=k),N<P&&(P=N),N>S&&(S=N)}const I=[E.lng+_,E.lat+P,E.lng+g,E.lat+S];return this.isSurfacePointOnScreen([0,1,0])&&(I[3]=90,I[0]=-180,I[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(I[1]=-90,I[0]=-180,I[2]=180),new qt(I)}getConstrained(e,a){const l=c.ah(e.lat,-c.ai,c.ai),d=c.ah(+a,this.minZoom+wr(0,l),this.maxZoom);return{center:new c.S(e.lng,l),zoom:d}}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}setLocationAtPoint(e,a){const l=Qr(this.unprojectScreenPoint(a)),d=Qr(e),g=c.bp();c.bB(g);const _=c.bp();c.by(_,l,g,-this.center.lng*Math.PI/180),c.bx(_,_,g,this.center.lat*Math.PI/180);const S=d[0]*d[0]+d[2]*d[2],P=_[0]*_[0];if(S<P)return;const E=Math.sqrt(S-P),I=-E,O=c.bC(d[0],d[2],_[0],E),k=c.bC(d[0],d[2],_[0],I),N=c.bp();c.by(N,d,g,-O);const W=c.bC(N[1],N[2],_[1],_[2]),J=c.bp();c.by(J,d,g,-k);const ee=c.bC(J[1],J[2],_[1],_[2]),te=.5*Math.PI,ie=W>=-te&&W<=te,le=ee>=-te&&ee<=te;let ae,ue;if(ie&&le){const Ue=this.center.lng*Math.PI/180,Ie=this.center.lat*Math.PI/180;c.bD(O,Ue)+c.bD(W,Ie)<c.bD(k,Ue)+c.bD(ee,Ie)?(ae=O,ue=W):(ae=k,ue=ee)}else if(ie)ae=O,ue=W;else{if(!le)return;ae=k,ue=ee}const me=ae/Math.PI*180,oe=ue/Math.PI*180,Se=this.center.lat;this.setCenter(new c.S(me,c.ah(oe,-90,90))),this.setZoom(this.zoom+wr(Se,this.center.lat))}locationToScreenPoint(e,a){const l=Qr(e);if(a){const d=a.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aR(l,l,1+d/c.bu)}return this._projectSurfacePointToScreen(l)}_projectSurfacePointToScreen(e){const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],new c.P((.5*a[0]+.5)*this.width,(.5*-a[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,a){if(a){const l=a.pointCoordinate(e);if(l)return l}return c.a1.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,a){var l;return(l=this.screenPointToMercatorCoordinate(e,a))===null||l===void 0?void 0:l.toLngLat()}isPointOnMapSurface(e,a){const l=this._cameraPosition,d=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(l,d)}getRayDirectionFromPixel(e){const a=c.bv();a[0]=e.x/this.width*2-1,a[1]=-1*(e.y/this.height*2-1),a[2]=1,a[3]=1,c.aw(a,a,this._globeViewProjMatrixNoCorrectionInverted),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3];const l=c.bp();l[0]=a[0]-this._cameraPosition[0],l[1]=a[1]-this._cameraPosition[1],l[2]=a[2]-this._cameraPosition[2];const d=c.bp();return c.aV(d,l),d}isSurfacePointVisible(e){const a=this._cachedClippingPlane;return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]+a[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const a=c.bv();return c.aw(a,[...e,1],this._globeViewProjMatrixNoCorrection),a[0]/=a[3],a[1]/=a[3],a[2]/=a[3],a[0]>-1&&a[0]<1&&a[1]>-1&&a[1]<1&&a[2]>-1&&a[2]<1}rayPlanetIntersection(e,a){const l=c.aX(e,a),d=c.bp(),g=c.bp();c.aR(g,a,l),c.aU(d,e,g);const _=1-c.aX(d,d);if(_<0)return null;const S=c.aX(e,e)-1,P=-l+(l<0?1:-1)*Math.sqrt(_),E=S/P,I=P;return{tMin:Math.min(E,I),tMax:Math.max(E,I)}}unprojectScreenPoint(e){const a=this._cameraPosition,l=this.getRayDirectionFromPixel(e),d=this.rayPlanetIntersection(a,l);if(d){const I=c.bp();c.aS(I,a,[l[0]*d.tMin,l[1]*d.tMin,l[2]*d.tMin]);const O=c.bp();return c.aV(O,I),gs(O)}const g=this._cachedClippingPlane,_=g[0]*l[0]+g[1]*l[1]+g[2]*l[2],S=-c.b1(g,a)/_,P=c.bp();if(S>0)c.aS(P,a,[l[0]*S,l[1]*S,l[2]*S]);else{const I=c.bp();c.aS(I,a,[2*l[0],2*l[1],2*l[2]]);const O=c.b1(this._cachedClippingPlane,I);c.aU(P,I,[this._cachedClippingPlane[0]*O,this._cachedClippingPlane[1]*O,this._cachedClippingPlane[2]*O])}const E=(function(I){const O=c.bp();return O[0]=I[0]*-I[3],O[1]=I[1]*-I[3],O[2]=I[2]*-I[3],{center:O,radius:Math.sqrt(1-I[3]*I[3])}})(g);return gs((function(I,O,k){const N=c.bp();c.aU(N,k,I);const W=c.bp();return c.bq(W,I,N,O/c.a$(N)),W})(E.center,E.radius,P))}getMatrixForModel(e,a){const l=c.S.convert(e),d=1/c.bu,g=c.b9();return c.bz(g,g,l.lng/180*Math.PI),c.b7(g,g,-l.lat/180*Math.PI),c.M(g,g,[0,0,1+a/c.bu]),c.b7(g,g,.5*Math.PI),c.N(g,g,[d,d,d]),g}getProjectionDataForCustomLayer(e=!0){const a=this.getProjectionData({overscaledTileID:new c.Z(0,0,0,0,0),applyGlobeMatrix:e});return a.tileMercatorCoords=[0,0,1,1],a}getFastPathSimpleProjectionMatrix(e){}}class tc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,a,l){return this._helper.interpolatePadding(e,a,l)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,a,l=!0){this._helper.resize(e,a,l)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,a){this._helper.overrideNearFarZ(e,a)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,a){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=a,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new Nr({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,a)=>this.getConstrained(e,a)}),this._globeness=1,this._mercatorTransform=new Rn,this._verticalPerspectiveTransform=new ec}clone(){const e=new tc;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const a=this._mercatorTransform.getProjectionData(e),l=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?l.mainMatrix:a.mainMatrix,clippingPlane:l.clippingPlane,tileMercatorCoords:l.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:a.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,a,l){const d=this._mercatorTransform.getPitchedTextCorrection(e,a,l),g=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,a,l);return c.bk(d,g,this._globeness)}projectTileCoordinates(e,a,l,d){return this.currentTransform.projectTileCoordinates(e,a,l,d)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,a){return this.currentTransform.lngLatToCameraDepth(e,a)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,a){return this.currentTransform.getConstrained(e,a)}calculateCenterFromCameraLngLatAlt(e,a,l,d){return this._helper.calculateCenterFromCameraLngLatAlt(e,a,l,d)}setLocationAtPoint(e,a){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,a),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,a),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,a){return this.currentTransform.locationToScreenPoint(e,a)}screenPointToMercatorCoordinate(e,a){return this.currentTransform.screenPointToMercatorCoordinate(e,a)}screenPointToLocation(e,a){return this.currentTransform.screenPointToLocation(e,a)}isPointOnMapSurface(e,a){return this.currentTransform.isPointOnMapSurface(e,a)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,a){return this.currentTransform.getMatrixForModel(e,a)}getProjectionDataForCustomLayer(e=!0){const a=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return a;const l=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return l.fallbackMatrix=a.mainMatrix,l}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class xi{get useGlobeControls(){return!0}handlePanInertia(e,a){const l=Vh(e,a);return Math.abs(l.lng-a.center.lng)>180&&(l.lng=a.center.lng+179.5*Math.sign(l.lng-a.center.lng)),{easingCenter:l,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,a){const l=e.around,d=a.screenPointToLocation(l);e.bearingDelta&&a.setBearing(a.bearing+e.bearingDelta),e.pitchDelta&&a.setPitch(a.pitch+e.pitchDelta),e.rollDelta&&a.setRoll(a.roll+e.rollDelta);const g=a.zoom;e.zoomDelta&&a.setZoom(a.zoom+e.zoomDelta);const _=a.zoom-g;if(_===0)return;const S=c.bA(a.center.lng,d.lng),P=S/(Math.abs(S/180)+1),E=c.bA(a.center.lat,d.lat),I=a.getRayDirectionFromPixel(l),O=a.cameraPosition,k=-1*c.aX(O,I),N=c.bp();c.aS(N,O,[I[0]*k,I[1]*k,I[2]*k]);const W=c.aZ(N)-1,J=Math.exp(.5*-Math.max(W-.3,0)),ee=ol(a.worldSize,a.center.lat)/Math.min(a.width,a.height),te=c.bn(ee,.9,.5,1,.25),ie=(1-c.af(-_))*Math.min(J,te),le=a.center.lat,ae=a.zoom,ue=new c.S(a.center.lng+P*ie,c.ah(a.center.lat+E*ie,-c.ai,c.ai));a.setLocationAtPoint(d,l);const me=a.center,oe=c.bn(Math.abs(S),45,85,0,1),Se=c.bn(ee,.75,.35,0,1),Ue=Math.pow(Math.max(oe,Se),.25),Ie=c.bA(me.lng,ue.lng),Oe=c.bA(me.lat,ue.lat);a.setCenter(new c.S(me.lng+Ie*Ue,me.lat+Oe*Ue).wrap()),a.setZoom(ae+wr(le,a.center.lat))}handleMapControlsPan(e,a,l){if(!e.panDelta)return;const d=a.center.lat,g=a.zoom;a.setCenter(Vh(e.panDelta,a).wrap()),a.setZoom(g+wr(d,a.center.lat))}cameraForBoxAndBearing(e,a,l,d,g){const _=hi(e,a,l,d,g),S=a.left/g.width*2-1,P=(g.width-a.right)/g.width*2-1,E=a.top/g.height*-2+1,I=(g.height-a.bottom)/g.height*-2+1,O=c.bA(l.getWest(),l.getEast())<0,k=O?l.getEast():l.getWest(),N=O?l.getWest():l.getEast(),W=Math.max(l.getNorth(),l.getSouth()),J=Math.min(l.getNorth(),l.getSouth()),ee=k+.5*c.bA(k,N),te=W+.5*c.bA(W,J),ie=g.clone();ie.setCenter(_.center),ie.setBearing(_.bearing),ie.setPitch(0),ie.setRoll(0),ie.setZoom(_.zoom);const le=ie.modelViewProjectionMatrix,ae=[Qr(l.getNorthWest()),Qr(l.getNorthEast()),Qr(l.getSouthWest()),Qr(l.getSouthEast()),Qr(new c.S(N,te)),Qr(new c.S(k,te)),Qr(new c.S(ee,W)),Qr(new c.S(ee,J))],ue=Qr(_.center);let me=Number.POSITIVE_INFINITY;for(const oe of ae)S<0&&(me=xi.getLesserNonNegativeNonNull(me,xi.solveVectorScale(oe,ue,le,"x",S))),P>0&&(me=xi.getLesserNonNegativeNonNull(me,xi.solveVectorScale(oe,ue,le,"x",P))),E>0&&(me=xi.getLesserNonNegativeNonNull(me,xi.solveVectorScale(oe,ue,le,"y",E))),I<0&&(me=xi.getLesserNonNegativeNonNull(me,xi.solveVectorScale(oe,ue,le,"y",I)));if(Number.isFinite(me)&&me!==0)return _.zoom=ie.zoom+c.ak(me),_;Ja()}handleJumpToCenterZoom(e,a){const l=e.center.lat,d=e.getConstrained(a.center?c.S.convert(a.center):e.center,e.zoom).center;e.setCenter(d.wrap());const g=a.zoom!==void 0?+a.zoom:e.zoom+wr(l,d.lat);e.zoom!==g&&e.setZoom(g)}handleEaseTo(e,a){const l=e.zoom,d=e.center,g=e.padding,_={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:a.roll===void 0?e.roll:a.roll,pitch:a.pitch===void 0?e.pitch:a.pitch,bearing:a.bearing===void 0?e.bearing:a.bearing},P=a.zoom!==void 0,E=!e.isPaddingEqual(a.padding);let I=!1;const O=a.center?c.S.convert(a.center):d,k=e.getConstrained(O,l).center;al(e,k);const N=e.clone();N.setCenter(k),N.setZoom(P?+a.zoom:l+wr(d.lat,O.lat)),N.setBearing(a.bearing);const W=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));N.setLocationAtPoint(k,W);const J=(a.offset&&a.offsetAsPoint.mag())>0?N.center:k,ee=P?+a.zoom:l+wr(d.lat,J.lat),te=l+wr(d.lat,0),ie=ee+wr(J.lat,0),le=c.bA(d.lng,J.lng),ae=c.bA(d.lat,J.lat),ue=c.af(ie-te);return I=ee!==l,{easeFunc:me=>{if(c.be(_,S)||ui({startEulerAngles:_,endEulerAngles:S,tr:e,k:me,useSlerp:_.roll!=S.roll}),E&&e.interpolatePadding(g,a.padding,me),a.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(a.around,a.aroundPoint);else{const oe=ie>te?Math.min(2,ue):Math.max(.5,ue),Se=Math.pow(oe,1-me),Ue=ku(d,le,ae,me*Se);e.setCenter(Ue.wrap())}if(I){const oe=c.C.number(te,ie,me)+wr(0,e.center.lat);e.setZoom(oe)}},isZooming:I,elevationCenter:J}}handleFlyTo(e,a){const l=a.zoom!==void 0,d=e.center,g=e.zoom,_=e.padding,S=!e.isPaddingEqual(a.padding),P=e.getConstrained(c.S.convert(a.center||a.locationAtOffset),g).center,E=l?+a.zoom:e.zoom+wr(e.center.lat,P.lat),I=e.clone();I.setCenter(P),I.setZoom(E),I.setBearing(a.bearing);const O=new c.P(c.ah(e.centerPoint.x+a.offsetAsPoint.x,0,e.width),c.ah(e.centerPoint.y+a.offsetAsPoint.y,0,e.height));I.setLocationAtPoint(P,O);const k=I.center;al(e,k);const N=(function(ae,ue,me){const oe=Qr(ue),Se=Qr(me),Ue=c.aX(oe,Se),Ie=Math.acos(Ue),Oe=Kl(ae);return Ie/(2*Math.PI)*Oe})(e,d,k),W=g+wr(d.lat,0),J=E+wr(k.lat,0),ee=c.af(J-W);let te;if(typeof a.minZoom=="number"){const ae=+a.minZoom+wr(k.lat,0),ue=Math.min(ae,W,J)+wr(0,k.lat),me=e.getConstrained(k,ue).zoom+wr(k.lat,0);te=c.af(me-W)}const ie=c.bA(d.lng,k.lng),le=c.bA(d.lat,k.lat);return{easeFunc:(ae,ue,me,oe)=>{const Se=ku(d,ie,le,me);S&&e.interpolatePadding(_,a.padding,ae);const Ue=ae===1?k:Se;e.setCenter(Ue.wrap());const Ie=W+c.ak(ue);e.setZoom(ae===1?E:Ie+wr(0,Ue.lat))},scaleOfZoom:ee,targetCenter:k,scaleOfMinZoom:te,pixelPathLength:N}}static solveVectorScale(e,a,l,d,g){const _=d==="x"?[l[0],l[4],l[8],l[12]]:[l[1],l[5],l[9],l[13]],S=[l[3],l[7],l[11],l[15]],P=e[0]*_[0]+e[1]*_[1]+e[2]*_[2],E=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],I=a[0]*_[0]+a[1]*_[1]+a[2]*_[2],O=a[0]*S[0]+a[1]*S[1]+a[2]*S[2];return I+g*E===P+g*O||S[3]*(P-I)+_[3]*(O-E)+P*O==I*E?null:(I+_[3]-g*O-g*S[3])/(I-P-g*O+g*E)}static getLesserNonNegativeNonNull(e,a){return a!==null&&a>=0&&a<e?a:e}}class Ou{constructor(e){this._globe=e,this._mercatorCameraHelper=new vr,this._verticalPerspectiveCameraHelper=new xi}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,a){return this.currentHelper.handlePanInertia(e,a)}handleMapControlsRollPitchBearingZoom(e,a){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,a)}handleMapControlsPan(e,a,l){this.currentHelper.handleMapControlsPan(e,a,l)}cameraForBoxAndBearing(e,a,l,d,g){return this.currentHelper.cameraForBoxAndBearing(e,a,l,d,g)}handleJumpToCenterZoom(e,a){this.currentHelper.handleJumpToCenterZoom(e,a)}handleEaseTo(e,a){return this.currentHelper.handleEaseTo(e,a)}handleFlyTo(e,a){return this.currentHelper.handleFlyTo(e,a)}}const Vc=(f,e)=>c.y(f,e&&e.filter((a=>a.identifier!=="source.canvas"))),Od=c.bE();class Bu extends c.E{constructor(e,a={}){var l,d;super(),this._rtlPluginLoaded=()=>{for(const _ in this.sourceCaches){const S=this.sourceCaches[_].getSource().type;S!=="vector"&&S!=="geojson"||this.sourceCaches[_].reload()}},this.map=e,this.dispatcher=new It(Kt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",((_,S)=>this.getGlyphs(_,S))),this.dispatcher.registerMessageHandler("GI",((_,S)=>this.getImages(_,S))),this.imageManager=new Bt,this.imageManager.setEventedParent(this);const g=((l=e._container)===null||l===void 0?void 0:l.lang)||typeof document<"u"&&((d=document.documentElement)===null||d===void 0?void 0:d.lang)||void 0;this.glyphManager=new jn(e._requestManager,a.localIdeographFontFamily,g),this.lineAtlas=new Et(256,512),this.crossTileSymbolIndex=new ds,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",c.bG()),gr().on(qa,this._rtlPluginLoaded),this.on("data",(_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const S=this.sourceCaches[_.sourceId];if(!S)return;const P=S.getSource();if(P&&P.vectorLayerIds)for(const E in this._layers){const I=this._layers[E];I.source===P.id&&this._validateLayer(I)}}))}setGlobalStateProperty(e,a){var l,d,g;this._checkLoaded();const _=a===null?(g=(d=(l=this.stylesheet.state)===null||l===void 0?void 0:l[e])===null||d===void 0?void 0:d.default)!==null&&g!==void 0?g:null:a;if(c.bH(_,this._globalState[e]))return this;this._globalState[e]=_,this._applyGlobalStateChanges([e])}getGlobalState(){return this._globalState}setGlobalState(e){this._checkLoaded();const a=[];for(const l in e)!c.bH(this._globalState[l],e[l].default)&&(a.push(l),this._globalState[l]=e[l].default);this._applyGlobalStateChanges(a)}_applyGlobalStateChanges(e){if(e.length===0)return;const a=new Set,l={};for(const d of e){l[d]=this._globalState[d];for(const g in this._layers){const _=this._layers[g],S=_.getLayoutAffectingGlobalStateRefs(),P=_.getPaintAffectingGlobalStateRefs();if(S.has(d)&&a.add(_.source),P.has(d))for(const{name:E,value:I}of P.get(d))this._updatePaintProperty(_,E,I)}}this.dispatcher.broadcast("UGS",l);for(const d in this.sourceCaches)a.has(d)&&(this._reloadSource(d),this._changed=!0)}loadURL(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;const d=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const g=this._loadStyleRequest;c.j(d,this._loadStyleRequest).then((_=>{this._loadStyleRequest=null,this._load(_.data,a,l)})).catch((_=>{this._loadStyleRequest=null,_&&!g.signal.aborted&&this.fire(new c.k(_))}))}loadJSON(e,a={},l){this.fire(new c.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,ge.frameAsync(this._frameRequest).then((()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,l)})).catch((()=>{}))}loadEmpty(){this.fire(new c.l("dataloading",{dataType:"style"})),this._load(Od,{validate:!1})}_load(e,a,l){var d,g;let _=a.transformStyle?a.transformStyle(l,e):e;if(!a.validate||!Vc(this,c.z(_))){_=Object.assign({},_),this._loaded=!0,this.stylesheet=_;for(const S in _.sources)this.addSource(S,_.sources[S],{validate:!1});_.sprite?this._loadSprite(_.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(_.glyphs),this._createLayers(),this.light=new We(this.stylesheet.light),this._setProjectionInternal(((d=this.stylesheet.projection)===null||d===void 0?void 0:d.type)||"mercator"),this.sky=new rt(this.stylesheet.sky),this.map.setTerrain((g=this.stylesheet.terrain)!==null&&g!==void 0?g:null),this.fire(new c.l("data",{dataType:"style"})),this.fire(new c.l("style.load"))}}_createLayers(){var e;const a=c.bI(this.stylesheet.layers);this.setGlobalState((e=this.stylesheet.state)!==null&&e!==void 0?e:null),this.dispatcher.broadcast("SL",a),this._order=a.map((l=>l.id)),this._layers={},this._serializedLayers=null;for(const l of a){const d=c.bJ(l,this._globalState);d.setEventedParent(this,{layer:{id:l.id}}),this._layers[l.id]=d}}_loadSprite(e,a=!1,l=void 0){let d;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,(function(g,_,S,P){return c._(this,void 0,void 0,(function*(){const E=wt(g),I=S>1?"@2x":"",O={},k={};for(const{id:N,url:W}of E){const J=_.transformRequest(ft(W,I,".json"),"SpriteJSON");O[N]=c.j(J,P);const ee=_.transformRequest(ft(W,I,".png"),"SpriteImage");k[N]=it.getImage(ee,P)}return yield Promise.all([...Object.values(O),...Object.values(k)]),(function(N,W){return c._(this,void 0,void 0,(function*(){const J={};for(const ee in N){J[ee]={};const te=ge.getImageCanvasContext((yield W[ee]).data),ie=(yield N[ee]).data;for(const le in ie){const{width:ae,height:ue,x:me,y:oe,sdf:Se,pixelRatio:Ue,stretchX:Ie,stretchY:Oe,content:je,textFitWidth:pt,textFitHeight:ht}=ie[le];J[ee][le]={data:null,pixelRatio:Ue,sdf:Se,stretchX:Ie,stretchY:Oe,content:je,textFitWidth:pt,textFitHeight:ht,spriteData:{width:ae,height:ue,x:me,y:oe,context:te}}}}return J}))})(O,k)}))})(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then((g=>{if(this._spriteRequest=null,g)for(const _ in g){this._spritesImagesIds[_]=[];const S=this._spritesImagesIds[_]?this._spritesImagesIds[_].filter((P=>!(P in g))):[];for(const P of S)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in g[_]){const E=_==="default"?P:`${_}:${P}`;this._spritesImagesIds[_].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,g[_][P],!1):this.imageManager.addImage(E,g[_][P]),a&&(this._changedImages[E]=!0)}}})).catch((g=>{this._spriteRequest=null,d=g,this.fire(new c.k(d))})).finally((()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"})),l&&l(d)}))}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}_validateLayer(e){const a=this.sourceCaches[e.source];if(!a)return;const l=e.sourceLayer;if(!l)return;const d=a.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(l)===-1)&&this.fire(new c.k(new Error(`Source layer "${l}" does not exist on source "${d.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){const l=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?c.bK(l):l);const d=[];for(const g of e)if(l[g]){const _=a?c.bK(l[g]):l[g];d.push(_)}return d}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const a=Object.keys(this._layers);for(const l of a){const d=this._layers[l];d.type!=="custom"&&(e[l]=d.serialize())}return e}hasTransitions(){var e,a,l;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((a=this.sky)===null||a===void 0)&&a.hasTransition()||!((l=this.projection)===null||l===void 0)&&l.hasTransition())return!0;for(const d in this.sourceCaches)if(this.sourceCaches[d].hasTransition())return!0;for(const d in this._layers)if(this._layers[d].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const a=this._changed;if(a){const d=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(d.length||g.length)&&this._updateWorkerLayers(d,g);for(const _ in this._updatedSources){const S=this._updatedSources[_];if(S==="reload")this._reloadSource(_);else{if(S!=="clear")throw new Error(`Invalid action ${S}`);this._clearSource(_)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const _ in this._updatedPaintProps)this._layers[_].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const l={};for(const d in this.sourceCaches){const g=this.sourceCaches[d];l[d]=g.used,g.used=!1}for(const d of this._order){const g=this._layers[d];g.recalculate(e,this._availableImages),!g.isHidden(e.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const d in l){const g=this.sourceCaches[d];!!l[d]!=!!g.used&&g.fire(new c.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,a&&this.fire(new c.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var l;this._checkLoaded();const d=this.serialize();if(e=a.transformStyle?a.transformStyle(d,e):e,((l=a.validate)===null||l===void 0||l)&&Vc(this,c.z(e)))return!1;(e=c.bK(e)).layers=c.bI(e.layers);const g=c.bL(d,e),_=this._getOperationsToPerform(g);if(_.unimplemented.length>0)throw new Error(`Unimplemented: ${_.unimplemented.join(", ")}.`);if(_.operations.length===0)return!1;for(const S of _.operations)S();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const a=[],l=[];for(const d of e)switch(d.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":a.push((()=>this.addLayer.apply(this,d.args)));break;case"removeLayer":a.push((()=>this.removeLayer.apply(this,d.args)));break;case"setPaintProperty":a.push((()=>this.setPaintProperty.apply(this,d.args)));break;case"setLayoutProperty":a.push((()=>this.setLayoutProperty.apply(this,d.args)));break;case"setFilter":a.push((()=>this.setFilter.apply(this,d.args)));break;case"addSource":a.push((()=>this.addSource.apply(this,d.args)));break;case"removeSource":a.push((()=>this.removeSource.apply(this,d.args)));break;case"setLayerZoomRange":a.push((()=>this.setLayerZoomRange.apply(this,d.args)));break;case"setLight":a.push((()=>this.setLight.apply(this,d.args)));break;case"setGeoJSONSourceData":a.push((()=>this.setGeoJSONSourceData.apply(this,d.args)));break;case"setGlyphs":a.push((()=>this.setGlyphs.apply(this,d.args)));break;case"setSprite":a.push((()=>this.setSprite.apply(this,d.args)));break;case"setTerrain":a.push((()=>this.map.setTerrain.apply(this,d.args)));break;case"setSky":a.push((()=>this.setSky.apply(this,d.args)));break;case"setProjection":this.setProjection.apply(this,d.args);break;case"setGlobalState":a.push((()=>this.setGlobalState.apply(this,d.args)));break;case"setTransition":a.push((()=>{}));break;default:l.push(d.command)}return{operations:a,unimplemented:l}}addImage(e,a){if(this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.k(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,l={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(c.z.source,`sources.${e}`,a,null,l))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const d=this.sourceCaches[e]=new dn(e,a,this.dispatcher);d.style=this,d.setEventedParent(this,(()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:e}))),d.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const l in this._layers)if(this._layers[l].source===e)return this.fire(new c.k(new Error(`Source "${e}" cannot be removed while layer "${l}" is using it.`)));const a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new c.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const l=this.sourceCaches[e].getSource();if(l.type!=="geojson")throw new Error(`geojsonSource.type is ${l.type}, which is !== 'geojson`);l.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,l={}){this._checkLoaded();const d=e.id;if(this.getLayer(d))return void this.fire(new c.k(new Error(`Layer "${d}" already exists on this map.`)));let g;if(e.type==="custom"){if(Vc(this,c.bM(e)))return;g=c.bJ(e,this._globalState)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(d,e.source),e=c.bK(e),e=c.e(e,{source:d})),this._validate(c.z.layer,`layers.${d}`,e,{arrayIndex:-1},l))return;g=c.bJ(e,this._globalState),this._validateLayer(g),g.setEventedParent(this,{layer:{id:d}})}const _=a?this._order.indexOf(a):this._order.length;if(a&&_===-1)this.fire(new c.k(new Error(`Cannot add layer "${d}" before non-existing layer "${a}".`)));else{if(this._order.splice(_,0,d),this._layerOrderChanged=!0,this._layers[d]=g,this._removedLayers[d]&&g.source&&g.type!=="custom"){const S=this._removedLayers[d];delete this._removedLayers[d],S.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.k(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;const l=this._order.indexOf(e);this._order.splice(l,1);const d=a?this._order.indexOf(a):this._order.length;a&&d===-1?this.fire(new c.k(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(d,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const a=this._layers[e];if(!a)return void this.fire(new c.k(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);const l=this._order.indexOf(e);this._order.splice(l,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,l){this._checkLoaded();const d=this.getLayer(e);d?d.minzoom===a&&d.maxzoom===l||(a!=null&&(d.minzoom=a),l!=null&&(d.maxzoom=l),this._updateLayer(d)):this.fire(new c.k(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,l={}){this._checkLoaded();const d=this.getLayer(e);if(d){if(!c.bH(d.filter,a))return a==null?(d.setFilter(void 0),void this._updateLayer(d)):void(this._validate(c.z.filter,`layers.${d.id}.filter`,a,null,l)||(d.setFilter(c.bK(a)),this._updateLayer(d)))}else this.fire(new c.k(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bK(this.getLayer(e).filter)}setLayoutProperty(e,a,l,d={}){this._checkLoaded();const g=this.getLayer(e);g?c.bH(g.getLayoutProperty(a),l)||(g.setLayoutProperty(a,l,d),this._updateLayer(g)):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){const l=this.getLayer(e);if(l)return l.getLayoutProperty(a);this.fire(new c.k(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,l,d={}){this._checkLoaded();const g=this.getLayer(e);g?c.bH(g.getPaintProperty(a),l)||this._updatePaintProperty(g,a,l,d):this.fire(new c.k(new Error(`Cannot style non-existing layer "${e}".`)))}_updatePaintProperty(e,a,l,d={}){e.setPaintProperty(a,l,d)&&this._updateLayer(e),this._changed=!0,this._updatedPaintProps[e.id]=!0,this._serializedLayers=null}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();const l=e.source,d=e.sourceLayer,g=this.sourceCaches[l];if(g===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const _=g.getSource().type;_==="geojson"&&d?this.fire(new c.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):_!=="vector"||d?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),g.setFeatureState(d,e.id,a)):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();const l=e.source,d=this.sourceCaches[l];if(d===void 0)return void this.fire(new c.k(new Error(`The source '${l}' does not exist in the map's style.`)));const g=d.getSource().type,_=g==="vector"?e.sourceLayer:void 0;g!=="vector"||_?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.k(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(_,e.id,a):this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const a=e.source,l=e.sourceLayer,d=this.sourceCaches[a];if(d!==void 0)return d.getSource().type!=="vector"||l?(e.id===void 0&&this.fire(new c.k(new Error("The feature id parameter must be provided."))),d.getFeatureState(l,e.id)):void this.fire(new c.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.k(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bN(this.sourceCaches,(g=>g.serialize())),a=this._serializeByIds(this._order,!0),l=this.map.getTerrain()||void 0,d=this.stylesheet;return c.bO({version:d.version,name:d.name,metadata:d.metadata,light:d.light,sky:d.sky,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,projection:d.projection,sources:e,layers:a,terrain:l},(g=>g!==void 0))}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const a=_=>this._layers[_].type==="fill-extrusion",l={},d=[];for(let _=this._order.length-1;_>=0;_--){const S=this._order[_];if(a(S)){l[S]=_;for(const P of e){const E=P[S];if(E)for(const I of E)d.push(I)}}}d.sort(((_,S)=>S.intersectionZ-_.intersectionZ));const g=[];for(let _=this._order.length-1;_>=0;_--){const S=this._order[_];if(a(S))for(let P=d.length-1;P>=0;P--){const E=d[P].feature;if(l[E.layer.id]<_)break;g.push(E),d.pop()}else for(const P of e){const E=P[S];if(E)for(const I of E)g.push(I.feature)}}return g}queryRenderedFeatures(e,a,l){a&&a.filter&&this._validate(c.z.filter,"queryRenderedFeatures.filter",a.filter,null,a);const d={};if(a&&a.layers){if(!(Array.isArray(a.layers)||a.layers instanceof Set))return this.fire(new c.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const E of a.layers){const I=this._layers[E];if(!I)return this.fire(new c.k(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];d[I.source]=!0}}const g=[];a.availableImages=this._availableImages;const _=this._serializedAllLayers(),S=a.layers instanceof Set?a.layers:Array.isArray(a.layers)?new Set(a.layers):null,P=Object.assign(Object.assign({},a),{layers:S,globalState:this._globalState});for(const E in this.sourceCaches)a.layers&&!d[E]||g.push(En(this.sourceCaches[E],this._layers,_,e,P,l,this.map.terrain?(I,O,k)=>this.map.terrain.getElevation(I,O,k):void 0));return this.placement&&g.push((function(E,I,O,k,N,W,J){const ee={},te=W.queryRenderedSymbols(k),ie=[];for(const le of Object.keys(te).map(Number))ie.push(J[le]);ie.sort(tr);for(const le of ie){const ae=le.featureIndex.lookupSymbolFeatures(te[le.bucketInstanceId],I,le.bucketIndex,le.sourceLayerIndex,{filterSpec:N.filter,globalState:N.globalState},N.layers,N.availableImages,E);for(const ue in ae){const me=ee[ue]=ee[ue]||[],oe=ae[ue];oe.sort(((Se,Ue)=>{const Ie=le.featureSortOrder;if(Ie){const Oe=Ie.indexOf(Se.featureIndex);return Ie.indexOf(Ue.featureIndex)-Oe}return Ue.featureIndex-Se.featureIndex}));for(const Se of oe)me.push(Se)}}return(function(le,ae,ue){for(const me in le)for(const oe of le[me])xn(oe,ue[ae[me].source]);return le})(ee,E,O)})(this._layers,_,this.sourceCaches,e,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(e,a){a?.filter&&this._validate(c.z.filter,"querySourceFeatures.filter",a.filter,null,a);const l=this.sourceCaches[e];return l?(function(d,g){const _=d.getRenderableIds().map((E=>d.getTileByID(E))),S=[],P={};for(let E=0;E<_.length;E++){const I=_[E],O=I.tileID.canonical.key;P[O]||(P[O]=!0,I.querySourceFeatures(S,g))}return S})(l,a?Object.assign(Object.assign({},a),{globalState:this._globalState}):{globalState:this._globalState}):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();const l=this.light.getLight();let d=!1;for(const _ in e)if(!c.bH(e[_],l[_])){d=!0;break}if(!d)return;const g={now:ge.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(g)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){this._checkLoaded();const l=this.getSky();let d=!1;if(!e&&!l)return;if(e&&!l)d=!0;else if(!e&&l)d=!0;else for(const _ in e)if(!c.bH(e[_],l[_])){d=!0;break}if(!d)return;const g={now:ge.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(g)}_setProjectionInternal(e){const a=(function(l){if(Array.isArray(l)){const d=new ms({type:l});return{projection:d,transform:new tc,cameraHelper:new Ou(d)}}switch(l){case"mercator":return{projection:new hn,transform:new Rn,cameraHelper:new vr};case"globe":{const d=new ms({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:d,transform:new tc,cameraHelper:new Ou(d)}}case"vertical-perspective":return{projection:new ps,transform:new ec,cameraHelper:new xi};default:return c.w(`Unknown projection name: ${l}. Falling back to mercator projection.`),{projection:new hn,transform:new Rn,cameraHelper:new vr}}})(e);this.projection=a.projection,this.map.migrateProjection(a.transform,a.cameraHelper);for(const l in this.sourceCaches)this.sourceCaches[l].reload()}_validate(e,a,l,d,g={}){return(!g||g.validate!==!1)&&Vc(this,e.call(c.z,c.e({key:a,style:this.serialize(),value:l,styleSpec:c.v},d)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),gr().off(qa,this._rtlPluginLoaded);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this.sourceCaches){const l=this.sourceCaches[a];l.setEventedParent(null),l.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,l,d,g=!1){let _=!1,S=!1;const P={};for(const E of this._order){const I=this._layers[E];if(I.type!=="symbol")continue;if(!P[I.source]){const k=this.sourceCaches[I.source];P[I.source]=k.getRenderableIds(!0).map((N=>k.getTileByID(N))).sort(((N,W)=>W.tileID.overscaledZ-N.tileID.overscaledZ||(N.tileID.isLessThan(W.tileID)?-1:1)))}const O=this.crossTileSymbolIndex.addLayer(I,P[I.source],e.center.lng);_=_||O}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||l===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(ge.now(),e.zoom))&&(this.pauseablePlacement=new Xl(e,this.map.terrain,this._order,g,a,l,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(ge.now()),S=!0),_&&this.pauseablePlacement.placement.setStale()),S||_)for(const E of this._order){const I=this._layers[E];I.type==="symbol"&&this.placement.updateLayerOpacities(I,P[I.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(ge.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();const d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,a.icons),l}))}getGlyphs(e,a){return c._(this,void 0,void 0,(function*(){const l=yield this.glyphManager.getGlyphs(a.stacks),d=this.sourceCaches[a.source];return d&&d.setDependencies(a.tileID.key,a.type,[""]),l}))}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(c.z.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,a,l={},d){this._checkLoaded();const g=[{id:e,url:a}],_=[...wt(this.stylesheet.sprite),...g];this._validate(c.z.sprite,"sprite",_,null,l)||(this.stylesheet.sprite=_,this._loadSprite(g,!0,d))}removeSprite(e){this._checkLoaded();const a=wt(this.stylesheet.sprite);if(a.find((l=>l.id===e))){if(this._spritesImagesIds[e])for(const l of this._spritesImagesIds[e])this.imageManager.removeImage(l),this._changedImages[l]=!0;a.splice(a.findIndex((l=>l.id===e)),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.l("data",{dataType:"style"}))}else this.fire(new c.k(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return wt(this.stylesheet.sprite)}setSprite(e,a={},l){this._checkLoaded(),e&&this._validate(c.z.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,l):(this._unloadSprite(),l&&l(null)))}}var Bd=c.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Fd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,l,d,g,_,S,P,E){this.context=e;let I=this.boundPaintVertexBuffers.length!==d.length;for(let O=0;!I&&O<d.length;O++)this.boundPaintVertexBuffers[O]!==d[O]&&(I=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==l||I||this.boundIndexBuffer!==g||this.boundVertexOffset!==_||this.boundDynamicVertexBuffer!==S||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==E?this.freshBind(a,l,d,g,_,S,P,E):(e.bindVertexArray.set(this.vao),S&&S.bind(),g&&g.dynamicDraw&&g.bind(),P&&P.bind(),E&&E.bind())}freshBind(e,a,l,d,g,_,S,P){const E=e.numAttributes,I=this.context,O=I.gl;this.vao&&this.destroy(),this.vao=I.createVertexArray(),I.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=l,this.boundIndexBuffer=d,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=_,this.boundDynamicVertexBuffer2=S,this.boundDynamicVertexBuffer3=P,a.enableAttributes(O,e);for(const k of l)k.enableAttributes(O,e);_&&_.enableAttributes(O,e),S&&S.enableAttributes(O,e),P&&P.enableAttributes(O,e),a.bind(),a.setVertexAttribPointers(O,e,g);for(const k of l)k.bind(),k.setVertexAttribPointers(O,e,g);_&&(_.bind(),_.setVertexAttribPointers(O,e,g)),d&&d.bind(),S&&(S.bind(),S.setVertexAttribPointers(O,e,g)),P&&(P.bind(),P.setVertexAttribPointers(O,e,g)),I.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const Hc=(f,e,a,l,d)=>({u_texture:0,u_ele_delta:f,u_fog_matrix:e,u_fog_color:a?a.properties.get("fog-color"):c.bf.white,u_fog_ground_blend:a?a.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:d?0:a?a.calculateFogBlendOpacity(l):0,u_horizon_color:a?a.properties.get("horizon-color"):c.bf.white,u_horizon_fog_blend:a?a.properties.get("horizon-fog-blend"):1,u_is_globe_mode:d?1:0}),Fu={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function vs(f){const e=[];for(let a=0;a<f.length;a++){if(f[a]===null)continue;const l=f[a].split(" ");e.push(l.pop())}return e}class Nu{constructor(e,a,l,d,g,_,S,P,E=[]){const I=e.gl;this.program=I.createProgram();const O=vs(a.staticAttributes),k=l?l.getBinderAttributes():[],N=O.concat(k),W=Ea.prelude.staticUniforms?vs(Ea.prelude.staticUniforms):[],J=S.staticUniforms?vs(S.staticUniforms):[],ee=a.staticUniforms?vs(a.staticUniforms):[],te=l?l.getBinderUniforms():[],ie=W.concat(J).concat(ee).concat(te),le=[];for(const Ie of ie)le.indexOf(Ie)<0&&le.push(Ie);const ae=l?l.defines():[];vi(I)&&ae.unshift("#version 300 es"),g&&ae.push("#define OVERDRAW_INSPECTOR;"),_&&ae.push("#define TERRAIN3D;"),P&&ae.push(P),E&&ae.push(...E);let ue=ae.concat(Ea.prelude.fragmentSource,S.fragmentSource,a.fragmentSource).join(`
`),me=ae.concat(Ea.prelude.vertexSource,S.vertexSource,a.vertexSource).join(`
`);vi(I)||(ue=(function(Ie){return Ie.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")})(ue),me=(function(Ie){return Ie.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")})(me));const oe=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(oe,ue),I.compileShader(oe),!I.getShaderParameter(oe,I.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${I.getShaderInfoLog(oe)}`);I.attachShader(this.program,oe);const Se=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);if(I.shaderSource(Se,me),I.compileShader(Se),!I.getShaderParameter(Se,I.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${I.getShaderInfoLog(Se)}`);I.attachShader(this.program,Se),this.attributes={};const Ue={};this.numAttributes=N.length;for(let Ie=0;Ie<this.numAttributes;Ie++)N[Ie]&&(I.bindAttribLocation(this.program,Ie,N[Ie]),this.attributes[N[Ie]]=Ie);if(I.linkProgram(this.program),!I.getProgramParameter(this.program,I.LINK_STATUS))throw new Error(`Program failed to link: ${I.getProgramInfoLog(this.program)}`);I.deleteShader(Se),I.deleteShader(oe);for(let Ie=0;Ie<le.length;Ie++){const Oe=le[Ie];if(Oe&&!Ue[Oe]){const je=I.getUniformLocation(this.program,Oe);je&&(Ue[Oe]=je)}}this.fixedUniforms=d(e,Ue),this.terrainUniforms=((Ie,Oe)=>({u_depth:new c.bP(Ie,Oe.u_depth),u_terrain:new c.bP(Ie,Oe.u_terrain),u_terrain_dim:new c.bg(Ie,Oe.u_terrain_dim),u_terrain_matrix:new c.bR(Ie,Oe.u_terrain_matrix),u_terrain_unpack:new c.bS(Ie,Oe.u_terrain_unpack),u_terrain_exaggeration:new c.bg(Ie,Oe.u_terrain_exaggeration)}))(e,Ue),this.projectionUniforms=((Ie,Oe)=>({u_projection_matrix:new c.bR(Ie,Oe.u_projection_matrix),u_projection_tile_mercator_coords:new c.bS(Ie,Oe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bS(Ie,Oe.u_projection_clipping_plane),u_projection_transition:new c.bg(Ie,Oe.u_projection_transition),u_projection_fallback_matrix:new c.bR(Ie,Oe.u_projection_fallback_matrix)}))(e,Ue),this.binderUniforms=l?l.getUniforms(e,Ue):[]}draw(e,a,l,d,g,_,S,P,E,I,O,k,N,W,J,ee,te,ie,le){const ae=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(l),e.setStencilMode(d),e.setColorMode(g),e.setCullFace(_),P){e.activeTexture.set(ae.TEXTURE2),ae.bindTexture(ae.TEXTURE_2D,P.depthTexture),e.activeTexture.set(ae.TEXTURE3),ae.bindTexture(ae.TEXTURE_2D,P.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(P[me])}if(E)for(const me in E)this.projectionUniforms[Fu[me]].set(E[me]);if(S)for(const me in this.fixedUniforms)this.fixedUniforms[me].set(S[me]);ee&&ee.setUniforms(e,this.binderUniforms,W,{zoom:J});let ue=0;switch(a){case ae.LINES:ue=2;break;case ae.TRIANGLES:ue=3;break;case ae.LINE_STRIP:ue=1}for(const me of N.get()){const oe=me.vaos||(me.vaos={});(oe[I]||(oe[I]=new Fd)).bind(e,this,O,ee?ee.getPaintVertexBuffers():[],k,me.vertexOffset,te,ie,le),ae.drawElements(a,me.primitiveLength*ue,ae.UNSIGNED_SHORT,me.primitiveOffset*ue*2)}}}function ll(f,e,a){const l=1/c.aC(a,1,e.transform.tileZoom),d=Math.pow(2,a.tileID.overscaledZ),g=a.tileSize*Math.pow(2,e.transform.tileZoom)/d,_=g*(a.tileID.canonical.x+a.tileID.wrap*d),S=g*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[l,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[_>>16,S>>16],u_pixel_coord_lower:[65535&_,65535&S]}}const Di=(f,e,a,l)=>{const d=f.style.light,g=d.properties.get("position"),_=[g.x,g.y,g.z],S=c.bV();d.properties.get("anchor")==="viewport"&&c.bW(S,f.transform.bearingInRadians),c.bX(_,_,S);const P=f.transform.transformLightDirection(_),E=d.properties.get("color");return{u_lightpos:_,u_lightpos_globe:P,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[E.r,E.g,E.b],u_vertical_gradient:+e,u_opacity:a,u_fill_translate:l}},Nd=(f,e,a,l,d,g,_)=>c.e(Di(f,e,a,l),ll(g,f,_),{u_height_factor:-Math.pow(2,d.overscaledZ)/_.tileSize/8}),nc=(f,e,a,l)=>c.e(ll(e,f,a),{u_fill_translate:l}),cl=(f,e)=>({u_world:f,u_fill_translate:e}),ul=(f,e,a,l,d)=>c.e(nc(f,e,a,d),{u_world:l}),Gh=(f,e,a,l,d)=>{const g=f.transform;let _,S,P=0;if(a.paint.get("circle-pitch-alignment")==="map"){const E=c.aC(e,1,g.zoom);_=!0,S=[E,E],P=E/(c.$*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*d}else _=!1,S=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(a.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+_,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:S,u_globe_extrude_scale:P,u_translate:l}},rc=f=>({u_pixel_extrude_scale:[1/f.width,1/f.height]}),hl=f=>({u_viewport_size:[f.width,f.height]}),xs=(f,e=1)=>({u_color:f,u_overlay:0,u_overlay_scale:e}),Zh=(f,e,a,l)=>{const d=c.aC(f,1,e)/(c.$*Math.pow(2,f.tileID.overscaledZ))*2*Math.PI*l;return{u_extrude_scale:c.aC(f,1,e),u_intensity:a,u_globe_extrude_scale:d}},Uu=(f,e,a,l)=>{const d=c.L();c.bY(d,0,f.width,f.height,0,0,1);const g=f.context.gl;return{u_matrix:d,u_world:[g.drawingBufferWidth,g.drawingBufferHeight],u_image:a,u_color_ramp:l,u_opacity:e.paint.get("heatmap-opacity")}},qh=(f,e,a)=>{const l=a.paint.get("hillshade-accent-color");let d;switch(a.paint.get("hillshade-method")){case"basic":d=4;break;case"combined":d=1;break;case"igor":d=2;break;case"multidirectional":d=3;break;default:d=0}const g=a.getIlluminationProperties();for(let _=0;_<g.directionRadians.length;_++)a.paint.get("hillshade-illumination-anchor")==="viewport"&&(g.directionRadians[_]+=f.transform.bearingInRadians);return{u_image:0,u_latrange:bs(0,e.tileID),u_exaggeration:a.paint.get("hillshade-exaggeration"),u_altitudes:g.altitudeRadians,u_azimuths:g.directionRadians,u_accent:l,u_method:d,u_highlights:g.highlightColor,u_shadows:g.shadowColor}},ju=(f,e)=>{const a=e.stride,l=c.L();return c.bY(l,0,c.$,-c.$,0,0,1),c.M(l,l,[0,-c.$,0]),{u_matrix:l,u_image:1,u_dimension:[a,a],u_zoom:f.overscaledZ,u_unpack:e.getUnpackVector()}};function bs(f,e){const a=Math.pow(2,e.canonical.z),l=e.canonical.y;return[new c.a1(0,l/a).toLngLat().lat,new c.a1(0,(l+1)/a).toLngLat().lat]}const dl=(f,e,a=0)=>({u_image:0,u_unpack:e.getUnpackVector(),u_dimension:[e.stride,e.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:a,u_opacity:f.paint.get("color-relief-opacity")}),Gc=(f,e,a,l)=>{const d=f.transform;return{u_translation:oc(f,e,a),u_ratio:l/c.aC(e,1,d.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},ic=(f,e,a,l,d)=>c.e(Gc(f,e,a,l),{u_image:0,u_image_height:d}),Vu=(f,e,a,l,d)=>{const g=f.transform,_=ac(e,g);return{u_translation:oc(f,e,a),u_texsize:e.imageAtlasTexture.size,u_ratio:l/c.aC(e,1,g.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[_,d.fromScale,d.toScale],u_fade:d.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},Zo=(f,e,a,l,d,g)=>{const _=f.lineAtlas,S=ac(e,f.transform),P=a.layout.get("line-cap")==="round",E=_.getDash(d.from,P),I=_.getDash(d.to,P),O=E.width*g.fromScale,k=I.width*g.toScale;return c.e(Gc(f,e,a,l),{u_patternscale_a:[S/O,-E.height/2],u_patternscale_b:[S/k,-I.height/2],u_sdfgamma:_.width/(256*Math.min(O,k)*f.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:I.y,u_mix:g.t})};function ac(f,e){return 1/c.aC(f,1,e.tileZoom)}function oc(f,e,a){return c.aD(f.transform,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}const fl=(f,e,a,l,d)=>{return{u_tl_parent:f,u_scale_parent:e,u_buffer_scale:1,u_fade_t:a.mix,u_opacity:a.opacity*l.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:l.paint.get("raster-brightness-min"),u_brightness_high:l.paint.get("raster-brightness-max"),u_saturation_factor:(_=l.paint.get("raster-saturation"),_>0?1-1/(1.001-_):-_),u_contrast_factor:(g=l.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:Wh(l.paint.get("raster-hue-rotate")),u_coords_top:[d[0].x,d[0].y,d[1].x,d[1].y],u_coords_bottom:[d[3].x,d[3].y,d[2].x,d[2].y]};var g,_};function Wh(f){f*=Math.PI/180;const e=Math.sin(f),a=Math.cos(f);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}const pl=(f,e,a,l,d,g,_,S,P,E,I,O,k)=>{const N=_.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:N.cameraToCenterDistance,u_pitch:N.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:N.width/N.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_label_plane_matrix:S,u_coord_matrix:P,u_is_text:+I,u_pitch_with_map:+l,u_is_along_line:d,u_is_variable_anchor:g,u_texsize:O,u_texture:0,u_translation:E,u_pitched_scale:k}},$h=(f,e,a,l,d,g,_,S,P,E,I,O,k,N)=>{const W=_.transform;return c.e(pl(f,e,a,l,d,g,_,S,P,E,I,O,N),{u_gamma_scale:l?Math.cos(W.pitch*Math.PI/180)*W.cameraToCenterDistance:1,u_device_pixel_ratio:_.pixelRatio,u_is_halo:1})},Ud=(f,e,a,l,d,g,_,S,P,E,I,O,k)=>c.e($h(f,e,a,l,d,g,_,S,P,E,!0,I,0,k),{u_texsize_icon:O,u_texture_icon:1}),Xh=(f,e)=>({u_opacity:f,u_color:e}),Yh=(f,e,a,l,d)=>c.e((function(g,_,S,P){const E=S.imageManager.getPattern(g.from.toString()),I=S.imageManager.getPattern(g.to.toString()),{width:O,height:k}=S.imageManager.getPixelSize(),N=Math.pow(2,P.tileID.overscaledZ),W=P.tileSize*Math.pow(2,S.transform.tileZoom)/N,J=W*(P.tileID.canonical.x+P.tileID.wrap*N),ee=W*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:E.tl,u_pattern_br_a:E.br,u_pattern_tl_b:I.tl,u_pattern_br_b:I.br,u_texsize:[O,k],u_mix:_.t,u_pattern_size_a:E.displaySize,u_pattern_size_b:I.displaySize,u_scale_a:_.fromScale,u_scale_b:_.toScale,u_tile_units_to_pixels:1/c.aC(P,1,S.transform.tileZoom),u_pixel_coord_upper:[J>>16,ee>>16],u_pixel_coord_lower:[65535&J,65535&ee]}})(a,d,e,l),{u_opacity:f}),Hu=(f,e)=>{},Ii={fillExtrusion:(f,e)=>({u_lightpos:new c.bT(f,e.u_lightpos),u_lightpos_globe:new c.bT(f,e.u_lightpos_globe),u_lightintensity:new c.bg(f,e.u_lightintensity),u_lightcolor:new c.bT(f,e.u_lightcolor),u_vertical_gradient:new c.bg(f,e.u_vertical_gradient),u_opacity:new c.bg(f,e.u_opacity),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillExtrusionPattern:(f,e)=>({u_lightpos:new c.bT(f,e.u_lightpos),u_lightpos_globe:new c.bT(f,e.u_lightpos_globe),u_lightintensity:new c.bg(f,e.u_lightintensity),u_lightcolor:new c.bT(f,e.u_lightcolor),u_vertical_gradient:new c.bg(f,e.u_vertical_gradient),u_height_factor:new c.bg(f,e.u_height_factor),u_opacity:new c.bg(f,e.u_opacity),u_fill_translate:new c.bU(f,e.u_fill_translate),u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade)}),fill:(f,e)=>({u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillPattern:(f,e)=>({u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillOutline:(f,e)=>({u_world:new c.bU(f,e.u_world),u_fill_translate:new c.bU(f,e.u_fill_translate)}),fillOutlinePattern:(f,e)=>({u_world:new c.bU(f,e.u_world),u_image:new c.bP(f,e.u_image),u_texsize:new c.bU(f,e.u_texsize),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade),u_fill_translate:new c.bU(f,e.u_fill_translate)}),circle:(f,e)=>({u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_scale_with_map:new c.bP(f,e.u_scale_with_map),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_extrude_scale:new c.bU(f,e.u_extrude_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.bg(f,e.u_globe_extrude_scale),u_translate:new c.bU(f,e.u_translate)}),collisionBox:(f,e)=>({u_pixel_extrude_scale:new c.bU(f,e.u_pixel_extrude_scale)}),collisionCircle:(f,e)=>({u_viewport_size:new c.bU(f,e.u_viewport_size)}),debug:(f,e)=>({u_color:new c.bQ(f,e.u_color),u_overlay:new c.bP(f,e.u_overlay),u_overlay_scale:new c.bg(f,e.u_overlay_scale)}),depth:Hu,clippingMask:Hu,heatmap:(f,e)=>({u_extrude_scale:new c.bg(f,e.u_extrude_scale),u_intensity:new c.bg(f,e.u_intensity),u_globe_extrude_scale:new c.bg(f,e.u_globe_extrude_scale)}),heatmapTexture:(f,e)=>({u_matrix:new c.bR(f,e.u_matrix),u_world:new c.bU(f,e.u_world),u_image:new c.bP(f,e.u_image),u_color_ramp:new c.bP(f,e.u_color_ramp),u_opacity:new c.bg(f,e.u_opacity)}),hillshade:(f,e)=>({u_image:new c.bP(f,e.u_image),u_latrange:new c.bU(f,e.u_latrange),u_exaggeration:new c.bg(f,e.u_exaggeration),u_altitudes:new c.b_(f,e.u_altitudes),u_azimuths:new c.b_(f,e.u_azimuths),u_accent:new c.bQ(f,e.u_accent),u_method:new c.bP(f,e.u_method),u_shadows:new c.bZ(f,e.u_shadows),u_highlights:new c.bZ(f,e.u_highlights)}),hillshadePrepare:(f,e)=>({u_matrix:new c.bR(f,e.u_matrix),u_image:new c.bP(f,e.u_image),u_dimension:new c.bU(f,e.u_dimension),u_zoom:new c.bg(f,e.u_zoom),u_unpack:new c.bS(f,e.u_unpack)}),colorRelief:(f,e)=>({u_image:new c.bP(f,e.u_image),u_unpack:new c.bS(f,e.u_unpack),u_dimension:new c.bU(f,e.u_dimension),u_elevation_stops:new c.bP(f,e.u_elevation_stops),u_color_stops:new c.bP(f,e.u_color_stops),u_color_ramp_size:new c.bP(f,e.u_color_ramp_size),u_opacity:new c.bg(f,e.u_opacity)}),line:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels)}),lineGradient:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_image:new c.bP(f,e.u_image),u_image_height:new c.bg(f,e.u_image_height)}),linePattern:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_texsize:new c.bU(f,e.u_texsize),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_image:new c.bP(f,e.u_image),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_scale:new c.bT(f,e.u_scale),u_fade:new c.bg(f,e.u_fade)}),lineSDF:(f,e)=>({u_translation:new c.bU(f,e.u_translation),u_ratio:new c.bg(f,e.u_ratio),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_units_to_pixels:new c.bU(f,e.u_units_to_pixels),u_patternscale_a:new c.bU(f,e.u_patternscale_a),u_patternscale_b:new c.bU(f,e.u_patternscale_b),u_sdfgamma:new c.bg(f,e.u_sdfgamma),u_image:new c.bP(f,e.u_image),u_tex_y_a:new c.bg(f,e.u_tex_y_a),u_tex_y_b:new c.bg(f,e.u_tex_y_b),u_mix:new c.bg(f,e.u_mix)}),raster:(f,e)=>({u_tl_parent:new c.bU(f,e.u_tl_parent),u_scale_parent:new c.bg(f,e.u_scale_parent),u_buffer_scale:new c.bg(f,e.u_buffer_scale),u_fade_t:new c.bg(f,e.u_fade_t),u_opacity:new c.bg(f,e.u_opacity),u_image0:new c.bP(f,e.u_image0),u_image1:new c.bP(f,e.u_image1),u_brightness_low:new c.bg(f,e.u_brightness_low),u_brightness_high:new c.bg(f,e.u_brightness_high),u_saturation_factor:new c.bg(f,e.u_saturation_factor),u_contrast_factor:new c.bg(f,e.u_contrast_factor),u_spin_weights:new c.bT(f,e.u_spin_weights),u_coords_top:new c.bS(f,e.u_coords_top),u_coords_bottom:new c.bS(f,e.u_coords_bottom)}),symbolIcon:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texture:new c.bP(f,e.u_texture),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),symbolSDF:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texture:new c.bP(f,e.u_texture),u_gamma_scale:new c.bg(f,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_is_halo:new c.bP(f,e.u_is_halo),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),symbolTextAndIcon:(f,e)=>({u_is_size_zoom_constant:new c.bP(f,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bP(f,e.u_is_size_feature_constant),u_size_t:new c.bg(f,e.u_size_t),u_size:new c.bg(f,e.u_size),u_camera_to_center_distance:new c.bg(f,e.u_camera_to_center_distance),u_pitch:new c.bg(f,e.u_pitch),u_rotate_symbol:new c.bP(f,e.u_rotate_symbol),u_aspect_ratio:new c.bg(f,e.u_aspect_ratio),u_fade_change:new c.bg(f,e.u_fade_change),u_label_plane_matrix:new c.bR(f,e.u_label_plane_matrix),u_coord_matrix:new c.bR(f,e.u_coord_matrix),u_is_text:new c.bP(f,e.u_is_text),u_pitch_with_map:new c.bP(f,e.u_pitch_with_map),u_is_along_line:new c.bP(f,e.u_is_along_line),u_is_variable_anchor:new c.bP(f,e.u_is_variable_anchor),u_texsize:new c.bU(f,e.u_texsize),u_texsize_icon:new c.bU(f,e.u_texsize_icon),u_texture:new c.bP(f,e.u_texture),u_texture_icon:new c.bP(f,e.u_texture_icon),u_gamma_scale:new c.bg(f,e.u_gamma_scale),u_device_pixel_ratio:new c.bg(f,e.u_device_pixel_ratio),u_is_halo:new c.bP(f,e.u_is_halo),u_translation:new c.bU(f,e.u_translation),u_pitched_scale:new c.bg(f,e.u_pitched_scale)}),background:(f,e)=>({u_opacity:new c.bg(f,e.u_opacity),u_color:new c.bQ(f,e.u_color)}),backgroundPattern:(f,e)=>({u_opacity:new c.bg(f,e.u_opacity),u_image:new c.bP(f,e.u_image),u_pattern_tl_a:new c.bU(f,e.u_pattern_tl_a),u_pattern_br_a:new c.bU(f,e.u_pattern_br_a),u_pattern_tl_b:new c.bU(f,e.u_pattern_tl_b),u_pattern_br_b:new c.bU(f,e.u_pattern_br_b),u_texsize:new c.bU(f,e.u_texsize),u_mix:new c.bg(f,e.u_mix),u_pattern_size_a:new c.bU(f,e.u_pattern_size_a),u_pattern_size_b:new c.bU(f,e.u_pattern_size_b),u_scale_a:new c.bg(f,e.u_scale_a),u_scale_b:new c.bg(f,e.u_scale_b),u_pixel_coord_upper:new c.bU(f,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bU(f,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.bg(f,e.u_tile_units_to_pixels)}),terrain:(f,e)=>({u_texture:new c.bP(f,e.u_texture),u_ele_delta:new c.bg(f,e.u_ele_delta),u_fog_matrix:new c.bR(f,e.u_fog_matrix),u_fog_color:new c.bQ(f,e.u_fog_color),u_fog_ground_blend:new c.bg(f,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.bg(f,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bQ(f,e.u_horizon_color),u_horizon_fog_blend:new c.bg(f,e.u_horizon_fog_blend),u_is_globe_mode:new c.bg(f,e.u_is_globe_mode)}),terrainDepth:(f,e)=>({u_ele_delta:new c.bg(f,e.u_ele_delta)}),terrainCoords:(f,e)=>({u_texture:new c.bP(f,e.u_texture),u_terrain_coords_id:new c.bg(f,e.u_terrain_coords_id),u_ele_delta:new c.bg(f,e.u_ele_delta)}),projectionErrorMeasurement:(f,e)=>({u_input:new c.bg(f,e.u_input),u_output_expected:new c.bg(f,e.u_output_expected)}),atmosphere:(f,e)=>({u_sun_pos:new c.bT(f,e.u_sun_pos),u_atmosphere_blend:new c.bg(f,e.u_atmosphere_blend),u_globe_position:new c.bT(f,e.u_globe_position),u_globe_radius:new c.bg(f,e.u_globe_radius),u_inv_proj_matrix:new c.bR(f,e.u_inv_proj_matrix)}),sky:(f,e)=>({u_sky_color:new c.bQ(f,e.u_sky_color),u_horizon_color:new c.bQ(f,e.u_horizon_color),u_horizon:new c.bU(f,e.u_horizon),u_horizon_normal:new c.bU(f,e.u_horizon_normal),u_sky_horizon_blend:new c.bg(f,e.u_sky_horizon_blend),u_sky_blend:new c.bg(f,e.u_sky_blend)})};class ml{constructor(e,a,l){this.context=e;const d=e.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!l,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const sc={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class no{constructor(e,a,l,d){this.length=a.length,this.attributes=l,this.itemSize=a.bytesPerElement,this.dynamicDraw=d,this.context=e;const g=e.gl;this.buffer=g.createBuffer(),e.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let l=0;l<this.attributes.length;l++){const d=a.attributes[this.attributes[l].name];d!==void 0&&e.enableVertexAttribArray(d)}}setVertexAttribPointers(e,a,l){for(let d=0;d<this.attributes.length;d++){const g=this.attributes[d],_=a.attributes[g.name];_!==void 0&&e.vertexAttribPointer(_,g.components,e[sc[g.type]],!1,this.itemSize,g.offset+this.itemSize*(l||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Sn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Zc extends Sn{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class lc extends Sn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class Kh extends Sn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class qo extends Sn{getDefault(){return[!0,!0,!0,!0]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class vo extends Sn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class ws extends Sn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Gu extends Sn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Qh extends Sn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Ss extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class gl extends Sn{getDefault(){return[0,1]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class qc extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class Jh extends Sn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Wo extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class cc extends Sn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class uc extends Sn{getDefault(){return c.bf.transparent}set(e){const a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class hc extends Sn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Zu extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class Ps extends Sn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class dc extends Sn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class Cs extends Sn{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class oa extends Sn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class Wc extends Sn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class xa extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class $c extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Jr extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class zi extends Sn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class xo extends Sn{getDefault(){return null}set(e){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Ts extends Sn{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;const l=this.gl;vi(l)?l.bindVertexArray(e):(a=l.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class As extends Sn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class fc extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class $o extends Sn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class sa extends Sn{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class qu extends sa{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class yl extends sa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class sn extends sa{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const pc="Framebuffer is not complete";class la{constructor(e,a,l,d,g){this.context=e,this.width=a,this.height=l;const _=e.gl,S=this.framebuffer=_.createFramebuffer();if(this.colorAttachment=new qu(e,S),d)this.depthAttachment=g?new sn(e,S):new yl(e,S);else if(g)throw new Error("Stencil cannot be set without depth");if(_.checkFramebufferStatus(_.FRAMEBUFFER)!==_.FRAMEBUFFER_COMPLETE)throw new Error(pc)}destroy(){const e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){const l=this.depthAttachment.get();l&&e.deleteRenderbuffer(l)}e.deleteFramebuffer(this.framebuffer)}}class Xc{constructor(e){var a,l;if(this.gl=e,this.clearColor=new Zc(this),this.clearDepth=new lc(this),this.clearStencil=new Kh(this),this.colorMask=new qo(this),this.depthMask=new vo(this),this.stencilMask=new ws(this),this.stencilFunc=new Gu(this),this.stencilOp=new Qh(this),this.stencilTest=new Ss(this),this.depthRange=new gl(this),this.depthTest=new qc(this),this.depthFunc=new Jh(this),this.blend=new Wo(this),this.blendFunc=new cc(this),this.blendColor=new uc(this),this.blendEquation=new hc(this),this.cullFace=new Zu(this),this.cullFaceSide=new Ps(this),this.frontFace=new dc(this),this.program=new Cs(this),this.activeTexture=new oa(this),this.viewport=new Wc(this),this.bindFramebuffer=new xa(this),this.bindRenderbuffer=new $c(this),this.bindTexture=new Jr(this),this.bindVertexBuffer=new zi(this),this.bindElementBuffer=new xo(this),this.bindVertexArray=new Ts(this),this.pixelStoreUnpack=new As(this),this.pixelStoreUnpackPremultiplyAlpha=new fc(this),this.pixelStoreUnpackFlipY=new $o(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),vi(e)){this.HALF_FLOAT=e.HALF_FLOAT;const d=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:d?.RGBA16F_EXT,this.RGB16F=(l=e.RGB16F)!==null&&l!==void 0?l:d?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const d=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=d?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new ml(this,e,a)}createVertexBuffer(e,a,l){return new no(this,e,a,l)}createRenderbuffer(e,a,l){const d=this.gl,g=d.createRenderbuffer();return this.bindRenderbuffer.set(g),d.renderbufferStorage(d.RENDERBUFFER,e,a,l),this.bindRenderbuffer.set(null),g}createFramebuffer(e,a,l,d){return new la(this,e,a,l,d)}clear({color:e,depth:a,stencil:l}){const d=this.gl;let g=0;e&&(g|=d.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(g|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),l!==void 0&&(g|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(l),this.stencilMask.set(255)),d.clear(g)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bH(e.blendFunction,Hn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return vi(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return vi(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let bi;function Wu(f,e,a,l,d){const g=f.context,_=f.transform,S=g.gl,P=f.useProgram("collisionBox"),E=[];let I=0,O=0;for(let te=0;te<l.length;te++){const ie=l[te],le=e.getTile(ie).getBucket(a);if(!le)continue;const ae=d?le.textCollisionBox:le.iconCollisionBox,ue=le.collisionCircleArray;ue.length>0&&(E.push({circleArray:ue,circleOffset:O,coord:ie}),I+=ue.length/4,O=I),ae&&P.draw(g,S.LINES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Nt.disabled,rc(f.transform),f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie),_.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),a.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,null,f.transform.zoom,null,null,ae.collisionVertexBuffer)}if(!d||!E.length)return;const k=f.useProgram("collisionCircle"),N=new c.b$;N.resize(4*I),N._trim();let W=0;for(const te of E)for(let ie=0;ie<te.circleArray.length/4;ie++){const le=4*ie,ae=te.circleArray[le+0],ue=te.circleArray[le+1],me=te.circleArray[le+2],oe=te.circleArray[le+3];N.emplace(W++,ae,ue,me,oe,0),N.emplace(W++,ae,ue,me,oe,1),N.emplace(W++,ae,ue,me,oe,2),N.emplace(W++,ae,ue,me,oe,3)}(!bi||bi.length<2*I)&&(bi=(function(te){const ie=2*te,le=new c.c1;le.resize(ie),le._trim();for(let ae=0;ae<ie;ae++){const ue=6*ae;le.uint16[ue+0]=4*ae+0,le.uint16[ue+1]=4*ae+1,le.uint16[ue+2]=4*ae+2,le.uint16[ue+3]=4*ae+2,le.uint16[ue+4]=4*ae+3,le.uint16[ue+5]=4*ae+0}return le})(I));const J=g.createIndexBuffer(bi,!0),ee=g.createVertexBuffer(N,c.c0.members,!0);for(const te of E){const ie=hl(f.transform);k.draw(g,S.TRIANGLES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Nt.disabled,ie,f.style.map.terrain&&f.style.map.terrain.getTerrainData(te.coord),null,a.id,ee,J,c.aM.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,f.transform.zoom,null,null,null)}ee.destroy(),J.destroy()}const Yc=c.ag(new Float32Array(16));function Xo(f,e,a,l,d,g){const{horizontalAlign:_,verticalAlign:S}=c.aH(f);return new c.P((-(_-.5)*e/d+l[0])*g,(-(S-.5)*a/d+l[1])*g)}function $u(f,e,a,l,d,g){const _=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let S=l.mult(g);a||(S=S.rotate(-d));const P=_.add(S);return lr(P.x,P.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(a){const S=Er(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(f),P=Math.atan(S.y/S.x)+(S.x<0?Math.PI:0);return f.add(l.rotate(P))}return f.add(l)}function mc(f,e,a,l,d,g,_,S,P,E,I,O){const k=f.text.placedSymbolArray,N=f.text.dynamicLayoutVertexArray,W=f.icon.dynamicLayoutVertexArray,J={};N.clear();for(let ee=0;ee<k.length;ee++){const te=k.get(ee),ie=te.hidden||!te.crossTileID||f.allowVerticalPlacement&&!te.placedOrientation?null:l[te.crossTileID];if(ie){const le=new c.P(te.anchorX,te.anchorY),ae={getElevation:O,width:d.width,height:d.height,pitchedLabelPlaneMatrix:g,pitchWithMap:a,transform:d,tileAnchorPoint:le,translation:E,unwrappedTileID:I},ue=a?cr(le.x,le.y,ae):Er(le.x,le.y,ae),me=lt(d.cameraToCenterDistance,ue.signedDistanceFromCamera);let oe=c.ap(f.textSizeData,S,te)*me/c.aB;a&&(oe*=f.tilePixelRatio/_);const{width:Se,height:Ue,anchor:Ie,textOffset:Oe,textBoxScale:je}=ie,pt=Xo(Ie,Se,Ue,Oe,je,oe),ht=d.getPitchedTextCorrection(le.x+E[0],le.y+E[1],I),Ke=$u(ue.point,ae,e,pt,-d.bearingInRadians,ht),Tt=f.allowVerticalPlacement&&te.placedOrientation===c.ao.vertical?Math.PI/2:0;for(let ln=0;ln<te.numGlyphs;ln++)c.av(N,Ke,Tt);P&&te.associatedIconIndex>=0&&(J[te.associatedIconIndex]={shiftedAnchor:Ke,angle:Tt})}else $a(te.numGlyphs,N)}if(P){W.clear();const ee=f.icon.placedSymbolArray;for(let te=0;te<ee.length;te++){const ie=ee.get(te);if(ie.hidden)$a(ie.numGlyphs,W);else{const le=J[te];if(le)for(let ae=0;ae<ie.numGlyphs;ae++)c.av(W,le.shiftedAnchor,le.angle);else $a(ie.numGlyphs,W)}}f.icon.dynamicLayoutVertexBuffer.updateData(W)}f.text.dynamicLayoutVertexBuffer.updateData(N)}function bo(f,e,a){return a.iconsInText&&e?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function ro(f,e,a,l,d,g,_,S,P,E,I,O,k){const N=f.context,W=N.gl,J=f.transform,ee=S==="map",te=P==="map",ie=S!=="viewport"&&a.layout.get("symbol-placement")!=="point",le=ee&&!te&&!ie,ae=!a.layout.get("symbol-sort-key").isConstant();let ue=!1;const me=f.getDepthModeForSublayer(0,Xt.ReadOnly),oe=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Se=[],Ue=J.getCircleRadiusCorrection();for(const Ie of l){const Oe=e.getTile(Ie),je=Oe.getBucket(a);if(!je)continue;const pt=d?je.text:je.icon;if(!pt||!pt.segments.get().length||!pt.hasVisibleVertices)continue;const ht=pt.programConfigurations.get(a.id),Ke=d||je.sdfIcons,Tt=d?je.textSizeData:je.iconSizeData,ln=te||J.pitch!==0,Pn=f.useProgram(bo(Ke,d,je),ht),ar=c.an(Tt,J.zoom),Fn=f.style.map.terrain&&f.style.map.terrain.getTerrainData(Ie);let Nn,$n,Gn,Un,vn=[0,0],jr=null;if(d)$n=Oe.glyphAtlasTexture,Gn=W.LINEAR,Nn=Oe.glyphAtlasTexture.size,je.iconsInText&&(vn=Oe.imageAtlasTexture.size,jr=Oe.imageAtlasTexture,Un=ln||f.options.rotating||f.options.zooming||Tt.kind==="composite"||Tt.kind==="camera"?W.LINEAR:W.NEAREST);else{const Dn=a.layout.get("icon-size").constantOr(0)!==1||je.iconsNeedLinear;$n=Oe.imageAtlasTexture,Gn=Ke||f.options.rotating||f.options.zooming||Dn||ln?W.LINEAR:W.NEAREST,Nn=Oe.imageAtlasTexture.size}const Ir=c.aC(Oe,1,f.transform.zoom),Ui=Vn(ee,f.transform,Ir),is=c.L();c.aq(is,Ui);const Ro=Ut(te,ee,f.transform,Ir),ji=c.aD(J,Oe,g,_),Do=J.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!k,applyTerrainMatrix:!0}),as=oe&&je.hasTextData(),Sc=a.layout.get("icon-text-fit")!=="none"&&as&&je.hasIconData();if(ie){const Dn=f.style.map.terrain?(Si,xr)=>f.style.map.terrain.getElevation(Ie,Si,xr):null,hr=a.layout.get("text-rotation-alignment")==="map";yr(je,f,d,Ui,is,te,E,hr,Ie.toUnwrapped(),J.width,J.height,ji,Dn)}const Io=d&&oe||Sc,ni=ie||Io?Yc:te?Ui:f.transform.clipSpaceToPixelsMatrix,oo=Ke&&a.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let so;so=Ke?je.iconsInText?Ud(Tt.kind,ar,le,te,ie,Io,f,ni,Ro,ji,Nn,vn,Ue):$h(Tt.kind,ar,le,te,ie,Io,f,ni,Ro,ji,d,Nn,0,Ue):pl(Tt.kind,ar,le,te,ie,Io,f,ni,Ro,ji,d,Nn,Ue);const os={program:Pn,buffers:pt,uniformValues:so,projectionData:Do,atlasTexture:$n,atlasTextureIcon:jr,atlasInterpolation:Gn,atlasInterpolationIcon:Un,isSDF:Ke,hasHalo:oo};if(ae&&je.canOverlap){ue=!0;const Dn=pt.segments.get();for(const hr of Dn)Se.push({segments:new c.aM([hr]),sortKey:hr.sortKey,state:os,terrainData:Fn})}else Se.push({segments:pt.segments,sortKey:0,state:os,terrainData:Fn})}ue&&Se.sort(((Ie,Oe)=>Ie.sortKey-Oe.sortKey));for(const Ie of Se){const Oe=Ie.state;if(N.activeTexture.set(W.TEXTURE0),Oe.atlasTexture.bind(Oe.atlasInterpolation,W.CLAMP_TO_EDGE),Oe.atlasTextureIcon&&(N.activeTexture.set(W.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,W.CLAMP_TO_EDGE)),Oe.isSDF){const je=Oe.uniformValues;Oe.hasHalo&&(je.u_is_halo=1,Yo(Oe.buffers,Ie.segments,a,f,Oe.program,me,I,O,je,Oe.projectionData,Ie.terrainData)),je.u_is_halo=0}Yo(Oe.buffers,Ie.segments,a,f,Oe.program,me,I,O,Oe.uniformValues,Oe.projectionData,Ie.terrainData)}}function Yo(f,e,a,l,d,g,_,S,P,E,I){const O=l.context;d.draw(O,O.gl.TRIANGLES,g,_,S,Nt.backCCW,P,I,E,a.id,f.layoutVertexBuffer,f.indexBuffer,e,a.paint,l.transform.zoom,f.programConfigurations.get(a.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function _l(f,e,a,l,d){const g=f.context,_=g.gl,S=_n.disabled,P=new Hn([_.ONE,_.ONE],c.bf.transparent,[!0,!0,!0,!0]),E=e.getBucket(a);if(!E)return;const I=l.key;let O=a.heatmapFbos.get(I);O||(O=wi(g,e.tileSize,e.tileSize),a.heatmapFbos.set(I,O)),g.bindFramebuffer.set(O.framebuffer),g.viewport.set([0,0,e.tileSize,e.tileSize]),g.clear({color:c.bf.transparent});const k=E.programConfigurations.get(a.id),N=f.useProgram("heatmap",k,!d),W=f.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),J=f.style.map.terrain.getTerrainData(l);N.draw(g,_.TRIANGLES,Xt.disabled,S,P,Nt.disabled,Zh(e,f.transform.zoom,a.paint.get("heatmap-intensity"),1),J,W,a.id,E.layoutVertexBuffer,E.indexBuffer,E.segments,a.paint,f.transform.zoom,k)}function ca(f,e,a,l,d){const g=f.context,_=g.gl,S=f.transform;g.setColorMode(f.colorModeForRenderPass());const P=Ra(g,e),E=a.key,I=e.heatmapFbos.get(E);if(!I)return;g.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,I.colorAttachment.get()),g.activeTexture.set(_.TEXTURE1),P.bind(_.LINEAR,_.CLAMP_TO_EDGE);const O=S.getProjectionData({overscaledTileID:a,applyTerrainMatrix:d,applyGlobeMatrix:!l});f.useProgram("heatmapTexture").draw(g,_.TRIANGLES,Xt.disabled,_n.disabled,f.colorModeForRenderPass(),Nt.disabled,Uu(f,e,0,1),null,O,e.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments,e.paint,S.zoom),I.destroy(),e.heatmapFbos.delete(E)}function wi(f,e,a){var l,d;const g=f.gl,_=g.createTexture();g.bindTexture(g.TEXTURE_2D,_),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,g.LINEAR),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,g.LINEAR);const S=(l=f.HALF_FLOAT)!==null&&l!==void 0?l:g.UNSIGNED_BYTE,P=(d=f.RGBA16F)!==null&&d!==void 0?d:g.RGBA;g.texImage2D(g.TEXTURE_2D,0,P,e,a,0,g.RGBA,S,null);const E=f.createFramebuffer(e,a,!1,!1);return E.colorAttachment.set(_),E}function Ra(f,e){return e.colorRampTexture||(e.colorRampTexture=new c.T(f,e.colorRamp,f.gl.RGBA)),e.colorRampTexture}function ua(f,e,a,l,d){if(!a||!l||!l.imageAtlas)return;const g=l.imageAtlas.patternPositions;let _=g[a.to.toString()],S=g[a.from.toString()];if(!_&&S&&(_=S),!S&&_&&(S=_),!_||!S){const P=d.getPaintProperty(e);_=g[P],S=g[P]}_&&S&&f.setConstantPatternPositions(_,S)}function Li(f,e,a,l,d,g,_,S){const P=f.context.gl,E="fill-pattern",I=a.paint.get(E),O=I&&I.constantOr(1),k=a.getCrossfadeParameters();let N,W,J,ee,te;const ie=f.transform,le=a.paint.get("fill-translate"),ae=a.paint.get("fill-translate-anchor");_?(W=O&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=P.LINES):(W=O?"fillPattern":"fill",N=P.TRIANGLES);const ue=I.constantOr(null);for(const me of l){const oe=e.getTile(me);if(O&&!oe.patternsLoaded())continue;const Se=oe.getBucket(a);if(!Se)continue;const Ue=Se.programConfigurations.get(a.id),Ie=f.useProgram(W,Ue),Oe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(me);O&&(f.context.activeTexture.set(P.TEXTURE0),oe.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ue.updatePaintBuffers(k)),ua(Ue,E,ue,oe,a);const je=ie.getProjectionData({overscaledTileID:me,applyGlobeMatrix:!S,applyTerrainMatrix:!0}),pt=c.aD(ie,oe,le,ae);if(_){ee=Se.indexBuffer2,te=Se.segments2;const Ke=[P.drawingBufferWidth,P.drawingBufferHeight];J=W==="fillOutlinePattern"&&O?ul(f,k,oe,Ke,pt):cl(Ke,pt)}else ee=Se.indexBuffer,te=Se.segments,J=O?nc(f,k,oe,pt):{u_fill_translate:pt};const ht=f.stencilModeForClipping(me);Ie.draw(f.context,N,d,ht,g,Nt.backCCW,J,Oe,je,a.id,Se.layoutVertexBuffer,ee,te,a.paint,f.transform.zoom,Ue)}}function Da(f,e,a,l,d,g,_,S){const P=f.context,E=P.gl,I="fill-extrusion-pattern",O=a.paint.get(I),k=O.constantOr(1),N=a.getCrossfadeParameters(),W=a.paint.get("fill-extrusion-opacity"),J=O.constantOr(null),ee=f.transform;for(const te of l){const ie=e.getTile(te),le=ie.getBucket(a);if(!le)continue;const ae=f.style.map.terrain&&f.style.map.terrain.getTerrainData(te),ue=le.programConfigurations.get(a.id),me=f.useProgram(k?"fillExtrusionPattern":"fillExtrusion",ue);k&&(f.context.activeTexture.set(E.TEXTURE0),ie.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ue.updatePaintBuffers(N));const oe=ee.getProjectionData({overscaledTileID:te,applyGlobeMatrix:!S,applyTerrainMatrix:!0});ua(ue,I,J,ie,a);const Se=c.aD(ee,ie,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ue=a.paint.get("fill-extrusion-vertical-gradient"),Ie=k?Nd(f,Ue,W,Se,te,N,ie):Di(f,Ue,W,Se);me.draw(P,P.gl.TRIANGLES,d,g,_,Nt.backCCW,Ie,ae,oe,a.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,a.paint,f.transform.zoom,ue,f.style.map.terrain&&le.centroidVertexBuffer)}}function Kc(f,e,a,l,d,g,_,S,P){var E;const I=f.style.projection,O=f.context,k=f.transform,N=O.gl,W=[`#define NUM_ILLUMINATION_SOURCES ${a.paint.get("hillshade-highlight-color").values.length}`],J=f.useProgram("hillshade",null,!1,W),ee=!f.options.moving;for(const te of l){const ie=e.getTile(te),le=ie.fbo;if(!le)continue;const ae=I.getMeshFromTileID(O,te.canonical,S,!0,"raster"),ue=(E=f.style.map.terrain)===null||E===void 0?void 0:E.getTerrainData(te);O.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,le.colorAttachment.get());const me=k.getProjectionData({overscaledTileID:te,aligned:ee,applyGlobeMatrix:!P,applyTerrainMatrix:!0});J.draw(O,N.TRIANGLES,g,d[te.overscaledZ],_,Nt.backCCW,qh(f,ie,a),ue,me,a.id,ae.vertexBuffer,ae.indexBuffer,ae.segments)}}function wo(f,e,a,l,d,g,_,S,P){var E;const I=f.style.projection,O=f.context,k=f.transform,N=O.gl,W=f.useProgram("colorRelief"),J=!f.options.moving;let ee=!0,te=0;for(const ie of l){const le=e.getTile(ie),ae=le.dem;if(ee){const Ie=N.getParameter(N.MAX_TEXTURE_SIZE),{elevationTexture:Oe,colorTexture:je}=a.getColorRampTextures(O,Ie,ae.getUnpackVector());O.activeTexture.set(N.TEXTURE1),Oe.bind(N.NEAREST,N.CLAMP_TO_EDGE),O.activeTexture.set(N.TEXTURE4),je.bind(N.LINEAR,N.CLAMP_TO_EDGE),ee=!1,te=Oe.size[0]}if(!ae||!ae.data)continue;const ue=ae.stride,me=ae.getPixels();if(O.activeTexture.set(N.TEXTURE0),O.pixelStoreUnpackPremultiplyAlpha.set(!1),le.demTexture=le.demTexture||f.getTileTexture(ue),le.demTexture){const Ie=le.demTexture;Ie.update(me,{premultiply:!1}),Ie.bind(N.LINEAR,N.CLAMP_TO_EDGE)}else le.demTexture=new c.T(O,me,N.RGBA,{premultiply:!1}),le.demTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE);const oe=I.getMeshFromTileID(O,ie.canonical,S,!0,"raster"),Se=(E=f.style.map.terrain)===null||E===void 0?void 0:E.getTerrainData(ie),Ue=k.getProjectionData({overscaledTileID:ie,aligned:J,applyGlobeMatrix:!P,applyTerrainMatrix:!0});W.draw(O,N.TRIANGLES,g,d[ie.overscaledZ],_,Nt.backCCW,dl(a,le.dem,te),Se,Ue,a.id,oe.vertexBuffer,oe.indexBuffer,oe.segments)}}const gc=[new c.P(0,0),new c.P(c.$,0),new c.P(c.$,c.$),new c.P(0,c.$)];function Gr(f,e,a,l,d,g,_,S,P=!1,E=!1){const I=l[l.length-1].overscaledZ,O=f.context,k=O.gl,N=f.useProgram("raster"),W=f.transform,J=f.style.projection,ee=f.colorModeForRenderPass(),te=!f.options.moving;for(const ie of l){const le=f.getDepthModeForSublayer(ie.overscaledZ-I,a.paint.get("raster-opacity")===1?Xt.ReadWrite:Xt.ReadOnly,k.LESS),ae=e.getTile(ie);ae.registerFadeDuration(a.paint.get("raster-fade-duration"));const ue=e.findLoadedParent(ie,0),me=e.findLoadedSibling(ie),oe=ur(ae,ue||me||null,e,a,f.transform,f.style.map.terrain);let Se,Ue;const Ie=a.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;O.activeTexture.set(k.TEXTURE0),ae.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),O.activeTexture.set(k.TEXTURE1),ue?(ue.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),Se=Math.pow(2,ue.tileID.overscaledZ-ae.tileID.overscaledZ),Ue=[ae.tileID.canonical.x*Se%1,ae.tileID.canonical.y*Se%1]):ae.texture.bind(Ie,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),ae.texture.useMipmap&&O.extTextureFilterAnisotropic&&f.transform.pitch>20&&k.texParameterf(k.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const Oe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ie),je=W.getProjectionData({overscaledTileID:ie,aligned:te,applyGlobeMatrix:!E,applyTerrainMatrix:!0}),pt=fl(Ue||[0,0],Se||1,oe,a,S),ht=J.getMeshFromTileID(O,ie.canonical,g,_,"raster");N.draw(O,k.TRIANGLES,le,d?d[ie.overscaledZ]:_n.disabled,ee,P?Nt.frontCCW:Nt.backCCW,pt,Oe,je,a.id,ht.vertexBuffer,ht.indexBuffer,ht.segments)}}function ur(f,e,a,l,d,g){const _=l.paint.get("raster-fade-duration");if(!g&&_>0){const S=ge.now(),P=(S-f.timeAdded)/_,E=e?(S-e.timeAdded)/_:-1,I=a.getSource(),O=Pt(d,{tileSize:I.tileSize,roundZoom:I.roundZoom}),k=!e||Math.abs(e.tileID.overscaledZ-O)>Math.abs(f.tileID.overscaledZ-O),N=k&&f.refreshedUponExpiration?1:c.ah(k?P:1-E,0,1);return f.refreshedUponExpiration&&P>=1&&(f.refreshedUponExpiration=!1),e?{opacity:1,mix:1-N}:{opacity:N,mix:0}}return{opacity:1,mix:0}}const Mn=new c.bf(1,0,0,1),Ko=new c.bf(0,1,0,1),Ia=new c.bf(0,0,1,1),vl=new c.bf(1,0,1,1),So=new c.bf(0,1,1,1);function Xu(f,e,a,l){Bn(f,0,e+a/2,f.transform.width,a,l)}function Qc(f,e,a,l){Bn(f,e-a/2,0,a,f.transform.height,l)}function Bn(f,e,a,l,d,g){const _=f.context,S=_.gl;S.enable(S.SCISSOR_TEST),S.scissor(e*f.pixelRatio,a*f.pixelRatio,l*f.pixelRatio,d*f.pixelRatio),_.clear({color:g}),S.disable(S.SCISSOR_TEST)}function za(f,e,a){const l=f.context,d=l.gl,g=f.useProgram("debug"),_=Xt.disabled,S=_n.disabled,P=f.colorModeForRenderPass(),E="$debug",I=f.style.map.terrain&&f.style.map.terrain.getTerrainData(a);l.activeTexture.set(d.TEXTURE0);const O=e.getTileByID(a.key).latestRawTileData,k=Math.floor((O&&O.byteLength||0)/1024),N=e.getTile(a).tileSize,W=512/Math.min(N,512)*(a.overscaledZ/f.transform.zoom)*.5;let J=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(J+=` => ${a.overscaledZ}`),(function(te,ie){te.initDebugOverlayCanvas();const le=te.debugOverlayCanvas,ae=te.context.gl,ue=te.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,le.width,le.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(ie,5,5),ue.strokeText(ie,5,5),te.debugOverlayTexture.update(le),te.debugOverlayTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)})(f,`${J} ${k}kB`);const ee=f.transform.getProjectionData({overscaledTileID:a,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(l,d.TRIANGLES,_,S,Hn.alphaBlended,Nt.disabled,xs(c.bf.transparent,W),null,ee,E,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),g.draw(l,d.LINE_STRIP,_,S,P,Nt.disabled,xs(c.bf.red),I,ee,E,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function Yi(f,e,a,l){const{isRenderingGlobe:d}=l,g=f.context,_=g.gl,S=f.transform,P=f.colorModeForRenderPass(),E=f.getDepthModeFor3D(),I=f.useProgram("terrain");g.bindFramebuffer.set(null),g.viewport.set([0,0,f.width,f.height]);for(const O of a){const k=e.getTerrainMesh(O.tileID),N=f.renderToTexture.getTexture(O),W=e.getTerrainData(O.tileID);g.activeTexture.set(_.TEXTURE0),_.bindTexture(_.TEXTURE_2D,N.texture);const J=e.getMeshFrameDelta(S.zoom),ee=S.calculateFogMatrix(O.tileID.toUnwrapped()),te=Hc(J,ee,f.style.sky,S.pitch,d),ie=S.getProjectionData({overscaledTileID:O.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});I.draw(g,_.TRIANGLES,E,_n.disabled,P,Nt.backCCW,te,W,ie,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}function Qo(f,e){if(!e.mesh){const a=new c.aL;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(1,1),a.emplaceBack(-1,1);const l=new c.aN;l.emplaceBack(0,1,2),l.emplaceBack(0,2,3),e.mesh=new jo(f.createVertexBuffer(a,Qa.members),f.createIndexBuffer(l),c.aM.simpleSegment(0,0,a.length,l.length))}return e.mesh}class xl{constructor(e,a){this.context=new Xc(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=dn.maxUnderzooming+dn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ds}resize(e,a,l){if(this.width=Math.floor(e*l),this.height=Math.floor(a*l),this.pixelRatio=l,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const e=this.context,a=new c.aL;a.emplaceBack(0,0),a.emplaceBack(c.$,0),a.emplaceBack(0,c.$),a.emplaceBack(c.$,c.$),this.tileExtentBuffer=e.createVertexBuffer(a,Qa.members),this.tileExtentSegments=c.aM.simpleSegment(0,0,4,2);const l=new c.aL;l.emplaceBack(0,0),l.emplaceBack(c.$,0),l.emplaceBack(0,c.$),l.emplaceBack(c.$,c.$),this.debugBuffer=e.createVertexBuffer(l,Qa.members),this.debugSegments=c.aM.simpleSegment(0,0,4,5);const d=new c.c6;d.emplaceBack(0,0,0,0),d.emplaceBack(c.$,0,c.$,0),d.emplaceBack(0,c.$,0,c.$),d.emplaceBack(c.$,c.$,c.$,c.$),this.rasterBoundsBuffer=e.createVertexBuffer(d,Bd.members),this.rasterBoundsSegments=c.aM.simpleSegment(0,0,4,2);const g=new c.aL;g.emplaceBack(0,0),g.emplaceBack(c.$,0),g.emplaceBack(0,c.$),g.emplaceBack(c.$,c.$),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(g,Qa.members),this.rasterBoundsSegmentsPosOnly=c.aM.simpleSegment(0,0,4,5);const _=new c.aL;_.emplaceBack(0,0),_.emplaceBack(1,0),_.emplaceBack(0,1),_.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(_,Qa.members),this.viewportSegments=c.aM.simpleSegment(0,0,4,2);const S=new c.c7;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(S);const P=new c.aN;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(P);const E=this.context.gl;this.stencilClearMode=new _n({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO),this.tileExtentMesh=new jo(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const l=c.L();c.bY(l,0,this.width,this.height,0,0,1),c.N(l,l,[a.drawingBufferWidth,a.drawingBufferHeight,0]);const d={mainMatrix:l,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:l};this.useProgram("clippingMask",null,!0).draw(e,a.TRIANGLES,Xt.disabled,this.stencilClearMode,Hn.disabled,Nt.disabled,null,null,d,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a,l){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source,this.nextStencilID+a.length>256&&this.clearStencil();const d=this.context;d.setColorMode(Hn.disabled),d.setDepthMode(Xt.disabled);const g={};for(const _ of a)g[_.key]=this.nextStencilID++;this._renderTileMasks(g,a,l,!0),this._renderTileMasks(g,a,l,!1),this._tileClippingMaskIDs=g}_renderTileMasks(e,a,l,d){const g=this.context,_=g.gl,S=this.style.projection,P=this.transform,E=this.useProgram("clippingMask");for(const I of a){const O=e[I.key],k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(I),N=S.getMeshFromTileID(this.context,I.canonical,d,!0,"stencil"),W=P.getProjectionData({overscaledTileID:I,applyGlobeMatrix:!l,applyTerrainMatrix:!0});E.draw(g,_.TRIANGLES,Xt.disabled,new _n({func:_.ALWAYS,mask:0},O,255,_.KEEP,_.KEEP,_.REPLACE),Hn.disabled,l?Nt.disabled:Nt.backCCW,null,k,W,"$clipping",N.vertexBuffer,N.indexBuffer,N.segments)}}_renderTilesDepthBuffer(){const e=this.context,a=e.gl,l=this.style.projection,d=this.transform,g=this.useProgram("depth"),_=this.getDepthModeFor3D(),S=Ce(d,{tileSize:d.tileSize});for(const P of S){const E=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),I=l.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),O=d.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});g.draw(e,a.TRIANGLES,_,_n.disabled,Hn.disabled,Nt.backCCW,null,E,O,"$clipping",I.vertexBuffer,I.indexBuffer,I.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,a=this.context.gl;return new _n({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){const a=this.context.gl;return new _n({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const a=this.context.gl,l=e.sort(((_,S)=>S.overscaledZ-_.overscaledZ)),d=l[l.length-1].overscaledZ,g=l[0].overscaledZ-d+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const _={};for(let S=0;S<g;S++)_[S+d]=new _n({func:a.GEQUAL,mask:255},S+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=g,[_,l]}return[{[d]:_n.disabled},l]}stencilConfigForOverlapTwoPass(e){const a=this.context.gl,l=e.sort(((_,S)=>S.overscaledZ-_.overscaledZ)),d=l[l.length-1].overscaledZ,g=l[0].overscaledZ-d+1;if(this.clearStencil(),g>1){const _={},S={};for(let P=0;P<g;P++)_[P+d]=new _n({func:a.GREATER,mask:255},g+1+P,255,a.KEEP,a.KEEP,a.REPLACE),S[P+d]=new _n({func:a.GREATER,mask:255},1+P,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID=2*g+1,[_,S,l]}return this.nextStencilID=3,[{[d]:new _n({func:a.GREATER,mask:255},2,255,a.KEEP,a.KEEP,a.REPLACE)},{[d]:new _n({func:a.GREATER,mask:255},1,255,a.KEEP,a.KEEP,a.REPLACE)},l]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Hn([e.CONSTANT_COLOR,e.ONE],new c.bf(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Hn.unblended:Hn.alphaBlended}getDepthModeForSublayer(e,a,l){if(!this.opaquePassEnabledForLayer())return Xt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Xt(l||this.context.gl.LEQUAL,a,[d,d])}getDepthModeFor3D(){return new Xt(this.context.gl.LEQUAL,Xt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){var l,d;this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(ge.now()),this.imageManager.beginFrame();const g=this.style._order,_=this.style.sourceCaches,S={},P={},E={},I={isRenderingToTexture:!1,isRenderingGlobe:((l=e.projection)===null||l===void 0?void 0:l.transitionState)>0};for(const k in _){const N=_[k];N.used&&N.prepare(this.context),S[k]=N.getVisibleCoordinates(!1),P[k]=S[k].slice().reverse(),E[k]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<g.length;k++)if(this.style._layers[g[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const k of g){const N=this.style._layers[k];if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;const W=P[N.source];(N.type==="custom"||W.length)&&this.renderLayer(this,_[N.source],N,W,I)}if((d=this.style.projection)===null||d===void 0||d.updateGPUdependent({context:this.context,useProgram:k=>this.useProgram(k)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?c.bf.black:c.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&(function(k,N){const W=k.context,J=W.gl,ee=((me,oe,Se)=>{const Ue=Math.cos(oe.rollInRadians),Ie=Math.sin(oe.rollInRadians),Oe=de(oe),je=oe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:me.properties.get("sky-color"),u_horizon_color:me.properties.get("horizon-color"),u_horizon:[(oe.width/2-Oe*Ie)*Se,(oe.height/2+Oe*Ue)*Se],u_horizon_normal:[-Ie,Ue],u_sky_horizon_blend:me.properties.get("sky-horizon-blend")*oe.height/2*Se,u_sky_blend:je}})(N,k.style.map.transform,k.pixelRatio),te=new Xt(J.LEQUAL,Xt.ReadWrite,[0,1]),ie=_n.disabled,le=k.colorModeForRenderPass(),ae=k.useProgram("sky"),ue=Qo(W,N);ae.draw(W,J.TRIANGLES,te,ie,le,Nt.disabled,ee,null,void 0,"sky",ue.vertexBuffer,ue.indexBuffer,ue.segments)})(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const k=this.style._layers[g[this.currentLayer]],N=_[k.source],W=S[k.source];this._renderTileClippingMasks(k,W,!1),this.renderLayer(this,N,k,W,I)}this.renderPass="translucent";let O=!1;for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const k=this.style._layers[g[this.currentLayer]],N=_[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k,I))continue;this.opaquePassEnabledForLayer()||O||(O=!0,I.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const W=(k.type==="symbol"?E:P)[k.source];this._renderTileClippingMasks(k,S[k.source],!!this.renderToTexture),this.renderLayer(this,N,k,W,I)}if(I.isRenderingGlobe&&(function(k,N,W){const J=k.context,ee=J.gl,te=k.useProgram("atmosphere"),ie=new Xt(ee.LEQUAL,Xt.ReadOnly,[0,1]),le=k.transform,ae=(function(je,pt){const ht=je.properties.get("position"),Ke=[-ht.x,-ht.y,-ht.z],Tt=c.ag(new Float64Array(16));return je.properties.get("anchor")==="map"&&(c.b6(Tt,Tt,pt.rollInRadians),c.b7(Tt,Tt,-pt.pitchInRadians),c.b6(Tt,Tt,pt.bearingInRadians),c.b7(Tt,Tt,pt.center.lat*Math.PI/180),c.bz(Tt,Tt,-pt.center.lng*Math.PI/180)),c.c5(Ke,Ke,Tt),Ke})(W,k.transform),ue=le.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=N.properties.get("atmosphere-blend")*ue.projectionTransition;if(me===0)return;const oe=ol(le.worldSize,le.center.lat),Se=le.inverseProjectionMatrix,Ue=new Float64Array(4);Ue[3]=1,c.aw(Ue,Ue,le.modelViewProjectionMatrix),Ue[0]/=Ue[3],Ue[1]/=Ue[3],Ue[2]/=Ue[3],Ue[3]=1,c.aw(Ue,Ue,Se),Ue[0]/=Ue[3],Ue[1]/=Ue[3],Ue[2]/=Ue[3],Ue[3]=1;const Ie=((je,pt,ht,Ke,Tt)=>({u_sun_pos:je,u_atmosphere_blend:pt,u_globe_position:ht,u_globe_radius:Ke,u_inv_proj_matrix:Tt}))(ae,me,[Ue[0],Ue[1],Ue[2]],oe,Se),Oe=Qo(J,N);te.draw(J,ee.TRIANGLES,ie,_n.disabled,Hn.alphaBlended,Nt.disabled,Ie,null,null,"atmosphere",Oe.vertexBuffer,Oe.indexBuffer,Oe.segments)})(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const k=(function(N,W){let J=null;const ee=Object.values(N._layers).flatMap((ae=>ae.source&&!ae.isHidden(W)?[N.sourceCaches[ae.source]]:[])),te=ee.filter((ae=>ae.getSource().type==="vector")),ie=ee.filter((ae=>ae.getSource().type!=="vector")),le=ae=>{(!J||J.getSource().maxzoom<ae.getSource().maxzoom)&&(J=ae)};return te.forEach((ae=>le(ae))),J||ie.forEach((ae=>le(ae))),J})(this.style,this.transform.zoom);k&&(function(N,W,J){for(let ee=0;ee<J.length;ee++)za(N,W,J[ee])})(this,k,k.getVisibleCoordinates())}this.options.showPadding&&(function(k){const N=k.transform.padding;Xu(k,k.transform.height-(N.top||0),3,Mn),Xu(k,N.bottom||0,3,Ko),Qc(k,N.left||0,3,Ia),Qc(k,k.transform.width-(N.right||0),3,vl);const W=k.transform.centerPoint;(function(J,ee,te,ie){Bn(J,ee-1,te-10,2,20,ie),Bn(J,ee-10,te-1,20,2,ie)})(k,W.x,k.transform.height-W.y,So)})(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const a=this.terrainFacilitator.matrix,l=this.transform.modelViewProjectionMatrix;let d=this.terrainFacilitator.dirty;d||(d=e?!c.c8(a,l):!c.c9(a,l)),d||(d=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),d&&(c.ca(a,l),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,(function(g,_){const S=g.context,P=S.gl,E=g.transform,I=Hn.unblended,O=new Xt(P.LEQUAL,Xt.ReadWrite,[0,1]),k=_.sourceCache.getRenderableTiles(),N=g.useProgram("terrainDepth");S.bindFramebuffer.set(_.getFramebuffer("depth").framebuffer),S.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),S.clear({color:c.bf.transparent,depth:1});for(const W of k){const J=_.getTerrainMesh(W.tileID),ee=_.getTerrainData(W.tileID),te=E.getProjectionData({overscaledTileID:W.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ie={u_ele_delta:_.getMeshFrameDelta(E.zoom)};N.draw(S,P.TRIANGLES,O,_n.disabled,I,Nt.backCCW,ie,ee,te,"terrain",J.vertexBuffer,J.indexBuffer,J.segments)}S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain),(function(g,_){const S=g.context,P=S.gl,E=g.transform,I=Hn.unblended,O=new Xt(P.LEQUAL,Xt.ReadWrite,[0,1]),k=_.getCoordsTexture(),N=_.sourceCache.getRenderableTiles(),W=g.useProgram("terrainCoords");S.bindFramebuffer.set(_.getFramebuffer("coords").framebuffer),S.viewport.set([0,0,g.width/devicePixelRatio,g.height/devicePixelRatio]),S.clear({color:c.bf.transparent,depth:1}),_.coordsIndex=[];for(const J of N){const ee=_.getTerrainMesh(J.tileID),te=_.getTerrainData(J.tileID);S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,k.texture);const ie={u_terrain_coords_id:(255-_.coordsIndex.length)/255,u_texture:0,u_ele_delta:_.getMeshFrameDelta(E.zoom)},le=E.getProjectionData({overscaledTileID:J.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});W.draw(S,P.TRIANGLES,O,_n.disabled,I,Nt.backCCW,ie,te,le,"terrain",ee.vertexBuffer,ee.indexBuffer,ee.segments),_.coordsIndex.push(J.tileID.key)}S.bindFramebuffer.set(null),S.viewport.set([0,0,g.width,g.height])})(this,this.style.map.terrain))}renderLayer(e,a,l,d,g){l.isHidden(this.transform.zoom)||(l.type==="background"||l.type==="custom"||(d||[]).length)&&(this.id=l.id,c.cb(l)?(function(_,S,P,E,I,O){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:k}=O,N=_n.disabled,W=_.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&(function(J,ee,te,ie,le,ae,ue,me,oe){const Se=ee.transform,Ue=ee.style.map.terrain,Ie=le==="map",Oe=ae==="map";for(const je of J){const pt=ie.getTile(je),ht=pt.getBucket(te);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const Ke=c.an(ht.textSizeData,Se.zoom),Tt=c.aC(pt,1,ee.transform.zoom),ln=Vn(Ie,ee.transform,Tt),Pn=te.layout.get("icon-text-fit")!=="none"&&ht.hasIconData();if(Ke){const ar=Math.pow(2,Se.zoom-pt.tileID.overscaledZ),Fn=Ue?(Nn,$n)=>Ue.getElevation(je,Nn,$n):null;mc(ht,Ie,Oe,oe,Se,ln,ar,Ke,Pn,c.aD(Se,pt,ue,me),je.toUnwrapped(),Fn)}}})(E,_,P,S,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),I),P.paint.get("icon-opacity").constantOr(1)!==0&&ro(_,S,P,E,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),N,W,k),P.paint.get("text-opacity").constantOr(1)!==0&&ro(_,S,P,E,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),N,W,k),S.map.showCollisionBoxes&&(Wu(_,S,P,E,!0),Wu(_,S,P,E,!1))})(e,a,l,d,this.style.placement.variableOffsets,g):c.cc(l)?(function(_,S,P,E,I){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:O}=I,k=P.paint.get("circle-opacity"),N=P.paint.get("circle-stroke-width"),W=P.paint.get("circle-stroke-opacity"),J=!P.layout.get("circle-sort-key").isConstant();if(k.constantOr(1)===0&&(N.constantOr(1)===0||W.constantOr(1)===0))return;const ee=_.context,te=ee.gl,ie=_.transform,le=_.getDepthModeForSublayer(0,Xt.ReadOnly),ae=_n.disabled,ue=_.colorModeForRenderPass(),me=[],oe=ie.getCircleRadiusCorrection();for(let Se=0;Se<E.length;Se++){const Ue=E[Se],Ie=S.getTile(Ue),Oe=Ie.getBucket(P);if(!Oe)continue;const je=P.paint.get("circle-translate"),pt=P.paint.get("circle-translate-anchor"),ht=c.aD(ie,Ie,je,pt),Ke=Oe.programConfigurations.get(P.id),Tt=_.useProgram("circle",Ke),ln=Oe.layoutVertexBuffer,Pn=Oe.indexBuffer,ar=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ue),Fn={programConfiguration:Ke,program:Tt,layoutVertexBuffer:ln,indexBuffer:Pn,uniformValues:Gh(_,Ie,P,ht,oe),terrainData:ar,projectionData:ie.getProjectionData({overscaledTileID:Ue,applyGlobeMatrix:!O,applyTerrainMatrix:!0})};if(J){const Nn=Oe.segments.get();for(const $n of Nn)me.push({segments:new c.aM([$n]),sortKey:$n.sortKey,state:Fn})}else me.push({segments:Oe.segments,sortKey:0,state:Fn})}J&&me.sort(((Se,Ue)=>Se.sortKey-Ue.sortKey));for(const Se of me){const{programConfiguration:Ue,program:Ie,layoutVertexBuffer:Oe,indexBuffer:je,uniformValues:pt,terrainData:ht,projectionData:Ke}=Se.state;Ie.draw(ee,te.TRIANGLES,le,ae,ue,Nt.backCCW,pt,ht,Ke,P.id,Oe,je,Se.segments,P.paint,_.transform.zoom,Ue)}})(e,a,l,d,g):c.cd(l)?(function(_,S,P,E,I){if(P.paint.get("heatmap-opacity")===0)return;const O=_.context,{isRenderingToTexture:k,isRenderingGlobe:N}=I;if(_.style.map.terrain){for(const W of E){const J=S.getTile(W);S.hasRenderableParent(W)||(_.renderPass==="offscreen"?_l(_,J,P,W,N):_.renderPass==="translucent"&&ca(_,P,W,k,N))}O.viewport.set([0,0,_.width,_.height])}else _.renderPass==="offscreen"?(function(W,J,ee,te){const ie=W.context,le=ie.gl,ae=W.transform,ue=_n.disabled,me=new Hn([le.ONE,le.ONE],c.bf.transparent,[!0,!0,!0,!0]);(function(oe,Se,Ue){const Ie=oe.gl;oe.activeTexture.set(Ie.TEXTURE1),oe.viewport.set([0,0,Se.width/4,Se.height/4]);let Oe=Ue.heatmapFbos.get(c.c2);Oe?(Ie.bindTexture(Ie.TEXTURE_2D,Oe.colorAttachment.get()),oe.bindFramebuffer.set(Oe.framebuffer)):(Oe=wi(oe,Se.width/4,Se.height/4),Ue.heatmapFbos.set(c.c2,Oe))})(ie,W,ee),ie.clear({color:c.bf.transparent});for(let oe=0;oe<te.length;oe++){const Se=te[oe];if(J.hasRenderableParent(Se))continue;const Ue=J.getTile(Se),Ie=Ue.getBucket(ee);if(!Ie)continue;const Oe=Ie.programConfigurations.get(ee.id),je=W.useProgram("heatmap",Oe),pt=ae.getProjectionData({overscaledTileID:Se,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),ht=ae.getCircleRadiusCorrection();je.draw(ie,le.TRIANGLES,Xt.disabled,ue,me,Nt.backCCW,Zh(Ue,ae.zoom,ee.paint.get("heatmap-intensity"),ht),null,pt,ee.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,ee.paint,ae.zoom,Oe)}ie.viewport.set([0,0,W.width,W.height])})(_,S,P,E):_.renderPass==="translucent"&&(function(W,J){const ee=W.context,te=ee.gl;ee.setColorMode(W.colorModeForRenderPass());const ie=J.heatmapFbos.get(c.c2);ie&&(ee.activeTexture.set(te.TEXTURE0),te.bindTexture(te.TEXTURE_2D,ie.colorAttachment.get()),ee.activeTexture.set(te.TEXTURE1),Ra(ee,J).bind(te.LINEAR,te.CLAMP_TO_EDGE),W.useProgram("heatmapTexture").draw(ee,te.TRIANGLES,Xt.disabled,_n.disabled,W.colorModeForRenderPass(),Nt.disabled,Uu(W,J,0,1),null,null,J.id,W.viewportBuffer,W.quadTriangleIndexBuffer,W.viewportSegments,J.paint,W.transform.zoom))})(_,P)})(e,a,l,d,g):c.ce(l)?(function(_,S,P,E,I){if(_.renderPass!=="translucent")return;const{isRenderingToTexture:O}=I,k=P.paint.get("line-opacity"),N=P.paint.get("line-width");if(k.constantOr(1)===0||N.constantOr(1)===0)return;const W=_.getDepthModeForSublayer(0,Xt.ReadOnly),J=_.colorModeForRenderPass(),ee=P.paint.get("line-dasharray"),te=P.paint.get("line-pattern"),ie=te.constantOr(1),le=P.paint.get("line-gradient"),ae=P.getCrossfadeParameters(),ue=ie?"linePattern":ee?"lineSDF":le?"lineGradient":"line",me=_.context,oe=me.gl,Se=_.transform;let Ue=!0;for(const Ie of E){const Oe=S.getTile(Ie);if(ie&&!Oe.patternsLoaded())continue;const je=Oe.getBucket(P);if(!je)continue;const pt=je.programConfigurations.get(P.id),ht=_.context.program.get(),Ke=_.useProgram(ue,pt),Tt=Ue||Ke.program!==ht,ln=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Ie),Pn=te.constantOr(null);if(Pn&&Oe.imageAtlas){const Gn=Oe.imageAtlas,Un=Gn.patternPositions[Pn.to.toString()],vn=Gn.patternPositions[Pn.from.toString()];Un&&vn&&pt.setConstantPatternPositions(Un,vn)}const ar=Se.getProjectionData({overscaledTileID:Ie,applyGlobeMatrix:!O,applyTerrainMatrix:!0}),Fn=Se.getPixelScale(),Nn=ie?Vu(_,Oe,P,Fn,ae):ee?Zo(_,Oe,P,Fn,ee,ae):le?ic(_,Oe,P,Fn,je.lineClipsArray.length):Gc(_,Oe,P,Fn);if(ie)me.activeTexture.set(oe.TEXTURE0),Oe.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),pt.updatePaintBuffers(ae);else if(ee&&(Tt||_.lineAtlas.dirty))me.activeTexture.set(oe.TEXTURE0),_.lineAtlas.bind(me);else if(le){const Gn=je.gradients[P.id];let Un=Gn.texture;if(P.gradientVersion!==Gn.version){let vn=256;if(P.stepInterpolant){const jr=S.getSource().maxzoom,Ir=Ie.canonical.z===jr?Math.ceil(1<<_.transform.maxZoom-Ie.canonical.z):1;vn=c.ah(c.c3(je.maxLineLength/c.$*1024*Ir),256,me.maxTextureSize)}Gn.gradient=c.c4({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:vn,image:Gn.gradient||void 0,clips:je.lineClipsArray}),Gn.texture?Gn.texture.update(Gn.gradient):Gn.texture=new c.T(me,Gn.gradient,oe.RGBA),Gn.version=P.gradientVersion,Un=Gn.texture}me.activeTexture.set(oe.TEXTURE0),Un.bind(P.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}const $n=_.stencilModeForClipping(Ie);Ke.draw(me,oe.TRIANGLES,W,$n,J,Nt.disabled,Nn,ln,ar,P.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,P.paint,_.transform.zoom,pt,je.layoutVertexBuffer2),Ue=!1}})(e,a,l,d,g):c.cf(l)?(function(_,S,P,E,I){const O=P.paint.get("fill-color"),k=P.paint.get("fill-opacity");if(k.constantOr(1)===0)return;const{isRenderingToTexture:N}=I,W=_.colorModeForRenderPass(),J=P.paint.get("fill-pattern"),ee=_.opaquePassEnabledForLayer()&&!J.constantOr(1)&&O.constantOr(c.bf.transparent).a===1&&k.constantOr(0)===1?"opaque":"translucent";if(_.renderPass===ee){const te=_.getDepthModeForSublayer(1,_.renderPass==="opaque"?Xt.ReadWrite:Xt.ReadOnly);Li(_,S,P,E,te,W,!1,N)}if(_.renderPass==="translucent"&&P.paint.get("fill-antialias")){const te=_.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,Xt.ReadOnly);Li(_,S,P,E,te,W,!0,N)}})(e,a,l,d,g):c.cg(l)?(function(_,S,P,E,I){const O=P.paint.get("fill-extrusion-opacity");if(O===0)return;const{isRenderingToTexture:k}=I;if(_.renderPass==="translucent"){const N=new Xt(_.context.gl.LEQUAL,Xt.ReadWrite,_.depthRangeFor3D);if(O!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))Da(_,S,P,E,N,_n.disabled,Hn.disabled,k),Da(_,S,P,E,N,_.stencilModeFor3D(),_.colorModeForRenderPass(),k);else{const W=_.colorModeForRenderPass();Da(_,S,P,E,N,_n.disabled,W,k)}}})(e,a,l,d,g):c.ch(l)?(function(_,S,P,E,I){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent")return;const{isRenderingToTexture:O}=I,k=_.context,N=_.style.projection.useSubdivision,W=_.getDepthModeForSublayer(0,Xt.ReadOnly),J=_.colorModeForRenderPass();if(_.renderPass==="offscreen")(function(ee,te,ie,le,ae,ue,me){const oe=ee.context,Se=oe.gl;for(const Ue of ie){const Ie=te.getTile(Ue),Oe=Ie.dem;if(!Oe||!Oe.data||!Ie.needsHillshadePrepare)continue;const je=Oe.dim,pt=Oe.stride,ht=Oe.getPixels();if(oe.activeTexture.set(Se.TEXTURE1),oe.pixelStoreUnpackPremultiplyAlpha.set(!1),Ie.demTexture=Ie.demTexture||ee.getTileTexture(pt),Ie.demTexture){const Tt=Ie.demTexture;Tt.update(ht,{premultiply:!1}),Tt.bind(Se.NEAREST,Se.CLAMP_TO_EDGE)}else Ie.demTexture=new c.T(oe,ht,Se.RGBA,{premultiply:!1}),Ie.demTexture.bind(Se.NEAREST,Se.CLAMP_TO_EDGE);oe.activeTexture.set(Se.TEXTURE0);let Ke=Ie.fbo;if(!Ke){const Tt=new c.T(oe,{width:je,height:je,data:null},Se.RGBA);Tt.bind(Se.LINEAR,Se.CLAMP_TO_EDGE),Ke=Ie.fbo=oe.createFramebuffer(je,je,!0,!1),Ke.colorAttachment.set(Tt.texture)}oe.bindFramebuffer.set(Ke.framebuffer),oe.viewport.set([0,0,je,je]),ee.useProgram("hillshadePrepare").draw(oe,Se.TRIANGLES,ae,ue,me,Nt.disabled,ju(Ie.tileID,Oe),null,null,le.id,ee.rasterBoundsBuffer,ee.quadTriangleIndexBuffer,ee.rasterBoundsSegments),Ie.needsHillshadePrepare=!1}})(_,S,E,P,W,_n.disabled,J),k.viewport.set([0,0,_.width,_.height]);else if(_.renderPass==="translucent")if(N){const[ee,te,ie]=_.stencilConfigForOverlapTwoPass(E);Kc(_,S,P,ie,ee,W,J,!1,O),Kc(_,S,P,ie,te,W,J,!0,O)}else{const[ee,te]=_.getStencilConfigForOverlapAndUpdateStencilID(E);Kc(_,S,P,te,ee,W,J,!1,O)}})(e,a,l,d,g):c.ci(l)?(function(_,S,P,E,I){if(_.renderPass!=="translucent"||!E.length)return;const{isRenderingToTexture:O}=I,k=_.style.projection.useSubdivision,N=_.getDepthModeForSublayer(0,Xt.ReadOnly),W=_.colorModeForRenderPass();if(k){const[J,ee,te]=_.stencilConfigForOverlapTwoPass(E);wo(_,S,P,te,J,N,W,!1,O),wo(_,S,P,te,ee,N,W,!0,O)}else{const[J,ee]=_.getStencilConfigForOverlapAndUpdateStencilID(E);wo(_,S,P,ee,J,N,W,!1,O)}})(e,a,l,d,g):c.cj(l)?(function(_,S,P,E,I){if(_.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!E.length)return;const{isRenderingToTexture:O}=I,k=S.getSource(),N=_.style.projection.useSubdivision;if(k instanceof Br)Gr(_,S,P,E,null,!1,!1,k.tileCoords,k.flippedWindingOrder,O);else if(N){const[W,J,ee]=_.stencilConfigForOverlapTwoPass(E);Gr(_,S,P,ee,W,!1,!0,gc,!1,O),Gr(_,S,P,ee,J,!0,!0,gc,!1,O)}else{const[W,J]=_.getStencilConfigForOverlapAndUpdateStencilID(E);Gr(_,S,P,J,W,!1,!0,gc,!1,O)}})(e,a,l,d,g):c.ck(l)?(function(_,S,P,E,I){const O=P.paint.get("background-color"),k=P.paint.get("background-opacity");if(k===0)return;const{isRenderingToTexture:N}=I,W=_.context,J=W.gl,ee=_.style.projection,te=_.transform,ie=te.tileSize,le=P.paint.get("background-pattern");if(_.isPatternMissing(le))return;const ae=!le&&O.a===1&&k===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==ae)return;const ue=_n.disabled,me=_.getDepthModeForSublayer(0,ae==="opaque"?Xt.ReadWrite:Xt.ReadOnly),oe=_.colorModeForRenderPass(),Se=_.useProgram(le?"backgroundPattern":"background"),Ue=E||Ce(te,{tileSize:ie,terrain:_.style.map.terrain});le&&(W.activeTexture.set(J.TEXTURE0),_.imageManager.bind(_.context));const Ie=P.getCrossfadeParameters();for(const Oe of Ue){const je=te.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),pt=le?Yh(k,_,le,{tileID:Oe,tileSize:ie},Ie):Xh(k,O),ht=_.style.map.terrain&&_.style.map.terrain.getTerrainData(Oe),Ke=ee.getMeshFromTileID(W,Oe.canonical,!1,!0,"raster");Se.draw(W,J.TRIANGLES,me,ue,oe,Nt.backCCW,pt,ht,je,P.id,Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)}})(e,0,l,d,g):c.cl(l)&&(function(_,S,P,E){const{isRenderingGlobe:I}=E,O=_.context,k=P.implementation,N=_.style.projection,W=_.transform,J=W.getProjectionDataForCustomLayer(I),ee={farZ:W.farZ,nearZ:W.nearZ,fov:W.fov*Math.PI/180,modelViewProjectionMatrix:W.modelViewProjectionMatrix,projectionMatrix:W.projectionMatrix,shaderData:{variantName:N.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${N.shaderPreludeCode.vertexSource}`,define:N.shaderDefine},defaultProjectionData:J},te=k.renderingMode?k.renderingMode:"2d";if(_.renderPass==="offscreen"){const ie=k.prerender;ie&&(_.setCustomLayerDefaults(),O.setColorMode(_.colorModeForRenderPass()),ie.call(k,O.gl,ee),O.setDirty(),_.setBaseState())}else if(_.renderPass==="translucent"){_.setCustomLayerDefaults(),O.setColorMode(_.colorModeForRenderPass()),O.setStencilMode(_n.disabled);const ie=te==="3d"?_.getDepthModeFor3D():_.getDepthModeForSublayer(0,Xt.ReadOnly);O.setDepthMode(ie),k.render(O.gl,ee),O.setDirty(),_.setBaseState(),O.bindFramebuffer.set(null)}})(e,0,l,g))}saveTileTexture(e){const a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const a=this.imageManager.getPattern(e.from.toString()),l=this.imageManager.getPattern(e.to.toString());return!a||!l}useProgram(e,a,l=!1,d=[]){this.cache=this.cache||{};const g=!!this.style.map.terrain,_=this.style.projection,S=l?Ea.projectionMercator:_.shaderPreludeCode,P=l?go:_.shaderDefine,E=e+(a?a.cacheKey:"")+`/${l?fs:_.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(g?"/terrain":"")+(d?`/${d.join("/")}`:"");return this.cache[E]||(this.cache[E]=new Nu(this.context,Ea[e],a,Ii[e],this._showOverdrawInspector,g,S,P,d)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}function Po(f,e){let a,l=!1,d=null,g=null;const _=()=>{d=null,l&&(f.apply(g,a),d=setTimeout(_,e),l=!1)};return(...S)=>(l=!0,g=this,a=S,d||_(),d)}class ki{constructor(e){this._getCurrentHash=()=>{const a=window.location.hash.replace("#","");if(this._hashName){let l;return a.split("&").map((d=>d.split("="))).forEach((d=>{d[0]===this._hashName&&(l=d)})),(l&&l[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{const a=this._getCurrentHash();if(!this._isValidHash(a))return!1;const l=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:l,pitch:+(a[4]||0)}),!0},this._updateHashUnthrottled=()=>{const a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{const a=this._getCurrentHash();if(a.length===0)return;const l=a.join("/");let d=l;d.split("&").length>0&&(d=d.split("&")[0]),this._hashName&&(d=`${this._hashName}=${l}`);let g=window.location.hash.replace(d,"");g.startsWith("#&")?g=g.slice(0,1)+g.slice(2):g==="#"&&(g="");let _=window.location.href.replace(/(#.+)?$/,g);_=_.replace("&&","&"),window.history.replaceState(window.history.state,null,_)},this._updateHash=Po(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const a=this._map.getCenter(),l=Math.round(100*this._map.getZoom())/100,d=Math.ceil((l*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,d),_=Math.round(a.lng*g)/g,S=Math.round(a.lat*g)/g,P=this._map.getBearing(),E=this._map.getPitch();let I="";if(I+=e?`/${_}/${S}/${l}`:`${l}/${S}/${_}`,(P||E)&&(I+="/"+Math.round(10*P)/10),E&&(I+=`/${Math.round(E)}`),this._hashName){const O=this._hashName;let k=!1;const N=window.location.hash.slice(1).split("&").map((W=>{const J=W.split("=")[0];return J===O?(k=!0,`${J}=${I}`):W})).filter((W=>W));return k||N.push(`${O}=${I}`),`#${N.join("&")}`}return`#${I}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.S(+e[2],+e[1])}catch{return!1}const a=+e[0],l=+(e[3]||0),d=+(e[4]||0);return a>=this._map.getMinZoom()&&a<=this._map.getMaxZoom()&&l>=-180&&l<=180&&d>=this._map.getMinPitch()&&d<=this._map.getMaxPitch()}}const Ki={linearity:.3,easing:c.cm(0,0,.3,1)},ha=c.e({deceleration:2500,maxSpeed:1400},Ki),yc=c.e({deceleration:20,maxSpeed:1400},Ki),Jc=c.e({deceleration:1e3,maxSpeed:360},Ki),bl=c.e({deceleration:1e3,maxSpeed:90},Ki),_c=c.e({deceleration:1e3,maxSpeed:360},Ki);class Jo{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:ge.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,a=ge.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const a={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)a.zoom+=g.zoomDelta||0,a.bearing+=g.bearingDelta||0,a.pitch+=g.pitchDelta||0,a.roll+=g.rollDelta||0,g.panDelta&&a.pan._add(g.panDelta),g.around&&(a.around=g.around),g.pinchAround&&(a.pinchAround=g.pinchAround);const l=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(a.pan.mag()){const g=Qi(a.pan.mag(),l,c.e({},ha,e||{})),_=a.pan.mult(g.amount/a.pan.mag()),S=this._map.cameraHelper.handlePanInertia(_,this._map.transform);d.center=S.easingCenter,d.offset=S.easingOffset,Rr(d,g)}if(a.zoom){const g=Qi(a.zoom,l,yc);d.zoom=this._map.transform.zoom+g.amount,Rr(d,g)}if(a.bearing){const g=Qi(a.bearing,l,Jc);d.bearing=this._map.transform.bearing+c.ah(g.amount,-179,179),Rr(d,g)}if(a.pitch){const g=Qi(a.pitch,l,bl);d.pitch=this._map.transform.pitch+g.amount,Rr(d,g)}if(a.roll){const g=Qi(a.roll,l,_c);d.roll=this._map.transform.roll+c.ah(g.amount,-179,179),Rr(d,g)}if(d.zoom||d.bearing){const g=a.pinchAround===void 0?a.around:a.pinchAround;d.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),c.e(d,{noMoveStart:!0})}}function Rr(f,e){(!f.duration||f.duration<e.duration)&&(f.duration=e.duration,f.easing=e.easing)}function Qi(f,e,a){const{maxSpeed:l,linearity:d,deceleration:g}=a,_=c.ah(f*d/(e/1e3),-l,l),S=Math.abs(_)/(g*d);return{easing:a.easing,duration:1e3*S,amount:_*(S/2)}}class Oi extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l,d={}){l=l instanceof MouseEvent?l:new MouseEvent(e,l);const g=ne.mousePos(a.getCanvas(),l),_=a.unproject(g);super(e,c.e({point:g,lngLat:_,originalEvent:l},d)),this._defaultPrevented=!1,this.target=a}}class wl extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){const d=e==="touchend"?l.changedTouches:l.touches,g=ne.touchPos(a.getCanvasContainer(),d),_=g.map((P=>a.unproject(P))),S=g.reduce(((P,E,I,O)=>P.add(E.div(O.length))),new c.P(0,0));super(e,{points:g,point:S,lngLats:_,lngLat:a.unproject(S),originalEvent:l}),this._defaultPrevented=!1}}class Yu extends c.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,l){super(e,{originalEvent:l}),this._defaultPrevented=!1}}class ed{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Yu(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new Oi(e.type,this._map,e))}mouseup(e){this._map.fire(new Oi(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Oi(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Oi(e.type,this._map,e))}mouseover(e){this._map.fire(new Oi(e.type,this._map,e))}mouseout(e){this._map.fire(new Oi(e.type,this._map,e))}touchstart(e){return this._firePreventable(new wl(e.type,this._map,e))}touchmove(e){this._map.fire(new wl(e.type,this._map,e))}touchend(e){this._map.fire(new wl(e.type,this._map,e))}touchcancel(e){this._map.fire(new wl(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ur{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Oi(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Oi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Oi(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class es{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Es{constructor(e,a){this._map=e,this._tr=new es(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(ne.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;const l=a;if(this._lastPos.equals(l)||!this._box&&l.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=l,this._box||(this._box=ne.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const g=Math.min(d.x,l.x),_=Math.max(d.x,l.x),S=Math.min(d.y,l.y),P=Math.max(d.y,l.y);ne.setTransform(this._box,`translate(${g}px,${S}px)`),this._box.style.width=_-g+"px",this._box.style.height=P-S+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;const l=this._startPos,d=a;if(this.reset(),ne.suppressClick(),l.x!==d.x||l.y!==d.y)return this._map.fire(new c.l("boxzoomend",{originalEvent:e})),{cameraAnimation:g=>g.fitScreenCoordinates(l,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ne.remove(this._box),this._box=null),ne.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new c.l(e,{originalEvent:a}))}}function ts(f,e){if(f.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${e.length}`);const a={};for(let l=0;l<f.length;l++)a[f[l].identifier]=e[l];return a}class Sl{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,l){(this.centroid||l.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),l.length===this.numTouches&&(this.centroid=(function(d){const g=new c.P(0,0);for(const _ of d)g._add(_);return g.div(d.length)})(a),this.touches=ts(l,a)))}touchmove(e,a,l){if(this.aborted||!this.centroid)return;const d=ts(l,a);for(const g in this.touches){const _=d[g];(!_||_.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(e,a,l){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),l.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class Co{constructor(e){this.singleTap=new Sl(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,l){this.singleTap.touchstart(e,a,l)}touchmove(e,a,l){this.singleTap.touchmove(e,a,l)}touchend(e,a,l){const d=this.singleTap.touchend(e,a,l);if(d){const g=e.timeStamp-this.lastTime<500,_=!this.lastTap||this.lastTap.dist(d)<30;if(g&&_||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class fi{constructor(e){this._tr=new es(e),this._zoomIn=new Co({numTouches:1,numTaps:2}),this._zoomOut=new Co({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,l){this._zoomIn.touchstart(e,a,l),this._zoomOut.touchstart(e,a,l)}touchmove(e,a,l){this._zoomIn.touchmove(e,a,l),this._zoomOut.touchmove(e,a,l)}touchend(e,a,l){const d=this._zoomIn.touchend(e,a,l),g=this._zoomOut.touchend(e,a,l),_=this._tr;return d?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:_.zoom+1,around:_.unproject(d)},{originalEvent:e})}):g?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:_.zoom-1,around:_.unproject(g)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bi{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.rollDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(a)?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;const l=this._lastPoint;if(!l)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const d=Array.isArray(a)?a[0]:a;return!this._moved&&d.dist(l)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(l,d))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&ne.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Ku=0,La=2,Ms={[Ku]:1,[La]:2};class ka{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const a=ne.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!(function(a,l){const d=Ms[l];return a.buttons===void 0||(a.buttons&d)!==d})(e,this._eventButton)}isValidEndEvent(e){return ne.mouseButton(e)===this._eventButton}}class Qu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class eu{constructor(e=new ka({checkCorrectEvent:()=>!0}),a=new Qu){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=a}_executeRelevantHandler(e,a,l){return e instanceof MouseEvent?a(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?l(e):void 0}startMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.startMove(a)),(a=>this.oneFingerTouchMoveStateManager.startMove(a)))}endMove(e){this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.endMove(a)),(a=>this.oneFingerTouchMoveStateManager.endMove(a)))}isValidStartEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidStartEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidStartEvent(a)))}isValidMoveEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidMoveEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(a)))}isValidEndEvent(e){return this._executeRelevantHandler(e,(a=>this.mouseMoveStateManager.isValidEndEvent(a)),(a=>this.oneFingerTouchMoveStateManager.isValidEndEvent(a)))}}const vc=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=e=>{e.preventDefault()}};class Pl{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,l){return this._calculateTransform(e,a,l)}touchmove(e,a,l){if(this._active){if(!this._shouldBePrevented(l.length))return e.preventDefault(),this._calculateTransform(e,a,l);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,l){this._calculateTransform(e,a,l),this._active&&this._shouldBePrevented(l.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,l){l.length>0&&(this._active=!0);const d=ts(l,a),g=new c.P(0,0),_=new c.P(0,0);let S=0;for(const E in d){const I=d[E],O=this._touches[E];O&&(g._add(I),_._add(I.sub(O)),S++,d[E]=I)}if(this._touches=d,this._shouldBePrevented(S)||!_.mag())return;const P=_.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(S),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ns{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,l){this._firstTwoTouches||l.length<2||(this._firstTwoTouches=[l[0].identifier,l[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,l){if(!this._firstTwoTouches)return;e.preventDefault();const[d,g]=this._firstTwoTouches,_=Fi(l,a,d),S=Fi(l,a,g);if(!_||!S)return;const P=this._aroundCenter?null:_.add(S).div(2);return this._move([_,S],P,e)}touchend(e,a,l){if(!this._firstTwoTouches)return;const[d,g]=this._firstTwoTouches,_=Fi(l,a,d),S=Fi(l,a,g);_&&S||(this._active&&ne.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Fi(f,e,a){for(let l=0;l<f.length;l++)if(f[l].identifier===a)return e[l]}function bt(f,e){return Math.log(f/e)/Math.LN2}class tu extends ns{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){const l=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(bt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:bt(this._distance,l),pinchAround:a}}}function Rs(f,e){return 180*f.angleWith(e)/Math.PI}class nu extends ns{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,l){const d=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Rs(this._vector,d),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const a=25/(Math.PI*this._minDiameter)*360,l=Rs(e,this._startVector);return Math.abs(l)<a}}function Oa(f){return Math.abs(f.y)>Math.abs(f.x)}class Ds extends ns{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,l){super.touchstart(e,a,l),this._currentTouchCount=l.length}_start(e){this._lastPoints=e,Oa(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,l){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const d=e[0].sub(this._lastPoints[0]),g=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,g,l.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(d.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,l){if(this._valid!==void 0)return this._valid;const d=e.mag()>=2,g=a.mag()>=2;if(!d&&!g)return;if(!d||!g)return this._firstMove===void 0&&(this._firstMove=l),l-this._firstMove<100&&void 0;const _=e.y>0==a.y>0;return Oa(e)&&Oa(a)&&_}}const ru={panStep:100,bearingStep:15,pitchStep:10};class en{constructor(e){this._tr=new es(e);const a=ru;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,l=0,d=0,g=0,_=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?l=-1:(e.preventDefault(),g=-1);break;case 39:e.shiftKey?l=1:(e.preventDefault(),g=1);break;case 38:e.shiftKey?d=1:(e.preventDefault(),_=-1);break;case 40:e.shiftKey?d=-1:(e.preventDefault(),_=1);break;default:return}return this._rotationDisabled&&(l=0,d=0),{cameraAnimation:S=>{const P=this._tr;S.easeTo({duration:300,easeId:"keyboardHandler",easing:xc,zoom:a?Math.round(P.zoom)+a*(e.shiftKey?2:1):P.zoom,bearing:P.bearing+l*this._bearingStep,pitch:P.pitch+d*this._pitchStep,offset:[-g*this._panStep,-_*this._panStep],center:P.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xc(f){return f*(2-f)}const iu=4.000244140625,io=1/450;class To{constructor(e,a){this._onTimeout=l=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)},this._map=e,this._tr=new es(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=io}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const l=ge.now(),d=l-(this._lastWheelEventTime||0);this._lastWheelEventTime=l,a!==0&&a%iu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(d*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=ne.mousePos(this._map.getCanvas(),e),l=this._tr;this._aroundPoint=this._aroundCenter?l.transform.locationToScreenPoint(c.S.convert(l.center)):a,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const S=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=S),typeof this._targetZoom=="number"&&(this._targetZoom+=S)}if(this._delta!==0){const S=this._type==="wheel"&&Math.abs(this._delta)>iu?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*S)));this._delta<0&&P!==0&&(P=1/P);const E=typeof this._targetZoom!="number"?e.scale:c.af(this._targetZoom);this._targetZoom=e.getConstrained(e.getCameraLngLat(),c.ak(E*P)).zoom,this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const a=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,l=this._startZoom,d=this._easing;let g,_=!1;if(this._type==="wheel"&&l&&d){const S=ge.now()-this._lastWheelEventTime,P=Math.min((S+5)/200,1),E=d(P);g=c.C.number(l,a,E),P<1?this._frameId||(this._frameId=!0):_=!0}else g=a,_=!0;return this._active=!0,_&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout}),200)),this._lastExpectedZoom=g,{noInertia:!0,needsRenderFrame:!_,zoomDelta:g-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=c.co;if(this._prevEase){const l=this._prevEase,d=(ge.now()-l.start)/l.duration,g=l.easing(d+.01)-l.easing(d),_=.27/Math.sqrt(g*g+1e-4)*.01,S=Math.sqrt(.0729-_*_);a=c.cm(_,S,.25,1)}return this._prevEase={start:ge.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Cl{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class au{constructor(e){this._tr=new es(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:l=>{l.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bc{constructor(){this._tap=new Co({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,l){if(!this._swipePoint)if(this._tapTime){const d=a[0],g=e.timeStamp-this._tapTime<500,_=this._tapPoint.dist(d)<30;g&&_?l.length>0&&(this._swipePoint=d,this._swipeTouch=l[0].identifier):this.reset()}else this._tap.touchstart(e,a,l)}touchmove(e,a,l){if(this._tapTime){if(this._swipePoint){if(l[0].identifier!==this._swipeTouch)return;const d=a[0],g=d.y-this._swipePoint.y;return this._swipePoint=d,e.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(e,a,l)}touchend(e,a,l){if(this._tapTime)this._swipePoint&&l.length===0&&this.reset();else{const d=this._tap.touchend(e,a,l);d&&(this._tapTime=e.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Is{constructor(e,a,l){this._el=e,this._mousePan=a,this._touchPan=l}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Tl{constructor(e,a,l,d){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=a,this._mousePitch=l,this._mouseRoll=d}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class ou{constructor(e,a,l,d){this._el=e,this._touchZoom=a,this._touchRotate=l,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ju{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=ne.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const l=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),d=document.createElement("div");d.className="maplibregl-desktop-message",d.textContent=a,this._container.appendChild(d);const g=document.createElement("div");g.className="maplibregl-mobile-message",g.textContent=l,this._container.appendChild(g),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(ne.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new c.l("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout((()=>{this._container.classList.remove("maplibregl-show")}),100))}}const Ao=f=>f.zoom||f.drag||f.roll||f.pitch||f.rotate;class Ba extends c.l{}function Ln(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta||f.rollDelta}class eh{constructor(e,a){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,g)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const _=d.type==="renderFrame"?void 0:d,S={needsRenderFrame:!1},P={},E={};for(const{handlerName:k,handler:N,allowed:W}of this._handlers){if(!N.isEnabled())continue;let J;if(this._blockedByActive(E,W,k))N.reset();else if(N[g||d.type]){if(c.cp(d,g||d.type)){const ee=ne.mousePos(this._map.getCanvas(),d);J=N[g||d.type](d,ee)}else if(c.cq(d,g||d.type)){const ee=this._getMapTouches(d.touches),te=ne.touchPos(this._map.getCanvas(),ee);J=N[g||d.type](d,te,ee)}else c.cr(g||d.type)||(J=N[g||d.type](d));this.mergeHandlerResult(S,P,J,k,_),J&&J.needsRenderFrame&&this._triggerRenderFrame()}(J||N.isActive())&&(E[k]=N)}const I={};for(const k in this._previousActiveHandlers)E[k]||(I[k]=_);this._previousActiveHandlers=E,(Object.keys(I).length||Ln(S))&&(this._changes.push([S,P,I]),this._triggerRenderFrame()),(Object.keys(E).length||Ln(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:O}=S;O&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],O(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Jo(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);const l=this._el;this._listeners=[[l,"touchstart",{passive:!0}],[l,"touchmove",{passive:!1}],[l,"touchend",void 0],[l,"touchcancel",void 0],[l,"mousedown",void 0],[l,"mousemove",void 0],[l,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[l,"mouseover",void 0],[l,"mouseout",void 0],[l,"dblclick",void 0],[l,"click",void 0],[l,"keydown",{capture:!1}],[l,"keyup",void 0],[l,"wheel",{passive:!1}],[l,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,g,_]of this._listeners)ne.addEventListener(d,g,d===document?this.handleWindowEvent:this.handleEvent,_)}destroy(){for(const[e,a,l]of this._listeners)ne.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,l)}_addDefaultHandlers(e){const a=this._map,l=a.getCanvasContainer();this._add("mapEvent",new ed(a,e));const d=a.boxZoom=new Es(a,e);this._add("boxZoom",d),e.interactive&&e.boxZoom&&d.enable();const g=a.cooperativeGestures=new Ju(a,e.cooperativeGestures);this._add("cooperativeGestures",g),e.cooperativeGestures&&g.enable();const _=new fi(a),S=new au(a);a.doubleClickZoom=new Cl(S,_),this._add("tapZoom",_),this._add("clickZoom",S),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();const P=new bc;this._add("tapDragZoom",P);const E=a.touchPitch=new Ds(a);this._add("touchPitch",E),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);const I=()=>a.project(a.getCenter()),O=(function({enable:ae,clickTolerance:ue,aroundCenter:me=!0,minPixelCenterThreshold:oe=100,rotateDegreesPerPixelMoved:Se=.8},Ue){const Ie=new ka({checkCorrectEvent:Oe=>ne.mouseButton(Oe)===0&&Oe.ctrlKey||ne.mouseButton(Oe)===2&&!Oe.ctrlKey});return new Bi({clickTolerance:ue,move:(Oe,je)=>{const pt=Ue();if(me&&Math.abs(pt.y-Oe.y)>oe)return{bearingDelta:c.cn(new c.P(Oe.x,je.y),je,pt)};let ht=(je.x-Oe.x)*Se;return me&&je.y<pt.y&&(ht=-ht),{bearingDelta:ht}},moveStateManager:Ie,enable:ae,assignEvents:vc})})(e,I),k=(function({enable:ae,clickTolerance:ue,pitchDegreesPerPixelMoved:me=-.5}){const oe=new ka({checkCorrectEvent:Se=>ne.mouseButton(Se)===0&&Se.ctrlKey||ne.mouseButton(Se)===2});return new Bi({clickTolerance:ue,move:(Se,Ue)=>({pitchDelta:(Ue.y-Se.y)*me}),moveStateManager:oe,enable:ae,assignEvents:vc})})(e),N=(function({enable:ae,clickTolerance:ue,rollDegreesPerPixelMoved:me=.3},oe){const Se=new ka({checkCorrectEvent:Ue=>ne.mouseButton(Ue)===2&&Ue.ctrlKey});return new Bi({clickTolerance:ue,move:(Ue,Ie)=>{const Oe=oe();let je=(Ie.x-Ue.x)*me;return Ie.y<Oe.y&&(je=-je),{rollDelta:je}},moveStateManager:Se,enable:ae,assignEvents:vc})})(e,I);a.dragRotate=new Tl(e,O,k,N),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",k,["mouseRotate","mouseRoll"]),this._add("mouseRoll",N,["mousePitch"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();const W=(function({enable:ae,clickTolerance:ue}){const me=new ka({checkCorrectEvent:oe=>ne.mouseButton(oe)===0&&!oe.ctrlKey});return new Bi({clickTolerance:ue,move:(oe,Se)=>({around:Se,panDelta:Se.sub(oe)}),activateOnStart:!0,moveStateManager:me,enable:ae,assignEvents:vc})})(e),J=new Pl(e,a);a.dragPan=new Is(l,W,J),this._add("mousePan",W),this._add("touchPan",J,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);const ee=new nu,te=new tu;a.touchZoomRotate=new ou(l,te,ee,P),this._add("touchRotate",ee,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);const ie=a.scrollZoom=new To(a,(()=>this._triggerRenderFrame()));this._add("scrollZoom",ie,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);const le=a.keyboard=new en(a);this._add("keyboard",le),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new Ur(a))}_add(e,a,l){this._handlers.push({handlerName:e,handler:a,allowed:l}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ao(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,l){for(const d in e)if(d!==l&&(!a||a.indexOf(d)<0))return!0;return!1}_getMapTouches(e){const a=[];for(const l of e)this._el.contains(l.target)&&a.push(l);return a}mergeHandlerResult(e,a,l,d,g){if(!l)return;c.e(e,l);const _={handlerName:d,originalEvent:l.originalEvent||g};l.zoomDelta!==void 0&&(a.zoom=_),l.panDelta!==void 0&&(a.drag=_),l.rollDelta!==void 0&&(a.roll=_),l.pitchDelta!==void 0&&(a.pitch=_),l.bearingDelta!==void 0&&(a.rotate=_)}_applyChanges(){const e={},a={},l={};for(const[d,g,_]of this._changes)d.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(d.panDelta)),d.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+d.pitchDelta),d.rollDelta&&(e.rollDelta=(e.rollDelta||0)+d.rollDelta),d.around!==void 0&&(e.around=d.around),d.pinchAround!==void 0&&(e.pinchAround=d.pinchAround),d.noInertia&&(e.noInertia=d.noInertia),c.e(a,g),c.e(l,_);this._updateMapTransform(e,a,l),this._changes=[]}_updateMapTransform(e,a,l){const d=this._map,g=d._getTransformForUpdate(),_=d.terrain;if(!(Ln(e)||_&&this._terrainMovement))return this._fireEvents(a,l,!0);d._stop(!0);let{panDelta:S,zoomDelta:P,bearingDelta:E,pitchDelta:I,rollDelta:O,around:k,pinchAround:N}=e;N!==void 0&&(k=N),k=k||d.transform.centerPoint,_&&!g.isPointOnMapSurface(k)&&(k=g.centerPoint);const W={panDelta:S,zoomDelta:P,rollDelta:O,pitchDelta:I,bearingDelta:E,around:k};this._map.cameraHelper.useGlobeControls&&!g.isPointOnMapSurface(k)&&(k=g.centerPoint);const J=k.distSqr(g.centerPoint)<.01?g.center:g.screenPointToLocation(S?k.sub(S):k);_?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,g),this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?g.setCenter(g.screenPointToLocation(g.centerPoint.sub(S))):this._map.cameraHelper.handleMapControlsPan(W,g,J):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(W,g,J))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(W,g),this._map.cameraHelper.handleMapControlsPan(W,g,J)),d._applyUpdatedTransform(g),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,l,!0)}_fireEvents(e,a,l){const d=Ao(this._eventsInProgress),g=Ao(e),_={};for(const O in e){const{originalEvent:k}=e[O];this._eventsInProgress[O]||(_[`${O}start`]=k),this._eventsInProgress[O]=e[O]}!d&&g&&this._fireEvent("movestart",g.originalEvent);for(const O in _)this._fireEvent(O,_[O]);g&&this._fireEvent("move",g.originalEvent);for(const O in e){const{originalEvent:k}=e[O];this._fireEvent(O,k)}const S={};let P;for(const O in this._eventsInProgress){const{handlerName:k,originalEvent:N}=this._eventsInProgress[O];this._handlersById[k].isActive()||(delete this._eventsInProgress[O],P=a[k]||N,S[`${O}end`]=P)}for(const O in S)this._fireEvent(O,S[O]);const E=Ao(this._eventsInProgress),I=(d||g)&&!E;if(I&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const O=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&O.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(O)}if(l&&I){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),k=N=>N!==0&&-this._bearingSnap<N&&N<this._bearingSnap;!O||!O.essential&&ge.prefersReducedMotion?(this._map.fire(new c.l("moveend",{originalEvent:P})),k(this._map.getBearing())&&this._map.resetNorth()):(k(O.bearing||this._map.getBearing())&&(O.bearing=0),O.freezeElevation=!0,this._map.easeTo(O,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new c.l(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{delete this._frameId,this.handleEvent(new Ba("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Al extends c.E{constructor(e,a,l){super(),this._renderFrameCallback=()=>{const d=Math.min((ge.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(d)),d<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=l.bearingSnap,this.cameraHelper=a,this.on("moveend",(()=>{delete this._requestedCameraState}))}migrateProjection(e,a){e.apply(this.transform),this.transform=e,this.cameraHelper=a}getCenter(){return new c.S(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,a){return this.jumpTo({elevation:e},a),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,a,l){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},a),l)}panTo(e,a,l){return this.easeTo(c.e({center:e},a),l)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,l){return this.easeTo(c.e({zoom:e},a),l)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,a){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)).fire(new c.l("moveend",a))),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,l){return this.easeTo(c.e({bearing:e},a),l)}resetNorth(e,a){return this.rotateTo(0,c.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}getRoll(){return this.transform.roll}setRoll(e,a){return this.jumpTo({roll:e},a),this}cameraForBounds(e,a){e=qt.convert(e).adjustAntiMeridian();const l=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),l,a)}_cameraForBoxAndBearing(e,a,l,d){const g={top:0,bottom:0,right:0,left:0};if(typeof(d=c.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const E=d.padding;d.padding={top:E,bottom:E,right:E,left:E}}const _=c.e(g,d.padding);d.padding=_;const S=this.transform,P=new qt(e,a);return this.cameraHelper.cameraForBoxAndBearing(d,_,P,l,S)}fitBounds(e,a,l){return this._fitInternal(this.cameraForBounds(e,a),a,l)}fitScreenCoordinates(e,a,l,d,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(a)),l,d),d,g)}_fitInternal(e,a,l){return e?(delete(a=c.e(e,a)).padding,a.linear?this.easeTo(a,l):this.flyTo(a,l)):this}jumpTo(e,a){this.stop();const l=this._getTransformForUpdate();let d=!1,g=!1,_=!1;const S=l.zoom;this.cameraHelper.handleJumpToCenterZoom(l,e);const P=l.zoom!==S;return"elevation"in e&&l.elevation!==+e.elevation&&l.setElevation(+e.elevation),"bearing"in e&&l.bearing!==+e.bearing&&(d=!0,l.setBearing(+e.bearing)),"pitch"in e&&l.pitch!==+e.pitch&&(g=!0,l.setPitch(+e.pitch)),"roll"in e&&l.roll!==+e.roll&&(_=!0,l.setRoll(+e.roll)),e.padding==null||l.isPaddingEqual(e.padding)||l.setPadding(e.padding),this._applyUpdatedTransform(l),this.fire(new c.l("movestart",a)).fire(new c.l("move",a)),P&&this.fire(new c.l("zoomstart",a)).fire(new c.l("zoom",a)).fire(new c.l("zoomend",a)),d&&this.fire(new c.l("rotatestart",a)).fire(new c.l("rotate",a)).fire(new c.l("rotateend",a)),g&&this.fire(new c.l("pitchstart",a)).fire(new c.l("pitch",a)).fire(new c.l("pitchend",a)),_&&this.fire(new c.l("rollstart",a)).fire(new c.l("roll",a)).fire(new c.l("rollend",a)),this.fire(new c.l("moveend",a))}calculateCameraOptionsFromTo(e,a,l,d=0){const g=c.a1.fromLngLat(e,a),_=c.a1.fromLngLat(l,d),S=_.x-g.x,P=_.y-g.y,E=_.z-g.z,I=Math.hypot(S,P,E);if(I===0)throw new Error("Can't calculate camera options with same From and To");const O=Math.hypot(S,P),k=c.ak(this.transform.cameraToCenterDistance/I/this.transform.tileSize),N=180*Math.atan2(S,-P)/Math.PI;let W=180*Math.acos(O/I)/Math.PI;return W=E<0?90-W:90+W,{center:_.toLngLat(),elevation:d,zoom:k,pitch:W,bearing:N}}calculateCameraOptionsFromCameraLngLatAltRotation(e,a,l,d,g){const _=this.transform.calculateCenterFromCameraLngLatAlt(e,a,l,d);return{center:_.center,elevation:_.elevation,zoom:_.zoom,bearing:l,pitch:d,roll:g}}easeTo(e,a){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.co},e)).animate===!1||!e.essential&&ge.prefersReducedMotion)&&(e.duration=0);const l=this._getTransformForUpdate(),d=this.getBearing(),g=l.pitch,_=l.roll,S="bearing"in e?this._normalizeBearing(e.bearing,d):d,P="pitch"in e?+e.pitch:g,E="roll"in e?this._normalizeBearing(e.roll,_):_,I="padding"in e?e.padding:l.padding,O=c.P.convert(e.offset);let k,N;e.around&&(k=c.S.convert(e.around),N=l.locationToScreenPoint(k));const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},J=this.cameraHelper.handleEaseTo(l,{bearing:S,pitch:P,roll:E,padding:I,around:k,aroundPoint:N,offsetAsPoint:O,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||d!==S,this._pitching=this._pitching||P!==g,this._rolling=this._rolling||E!==_,this._padding=!l.isPaddingEqual(I),this._zooming=this._zooming||J.isZooming,this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,W),this.terrain&&this._prepareElevation(J.elevationCenter),this._ease((ee=>{J.easeFunc(ee),this.terrain&&!e.freezeElevation&&this._updateElevation(ee),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(ee=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,ee)}),e),this}_prepareEase(e,a,l={}){this._moving=!0,a||l.moving||this.fire(new c.l("movestart",e)),this._zooming&&!l.zooming&&this.fire(new c.l("zoomstart",e)),this._rotating&&!l.rotating&&this.fire(new c.l("rotatestart",e)),this._pitching&&!l.pitching&&this.fire(new c.l("pitchstart",e)),this._rolling&&!l.rolling&&this.fire(new c.l("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this._elevationStart!==void 0&&this._elevationCenter!==void 0||this._prepareElevation(this.transform.center),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){const l=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(l-(a-(l*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.setElevation(c.C.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const a=e.getCameraLngLat(),l=e.getCameraAltitude(),d=this.terrain?this.terrain.getElevationForLngLatZoom(a,e.zoom):0;if(l<d){const g=this.calculateCameraOptionsFromTo(a,d,e.center,e.elevation);return{pitch:g.pitch,zoom:g.zoom}}return{}}_applyUpdatedTransform(e){const a=[];if(a.push((d=>this._elevateCameraIfInsideTerrain(d))),this.transformCameraUpdate&&a.push((d=>this.transformCameraUpdate(d))),!a.length)return;const l=e.clone();for(const d of a){const g=l.clone(),{center:_,zoom:S,roll:P,pitch:E,bearing:I,elevation:O}=d(g);_&&g.setCenter(_),O!==void 0&&g.setElevation(O),S!==void 0&&g.setZoom(S),P!==void 0&&g.setRoll(P),E!==void 0&&g.setPitch(E),I!==void 0&&g.setBearing(I),l.apply(g)}this.transform.apply(l)}_fireMoveEvents(e){this.fire(new c.l("move",e)),this._zooming&&this.fire(new c.l("zoom",e)),this._rotating&&this.fire(new c.l("rotate",e)),this._pitching&&this.fire(new c.l("pitch",e)),this._rolling&&this.fire(new c.l("roll",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;const l=this._zooming,d=this._rotating,g=this._pitching,_=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,l&&this.fire(new c.l("zoomend",e)),d&&this.fire(new c.l("rotateend",e)),g&&this.fire(new c.l("pitchend",e)),_&&this.fire(new c.l("rollend",e)),this.fire(new c.l("moveend",e))}flyTo(e,a){if(!e.essential&&ge.prefersReducedMotion){const je=c.Q(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(je,a)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.co},e);const l=this._getTransformForUpdate(),d=l.bearing,g=l.pitch,_=l.roll,S=l.padding,P="bearing"in e?this._normalizeBearing(e.bearing,d):d,E="pitch"in e?+e.pitch:g,I="roll"in e?this._normalizeBearing(e.roll,_):_,O="padding"in e?e.padding:l.padding,k=c.P.convert(e.offset);let N=l.centerPoint.add(k);const W=l.screenPointToLocation(N),J=this.cameraHelper.handleFlyTo(l,{bearing:P,pitch:E,roll:I,padding:O,locationAtOffset:W,offsetAsPoint:k,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let ee=e.curve;const te=Math.max(l.width,l.height),ie=te/J.scaleOfZoom,le=J.pixelPathLength;typeof J.scaleOfMinZoom=="number"&&(ee=Math.sqrt(te/J.scaleOfMinZoom/le*2));const ae=ee*ee;function ue(je){const pt=(ie*ie-te*te+(je?-1:1)*ae*ae*le*le)/(2*(je?ie:te)*ae*le);return Math.log(Math.sqrt(pt*pt+1)-pt)}function me(je){return(Math.exp(je)-Math.exp(-je))/2}function oe(je){return(Math.exp(je)+Math.exp(-je))/2}const Se=ue(!1);let Ue=function(je){return oe(Se)/oe(Se+ee*je)},Ie=function(je){return te*((oe(Se)*(me(pt=Se+ee*je)/oe(pt))-me(Se))/ae)/le;var pt},Oe=(ue(!0)-Se)/ee;if(Math.abs(le)<2e-6||!isFinite(Oe)){if(Math.abs(te-ie)<1e-6)return this.easeTo(e,a);const je=ie<te?-1:1;Oe=Math.abs(Math.log(ie/te))/ee,Ie=()=>0,Ue=pt=>Math.exp(je*ee*pt)}return e.duration="duration"in e?+e.duration:1e3*Oe/("screenSpeed"in e?+e.screenSpeed/ee:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=d!==P,this._pitching=E!==g,this._rolling=I!==_,this._padding=!l.isPaddingEqual(O),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(J.targetCenter),this._ease((je=>{const pt=je*Oe,ht=1/Ue(pt),Ke=Ie(pt);this._rotating&&l.setBearing(c.C.number(d,P,je)),this._pitching&&l.setPitch(c.C.number(g,E,je)),this._rolling&&l.setRoll(c.C.number(_,I,je)),this._padding&&(l.interpolatePadding(S,O,je),N=l.centerPoint.add(k)),J.easeFunc(je,ht,Ke,N),this.terrain&&!e.freezeElevation&&this._updateElevation(je),this._applyUpdatedTransform(l),this._fireMoveEvents(a)}),(()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)}),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var l;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const d=this._onEaseEnd;delete this._onEaseEnd,d.call(this,a)}return e||(l=this.handlers)===null||l===void 0||l.stop(!1),this}_ease(e,a,l){l.animate===!1||l.duration===0?(e(1),a()):(this._easeStart=ge.now(),this._easeOptions=l,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=c.aO(e,-180,180);const l=Math.abs(e-a);return Math.abs(e-360-a)<l&&(e-=360),Math.abs(e+360-a)<l&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.S.convert(e),this.transform.tileZoom):null}}const Fa={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class pn{constructor(e=Fa){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=ne.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ne.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ne.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){const l=this._map._getUIString(`AttributionControl.${a}`);e.title=l,e.setAttribute("aria-label",l)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map((d=>typeof d!="string"?"":d))):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const a=this._map.style.sourceCaches;for(const d in a){const g=a[d];if(g.used||g.usedForTerrain){const _=g.getSource();_.attribution&&e.indexOf(_.attribution)<0&&e.push(_.attribution)}}e=e.filter((d=>String(d).trim())),e.sort(((d,g)=>d.length-g.length)),e=e.filter(((d,g)=>{for(let _=g+1;_<e.length;_++)if(e[_].indexOf(d)>=0)return!1;return!0}));const l=e.join(" | ");l!==this._attribHTML&&(this._attribHTML=l,e.length?(this._innerContainer.innerHTML=ne.sanitize(l),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class kn{constructor(e={}){this._updateCompact=()=>{const a=this._container.children;if(a.length){const l=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&l.classList.add("maplibregl-compact"):l.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=ne.create("div","maplibregl-ctrl");const a=ne.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ne.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Dr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){const a=this._currentlyRunning,l=a?this._queue.concat(a):this._queue;for(const d of l)if(d.id===e)return void(d.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const a=this._currentlyRunning=this._queue;this._queue=[];for(const l of a)if(!l.cancelled&&(l.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var su=c.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class Ni extends c.E{constructor(e){super(),this._lastTilesetChange=ge.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];const l={};for(const d of Ce(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))l[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.terrainRttPosMatrix32f=new Float64Array(16),c.bY(d.terrainRttPosMatrix32f,0,c.$,c.$,0,0,1),this._tiles[d.key]=new Ri(d,this.tileSize),this._lastTilesetChange=ge.now());for(const d in this._tiles)l[d]||delete this._tiles[d]}freeRtt(e){for(const a in this._tiles){const l=this._tiles[a];(!e||l.tileID.equals(e)||l.tileID.isChildOf(e)||e.isChildOf(l.tileID))&&(l.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map((e=>this.getTileByID(e)))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e,a){return a?this._getTerrainCoordsForTileRanges(e,a):this._getTerrainCoordsForRegularTile(e)}_getTerrainCoordsForRegularTile(e){const a={};for(const l of this._renderableTilesKeys){const d=this._tiles[l].tileID,g=e.clone(),_=c.ba();if(d.canonical.equals(e.canonical))c.bY(_,0,c.$,c.$,0,0,1);else if(d.canonical.isChildOf(e.canonical)){const S=d.canonical.z-e.canonical.z,P=d.canonical.x-(d.canonical.x>>S<<S),E=d.canonical.y-(d.canonical.y>>S<<S),I=c.$>>S;c.bY(_,0,I,I,0,0,1),c.M(_,_,[-P*I,-E*I,0])}else{if(!e.canonical.isChildOf(d.canonical))continue;{const S=e.canonical.z-d.canonical.z,P=e.canonical.x-(e.canonical.x>>S<<S),E=e.canonical.y-(e.canonical.y>>S<<S),I=c.$>>S;c.bY(_,0,c.$,c.$,0,0,1),c.M(_,_,[P*I,E*I,0]),c.N(_,_,[1/2**S,1/2**S,0])}}g.terrainRttPosMatrix32f=new Float32Array(_),a[l]=g}return a}_getTerrainCoordsForTileRanges(e,a){const l={};for(const d of this._renderableTilesKeys){const g=this._tiles[d].tileID;if(!this._isWithinTileRanges(g,a))continue;const _=e.clone(),S=c.ba();if(g.canonical.z===e.canonical.z){const P=e.canonical.x-g.canonical.x,E=e.canonical.y-g.canonical.y;c.bY(S,0,c.$,c.$,0,0,1),c.M(S,S,[P*c.$,E*c.$,0])}else if(g.canonical.z>e.canonical.z){const P=g.canonical.z-e.canonical.z,E=g.canonical.x-(g.canonical.x>>P<<P),I=g.canonical.y-(g.canonical.y>>P<<P),O=e.canonical.x-(g.canonical.x>>P),k=e.canonical.y-(g.canonical.y>>P),N=c.$>>P;c.bY(S,0,N,N,0,0,1),c.M(S,S,[-E*N+O*c.$,-I*N+k*c.$,0])}else{const P=e.canonical.z-g.canonical.z,E=e.canonical.x-(e.canonical.x>>P<<P),I=e.canonical.y-(e.canonical.y>>P<<P),O=(e.canonical.x>>P)-g.canonical.x,k=(e.canonical.y>>P)-g.canonical.y,N=c.$<<P;c.bY(S,0,N,N,0,0,1),c.M(S,S,[E*c.$+O*N,I*c.$+k*N,0])}_.terrainRttPosMatrix32f=new Float32Array(S),l[d]=_}return l}getSourceTile(e,a){const l=this.sourceCache._source;let d=e.overscaledZ-this.deltaZoom;if(d>l.maxzoom&&(d=l.maxzoom),d<l.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(d).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!g||!g.dem)&&a)for(;d>=l.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(e.scaledTo(d--).key);return g}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}_isWithinTileRanges(e,a){return a[e.canonical.z]&&e.canonical.x>=a[e.canonical.z].minTileX&&e.canonical.x<=a[e.canonical.z].maxTileX&&e.canonical.y>=a[e.canonical.z].minTileY&&e.canonical.y<=a[e.canonical.z].maxTileY}}class ao{constructor(e,a,l){this._meshCache={},this.painter=e,this.sourceCache=new Ni(a),this.options=l,this.exaggeration=typeof l.exaggeration=="number"?l.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,l,d=c.$){var g;if(!(a>=0&&a<d&&l>=0&&l<d))return 0;const _=this.getTerrainData(e),S=(g=_.tile)===null||g===void 0?void 0:g.dem;if(!S)return 0;const P=c.cs([],[a/d*c.$,l/d*c.$],_.u_terrain_matrix),E=[P[0]*S.dim,P[1]*S.dim],I=Math.floor(E[0]),O=Math.floor(E[1]),k=E[0]-I,N=E[1]-O;return S.get(I,O)*(1-k)*(1-N)+S.get(I+1,O)*k*(1-N)+S.get(I,O+1)*(1-k)*N+S.get(I+1,O+1)*k*N}getElevationForLngLatZoom(e,a){if(!c.ct(a,e.wrap()))return 0;const{tileID:l,mercatorX:d,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(l,d%c.$,g%c.$,c.$)}getElevation(e,a,l,d=c.$){return this.getDEMElevation(e,a,l,d)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const d=this.painter.context,g=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new c.T(d,g,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new c.T(d,new c.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.ag([])}const a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){const d=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new c.T(d,a.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),a.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}const l=a&&a+a.tileID.key+e.key;if(l&&!this._demMatrixCache[l]){const d=this.sourceCache.sourceCache._source.maxzoom;let g=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=d?g=e.canonical.z-d:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const _=e.canonical.x-(e.canonical.x>>g<<g),S=e.canonical.y-(e.canonical.y>>g<<g),P=c.cu(new Float64Array(16),[1/(c.$<<g),1/(c.$<<g),0]);c.M(P,P,[_*c.$,S*c.$,0]),this._demMatrixCache[e.key]={matrix:P,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:l?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){const a=this.painter,l=a.width/devicePixelRatio,d=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===l&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new c.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new c.T(a.context,{width:l,height:d,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(l,d,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,l,d))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,_=0;g<this._coordsTextureSize;g++)for(let S=0;S<this._coordsTextureSize;S++,_+=4)a[_+0]=255&S,a[_+1]=255&g,a[_+2]=S>>8<<4|g>>8,a[_+3]=0;const l=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),d=new c.T(e,l,e.gl.RGBA,{premultiply:!1});return d.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const a=new Uint8Array(4),l=this.painter.context,d=l.gl,g=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),_=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),S=Math.round(this.painter.height/devicePixelRatio);l.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(g,S-_-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null);const P=a[0]+(a[2]>>4<<8),E=a[1]+((15&a[2])<<8),I=this.coordsIndex[255-a[3]],O=I&&this.sourceCache.getTileByID(I);if(!O)return null;const k=this._coordsTextureSize,N=(1<<O.tileID.canonical.z)*k;return new c.a1((O.tileID.canonical.x*k+P)/N+O.tileID.wrap,(O.tileID.canonical.y*k+E)/N,this.getElevation(O.tileID,P,E,k))}depthAtPoint(e){const a=new Uint8Array(4),l=this.painter.context,d=l.gl;return l.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),d.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,a),l.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(e){var a;const l=((a=this.painter.style.projection)===null||a===void 0?void 0:a.transitionState)>0,d=l&&e.canonical.y===0,g=l&&e.canonical.y===(1<<e.canonical.z)-1,_=`m_${d?"n":""}_${g?"s":""}`;if(this._meshCache[_])return this._meshCache[_];const S=this.painter.context,P=new c.cv,E=new c.aN,I=this.meshSize,O=c.$/I,k=I*I;for(let oe=0;oe<=I;oe++)for(let Se=0;Se<=I;Se++)P.emplaceBack(Se*O,oe*O,0);for(let oe=0;oe<k;oe+=I+1)for(let Se=0;Se<I;Se++)E.emplaceBack(Se+oe,I+Se+oe+1,I+Se+oe+2),E.emplaceBack(Se+oe,I+Se+oe+2,Se+oe+1);const N=P.length,W=N+(I+1),J=(I+1)*I,ee=d?c.bh:0,te=d?0:1,ie=g?c.bi:c.$,le=g?0:1;for(let oe=0;oe<=I;oe++)P.emplaceBack(oe*O,ee,te);for(let oe=0;oe<=I;oe++)P.emplaceBack(oe*O,ie,le);for(let oe=0;oe<I;oe++)E.emplaceBack(J+oe,W+oe,W+oe+1),E.emplaceBack(J+oe,W+oe+1,J+oe+1),E.emplaceBack(0+oe,N+oe+1,N+oe),E.emplaceBack(0+oe,0+oe+1,N+oe+1);const ae=P.length,ue=ae+2*(I+1);for(const oe of[0,1])for(let Se=0;Se<=I;Se++)for(const Ue of[0,1])P.emplaceBack(oe*c.$,Se*O,Ue);for(let oe=0;oe<2*I;oe+=2)E.emplaceBack(ae+oe,ae+oe+1,ae+oe+3),E.emplaceBack(ae+oe,ae+oe+3,ae+oe+2),E.emplaceBack(ue+oe,ue+oe+3,ue+oe+1),E.emplaceBack(ue+oe,ue+oe+2,ue+oe+3);const me=new jo(S.createVertexBuffer(P,su.members),S.createIndexBuffer(E),c.aM.simpleSegment(0,0,P.length,E.length));return this._meshCache[_]=me,me}getMeshFrameDelta(e){return 2*Math.PI*c.bu/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,a){var l;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(l=this.getMinMaxElevation(d).minElevation)!==null&&l!==void 0?l:0}getMinMaxElevation(e){const a=this.getTerrainData(e).tile,l={minElevation:null,maxElevation:null};return a&&a.dem&&(l.minElevation=a.dem.min*this.exaggeration,l.maxElevation=a.dem.max*this.exaggeration),l}_getOverscaledTileIDFromLngLatZoom(e,a){const l=c.a1.fromLngLat(e.wrap()),d=(1<<a)*c.$,g=l.x*d,_=l.y*d,S=Math.floor(g/c.$),P=Math.floor(_/c.$);return{tileID:new c.Z(a,0,a,S,P),mercatorX:g,mercatorY:_}}}class Ct{constructor(e,a,l){this._context=e,this._size=a,this._tileSize=l,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),l=new c.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return l.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(l.texture),{id:e,fbo:a,texture:l,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter((a=>e.id!==a)),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some((e=>!e.inUse))===!1}}const zt={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class Eo{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new Ct(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter((l=>!e._layers[l].isHidden(a))),this._coordsAscending={};for(const l in e.sourceCaches){this._coordsAscending[l]={};const d=e.sourceCaches[l].getVisibleCoordinates(),g=e.sourceCaches[l].getSource(),_=g instanceof Br?g.terrainTileRanges:null;for(const S of d){const P=this.terrain.sourceCache.getTerrainCoords(S,_);for(const E in P)this._coordsAscending[l][E]||(this._coordsAscending[l][E]=[]),this._coordsAscending[l][E].push(P[E])}}this._coordsAscendingStr={};for(const l of e._order){const d=e._layers[l],g=d.source;if(zt[d.type]&&!this._coordsAscendingStr[g]){this._coordsAscendingStr[g]={};for(const _ in this._coordsAscending[g])this._coordsAscendingStr[g][_]=this._coordsAscending[g][_].map((S=>S.key)).sort().join()}}for(const l of this._renderableTiles)for(const d in this._coordsAscendingStr){const g=this._coordsAscendingStr[d][l.tileID.key];g&&g!==l.rttCoords[d]&&(l.rtt=[])}}renderLayer(e,a){if(e.isHidden(this.painter.transform.zoom))return!1;const l=Object.assign(Object.assign({},a),{isRenderingToTexture:!0}),d=e.type,g=this.painter,_=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(zt[d]&&(this._prevType&&zt[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(e.id),!_))return!0;if(zt[this._prevType]||zt[d]&&_){this._prevType=d;const S=this._stacks.length-1,P=this._stacks[S]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(Yi(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[S]){const O=this.pool.getObjectForId(E.rtt[S].id);if(O.stamp===E.rtt[S].stamp){this.pool.useObject(O);continue}}const I=this.pool.getOrCreateFreeObject();this.pool.useObject(I),this.pool.stampObject(I),E.rtt[S]={id:I.id,stamp:I.stamp},g.context.bindFramebuffer.set(I.fbo.framebuffer),g.context.clear({color:c.bf.transparent,stencil:0}),g.currentStencilSource=void 0;for(let O=0;O<P.length;O++){const k=g.style._layers[P[O]],N=k.source?this._coordsAscending[k.source][E.tileID.key]:[E.tileID];g.context.viewport.set([0,0,I.fbo.width,I.fbo.height]),g._renderTileClippingMasks(k,N,!0),g.renderLayer(g,g.style.sourceCaches[k.source],k,N,l),k.source&&(E.rttCoords[k.source]=this._coordsAscendingStr[k.source][E.tileID.key])}}return Yi(this.painter,this.terrain,this._rttTiles,l),this._rttTiles=[],this.pool.freeAllObjects(),zt[d]}return!1}}const th={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},fr=H,ei={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Fa,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},lu={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class ba{constructor(e,a,l=!1){this.mousedown=g=>{this.startMove(g,ne.mousePos(this.element,g)),ne.addEventListener(window,"mousemove",this.mousemove),ne.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=g=>{this.move(g,ne.mousePos(this.element,g))},this.mouseup=g=>{this._rotatePitchHandler.dragEnd(g),this.offTemp()},this.touchstart=g=>{g.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ne.touchPos(this.element,g.targetTouches)[0],this.startMove(g,this._startPos),ne.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.addEventListener(window,"touchend",this.touchend))},this.touchmove=g=>{g.targetTouches.length!==1?this.reset():(this._lastPos=ne.touchPos(this.element,g.targetTouches)[0],this.move(g,this._lastPos))},this.touchend=g=>{g.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=a;const d=new eu;this._rotatePitchHandler=new Bi({clickTolerance:3,move:(g,_)=>{const S=a.getBoundingClientRect(),P=new c.P((S.bottom-S.top)/2,(S.right-S.left)/2);return{bearingDelta:c.cn(new c.P(g.x,_.y),_,P),pitchDelta:l?-.5*(_.y-g.y):void 0}},moveStateManager:d,enable:!0,assignEvents:()=>{}}),this.map=e,ne.addEventListener(a,"mousedown",this.mousedown),ne.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),ne.addEventListener(a,"touchcancel",this.reset)}startMove(e,a){this._rotatePitchHandler.dragStart(e,a),ne.disableDrag()}move(e,a){const l=this.map,{bearingDelta:d,pitchDelta:g}=this._rotatePitchHandler.dragMove(e,a)||{};d&&l.setBearing(l.getBearing()+d),g&&l.setPitch(l.getPitch()+g)}off(){const e=this.element;ne.removeEventListener(e,"mousedown",this.mousedown),ne.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend),ne.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){ne.enableDrag(),ne.removeEventListener(window,"mousemove",this.mousemove),ne.removeEventListener(window,"mouseup",this.mouseup),ne.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ne.removeEventListener(window,"touchend",this.touchend)}}let rs;function El(f,e,a,l=!1){if(l||!a.getCoveringTilesDetailsProvider().allowWorldCopies())return f?.wrap();const d=new c.S(f.lng,f.lat);if(f=new c.S(f.lng,f.lat),e){const g=new c.S(f.lng-360,f.lat),_=new c.S(f.lng+360,f.lat),S=a.locationToScreenPoint(f).distSqr(e);a.locationToScreenPoint(g).distSqr(e)<S?f=g:a.locationToScreenPoint(_).distSqr(e)<S&&(f=_)}for(;Math.abs(f.lng-a.center.lng)>180;){const g=a.locationToScreenPoint(f);if(g.x>=0&&g.y>=0&&g.x<=a.width&&g.y<=a.height)break;f.lng>a.center.lng?f.lng-=360:f.lng+=360}return f.lng!==d.lng&&a.isPointOnMapSurface(a.locationToScreenPoint(f))?f:d}const Wn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function pr(f,e,a){const l=f.classList;for(const d in Wn)l.remove(`maplibregl-${a}-anchor-${d}`);l.add(`maplibregl-${a}-anchor-${e}`)}class Ml extends c.E{constructor(e){if(super(),this._onKeyPress=a=>{const l=a.code,d=a.charCode||a.keyCode;l!=="Space"&&l!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=a=>{const l=a.originalEvent.target,d=this._element;this._popup&&(l===d||d.contains(l))&&this.togglePopup()},this._update=a=>{if(!this._map)return;const l=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!l)&&this._map.once("render",this._update),this._lngLat=El(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),ne.setTransform(this._element,`${Wn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${d}`),ge.frameAsync(new AbortController).then((()=>{this._updateOpacity(a&&a.type==="moveend")})).catch((()=>{}))},this._onMove=a=>{if(!this._isDragging){const l=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.l("dragstart"))),this.fire(new c.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.l("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=ne.create("div");const a=ne.createNS("http://www.w3.org/2000/svg","svg"),l=41,d=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${l}px`),a.setAttributeNS(null,"width",`${d}px`),a.setAttributeNS(null,"viewBox",`0 0 ${d} ${l}`);const g=ne.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const _=ne.createNS("http://www.w3.org/2000/svg","g");_.setAttributeNS(null,"fill-rule","nonzero");const S=ne.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const te of P){const ie=ne.createNS("http://www.w3.org/2000/svg","ellipse");ie.setAttributeNS(null,"opacity","0.04"),ie.setAttributeNS(null,"cx","10.5"),ie.setAttributeNS(null,"cy","5.80029008"),ie.setAttributeNS(null,"rx",te.rx),ie.setAttributeNS(null,"ry",te.ry),S.appendChild(ie)}const E=ne.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const I=ne.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(I);const O=ne.createNS("http://www.w3.org/2000/svg","g");O.setAttributeNS(null,"opacity","0.25"),O.setAttributeNS(null,"fill","#000000");const k=ne.createNS("http://www.w3.org/2000/svg","path");k.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),O.appendChild(k);const N=ne.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"transform","translate(6.0, 7.0)"),N.setAttributeNS(null,"fill","#FFFFFF");const W=ne.createNS("http://www.w3.org/2000/svg","g");W.setAttributeNS(null,"transform","translate(8.0, 8.0)");const J=ne.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#000000"),J.setAttributeNS(null,"opacity","0.25"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962");const ee=ne.createNS("http://www.w3.org/2000/svg","circle");ee.setAttributeNS(null,"fill","#FFFFFF"),ee.setAttributeNS(null,"cx","5.5"),ee.setAttributeNS(null,"cy","5.5"),ee.setAttributeNS(null,"r","5.4999962"),W.appendChild(J),W.appendChild(ee),_.appendChild(S),_.appendChild(E),_.appendChild(O),_.appendChild(N),_.appendChild(W),a.appendChild(_),a.setAttributeNS(null,"height",l*this._scale+"px"),a.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(a),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",(a=>{a.preventDefault()})),this._element.addEventListener("mousedown",(a=>{a.preventDefault()})),pr(this._element,this._anchor,"marker"),e&&e.className)for(const a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ne.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.S.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const d=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,l;const d=(a=this._map)===null||a===void 0?void 0:a.terrain,g=this._map.transform.isLocationOccluded(this._lngLat);if(!d||g){const N=g?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==N&&(this._element.style.opacity=N))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout((()=>{this._opacityTimeout=null}),100)}const _=this._map,S=_.terrain.depthAtPoint(this._pos),P=_.terrain.getElevationForLngLatZoom(this._lngLat,_.transform.tileZoom);if(_.transform.lngLatToCameraDepth(this._lngLat,P)-S<.006)return void(this._element.style.opacity=this._opacity);const E=-this._offset.y/_.transform.pixelsPerMeter,I=Math.sin(_.getPitch()*Math.PI/180)*E,O=_.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),k=_.transform.lngLatToCameraDepth(this._lngLat,P+I)-O>.006;!((l=this._popup)===null||l===void 0)&&l.isOpen()&&k&&this._popup.remove(),this._element.style.opacity=k?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return(this._opacity===void 0||e===void 0&&a===void 0)&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}const ti={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let ir=0,Mo=!1;const zs={maxWidth:100,unit:"metric"};function Ls(f,e,a){const l=a&&a.maxWidth||100,d=f._container.clientHeight/2,g=f._container.clientWidth/2,_=f.unproject([g-l/2,d]),S=f.unproject([g+l/2,d]),P=Math.round(f.project(S).x-f.project(_).x),E=Math.min(l,P,f._container.clientWidth),I=_.distanceTo(S);if(a&&a.unit==="imperial"){const O=3.2808*I;O>5280?Na(e,E,O/5280,f._getUIString("ScaleControl.Miles")):Na(e,E,O,f._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?Na(e,E,I/1852,f._getUIString("ScaleControl.NauticalMiles")):I>=1e3?Na(e,E,I/1e3,f._getUIString("ScaleControl.Kilometers")):Na(e,E,I,f._getUIString("ScaleControl.Meters"))}function Na(f,e,a,l){const d=(function(g){const _=Math.pow(10,`${Math.floor(g)}`.length-1);let S=g/_;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:(function(P){const E=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*E)/E})(S),_*S})(a);f.style.width=e*(d/a)+"px",f.innerHTML=`${d}&nbsp;${l}`}const Ua={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Rl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Dl(f){if(f){if(typeof f=="number"){const e=Math.round(Math.abs(f)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,f),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-f),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(f,0),right:new c.P(-f,0)}}if(f instanceof c.P||Array.isArray(f)){const e=c.P.convert(f);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(f.center||[0,0]),top:c.P.convert(f.top||[0,0]),"top-left":c.P.convert(f["top-left"]||[0,0]),"top-right":c.P.convert(f["top-right"]||[0,0]),bottom:c.P.convert(f.bottom||[0,0]),"bottom-left":c.P.convert(f["bottom-left"]||[0,0]),"bottom-right":c.P.convert(f["bottom-right"]||[0,0]),left:c.P.convert(f.left||[0,0]),right:c.P.convert(f.right||[0,0])}}return Dl(new c.P(0,0))}const wc=H;A.AJAXError=c.cz,A.Event=c.l,A.Evented=c.E,A.LngLat=c.S,A.MercatorCoordinate=c.a1,A.Point=c.P,A.addProtocol=c.cA,A.config=c.a,A.removeProtocol=c.cB,A.AttributionControl=pn,A.BoxZoomHandler=Es,A.CanvasSource=oi,A.CooperativeGesturesHandler=Ju,A.DoubleClickZoomHandler=Cl,A.DragPanHandler=Is,A.DragRotateHandler=Tl,A.EdgeInsets=yo,A.FullscreenControl=class extends c.E{constructor(f={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ne.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=ne.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ne.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},A.GeoJSONSource=Kr,A.GeolocateControl=class extends c.E{constructor(f){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.l("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.l("geolocate",e)),this._finish()}},this._updateCamera=e=>{const a=new c.S(e.coords.longitude,e.coords.latitude),l=e.coords.accuracy,d=this._map.getBearing(),g=c.e({bearing:d},this.options.fitBoundsOptions),_=qt.fromLngLat(a,l);this._map.fitBounds(_,g,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const a=new c.S(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this._updateCircleRadiusIfNeeded()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onUpdate=()=>{this._updateCircleRadiusIfNeeded()},this._onError=e=>{if(this._map){if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Mo)return;this.options.trackUserLocation&&this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.l("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=ne.create("button","maplibregl-ctrl-geolocate",this._container),ne.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ne.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ml({element:this._dotElement}),this._circleElement=ne.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ml({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onUpdate),this._map.on("move",this._onUpdate),this._map.on("rotate",this._onUpdate),this._map.on("pitch",this._onUpdate)),this._geolocateButton.addEventListener("click",(()=>this.trigger())),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(a=>{const l=a?.[0]instanceof ResizeObserverEntry;a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||l||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.l("trackuserlocationend")),this.fire(new c.l("userlocationlostfocus")))}))}},this.options=c.e({},ti,f)}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),(function(){return c._(this,arguments,void 0,(function*(e=!1){if(rs!==void 0&&!e)return rs;if(window.navigator.permissions===void 0)return rs=!!window.navigator.geolocation,rs;try{rs=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{rs=!!window.navigator.geolocation}return rs}))})().then((e=>this._finishSetupUI(e))),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ne.remove(this._container),this._map.off("zoom",this._onUpdate),this._map.off("move",this._onUpdate),this._map.off("rotate",this._onUpdate),this._map.off("pitch",this._onUpdate),this._map=void 0,ir=0,Mo=!1}_isOutOfMapMaxBounds(f){const e=this._map.getMaxBounds(),a=f.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadiusIfNeeded(){const f=this._userLocationDotMarker.getLngLat();if(!(this.options.showUserLocation&&this.options.showAccuracyCircle&&this._accuracy&&f))return;const e=this._map.project(f),a=this._map.unproject([e.x+100,e.y]),l=f.distanceTo(a)/100,d=2*this._accuracy/l;this._circleElement.style.width=`${d.toFixed(2)}px`,this._circleElement.style.height=`${d.toFixed(2)}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ir--,Mo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.l("trackuserlocationstart")),this.fire(new c.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ir++,ir>1?(f={maximumAge:6e5,timeout:0},Mo=!0):(f=this.options.positionOptions,Mo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},A.GlobeControl=class{constructor(){this._toggleProjection=()=>{var f;const e=(f=this._map.getProjection())===null||f===void 0?void 0:f.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var f;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((f=this._map.getProjection())===null||f===void 0?void 0:f.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=ne.create("button","maplibregl-ctrl-globe",this._container),ne.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},A.Hash=ki,A.ImageSource=Br,A.KeyboardHandler=en,A.LngLatBounds=qt,A.LogoControl=kn,A.Map=class extends Al{constructor(f){var e,a;c.cw.mark(c.cx.create);const l=Object.assign(Object.assign(Object.assign({},ei),f),{canvasContextAttributes:Object.assign(Object.assign({},ei.canvasContextAttributes),f.canvasContextAttributes)});if(l.minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const d=new Rn,g=new vr;if(l.minZoom!==void 0&&d.setMinZoom(l.minZoom),l.maxZoom!==void 0&&d.setMaxZoom(l.maxZoom),l.minPitch!==void 0&&d.setMinPitch(l.minPitch),l.maxPitch!==void 0&&d.setMaxPitch(l.maxPitch),l.renderWorldCopies!==void 0&&d.setRenderWorldCopies(l.renderWorldCopies),super(d,g,{bearingSnap:l.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Dr,this._controls=[],this._mapId=c.a7(),this._contextLost=S=>{S.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.l("webglcontextlost",{originalEvent:S}))},this._contextRestored=S=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.l("webglcontextrestored",{originalEvent:S}))},this._onMapScroll=S=>{if(S.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._maxTileCacheZoomLevels=l.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},l.canvasContextAttributes),this._trackResize=l.trackResize===!0,this._bearingSnap=l.bearingSnap,this._centerClampedToGround=l.centerClampedToGround,this._refreshExpiredTiles=l.refreshExpiredTiles===!0,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions===!0,this._collectResourceTiming=l.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},th),l.locale),this._clickTolerance=l.clickTolerance,this._overridePixelRatio=l.pixelRatio,this._maxCanvasSize=l.maxCanvasSize,this.transformCameraUpdate=l.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=l.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=it.addThrottleControl((()=>this.isMoving())),this._requestManager=new at(l.transformRequest),typeof l.container=="string"){if(this._container=document.getElementById(l.container),!this._container)throw new Error(`Container '${l.container}' not found.`)}else{if(!(l.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this.on("terrain",(()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)})),this.once("idle",(()=>{this._idleTriggered=!0})),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let S=!1;const P=Po((E=>{this._trackResize&&!this._removed&&(this.resize(E),this.redraw())}),50);this._resizeObserver=new ResizeObserver((E=>{S?P(E):S=!0})),this._resizeObserver.observe(this._container)}this.handlers=new eh(this,l),this._hash=l.hash&&new ki(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,elevation:l.elevation,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch,roll:l.roll}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,c.e({},l.fitBoundsOptions,{duration:0}))));const _=typeof l.style=="string"||((a=(e=l.style)===null||e===void 0?void 0:e.projection)===null||a===void 0?void 0:a.type)!=="globe";this.resize(null,_),this._localIdeographFontFamily=l.localIdeographFontFamily,this._validateStyle=l.validateStyle,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new pn(typeof l.attributionControl=="boolean"?void 0:l.attributionControl)),l.maplibreLogo&&this.addControl(new kn,l.logoPosition),this.on("style.load",(()=>{if(_||this._resizeTransform(),this.transform.unmodified){const S=c.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(S)}})),this.on("data",(S=>{this._update(S.dataType==="style"),this.fire(new c.l(`${S.dataType}data`,S))})),this.on("dataloading",(S=>{this.fire(new c.l(`${S.dataType}dataloading`,S))})),this.on("dataabort",(S=>{this.fire(new c.l("sourcedataabort",S))}))}_getMapId(){return this._mapId}setGlobalStateProperty(f,e){return this.style.setGlobalStateProperty(f,e),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(f,e){if(e===void 0&&(e=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new c.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=f.onAdd(this);this._controls.push(f);const l=this._controlPositions[e];return e.indexOf("bottom")!==-1?l.insertBefore(a,l.firstChild):l.appendChild(a),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new c.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(f);return e>-1&&this._controls.splice(e,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}coveringTiles(f){return Ce(this.transform,f)}calculateCameraOptionsFromTo(f,e,a,l){return l==null&&this.terrain&&(l=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,e,a,l)}resize(f,e=!0){const[a,l]=this._containerDimensions(),d=this._getClampedPixelRatio(a,l);if(this._resizeCanvas(a,l,d),this.painter.resize(a,l,d),this.painter.overLimit()){const _=this.painter.context.gl;this._maxCanvasSize=[_.drawingBufferWidth,_.drawingBufferHeight];const S=this._getClampedPixelRatio(a,l);this._resizeCanvas(a,l,S),this.painter.resize(a,l,S)}this._resizeTransform(e);const g=!this._moving;return g&&(this.stop(),this.fire(new c.l("movestart",f)).fire(new c.l("move",f))),this.fire(new c.l("resize",f)),g&&this.fire(new c.l("moveend",f)),this}_resizeTransform(f=!0){var e;const[a,l]=this._containerDimensions();this.transform.resize(a,l,f),(e=this._requestedCameraState)===null||e===void 0||e.resize(a,l,f)}_getClampedPixelRatio(f,e){const{0:a,1:l}=this._maxCanvasSize,d=this.getPixelRatio(),g=f*d,_=e*d;return Math.min(g>a?a/g:1,_>l?l/_:1)*d}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(qt.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.setMinZoom(f),this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.setMaxZoom(f),this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.setMinPitch(f),this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(f>=this.transform.minPitch)return this.transform.setMaxPitch(f),this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.setRenderWorldCopies(f),this._update()}project(f){return this.transform.locationToScreenPoint(c.S.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.screenPointToLocation(c.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,e,a){if(f==="mouseenter"||f==="mouseover"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:g=>{const _=e.filter((P=>this.getLayer(P))),S=_.length!==0?this.queryRenderedFeatures(g.point,{layers:_}):[];S.length?l||(l=!0,a.call(this,new Oi(f,this,g.originalEvent,{features:S}))):l=!1},mouseout:()=>{l=!1}}}}if(f==="mouseleave"||f==="mouseout"){let l=!1;return{layers:e,listener:a,delegates:{mousemove:_=>{const S=e.filter((P=>this.getLayer(P)));(S.length!==0?this.queryRenderedFeatures(_.point,{layers:S}):[]).length?l=!0:l&&(l=!1,a.call(this,new Oi(f,this,_.originalEvent)))},mouseout:_=>{l&&(l=!1,a.call(this,new Oi(f,this,_.originalEvent)))}}}}{const l=d=>{const g=e.filter((S=>this.getLayer(S))),_=g.length!==0?this.queryRenderedFeatures(d.point,{layers:g}):[];_.length&&(d.features=_,a.call(this,d),delete d.features)};return{layers:e,listener:a,delegates:{[f]:l}}}}_saveDelegatedListener(f,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(e)}_removeDelegatedListener(f,e,a){if(!this._delegatedListeners||!this._delegatedListeners[f])return;const l=this._delegatedListeners[f];for(let d=0;d<l.length;d++){const g=l[d];if(g.listener===a&&g.layers.length===e.length&&g.layers.every((_=>e.includes(_)))){for(const _ in g.delegates)this.off(_,g.delegates[_]);return void l.splice(d,1)}}}on(f,e,a){if(a===void 0)return super.on(f,e);const l=typeof e=="string"?[e]:e,d=this._createDelegatedListener(f,l,a);this._saveDelegatedListener(f,d);for(const g in d.delegates)this.on(g,d.delegates[g]);return{unsubscribe:()=>{this._removeDelegatedListener(f,l,a)}}}once(f,e,a){if(a===void 0)return super.once(f,e);const l=typeof e=="string"?[e]:e,d=this._createDelegatedListener(f,l,a);for(const g in d.delegates){const _=d.delegates[g];d.delegates[g]=(...S)=>{this._removeDelegatedListener(f,l,a),_(...S)}}this._saveDelegatedListener(f,d);for(const g in d.delegates)this.once(g,d.delegates[g]);return this}off(f,e,a){return a===void 0?super.off(f,e):(this._removeDelegatedListener(f,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(f,e){if(!this.style)return[];let a;const l=f instanceof c.P||Array.isArray(f),d=l?f:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(l?{}:f)||{},d instanceof c.P||typeof d[0]=="number")a=[c.P.convert(d)];else{const g=c.P.convert(d[0]),_=c.P.convert(d[1]);a=[g,new c.P(_.x,g.y),_,new c.P(g.x,_.y),g]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(f,e){return this.style.querySourceFeatures(f,e)}setStyle(f,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(f,e))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const e=this._locale[f];if(e==null)throw new Error(`Missing UI string '${f}'`);return e}_updateStyle(f,e){var a,l;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",(()=>this._updateStyle(f,e)));const d=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Bu(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,e,d):this.style.loadJSON(f,e,d),this):((l=(a=this.style)===null||a===void 0?void 0:a.projection)===null||l===void 0||l.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Bu(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,e){if(typeof f=="string"){const a=this._requestManager.transformRequest(f,"Style");c.j(a,new AbortController).then((l=>{this._updateDiff(l.data,e)})).catch((l=>{l&&this.fire(new c.k(l))}))}else typeof f=="object"&&this._updateDiff(f,e)}_updateDiff(f,e){try{this.style.setState(f,e)&&this._update(!0)}catch(a){c.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(f,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(f,e){return this._lazyInitEmptyStyle(),this.style.addSource(f,e),this._update(!0)}isSourceLoaded(f){const e=this.style&&this.style.sourceCaches[f];if(e!==void 0)return e.loaded();this.fire(new c.k(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const e=this.style.sourceCaches[f.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);this.terrain===null&&e.reload();for(const a in this.style._layers){const l=this.style._layers[a];l.type==="hillshade"&&l.source===f.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),l.type==="color-relief"&&l.source===f.source&&c.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ao(this.painter,e,f),this.painter.renderToTexture=new Eo(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=a=>{var l;a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==f.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),((l=a.source)===null||l===void 0?void 0:l.type)==="image"?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.l("terrain",{terrain:f})),this}getTerrain(){var f,e;return(e=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const e in f){const a=f[e]._tiles;for(const l in a){const d=a[l];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}setSourceTileLodParams(f,e,a){if(a){const l=this.getSource(a);if(!l)throw new Error(`There is no source with ID "${a}", cannot set LOD parameters`);l.calculateTileZoom=nt(Math.max(1,f),Math.max(1,e))}else for(const l in this.style.sourceCaches)this.style.sourceCaches[l].getSource().calculateTileZoom=nt(Math.max(1,f),Math.max(1,e));return this._update(!0),this}refreshTiles(f,e){const a=this.style.sourceCaches[f];if(!a)throw new Error(`There is no source cache with ID "${f}", cannot refresh tile`);e===void 0?a.reload(!0):a.refreshTiles(e.map((l=>new c.a4(l.z,l.x,l.y))))}addImage(f,e,a={}){const{pixelRatio:l=1,sdf:d=!1,stretchX:g,stretchY:_,content:S,textFitWidth:P,textFitHeight:E}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:I,height:O,data:k}=e,N=e;return this.style.addImage(f,{data:new c.R({width:I,height:O},new Uint8Array(k)),pixelRatio:l,stretchX:g,stretchY:_,content:S,textFitWidth:P,textFitHeight:E,sdf:d,version:0,userImage:N}),N.onAdd&&N.onAdd(this,f),this}}{const{width:I,height:O,data:k}=ge.getImageData(e);this.style.addImage(f,{data:new c.R({width:I,height:O},k),pixelRatio:l,stretchX:g,stretchY:_,content:S,textFitWidth:P,textFitHeight:E,sdf:d,version:0})}}updateImage(f,e){const a=this.style.getImage(f);if(!a)return this.fire(new c.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const l=e instanceof HTMLImageElement||c.b(e)?ge.getImageData(e):e,{width:d,height:g,data:_}=l;if(d===void 0||g===void 0)return this.fire(new c.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==a.data.width||g!==a.data.height)return this.fire(new c.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const S=!(e instanceof HTMLImageElement||c.b(e));return a.data.replace(_,S),this.style.updateImage(f,a),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new c.k(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f){return it.getImage(this._requestManager.transformRequest(f,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(f,e){return this._lazyInitEmptyStyle(),this.style.addLayer(f,e),this._update(!0)}moveLayer(f,e){return this.style.moveLayer(f,e),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,e,a){return this.style.setLayerZoomRange(f,e,a),this._update(!0)}setFilter(f,e,a={}){return this.style.setFilter(f,e,a),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,e,a,l={}){return this.style.setPaintProperty(f,e,a,l),this._update(!0)}getPaintProperty(f,e){return this.style.getPaintProperty(f,e)}setLayoutProperty(f,e,a,l={}){return this.style.setLayoutProperty(f,e,a,l),this._update(!0)}getLayoutProperty(f,e){return this.style.getLayoutProperty(f,e)}setGlyphs(f,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,e,a,(l=>{l||this._update(!0)})),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,e,(a=>{a||this._update(!0)})),this}setLight(f,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(f,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(f,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(f,e){return this.style.setFeatureState(f,e),this._update()}removeFeatureState(f,e){return this.style.removeFeatureState(f,e),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,e=0;return this._container&&(f=this._container.clientWidth||400,e=this._container.clientHeight||300),[f,e]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const e=this._canvasContainer=ne.create("div","maplibregl-canvas-container",f);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=ne.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const a=this._containerDimensions(),l=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],l);const d=this._controlContainer=ne.create("div","maplibregl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((_=>{g[_]=ne.create("div",`maplibregl-ctrl-${_} `,d)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,e,a){this._canvas.width=Math.floor(a*f),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const f=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",(l=>{e={requestedAttributes:f},l&&(e.statusMessage=l.statusMessage,e.type=l.type)}),{once:!0});let a=null;if(a=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,f):this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f),!a){const l="Failed to initialize WebGL";throw e?(e.message=l,new Error(JSON.stringify(e))):new Error(l)}this.painter=new xl(a,this.transform),Re.testSupport(a)}migrateProjection(f,e){super.migrateProjection(f,e),this.painter.transform=f,this.fire(new c.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){var e,a,l,d,g;const _=this._idleTriggered?this._fadeDuration:0,S=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,k=ge.now();this.style.zoomHistory.update(O,k);const N=new c.F(O,{now:k,fadeDuration:_,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),W=N.crossFadingFactor();W===1&&W===this._crossFadingFactor||(P=!0,this._crossFadingFactor=W),this.style.update(N)}const E=((a=this.style.projection)===null||a===void 0?void 0:a.transitionState)>0!==S;(l=this.style.projection)===null||l===void 0||l.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((d=this.style.projection)===null||d===void 0?void 0:d.transitionState,(g=this.style.projection)===null||g===void 0?void 0:g.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||E)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,_,this._crossSourceCollisions,E),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:_,showPadding:this.showPadding}),this.fire(new c.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cw.mark(c.cx.load),this.fire(new c.l("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const I=this._sourcesDirty||this._styleDirty||this._placementDirty;return I||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.l("idle")),!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,c.cw.mark(c.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),it.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ne.remove(this._canvasContainer),ne.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cw.clearMetrics(),this._removed=!0,this.fire(new c.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,ge.frame(this._frameRequest,(f=>{c.cw.frame(f),this._frameRequest=null;try{this._render(f)}catch(e){if(!c.cy(e)&&!(function(a){return a.message===pc})(e))throw e}}),(()=>{})))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return fr}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(f){return this._lazyInitEmptyStyle(),this.style.setProjection(f),this._update(!0)}},A.MapMouseEvent=Oi,A.MapTouchEvent=wl,A.MapWheelEvent=Yu,A.Marker=Ml,A.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const e=this._map.getZoom(),a=e===this._map.getMaxZoom(),l=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=l,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",l.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,a)=>{const l=this._map._getUIString(`NavigationControl.${a}`);e.title=l,e.setAttribute("aria-label",l)},this.options=c.e({},lu,f),this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",(e=>this._map.zoomIn({},{originalEvent:e}))),ne.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",(e=>this._map.zoomOut({},{originalEvent:e}))),ne.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",(e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})})),this._compassIcon=ne.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ba(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ne.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,e){const a=ne.create("button",f,this._container);return a.type="button",a.addEventListener("click",e),a}},A.Popup=class extends c.E{constructor(f){super(),this._updateOpacity=()=>{this.options.locationOccludedOpacity!==void 0&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&ne.remove(this._content),this._container&&(ne.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.l("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ne.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ne.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const _ of this.options.className.split(" "))this._container.classList.add(_);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=El(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!e)return;const a=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let l=this.options.anchor;const d=Dl(this.options.offset);if(!l){const _=this._container.offsetWidth,S=this._container.offsetHeight;let P;P=a.y+d.bottom.y<S?["top"]:a.y>this._map.transform.height-S?["bottom"]:[],a.x<_/2?P.push("left"):a.x>this._map.transform.width-_/2&&P.push("right"),l=P.length===0?"bottom":P.join("-")}let g=a.add(d[l]);this.options.subpixelPositioning||(g=g.round()),ne.setTransform(this._container,`${Wn[l]} translate(${g.x}px,${g.y}px)`),pr(this._container,l,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(Ua),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=c.S.convert(f),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const e=document.createDocumentFragment(),a=document.createElement("body");let l;for(a.innerHTML=f;l=a.firstChild,l;)e.appendChild(l);return this.setDOMContent(e)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ne.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){return this._container&&this._container.classList.add(f),this}removeClassName(f){return this._container&&this._container.classList.remove(f),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}setSubpixelPositioning(f){this.options.subpixelPositioning=f}_createCloseButton(){this.options.closeButton&&(this._closeButton=ne.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Rl);f&&f.focus()}},A.RasterDEMTileSource=nr,A.RasterTileSource=Ar,A.ScaleControl=class{constructor(f){this._onMove=()=>{Ls(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Ls(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},zs),f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ne.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},A.ScrollZoomHandler=To,A.Style=Bu,A.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=f}onAdd(f){return this._map=f,this._container=ne.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ne.create("button","maplibregl-ctrl-terrain",this._container),ne.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ne.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},A.TwoFingersTouchPitchHandler=Ds,A.TwoFingersTouchRotateHandler=nu,A.TwoFingersTouchZoomHandler=tu,A.TwoFingersTouchZoomRotateHandler=ou,A.VectorTileSource=qn,A.VideoSource=Mi,A.addSourceType=(f,e)=>c._(void 0,void 0,void 0,(function*(){if(ra(f))throw new Error(`A source type called "${f}" already exists.`);((a,l)=>{ya[a]=l})(f,e)})),A.clearPrewarmedResources=function(){const f=st;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(ve),st=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},A.createTileMesh=Lu,A.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},A.getRTLTextPluginStatus=function(){return gr().getRTLTextPluginStatus()},A.getVersion=function(){return wc},A.getWorkerCount=function(){return Xe.workerCount},A.getWorkerUrl=function(){return c.a.WORKER_URL},A.importScriptInWorkers=function(f){return Zt().broadcast("IS",f)},A.prewarm=function(){Kt().acquire(ve)},A.setMaxParallelImageRequests=function(f){c.a.MAX_PARALLEL_IMAGE_REQUESTS=f},A.setRTLTextPlugin=function(f,e){return gr().setRTLTextPlugin(f,e)},A.setWorkerCount=function(f){Xe.workerCount=f},A.setWorkerUrl=function(f){c.a.WORKER_URL=f}}));var G=L;return G}))})(cm)),cm.exports}var q0=Z0();const W0=ug(q0),$0={"bosnia-herzegovina":"bosnia and herzegovina","bosnia and herzegovina":"bosnia and herzegovina","bosnia and herz.":"bosnia and herzegovina","bosnia and herz":"bosnia and herzegovina",macedonia:"north macedonia","macedonia (fyrom)":"north macedonia","the former yugoslav republic of macedonia":"north macedonia","united states of america":"united states",usa:"united states","u s a":"united states",us:"united states",america:"united states","u.s.a.":"united states","u. s. a.":"united states","u. s. a. ":"united states",uk:"united kingdom","united kingdom of great britain and northern ireland":"united kingdom","great britain":"united kingdom",britain:"united kingdom","south korea":"korea republic of","korea republic of":"korea republic of","republic of korea":"korea republic of","korea south":"korea republic of","s korea":"korea republic of","ro korea":"korea republic of","korea, south":"korea republic of","north korea":"korea democratic peoples republic of","democratic peoples republic of korea":"korea democratic peoples republic of",dprk:"korea democratic peoples republic of",russia:"russian federation","russian federation":"russian federation","russian fed":"russian federation","russian federation (the)":"russian federation","ivory coast":"cote divoire","cote d ivoire":"cote divoire","cote divoire":"cote divoire",cotedivoire:"cote divoire","guinea bissau":"guinea bissau","guinea-bissau":"guinea bissau","republic of guinea bissau":"guinea bissau",belarus:"belarus",belorussia:"belarus",byelorussia:"belarus","republic of belarus":"belarus",eswatini:"eswatini","kingdom of eswatini":"eswatini",swaziland:"eswatini","kingdom of swaziland":"eswatini",czechia:"czech republic","czech republic":"czech republic",prc:"china","people s republic of china":"china","people s republic of china (china)":"china",china:"china",iran:"iran","islamic republic of iran":"iran","iran islamic republic of":"iran","syrian arab republic":"syria",syria:"syria","viet nam":"vietnam",vietnam:"vietnam",moldova:"moldova","republic of moldova":"moldova","moldova republic of":"moldova",bolivia:"bolivia","bolivia plurinational state of":"bolivia",vatican:"vatican city","vatican city":"vatican city","holy see":"vatican city",turkiye:"turkey",turkey:"turkey","cape verde":"cape verde","cabo verde":"cape verde","congo republic":"congo republic","congo democratic republic":"democratic republic of the congo","democratic republic of the congo":"democratic republic of the congo","dr congo":"democratic republic of the congo",slovakia:"slovakia","slovak republic":"slovakia","north macedonia":"north macedonia","republic of north macedonia":"north macedonia",uae:"united arab emirates","u a e":"united arab emirates",drc:"democratic republic of the congo",ukraine:"ukraine"};function Wm(b){return b.toLowerCase().split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")}function X0(b){return b>=7.5?"#006400":b>=7.25?"#0A8C0A":b>=7?"#228B22":b>=6.75?"#2E8B57":b>=6.5?"#32CD32":b>=6.25?"#7CFC00":b>=6?"#ADFF2F":b>=5.75?"#DFFF00":b>=5.5?"#FFFF00":b>=5.25?"#FFEF00":b>=5?"#FFD700":b>=4.75?"#FFA500":b>=4.5?"#FF8C00":b>=4.25?"#FF7F50":b>=4?"#FF6347":b>=3.75?"#FF4500":b>=3.5?"#FF0000":b>=3.25?"#DC143C":b>=3?"#B22222":b>=2.75?"#A52A2A":b>=2.5?"#8B0000":b>=2.25?"#800000":(b>=1.5,"#4B0000")}class Y0{container=null;onAdd(R){const L=document.createElement("div");L.className="maplibregl-ctrl maplibregl-ctrl-group simple-zoom-ctrl",L.style.position="absolute",L.style.right="0px",L.style.transform="translateY(100%)",L.style.display="flex",L.style.flexDirection="column",L.style.gap="6px",L.style.background="rgba(255,255,255,0.9)",L.style.borderRadius="6px",L.style.padding="6px",L.style.boxShadow="0 1px 6px rgba(0,0,0,0.15)",L.style.userSelect="none";const D=(A,c)=>{const H=document.createElement("button");return H.innerText=A,H.title=A,H.style.width="24px",H.style.height="24px",H.style.display="flex",H.style.alignItems="center",H.style.justifyContent="center",H.style.border="none",H.style.background="transparent",H.style.cursor="pointer",H.style.fontSize="22px",H.onpointerdown=Y=>Y.stopPropagation(),H.onclick=c,H},j=D("+",()=>R.easeTo({zoom:R.getZoom()+1})),G=D("−",()=>R.easeTo({zoom:R.getZoom()-1}));return L.appendChild(j),L.appendChild(G),this.container=L,L}onRemove(){this.container?.parentNode?.removeChild(this.container),this.container=null}}function Td(b){return b?b.toLowerCase().normalize("NFKD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s]/g,"").replace(/\s+/g," ").trim():""}function K0({mapContainerRef:b,callback:R,countryStats:L=[]}){const D=Ee.useRef(null),j=Ee.useRef(null);return Ee.useEffect(()=>{if(D.current)return;D.current=new W0.Map({container:b.current,style:"https://demotiles.maplibre.org/style.json",center:[43,43],zoom:3,attributionControl:!1}),D.current.addControl(new Y0);const G={},A={},c={};for(const H of L)if(H?.Country_clean&&typeof H.Happiness=="number"){const Y=H.Country_clean;G[Y]=H.Happiness,H.Country&&typeof H.Country=="string"&&(A[H.Country]=Y,c[Td(H.Country)]=Y);const he=Wm(H.Country_clean);A[he]||(A[he]=Y,c[Td(he)]=Y)}return Object.entries($0).forEach(([H,Y])=>{if(G[Y]!==void 0){const he=Wm(H);A[he]=Y,A[H]=Y,c[Td(he)]=Y,c[Td(H)]=Y}}),D.current.on("load",()=>{const Y=["match",["downcase",["coalesce",["get","NAME"],["get","ADMIN"],["get","NAME_EN"],["get","BRK_NAME"]]]],he="#d9d9d9",we=new Set;for(const[Re,ye]of Object.entries(A)){const ze=G[ye];if(typeof ze=="number"&&!isNaN(ze)){const De=Re.toLowerCase();we.has(De)||(Y.push(De,X0(ze)),we.add(De))}}Y.push(he);const ge="countries-fill";if(D.current?.getLayer(ge))j.current=ge,D.current.setPaintProperty(ge,"fill-color",Y),D.current.setPaintProperty(ge,"fill-opacity",1);else{const ye=(D.current.getStyle().layers||[]).find(ze=>/country|countries|admin|ne_10m_admin_0_countries/i.test(ze.id));ye&&(j.current=ye.id,D.current.setPaintProperty(ye.id,"fill-color",Y),D.current.setPaintProperty(ye.id,"fill-opacity",1))}D.current?.setPaintProperty("crimea-fill","fill-color","#FFA500")}),D.current?.on("click",H=>{if(D.current?.queryRenderedFeatures(H.point,{layers:["crimea-fill"]})?.length)return;const he=j.current??"countries-fill",we=D.current?.queryRenderedFeatures(H.point,{layers:[he]});if(we?.length){const ge=we[0],ne=ge.properties?.NAME||ge.properties?.name||"",Re=Td(ne),ye=c[Re]??c[Td(Wm(ne))];R(ye??Re)}}),()=>{D.current?.remove(),D.current=null,j.current=null}},[L]),_e.jsx("div",{ref:b,className:"w-full h-40"})}function Q0(b,R){const L=Ee.createContext(R),D=G=>{const{children:A,...c}=G,H=Ee.useMemo(()=>c,Object.values(c));return _e.jsx(L.Provider,{value:H,children:A})};D.displayName=b+"Provider";function j(G){const A=Ee.useContext(L);if(A)return A;if(R!==void 0)return R;throw new Error(`\`${G}\` must be used within \`${b}\``)}return[D,j]}function tp(b,R=[]){let L=[];function D(G,A){const c=Ee.createContext(A),H=L.length;L=[...L,A];const Y=we=>{const{scope:ge,children:ne,...Re}=we,ye=ge?.[b]?.[H]||c,ze=Ee.useMemo(()=>Re,Object.values(Re));return _e.jsx(ye.Provider,{value:ze,children:ne})};Y.displayName=G+"Provider";function he(we,ge){const ne=ge?.[b]?.[H]||c,Re=Ee.useContext(ne);if(Re)return Re;if(A!==void 0)return A;throw new Error(`\`${we}\` must be used within \`${G}\``)}return[Y,he]}const j=()=>{const G=L.map(A=>Ee.createContext(A));return function(c){const H=c?.[b]||G;return Ee.useMemo(()=>({[`__scope${b}`]:{...c,[b]:H}}),[c,H])}};return j.scopeName=b,[D,J0(j,...R)]}function J0(...b){const R=b[0];if(b.length===1)return R;const L=()=>{const D=b.map(j=>({useScope:j(),scopeName:j.scopeName}));return function(G){const A=D.reduce((c,{useScope:H,scopeName:Y})=>{const we=H(G)[`__scope${Y}`];return{...c,...we}},{});return Ee.useMemo(()=>({[`__scope${R.scopeName}`]:A}),[A])}};return L.scopeName=R.scopeName,L}function ev(b){const R=b+"CollectionProvider",[L,D]=tp(R),[j,G]=L(R,{collectionRef:{current:null},itemMap:new Map}),A=ye=>{const{scope:ze,children:De}=ye,ke=gi.useRef(null),He=gi.useRef(new Map).current;return _e.jsx(j,{scope:ze,itemMap:He,collectionRef:ke,children:De})};A.displayName=R;const c=b+"CollectionSlot",H=Xf(c),Y=gi.forwardRef((ye,ze)=>{const{scope:De,children:ke}=ye,He=G(c,De),it=el(ze,He.collectionRef);return _e.jsx(H,{ref:it,children:ke})});Y.displayName=c;const he=b+"CollectionItemSlot",we="data-radix-collection-item",ge=Xf(he),ne=gi.forwardRef((ye,ze)=>{const{scope:De,children:ke,...He}=ye,it=gi.useRef(null),at=el(ze,it),wt=G(he,De);return gi.useEffect(()=>(wt.itemMap.set(it,{ref:it,...He}),()=>void wt.itemMap.delete(it))),_e.jsx(ge,{[we]:"",ref:at,children:ke})});ne.displayName=he;function Re(ye){const ze=G(b+"CollectionConsumer",ye);return gi.useCallback(()=>{const ke=ze.collectionRef.current;if(!ke)return[];const He=Array.from(ke.querySelectorAll(`[${we}]`));return Array.from(ze.itemMap.values()).sort((wt,ft)=>He.indexOf(wt.ref.current)-He.indexOf(ft.ref.current))},[ze.collectionRef,ze.itemMap])}return[{Provider:A,Slot:Y,ItemSlot:ne},Re,D]}function ql(b,R,{checkForDefaultPrevented:L=!0}={}){return function(j){if(b?.(j),L===!1||!j.defaultPrevented)return R?.(j)}}var Id=globalThis?.document?Ee.useLayoutEffect:()=>{},tv=yy[" useInsertionEffect ".trim().toString()]||Id;function xm({prop:b,defaultProp:R,onChange:L=()=>{},caller:D}){const[j,G,A]=nv({defaultProp:R,onChange:L}),c=b!==void 0,H=c?b:j;{const he=Ee.useRef(b!==void 0);Ee.useEffect(()=>{const we=he.current;we!==c&&console.warn(`${D} is changing from ${we?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),he.current=c},[c,D])}const Y=Ee.useCallback(he=>{if(c){const we=rv(he)?he(b):he;we!==b&&A.current?.(we)}else G(he)},[c,b,G,A]);return[H,Y]}function nv({defaultProp:b,onChange:R}){const[L,D]=Ee.useState(b),j=Ee.useRef(L),G=Ee.useRef(R);return tv(()=>{G.current=R},[R]),Ee.useEffect(()=>{j.current!==L&&(G.current?.(L),j.current=L)},[L,j]),[L,D,G]}function rv(b){return typeof b=="function"}var zy=_y();const iv=ug(zy);var av=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ta=av.reduce((b,R)=>{const L=Xf(`Primitive.${R}`),D=Ee.forwardRef((j,G)=>{const{asChild:A,...c}=j,H=A?L:R;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_e.jsx(H,{...c,ref:G})});return D.displayName=`Primitive.${R}`,{...b,[R]:D}},{});function ov(b,R){b&&zy.flushSync(()=>b.dispatchEvent(R))}function sv(b,R){return Ee.useReducer((L,D)=>R[L][D]??L,b)}var np=b=>{const{present:R,children:L}=b,D=lv(R),j=typeof L=="function"?L({present:D.isPresent}):Ee.Children.only(L),G=el(D.ref,cv(j));return typeof L=="function"||D.isPresent?Ee.cloneElement(j,{ref:G}):null};np.displayName="Presence";function lv(b){const[R,L]=Ee.useState(),D=Ee.useRef(null),j=Ee.useRef(b),G=Ee.useRef("none"),A=b?"mounted":"unmounted",[c,H]=sv(A,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return Ee.useEffect(()=>{const Y=tm(D.current);G.current=c==="mounted"?Y:"none"},[c]),Id(()=>{const Y=D.current,he=j.current;if(he!==b){const ge=G.current,ne=tm(Y);b?H("MOUNT"):ne==="none"||Y?.display==="none"?H("UNMOUNT"):H(he&&ge!==ne?"ANIMATION_OUT":"UNMOUNT"),j.current=b}},[b,H]),Id(()=>{if(R){let Y;const he=R.ownerDocument.defaultView??window,we=ne=>{const ye=tm(D.current).includes(CSS.escape(ne.animationName));if(ne.target===R&&ye&&(H("ANIMATION_END"),!j.current)){const ze=R.style.animationFillMode;R.style.animationFillMode="forwards",Y=he.setTimeout(()=>{R.style.animationFillMode==="forwards"&&(R.style.animationFillMode=ze)})}},ge=ne=>{ne.target===R&&(G.current=tm(D.current))};return R.addEventListener("animationstart",ge),R.addEventListener("animationcancel",we),R.addEventListener("animationend",we),()=>{he.clearTimeout(Y),R.removeEventListener("animationstart",ge),R.removeEventListener("animationcancel",we),R.removeEventListener("animationend",we)}}else H("ANIMATION_END")},[R,H]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:Ee.useCallback(Y=>{D.current=Y?getComputedStyle(Y):null,L(Y)},[])}}function tm(b){return b?.animationName||"none"}function cv(b){let R=Object.getOwnPropertyDescriptor(b.props,"ref")?.get,L=R&&"isReactWarning"in R&&R.isReactWarning;return L?b.ref:(R=Object.getOwnPropertyDescriptor(b,"ref")?.get,L=R&&"isReactWarning"in R&&R.isReactWarning,L?b.props.ref:b.props.ref||b.ref)}var uv=yy[" useId ".trim().toString()]||(()=>{}),hv=0;function Wf(b){const[R,L]=Ee.useState(uv());return Id(()=>{L(D=>D??String(hv++))},[b]),b||(R?`radix-${R}`:"")}var bm="Collapsible",[dv,Ly]=tp(bm),[fv,fg]=dv(bm),ky=Ee.forwardRef((b,R)=>{const{__scopeCollapsible:L,open:D,defaultOpen:j,disabled:G,onOpenChange:A,...c}=b,[H,Y]=xm({prop:D,defaultProp:j??!1,onChange:A,caller:bm});return _e.jsx(fv,{scope:L,disabled:G,contentId:Wf(),open:H,onOpenToggle:Ee.useCallback(()=>Y(he=>!he),[Y]),children:_e.jsx(Ta.div,{"data-state":mg(H),"data-disabled":G?"":void 0,...c,ref:R})})});ky.displayName=bm;var Oy="CollapsibleTrigger",By=Ee.forwardRef((b,R)=>{const{__scopeCollapsible:L,...D}=b,j=fg(Oy,L);return _e.jsx(Ta.button,{type:"button","aria-controls":j.contentId,"aria-expanded":j.open||!1,"data-state":mg(j.open),"data-disabled":j.disabled?"":void 0,disabled:j.disabled,...D,ref:R,onClick:ql(b.onClick,j.onOpenToggle)})});By.displayName=Oy;var pg="CollapsibleContent",Fy=Ee.forwardRef((b,R)=>{const{forceMount:L,...D}=b,j=fg(pg,b.__scopeCollapsible);return _e.jsx(np,{present:L||j.open,children:({present:G})=>_e.jsx(pv,{...D,ref:R,present:G})})});Fy.displayName=pg;var pv=Ee.forwardRef((b,R)=>{const{__scopeCollapsible:L,present:D,children:j,...G}=b,A=fg(pg,L),[c,H]=Ee.useState(D),Y=Ee.useRef(null),he=el(R,Y),we=Ee.useRef(0),ge=we.current,ne=Ee.useRef(0),Re=ne.current,ye=A.open||c,ze=Ee.useRef(ye),De=Ee.useRef(void 0);return Ee.useEffect(()=>{const ke=requestAnimationFrame(()=>ze.current=!1);return()=>cancelAnimationFrame(ke)},[]),Id(()=>{const ke=Y.current;if(ke){De.current=De.current||{transitionDuration:ke.style.transitionDuration,animationName:ke.style.animationName},ke.style.transitionDuration="0s",ke.style.animationName="none";const He=ke.getBoundingClientRect();we.current=He.height,ne.current=He.width,ze.current||(ke.style.transitionDuration=De.current.transitionDuration,ke.style.animationName=De.current.animationName),H(D)}},[A.open,D]),_e.jsx(Ta.div,{"data-state":mg(A.open),"data-disabled":A.disabled?"":void 0,id:A.contentId,hidden:!ye,...G,ref:he,style:{"--radix-collapsible-content-height":ge?`${ge}px`:void 0,"--radix-collapsible-content-width":Re?`${Re}px`:void 0,...b.style},children:ye&&j})});function mg(b){return b?"open":"closed"}var mv=ky,gv=By,yv=Fy,_v=Ee.createContext(void 0);function vv(b){const R=Ee.useContext(_v);return b||R||"ltr"}var tl="Accordion",xv=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[gg,bv,wv]=ev(tl),[wm]=tp(tl,[wv,Ly]),yg=Ly(),Ny=gi.forwardRef((b,R)=>{const{type:L,...D}=b,j=D,G=D;return _e.jsx(gg.Provider,{scope:b.__scopeAccordion,children:L==="multiple"?_e.jsx(Tv,{...G,ref:R}):_e.jsx(Cv,{...j,ref:R})})});Ny.displayName=tl;var[Uy,Sv]=wm(tl),[jy,Pv]=wm(tl,{collapsible:!1}),Cv=gi.forwardRef((b,R)=>{const{value:L,defaultValue:D,onValueChange:j=()=>{},collapsible:G=!1,...A}=b,[c,H]=xm({prop:L,defaultProp:D??"",onChange:j,caller:tl});return _e.jsx(Uy,{scope:b.__scopeAccordion,value:gi.useMemo(()=>c?[c]:[],[c]),onItemOpen:H,onItemClose:gi.useCallback(()=>G&&H(""),[G,H]),children:_e.jsx(jy,{scope:b.__scopeAccordion,collapsible:G,children:_e.jsx(Vy,{...A,ref:R})})})}),Tv=gi.forwardRef((b,R)=>{const{value:L,defaultValue:D,onValueChange:j=()=>{},...G}=b,[A,c]=xm({prop:L,defaultProp:D??[],onChange:j,caller:tl}),H=gi.useCallback(he=>c((we=[])=>[...we,he]),[c]),Y=gi.useCallback(he=>c((we=[])=>we.filter(ge=>ge!==he)),[c]);return _e.jsx(Uy,{scope:b.__scopeAccordion,value:A,onItemOpen:H,onItemClose:Y,children:_e.jsx(jy,{scope:b.__scopeAccordion,collapsible:!0,children:_e.jsx(Vy,{...G,ref:R})})})}),[Av,Sm]=wm(tl),Vy=gi.forwardRef((b,R)=>{const{__scopeAccordion:L,disabled:D,dir:j,orientation:G="vertical",...A}=b,c=gi.useRef(null),H=el(c,R),Y=bv(L),we=vv(j)==="ltr",ge=ql(b.onKeyDown,ne=>{if(!xv.includes(ne.key))return;const Re=ne.target,ye=Y().filter(ot=>!ot.ref.current?.disabled),ze=ye.findIndex(ot=>ot.ref.current===Re),De=ye.length;if(ze===-1)return;ne.preventDefault();let ke=ze;const He=0,it=De-1,at=()=>{ke=ze+1,ke>it&&(ke=He)},wt=()=>{ke=ze-1,ke<He&&(ke=it)};switch(ne.key){case"Home":ke=He;break;case"End":ke=it;break;case"ArrowRight":G==="horizontal"&&(we?at():wt());break;case"ArrowDown":G==="vertical"&&at();break;case"ArrowLeft":G==="horizontal"&&(we?wt():at());break;case"ArrowUp":G==="vertical"&&wt();break}const ft=ke%De;ye[ft].ref.current?.focus()});return _e.jsx(Av,{scope:L,disabled:D,direction:j,orientation:G,children:_e.jsx(gg.Slot,{scope:L,children:_e.jsx(Ta.div,{...A,"data-orientation":G,ref:H,onKeyDown:D?void 0:ge})})})}),mm="AccordionItem",[Ev,_g]=wm(mm),Hy=gi.forwardRef((b,R)=>{const{__scopeAccordion:L,value:D,...j}=b,G=Sm(mm,L),A=Sv(mm,L),c=yg(L),H=Wf(),Y=D&&A.value.includes(D)||!1,he=G.disabled||b.disabled;return _e.jsx(Ev,{scope:L,open:Y,disabled:he,triggerId:H,children:_e.jsx(mv,{"data-orientation":G.orientation,"data-state":Xy(Y),...c,...j,ref:R,disabled:he,open:Y,onOpenChange:we=>{we?A.onItemOpen(D):A.onItemClose(D)}})})});Hy.displayName=mm;var Gy="AccordionHeader",Zy=gi.forwardRef((b,R)=>{const{__scopeAccordion:L,...D}=b,j=Sm(tl,L),G=_g(Gy,L);return _e.jsx(Ta.h3,{"data-orientation":j.orientation,"data-state":Xy(G.open),"data-disabled":G.disabled?"":void 0,...D,ref:R})});Zy.displayName=Gy;var ag="AccordionTrigger",qy=gi.forwardRef((b,R)=>{const{__scopeAccordion:L,...D}=b,j=Sm(tl,L),G=_g(ag,L),A=Pv(ag,L),c=yg(L);return _e.jsx(gg.ItemSlot,{scope:L,children:_e.jsx(gv,{"aria-disabled":G.open&&!A.collapsible||void 0,"data-orientation":j.orientation,id:G.triggerId,...c,...D,ref:R})})});qy.displayName=ag;var Wy="AccordionContent",$y=gi.forwardRef((b,R)=>{const{__scopeAccordion:L,...D}=b,j=Sm(tl,L),G=_g(Wy,L),A=yg(L);return _e.jsx(yv,{role:"region","aria-labelledby":G.triggerId,"data-orientation":j.orientation,...A,...D,ref:R,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...b.style}})});$y.displayName=Wy;function Xy(b){return b?"open":"closed"}var Mv=Ny,Rv=Hy,Dv=Zy,Iv=qy,zv=$y;/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=b=>b.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),kv=b=>b.replace(/^([A-Z])|[\s-_]+(\w)/g,(R,L,D)=>D?D.toUpperCase():L.toLowerCase()),$g=b=>{const R=kv(b);return R.charAt(0).toUpperCase()+R.slice(1)},Yy=(...b)=>b.filter((R,L,D)=>!!R&&R.trim()!==""&&D.indexOf(R)===L).join(" ").trim(),Ov=b=>{for(const R in b)if(R.startsWith("aria-")||R==="role"||R==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Bv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fv=Ee.forwardRef(({color:b="currentColor",size:R=24,strokeWidth:L=2,absoluteStrokeWidth:D,className:j="",children:G,iconNode:A,...c},H)=>Ee.createElement("svg",{ref:H,...Bv,width:R,height:R,stroke:b,strokeWidth:D?Number(L)*24/Number(R):L,className:Yy("lucide",j),...!G&&!Ov(c)&&{"aria-hidden":"true"},...c},[...A.map(([Y,he])=>Ee.createElement(Y,he)),...Array.isArray(G)?G:[G]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=(b,R)=>{const L=Ee.forwardRef(({className:D,...j},G)=>Ee.createElement(Fv,{ref:G,iconNode:R,className:Yy(`lucide-${Lv($g(b))}`,`lucide-${b}`,D),...j}));return L.displayName=$g(b),L};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Uv=Pm("arrow-left",Nv);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Vv=Pm("arrow-right",jv);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Gv=Pm("chevron-down",Hv);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zv=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],qv=Pm("x",Zv);function Wv({...b}){return _e.jsx(Mv,{"data-slot":"accordion",...b})}function nm({className:b,...R}){return _e.jsx(Rv,{"data-slot":"accordion-item",className:yi("border-b last:border-b-0",b),...R})}function rm({className:b,children:R,...L}){return _e.jsx(Dv,{className:"flex",children:_e.jsxs(Iv,{"data-slot":"accordion-trigger",className:yi("focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4 rounded-md py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",b),...L,children:[R,_e.jsx(Gv,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function im({className:b,children:R,...L}){return _e.jsx(zv,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...L,children:_e.jsx("div",{className:yi("pt-0 pb-4",b),children:R})})}function $m(){return _e.jsxs(Wv,{type:"single",collapsible:!0,className:"w-full",defaultValue:"item-1",children:[_e.jsxs(nm,{value:"item-1",children:[_e.jsx(rm,{children:"What is this project?"}),_e.jsx(im,{className:"flex flex-col gap-4 text-balance",children:_e.jsx("p",{children:"A data-driven explorer of national wellbeing. It combines public datasets to show what correlates with and drives a country’s happiness score. Each country page highlights its biggest positive and negative outliers."})})]}),_e.jsxs(nm,{value:"item-2",children:[_e.jsx(rm,{children:"How to read the map"}),_e.jsx(im,{className:"flex flex-col gap-4 text-balance",children:_e.jsx("p",{children:"Colors show the official happiness score. Hover to see top metrics. Click a country to open its profile with charts and outlier cards."})})]}),_e.jsxs(nm,{value:"item-3",children:[_e.jsx(rm,{children:"Country profile"}),_e.jsx(im,{className:"flex flex-col gap-4 text-balance",children:_e.jsx("p",{children:"Each profile shows three biggest strengths and three biggest weaknesses. Strengths are metrics where the country scores far above its expected value. Weaknesses are metrics where it scores far below expectations."})})]}),_e.jsxs(nm,{value:"item-4",children:[_e.jsx(rm,{children:"Data sources"}),_e.jsx(im,{className:"flex flex-col gap-4 text-balance",children:_e.jsx("p",{children:"Data comes from public sources and curated datasets. Every country detail page links to the original source files and the year used. Source names, file names, and extraction dates can be found here."})})]})]})}function um({className:b,...R}){return _e.jsx("div",{"data-slot":"card",className:yi("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",b),...R})}function hm({className:b,...R}){return _e.jsx("div",{"data-slot":"card-header",className:yi("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",b),...R})}function Rd({className:b,...R}){return _e.jsx("div",{"data-slot":"card-title",className:yi("leading-none font-semibold",b),...R})}function dm({className:b,...R}){return _e.jsx("div",{"data-slot":"card-content",className:yi("px-6",b),...R})}function Ky({className:b,...R}){return _e.jsx("div",{"data-slot":"card-footer",className:yi("flex items-center px-6 [.border-t]:pt-6",b),...R})}function $v(b){return Object.prototype.toString.call(b)==="[object Object]"}function Xg(b){return $v(b)||Array.isArray(b)}function Xv(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function vg(b,R){const L=Object.keys(b),D=Object.keys(R);if(L.length!==D.length)return!1;const j=JSON.stringify(Object.keys(b.breakpoints||{})),G=JSON.stringify(Object.keys(R.breakpoints||{}));return j!==G?!1:L.every(A=>{const c=b[A],H=R[A];return typeof c=="function"?`${c}`==`${H}`:!Xg(c)||!Xg(H)?c===H:vg(c,H)})}function Yg(b){return b.concat().sort((R,L)=>R.name>L.name?1:-1).map(R=>R.options)}function Yv(b,R){if(b.length!==R.length)return!1;const L=Yg(b),D=Yg(R);return L.every((j,G)=>{const A=D[G];return vg(j,A)})}function xg(b){return typeof b=="number"}function og(b){return typeof b=="string"}function Cm(b){return typeof b=="boolean"}function Kg(b){return Object.prototype.toString.call(b)==="[object Object]"}function Yr(b){return Math.abs(b)}function bg(b){return Math.sign(b)}function $f(b,R){return Yr(b-R)}function Kv(b,R){if(b===0||R===0||Yr(b)<=Yr(R))return 0;const L=$f(Yr(b),Yr(R));return Yr(L/b)}function Qv(b){return Math.round(b*100)/100}function Kf(b){return Qf(b).map(Number)}function Js(b){return b[rp(b)]}function rp(b){return Math.max(0,b.length-1)}function wg(b,R){return R===rp(b)}function Qg(b,R=0){return Array.from(Array(b),(L,D)=>R+D)}function Qf(b){return Object.keys(b)}function Qy(b,R){return[b,R].reduce((L,D)=>(Qf(D).forEach(j=>{const G=L[j],A=D[j],c=Kg(G)&&Kg(A);L[j]=c?Qy(G,A):A}),L),{})}function sg(b,R){return typeof R.MouseEvent<"u"&&b instanceof R.MouseEvent}function Jv(b,R){const L={start:D,center:j,end:G};function D(){return 0}function j(H){return G(H)/2}function G(H){return R-H}function A(H,Y){return og(b)?L[b](H):b(R,H,Y)}return{measure:A}}function Jf(){let b=[];function R(j,G,A,c={passive:!0}){let H;if("addEventListener"in j)j.addEventListener(G,A,c),H=()=>j.removeEventListener(G,A,c);else{const Y=j;Y.addListener(A),H=()=>Y.removeListener(A)}return b.push(H),D}function L(){b=b.filter(j=>j())}const D={add:R,clear:L};return D}function e1(b,R,L,D){const j=Jf(),G=1e3/60;let A=null,c=0,H=0;function Y(){j.add(b,"visibilitychange",()=>{b.hidden&&Re()})}function he(){ne(),j.clear()}function we(ze){if(!H)return;A||(A=ze,L(),L());const De=ze-A;for(A=ze,c+=De;c>=G;)L(),c-=G;const ke=c/G;D(ke),H&&(H=R.requestAnimationFrame(we))}function ge(){H||(H=R.requestAnimationFrame(we))}function ne(){R.cancelAnimationFrame(H),A=null,c=0,H=0}function Re(){A=null,c=0}return{init:Y,destroy:he,start:ge,stop:ne,update:L,render:D}}function t1(b,R){const L=R==="rtl",D=b==="y",j=D?"y":"x",G=D?"x":"y",A=!D&&L?-1:1,c=he(),H=we();function Y(Re){const{height:ye,width:ze}=Re;return D?ye:ze}function he(){return D?"top":L?"right":"left"}function we(){return D?"bottom":L?"left":"right"}function ge(Re){return Re*A}return{scroll:j,cross:G,startEdge:c,endEdge:H,measureSize:Y,direction:ge}}function Bh(b=0,R=0){const L=Yr(b-R);function D(Y){return Y<b}function j(Y){return Y>R}function G(Y){return D(Y)||j(Y)}function A(Y){return G(Y)?D(Y)?b:R:Y}function c(Y){return L?Y-L*Math.ceil((Y-R)/L):Y}return{length:L,max:R,min:b,constrain:A,reachedAny:G,reachedMax:j,reachedMin:D,removeOffset:c}}function Jy(b,R,L){const{constrain:D}=Bh(0,b),j=b+1;let G=A(R);function A(ge){return L?Yr((j+ge)%j):D(ge)}function c(){return G}function H(ge){return G=A(ge),we}function Y(ge){return he().set(c()+ge)}function he(){return Jy(b,c(),L)}const we={get:c,set:H,add:Y,clone:he};return we}function n1(b,R,L,D,j,G,A,c,H,Y,he,we,ge,ne,Re,ye,ze,De,ke){const{cross:He,direction:it}=b,at=["INPUT","SELECT","TEXTAREA"],wt={passive:!1},ft=Jf(),ot=Jf(),Bt=Bh(50,225).constrain(ne.measure(20)),cn={mouse:300,touch:400},nn={mouse:500,touch:600},on=Re?43:25;let jn=!1,er=0,mn=0,We=!1,mt=!1,rt=!1,Et=!1;function ve(St){if(!ke)return;function qt(qn){(Cm(ke)||ke(St,qn))&&It(qn)}const un=R;ft.add(un,"dragstart",qn=>qn.preventDefault(),wt).add(un,"touchmove",()=>{},wt).add(un,"touchend",()=>{}).add(un,"touchstart",qt).add(un,"mousedown",qt).add(un,"touchcancel",Ht).add(un,"contextmenu",Ht).add(un,"click",En,!0)}function Xe(){ft.clear(),ot.clear()}function vt(){const St=Et?L:R;ot.add(St,"touchmove",Zt,wt).add(St,"touchend",Ht).add(St,"mousemove",Zt,wt).add(St,"mouseup",Ht)}function st(St){const qt=St.nodeName||"";return at.includes(qt)}function xt(){return(Re?nn:cn)[Et?"mouse":"touch"]}function Kt(St,qt){const un=we.add(bg(St)*-1),qn=he.byDistance(St,!Re).distance;return Re||Yr(St)<Bt?qn:ze&&qt?qn*.5:he.byIndex(un.get(),0).distance}function It(St){const qt=sg(St,D);Et=qt,rt=Re&&qt&&!St.buttons&&jn,jn=$f(j.get(),A.get())>=2,!(qt&&St.button!==0)&&(st(St.target)||(We=!0,G.pointerDown(St),Y.useFriction(0).useDuration(0),j.set(A),vt(),er=G.readPoint(St),mn=G.readPoint(St,He),ge.emit("pointerDown")))}function Zt(St){if(!sg(St,D)&&St.touches.length>=2)return Ht(St);const un=G.readPoint(St),qn=G.readPoint(St,He),Ar=$f(un,er),nr=$f(qn,mn);if(!mt&&!Et&&(!St.cancelable||(mt=Ar>nr,!mt)))return Ht(St);const Kr=G.pointerMove(St);Ar>ye&&(rt=!0),Y.useFriction(.3).useDuration(.75),c.start(),j.add(it(Kr)),St.preventDefault()}function Ht(St){const un=he.byDistance(0,!1).index!==we.get(),qn=G.pointerUp(St)*xt(),Ar=Kt(it(qn),un),nr=Kv(qn,Ar),Kr=on-10*nr,Br=De+nr/50;mt=!1,We=!1,ot.clear(),Y.useDuration(Kr).useFriction(Br),H.distance(Ar,!Re),Et=!1,ge.emit("pointerUp")}function En(St){rt&&(St.stopPropagation(),St.preventDefault(),rt=!1)}function tr(){return We}return{init:ve,destroy:Xe,pointerDown:tr}}function r1(b,R){let D,j;function G(we){return we.timeStamp}function A(we,ge){const Re=`client${(ge||b.scroll)==="x"?"X":"Y"}`;return(sg(we,R)?we:we.touches[0])[Re]}function c(we){return D=we,j=we,A(we)}function H(we){const ge=A(we)-A(j),ne=G(we)-G(D)>170;return j=we,ne&&(D=we),ge}function Y(we){if(!D||!j)return 0;const ge=A(j)-A(D),ne=G(we)-G(D),Re=G(we)-G(j)>170,ye=ge/ne;return ne&&!Re&&Yr(ye)>.1?ye:0}return{pointerDown:c,pointerMove:H,pointerUp:Y,readPoint:A}}function i1(){function b(L){const{offsetTop:D,offsetLeft:j,offsetWidth:G,offsetHeight:A}=L;return{top:D,right:j+G,bottom:D+A,left:j,width:G,height:A}}return{measure:b}}function a1(b){function R(D){return b*(D/100)}return{measure:R}}function o1(b,R,L,D,j,G,A){const c=[b].concat(D);let H,Y,he=[],we=!1;function ge(ze){return j.measureSize(A.measure(ze))}function ne(ze){if(!G)return;Y=ge(b),he=D.map(ge);function De(ke){for(const He of ke){if(we)return;const it=He.target===b,at=D.indexOf(He.target),wt=it?Y:he[at],ft=ge(it?b:D[at]);if(Yr(ft-wt)>=.5){ze.reInit(),R.emit("resize");break}}}H=new ResizeObserver(ke=>{(Cm(G)||G(ze,ke))&&De(ke)}),L.requestAnimationFrame(()=>{c.forEach(ke=>H.observe(ke))})}function Re(){we=!0,H&&H.disconnect()}return{init:ne,destroy:Re}}function s1(b,R,L,D,j,G){let A=0,c=0,H=j,Y=G,he=b.get(),we=0;function ge(){const wt=D.get()-b.get(),ft=!H;let ot=0;return ft?(A=0,L.set(D),b.set(D),ot=wt):(L.set(b),A+=wt/H,A*=Y,he+=A,b.add(A),ot=he-we),c=bg(ot),we=he,at}function ne(){const wt=D.get()-R.get();return Yr(wt)<.001}function Re(){return H}function ye(){return c}function ze(){return A}function De(){return He(j)}function ke(){return it(G)}function He(wt){return H=wt,at}function it(wt){return Y=wt,at}const at={direction:ye,duration:Re,velocity:ze,seek:ge,settled:ne,useBaseFriction:ke,useBaseDuration:De,useFriction:it,useDuration:He};return at}function l1(b,R,L,D,j){const G=j.measure(10),A=j.measure(50),c=Bh(.1,.99);let H=!1;function Y(){return!(H||!b.reachedAny(L.get())||!b.reachedAny(R.get()))}function he(ne){if(!Y())return;const Re=b.reachedMin(R.get())?"min":"max",ye=Yr(b[Re]-R.get()),ze=L.get()-R.get(),De=c.constrain(ye/A);L.subtract(ze*De),!ne&&Yr(ze)<G&&(L.set(b.constrain(L.get())),D.useDuration(25).useBaseFriction())}function we(ne){H=!ne}return{shouldConstrain:Y,constrain:he,toggleActive:we}}function c1(b,R,L,D,j){const G=Bh(-R+b,0),A=we(),c=he(),H=ge();function Y(Re,ye){return $f(Re,ye)<=1}function he(){const Re=A[0],ye=Js(A),ze=A.lastIndexOf(Re),De=A.indexOf(ye)+1;return Bh(ze,De)}function we(){return L.map((Re,ye)=>{const{min:ze,max:De}=G,ke=G.constrain(Re),He=!ye,it=wg(L,ye);return He?De:it||Y(ze,ke)?ze:Y(De,ke)?De:ke}).map(Re=>parseFloat(Re.toFixed(3)))}function ge(){if(R<=b+j)return[G.max];if(D==="keepSnaps")return A;const{min:Re,max:ye}=c;return A.slice(Re,ye)}return{snapsContained:H,scrollContainLimit:c}}function u1(b,R,L){const D=R[0],j=L?D-b:Js(R);return{limit:Bh(j,D)}}function h1(b,R,L,D){const G=R.min+.1,A=R.max+.1,{reachedMin:c,reachedMax:H}=Bh(G,A);function Y(ge){return ge===1?H(L.get()):ge===-1?c(L.get()):!1}function he(ge){if(!Y(ge))return;const ne=b*(ge*-1);D.forEach(Re=>Re.add(ne))}return{loop:he}}function d1(b){const{max:R,length:L}=b;function D(G){const A=G-R;return L?A/-L:0}return{get:D}}function f1(b,R,L,D,j){const{startEdge:G,endEdge:A}=b,{groupSlides:c}=j,H=we().map(R.measure),Y=ge(),he=ne();function we(){return c(D).map(ye=>Js(ye)[A]-ye[0][G]).map(Yr)}function ge(){return D.map(ye=>L[G]-ye[G]).map(ye=>-Yr(ye))}function ne(){return c(Y).map(ye=>ye[0]).map((ye,ze)=>ye+H[ze])}return{snaps:Y,snapsAligned:he}}function p1(b,R,L,D,j,G){const{groupSlides:A}=j,{min:c,max:H}=D,Y=he();function he(){const ge=A(G),ne=!b||R==="keepSnaps";return L.length===1?[G]:ne?ge:ge.slice(c,H).map((Re,ye,ze)=>{const De=!ye,ke=wg(ze,ye);if(De){const He=Js(ze[0])+1;return Qg(He)}if(ke){const He=rp(G)-Js(ze)[0]+1;return Qg(He,Js(ze)[0])}return Re})}return{slideRegistry:Y}}function m1(b,R,L,D,j){const{reachedAny:G,removeOffset:A,constrain:c}=D;function H(Re){return Re.concat().sort((ye,ze)=>Yr(ye)-Yr(ze))[0]}function Y(Re){const ye=b?A(Re):c(Re),ze=R.map((ke,He)=>({diff:he(ke-ye,0),index:He})).sort((ke,He)=>Yr(ke.diff)-Yr(He.diff)),{index:De}=ze[0];return{index:De,distance:ye}}function he(Re,ye){const ze=[Re,Re+L,Re-L];if(!b)return Re;if(!ye)return H(ze);const De=ze.filter(ke=>bg(ke)===ye);return De.length?H(De):Js(ze)-L}function we(Re,ye){const ze=R[Re]-j.get(),De=he(ze,ye);return{index:Re,distance:De}}function ge(Re,ye){const ze=j.get()+Re,{index:De,distance:ke}=Y(ze),He=!b&&G(ze);if(!ye||He)return{index:De,distance:Re};const it=R[De]-ke,at=Re+he(it,0);return{index:De,distance:at}}return{byDistance:ge,byIndex:we,shortcut:he}}function g1(b,R,L,D,j,G,A){function c(we){const ge=we.distance,ne=we.index!==R.get();G.add(ge),ge&&(D.duration()?b.start():(b.update(),b.render(1),b.update())),ne&&(L.set(R.get()),R.set(we.index),A.emit("select"))}function H(we,ge){const ne=j.byDistance(we,ge);c(ne)}function Y(we,ge){const ne=R.clone().set(we),Re=j.byIndex(ne.get(),ge);c(Re)}return{distance:H,index:Y}}function y1(b,R,L,D,j,G,A,c){const H={passive:!0,capture:!0};let Y=0;function he(ne){if(!c)return;function Re(ye){if(new Date().getTime()-Y>10)return;A.emit("slideFocusStart"),b.scrollLeft=0;const ke=L.findIndex(He=>He.includes(ye));xg(ke)&&(j.useDuration(0),D.index(ke,0),A.emit("slideFocus"))}G.add(document,"keydown",we,!1),R.forEach((ye,ze)=>{G.add(ye,"focus",De=>{(Cm(c)||c(ne,De))&&Re(ze)},H)})}function we(ne){ne.code==="Tab"&&(Y=new Date().getTime())}return{init:he}}function qf(b){let R=b;function L(){return R}function D(H){R=A(H)}function j(H){R+=A(H)}function G(H){R-=A(H)}function A(H){return xg(H)?H:H.get()}return{get:L,set:D,add:j,subtract:G}}function e_(b,R){const L=b.scroll==="x"?A:c,D=R.style;let j=null,G=!1;function A(ge){return`translate3d(${ge}px,0px,0px)`}function c(ge){return`translate3d(0px,${ge}px,0px)`}function H(ge){if(G)return;const ne=Qv(b.direction(ge));ne!==j&&(D.transform=L(ne),j=ne)}function Y(ge){G=!ge}function he(){G||(D.transform="",R.getAttribute("style")||R.removeAttribute("style"))}return{clear:he,to:H,toggleActive:Y}}function _1(b,R,L,D,j,G,A,c,H){const he=Kf(j),we=Kf(j).reverse(),ge=De().concat(ke());function ne(ft,ot){return ft.reduce((Bt,cn)=>Bt-j[cn],ot)}function Re(ft,ot){return ft.reduce((Bt,cn)=>ne(Bt,ot)>0?Bt.concat([cn]):Bt,[])}function ye(ft){return G.map((ot,Bt)=>({start:ot-D[Bt]+.5+ft,end:ot+R-.5+ft}))}function ze(ft,ot,Bt){const cn=ye(ot);return ft.map(nn=>{const on=Bt?0:-L,jn=Bt?L:0,er=Bt?"end":"start",mn=cn[nn][er];return{index:nn,loopPoint:mn,slideLocation:qf(-1),translate:e_(b,H[nn]),target:()=>c.get()>mn?on:jn}})}function De(){const ft=A[0],ot=Re(we,ft);return ze(ot,L,!1)}function ke(){const ft=R-A[0]-1,ot=Re(he,ft);return ze(ot,-L,!0)}function He(){return ge.every(({index:ft})=>{const ot=he.filter(Bt=>Bt!==ft);return ne(ot,R)<=.1})}function it(){ge.forEach(ft=>{const{target:ot,translate:Bt,slideLocation:cn}=ft,nn=ot();nn!==cn.get()&&(Bt.to(nn),cn.set(nn))})}function at(){ge.forEach(ft=>ft.translate.clear())}return{canLoop:He,clear:at,loop:it,loopPoints:ge}}function v1(b,R,L){let D,j=!1;function G(H){if(!L)return;function Y(he){for(const we of he)if(we.type==="childList"){H.reInit(),R.emit("slidesChanged");break}}D=new MutationObserver(he=>{j||(Cm(L)||L(H,he))&&Y(he)}),D.observe(b,{childList:!0})}function A(){D&&D.disconnect(),j=!0}return{init:G,destroy:A}}function x1(b,R,L,D){const j={};let G=null,A=null,c,H=!1;function Y(){c=new IntersectionObserver(Re=>{H||(Re.forEach(ye=>{const ze=R.indexOf(ye.target);j[ze]=ye}),G=null,A=null,L.emit("slidesInView"))},{root:b.parentElement,threshold:D}),R.forEach(Re=>c.observe(Re))}function he(){c&&c.disconnect(),H=!0}function we(Re){return Qf(j).reduce((ye,ze)=>{const De=parseInt(ze),{isIntersecting:ke}=j[De];return(Re&&ke||!Re&&!ke)&&ye.push(De),ye},[])}function ge(Re=!0){if(Re&&G)return G;if(!Re&&A)return A;const ye=we(Re);return Re&&(G=ye),Re||(A=ye),ye}return{init:Y,destroy:he,get:ge}}function b1(b,R,L,D,j,G){const{measureSize:A,startEdge:c,endEdge:H}=b,Y=L[0]&&j,he=Re(),we=ye(),ge=L.map(A),ne=ze();function Re(){if(!Y)return 0;const ke=L[0];return Yr(R[c]-ke[c])}function ye(){if(!Y)return 0;const ke=G.getComputedStyle(Js(D));return parseFloat(ke.getPropertyValue(`margin-${H}`))}function ze(){return L.map((ke,He,it)=>{const at=!He,wt=wg(it,He);return at?ge[He]+he:wt?ge[He]+we:it[He+1][c]-ke[c]}).map(Yr)}return{slideSizes:ge,slideSizesWithGaps:ne,startGap:he,endGap:we}}function w1(b,R,L,D,j,G,A,c,H){const{startEdge:Y,endEdge:he,direction:we}=b,ge=xg(L);function ne(De,ke){return Kf(De).filter(He=>He%ke===0).map(He=>De.slice(He,He+ke))}function Re(De){return De.length?Kf(De).reduce((ke,He,it)=>{const at=Js(ke)||0,wt=at===0,ft=He===rp(De),ot=j[Y]-G[at][Y],Bt=j[Y]-G[He][he],cn=!D&&wt?we(A):0,nn=!D&&ft?we(c):0,on=Yr(Bt-nn-(ot+cn));return it&&on>R+H&&ke.push(He),ft&&ke.push(De.length),ke},[]).map((ke,He,it)=>{const at=Math.max(it[He-1]||0);return De.slice(at,ke)}):[]}function ye(De){return ge?ne(De,L):Re(De)}return{groupSlides:ye}}function S1(b,R,L,D,j,G,A){const{align:c,axis:H,direction:Y,startIndex:he,loop:we,duration:ge,dragFree:ne,dragThreshold:Re,inViewThreshold:ye,slidesToScroll:ze,skipSnaps:De,containScroll:ke,watchResize:He,watchSlides:it,watchDrag:at,watchFocus:wt}=G,ft=2,ot=i1(),Bt=ot.measure(R),cn=L.map(ot.measure),nn=t1(H,Y),on=nn.measureSize(Bt),jn=a1(on),er=Jv(c,on),mn=!we&&!!ke,We=we||!!ke,{slideSizes:mt,slideSizesWithGaps:rt,startGap:Et,endGap:ve}=b1(nn,Bt,cn,L,We,j),Xe=w1(nn,on,ze,we,Bt,cn,Et,ve,ft),{snaps:vt,snapsAligned:st}=f1(nn,er,Bt,cn,Xe),xt=-Js(vt)+Js(rt),{snapsContained:Kt,scrollContainLimit:It}=c1(on,xt,st,ke,ft),Zt=mn?Kt:st,{limit:Ht}=u1(xt,Zt,we),En=Jy(rp(Zt),he,we),tr=En.clone(),xn=Kf(L),St=({dragHandler:Z,scrollBody:q,scrollBounds:K,options:{loop:se}})=>{se||K.constrain(Z.pointerDown()),q.seek()},qt=({scrollBody:Z,translate:q,location:K,offsetLocation:se,previousLocation:de,scrollLooper:be,slideLooper:Be,dragHandler:Pe,animation:qe,eventHandler:nt,scrollBounds:Ye,options:{loop:Pt}},Ce)=>{const Gt=Z.settled(),dn=!Ye.shouldConstrain(),Rt=Pt?Gt:Gt&&dn,Wt=Rt&&!Pe.pointerDown();Wt&&qe.stop();const In=K.get()*Ce+de.get()*(1-Ce);se.set(In),Pt&&(be.loop(Z.direction()),Be.loop()),q.to(se.get()),Wt&&nt.emit("settle"),Rt||nt.emit("scroll")},un=e1(D,j,()=>St(xe),Z=>qt(xe,Z)),qn=.68,Ar=Zt[En.get()],nr=qf(Ar),Kr=qf(Ar),Br=qf(Ar),Mi=qf(Ar),oi=s1(nr,Br,Kr,Mi,ge,qn),ya=m1(we,Zt,xt,Ht,Mi),ra=g1(un,En,tr,oi,ya,Mi,A),qa=d1(Ht),Aa=Jf(),Wi=x1(R,L,A,ye),{slideRegistry:gr}=p1(mn,ke,Zt,It,Xe,xn),Ri=y1(b,L,gr,ra,oi,Aa,A,wt),xe={ownerDocument:D,ownerWindow:j,eventHandler:A,containerRect:Bt,slideRects:cn,animation:un,axis:nn,dragHandler:n1(nn,b,D,j,Mi,r1(nn,j),nr,un,ra,oi,ya,En,A,jn,ne,Re,De,qn,at),eventStore:Aa,percentOfView:jn,index:En,indexPrevious:tr,limit:Ht,location:nr,offsetLocation:Br,previousLocation:Kr,options:G,resizeHandler:o1(R,A,j,L,nn,He,ot),scrollBody:oi,scrollBounds:l1(Ht,Br,Mi,oi,jn),scrollLooper:h1(xt,Ht,Br,[nr,Br,Kr,Mi]),scrollProgress:qa,scrollSnapList:Zt.map(qa.get),scrollSnaps:Zt,scrollTarget:ya,scrollTo:ra,slideLooper:_1(nn,on,xt,mt,rt,vt,Zt,Br,L),slideFocus:Ri,slidesHandler:v1(R,A,it),slidesInView:Wi,slideIndexes:xn,slideRegistry:gr,slidesToScroll:Xe,target:Mi,translate:e_(nn,R)};return xe}function P1(){let b={},R;function L(Y){R=Y}function D(Y){return b[Y]||[]}function j(Y){return D(Y).forEach(he=>he(R,Y)),H}function G(Y,he){return b[Y]=D(Y).concat([he]),H}function A(Y,he){return b[Y]=D(Y).filter(we=>we!==he),H}function c(){b={}}const H={init:L,emit:j,off:A,on:G,clear:c};return H}const C1={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function T1(b){function R(G,A){return Qy(G,A||{})}function L(G){const A=G.breakpoints||{},c=Qf(A).filter(H=>b.matchMedia(H).matches).map(H=>A[H]).reduce((H,Y)=>R(H,Y),{});return R(G,c)}function D(G){return G.map(A=>Qf(A.breakpoints||{})).reduce((A,c)=>A.concat(c),[]).map(b.matchMedia)}return{mergeOptions:R,optionsAtMedia:L,optionsMediaQueries:D}}function A1(b){let R=[];function L(G,A){return R=A.filter(({options:c})=>b.optionsAtMedia(c).active!==!1),R.forEach(c=>c.init(G,b)),A.reduce((c,H)=>Object.assign(c,{[H.name]:H}),{})}function D(){R=R.filter(G=>G.destroy())}return{init:L,destroy:D}}function gm(b,R,L){const D=b.ownerDocument,j=D.defaultView,G=T1(j),A=A1(G),c=Jf(),H=P1(),{mergeOptions:Y,optionsAtMedia:he,optionsMediaQueries:we}=G,{on:ge,off:ne,emit:Re}=H,ye=nn;let ze=!1,De,ke=Y(C1,gm.globalOptions),He=Y(ke),it=[],at,wt,ft;function ot(){const{container:xn,slides:St}=He;wt=(og(xn)?b.querySelector(xn):xn)||b.children[0];const un=og(St)?wt.querySelectorAll(St):St;ft=[].slice.call(un||wt.children)}function Bt(xn){const St=S1(b,wt,ft,D,j,xn,H);if(xn.loop&&!St.slideLooper.canLoop()){const qt=Object.assign({},xn,{loop:!1});return Bt(qt)}return St}function cn(xn,St){ze||(ke=Y(ke,xn),He=he(ke),it=St||it,ot(),De=Bt(He),we([ke,...it.map(({options:qt})=>qt)]).forEach(qt=>c.add(qt,"change",nn)),He.active&&(De.translate.to(De.location.get()),De.animation.init(),De.slidesInView.init(),De.slideFocus.init(tr),De.eventHandler.init(tr),De.resizeHandler.init(tr),De.slidesHandler.init(tr),De.options.loop&&De.slideLooper.loop(),wt.offsetParent&&ft.length&&De.dragHandler.init(tr),at=A.init(tr,it)))}function nn(xn,St){const qt=Xe();on(),cn(Y({startIndex:qt},xn),St),H.emit("reInit")}function on(){De.dragHandler.destroy(),De.eventStore.clear(),De.translate.clear(),De.slideLooper.clear(),De.resizeHandler.destroy(),De.slidesHandler.destroy(),De.slidesInView.destroy(),De.animation.destroy(),A.destroy(),c.clear()}function jn(){ze||(ze=!0,c.clear(),on(),H.emit("destroy"),H.clear())}function er(xn,St,qt){!He.active||ze||(De.scrollBody.useBaseFriction().useDuration(St===!0?0:He.duration),De.scrollTo.index(xn,qt||0))}function mn(xn){const St=De.index.add(1).get();er(St,xn,-1)}function We(xn){const St=De.index.add(-1).get();er(St,xn,1)}function mt(){return De.index.add(1).get()!==Xe()}function rt(){return De.index.add(-1).get()!==Xe()}function Et(){return De.scrollSnapList}function ve(){return De.scrollProgress.get(De.offsetLocation.get())}function Xe(){return De.index.get()}function vt(){return De.indexPrevious.get()}function st(){return De.slidesInView.get()}function xt(){return De.slidesInView.get(!1)}function Kt(){return at}function It(){return De}function Zt(){return b}function Ht(){return wt}function En(){return ft}const tr={canScrollNext:mt,canScrollPrev:rt,containerNode:Ht,internalEngine:It,destroy:jn,off:ne,on:ge,emit:Re,plugins:Kt,previousScrollSnap:vt,reInit:ye,rootNode:Zt,scrollNext:mn,scrollPrev:We,scrollProgress:ve,scrollSnapList:Et,scrollTo:er,selectedScrollSnap:Xe,slideNodes:En,slidesInView:st,slidesNotInView:xt};return cn(R,L),setTimeout(()=>H.emit("init"),0),tr}gm.globalOptions=void 0;function Sg(b={},R=[]){const L=Ee.useRef(b),D=Ee.useRef(R),[j,G]=Ee.useState(),[A,c]=Ee.useState(),H=Ee.useCallback(()=>{j&&j.reInit(L.current,D.current)},[j]);return Ee.useEffect(()=>{vg(L.current,b)||(L.current=b,H())},[b,H]),Ee.useEffect(()=>{Yv(D.current,R)||(D.current=R,H())},[R,H]),Ee.useEffect(()=>{if(Xv()&&A){gm.globalOptions=Sg.globalOptions;const Y=gm(A,L.current,D.current);return G(Y),()=>Y.destroy()}else G(void 0)},[A,G]),[c,j]}Sg.globalOptions=void 0;const t_=Ee.createContext(null);function Tm(){const b=Ee.useContext(t_);if(!b)throw new Error("useCarousel must be used within a <Carousel />");return b}function E1({orientation:b="horizontal",opts:R,setApi:L,plugins:D,className:j,children:G,...A}){const[c,H]=Sg({...R,axis:b==="horizontal"?"x":"y"},D),[Y,he]=Ee.useState(!1),[we,ge]=Ee.useState(!1),ne=Ee.useCallback(De=>{De&&(he(De.canScrollPrev()),ge(De.canScrollNext()))},[]),Re=Ee.useCallback(()=>{H?.scrollPrev()},[H]),ye=Ee.useCallback(()=>{H?.scrollNext()},[H]),ze=Ee.useCallback(De=>{De.key==="ArrowLeft"?(De.preventDefault(),Re()):De.key==="ArrowRight"&&(De.preventDefault(),ye())},[Re,ye]);return Ee.useEffect(()=>{!H||!L||L(H)},[H,L]),Ee.useEffect(()=>{if(H)return ne(H),H.on("reInit",ne),H.on("select",ne),()=>{H?.off("select",ne)}},[H,ne]),_e.jsx(t_.Provider,{value:{carouselRef:c,api:H,opts:R,orientation:b||(R?.axis==="y"?"vertical":"horizontal"),scrollPrev:Re,scrollNext:ye,canScrollPrev:Y,canScrollNext:we},children:_e.jsx("div",{onKeyDownCapture:ze,className:yi("relative",j),role:"region","aria-roledescription":"carousel","data-slot":"carousel",...A,children:G})})}function M1({className:b,...R}){const{carouselRef:L,orientation:D}=Tm();return _e.jsx("div",{ref:L,className:"overflow-hidden","data-slot":"carousel-content",children:_e.jsx("div",{className:yi("flex",D==="horizontal"?"-ml-4":"-mt-4 flex-col",b),...R})})}function R1({className:b,...R}){const{orientation:L}=Tm();return _e.jsx("div",{role:"group","aria-roledescription":"slide","data-slot":"carousel-item",className:yi("min-w-0 shrink-0 grow-0 basis-full",L==="horizontal"?"pl-4":"pt-4",b),...R})}function D1({className:b,variant:R="outline",size:L="icon",...D}){const{orientation:j,scrollPrev:G,canScrollPrev:A}=Tm();return _e.jsxs(Yf,{"data-slot":"carousel-previous",variant:R,size:L,className:yi("absolute size-8 rounded-full",j==="horizontal"?"top-1/2 -left-12 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",b),disabled:!A,onClick:G,...D,children:[_e.jsx(Uv,{}),_e.jsx("span",{className:"sr-only",children:"Previous slide"})]})}function I1({className:b,variant:R="outline",size:L="icon",...D}){const{orientation:j,scrollNext:G,canScrollNext:A}=Tm();return _e.jsxs(Yf,{"data-slot":"carousel-next",variant:R,size:L,className:yi("absolute size-8 rounded-full",j==="horizontal"?"top-1/2 -right-12 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",b),disabled:!A,onClick:G,...D,children:[_e.jsx(Vv,{}),_e.jsx("span",{className:"sr-only",children:"Next slide"})]})}var Pg="Progress",Cg=100,[z1]=tp(Pg),[L1,k1]=z1(Pg),n_=Ee.forwardRef((b,R)=>{const{__scopeProgress:L,value:D=null,max:j,getValueLabel:G=O1,...A}=b;(j||j===0)&&!Jg(j)&&console.error(B1(`${j}`,"Progress"));const c=Jg(j)?j:Cg;D!==null&&!ey(D,c)&&console.error(F1(`${D}`,"Progress"));const H=ey(D,c)?D:null,Y=ym(H)?G(H,c):void 0;return _e.jsx(L1,{scope:L,value:H,max:c,children:_e.jsx(Ta.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":ym(H)?H:void 0,"aria-valuetext":Y,role:"progressbar","data-state":a_(H,c),"data-value":H??void 0,"data-max":c,...A,ref:R})})});n_.displayName=Pg;var r_="ProgressIndicator",i_=Ee.forwardRef((b,R)=>{const{__scopeProgress:L,...D}=b,j=k1(r_,L);return _e.jsx(Ta.div,{"data-state":a_(j.value,j.max),"data-value":j.value??void 0,"data-max":j.max,...D,ref:R})});i_.displayName=r_;function O1(b,R){return`${Math.round(b/R*100)}%`}function a_(b,R){return b==null?"indeterminate":b===R?"complete":"loading"}function ym(b){return typeof b=="number"}function Jg(b){return ym(b)&&!isNaN(b)&&b>0}function ey(b,R){return ym(b)&&!isNaN(b)&&b<=R&&b>=0}function B1(b,R){return`Invalid prop \`max\` of value \`${b}\` supplied to \`${R}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Cg}\`.`}function F1(b,R){return`Invalid prop \`value\` of value \`${b}\` supplied to \`${R}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Cg} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var N1=n_,U1=i_;function _m({className:b,value:R,...L}){return _e.jsx(N1,{"data-slot":"progress",className:yi("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",b),...L,children:_e.jsx(U1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(R||0)}%)`}})})}function ep(b){const R=Ee.useRef(b);return Ee.useEffect(()=>{R.current=b}),Ee.useMemo(()=>(...L)=>R.current?.(...L),[])}function j1(b,R=globalThis?.document){const L=ep(b);Ee.useEffect(()=>{const D=j=>{j.key==="Escape"&&L(j)};return R.addEventListener("keydown",D,{capture:!0}),()=>R.removeEventListener("keydown",D,{capture:!0})},[L,R])}var V1="DismissableLayer",lg="dismissableLayer.update",H1="dismissableLayer.pointerDownOutside",G1="dismissableLayer.focusOutside",ty,o_=Ee.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),s_=Ee.forwardRef((b,R)=>{const{disableOutsidePointerEvents:L=!1,onEscapeKeyDown:D,onPointerDownOutside:j,onFocusOutside:G,onInteractOutside:A,onDismiss:c,...H}=b,Y=Ee.useContext(o_),[he,we]=Ee.useState(null),ge=he?.ownerDocument??globalThis?.document,[,ne]=Ee.useState({}),Re=el(R,ft=>we(ft)),ye=Array.from(Y.layers),[ze]=[...Y.layersWithOutsidePointerEventsDisabled].slice(-1),De=ye.indexOf(ze),ke=he?ye.indexOf(he):-1,He=Y.layersWithOutsidePointerEventsDisabled.size>0,it=ke>=De,at=W1(ft=>{const ot=ft.target,Bt=[...Y.branches].some(cn=>cn.contains(ot));!it||Bt||(j?.(ft),A?.(ft),ft.defaultPrevented||c?.())},ge),wt=$1(ft=>{const ot=ft.target;[...Y.branches].some(cn=>cn.contains(ot))||(G?.(ft),A?.(ft),ft.defaultPrevented||c?.())},ge);return j1(ft=>{ke===Y.layers.size-1&&(D?.(ft),!ft.defaultPrevented&&c&&(ft.preventDefault(),c()))},ge),Ee.useEffect(()=>{if(he)return L&&(Y.layersWithOutsidePointerEventsDisabled.size===0&&(ty=ge.body.style.pointerEvents,ge.body.style.pointerEvents="none"),Y.layersWithOutsidePointerEventsDisabled.add(he)),Y.layers.add(he),ny(),()=>{L&&Y.layersWithOutsidePointerEventsDisabled.size===1&&(ge.body.style.pointerEvents=ty)}},[he,ge,L,Y]),Ee.useEffect(()=>()=>{he&&(Y.layers.delete(he),Y.layersWithOutsidePointerEventsDisabled.delete(he),ny())},[he,Y]),Ee.useEffect(()=>{const ft=()=>ne({});return document.addEventListener(lg,ft),()=>document.removeEventListener(lg,ft)},[]),_e.jsx(Ta.div,{...H,ref:Re,style:{pointerEvents:He?it?"auto":"none":void 0,...b.style},onFocusCapture:ql(b.onFocusCapture,wt.onFocusCapture),onBlurCapture:ql(b.onBlurCapture,wt.onBlurCapture),onPointerDownCapture:ql(b.onPointerDownCapture,at.onPointerDownCapture)})});s_.displayName=V1;var Z1="DismissableLayerBranch",q1=Ee.forwardRef((b,R)=>{const L=Ee.useContext(o_),D=Ee.useRef(null),j=el(R,D);return Ee.useEffect(()=>{const G=D.current;if(G)return L.branches.add(G),()=>{L.branches.delete(G)}},[L.branches]),_e.jsx(Ta.div,{...b,ref:j})});q1.displayName=Z1;function W1(b,R=globalThis?.document){const L=ep(b),D=Ee.useRef(!1),j=Ee.useRef(()=>{});return Ee.useEffect(()=>{const G=c=>{if(c.target&&!D.current){let H=function(){l_(H1,L,Y,{discrete:!0})};const Y={originalEvent:c};c.pointerType==="touch"?(R.removeEventListener("click",j.current),j.current=H,R.addEventListener("click",j.current,{once:!0})):H()}else R.removeEventListener("click",j.current);D.current=!1},A=window.setTimeout(()=>{R.addEventListener("pointerdown",G)},0);return()=>{window.clearTimeout(A),R.removeEventListener("pointerdown",G),R.removeEventListener("click",j.current)}},[R,L]),{onPointerDownCapture:()=>D.current=!0}}function $1(b,R=globalThis?.document){const L=ep(b),D=Ee.useRef(!1);return Ee.useEffect(()=>{const j=G=>{G.target&&!D.current&&l_(G1,L,{originalEvent:G},{discrete:!1})};return R.addEventListener("focusin",j),()=>R.removeEventListener("focusin",j)},[R,L]),{onFocusCapture:()=>D.current=!0,onBlurCapture:()=>D.current=!1}}function ny(){const b=new CustomEvent(lg);document.dispatchEvent(b)}function l_(b,R,L,{discrete:D}){const j=L.originalEvent.target,G=new CustomEvent(b,{bubbles:!1,cancelable:!0,detail:L});R&&j.addEventListener(b,R,{once:!0}),D?ov(j,G):j.dispatchEvent(G)}var Xm="focusScope.autoFocusOnMount",Ym="focusScope.autoFocusOnUnmount",ry={bubbles:!1,cancelable:!0},X1="FocusScope",c_=Ee.forwardRef((b,R)=>{const{loop:L=!1,trapped:D=!1,onMountAutoFocus:j,onUnmountAutoFocus:G,...A}=b,[c,H]=Ee.useState(null),Y=ep(j),he=ep(G),we=Ee.useRef(null),ge=el(R,ye=>H(ye)),ne=Ee.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;Ee.useEffect(()=>{if(D){let ye=function(He){if(ne.paused||!c)return;const it=He.target;c.contains(it)?we.current=it:Du(we.current,{select:!0})},ze=function(He){if(ne.paused||!c)return;const it=He.relatedTarget;it!==null&&(c.contains(it)||Du(we.current,{select:!0}))},De=function(He){if(document.activeElement===document.body)for(const at of He)at.removedNodes.length>0&&Du(c)};document.addEventListener("focusin",ye),document.addEventListener("focusout",ze);const ke=new MutationObserver(De);return c&&ke.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",ye),document.removeEventListener("focusout",ze),ke.disconnect()}}},[D,c,ne.paused]),Ee.useEffect(()=>{if(c){ay.add(ne);const ye=document.activeElement;if(!c.contains(ye)){const De=new CustomEvent(Xm,ry);c.addEventListener(Xm,Y),c.dispatchEvent(De),De.defaultPrevented||(Y1(tx(u_(c)),{select:!0}),document.activeElement===ye&&Du(c))}return()=>{c.removeEventListener(Xm,Y),setTimeout(()=>{const De=new CustomEvent(Ym,ry);c.addEventListener(Ym,he),c.dispatchEvent(De),De.defaultPrevented||Du(ye??document.body,{select:!0}),c.removeEventListener(Ym,he),ay.remove(ne)},0)}}},[c,Y,he,ne]);const Re=Ee.useCallback(ye=>{if(!L&&!D||ne.paused)return;const ze=ye.key==="Tab"&&!ye.altKey&&!ye.ctrlKey&&!ye.metaKey,De=document.activeElement;if(ze&&De){const ke=ye.currentTarget,[He,it]=K1(ke);He&&it?!ye.shiftKey&&De===it?(ye.preventDefault(),L&&Du(He,{select:!0})):ye.shiftKey&&De===He&&(ye.preventDefault(),L&&Du(it,{select:!0})):De===ke&&ye.preventDefault()}},[L,D,ne.paused]);return _e.jsx(Ta.div,{tabIndex:-1,...A,ref:ge,onKeyDown:Re})});c_.displayName=X1;function Y1(b,{select:R=!1}={}){const L=document.activeElement;for(const D of b)if(Du(D,{select:R}),document.activeElement!==L)return}function K1(b){const R=u_(b),L=iy(R,b),D=iy(R.reverse(),b);return[L,D]}function u_(b){const R=[],L=document.createTreeWalker(b,NodeFilter.SHOW_ELEMENT,{acceptNode:D=>{const j=D.tagName==="INPUT"&&D.type==="hidden";return D.disabled||D.hidden||j?NodeFilter.FILTER_SKIP:D.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;L.nextNode();)R.push(L.currentNode);return R}function iy(b,R){for(const L of b)if(!Q1(L,{upTo:R}))return L}function Q1(b,{upTo:R}){if(getComputedStyle(b).visibility==="hidden")return!0;for(;b;){if(R!==void 0&&b===R)return!1;if(getComputedStyle(b).display==="none")return!0;b=b.parentElement}return!1}function J1(b){return b instanceof HTMLInputElement&&"select"in b}function Du(b,{select:R=!1}={}){if(b&&b.focus){const L=document.activeElement;b.focus({preventScroll:!0}),b!==L&&J1(b)&&R&&b.select()}}var ay=ex();function ex(){let b=[];return{add(R){const L=b[0];R!==L&&L?.pause(),b=oy(b,R),b.unshift(R)},remove(R){b=oy(b,R),b[0]?.resume()}}}function oy(b,R){const L=[...b],D=L.indexOf(R);return D!==-1&&L.splice(D,1),L}function tx(b){return b.filter(R=>R.tagName!=="A")}var nx="Portal",h_=Ee.forwardRef((b,R)=>{const{container:L,...D}=b,[j,G]=Ee.useState(!1);Id(()=>G(!0),[]);const A=L||j&&globalThis?.document?.body;return A?iv.createPortal(_e.jsx(Ta.div,{...D,ref:R}),A):null});h_.displayName=nx;var Km=0;function rx(){Ee.useEffect(()=>{const b=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",b[0]??sy()),document.body.insertAdjacentElement("beforeend",b[1]??sy()),Km++,()=>{Km===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(R=>R.remove()),Km--}},[])}function sy(){const b=document.createElement("span");return b.setAttribute("data-radix-focus-guard",""),b.tabIndex=0,b.style.outline="none",b.style.opacity="0",b.style.position="fixed",b.style.pointerEvents="none",b}var Zl=function(){return Zl=Object.assign||function(R){for(var L,D=1,j=arguments.length;D<j;D++){L=arguments[D];for(var G in L)Object.prototype.hasOwnProperty.call(L,G)&&(R[G]=L[G])}return R},Zl.apply(this,arguments)};function d_(b,R){var L={};for(var D in b)Object.prototype.hasOwnProperty.call(b,D)&&R.indexOf(D)<0&&(L[D]=b[D]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function")for(var j=0,D=Object.getOwnPropertySymbols(b);j<D.length;j++)R.indexOf(D[j])<0&&Object.prototype.propertyIsEnumerable.call(b,D[j])&&(L[D[j]]=b[D[j]]);return L}function ix(b,R,L){if(L||arguments.length===2)for(var D=0,j=R.length,G;D<j;D++)(G||!(D in R))&&(G||(G=Array.prototype.slice.call(R,0,D)),G[D]=R[D]);return b.concat(G||Array.prototype.slice.call(R))}var fm="right-scroll-bar-position",pm="width-before-scroll-bar",ax="with-scroll-bars-hidden",ox="--removed-body-scroll-bar-size";function Qm(b,R){return typeof b=="function"?b(R):b&&(b.current=R),b}function sx(b,R){var L=Ee.useState(function(){return{value:b,callback:R,facade:{get current(){return L.value},set current(D){var j=L.value;j!==D&&(L.value=D,L.callback(D,j))}}}})[0];return L.callback=R,L.facade}var lx=typeof window<"u"?Ee.useLayoutEffect:Ee.useEffect,ly=new WeakMap;function cx(b,R){var L=sx(null,function(D){return b.forEach(function(j){return Qm(j,D)})});return lx(function(){var D=ly.get(L);if(D){var j=new Set(D),G=new Set(b),A=L.current;j.forEach(function(c){G.has(c)||Qm(c,null)}),G.forEach(function(c){j.has(c)||Qm(c,A)})}ly.set(L,b)},[b]),L}function ux(b){return b}function hx(b,R){R===void 0&&(R=ux);var L=[],D=!1,j={read:function(){if(D)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return L.length?L[L.length-1]:b},useMedium:function(G){var A=R(G,D);return L.push(A),function(){L=L.filter(function(c){return c!==A})}},assignSyncMedium:function(G){for(D=!0;L.length;){var A=L;L=[],A.forEach(G)}L={push:function(c){return G(c)},filter:function(){return L}}},assignMedium:function(G){D=!0;var A=[];if(L.length){var c=L;L=[],c.forEach(G),A=L}var H=function(){var he=A;A=[],he.forEach(G)},Y=function(){return Promise.resolve().then(H)};Y(),L={push:function(he){A.push(he),Y()},filter:function(he){return A=A.filter(he),L}}}};return j}function dx(b){b===void 0&&(b={});var R=hx(null);return R.options=Zl({async:!0,ssr:!1},b),R}var f_=function(b){var R=b.sideCar,L=d_(b,["sideCar"]);if(!R)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var D=R.read();if(!D)throw new Error("Sidecar medium not found");return Ee.createElement(D,Zl({},L))};f_.isSideCarExport=!0;function fx(b,R){return b.useMedium(R),f_}var p_=dx(),Jm=function(){},Am=Ee.forwardRef(function(b,R){var L=Ee.useRef(null),D=Ee.useState({onScrollCapture:Jm,onWheelCapture:Jm,onTouchMoveCapture:Jm}),j=D[0],G=D[1],A=b.forwardProps,c=b.children,H=b.className,Y=b.removeScrollBar,he=b.enabled,we=b.shards,ge=b.sideCar,ne=b.noRelative,Re=b.noIsolation,ye=b.inert,ze=b.allowPinchZoom,De=b.as,ke=De===void 0?"div":De,He=b.gapMode,it=d_(b,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),at=ge,wt=cx([L,R]),ft=Zl(Zl({},it),j);return Ee.createElement(Ee.Fragment,null,he&&Ee.createElement(at,{sideCar:p_,removeScrollBar:Y,shards:we,noRelative:ne,noIsolation:Re,inert:ye,setCallbacks:G,allowPinchZoom:!!ze,lockRef:L,gapMode:He}),A?Ee.cloneElement(Ee.Children.only(c),Zl(Zl({},ft),{ref:wt})):Ee.createElement(ke,Zl({},ft,{className:H,ref:wt}),c))});Am.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Am.classNames={fullWidth:pm,zeroRight:fm};var px=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function mx(){if(!document)return null;var b=document.createElement("style");b.type="text/css";var R=px();return R&&b.setAttribute("nonce",R),b}function gx(b,R){b.styleSheet?b.styleSheet.cssText=R:b.appendChild(document.createTextNode(R))}function yx(b){var R=document.head||document.getElementsByTagName("head")[0];R.appendChild(b)}var _x=function(){var b=0,R=null;return{add:function(L){b==0&&(R=mx())&&(gx(R,L),yx(R)),b++},remove:function(){b--,!b&&R&&(R.parentNode&&R.parentNode.removeChild(R),R=null)}}},vx=function(){var b=_x();return function(R,L){Ee.useEffect(function(){return b.add(R),function(){b.remove()}},[R&&L])}},m_=function(){var b=vx(),R=function(L){var D=L.styles,j=L.dynamic;return b(D,j),null};return R},xx={left:0,top:0,right:0,gap:0},eg=function(b){return parseInt(b||"",10)||0},bx=function(b){var R=window.getComputedStyle(document.body),L=R[b==="padding"?"paddingLeft":"marginLeft"],D=R[b==="padding"?"paddingTop":"marginTop"],j=R[b==="padding"?"paddingRight":"marginRight"];return[eg(L),eg(D),eg(j)]},wx=function(b){if(b===void 0&&(b="margin"),typeof window>"u")return xx;var R=bx(b),L=document.documentElement.clientWidth,D=window.innerWidth;return{left:R[0],top:R[1],right:R[2],gap:Math.max(0,D-L+R[2]-R[0])}},Sx=m_(),Dd="data-scroll-locked",Px=function(b,R,L,D){var j=b.left,G=b.top,A=b.right,c=b.gap;return L===void 0&&(L="margin"),`
  .`.concat(ax,` {
   overflow: hidden `).concat(D,`;
   padding-right: `).concat(c,"px ").concat(D,`;
  }
  body[`).concat(Dd,`] {
    overflow: hidden `).concat(D,`;
    overscroll-behavior: contain;
    `).concat([R&&"position: relative ".concat(D,";"),L==="margin"&&`
    padding-left: `.concat(j,`px;
    padding-top: `).concat(G,`px;
    padding-right: `).concat(A,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(D,`;
    `),L==="padding"&&"padding-right: ".concat(c,"px ").concat(D,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(fm,` {
    right: `).concat(c,"px ").concat(D,`;
  }
  
  .`).concat(pm,` {
    margin-right: `).concat(c,"px ").concat(D,`;
  }
  
  .`).concat(fm," .").concat(fm,` {
    right: 0 `).concat(D,`;
  }
  
  .`).concat(pm," .").concat(pm,` {
    margin-right: 0 `).concat(D,`;
  }
  
  body[`).concat(Dd,`] {
    `).concat(ox,": ").concat(c,`px;
  }
`)},cy=function(){var b=parseInt(document.body.getAttribute(Dd)||"0",10);return isFinite(b)?b:0},Cx=function(){Ee.useEffect(function(){return document.body.setAttribute(Dd,(cy()+1).toString()),function(){var b=cy()-1;b<=0?document.body.removeAttribute(Dd):document.body.setAttribute(Dd,b.toString())}},[])},Tx=function(b){var R=b.noRelative,L=b.noImportant,D=b.gapMode,j=D===void 0?"margin":D;Cx();var G=Ee.useMemo(function(){return wx(j)},[j]);return Ee.createElement(Sx,{styles:Px(G,!R,j,L?"":"!important")})},cg=!1;if(typeof window<"u")try{var am=Object.defineProperty({},"passive",{get:function(){return cg=!0,!0}});window.addEventListener("test",am,am),window.removeEventListener("test",am,am)}catch{cg=!1}var Ad=cg?{passive:!1}:!1,Ax=function(b){return b.tagName==="TEXTAREA"},g_=function(b,R){if(!(b instanceof Element))return!1;var L=window.getComputedStyle(b);return L[R]!=="hidden"&&!(L.overflowY===L.overflowX&&!Ax(b)&&L[R]==="visible")},Ex=function(b){return g_(b,"overflowY")},Mx=function(b){return g_(b,"overflowX")},uy=function(b,R){var L=R.ownerDocument,D=R;do{typeof ShadowRoot<"u"&&D instanceof ShadowRoot&&(D=D.host);var j=y_(b,D);if(j){var G=__(b,D),A=G[1],c=G[2];if(A>c)return!0}D=D.parentNode}while(D&&D!==L.body);return!1},Rx=function(b){var R=b.scrollTop,L=b.scrollHeight,D=b.clientHeight;return[R,L,D]},Dx=function(b){var R=b.scrollLeft,L=b.scrollWidth,D=b.clientWidth;return[R,L,D]},y_=function(b,R){return b==="v"?Ex(R):Mx(R)},__=function(b,R){return b==="v"?Rx(R):Dx(R)},Ix=function(b,R){return b==="h"&&R==="rtl"?-1:1},zx=function(b,R,L,D,j){var G=Ix(b,window.getComputedStyle(R).direction),A=G*D,c=L.target,H=R.contains(c),Y=!1,he=A>0,we=0,ge=0;do{if(!c)break;var ne=__(b,c),Re=ne[0],ye=ne[1],ze=ne[2],De=ye-ze-G*Re;(Re||De)&&y_(b,c)&&(we+=De,ge+=Re);var ke=c.parentNode;c=ke&&ke.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ke.host:ke}while(!H&&c!==document.body||H&&(R.contains(c)||R===c));return(he&&Math.abs(we)<1||!he&&Math.abs(ge)<1)&&(Y=!0),Y},om=function(b){return"changedTouches"in b?[b.changedTouches[0].clientX,b.changedTouches[0].clientY]:[0,0]},hy=function(b){return[b.deltaX,b.deltaY]},dy=function(b){return b&&"current"in b?b.current:b},Lx=function(b,R){return b[0]===R[0]&&b[1]===R[1]},kx=function(b){return`
  .block-interactivity-`.concat(b,` {pointer-events: none;}
  .allow-interactivity-`).concat(b,` {pointer-events: all;}
`)},Ox=0,Ed=[];function Bx(b){var R=Ee.useRef([]),L=Ee.useRef([0,0]),D=Ee.useRef(),j=Ee.useState(Ox++)[0],G=Ee.useState(m_)[0],A=Ee.useRef(b);Ee.useEffect(function(){A.current=b},[b]),Ee.useEffect(function(){if(b.inert){document.body.classList.add("block-interactivity-".concat(j));var ye=ix([b.lockRef.current],(b.shards||[]).map(dy),!0).filter(Boolean);return ye.forEach(function(ze){return ze.classList.add("allow-interactivity-".concat(j))}),function(){document.body.classList.remove("block-interactivity-".concat(j)),ye.forEach(function(ze){return ze.classList.remove("allow-interactivity-".concat(j))})}}},[b.inert,b.lockRef.current,b.shards]);var c=Ee.useCallback(function(ye,ze){if("touches"in ye&&ye.touches.length===2||ye.type==="wheel"&&ye.ctrlKey)return!A.current.allowPinchZoom;var De=om(ye),ke=L.current,He="deltaX"in ye?ye.deltaX:ke[0]-De[0],it="deltaY"in ye?ye.deltaY:ke[1]-De[1],at,wt=ye.target,ft=Math.abs(He)>Math.abs(it)?"h":"v";if("touches"in ye&&ft==="h"&&wt.type==="range")return!1;var ot=uy(ft,wt);if(!ot)return!0;if(ot?at=ft:(at=ft==="v"?"h":"v",ot=uy(ft,wt)),!ot)return!1;if(!D.current&&"changedTouches"in ye&&(He||it)&&(D.current=at),!at)return!0;var Bt=D.current||at;return zx(Bt,ze,ye,Bt==="h"?He:it)},[]),H=Ee.useCallback(function(ye){var ze=ye;if(!(!Ed.length||Ed[Ed.length-1]!==G)){var De="deltaY"in ze?hy(ze):om(ze),ke=R.current.filter(function(at){return at.name===ze.type&&(at.target===ze.target||ze.target===at.shadowParent)&&Lx(at.delta,De)})[0];if(ke&&ke.should){ze.cancelable&&ze.preventDefault();return}if(!ke){var He=(A.current.shards||[]).map(dy).filter(Boolean).filter(function(at){return at.contains(ze.target)}),it=He.length>0?c(ze,He[0]):!A.current.noIsolation;it&&ze.cancelable&&ze.preventDefault()}}},[]),Y=Ee.useCallback(function(ye,ze,De,ke){var He={name:ye,delta:ze,target:De,should:ke,shadowParent:Fx(De)};R.current.push(He),setTimeout(function(){R.current=R.current.filter(function(it){return it!==He})},1)},[]),he=Ee.useCallback(function(ye){L.current=om(ye),D.current=void 0},[]),we=Ee.useCallback(function(ye){Y(ye.type,hy(ye),ye.target,c(ye,b.lockRef.current))},[]),ge=Ee.useCallback(function(ye){Y(ye.type,om(ye),ye.target,c(ye,b.lockRef.current))},[]);Ee.useEffect(function(){return Ed.push(G),b.setCallbacks({onScrollCapture:we,onWheelCapture:we,onTouchMoveCapture:ge}),document.addEventListener("wheel",H,Ad),document.addEventListener("touchmove",H,Ad),document.addEventListener("touchstart",he,Ad),function(){Ed=Ed.filter(function(ye){return ye!==G}),document.removeEventListener("wheel",H,Ad),document.removeEventListener("touchmove",H,Ad),document.removeEventListener("touchstart",he,Ad)}},[]);var ne=b.removeScrollBar,Re=b.inert;return Ee.createElement(Ee.Fragment,null,Re?Ee.createElement(G,{styles:kx(j)}):null,ne?Ee.createElement(Tx,{noRelative:b.noRelative,gapMode:b.gapMode}):null)}function Fx(b){for(var R=null;b!==null;)b instanceof ShadowRoot&&(R=b.host,b=b.host),b=b.parentNode;return R}const Nx=fx(p_,Bx);var v_=Ee.forwardRef(function(b,R){return Ee.createElement(Am,Zl({},b,{ref:R,sideCar:Nx}))});v_.classNames=Am.classNames;var Ux=function(b){if(typeof document>"u")return null;var R=Array.isArray(b)?b[0]:b;return R.ownerDocument.body},Md=new WeakMap,sm=new WeakMap,lm={},tg=0,x_=function(b){return b&&(b.host||x_(b.parentNode))},jx=function(b,R){return R.map(function(L){if(b.contains(L))return L;var D=x_(L);return D&&b.contains(D)?D:(console.error("aria-hidden",L,"in not contained inside",b,". Doing nothing"),null)}).filter(function(L){return!!L})},Vx=function(b,R,L,D){var j=jx(R,Array.isArray(b)?b:[b]);lm[L]||(lm[L]=new WeakMap);var G=lm[L],A=[],c=new Set,H=new Set(j),Y=function(we){!we||c.has(we)||(c.add(we),Y(we.parentNode))};j.forEach(Y);var he=function(we){!we||H.has(we)||Array.prototype.forEach.call(we.children,function(ge){if(c.has(ge))he(ge);else try{var ne=ge.getAttribute(D),Re=ne!==null&&ne!=="false",ye=(Md.get(ge)||0)+1,ze=(G.get(ge)||0)+1;Md.set(ge,ye),G.set(ge,ze),A.push(ge),ye===1&&Re&&sm.set(ge,!0),ze===1&&ge.setAttribute(L,"true"),Re||ge.setAttribute(D,"true")}catch(De){console.error("aria-hidden: cannot operate on ",ge,De)}})};return he(R),c.clear(),tg++,function(){A.forEach(function(we){var ge=Md.get(we)-1,ne=G.get(we)-1;Md.set(we,ge),G.set(we,ne),ge||(sm.has(we)||we.removeAttribute(D),sm.delete(we)),ne||we.removeAttribute(L)}),tg--,tg||(Md=new WeakMap,Md=new WeakMap,sm=new WeakMap,lm={})}},Hx=function(b,R,L){L===void 0&&(L="data-aria-hidden");var D=Array.from(Array.isArray(b)?b:[b]),j=Ux(b);return j?(D.push.apply(D,Array.from(j.querySelectorAll("[aria-live], script"))),Vx(D,j,L,"aria-hidden")):function(){return null}},Em="Dialog",[b_]=tp(Em),[Gx,nl]=b_(Em),w_=b=>{const{__scopeDialog:R,children:L,open:D,defaultOpen:j,onOpenChange:G,modal:A=!0}=b,c=Ee.useRef(null),H=Ee.useRef(null),[Y,he]=xm({prop:D,defaultProp:j??!1,onChange:G,caller:Em});return _e.jsx(Gx,{scope:R,triggerRef:c,contentRef:H,contentId:Wf(),titleId:Wf(),descriptionId:Wf(),open:Y,onOpenChange:he,onOpenToggle:Ee.useCallback(()=>he(we=>!we),[he]),modal:A,children:L})};w_.displayName=Em;var S_="DialogTrigger",P_=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,...D}=b,j=nl(S_,L),G=el(R,j.triggerRef);return _e.jsx(Ta.button,{type:"button","aria-haspopup":"dialog","aria-expanded":j.open,"aria-controls":j.contentId,"data-state":Eg(j.open),...D,ref:G,onClick:ql(b.onClick,j.onOpenToggle)})});P_.displayName=S_;var Tg="DialogPortal",[Zx,C_]=b_(Tg,{forceMount:void 0}),T_=b=>{const{__scopeDialog:R,forceMount:L,children:D,container:j}=b,G=nl(Tg,R);return _e.jsx(Zx,{scope:R,forceMount:L,children:Ee.Children.map(D,A=>_e.jsx(np,{present:L||G.open,children:_e.jsx(h_,{asChild:!0,container:j,children:A})}))})};T_.displayName=Tg;var vm="DialogOverlay",A_=Ee.forwardRef((b,R)=>{const L=C_(vm,b.__scopeDialog),{forceMount:D=L.forceMount,...j}=b,G=nl(vm,b.__scopeDialog);return G.modal?_e.jsx(np,{present:D||G.open,children:_e.jsx(Wx,{...j,ref:R})}):null});A_.displayName=vm;var qx=Xf("DialogOverlay.RemoveScroll"),Wx=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,...D}=b,j=nl(vm,L);return _e.jsx(v_,{as:qx,allowPinchZoom:!0,shards:[j.contentRef],children:_e.jsx(Ta.div,{"data-state":Eg(j.open),...D,ref:R,style:{pointerEvents:"auto",...D.style}})})}),Fh="DialogContent",E_=Ee.forwardRef((b,R)=>{const L=C_(Fh,b.__scopeDialog),{forceMount:D=L.forceMount,...j}=b,G=nl(Fh,b.__scopeDialog);return _e.jsx(np,{present:D||G.open,children:G.modal?_e.jsx($x,{...j,ref:R}):_e.jsx(Xx,{...j,ref:R})})});E_.displayName=Fh;var $x=Ee.forwardRef((b,R)=>{const L=nl(Fh,b.__scopeDialog),D=Ee.useRef(null),j=el(R,L.contentRef,D);return Ee.useEffect(()=>{const G=D.current;if(G)return Hx(G)},[]),_e.jsx(M_,{...b,ref:j,trapFocus:L.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ql(b.onCloseAutoFocus,G=>{G.preventDefault(),L.triggerRef.current?.focus()}),onPointerDownOutside:ql(b.onPointerDownOutside,G=>{const A=G.detail.originalEvent,c=A.button===0&&A.ctrlKey===!0;(A.button===2||c)&&G.preventDefault()}),onFocusOutside:ql(b.onFocusOutside,G=>G.preventDefault())})}),Xx=Ee.forwardRef((b,R)=>{const L=nl(Fh,b.__scopeDialog),D=Ee.useRef(!1),j=Ee.useRef(!1);return _e.jsx(M_,{...b,ref:R,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:G=>{b.onCloseAutoFocus?.(G),G.defaultPrevented||(D.current||L.triggerRef.current?.focus(),G.preventDefault()),D.current=!1,j.current=!1},onInteractOutside:G=>{b.onInteractOutside?.(G),G.defaultPrevented||(D.current=!0,G.detail.originalEvent.type==="pointerdown"&&(j.current=!0));const A=G.target;L.triggerRef.current?.contains(A)&&G.preventDefault(),G.detail.originalEvent.type==="focusin"&&j.current&&G.preventDefault()}})}),M_=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,trapFocus:D,onOpenAutoFocus:j,onCloseAutoFocus:G,...A}=b,c=nl(Fh,L),H=Ee.useRef(null),Y=el(R,H);return rx(),_e.jsxs(_e.Fragment,{children:[_e.jsx(c_,{asChild:!0,loop:!0,trapped:D,onMountAutoFocus:j,onUnmountAutoFocus:G,children:_e.jsx(s_,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Eg(c.open),...A,ref:Y,onDismiss:()=>c.onOpenChange(!1)})}),_e.jsxs(_e.Fragment,{children:[_e.jsx(Yx,{titleId:c.titleId}),_e.jsx(Qx,{contentRef:H,descriptionId:c.descriptionId})]})]})}),Ag="DialogTitle",R_=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,...D}=b,j=nl(Ag,L);return _e.jsx(Ta.h2,{id:j.titleId,...D,ref:R})});R_.displayName=Ag;var D_="DialogDescription",I_=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,...D}=b,j=nl(D_,L);return _e.jsx(Ta.p,{id:j.descriptionId,...D,ref:R})});I_.displayName=D_;var z_="DialogClose",L_=Ee.forwardRef((b,R)=>{const{__scopeDialog:L,...D}=b,j=nl(z_,L);return _e.jsx(Ta.button,{type:"button",...D,ref:R,onClick:ql(b.onClick,()=>j.onOpenChange(!1))})});L_.displayName=z_;function Eg(b){return b?"open":"closed"}var k_="DialogTitleWarning",[Pb,O_]=Q0(k_,{contentName:Fh,titleName:Ag,docsSlug:"dialog"}),Yx=({titleId:b})=>{const R=O_(k_),L=`\`${R.contentName}\` requires a \`${R.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${R.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${R.docsSlug}`;return Ee.useEffect(()=>{b&&(document.getElementById(b)||console.error(L))},[L,b]),null},Kx="DialogDescriptionWarning",Qx=({contentRef:b,descriptionId:R})=>{const D=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${O_(Kx).contentName}}.`;return Ee.useEffect(()=>{const j=b.current?.getAttribute("aria-describedby");R&&j&&(document.getElementById(R)||console.warn(D))},[D,b,R]),null},Jx=w_,eb=P_,tb=T_,nb=A_,rb=E_,ib=R_,ab=I_,ob=L_;function sb({...b}){return _e.jsx(Jx,{"data-slot":"dialog",...b})}function lb({...b}){return _e.jsx(eb,{"data-slot":"dialog-trigger",...b})}function cb({...b}){return _e.jsx(tb,{"data-slot":"dialog-portal",...b})}function ub({className:b,...R}){return _e.jsx(nb,{"data-slot":"dialog-overlay",className:yi("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",b),...R})}function hb({className:b,children:R,showCloseButton:L=!0,...D}){return _e.jsxs(cb,{"data-slot":"dialog-portal",children:[_e.jsx(ub,{}),_e.jsxs(rb,{"data-slot":"dialog-content",className:yi("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",b),...D,children:[R,L&&_e.jsxs(ob,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[_e.jsx(qv,{}),_e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function db({className:b,...R}){return _e.jsx("div",{"data-slot":"dialog-header",className:yi("flex flex-col gap-2 text-center sm:text-left",b),...R})}function fb({className:b,...R}){return _e.jsx(ib,{"data-slot":"dialog-title",className:yi("text-lg leading-none font-semibold",b),...R})}function pb({className:b,...R}){return _e.jsx(ab,{"data-slot":"dialog-description",className:yi("text-muted-foreground text-sm",b),...R})}function mb(b){return b.toLowerCase().split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")}function B_({Country:b,disabled:R=!1,flash:L=!1}){return _e.jsxs(sb,{children:[R?_e.jsx(Yf,{className:`w-full ${L?"disabled:!text-primary disabled:!bg-primary":"disabled:!text-accent disabled:!bg-accent"} disabled:opacity-100`,type:"button",disabled:!0,children:"Profile"}):_e.jsx(lb,{asChild:!0,children:_e.jsx(Yf,{className:`w-full ${L?"text-primary":""}`,type:"button",children:"Profile"})}),_e.jsx(hb,{children:_e.jsxs(db,{children:[_e.jsx(fb,{children:mb(b)}),_e.jsx(pb,{children:"This is the country's profile information data. Maybe have multiple pages here or something."})]})})]})}class fy{IsStrength;IsWeakness;MetricName;DisplayPercent;Score;constructor(R,L,D,j,G){this.IsStrength=R,this.IsWeakness=L,this.MetricName=D,this.DisplayPercent=j,this.Score=G}}function py(b){return b.toLowerCase().split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")}function my({flash:b=!1,countryName:R,happiness:L,countryStrength:D,countryWeakness:j}){const G=D?3:1;return _e.jsxs(E1,{className:"w-2/3 max-w-xs",opts:{loop:!0},children:[_e.jsx(M1,{children:Array.from({length:G}).map((A,c)=>_e.jsx(R1,{children:_e.jsx("div",{className:"p-1",children:_e.jsxs(um,{className:`bg-accent transition-transform-colors duration-300 ${b?"scale-90 bg-primary":""}`,children:[_e.jsxs(hm,{children:[c===0&&_e.jsx(Rd,{children:"Happy Countries"}),c===1&&_e.jsx(Rd,{children:D?.MetricName}),c===2&&_e.jsx(Rd,{children:j?.MetricName})]}),_e.jsxs(dm,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:[c===0?_e.jsxs(_e.Fragment,{children:[L&&_e.jsxs(_e.Fragment,{children:[_e.jsxs("p",{children:[py(R)," has the happiness rate of"," ",L]}),L?_e.jsx(_m,{value:L*10,className:"mb-5"}):_e.jsx(_m,{value:0,className:"mb-5"})]}),!L&&_e.jsx(_e.Fragment,{children:R?_e.jsxs("p",{children:["No data for ",py(R)]}):_e.jsx("p",{children:"Click on the map to see happiness data!"})})]}):_e.jsx(_e.Fragment,{}),c===1&&_e.jsx("div",{children:D?_e.jsxs("p",{children:[D?.DisplayPercent,"% from expected"]}):_e.jsx("p",{children:"No data"})}),c===2&&_e.jsx("div",{children:j?_e.jsxs("p",{children:[j?.DisplayPercent,"% from expected"]}):_e.jsx("p",{children:"No data"})})]}),c===0&&_e.jsx(Ky,{className:"mt-auto flex-col gap-2",children:_e.jsx(B_,{Country:R,disabled:!L,flash:b})})]})})},c))}),_e.jsx(D1,{}),_e.jsx(I1,{})]})}function gy(b){return b.toLowerCase().split(" ").map(R=>R.charAt(0).toUpperCase()+R.slice(1)).join(" ")}function gb({flash:b=!1,countryName:R,happiness:L,countryStrength:D,countryWeakness:j}){return _e.jsxs("div",{className:"w-full flex flex-row justify-center items-center gap-4",children:[_e.jsxs(um,{className:`bg-accent transition-transform-colors-opacity duration-300 ${b?"scale-90 bg-primary":""} ${D?"":"opacity-0"}`,children:[_e.jsx(hm,{children:_e.jsx(Rd,{children:D?.MetricName})}),_e.jsx(dm,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:D?_e.jsxs("p",{children:[D?.DisplayPercent,"% from expected"]}):_e.jsx("p",{children:"No data"})})]}),_e.jsxs(um,{className:`bg-accent transition-transform-colors duration-300 ${b?"scale-90 bg-primary":""}`,children:[_e.jsx(hm,{children:_e.jsx(Rd,{children:"Happy Countries"})}),_e.jsxs(dm,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:[L&&_e.jsxs(_e.Fragment,{children:[_e.jsxs("p",{children:[gy(R)," has the happiness rate of ",L]}),L?_e.jsx(_m,{value:L*10,className:"mb-5"}):_e.jsx(_m,{value:0,className:"mb-5"})]}),!L&&_e.jsx(_e.Fragment,{children:R?_e.jsxs("p",{children:["No data for ",gy(R)]}):_e.jsx("p",{children:"Click on the map to see happiness data!"})})]}),_e.jsx(Ky,{className:"mt-auto flex-col gap-2",children:_e.jsx(B_,{Country:R,disabled:!L,flash:b})})]}),_e.jsxs(um,{className:`bg-accent transition-transform-colors duration-300 ${b?"scale-90 bg-primary":""} ${D?"":"opacity-0"}`,children:[_e.jsx(hm,{children:_e.jsx(Rd,{children:j?.MetricName})}),_e.jsx(dm,{className:"flex flex-col items-center justify-center p-4 max-h-60",children:j?_e.jsxs("p",{children:[j?.DisplayPercent,"% from expected"]}):_e.jsx("p",{children:"No data"})})]})]})}const F_=1e-6;function yb(b,R){const L=b.map(D=>D[R]).filter(D=>typeof D=="number"&&!isNaN(D));return L.length===0?{min:0,max:0}:{min:Math.min(...L),max:Math.max(...L)}}function _b(b,R,L){return L-R<F_?.5:(b-R)/(L-R)}function vb(b,R){const L=b.map(G=>G.Happiness).filter(G=>!isNaN(G)),D=Math.min(...L),j=Math.max(...L);return j-D<F_?.5:(R-D)/(j-D)}function xb(b,R){return vb(b,R)}class bb{MetricName;ActualValue;ExpectedValue;Difference;Weight;WeightMagnitude;constructor(R,L,D){this.MetricName=R,this.ActualValue=L,this.ExpectedValue=D,this.Difference=this.ActualValue-this.ExpectedValue,this.Weight=0,this.WeightMagnitude=0}get PercentAwayFromExpected(){const R=Math.max(Math.abs(this.ExpectedValue),.05);return this.Difference/R*100}get EffectivePercent(){return this.PercentAwayFromExpected*Math.sign(this.Weight)}get WeightedDifference(){return this.EffectivePercent*Math.abs(this.WeightMagnitude||this.Weight)}}function wb(){const[b,R]=Ee.useState(""),[L,D]=Ee.useState(""),[j,G]=Ee.useState(null),[A,c]=Ee.useState(),[H,Y]=Ee.useState(),[he,we]=Ee.useState(!1),ge=Ee.useRef(null),ne=Ee.useRef(null);return Ee.useEffect(()=>{if(!b)return;const Re=Pd.find(ke=>ke.Country_clean===b)||null;if(G(Re),we(!0),c(null),Y(null),window.clearTimeout(ne.current??void 0),ne.current=window.setTimeout(()=>{we(!1)},400),!Re)return;let ye=[];const ze={};for(const ke in Re){const He=ke;typeof Re[He]=="number"&&(ze[He]=yb(Pd,He))}for(let ke in Re)if(Re.hasOwnProperty(ke)){const He=ke,it=Re[He];if(typeof it=="number"&&!isNaN(it)){const at=ze[He],wt=_b(it,at.min,at.max),ft=xb(Pd,Re.Happiness);ye.push(new bb(He,wt,ft))}}const De=e0;for(let ke=0;ke<ye.length;ke++)for(let He=0;He<De.length;He++)if(ye[ke].MetricName===De[He].metric){const it=De[He].weight_signed??De[He].weight??0,at=De[He].weight_magnitude??Math.abs(De[He].weight??it);ye[ke].Weight=it,ye[ke].WeightMagnitude=at;break}if(ye.length>0){const ke=ye.reduce((it,at)=>at.WeightedDifference>it.WeightedDifference?at:it);c(new fy(!0,!1,ke.MetricName,Math.round(ke.PercentAwayFromExpected*10)/10,ke.WeightedDifference));const He=ye.reduce((it,at)=>at.WeightedDifference<it.WeightedDifference?at:it);Y(new fy(!1,!0,He.MetricName,Math.round(He.PercentAwayFromExpected*10)/10,He.WeightedDifference))}else c(null),Y(null);return()=>{window.clearTimeout(ne.current??void 0)}},[b]),_e.jsxs("div",{className:"container w-full h-screen bg-primary-foreground font-display",children:[_e.jsxs("div",{className:"bg-primary text-primary-foreground flex flex-row justify-between items-center gap-4 p-3 w-full h-20",children:[_e.jsxs("div",{className:"flex flex-row justify-start items-center gap-4",children:[_e.jsx("a",{href:"",target:"_blank",children:_e.jsx("img",{src:J_,className:"logo h-14",alt:"Vite logo"})}),_e.jsx("h1",{children:"Happiness Report"})]}),_e.jsxs("div",{className:"flex w-full max-w-sm items-center gap-2",children:[_e.jsx(H0,{type:"email",placeholder:"Find a country",value:L,onChange:Re=>D(Re.target.value),onKeyDown:Re=>{if(Re.key==="Enter"){const ye=Pd.find(ze=>ze.Country_clean.toLowerCase()===L.toLowerCase());R(ye?ye.Country_clean:L),D("")}},className:"placeholder:text-white placeholder:opacity-100"}),_e.jsx(Yf,{type:"button",variant:"outline",className:"bg-primary",onClick:()=>{const Re=Pd.find(ye=>ye.Country_clean.toLowerCase()===L.toLowerCase());Re&&(R(Re.Country_clean),D(""))},children:"Search"})]})]}),_e.jsx("div",{className:"card m-5 p-4 flex flex-col justify-center items-center gap-4 relative rounded-full h-1/3",ref:ge,children:_e.jsx(K0,{mapContainerRef:ge,callback:R,countryStats:Pd})}),_e.jsxs("div",{className:"flex flex-col justify-center items-center gap-4 md:hidden",children:[_e.jsx(my,{flash:he,countryName:b,happiness:j?.Happiness,countryStrength:A,countryWeakness:H}),_e.jsx("div",{className:"px-10 mb-5 w-full flex flex-row justify-center items-center",children:_e.jsxs("div",{className:"w-60",children:[_e.jsx("h2",{children:"About"}),_e.jsx($m,{})]})})]}),_e.jsxs("div",{className:"hidden md:flex lg:hidden flex-row justify-center items-center gap-15",children:[_e.jsx(my,{countryName:b,happiness:j?.Happiness,countryStrength:A,countryWeakness:H}),_e.jsxs("div",{className:"flex-1 max-w-70",children:[_e.jsx("h2",{children:"About"}),_e.jsx($m,{})]})]}),_e.jsxs("div",{className:"hidden lg:flex flex-row justify-center items-center gap-15",children:[_e.jsx("div",{className:"flex-1 max-w-xl",children:_e.jsx(gb,{flash:he,countryName:b,happiness:j?.Happiness,countryStrength:A,countryWeakness:H})}),_e.jsxs("div",{className:"flex-1 max-w-70 xl:max-w-1/2",children:[_e.jsx("h2",{children:"About"}),_e.jsx($m,{})]})]})]})}function Sb(){return _e.jsx(wb,{})}Q_.createRoot(document.getElementById("root")).render(_e.jsx(Ee.StrictMode,{children:_e.jsx(Sb,{})}));
